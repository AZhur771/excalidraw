var iH=Object.defineProperty;var sH=(t,e,n)=>e in t?iH(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var O=(t,e,n)=>(sH(t,typeof e!="symbol"?e+"":e,n),n);var U2=(t,e,n)=>{if(e.has(t))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(t):e.set(t,n)};function oH(t,e){for(var n=0;n<e.length;n++){const r=e[n];if(typeof r!="string"&&!Array.isArray(r)){for(const i in r)if(i!=="default"&&!(i in t)){const s=Object.getOwnPropertyDescriptor(r,i);s&&Object.defineProperty(t,i,s.get?s:{enumerable:!0,get:()=>r[i]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function n(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(i){if(i.ep)return;i.ep=!0;const s=n(i);fetch(i.href,s)}})();var u6={},E0=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof u6<"u"?u6:typeof self<"u"?self:{};function aa(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function aH(t){if(t.__esModule)return t;var e=t.default;if(typeof e=="function"){var n=function r(){return this instanceof r?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};n.prototype=e.prototype}else n={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.keys(t).forEach(function(r){var i=Object.getOwnPropertyDescriptor(t,r);Object.defineProperty(n,r,i.get?i:{enumerable:!0,get:function(){return t[r]}})}),n}var jM={exports:{}},hv={},XM={exports:{}},ot={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Tm=Symbol.for("react.element"),lH=Symbol.for("react.portal"),cH=Symbol.for("react.fragment"),uH=Symbol.for("react.strict_mode"),dH=Symbol.for("react.profiler"),hH=Symbol.for("react.provider"),fH=Symbol.for("react.context"),pH=Symbol.for("react.forward_ref"),mH=Symbol.for("react.suspense"),gH=Symbol.for("react.memo"),yH=Symbol.for("react.lazy"),d6=Symbol.iterator;function vH(t){return t===null||typeof t!="object"?null:(t=d6&&t[d6]||t["@@iterator"],typeof t=="function"?t:null)}var YM={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},ZM=Object.assign,KM={};function rh(t,e,n){this.props=t,this.context=e,this.refs=KM,this.updater=n||YM}rh.prototype.isReactComponent={};rh.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};rh.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function qM(){}qM.prototype=rh.prototype;function R3(t,e,n){this.props=t,this.context=e,this.refs=KM,this.updater=n||YM}var O3=R3.prototype=new qM;O3.constructor=R3;ZM(O3,rh.prototype);O3.isPureReactComponent=!0;var h6=Array.isArray,JM=Object.prototype.hasOwnProperty,D3={current:null},QM={key:!0,ref:!0,__self:!0,__source:!0};function eP(t,e,n){var r,i={},s=null,o=null;if(e!=null)for(r in e.ref!==void 0&&(o=e.ref),e.key!==void 0&&(s=""+e.key),e)JM.call(e,r)&&!QM.hasOwnProperty(r)&&(i[r]=e[r]);var a=arguments.length-2;if(a===1)i.children=n;else if(1<a){for(var l=Array(a),c=0;c<a;c++)l[c]=arguments[c+2];i.children=l}if(t&&t.defaultProps)for(r in a=t.defaultProps,a)i[r]===void 0&&(i[r]=a[r]);return{$$typeof:Tm,type:t,key:s,ref:o,props:i,_owner:D3.current}}function bH(t,e){return{$$typeof:Tm,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function N3(t){return typeof t=="object"&&t!==null&&t.$$typeof===Tm}function _H(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var f6=/\/+/g;function $2(t,e){return typeof t=="object"&&t!==null&&t.key!=null?_H(""+t.key):e.toString(36)}function Sg(t,e,n,r,i){var s=typeof t;(s==="undefined"||s==="boolean")&&(t=null);var o=!1;if(t===null)o=!0;else switch(s){case"string":case"number":o=!0;break;case"object":switch(t.$$typeof){case Tm:case lH:o=!0}}if(o)return o=t,i=i(o),t=r===""?"."+$2(o,0):r,h6(i)?(n="",t!=null&&(n=t.replace(f6,"$&/")+"/"),Sg(i,e,n,"",function(c){return c})):i!=null&&(N3(i)&&(i=bH(i,n+(!i.key||o&&o.key===i.key?"":(""+i.key).replace(f6,"$&/")+"/")+t)),e.push(i)),1;if(o=0,r=r===""?".":r+":",h6(t))for(var a=0;a<t.length;a++){s=t[a];var l=r+$2(s,a);o+=Sg(s,e,n,l,i)}else if(l=vH(t),typeof l=="function")for(t=l.call(t),a=0;!(s=t.next()).done;)s=s.value,l=r+$2(s,a++),o+=Sg(s,e,n,l,i);else if(s==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return o}function s1(t,e,n){if(t==null)return t;var r=[],i=0;return Sg(t,r,"","",function(s){return e.call(n,s,i++)}),r}function EH(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var Or={current:null},Cg={transition:null},wH={ReactCurrentDispatcher:Or,ReactCurrentBatchConfig:Cg,ReactCurrentOwner:D3};ot.Children={map:s1,forEach:function(t,e,n){s1(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return s1(t,function(){e++}),e},toArray:function(t){return s1(t,function(e){return e})||[]},only:function(t){if(!N3(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};ot.Component=rh;ot.Fragment=cH;ot.Profiler=dH;ot.PureComponent=R3;ot.StrictMode=uH;ot.Suspense=mH;ot.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=wH;ot.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var r=ZM({},t.props),i=t.key,s=t.ref,o=t._owner;if(e!=null){if(e.ref!==void 0&&(s=e.ref,o=D3.current),e.key!==void 0&&(i=""+e.key),t.type&&t.type.defaultProps)var a=t.type.defaultProps;for(l in e)JM.call(e,l)&&!QM.hasOwnProperty(l)&&(r[l]=e[l]===void 0&&a!==void 0?a[l]:e[l])}var l=arguments.length-2;if(l===1)r.children=n;else if(1<l){a=Array(l);for(var c=0;c<l;c++)a[c]=arguments[c+2];r.children=a}return{$$typeof:Tm,type:t.type,key:i,ref:s,props:r,_owner:o}};ot.createContext=function(t){return t={$$typeof:fH,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:hH,_context:t},t.Consumer=t};ot.createElement=eP;ot.createFactory=function(t){var e=eP.bind(null,t);return e.type=t,e};ot.createRef=function(){return{current:null}};ot.forwardRef=function(t){return{$$typeof:pH,render:t}};ot.isValidElement=N3;ot.lazy=function(t){return{$$typeof:yH,_payload:{_status:-1,_result:t},_init:EH}};ot.memo=function(t,e){return{$$typeof:gH,type:t,compare:e===void 0?null:e}};ot.startTransition=function(t){var e=Cg.transition;Cg.transition={};try{t()}finally{Cg.transition=e}};ot.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")};ot.useCallback=function(t,e){return Or.current.useCallback(t,e)};ot.useContext=function(t){return Or.current.useContext(t)};ot.useDebugValue=function(){};ot.useDeferredValue=function(t){return Or.current.useDeferredValue(t)};ot.useEffect=function(t,e){return Or.current.useEffect(t,e)};ot.useId=function(){return Or.current.useId()};ot.useImperativeHandle=function(t,e,n){return Or.current.useImperativeHandle(t,e,n)};ot.useInsertionEffect=function(t,e){return Or.current.useInsertionEffect(t,e)};ot.useLayoutEffect=function(t,e){return Or.current.useLayoutEffect(t,e)};ot.useMemo=function(t,e){return Or.current.useMemo(t,e)};ot.useReducer=function(t,e,n){return Or.current.useReducer(t,e,n)};ot.useRef=function(t){return Or.current.useRef(t)};ot.useState=function(t){return Or.current.useState(t)};ot.useSyncExternalStore=function(t,e,n){return Or.current.useSyncExternalStore(t,e,n)};ot.useTransition=function(){return Or.current.useTransition()};ot.version="18.2.0";XM.exports=ot;var A=XM.exports;const ce=aa(A),xH=oH({__proto__:null,default:ce},[A]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var TH=A,SH=Symbol.for("react.element"),CH=Symbol.for("react.fragment"),IH=Object.prototype.hasOwnProperty,AH=TH.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,kH={key:!0,ref:!0,__self:!0,__source:!0};function tP(t,e,n){var r,i={},s=null,o=null;n!==void 0&&(s=""+n),e.key!==void 0&&(s=""+e.key),e.ref!==void 0&&(o=e.ref);for(r in e)IH.call(e,r)&&!kH.hasOwnProperty(r)&&(i[r]=e[r]);if(t&&t.defaultProps)for(r in e=t.defaultProps,e)i[r]===void 0&&(i[r]=e[r]);return{$$typeof:SH,type:t,key:s,ref:o,props:i,_owner:AH.current}}hv.Fragment=CH;hv.jsx=tP;hv.jsxs=tP;jM.exports=hv;var F3=jM.exports;const ge=F3.Fragment,g=F3.jsx,M=F3.jsxs;var nP={exports:{}},pi={},rP={exports:{}},iP={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(j,K){var $=j.length;j.push(K);e:for(;0<$;){var B=$-1>>>1,G=j[B];if(0<i(G,K))j[B]=K,j[$]=G,$=B;else break e}}function n(j){return j.length===0?null:j[0]}function r(j){if(j.length===0)return null;var K=j[0],$=j.pop();if($!==K){j[0]=$;e:for(var B=0,G=j.length,Y=G>>>1;B<Y;){var X=2*(B+1)-1,J=j[X],ne=X+1,se=j[ne];if(0>i(J,$))ne<G&&0>i(se,J)?(j[B]=se,j[ne]=$,B=ne):(j[B]=J,j[X]=$,B=X);else if(ne<G&&0>i(se,$))j[B]=se,j[ne]=$,B=ne;else break e}}return K}function i(j,K){var $=j.sortIndex-K.sortIndex;return $!==0?$:j.id-K.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;t.unstable_now=function(){return s.now()}}else{var o=Date,a=o.now();t.unstable_now=function(){return o.now()-a}}var l=[],c=[],u=1,d=null,h=3,f=!1,p=!1,m=!1,v=typeof setTimeout=="function"?setTimeout:null,y=typeof clearTimeout=="function"?clearTimeout:null,b=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function _(j){for(var K=n(c);K!==null;){if(K.callback===null)r(c);else if(K.startTime<=j)r(c),K.sortIndex=K.expirationTime,e(l,K);else break;K=n(c)}}function E(j){if(m=!1,_(j),!p)if(n(l)!==null)p=!0,q(w);else{var K=n(c);K!==null&&Z(E,K.startTime-j)}}function w(j,K){p=!1,m&&(m=!1,y(C),C=-1),f=!0;var $=h;try{for(_(K),d=n(l);d!==null&&(!(d.expirationTime>K)||j&&!F());){var B=d.callback;if(typeof B=="function"){d.callback=null,h=d.priorityLevel;var G=B(d.expirationTime<=K);K=t.unstable_now(),typeof G=="function"?d.callback=G:d===n(l)&&r(l),_(K)}else r(l);d=n(l)}if(d!==null)var Y=!0;else{var X=n(c);X!==null&&Z(E,X.startTime-K),Y=!1}return Y}finally{d=null,h=$,f=!1}}var x=!1,T=null,C=-1,k=5,L=-1;function F(){return!(t.unstable_now()-L<k)}function N(){if(T!==null){var j=t.unstable_now();L=j;var K=!0;try{K=T(!0,j)}finally{K?R():(x=!1,T=null)}}else x=!1}var R;if(typeof b=="function")R=function(){b(N)};else if(typeof MessageChannel<"u"){var H=new MessageChannel,W=H.port2;H.port1.onmessage=N,R=function(){W.postMessage(null)}}else R=function(){v(N,0)};function q(j){T=j,x||(x=!0,R())}function Z(j,K){C=v(function(){j(t.unstable_now())},K)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(j){j.callback=null},t.unstable_continueExecution=function(){p||f||(p=!0,q(w))},t.unstable_forceFrameRate=function(j){0>j||125<j?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):k=0<j?Math.floor(1e3/j):5},t.unstable_getCurrentPriorityLevel=function(){return h},t.unstable_getFirstCallbackNode=function(){return n(l)},t.unstable_next=function(j){switch(h){case 1:case 2:case 3:var K=3;break;default:K=h}var $=h;h=K;try{return j()}finally{h=$}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(j,K){switch(j){case 1:case 2:case 3:case 4:case 5:break;default:j=3}var $=h;h=j;try{return K()}finally{h=$}},t.unstable_scheduleCallback=function(j,K,$){var B=t.unstable_now();switch(typeof $=="object"&&$!==null?($=$.delay,$=typeof $=="number"&&0<$?B+$:B):$=B,j){case 1:var G=-1;break;case 2:G=250;break;case 5:G=1073741823;break;case 4:G=1e4;break;default:G=5e3}return G=$+G,j={id:u++,callback:K,priorityLevel:j,startTime:$,expirationTime:G,sortIndex:-1},$>B?(j.sortIndex=$,e(c,j),n(l)===null&&j===n(c)&&(m?(y(C),C=-1):m=!0,Z(E,$-B))):(j.sortIndex=G,e(l,j),p||f||(p=!0,q(w))),j},t.unstable_shouldYield=F,t.unstable_wrapCallback=function(j){var K=h;return function(){var $=h;h=K;try{return j.apply(this,arguments)}finally{h=$}}}})(iP);rP.exports=iP;var MH=rP.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var sP=A,fi=MH;function oe(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var oP=new Set,gp={};function au(t,e){Dd(t,e),Dd(t+"Capture",e)}function Dd(t,e){for(gp[t]=e,t=0;t<e.length;t++)oP.add(e[t])}var Zo=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),bE=Object.prototype.hasOwnProperty,PH=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,p6={},m6={};function LH(t){return bE.call(m6,t)?!0:bE.call(p6,t)?!1:PH.test(t)?m6[t]=!0:(p6[t]=!0,!1)}function RH(t,e,n,r){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function OH(t,e,n,r){if(e===null||typeof e>"u"||RH(t,e,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function Dr(t,e,n,r,i,s,o){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=i,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=s,this.removeEmptyString=o}var nr={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){nr[t]=new Dr(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];nr[e]=new Dr(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){nr[t]=new Dr(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){nr[t]=new Dr(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){nr[t]=new Dr(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){nr[t]=new Dr(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){nr[t]=new Dr(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){nr[t]=new Dr(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){nr[t]=new Dr(t,5,!1,t.toLowerCase(),null,!1,!1)});var B3=/[\-:]([a-z])/g;function U3(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(B3,U3);nr[e]=new Dr(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(B3,U3);nr[e]=new Dr(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(B3,U3);nr[e]=new Dr(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){nr[t]=new Dr(t,1,!1,t.toLowerCase(),null,!1,!1)});nr.xlinkHref=new Dr("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){nr[t]=new Dr(t,1,!1,t.toLowerCase(),null,!0,!0)});function $3(t,e,n,r){var i=nr.hasOwnProperty(e)?nr[e]:null;(i!==null?i.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(OH(e,n,i,r)&&(n=null),r||i===null?LH(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):i.mustUseProperty?t[i.propertyName]=n===null?i.type===3?!1:"":n:(e=i.attributeName,r=i.attributeNamespace,n===null?t.removeAttribute(e):(i=i.type,n=i===3||i===4&&n===!0?"":""+n,r?t.setAttributeNS(r,e,n):t.setAttribute(e,n))))}var la=sP.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,o1=Symbol.for("react.element"),Vu=Symbol.for("react.portal"),Wu=Symbol.for("react.fragment"),H3=Symbol.for("react.strict_mode"),_E=Symbol.for("react.profiler"),aP=Symbol.for("react.provider"),lP=Symbol.for("react.context"),z3=Symbol.for("react.forward_ref"),EE=Symbol.for("react.suspense"),wE=Symbol.for("react.suspense_list"),G3=Symbol.for("react.memo"),Ta=Symbol.for("react.lazy"),cP=Symbol.for("react.offscreen"),g6=Symbol.iterator;function Ih(t){return t===null||typeof t!="object"?null:(t=g6&&t[g6]||t["@@iterator"],typeof t=="function"?t:null)}var sn=Object.assign,H2;function ff(t){if(H2===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);H2=e&&e[1]||""}return`
`+H2+t}var z2=!1;function G2(t,e){if(!t||z2)return"";z2=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(c){var r=c}Reflect.construct(t,[],e)}else{try{e.call()}catch(c){r=c}t.call(e.prototype)}else{try{throw Error()}catch(c){r=c}t()}}catch(c){if(c&&r&&typeof c.stack=="string"){for(var i=c.stack.split(`
`),s=r.stack.split(`
`),o=i.length-1,a=s.length-1;1<=o&&0<=a&&i[o]!==s[a];)a--;for(;1<=o&&0<=a;o--,a--)if(i[o]!==s[a]){if(o!==1||a!==1)do if(o--,a--,0>a||i[o]!==s[a]){var l=`
`+i[o].replace(" at new "," at ");return t.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",t.displayName)),l}while(1<=o&&0<=a);break}}}finally{z2=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?ff(t):""}function DH(t){switch(t.tag){case 5:return ff(t.type);case 16:return ff("Lazy");case 13:return ff("Suspense");case 19:return ff("SuspenseList");case 0:case 2:case 15:return t=G2(t.type,!1),t;case 11:return t=G2(t.type.render,!1),t;case 1:return t=G2(t.type,!0),t;default:return""}}function xE(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case Wu:return"Fragment";case Vu:return"Portal";case _E:return"Profiler";case H3:return"StrictMode";case EE:return"Suspense";case wE:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case lP:return(t.displayName||"Context")+".Consumer";case aP:return(t._context.displayName||"Context")+".Provider";case z3:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case G3:return e=t.displayName||null,e!==null?e:xE(t.type)||"Memo";case Ta:e=t._payload,t=t._init;try{return xE(t(e))}catch{}}return null}function NH(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return xE(e);case 8:return e===H3?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function dl(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function uP(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function FH(t){var e=uP(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var i=n.get,s=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return i.call(this)},set:function(o){r=""+o,s.call(this,o)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(o){r=""+o},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function a1(t){t._valueTracker||(t._valueTracker=FH(t))}function dP(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),r="";return t&&(r=uP(t)?t.checked?"true":"false":t.value),t=r,t!==n?(e.setValue(t),!0):!1}function w0(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function TE(t,e){var n=e.checked;return sn({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function y6(t,e){var n=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;n=dl(e.value!=null?e.value:n),t._wrapperState={initialChecked:r,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function hP(t,e){e=e.checked,e!=null&&$3(t,"checked",e,!1)}function SE(t,e){hP(t,e);var n=dl(e.value),r=e.type;if(n!=null)r==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(r==="submit"||r==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?CE(t,e.type,n):e.hasOwnProperty("defaultValue")&&CE(t,e.type,dl(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function v6(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function CE(t,e,n){(e!=="number"||w0(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var pf=Array.isArray;function hd(t,e,n,r){if(t=t.options,e){e={};for(var i=0;i<n.length;i++)e["$"+n[i]]=!0;for(n=0;n<t.length;n++)i=e.hasOwnProperty("$"+t[n].value),t[n].selected!==i&&(t[n].selected=i),i&&r&&(t[n].defaultSelected=!0)}else{for(n=""+dl(n),e=null,i=0;i<t.length;i++){if(t[i].value===n){t[i].selected=!0,r&&(t[i].defaultSelected=!0);return}e!==null||t[i].disabled||(e=t[i])}e!==null&&(e.selected=!0)}}function IE(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(oe(91));return sn({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function b6(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(oe(92));if(pf(n)){if(1<n.length)throw Error(oe(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:dl(n)}}function fP(t,e){var n=dl(e.value),r=dl(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),r!=null&&(t.defaultValue=""+r)}function _6(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function pP(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function AE(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?pP(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var l1,mP=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,r,i){MSApp.execUnsafeLocalFunction(function(){return t(e,n,r,i)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(l1=l1||document.createElement("div"),l1.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=l1.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function yp(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var Df={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},BH=["Webkit","ms","Moz","O"];Object.keys(Df).forEach(function(t){BH.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),Df[e]=Df[t]})});function gP(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||Df.hasOwnProperty(t)&&Df[t]?(""+e).trim():e+"px"}function yP(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var r=n.indexOf("--")===0,i=gP(n,e[n],r);n==="float"&&(n="cssFloat"),r?t.setProperty(n,i):t[n]=i}}var UH=sn({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function kE(t,e){if(e){if(UH[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(oe(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(oe(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(oe(61))}if(e.style!=null&&typeof e.style!="object")throw Error(oe(62))}}function ME(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var PE=null;function V3(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var LE=null,fd=null,pd=null;function E6(t){if(t=Im(t)){if(typeof LE!="function")throw Error(oe(280));var e=t.stateNode;e&&(e=yv(e),LE(t.stateNode,t.type,e))}}function vP(t){fd?pd?pd.push(t):pd=[t]:fd=t}function bP(){if(fd){var t=fd,e=pd;if(pd=fd=null,E6(t),e)for(t=0;t<e.length;t++)E6(e[t])}}function _P(t,e){return t(e)}function EP(){}var V2=!1;function wP(t,e,n){if(V2)return t(e,n);V2=!0;try{return _P(t,e,n)}finally{V2=!1,(fd!==null||pd!==null)&&(EP(),bP())}}function vp(t,e){var n=t.stateNode;if(n===null)return null;var r=yv(n);if(r===null)return null;n=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(t=t.type,r=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!r;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(oe(231,e,typeof n));return n}var RE=!1;if(Zo)try{var Ah={};Object.defineProperty(Ah,"passive",{get:function(){RE=!0}}),window.addEventListener("test",Ah,Ah),window.removeEventListener("test",Ah,Ah)}catch{RE=!1}function $H(t,e,n,r,i,s,o,a,l){var c=Array.prototype.slice.call(arguments,3);try{e.apply(n,c)}catch(u){this.onError(u)}}var Nf=!1,x0=null,T0=!1,OE=null,HH={onError:function(t){Nf=!0,x0=t}};function zH(t,e,n,r,i,s,o,a,l){Nf=!1,x0=null,$H.apply(HH,arguments)}function GH(t,e,n,r,i,s,o,a,l){if(zH.apply(this,arguments),Nf){if(Nf){var c=x0;Nf=!1,x0=null}else throw Error(oe(198));T0||(T0=!0,OE=c)}}function lu(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function xP(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function w6(t){if(lu(t)!==t)throw Error(oe(188))}function VH(t){var e=t.alternate;if(!e){if(e=lu(t),e===null)throw Error(oe(188));return e!==t?null:t}for(var n=t,r=e;;){var i=n.return;if(i===null)break;var s=i.alternate;if(s===null){if(r=i.return,r!==null){n=r;continue}break}if(i.child===s.child){for(s=i.child;s;){if(s===n)return w6(i),t;if(s===r)return w6(i),e;s=s.sibling}throw Error(oe(188))}if(n.return!==r.return)n=i,r=s;else{for(var o=!1,a=i.child;a;){if(a===n){o=!0,n=i,r=s;break}if(a===r){o=!0,r=i,n=s;break}a=a.sibling}if(!o){for(a=s.child;a;){if(a===n){o=!0,n=s,r=i;break}if(a===r){o=!0,r=s,n=i;break}a=a.sibling}if(!o)throw Error(oe(189))}}if(n.alternate!==r)throw Error(oe(190))}if(n.tag!==3)throw Error(oe(188));return n.stateNode.current===n?t:e}function TP(t){return t=VH(t),t!==null?SP(t):null}function SP(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=SP(t);if(e!==null)return e;t=t.sibling}return null}var CP=fi.unstable_scheduleCallback,x6=fi.unstable_cancelCallback,WH=fi.unstable_shouldYield,jH=fi.unstable_requestPaint,fn=fi.unstable_now,XH=fi.unstable_getCurrentPriorityLevel,W3=fi.unstable_ImmediatePriority,IP=fi.unstable_UserBlockingPriority,S0=fi.unstable_NormalPriority,YH=fi.unstable_LowPriority,AP=fi.unstable_IdlePriority,fv=null,ro=null;function ZH(t){if(ro&&typeof ro.onCommitFiberRoot=="function")try{ro.onCommitFiberRoot(fv,t,void 0,(t.current.flags&128)===128)}catch{}}var ds=Math.clz32?Math.clz32:JH,KH=Math.log,qH=Math.LN2;function JH(t){return t>>>=0,t===0?32:31-(KH(t)/qH|0)|0}var c1=64,u1=4194304;function mf(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function C0(t,e){var n=t.pendingLanes;if(n===0)return 0;var r=0,i=t.suspendedLanes,s=t.pingedLanes,o=n&268435455;if(o!==0){var a=o&~i;a!==0?r=mf(a):(s&=o,s!==0&&(r=mf(s)))}else o=n&~i,o!==0?r=mf(o):s!==0&&(r=mf(s));if(r===0)return 0;if(e!==0&&e!==r&&!(e&i)&&(i=r&-r,s=e&-e,i>=s||i===16&&(s&4194240)!==0))return e;if(r&4&&(r|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=r;0<e;)n=31-ds(e),i=1<<n,r|=t[n],e&=~i;return r}function QH(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function ez(t,e){for(var n=t.suspendedLanes,r=t.pingedLanes,i=t.expirationTimes,s=t.pendingLanes;0<s;){var o=31-ds(s),a=1<<o,l=i[o];l===-1?(!(a&n)||a&r)&&(i[o]=QH(a,e)):l<=e&&(t.expiredLanes|=a),s&=~a}}function DE(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function kP(){var t=c1;return c1<<=1,!(c1&4194240)&&(c1=64),t}function W2(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function Sm(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-ds(e),t[e]=n}function tz(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var r=t.eventTimes;for(t=t.expirationTimes;0<n;){var i=31-ds(n),s=1<<i;e[i]=0,r[i]=-1,t[i]=-1,n&=~s}}function j3(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var r=31-ds(n),i=1<<r;i&e|t[r]&e&&(t[r]|=e),n&=~i}}var wt=0;function MP(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var PP,X3,LP,RP,OP,NE=!1,d1=[],Ka=null,qa=null,Ja=null,bp=new Map,_p=new Map,Aa=[],nz="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function T6(t,e){switch(t){case"focusin":case"focusout":Ka=null;break;case"dragenter":case"dragleave":qa=null;break;case"mouseover":case"mouseout":Ja=null;break;case"pointerover":case"pointerout":bp.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":_p.delete(e.pointerId)}}function kh(t,e,n,r,i,s){return t===null||t.nativeEvent!==s?(t={blockedOn:e,domEventName:n,eventSystemFlags:r,nativeEvent:s,targetContainers:[i]},e!==null&&(e=Im(e),e!==null&&X3(e)),t):(t.eventSystemFlags|=r,e=t.targetContainers,i!==null&&e.indexOf(i)===-1&&e.push(i),t)}function rz(t,e,n,r,i){switch(e){case"focusin":return Ka=kh(Ka,t,e,n,r,i),!0;case"dragenter":return qa=kh(qa,t,e,n,r,i),!0;case"mouseover":return Ja=kh(Ja,t,e,n,r,i),!0;case"pointerover":var s=i.pointerId;return bp.set(s,kh(bp.get(s)||null,t,e,n,r,i)),!0;case"gotpointercapture":return s=i.pointerId,_p.set(s,kh(_p.get(s)||null,t,e,n,r,i)),!0}return!1}function DP(t){var e=dc(t.target);if(e!==null){var n=lu(e);if(n!==null){if(e=n.tag,e===13){if(e=xP(n),e!==null){t.blockedOn=e,OP(t.priority,function(){LP(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function Ig(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=FE(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var r=new n.constructor(n.type,n);PE=r,n.target.dispatchEvent(r),PE=null}else return e=Im(n),e!==null&&X3(e),t.blockedOn=n,!1;e.shift()}return!0}function S6(t,e,n){Ig(t)&&n.delete(e)}function iz(){NE=!1,Ka!==null&&Ig(Ka)&&(Ka=null),qa!==null&&Ig(qa)&&(qa=null),Ja!==null&&Ig(Ja)&&(Ja=null),bp.forEach(S6),_p.forEach(S6)}function Mh(t,e){t.blockedOn===e&&(t.blockedOn=null,NE||(NE=!0,fi.unstable_scheduleCallback(fi.unstable_NormalPriority,iz)))}function Ep(t){function e(i){return Mh(i,t)}if(0<d1.length){Mh(d1[0],t);for(var n=1;n<d1.length;n++){var r=d1[n];r.blockedOn===t&&(r.blockedOn=null)}}for(Ka!==null&&Mh(Ka,t),qa!==null&&Mh(qa,t),Ja!==null&&Mh(Ja,t),bp.forEach(e),_p.forEach(e),n=0;n<Aa.length;n++)r=Aa[n],r.blockedOn===t&&(r.blockedOn=null);for(;0<Aa.length&&(n=Aa[0],n.blockedOn===null);)DP(n),n.blockedOn===null&&Aa.shift()}var md=la.ReactCurrentBatchConfig,I0=!0;function sz(t,e,n,r){var i=wt,s=md.transition;md.transition=null;try{wt=1,Y3(t,e,n,r)}finally{wt=i,md.transition=s}}function oz(t,e,n,r){var i=wt,s=md.transition;md.transition=null;try{wt=4,Y3(t,e,n,r)}finally{wt=i,md.transition=s}}function Y3(t,e,n,r){if(I0){var i=FE(t,e,n,r);if(i===null)tb(t,e,r,A0,n),T6(t,r);else if(rz(i,t,e,n,r))r.stopPropagation();else if(T6(t,r),e&4&&-1<nz.indexOf(t)){for(;i!==null;){var s=Im(i);if(s!==null&&PP(s),s=FE(t,e,n,r),s===null&&tb(t,e,r,A0,n),s===i)break;i=s}i!==null&&r.stopPropagation()}else tb(t,e,r,null,n)}}var A0=null;function FE(t,e,n,r){if(A0=null,t=V3(r),t=dc(t),t!==null)if(e=lu(t),e===null)t=null;else if(n=e.tag,n===13){if(t=xP(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return A0=t,null}function NP(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(XH()){case W3:return 1;case IP:return 4;case S0:case YH:return 16;case AP:return 536870912;default:return 16}default:return 16}}var Fa=null,Z3=null,Ag=null;function FP(){if(Ag)return Ag;var t,e=Z3,n=e.length,r,i="value"in Fa?Fa.value:Fa.textContent,s=i.length;for(t=0;t<n&&e[t]===i[t];t++);var o=n-t;for(r=1;r<=o&&e[n-r]===i[s-r];r++);return Ag=i.slice(t,1<r?1-r:void 0)}function kg(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function h1(){return!0}function C6(){return!1}function mi(t){function e(n,r,i,s,o){this._reactName=n,this._targetInst=i,this.type=r,this.nativeEvent=s,this.target=o,this.currentTarget=null;for(var a in t)t.hasOwnProperty(a)&&(n=t[a],this[a]=n?n(s):s[a]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?h1:C6,this.isPropagationStopped=C6,this}return sn(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=h1)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=h1)},persist:function(){},isPersistent:h1}),e}var ih={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},K3=mi(ih),Cm=sn({},ih,{view:0,detail:0}),az=mi(Cm),j2,X2,Ph,pv=sn({},Cm,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:q3,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==Ph&&(Ph&&t.type==="mousemove"?(j2=t.screenX-Ph.screenX,X2=t.screenY-Ph.screenY):X2=j2=0,Ph=t),j2)},movementY:function(t){return"movementY"in t?t.movementY:X2}}),I6=mi(pv),lz=sn({},pv,{dataTransfer:0}),cz=mi(lz),uz=sn({},Cm,{relatedTarget:0}),Y2=mi(uz),dz=sn({},ih,{animationName:0,elapsedTime:0,pseudoElement:0}),hz=mi(dz),fz=sn({},ih,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),pz=mi(fz),mz=sn({},ih,{data:0}),A6=mi(mz),gz={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},yz={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},vz={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function bz(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=vz[t])?!!e[t]:!1}function q3(){return bz}var _z=sn({},Cm,{key:function(t){if(t.key){var e=gz[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=kg(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?yz[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:q3,charCode:function(t){return t.type==="keypress"?kg(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?kg(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),Ez=mi(_z),wz=sn({},pv,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),k6=mi(wz),xz=sn({},Cm,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:q3}),Tz=mi(xz),Sz=sn({},ih,{propertyName:0,elapsedTime:0,pseudoElement:0}),Cz=mi(Sz),Iz=sn({},pv,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),Az=mi(Iz),kz=[9,13,27,32],J3=Zo&&"CompositionEvent"in window,Ff=null;Zo&&"documentMode"in document&&(Ff=document.documentMode);var Mz=Zo&&"TextEvent"in window&&!Ff,BP=Zo&&(!J3||Ff&&8<Ff&&11>=Ff),M6=" ",P6=!1;function UP(t,e){switch(t){case"keyup":return kz.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function $P(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var ju=!1;function Pz(t,e){switch(t){case"compositionend":return $P(e);case"keypress":return e.which!==32?null:(P6=!0,M6);case"textInput":return t=e.data,t===M6&&P6?null:t;default:return null}}function Lz(t,e){if(ju)return t==="compositionend"||!J3&&UP(t,e)?(t=FP(),Ag=Z3=Fa=null,ju=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return BP&&e.locale!=="ko"?null:e.data;default:return null}}var Rz={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function L6(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!Rz[t.type]:e==="textarea"}function HP(t,e,n,r){vP(r),e=k0(e,"onChange"),0<e.length&&(n=new K3("onChange","change",null,n,r),t.push({event:n,listeners:e}))}var Bf=null,wp=null;function Oz(t){JP(t,0)}function mv(t){var e=Zu(t);if(dP(e))return t}function Dz(t,e){if(t==="change")return e}var zP=!1;if(Zo){var Z2;if(Zo){var K2="oninput"in document;if(!K2){var R6=document.createElement("div");R6.setAttribute("oninput","return;"),K2=typeof R6.oninput=="function"}Z2=K2}else Z2=!1;zP=Z2&&(!document.documentMode||9<document.documentMode)}function O6(){Bf&&(Bf.detachEvent("onpropertychange",GP),wp=Bf=null)}function GP(t){if(t.propertyName==="value"&&mv(wp)){var e=[];HP(e,wp,t,V3(t)),wP(Oz,e)}}function Nz(t,e,n){t==="focusin"?(O6(),Bf=e,wp=n,Bf.attachEvent("onpropertychange",GP)):t==="focusout"&&O6()}function Fz(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return mv(wp)}function Bz(t,e){if(t==="click")return mv(e)}function Uz(t,e){if(t==="input"||t==="change")return mv(e)}function $z(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var bs=typeof Object.is=="function"?Object.is:$z;function xp(t,e){if(bs(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var i=n[r];if(!bE.call(e,i)||!bs(t[i],e[i]))return!1}return!0}function D6(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function N6(t,e){var n=D6(t);t=0;for(var r;n;){if(n.nodeType===3){if(r=t+n.textContent.length,t<=e&&r>=e)return{node:n,offset:e-t};t=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=D6(n)}}function VP(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?VP(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function WP(){for(var t=window,e=w0();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=w0(t.document)}return e}function Q3(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function Hz(t){var e=WP(),n=t.focusedElem,r=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&VP(n.ownerDocument.documentElement,n)){if(r!==null&&Q3(n)){if(e=r.start,t=r.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var i=n.textContent.length,s=Math.min(r.start,i);r=r.end===void 0?s:Math.min(r.end,i),!t.extend&&s>r&&(i=r,r=s,s=i),i=N6(n,s);var o=N6(n,r);i&&o&&(t.rangeCount!==1||t.anchorNode!==i.node||t.anchorOffset!==i.offset||t.focusNode!==o.node||t.focusOffset!==o.offset)&&(e=e.createRange(),e.setStart(i.node,i.offset),t.removeAllRanges(),s>r?(t.addRange(e),t.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var zz=Zo&&"documentMode"in document&&11>=document.documentMode,Xu=null,BE=null,Uf=null,UE=!1;function F6(t,e,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;UE||Xu==null||Xu!==w0(r)||(r=Xu,"selectionStart"in r&&Q3(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),Uf&&xp(Uf,r)||(Uf=r,r=k0(BE,"onSelect"),0<r.length&&(e=new K3("onSelect","select",null,e,n),t.push({event:e,listeners:r}),e.target=Xu)))}function f1(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var Yu={animationend:f1("Animation","AnimationEnd"),animationiteration:f1("Animation","AnimationIteration"),animationstart:f1("Animation","AnimationStart"),transitionend:f1("Transition","TransitionEnd")},q2={},jP={};Zo&&(jP=document.createElement("div").style,"AnimationEvent"in window||(delete Yu.animationend.animation,delete Yu.animationiteration.animation,delete Yu.animationstart.animation),"TransitionEvent"in window||delete Yu.transitionend.transition);function gv(t){if(q2[t])return q2[t];if(!Yu[t])return t;var e=Yu[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in jP)return q2[t]=e[n];return t}var XP=gv("animationend"),YP=gv("animationiteration"),ZP=gv("animationstart"),KP=gv("transitionend"),qP=new Map,B6="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Cl(t,e){qP.set(t,e),au(e,[t])}for(var J2=0;J2<B6.length;J2++){var Q2=B6[J2],Gz=Q2.toLowerCase(),Vz=Q2[0].toUpperCase()+Q2.slice(1);Cl(Gz,"on"+Vz)}Cl(XP,"onAnimationEnd");Cl(YP,"onAnimationIteration");Cl(ZP,"onAnimationStart");Cl("dblclick","onDoubleClick");Cl("focusin","onFocus");Cl("focusout","onBlur");Cl(KP,"onTransitionEnd");Dd("onMouseEnter",["mouseout","mouseover"]);Dd("onMouseLeave",["mouseout","mouseover"]);Dd("onPointerEnter",["pointerout","pointerover"]);Dd("onPointerLeave",["pointerout","pointerover"]);au("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));au("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));au("onBeforeInput",["compositionend","keypress","textInput","paste"]);au("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));au("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));au("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var gf="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Wz=new Set("cancel close invalid load scroll toggle".split(" ").concat(gf));function U6(t,e,n){var r=t.type||"unknown-event";t.currentTarget=n,GH(r,e,void 0,t),t.currentTarget=null}function JP(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var r=t[n],i=r.event;r=r.listeners;e:{var s=void 0;if(e)for(var o=r.length-1;0<=o;o--){var a=r[o],l=a.instance,c=a.currentTarget;if(a=a.listener,l!==s&&i.isPropagationStopped())break e;U6(i,a,c),s=l}else for(o=0;o<r.length;o++){if(a=r[o],l=a.instance,c=a.currentTarget,a=a.listener,l!==s&&i.isPropagationStopped())break e;U6(i,a,c),s=l}}}if(T0)throw t=OE,T0=!1,OE=null,t}function Dt(t,e){var n=e[VE];n===void 0&&(n=e[VE]=new Set);var r=t+"__bubble";n.has(r)||(QP(e,t,2,!1),n.add(r))}function eb(t,e,n){var r=0;e&&(r|=4),QP(n,t,r,e)}var p1="_reactListening"+Math.random().toString(36).slice(2);function Tp(t){if(!t[p1]){t[p1]=!0,oP.forEach(function(n){n!=="selectionchange"&&(Wz.has(n)||eb(n,!1,t),eb(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[p1]||(e[p1]=!0,eb("selectionchange",!1,e))}}function QP(t,e,n,r){switch(NP(e)){case 1:var i=sz;break;case 4:i=oz;break;default:i=Y3}n=i.bind(null,e,n,t),i=void 0,!RE||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(i=!0),r?i!==void 0?t.addEventListener(e,n,{capture:!0,passive:i}):t.addEventListener(e,n,!0):i!==void 0?t.addEventListener(e,n,{passive:i}):t.addEventListener(e,n,!1)}function tb(t,e,n,r,i){var s=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var o=r.tag;if(o===3||o===4){var a=r.stateNode.containerInfo;if(a===i||a.nodeType===8&&a.parentNode===i)break;if(o===4)for(o=r.return;o!==null;){var l=o.tag;if((l===3||l===4)&&(l=o.stateNode.containerInfo,l===i||l.nodeType===8&&l.parentNode===i))return;o=o.return}for(;a!==null;){if(o=dc(a),o===null)return;if(l=o.tag,l===5||l===6){r=s=o;continue e}a=a.parentNode}}r=r.return}wP(function(){var c=s,u=V3(n),d=[];e:{var h=qP.get(t);if(h!==void 0){var f=K3,p=t;switch(t){case"keypress":if(kg(n)===0)break e;case"keydown":case"keyup":f=Ez;break;case"focusin":p="focus",f=Y2;break;case"focusout":p="blur",f=Y2;break;case"beforeblur":case"afterblur":f=Y2;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":f=I6;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":f=cz;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":f=Tz;break;case XP:case YP:case ZP:f=hz;break;case KP:f=Cz;break;case"scroll":f=az;break;case"wheel":f=Az;break;case"copy":case"cut":case"paste":f=pz;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":f=k6}var m=(e&4)!==0,v=!m&&t==="scroll",y=m?h!==null?h+"Capture":null:h;m=[];for(var b=c,_;b!==null;){_=b;var E=_.stateNode;if(_.tag===5&&E!==null&&(_=E,y!==null&&(E=vp(b,y),E!=null&&m.push(Sp(b,E,_)))),v)break;b=b.return}0<m.length&&(h=new f(h,p,null,n,u),d.push({event:h,listeners:m}))}}if(!(e&7)){e:{if(h=t==="mouseover"||t==="pointerover",f=t==="mouseout"||t==="pointerout",h&&n!==PE&&(p=n.relatedTarget||n.fromElement)&&(dc(p)||p[Ko]))break e;if((f||h)&&(h=u.window===u?u:(h=u.ownerDocument)?h.defaultView||h.parentWindow:window,f?(p=n.relatedTarget||n.toElement,f=c,p=p?dc(p):null,p!==null&&(v=lu(p),p!==v||p.tag!==5&&p.tag!==6)&&(p=null)):(f=null,p=c),f!==p)){if(m=I6,E="onMouseLeave",y="onMouseEnter",b="mouse",(t==="pointerout"||t==="pointerover")&&(m=k6,E="onPointerLeave",y="onPointerEnter",b="pointer"),v=f==null?h:Zu(f),_=p==null?h:Zu(p),h=new m(E,b+"leave",f,n,u),h.target=v,h.relatedTarget=_,E=null,dc(u)===c&&(m=new m(y,b+"enter",p,n,u),m.target=_,m.relatedTarget=v,E=m),v=E,f&&p)t:{for(m=f,y=p,b=0,_=m;_;_=yu(_))b++;for(_=0,E=y;E;E=yu(E))_++;for(;0<b-_;)m=yu(m),b--;for(;0<_-b;)y=yu(y),_--;for(;b--;){if(m===y||y!==null&&m===y.alternate)break t;m=yu(m),y=yu(y)}m=null}else m=null;f!==null&&$6(d,h,f,m,!1),p!==null&&v!==null&&$6(d,v,p,m,!0)}}e:{if(h=c?Zu(c):window,f=h.nodeName&&h.nodeName.toLowerCase(),f==="select"||f==="input"&&h.type==="file")var w=Dz;else if(L6(h))if(zP)w=Uz;else{w=Fz;var x=Nz}else(f=h.nodeName)&&f.toLowerCase()==="input"&&(h.type==="checkbox"||h.type==="radio")&&(w=Bz);if(w&&(w=w(t,c))){HP(d,w,n,u);break e}x&&x(t,h,c),t==="focusout"&&(x=h._wrapperState)&&x.controlled&&h.type==="number"&&CE(h,"number",h.value)}switch(x=c?Zu(c):window,t){case"focusin":(L6(x)||x.contentEditable==="true")&&(Xu=x,BE=c,Uf=null);break;case"focusout":Uf=BE=Xu=null;break;case"mousedown":UE=!0;break;case"contextmenu":case"mouseup":case"dragend":UE=!1,F6(d,n,u);break;case"selectionchange":if(zz)break;case"keydown":case"keyup":F6(d,n,u)}var T;if(J3)e:{switch(t){case"compositionstart":var C="onCompositionStart";break e;case"compositionend":C="onCompositionEnd";break e;case"compositionupdate":C="onCompositionUpdate";break e}C=void 0}else ju?UP(t,n)&&(C="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(C="onCompositionStart");C&&(BP&&n.locale!=="ko"&&(ju||C!=="onCompositionStart"?C==="onCompositionEnd"&&ju&&(T=FP()):(Fa=u,Z3="value"in Fa?Fa.value:Fa.textContent,ju=!0)),x=k0(c,C),0<x.length&&(C=new A6(C,t,null,n,u),d.push({event:C,listeners:x}),T?C.data=T:(T=$P(n),T!==null&&(C.data=T)))),(T=Mz?Pz(t,n):Lz(t,n))&&(c=k0(c,"onBeforeInput"),0<c.length&&(u=new A6("onBeforeInput","beforeinput",null,n,u),d.push({event:u,listeners:c}),u.data=T))}JP(d,e)})}function Sp(t,e,n){return{instance:t,listener:e,currentTarget:n}}function k0(t,e){for(var n=e+"Capture",r=[];t!==null;){var i=t,s=i.stateNode;i.tag===5&&s!==null&&(i=s,s=vp(t,n),s!=null&&r.unshift(Sp(t,s,i)),s=vp(t,e),s!=null&&r.push(Sp(t,s,i))),t=t.return}return r}function yu(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function $6(t,e,n,r,i){for(var s=e._reactName,o=[];n!==null&&n!==r;){var a=n,l=a.alternate,c=a.stateNode;if(l!==null&&l===r)break;a.tag===5&&c!==null&&(a=c,i?(l=vp(n,s),l!=null&&o.unshift(Sp(n,l,a))):i||(l=vp(n,s),l!=null&&o.push(Sp(n,l,a)))),n=n.return}o.length!==0&&t.push({event:e,listeners:o})}var jz=/\r\n?/g,Xz=/\u0000|\uFFFD/g;function H6(t){return(typeof t=="string"?t:""+t).replace(jz,`
`).replace(Xz,"")}function m1(t,e,n){if(e=H6(e),H6(t)!==e&&n)throw Error(oe(425))}function M0(){}var $E=null,HE=null;function zE(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var GE=typeof setTimeout=="function"?setTimeout:void 0,Yz=typeof clearTimeout=="function"?clearTimeout:void 0,z6=typeof Promise=="function"?Promise:void 0,Zz=typeof queueMicrotask=="function"?queueMicrotask:typeof z6<"u"?function(t){return z6.resolve(null).then(t).catch(Kz)}:GE;function Kz(t){setTimeout(function(){throw t})}function nb(t,e){var n=e,r=0;do{var i=n.nextSibling;if(t.removeChild(n),i&&i.nodeType===8)if(n=i.data,n==="/$"){if(r===0){t.removeChild(i),Ep(e);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=i}while(n);Ep(e)}function Qa(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function G6(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var sh=Math.random().toString(36).slice(2),Js="__reactFiber$"+sh,Cp="__reactProps$"+sh,Ko="__reactContainer$"+sh,VE="__reactEvents$"+sh,qz="__reactListeners$"+sh,Jz="__reactHandles$"+sh;function dc(t){var e=t[Js];if(e)return e;for(var n=t.parentNode;n;){if(e=n[Ko]||n[Js]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=G6(t);t!==null;){if(n=t[Js])return n;t=G6(t)}return e}t=n,n=t.parentNode}return null}function Im(t){return t=t[Js]||t[Ko],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function Zu(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(oe(33))}function yv(t){return t[Cp]||null}var WE=[],Ku=-1;function Il(t){return{current:t}}function $t(t){0>Ku||(t.current=WE[Ku],WE[Ku]=null,Ku--)}function Lt(t,e){Ku++,WE[Ku]=t.current,t.current=e}var hl={},yr=Il(hl),jr=Il(!1),Dc=hl;function Nd(t,e){var n=t.type.contextTypes;if(!n)return hl;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var i={},s;for(s in n)i[s]=e[s];return r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=i),i}function Xr(t){return t=t.childContextTypes,t!=null}function P0(){$t(jr),$t(yr)}function V6(t,e,n){if(yr.current!==hl)throw Error(oe(168));Lt(yr,e),Lt(jr,n)}function eL(t,e,n){var r=t.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var i in r)if(!(i in e))throw Error(oe(108,NH(t)||"Unknown",i));return sn({},n,r)}function L0(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||hl,Dc=yr.current,Lt(yr,t),Lt(jr,jr.current),!0}function W6(t,e,n){var r=t.stateNode;if(!r)throw Error(oe(169));n?(t=eL(t,e,Dc),r.__reactInternalMemoizedMergedChildContext=t,$t(jr),$t(yr),Lt(yr,t)):$t(jr),Lt(jr,n)}var Po=null,vv=!1,rb=!1;function tL(t){Po===null?Po=[t]:Po.push(t)}function Qz(t){vv=!0,tL(t)}function Al(){if(!rb&&Po!==null){rb=!0;var t=0,e=wt;try{var n=Po;for(wt=1;t<n.length;t++){var r=n[t];do r=r(!0);while(r!==null)}Po=null,vv=!1}catch(i){throw Po!==null&&(Po=Po.slice(t+1)),CP(W3,Al),i}finally{wt=e,rb=!1}}return null}var qu=[],Ju=0,R0=null,O0=0,Ei=[],wi=0,Nc=null,Oo=1,Do="";function Hl(t,e){qu[Ju++]=O0,qu[Ju++]=R0,R0=t,O0=e}function nL(t,e,n){Ei[wi++]=Oo,Ei[wi++]=Do,Ei[wi++]=Nc,Nc=t;var r=Oo;t=Do;var i=32-ds(r)-1;r&=~(1<<i),n+=1;var s=32-ds(e)+i;if(30<s){var o=i-i%5;s=(r&(1<<o)-1).toString(32),r>>=o,i-=o,Oo=1<<32-ds(e)+i|n<<i|r,Do=s+t}else Oo=1<<s|n<<i|r,Do=t}function eT(t){t.return!==null&&(Hl(t,1),nL(t,1,0))}function tT(t){for(;t===R0;)R0=qu[--Ju],qu[Ju]=null,O0=qu[--Ju],qu[Ju]=null;for(;t===Nc;)Nc=Ei[--wi],Ei[wi]=null,Do=Ei[--wi],Ei[wi]=null,Oo=Ei[--wi],Ei[wi]=null}var di=null,oi=null,Xt=!1,ns=null;function rL(t,e){var n=xi(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function j6(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,di=t,oi=Qa(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,di=t,oi=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=Nc!==null?{id:Oo,overflow:Do}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=xi(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,di=t,oi=null,!0):!1;default:return!1}}function jE(t){return(t.mode&1)!==0&&(t.flags&128)===0}function XE(t){if(Xt){var e=oi;if(e){var n=e;if(!j6(t,e)){if(jE(t))throw Error(oe(418));e=Qa(n.nextSibling);var r=di;e&&j6(t,e)?rL(r,n):(t.flags=t.flags&-4097|2,Xt=!1,di=t)}}else{if(jE(t))throw Error(oe(418));t.flags=t.flags&-4097|2,Xt=!1,di=t}}}function X6(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;di=t}function g1(t){if(t!==di)return!1;if(!Xt)return X6(t),Xt=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!zE(t.type,t.memoizedProps)),e&&(e=oi)){if(jE(t))throw iL(),Error(oe(418));for(;e;)rL(t,e),e=Qa(e.nextSibling)}if(X6(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(oe(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){oi=Qa(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}oi=null}}else oi=di?Qa(t.stateNode.nextSibling):null;return!0}function iL(){for(var t=oi;t;)t=Qa(t.nextSibling)}function Fd(){oi=di=null,Xt=!1}function nT(t){ns===null?ns=[t]:ns.push(t)}var eG=la.ReactCurrentBatchConfig;function Ji(t,e){if(t&&t.defaultProps){e=sn({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}var D0=Il(null),N0=null,Qu=null,rT=null;function iT(){rT=Qu=N0=null}function sT(t){var e=D0.current;$t(D0),t._currentValue=e}function YE(t,e,n){for(;t!==null;){var r=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),t===n)break;t=t.return}}function gd(t,e){N0=t,rT=Qu=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(Hr=!0),t.firstContext=null)}function Ri(t){var e=t._currentValue;if(rT!==t)if(t={context:t,memoizedValue:e,next:null},Qu===null){if(N0===null)throw Error(oe(308));Qu=t,N0.dependencies={lanes:0,firstContext:t}}else Qu=Qu.next=t;return e}var hc=null;function oT(t){hc===null?hc=[t]:hc.push(t)}function sL(t,e,n,r){var i=e.interleaved;return i===null?(n.next=n,oT(e)):(n.next=i.next,i.next=n),e.interleaved=n,qo(t,r)}function qo(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var Sa=!1;function aT(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function oL(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function $o(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function el(t,e,n){var r=t.updateQueue;if(r===null)return null;if(r=r.shared,dt&2){var i=r.pending;return i===null?e.next=e:(e.next=i.next,i.next=e),r.pending=e,qo(t,n)}return i=r.interleaved,i===null?(e.next=e,oT(r)):(e.next=i.next,i.next=e),r.interleaved=e,qo(t,n)}function Mg(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,j3(t,n)}}function Y6(t,e){var n=t.updateQueue,r=t.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var i=null,s=null;if(n=n.firstBaseUpdate,n!==null){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};s===null?i=s=o:s=s.next=o,n=n.next}while(n!==null);s===null?i=s=e:s=s.next=e}else i=s=e;n={baseState:r.baseState,firstBaseUpdate:i,lastBaseUpdate:s,shared:r.shared,effects:r.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function F0(t,e,n,r){var i=t.updateQueue;Sa=!1;var s=i.firstBaseUpdate,o=i.lastBaseUpdate,a=i.shared.pending;if(a!==null){i.shared.pending=null;var l=a,c=l.next;l.next=null,o===null?s=c:o.next=c,o=l;var u=t.alternate;u!==null&&(u=u.updateQueue,a=u.lastBaseUpdate,a!==o&&(a===null?u.firstBaseUpdate=c:a.next=c,u.lastBaseUpdate=l))}if(s!==null){var d=i.baseState;o=0,u=c=l=null,a=s;do{var h=a.lane,f=a.eventTime;if((r&h)===h){u!==null&&(u=u.next={eventTime:f,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var p=t,m=a;switch(h=e,f=n,m.tag){case 1:if(p=m.payload,typeof p=="function"){d=p.call(f,d,h);break e}d=p;break e;case 3:p.flags=p.flags&-65537|128;case 0:if(p=m.payload,h=typeof p=="function"?p.call(f,d,h):p,h==null)break e;d=sn({},d,h);break e;case 2:Sa=!0}}a.callback!==null&&a.lane!==0&&(t.flags|=64,h=i.effects,h===null?i.effects=[a]:h.push(a))}else f={eventTime:f,lane:h,tag:a.tag,payload:a.payload,callback:a.callback,next:null},u===null?(c=u=f,l=d):u=u.next=f,o|=h;if(a=a.next,a===null){if(a=i.shared.pending,a===null)break;h=a,a=h.next,h.next=null,i.lastBaseUpdate=h,i.shared.pending=null}}while(!0);if(u===null&&(l=d),i.baseState=l,i.firstBaseUpdate=c,i.lastBaseUpdate=u,e=i.shared.interleaved,e!==null){i=e;do o|=i.lane,i=i.next;while(i!==e)}else s===null&&(i.shared.lanes=0);Bc|=o,t.lanes=o,t.memoizedState=d}}function Z6(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var r=t[e],i=r.callback;if(i!==null){if(r.callback=null,r=n,typeof i!="function")throw Error(oe(191,i));i.call(r)}}}var aL=new sP.Component().refs;function ZE(t,e,n,r){e=t.memoizedState,n=n(r,e),n=n==null?e:sn({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var bv={isMounted:function(t){return(t=t._reactInternals)?lu(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var r=Rr(),i=nl(t),s=$o(r,i);s.payload=e,n!=null&&(s.callback=n),e=el(t,s,i),e!==null&&(hs(e,t,i,r),Mg(e,t,i))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var r=Rr(),i=nl(t),s=$o(r,i);s.tag=1,s.payload=e,n!=null&&(s.callback=n),e=el(t,s,i),e!==null&&(hs(e,t,i,r),Mg(e,t,i))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=Rr(),r=nl(t),i=$o(n,r);i.tag=2,e!=null&&(i.callback=e),e=el(t,i,r),e!==null&&(hs(e,t,r,n),Mg(e,t,r))}};function K6(t,e,n,r,i,s,o){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(r,s,o):e.prototype&&e.prototype.isPureReactComponent?!xp(n,r)||!xp(i,s):!0}function lL(t,e,n){var r=!1,i=hl,s=e.contextType;return typeof s=="object"&&s!==null?s=Ri(s):(i=Xr(e)?Dc:yr.current,r=e.contextTypes,s=(r=r!=null)?Nd(t,i):hl),e=new e(n,s),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=bv,t.stateNode=e,e._reactInternals=t,r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=i,t.__reactInternalMemoizedMaskedChildContext=s),e}function q6(t,e,n,r){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,r),e.state!==t&&bv.enqueueReplaceState(e,e.state,null)}function KE(t,e,n,r){var i=t.stateNode;i.props=n,i.state=t.memoizedState,i.refs=aL,aT(t);var s=e.contextType;typeof s=="object"&&s!==null?i.context=Ri(s):(s=Xr(e)?Dc:yr.current,i.context=Nd(t,s)),i.state=t.memoizedState,s=e.getDerivedStateFromProps,typeof s=="function"&&(ZE(t,e,s,n),i.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(e=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),e!==i.state&&bv.enqueueReplaceState(i,i.state,null),F0(t,n,i,r),i.state=t.memoizedState),typeof i.componentDidMount=="function"&&(t.flags|=4194308)}function Lh(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(oe(309));var r=n.stateNode}if(!r)throw Error(oe(147,t));var i=r,s=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===s?e.ref:(e=function(o){var a=i.refs;a===aL&&(a=i.refs={}),o===null?delete a[s]:a[s]=o},e._stringRef=s,e)}if(typeof t!="string")throw Error(oe(284));if(!n._owner)throw Error(oe(290,t))}return t}function y1(t,e){throw t=Object.prototype.toString.call(e),Error(oe(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function J6(t){var e=t._init;return e(t._payload)}function cL(t){function e(y,b){if(t){var _=y.deletions;_===null?(y.deletions=[b],y.flags|=16):_.push(b)}}function n(y,b){if(!t)return null;for(;b!==null;)e(y,b),b=b.sibling;return null}function r(y,b){for(y=new Map;b!==null;)b.key!==null?y.set(b.key,b):y.set(b.index,b),b=b.sibling;return y}function i(y,b){return y=rl(y,b),y.index=0,y.sibling=null,y}function s(y,b,_){return y.index=_,t?(_=y.alternate,_!==null?(_=_.index,_<b?(y.flags|=2,b):_):(y.flags|=2,b)):(y.flags|=1048576,b)}function o(y){return t&&y.alternate===null&&(y.flags|=2),y}function a(y,b,_,E){return b===null||b.tag!==6?(b=ub(_,y.mode,E),b.return=y,b):(b=i(b,_),b.return=y,b)}function l(y,b,_,E){var w=_.type;return w===Wu?u(y,b,_.props.children,E,_.key):b!==null&&(b.elementType===w||typeof w=="object"&&w!==null&&w.$$typeof===Ta&&J6(w)===b.type)?(E=i(b,_.props),E.ref=Lh(y,b,_),E.return=y,E):(E=Ng(_.type,_.key,_.props,null,y.mode,E),E.ref=Lh(y,b,_),E.return=y,E)}function c(y,b,_,E){return b===null||b.tag!==4||b.stateNode.containerInfo!==_.containerInfo||b.stateNode.implementation!==_.implementation?(b=db(_,y.mode,E),b.return=y,b):(b=i(b,_.children||[]),b.return=y,b)}function u(y,b,_,E,w){return b===null||b.tag!==7?(b=Ac(_,y.mode,E,w),b.return=y,b):(b=i(b,_),b.return=y,b)}function d(y,b,_){if(typeof b=="string"&&b!==""||typeof b=="number")return b=ub(""+b,y.mode,_),b.return=y,b;if(typeof b=="object"&&b!==null){switch(b.$$typeof){case o1:return _=Ng(b.type,b.key,b.props,null,y.mode,_),_.ref=Lh(y,null,b),_.return=y,_;case Vu:return b=db(b,y.mode,_),b.return=y,b;case Ta:var E=b._init;return d(y,E(b._payload),_)}if(pf(b)||Ih(b))return b=Ac(b,y.mode,_,null),b.return=y,b;y1(y,b)}return null}function h(y,b,_,E){var w=b!==null?b.key:null;if(typeof _=="string"&&_!==""||typeof _=="number")return w!==null?null:a(y,b,""+_,E);if(typeof _=="object"&&_!==null){switch(_.$$typeof){case o1:return _.key===w?l(y,b,_,E):null;case Vu:return _.key===w?c(y,b,_,E):null;case Ta:return w=_._init,h(y,b,w(_._payload),E)}if(pf(_)||Ih(_))return w!==null?null:u(y,b,_,E,null);y1(y,_)}return null}function f(y,b,_,E,w){if(typeof E=="string"&&E!==""||typeof E=="number")return y=y.get(_)||null,a(b,y,""+E,w);if(typeof E=="object"&&E!==null){switch(E.$$typeof){case o1:return y=y.get(E.key===null?_:E.key)||null,l(b,y,E,w);case Vu:return y=y.get(E.key===null?_:E.key)||null,c(b,y,E,w);case Ta:var x=E._init;return f(y,b,_,x(E._payload),w)}if(pf(E)||Ih(E))return y=y.get(_)||null,u(b,y,E,w,null);y1(b,E)}return null}function p(y,b,_,E){for(var w=null,x=null,T=b,C=b=0,k=null;T!==null&&C<_.length;C++){T.index>C?(k=T,T=null):k=T.sibling;var L=h(y,T,_[C],E);if(L===null){T===null&&(T=k);break}t&&T&&L.alternate===null&&e(y,T),b=s(L,b,C),x===null?w=L:x.sibling=L,x=L,T=k}if(C===_.length)return n(y,T),Xt&&Hl(y,C),w;if(T===null){for(;C<_.length;C++)T=d(y,_[C],E),T!==null&&(b=s(T,b,C),x===null?w=T:x.sibling=T,x=T);return Xt&&Hl(y,C),w}for(T=r(y,T);C<_.length;C++)k=f(T,y,C,_[C],E),k!==null&&(t&&k.alternate!==null&&T.delete(k.key===null?C:k.key),b=s(k,b,C),x===null?w=k:x.sibling=k,x=k);return t&&T.forEach(function(F){return e(y,F)}),Xt&&Hl(y,C),w}function m(y,b,_,E){var w=Ih(_);if(typeof w!="function")throw Error(oe(150));if(_=w.call(_),_==null)throw Error(oe(151));for(var x=w=null,T=b,C=b=0,k=null,L=_.next();T!==null&&!L.done;C++,L=_.next()){T.index>C?(k=T,T=null):k=T.sibling;var F=h(y,T,L.value,E);if(F===null){T===null&&(T=k);break}t&&T&&F.alternate===null&&e(y,T),b=s(F,b,C),x===null?w=F:x.sibling=F,x=F,T=k}if(L.done)return n(y,T),Xt&&Hl(y,C),w;if(T===null){for(;!L.done;C++,L=_.next())L=d(y,L.value,E),L!==null&&(b=s(L,b,C),x===null?w=L:x.sibling=L,x=L);return Xt&&Hl(y,C),w}for(T=r(y,T);!L.done;C++,L=_.next())L=f(T,y,C,L.value,E),L!==null&&(t&&L.alternate!==null&&T.delete(L.key===null?C:L.key),b=s(L,b,C),x===null?w=L:x.sibling=L,x=L);return t&&T.forEach(function(N){return e(y,N)}),Xt&&Hl(y,C),w}function v(y,b,_,E){if(typeof _=="object"&&_!==null&&_.type===Wu&&_.key===null&&(_=_.props.children),typeof _=="object"&&_!==null){switch(_.$$typeof){case o1:e:{for(var w=_.key,x=b;x!==null;){if(x.key===w){if(w=_.type,w===Wu){if(x.tag===7){n(y,x.sibling),b=i(x,_.props.children),b.return=y,y=b;break e}}else if(x.elementType===w||typeof w=="object"&&w!==null&&w.$$typeof===Ta&&J6(w)===x.type){n(y,x.sibling),b=i(x,_.props),b.ref=Lh(y,x,_),b.return=y,y=b;break e}n(y,x);break}else e(y,x);x=x.sibling}_.type===Wu?(b=Ac(_.props.children,y.mode,E,_.key),b.return=y,y=b):(E=Ng(_.type,_.key,_.props,null,y.mode,E),E.ref=Lh(y,b,_),E.return=y,y=E)}return o(y);case Vu:e:{for(x=_.key;b!==null;){if(b.key===x)if(b.tag===4&&b.stateNode.containerInfo===_.containerInfo&&b.stateNode.implementation===_.implementation){n(y,b.sibling),b=i(b,_.children||[]),b.return=y,y=b;break e}else{n(y,b);break}else e(y,b);b=b.sibling}b=db(_,y.mode,E),b.return=y,y=b}return o(y);case Ta:return x=_._init,v(y,b,x(_._payload),E)}if(pf(_))return p(y,b,_,E);if(Ih(_))return m(y,b,_,E);y1(y,_)}return typeof _=="string"&&_!==""||typeof _=="number"?(_=""+_,b!==null&&b.tag===6?(n(y,b.sibling),b=i(b,_),b.return=y,y=b):(n(y,b),b=ub(_,y.mode,E),b.return=y,y=b),o(y)):n(y,b)}return v}var Bd=cL(!0),uL=cL(!1),Am={},io=Il(Am),Ip=Il(Am),Ap=Il(Am);function fc(t){if(t===Am)throw Error(oe(174));return t}function lT(t,e){switch(Lt(Ap,e),Lt(Ip,t),Lt(io,Am),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:AE(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=AE(e,t)}$t(io),Lt(io,e)}function Ud(){$t(io),$t(Ip),$t(Ap)}function dL(t){fc(Ap.current);var e=fc(io.current),n=AE(e,t.type);e!==n&&(Lt(Ip,t),Lt(io,n))}function cT(t){Ip.current===t&&($t(io),$t(Ip))}var Qt=Il(0);function B0(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var ib=[];function uT(){for(var t=0;t<ib.length;t++)ib[t]._workInProgressVersionPrimary=null;ib.length=0}var Pg=la.ReactCurrentDispatcher,sb=la.ReactCurrentBatchConfig,Fc=0,rn=null,An=null,Hn=null,U0=!1,$f=!1,kp=0,tG=0;function sr(){throw Error(oe(321))}function dT(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!bs(t[n],e[n]))return!1;return!0}function hT(t,e,n,r,i,s){if(Fc=s,rn=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,Pg.current=t===null||t.memoizedState===null?sG:oG,t=n(r,i),$f){s=0;do{if($f=!1,kp=0,25<=s)throw Error(oe(301));s+=1,Hn=An=null,e.updateQueue=null,Pg.current=aG,t=n(r,i)}while($f)}if(Pg.current=$0,e=An!==null&&An.next!==null,Fc=0,Hn=An=rn=null,U0=!1,e)throw Error(oe(300));return t}function fT(){var t=kp!==0;return kp=0,t}function Hs(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Hn===null?rn.memoizedState=Hn=t:Hn=Hn.next=t,Hn}function Oi(){if(An===null){var t=rn.alternate;t=t!==null?t.memoizedState:null}else t=An.next;var e=Hn===null?rn.memoizedState:Hn.next;if(e!==null)Hn=e,An=t;else{if(t===null)throw Error(oe(310));An=t,t={memoizedState:An.memoizedState,baseState:An.baseState,baseQueue:An.baseQueue,queue:An.queue,next:null},Hn===null?rn.memoizedState=Hn=t:Hn=Hn.next=t}return Hn}function Mp(t,e){return typeof e=="function"?e(t):e}function ob(t){var e=Oi(),n=e.queue;if(n===null)throw Error(oe(311));n.lastRenderedReducer=t;var r=An,i=r.baseQueue,s=n.pending;if(s!==null){if(i!==null){var o=i.next;i.next=s.next,s.next=o}r.baseQueue=i=s,n.pending=null}if(i!==null){s=i.next,r=r.baseState;var a=o=null,l=null,c=s;do{var u=c.lane;if((Fc&u)===u)l!==null&&(l=l.next={lane:0,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null}),r=c.hasEagerState?c.eagerState:t(r,c.action);else{var d={lane:u,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null};l===null?(a=l=d,o=r):l=l.next=d,rn.lanes|=u,Bc|=u}c=c.next}while(c!==null&&c!==s);l===null?o=r:l.next=a,bs(r,e.memoizedState)||(Hr=!0),e.memoizedState=r,e.baseState=o,e.baseQueue=l,n.lastRenderedState=r}if(t=n.interleaved,t!==null){i=t;do s=i.lane,rn.lanes|=s,Bc|=s,i=i.next;while(i!==t)}else i===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function ab(t){var e=Oi(),n=e.queue;if(n===null)throw Error(oe(311));n.lastRenderedReducer=t;var r=n.dispatch,i=n.pending,s=e.memoizedState;if(i!==null){n.pending=null;var o=i=i.next;do s=t(s,o.action),o=o.next;while(o!==i);bs(s,e.memoizedState)||(Hr=!0),e.memoizedState=s,e.baseQueue===null&&(e.baseState=s),n.lastRenderedState=s}return[s,r]}function hL(){}function fL(t,e){var n=rn,r=Oi(),i=e(),s=!bs(r.memoizedState,i);if(s&&(r.memoizedState=i,Hr=!0),r=r.queue,pT(gL.bind(null,n,r,t),[t]),r.getSnapshot!==e||s||Hn!==null&&Hn.memoizedState.tag&1){if(n.flags|=2048,Pp(9,mL.bind(null,n,r,i,e),void 0,null),Wn===null)throw Error(oe(349));Fc&30||pL(n,e,i)}return i}function pL(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=rn.updateQueue,e===null?(e={lastEffect:null,stores:null},rn.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function mL(t,e,n,r){e.value=n,e.getSnapshot=r,yL(e)&&vL(t)}function gL(t,e,n){return n(function(){yL(e)&&vL(t)})}function yL(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!bs(t,n)}catch{return!0}}function vL(t){var e=qo(t,1);e!==null&&hs(e,t,1,-1)}function Q6(t){var e=Hs();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Mp,lastRenderedState:t},e.queue=t,t=t.dispatch=iG.bind(null,rn,t),[e.memoizedState,t]}function Pp(t,e,n,r){return t={tag:t,create:e,destroy:n,deps:r,next:null},e=rn.updateQueue,e===null?(e={lastEffect:null,stores:null},rn.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(r=n.next,n.next=t,t.next=r,e.lastEffect=t)),t}function bL(){return Oi().memoizedState}function Lg(t,e,n,r){var i=Hs();rn.flags|=t,i.memoizedState=Pp(1|e,n,void 0,r===void 0?null:r)}function _v(t,e,n,r){var i=Oi();r=r===void 0?null:r;var s=void 0;if(An!==null){var o=An.memoizedState;if(s=o.destroy,r!==null&&dT(r,o.deps)){i.memoizedState=Pp(e,n,s,r);return}}rn.flags|=t,i.memoizedState=Pp(1|e,n,s,r)}function eC(t,e){return Lg(8390656,8,t,e)}function pT(t,e){return _v(2048,8,t,e)}function _L(t,e){return _v(4,2,t,e)}function EL(t,e){return _v(4,4,t,e)}function wL(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function xL(t,e,n){return n=n!=null?n.concat([t]):null,_v(4,4,wL.bind(null,e,t),n)}function mT(){}function TL(t,e){var n=Oi();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&dT(e,r[1])?r[0]:(n.memoizedState=[t,e],t)}function SL(t,e){var n=Oi();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&dT(e,r[1])?r[0]:(t=t(),n.memoizedState=[t,e],t)}function CL(t,e,n){return Fc&21?(bs(n,e)||(n=kP(),rn.lanes|=n,Bc|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,Hr=!0),t.memoizedState=n)}function nG(t,e){var n=wt;wt=n!==0&&4>n?n:4,t(!0);var r=sb.transition;sb.transition={};try{t(!1),e()}finally{wt=n,sb.transition=r}}function IL(){return Oi().memoizedState}function rG(t,e,n){var r=nl(t);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},AL(t))kL(e,n);else if(n=sL(t,e,n,r),n!==null){var i=Rr();hs(n,t,r,i),ML(n,e,r)}}function iG(t,e,n){var r=nl(t),i={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(AL(t))kL(e,i);else{var s=t.alternate;if(t.lanes===0&&(s===null||s.lanes===0)&&(s=e.lastRenderedReducer,s!==null))try{var o=e.lastRenderedState,a=s(o,n);if(i.hasEagerState=!0,i.eagerState=a,bs(a,o)){var l=e.interleaved;l===null?(i.next=i,oT(e)):(i.next=l.next,l.next=i),e.interleaved=i;return}}catch{}finally{}n=sL(t,e,i,r),n!==null&&(i=Rr(),hs(n,t,r,i),ML(n,e,r))}}function AL(t){var e=t.alternate;return t===rn||e!==null&&e===rn}function kL(t,e){$f=U0=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function ML(t,e,n){if(n&4194240){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,j3(t,n)}}var $0={readContext:Ri,useCallback:sr,useContext:sr,useEffect:sr,useImperativeHandle:sr,useInsertionEffect:sr,useLayoutEffect:sr,useMemo:sr,useReducer:sr,useRef:sr,useState:sr,useDebugValue:sr,useDeferredValue:sr,useTransition:sr,useMutableSource:sr,useSyncExternalStore:sr,useId:sr,unstable_isNewReconciler:!1},sG={readContext:Ri,useCallback:function(t,e){return Hs().memoizedState=[t,e===void 0?null:e],t},useContext:Ri,useEffect:eC,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,Lg(4194308,4,wL.bind(null,e,t),n)},useLayoutEffect:function(t,e){return Lg(4194308,4,t,e)},useInsertionEffect:function(t,e){return Lg(4,2,t,e)},useMemo:function(t,e){var n=Hs();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var r=Hs();return e=n!==void 0?n(e):e,r.memoizedState=r.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},r.queue=t,t=t.dispatch=rG.bind(null,rn,t),[r.memoizedState,t]},useRef:function(t){var e=Hs();return t={current:t},e.memoizedState=t},useState:Q6,useDebugValue:mT,useDeferredValue:function(t){return Hs().memoizedState=t},useTransition:function(){var t=Q6(!1),e=t[0];return t=nG.bind(null,t[1]),Hs().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var r=rn,i=Hs();if(Xt){if(n===void 0)throw Error(oe(407));n=n()}else{if(n=e(),Wn===null)throw Error(oe(349));Fc&30||pL(r,e,n)}i.memoizedState=n;var s={value:n,getSnapshot:e};return i.queue=s,eC(gL.bind(null,r,s,t),[t]),r.flags|=2048,Pp(9,mL.bind(null,r,s,n,e),void 0,null),n},useId:function(){var t=Hs(),e=Wn.identifierPrefix;if(Xt){var n=Do,r=Oo;n=(r&~(1<<32-ds(r)-1)).toString(32)+n,e=":"+e+"R"+n,n=kp++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=tG++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},oG={readContext:Ri,useCallback:TL,useContext:Ri,useEffect:pT,useImperativeHandle:xL,useInsertionEffect:_L,useLayoutEffect:EL,useMemo:SL,useReducer:ob,useRef:bL,useState:function(){return ob(Mp)},useDebugValue:mT,useDeferredValue:function(t){var e=Oi();return CL(e,An.memoizedState,t)},useTransition:function(){var t=ob(Mp)[0],e=Oi().memoizedState;return[t,e]},useMutableSource:hL,useSyncExternalStore:fL,useId:IL,unstable_isNewReconciler:!1},aG={readContext:Ri,useCallback:TL,useContext:Ri,useEffect:pT,useImperativeHandle:xL,useInsertionEffect:_L,useLayoutEffect:EL,useMemo:SL,useReducer:ab,useRef:bL,useState:function(){return ab(Mp)},useDebugValue:mT,useDeferredValue:function(t){var e=Oi();return An===null?e.memoizedState=t:CL(e,An.memoizedState,t)},useTransition:function(){var t=ab(Mp)[0],e=Oi().memoizedState;return[t,e]},useMutableSource:hL,useSyncExternalStore:fL,useId:IL,unstable_isNewReconciler:!1};function $d(t,e){try{var n="",r=e;do n+=DH(r),r=r.return;while(r);var i=n}catch(s){i=`
Error generating stack: `+s.message+`
`+s.stack}return{value:t,source:e,stack:i,digest:null}}function lb(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function qE(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var lG=typeof WeakMap=="function"?WeakMap:Map;function PL(t,e,n){n=$o(-1,n),n.tag=3,n.payload={element:null};var r=e.value;return n.callback=function(){z0||(z0=!0,aw=r),qE(t,e)},n}function LL(t,e,n){n=$o(-1,n),n.tag=3;var r=t.type.getDerivedStateFromError;if(typeof r=="function"){var i=e.value;n.payload=function(){return r(i)},n.callback=function(){qE(t,e)}}var s=t.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(n.callback=function(){qE(t,e),typeof r!="function"&&(tl===null?tl=new Set([this]):tl.add(this));var o=e.stack;this.componentDidCatch(e.value,{componentStack:o!==null?o:""})}),n}function tC(t,e,n){var r=t.pingCache;if(r===null){r=t.pingCache=new lG;var i=new Set;r.set(e,i)}else i=r.get(e),i===void 0&&(i=new Set,r.set(e,i));i.has(n)||(i.add(n),t=wG.bind(null,t,e,n),e.then(t,t))}function nC(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function rC(t,e,n,r,i){return t.mode&1?(t.flags|=65536,t.lanes=i,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=$o(-1,1),e.tag=2,el(n,e,1))),n.lanes|=1),t)}var cG=la.ReactCurrentOwner,Hr=!1;function Cr(t,e,n,r){e.child=t===null?uL(e,null,n,r):Bd(e,t.child,n,r)}function iC(t,e,n,r,i){n=n.render;var s=e.ref;return gd(e,i),r=hT(t,e,n,r,s,i),n=fT(),t!==null&&!Hr?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,Jo(t,e,i)):(Xt&&n&&eT(e),e.flags|=1,Cr(t,e,r,i),e.child)}function sC(t,e,n,r,i){if(t===null){var s=n.type;return typeof s=="function"&&!xT(s)&&s.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=s,RL(t,e,s,r,i)):(t=Ng(n.type,null,r,e,e.mode,i),t.ref=e.ref,t.return=e,e.child=t)}if(s=t.child,!(t.lanes&i)){var o=s.memoizedProps;if(n=n.compare,n=n!==null?n:xp,n(o,r)&&t.ref===e.ref)return Jo(t,e,i)}return e.flags|=1,t=rl(s,r),t.ref=e.ref,t.return=e,e.child=t}function RL(t,e,n,r,i){if(t!==null){var s=t.memoizedProps;if(xp(s,r)&&t.ref===e.ref)if(Hr=!1,e.pendingProps=r=s,(t.lanes&i)!==0)t.flags&131072&&(Hr=!0);else return e.lanes=t.lanes,Jo(t,e,i)}return JE(t,e,n,r,i)}function OL(t,e,n){var r=e.pendingProps,i=r.children,s=t!==null?t.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},Lt(td,si),si|=n;else{if(!(n&1073741824))return t=s!==null?s.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,Lt(td,si),si|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=s!==null?s.baseLanes:n,Lt(td,si),si|=r}else s!==null?(r=s.baseLanes|n,e.memoizedState=null):r=n,Lt(td,si),si|=r;return Cr(t,e,i,n),e.child}function DL(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function JE(t,e,n,r,i){var s=Xr(n)?Dc:yr.current;return s=Nd(e,s),gd(e,i),n=hT(t,e,n,r,s,i),r=fT(),t!==null&&!Hr?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,Jo(t,e,i)):(Xt&&r&&eT(e),e.flags|=1,Cr(t,e,n,i),e.child)}function oC(t,e,n,r,i){if(Xr(n)){var s=!0;L0(e)}else s=!1;if(gd(e,i),e.stateNode===null)Rg(t,e),lL(e,n,r),KE(e,n,r,i),r=!0;else if(t===null){var o=e.stateNode,a=e.memoizedProps;o.props=a;var l=o.context,c=n.contextType;typeof c=="object"&&c!==null?c=Ri(c):(c=Xr(n)?Dc:yr.current,c=Nd(e,c));var u=n.getDerivedStateFromProps,d=typeof u=="function"||typeof o.getSnapshotBeforeUpdate=="function";d||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==r||l!==c)&&q6(e,o,r,c),Sa=!1;var h=e.memoizedState;o.state=h,F0(e,r,o,i),l=e.memoizedState,a!==r||h!==l||jr.current||Sa?(typeof u=="function"&&(ZE(e,n,u,r),l=e.memoizedState),(a=Sa||K6(e,n,a,r,h,l,c))?(d||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(e.flags|=4194308)):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=l),o.props=r,o.state=l,o.context=c,r=a):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{o=e.stateNode,oL(t,e),a=e.memoizedProps,c=e.type===e.elementType?a:Ji(e.type,a),o.props=c,d=e.pendingProps,h=o.context,l=n.contextType,typeof l=="object"&&l!==null?l=Ri(l):(l=Xr(n)?Dc:yr.current,l=Nd(e,l));var f=n.getDerivedStateFromProps;(u=typeof f=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==d||h!==l)&&q6(e,o,r,l),Sa=!1,h=e.memoizedState,o.state=h,F0(e,r,o,i);var p=e.memoizedState;a!==d||h!==p||jr.current||Sa?(typeof f=="function"&&(ZE(e,n,f,r),p=e.memoizedState),(c=Sa||K6(e,n,c,r,h,p,l)||!1)?(u||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(r,p,l),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(r,p,l)),typeof o.componentDidUpdate=="function"&&(e.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof o.componentDidUpdate!="function"||a===t.memoizedProps&&h===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&h===t.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=p),o.props=r,o.state=p,o.context=l,r=c):(typeof o.componentDidUpdate!="function"||a===t.memoizedProps&&h===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&h===t.memoizedState||(e.flags|=1024),r=!1)}return QE(t,e,n,r,s,i)}function QE(t,e,n,r,i,s){DL(t,e);var o=(e.flags&128)!==0;if(!r&&!o)return i&&W6(e,n,!1),Jo(t,e,s);r=e.stateNode,cG.current=e;var a=o&&typeof n.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,t!==null&&o?(e.child=Bd(e,t.child,null,s),e.child=Bd(e,null,a,s)):Cr(t,e,a,s),e.memoizedState=r.state,i&&W6(e,n,!0),e.child}function NL(t){var e=t.stateNode;e.pendingContext?V6(t,e.pendingContext,e.pendingContext!==e.context):e.context&&V6(t,e.context,!1),lT(t,e.containerInfo)}function aC(t,e,n,r,i){return Fd(),nT(i),e.flags|=256,Cr(t,e,n,r),e.child}var ew={dehydrated:null,treeContext:null,retryLane:0};function tw(t){return{baseLanes:t,cachePool:null,transitions:null}}function FL(t,e,n){var r=e.pendingProps,i=Qt.current,s=!1,o=(e.flags&128)!==0,a;if((a=o)||(a=t!==null&&t.memoizedState===null?!1:(i&2)!==0),a?(s=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(i|=1),Lt(Qt,i&1),t===null)return XE(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(o=r.children,t=r.fallback,s?(r=e.mode,s=e.child,o={mode:"hidden",children:o},!(r&1)&&s!==null?(s.childLanes=0,s.pendingProps=o):s=xv(o,r,0,null),t=Ac(t,r,n,null),s.return=e,t.return=e,s.sibling=t,e.child=s,e.child.memoizedState=tw(n),e.memoizedState=ew,t):gT(e,o));if(i=t.memoizedState,i!==null&&(a=i.dehydrated,a!==null))return uG(t,e,o,r,a,i,n);if(s){s=r.fallback,o=e.mode,i=t.child,a=i.sibling;var l={mode:"hidden",children:r.children};return!(o&1)&&e.child!==i?(r=e.child,r.childLanes=0,r.pendingProps=l,e.deletions=null):(r=rl(i,l),r.subtreeFlags=i.subtreeFlags&14680064),a!==null?s=rl(a,s):(s=Ac(s,o,n,null),s.flags|=2),s.return=e,r.return=e,r.sibling=s,e.child=r,r=s,s=e.child,o=t.child.memoizedState,o=o===null?tw(n):{baseLanes:o.baseLanes|n,cachePool:null,transitions:o.transitions},s.memoizedState=o,s.childLanes=t.childLanes&~n,e.memoizedState=ew,r}return s=t.child,t=s.sibling,r=rl(s,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=n),r.return=e,r.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=r,e.memoizedState=null,r}function gT(t,e){return e=xv({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function v1(t,e,n,r){return r!==null&&nT(r),Bd(e,t.child,null,n),t=gT(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function uG(t,e,n,r,i,s,o){if(n)return e.flags&256?(e.flags&=-257,r=lb(Error(oe(422))),v1(t,e,o,r)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(s=r.fallback,i=e.mode,r=xv({mode:"visible",children:r.children},i,0,null),s=Ac(s,i,o,null),s.flags|=2,r.return=e,s.return=e,r.sibling=s,e.child=r,e.mode&1&&Bd(e,t.child,null,o),e.child.memoizedState=tw(o),e.memoizedState=ew,s);if(!(e.mode&1))return v1(t,e,o,null);if(i.data==="$!"){if(r=i.nextSibling&&i.nextSibling.dataset,r)var a=r.dgst;return r=a,s=Error(oe(419)),r=lb(s,r,void 0),v1(t,e,o,r)}if(a=(o&t.childLanes)!==0,Hr||a){if(r=Wn,r!==null){switch(o&-o){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(r.suspendedLanes|o)?0:i,i!==0&&i!==s.retryLane&&(s.retryLane=i,qo(t,i),hs(r,t,i,-1))}return wT(),r=lb(Error(oe(421))),v1(t,e,o,r)}return i.data==="$?"?(e.flags|=128,e.child=t.child,e=xG.bind(null,t),i._reactRetry=e,null):(t=s.treeContext,oi=Qa(i.nextSibling),di=e,Xt=!0,ns=null,t!==null&&(Ei[wi++]=Oo,Ei[wi++]=Do,Ei[wi++]=Nc,Oo=t.id,Do=t.overflow,Nc=e),e=gT(e,r.children),e.flags|=4096,e)}function lC(t,e,n){t.lanes|=e;var r=t.alternate;r!==null&&(r.lanes|=e),YE(t.return,e,n)}function cb(t,e,n,r,i){var s=t.memoizedState;s===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:i}:(s.isBackwards=e,s.rendering=null,s.renderingStartTime=0,s.last=r,s.tail=n,s.tailMode=i)}function BL(t,e,n){var r=e.pendingProps,i=r.revealOrder,s=r.tail;if(Cr(t,e,r.children,n),r=Qt.current,r&2)r=r&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&lC(t,n,e);else if(t.tag===19)lC(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if(Lt(Qt,r),!(e.mode&1))e.memoizedState=null;else switch(i){case"forwards":for(n=e.child,i=null;n!==null;)t=n.alternate,t!==null&&B0(t)===null&&(i=n),n=n.sibling;n=i,n===null?(i=e.child,e.child=null):(i=n.sibling,n.sibling=null),cb(e,!1,i,n,s);break;case"backwards":for(n=null,i=e.child,e.child=null;i!==null;){if(t=i.alternate,t!==null&&B0(t)===null){e.child=i;break}t=i.sibling,i.sibling=n,n=i,i=t}cb(e,!0,n,null,s);break;case"together":cb(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function Rg(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function Jo(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),Bc|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(oe(153));if(e.child!==null){for(t=e.child,n=rl(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=rl(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function dG(t,e,n){switch(e.tag){case 3:NL(e),Fd();break;case 5:dL(e);break;case 1:Xr(e.type)&&L0(e);break;case 4:lT(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,i=e.memoizedProps.value;Lt(D0,r._currentValue),r._currentValue=i;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(Lt(Qt,Qt.current&1),e.flags|=128,null):n&e.child.childLanes?FL(t,e,n):(Lt(Qt,Qt.current&1),t=Jo(t,e,n),t!==null?t.sibling:null);Lt(Qt,Qt.current&1);break;case 19:if(r=(n&e.childLanes)!==0,t.flags&128){if(r)return BL(t,e,n);e.flags|=128}if(i=e.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),Lt(Qt,Qt.current),r)break;return null;case 22:case 23:return e.lanes=0,OL(t,e,n)}return Jo(t,e,n)}var UL,nw,$L,HL;UL=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};nw=function(){};$L=function(t,e,n,r){var i=t.memoizedProps;if(i!==r){t=e.stateNode,fc(io.current);var s=null;switch(n){case"input":i=TE(t,i),r=TE(t,r),s=[];break;case"select":i=sn({},i,{value:void 0}),r=sn({},r,{value:void 0}),s=[];break;case"textarea":i=IE(t,i),r=IE(t,r),s=[];break;default:typeof i.onClick!="function"&&typeof r.onClick=="function"&&(t.onclick=M0)}kE(n,r);var o;n=null;for(c in i)if(!r.hasOwnProperty(c)&&i.hasOwnProperty(c)&&i[c]!=null)if(c==="style"){var a=i[c];for(o in a)a.hasOwnProperty(o)&&(n||(n={}),n[o]="")}else c!=="dangerouslySetInnerHTML"&&c!=="children"&&c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&c!=="autoFocus"&&(gp.hasOwnProperty(c)?s||(s=[]):(s=s||[]).push(c,null));for(c in r){var l=r[c];if(a=i!=null?i[c]:void 0,r.hasOwnProperty(c)&&l!==a&&(l!=null||a!=null))if(c==="style")if(a){for(o in a)!a.hasOwnProperty(o)||l&&l.hasOwnProperty(o)||(n||(n={}),n[o]="");for(o in l)l.hasOwnProperty(o)&&a[o]!==l[o]&&(n||(n={}),n[o]=l[o])}else n||(s||(s=[]),s.push(c,n)),n=l;else c==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,a=a?a.__html:void 0,l!=null&&a!==l&&(s=s||[]).push(c,l)):c==="children"?typeof l!="string"&&typeof l!="number"||(s=s||[]).push(c,""+l):c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&(gp.hasOwnProperty(c)?(l!=null&&c==="onScroll"&&Dt("scroll",t),s||a===l||(s=[])):(s=s||[]).push(c,l))}n&&(s=s||[]).push("style",n);var c=s;(e.updateQueue=c)&&(e.flags|=4)}};HL=function(t,e,n,r){n!==r&&(e.flags|=4)};function Rh(t,e){if(!Xt)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:r.sibling=null}}function or(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,r=0;if(e)for(var i=t.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags&14680064,r|=i.flags&14680064,i.return=t,i=i.sibling;else for(i=t.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags,r|=i.flags,i.return=t,i=i.sibling;return t.subtreeFlags|=r,t.childLanes=n,e}function hG(t,e,n){var r=e.pendingProps;switch(tT(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return or(e),null;case 1:return Xr(e.type)&&P0(),or(e),null;case 3:return r=e.stateNode,Ud(),$t(jr),$t(yr),uT(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(t===null||t.child===null)&&(g1(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,ns!==null&&(uw(ns),ns=null))),nw(t,e),or(e),null;case 5:cT(e);var i=fc(Ap.current);if(n=e.type,t!==null&&e.stateNode!=null)$L(t,e,n,r,i),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(oe(166));return or(e),null}if(t=fc(io.current),g1(e)){r=e.stateNode,n=e.type;var s=e.memoizedProps;switch(r[Js]=e,r[Cp]=s,t=(e.mode&1)!==0,n){case"dialog":Dt("cancel",r),Dt("close",r);break;case"iframe":case"object":case"embed":Dt("load",r);break;case"video":case"audio":for(i=0;i<gf.length;i++)Dt(gf[i],r);break;case"source":Dt("error",r);break;case"img":case"image":case"link":Dt("error",r),Dt("load",r);break;case"details":Dt("toggle",r);break;case"input":y6(r,s),Dt("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!s.multiple},Dt("invalid",r);break;case"textarea":b6(r,s),Dt("invalid",r)}kE(n,s),i=null;for(var o in s)if(s.hasOwnProperty(o)){var a=s[o];o==="children"?typeof a=="string"?r.textContent!==a&&(s.suppressHydrationWarning!==!0&&m1(r.textContent,a,t),i=["children",a]):typeof a=="number"&&r.textContent!==""+a&&(s.suppressHydrationWarning!==!0&&m1(r.textContent,a,t),i=["children",""+a]):gp.hasOwnProperty(o)&&a!=null&&o==="onScroll"&&Dt("scroll",r)}switch(n){case"input":a1(r),v6(r,s,!0);break;case"textarea":a1(r),_6(r);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(r.onclick=M0)}r=i,e.updateQueue=r,r!==null&&(e.flags|=4)}else{o=i.nodeType===9?i:i.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=pP(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=o.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof r.is=="string"?t=o.createElement(n,{is:r.is}):(t=o.createElement(n),n==="select"&&(o=t,r.multiple?o.multiple=!0:r.size&&(o.size=r.size))):t=o.createElementNS(t,n),t[Js]=e,t[Cp]=r,UL(t,e,!1,!1),e.stateNode=t;e:{switch(o=ME(n,r),n){case"dialog":Dt("cancel",t),Dt("close",t),i=r;break;case"iframe":case"object":case"embed":Dt("load",t),i=r;break;case"video":case"audio":for(i=0;i<gf.length;i++)Dt(gf[i],t);i=r;break;case"source":Dt("error",t),i=r;break;case"img":case"image":case"link":Dt("error",t),Dt("load",t),i=r;break;case"details":Dt("toggle",t),i=r;break;case"input":y6(t,r),i=TE(t,r),Dt("invalid",t);break;case"option":i=r;break;case"select":t._wrapperState={wasMultiple:!!r.multiple},i=sn({},r,{value:void 0}),Dt("invalid",t);break;case"textarea":b6(t,r),i=IE(t,r),Dt("invalid",t);break;default:i=r}kE(n,i),a=i;for(s in a)if(a.hasOwnProperty(s)){var l=a[s];s==="style"?yP(t,l):s==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&mP(t,l)):s==="children"?typeof l=="string"?(n!=="textarea"||l!=="")&&yp(t,l):typeof l=="number"&&yp(t,""+l):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(gp.hasOwnProperty(s)?l!=null&&s==="onScroll"&&Dt("scroll",t):l!=null&&$3(t,s,l,o))}switch(n){case"input":a1(t),v6(t,r,!1);break;case"textarea":a1(t),_6(t);break;case"option":r.value!=null&&t.setAttribute("value",""+dl(r.value));break;case"select":t.multiple=!!r.multiple,s=r.value,s!=null?hd(t,!!r.multiple,s,!1):r.defaultValue!=null&&hd(t,!!r.multiple,r.defaultValue,!0);break;default:typeof i.onClick=="function"&&(t.onclick=M0)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return or(e),null;case 6:if(t&&e.stateNode!=null)HL(t,e,t.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(oe(166));if(n=fc(Ap.current),fc(io.current),g1(e)){if(r=e.stateNode,n=e.memoizedProps,r[Js]=e,(s=r.nodeValue!==n)&&(t=di,t!==null))switch(t.tag){case 3:m1(r.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&m1(r.nodeValue,n,(t.mode&1)!==0)}s&&(e.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[Js]=e,e.stateNode=r}return or(e),null;case 13:if($t(Qt),r=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(Xt&&oi!==null&&e.mode&1&&!(e.flags&128))iL(),Fd(),e.flags|=98560,s=!1;else if(s=g1(e),r!==null&&r.dehydrated!==null){if(t===null){if(!s)throw Error(oe(318));if(s=e.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(oe(317));s[Js]=e}else Fd(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;or(e),s=!1}else ns!==null&&(uw(ns),ns=null),s=!0;if(!s)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(r=r!==null,r!==(t!==null&&t.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(t===null||Qt.current&1?Pn===0&&(Pn=3):wT())),e.updateQueue!==null&&(e.flags|=4),or(e),null);case 4:return Ud(),nw(t,e),t===null&&Tp(e.stateNode.containerInfo),or(e),null;case 10:return sT(e.type._context),or(e),null;case 17:return Xr(e.type)&&P0(),or(e),null;case 19:if($t(Qt),s=e.memoizedState,s===null)return or(e),null;if(r=(e.flags&128)!==0,o=s.rendering,o===null)if(r)Rh(s,!1);else{if(Pn!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(o=B0(t),o!==null){for(e.flags|=128,Rh(s,!1),r=o.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=n,n=e.child;n!==null;)s=n,t=r,s.flags&=14680066,o=s.alternate,o===null?(s.childLanes=0,s.lanes=t,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=o.childLanes,s.lanes=o.lanes,s.child=o.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=o.memoizedProps,s.memoizedState=o.memoizedState,s.updateQueue=o.updateQueue,s.type=o.type,t=o.dependencies,s.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return Lt(Qt,Qt.current&1|2),e.child}t=t.sibling}s.tail!==null&&fn()>Hd&&(e.flags|=128,r=!0,Rh(s,!1),e.lanes=4194304)}else{if(!r)if(t=B0(o),t!==null){if(e.flags|=128,r=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),Rh(s,!0),s.tail===null&&s.tailMode==="hidden"&&!o.alternate&&!Xt)return or(e),null}else 2*fn()-s.renderingStartTime>Hd&&n!==1073741824&&(e.flags|=128,r=!0,Rh(s,!1),e.lanes=4194304);s.isBackwards?(o.sibling=e.child,e.child=o):(n=s.last,n!==null?n.sibling=o:e.child=o,s.last=o)}return s.tail!==null?(e=s.tail,s.rendering=e,s.tail=e.sibling,s.renderingStartTime=fn(),e.sibling=null,n=Qt.current,Lt(Qt,r?n&1|2:n&1),e):(or(e),null);case 22:case 23:return ET(),r=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?si&1073741824&&(or(e),e.subtreeFlags&6&&(e.flags|=8192)):or(e),null;case 24:return null;case 25:return null}throw Error(oe(156,e.tag))}function fG(t,e){switch(tT(e),e.tag){case 1:return Xr(e.type)&&P0(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return Ud(),$t(jr),$t(yr),uT(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return cT(e),null;case 13:if($t(Qt),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(oe(340));Fd()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return $t(Qt),null;case 4:return Ud(),null;case 10:return sT(e.type._context),null;case 22:case 23:return ET(),null;case 24:return null;default:return null}}var b1=!1,hr=!1,pG=typeof WeakSet=="function"?WeakSet:Set,we=null;function ed(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){an(t,e,r)}else n.current=null}function rw(t,e,n){try{n()}catch(r){an(t,e,r)}}var cC=!1;function mG(t,e){if($E=I0,t=WP(),Q3(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var i=r.anchorOffset,s=r.focusNode;r=r.focusOffset;try{n.nodeType,s.nodeType}catch{n=null;break e}var o=0,a=-1,l=-1,c=0,u=0,d=t,h=null;t:for(;;){for(var f;d!==n||i!==0&&d.nodeType!==3||(a=o+i),d!==s||r!==0&&d.nodeType!==3||(l=o+r),d.nodeType===3&&(o+=d.nodeValue.length),(f=d.firstChild)!==null;)h=d,d=f;for(;;){if(d===t)break t;if(h===n&&++c===i&&(a=o),h===s&&++u===r&&(l=o),(f=d.nextSibling)!==null)break;d=h,h=d.parentNode}d=f}n=a===-1||l===-1?null:{start:a,end:l}}else n=null}n=n||{start:0,end:0}}else n=null;for(HE={focusedElem:t,selectionRange:n},I0=!1,we=e;we!==null;)if(e=we,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,we=t;else for(;we!==null;){e=we;try{var p=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(p!==null){var m=p.memoizedProps,v=p.memoizedState,y=e.stateNode,b=y.getSnapshotBeforeUpdate(e.elementType===e.type?m:Ji(e.type,m),v);y.__reactInternalSnapshotBeforeUpdate=b}break;case 3:var _=e.stateNode.containerInfo;_.nodeType===1?_.textContent="":_.nodeType===9&&_.documentElement&&_.removeChild(_.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(oe(163))}}catch(E){an(e,e.return,E)}if(t=e.sibling,t!==null){t.return=e.return,we=t;break}we=e.return}return p=cC,cC=!1,p}function Hf(t,e,n){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var i=r=r.next;do{if((i.tag&t)===t){var s=i.destroy;i.destroy=void 0,s!==void 0&&rw(e,n,s)}i=i.next}while(i!==r)}}function Ev(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var r=n.create;n.destroy=r()}n=n.next}while(n!==e)}}function iw(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function zL(t){var e=t.alternate;e!==null&&(t.alternate=null,zL(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[Js],delete e[Cp],delete e[VE],delete e[qz],delete e[Jz])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function GL(t){return t.tag===5||t.tag===3||t.tag===4}function uC(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||GL(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function sw(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=M0));else if(r!==4&&(t=t.child,t!==null))for(sw(t,e,n),t=t.sibling;t!==null;)sw(t,e,n),t=t.sibling}function ow(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(r!==4&&(t=t.child,t!==null))for(ow(t,e,n),t=t.sibling;t!==null;)ow(t,e,n),t=t.sibling}var qn=null,es=!1;function ma(t,e,n){for(n=n.child;n!==null;)VL(t,e,n),n=n.sibling}function VL(t,e,n){if(ro&&typeof ro.onCommitFiberUnmount=="function")try{ro.onCommitFiberUnmount(fv,n)}catch{}switch(n.tag){case 5:hr||ed(n,e);case 6:var r=qn,i=es;qn=null,ma(t,e,n),qn=r,es=i,qn!==null&&(es?(t=qn,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):qn.removeChild(n.stateNode));break;case 18:qn!==null&&(es?(t=qn,n=n.stateNode,t.nodeType===8?nb(t.parentNode,n):t.nodeType===1&&nb(t,n),Ep(t)):nb(qn,n.stateNode));break;case 4:r=qn,i=es,qn=n.stateNode.containerInfo,es=!0,ma(t,e,n),qn=r,es=i;break;case 0:case 11:case 14:case 15:if(!hr&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){i=r=r.next;do{var s=i,o=s.destroy;s=s.tag,o!==void 0&&(s&2||s&4)&&rw(n,e,o),i=i.next}while(i!==r)}ma(t,e,n);break;case 1:if(!hr&&(ed(n,e),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(a){an(n,e,a)}ma(t,e,n);break;case 21:ma(t,e,n);break;case 22:n.mode&1?(hr=(r=hr)||n.memoizedState!==null,ma(t,e,n),hr=r):ma(t,e,n);break;default:ma(t,e,n)}}function dC(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new pG),e.forEach(function(r){var i=TG.bind(null,t,r);n.has(r)||(n.add(r),r.then(i,i))})}}function zi(t,e){var n=e.deletions;if(n!==null)for(var r=0;r<n.length;r++){var i=n[r];try{var s=t,o=e,a=o;e:for(;a!==null;){switch(a.tag){case 5:qn=a.stateNode,es=!1;break e;case 3:qn=a.stateNode.containerInfo,es=!0;break e;case 4:qn=a.stateNode.containerInfo,es=!0;break e}a=a.return}if(qn===null)throw Error(oe(160));VL(s,o,i),qn=null,es=!1;var l=i.alternate;l!==null&&(l.return=null),i.return=null}catch(c){an(i,e,c)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)WL(e,t),e=e.sibling}function WL(t,e){var n=t.alternate,r=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(zi(e,t),ks(t),r&4){try{Hf(3,t,t.return),Ev(3,t)}catch(m){an(t,t.return,m)}try{Hf(5,t,t.return)}catch(m){an(t,t.return,m)}}break;case 1:zi(e,t),ks(t),r&512&&n!==null&&ed(n,n.return);break;case 5:if(zi(e,t),ks(t),r&512&&n!==null&&ed(n,n.return),t.flags&32){var i=t.stateNode;try{yp(i,"")}catch(m){an(t,t.return,m)}}if(r&4&&(i=t.stateNode,i!=null)){var s=t.memoizedProps,o=n!==null?n.memoizedProps:s,a=t.type,l=t.updateQueue;if(t.updateQueue=null,l!==null)try{a==="input"&&s.type==="radio"&&s.name!=null&&hP(i,s),ME(a,o);var c=ME(a,s);for(o=0;o<l.length;o+=2){var u=l[o],d=l[o+1];u==="style"?yP(i,d):u==="dangerouslySetInnerHTML"?mP(i,d):u==="children"?yp(i,d):$3(i,u,d,c)}switch(a){case"input":SE(i,s);break;case"textarea":fP(i,s);break;case"select":var h=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!s.multiple;var f=s.value;f!=null?hd(i,!!s.multiple,f,!1):h!==!!s.multiple&&(s.defaultValue!=null?hd(i,!!s.multiple,s.defaultValue,!0):hd(i,!!s.multiple,s.multiple?[]:"",!1))}i[Cp]=s}catch(m){an(t,t.return,m)}}break;case 6:if(zi(e,t),ks(t),r&4){if(t.stateNode===null)throw Error(oe(162));i=t.stateNode,s=t.memoizedProps;try{i.nodeValue=s}catch(m){an(t,t.return,m)}}break;case 3:if(zi(e,t),ks(t),r&4&&n!==null&&n.memoizedState.isDehydrated)try{Ep(e.containerInfo)}catch(m){an(t,t.return,m)}break;case 4:zi(e,t),ks(t);break;case 13:zi(e,t),ks(t),i=t.child,i.flags&8192&&(s=i.memoizedState!==null,i.stateNode.isHidden=s,!s||i.alternate!==null&&i.alternate.memoizedState!==null||(bT=fn())),r&4&&dC(t);break;case 22:if(u=n!==null&&n.memoizedState!==null,t.mode&1?(hr=(c=hr)||u,zi(e,t),hr=c):zi(e,t),ks(t),r&8192){if(c=t.memoizedState!==null,(t.stateNode.isHidden=c)&&!u&&t.mode&1)for(we=t,u=t.child;u!==null;){for(d=we=u;we!==null;){switch(h=we,f=h.child,h.tag){case 0:case 11:case 14:case 15:Hf(4,h,h.return);break;case 1:ed(h,h.return);var p=h.stateNode;if(typeof p.componentWillUnmount=="function"){r=h,n=h.return;try{e=r,p.props=e.memoizedProps,p.state=e.memoizedState,p.componentWillUnmount()}catch(m){an(r,n,m)}}break;case 5:ed(h,h.return);break;case 22:if(h.memoizedState!==null){fC(d);continue}}f!==null?(f.return=h,we=f):fC(d)}u=u.sibling}e:for(u=null,d=t;;){if(d.tag===5){if(u===null){u=d;try{i=d.stateNode,c?(s=i.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(a=d.stateNode,l=d.memoizedProps.style,o=l!=null&&l.hasOwnProperty("display")?l.display:null,a.style.display=gP("display",o))}catch(m){an(t,t.return,m)}}}else if(d.tag===6){if(u===null)try{d.stateNode.nodeValue=c?"":d.memoizedProps}catch(m){an(t,t.return,m)}}else if((d.tag!==22&&d.tag!==23||d.memoizedState===null||d===t)&&d.child!==null){d.child.return=d,d=d.child;continue}if(d===t)break e;for(;d.sibling===null;){if(d.return===null||d.return===t)break e;u===d&&(u=null),d=d.return}u===d&&(u=null),d.sibling.return=d.return,d=d.sibling}}break;case 19:zi(e,t),ks(t),r&4&&dC(t);break;case 21:break;default:zi(e,t),ks(t)}}function ks(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(GL(n)){var r=n;break e}n=n.return}throw Error(oe(160))}switch(r.tag){case 5:var i=r.stateNode;r.flags&32&&(yp(i,""),r.flags&=-33);var s=uC(t);ow(t,s,i);break;case 3:case 4:var o=r.stateNode.containerInfo,a=uC(t);sw(t,a,o);break;default:throw Error(oe(161))}}catch(l){an(t,t.return,l)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function gG(t,e,n){we=t,jL(t)}function jL(t,e,n){for(var r=(t.mode&1)!==0;we!==null;){var i=we,s=i.child;if(i.tag===22&&r){var o=i.memoizedState!==null||b1;if(!o){var a=i.alternate,l=a!==null&&a.memoizedState!==null||hr;a=b1;var c=hr;if(b1=o,(hr=l)&&!c)for(we=i;we!==null;)o=we,l=o.child,o.tag===22&&o.memoizedState!==null?pC(i):l!==null?(l.return=o,we=l):pC(i);for(;s!==null;)we=s,jL(s),s=s.sibling;we=i,b1=a,hr=c}hC(t)}else i.subtreeFlags&8772&&s!==null?(s.return=i,we=s):hC(t)}}function hC(t){for(;we!==null;){var e=we;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:hr||Ev(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!hr)if(n===null)r.componentDidMount();else{var i=e.elementType===e.type?n.memoizedProps:Ji(e.type,n.memoizedProps);r.componentDidUpdate(i,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var s=e.updateQueue;s!==null&&Z6(e,s,r);break;case 3:var o=e.updateQueue;if(o!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}Z6(e,o,n)}break;case 5:var a=e.stateNode;if(n===null&&e.flags&4){n=a;var l=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&n.focus();break;case"img":l.src&&(n.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var c=e.alternate;if(c!==null){var u=c.memoizedState;if(u!==null){var d=u.dehydrated;d!==null&&Ep(d)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(oe(163))}hr||e.flags&512&&iw(e)}catch(h){an(e,e.return,h)}}if(e===t){we=null;break}if(n=e.sibling,n!==null){n.return=e.return,we=n;break}we=e.return}}function fC(t){for(;we!==null;){var e=we;if(e===t){we=null;break}var n=e.sibling;if(n!==null){n.return=e.return,we=n;break}we=e.return}}function pC(t){for(;we!==null;){var e=we;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{Ev(4,e)}catch(l){an(e,n,l)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var i=e.return;try{r.componentDidMount()}catch(l){an(e,i,l)}}var s=e.return;try{iw(e)}catch(l){an(e,s,l)}break;case 5:var o=e.return;try{iw(e)}catch(l){an(e,o,l)}}}catch(l){an(e,e.return,l)}if(e===t){we=null;break}var a=e.sibling;if(a!==null){a.return=e.return,we=a;break}we=e.return}}var yG=Math.ceil,H0=la.ReactCurrentDispatcher,yT=la.ReactCurrentOwner,Ai=la.ReactCurrentBatchConfig,dt=0,Wn=null,bn=null,tr=0,si=0,td=Il(0),Pn=0,Lp=null,Bc=0,wv=0,vT=0,zf=null,$r=null,bT=0,Hd=1/0,Ao=null,z0=!1,aw=null,tl=null,_1=!1,Ba=null,G0=0,Gf=0,lw=null,Og=-1,Dg=0;function Rr(){return dt&6?fn():Og!==-1?Og:Og=fn()}function nl(t){return t.mode&1?dt&2&&tr!==0?tr&-tr:eG.transition!==null?(Dg===0&&(Dg=kP()),Dg):(t=wt,t!==0||(t=window.event,t=t===void 0?16:NP(t.type)),t):1}function hs(t,e,n,r){if(50<Gf)throw Gf=0,lw=null,Error(oe(185));Sm(t,n,r),(!(dt&2)||t!==Wn)&&(t===Wn&&(!(dt&2)&&(wv|=n),Pn===4&&ka(t,tr)),Yr(t,r),n===1&&dt===0&&!(e.mode&1)&&(Hd=fn()+500,vv&&Al()))}function Yr(t,e){var n=t.callbackNode;ez(t,e);var r=C0(t,t===Wn?tr:0);if(r===0)n!==null&&x6(n),t.callbackNode=null,t.callbackPriority=0;else if(e=r&-r,t.callbackPriority!==e){if(n!=null&&x6(n),e===1)t.tag===0?Qz(mC.bind(null,t)):tL(mC.bind(null,t)),Zz(function(){!(dt&6)&&Al()}),n=null;else{switch(MP(r)){case 1:n=W3;break;case 4:n=IP;break;case 16:n=S0;break;case 536870912:n=AP;break;default:n=S0}n=e7(n,XL.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function XL(t,e){if(Og=-1,Dg=0,dt&6)throw Error(oe(327));var n=t.callbackNode;if(yd()&&t.callbackNode!==n)return null;var r=C0(t,t===Wn?tr:0);if(r===0)return null;if(r&30||r&t.expiredLanes||e)e=V0(t,r);else{e=r;var i=dt;dt|=2;var s=ZL();(Wn!==t||tr!==e)&&(Ao=null,Hd=fn()+500,Ic(t,e));do try{_G();break}catch(a){YL(t,a)}while(!0);iT(),H0.current=s,dt=i,bn!==null?e=0:(Wn=null,tr=0,e=Pn)}if(e!==0){if(e===2&&(i=DE(t),i!==0&&(r=i,e=cw(t,i))),e===1)throw n=Lp,Ic(t,0),ka(t,r),Yr(t,fn()),n;if(e===6)ka(t,r);else{if(i=t.current.alternate,!(r&30)&&!vG(i)&&(e=V0(t,r),e===2&&(s=DE(t),s!==0&&(r=s,e=cw(t,s))),e===1))throw n=Lp,Ic(t,0),ka(t,r),Yr(t,fn()),n;switch(t.finishedWork=i,t.finishedLanes=r,e){case 0:case 1:throw Error(oe(345));case 2:zl(t,$r,Ao);break;case 3:if(ka(t,r),(r&130023424)===r&&(e=bT+500-fn(),10<e)){if(C0(t,0)!==0)break;if(i=t.suspendedLanes,(i&r)!==r){Rr(),t.pingedLanes|=t.suspendedLanes&i;break}t.timeoutHandle=GE(zl.bind(null,t,$r,Ao),e);break}zl(t,$r,Ao);break;case 4:if(ka(t,r),(r&4194240)===r)break;for(e=t.eventTimes,i=-1;0<r;){var o=31-ds(r);s=1<<o,o=e[o],o>i&&(i=o),r&=~s}if(r=i,r=fn()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*yG(r/1960))-r,10<r){t.timeoutHandle=GE(zl.bind(null,t,$r,Ao),r);break}zl(t,$r,Ao);break;case 5:zl(t,$r,Ao);break;default:throw Error(oe(329))}}}return Yr(t,fn()),t.callbackNode===n?XL.bind(null,t):null}function cw(t,e){var n=zf;return t.current.memoizedState.isDehydrated&&(Ic(t,e).flags|=256),t=V0(t,e),t!==2&&(e=$r,$r=n,e!==null&&uw(e)),t}function uw(t){$r===null?$r=t:$r.push.apply($r,t)}function vG(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var i=n[r],s=i.getSnapshot;i=i.value;try{if(!bs(s(),i))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function ka(t,e){for(e&=~vT,e&=~wv,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-ds(e),r=1<<n;t[n]=-1,e&=~r}}function mC(t){if(dt&6)throw Error(oe(327));yd();var e=C0(t,0);if(!(e&1))return Yr(t,fn()),null;var n=V0(t,e);if(t.tag!==0&&n===2){var r=DE(t);r!==0&&(e=r,n=cw(t,r))}if(n===1)throw n=Lp,Ic(t,0),ka(t,e),Yr(t,fn()),n;if(n===6)throw Error(oe(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,zl(t,$r,Ao),Yr(t,fn()),null}function _T(t,e){var n=dt;dt|=1;try{return t(e)}finally{dt=n,dt===0&&(Hd=fn()+500,vv&&Al())}}function Uc(t){Ba!==null&&Ba.tag===0&&!(dt&6)&&yd();var e=dt;dt|=1;var n=Ai.transition,r=wt;try{if(Ai.transition=null,wt=1,t)return t()}finally{wt=r,Ai.transition=n,dt=e,!(dt&6)&&Al()}}function ET(){si=td.current,$t(td)}function Ic(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,Yz(n)),bn!==null)for(n=bn.return;n!==null;){var r=n;switch(tT(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&P0();break;case 3:Ud(),$t(jr),$t(yr),uT();break;case 5:cT(r);break;case 4:Ud();break;case 13:$t(Qt);break;case 19:$t(Qt);break;case 10:sT(r.type._context);break;case 22:case 23:ET()}n=n.return}if(Wn=t,bn=t=rl(t.current,null),tr=si=e,Pn=0,Lp=null,vT=wv=Bc=0,$r=zf=null,hc!==null){for(e=0;e<hc.length;e++)if(n=hc[e],r=n.interleaved,r!==null){n.interleaved=null;var i=r.next,s=n.pending;if(s!==null){var o=s.next;s.next=i,r.next=o}n.pending=r}hc=null}return t}function YL(t,e){do{var n=bn;try{if(iT(),Pg.current=$0,U0){for(var r=rn.memoizedState;r!==null;){var i=r.queue;i!==null&&(i.pending=null),r=r.next}U0=!1}if(Fc=0,Hn=An=rn=null,$f=!1,kp=0,yT.current=null,n===null||n.return===null){Pn=1,Lp=e,bn=null;break}e:{var s=t,o=n.return,a=n,l=e;if(e=tr,a.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var c=l,u=a,d=u.tag;if(!(u.mode&1)&&(d===0||d===11||d===15)){var h=u.alternate;h?(u.updateQueue=h.updateQueue,u.memoizedState=h.memoizedState,u.lanes=h.lanes):(u.updateQueue=null,u.memoizedState=null)}var f=nC(o);if(f!==null){f.flags&=-257,rC(f,o,a,s,e),f.mode&1&&tC(s,c,e),e=f,l=c;var p=e.updateQueue;if(p===null){var m=new Set;m.add(l),e.updateQueue=m}else p.add(l);break e}else{if(!(e&1)){tC(s,c,e),wT();break e}l=Error(oe(426))}}else if(Xt&&a.mode&1){var v=nC(o);if(v!==null){!(v.flags&65536)&&(v.flags|=256),rC(v,o,a,s,e),nT($d(l,a));break e}}s=l=$d(l,a),Pn!==4&&(Pn=2),zf===null?zf=[s]:zf.push(s),s=o;do{switch(s.tag){case 3:s.flags|=65536,e&=-e,s.lanes|=e;var y=PL(s,l,e);Y6(s,y);break e;case 1:a=l;var b=s.type,_=s.stateNode;if(!(s.flags&128)&&(typeof b.getDerivedStateFromError=="function"||_!==null&&typeof _.componentDidCatch=="function"&&(tl===null||!tl.has(_)))){s.flags|=65536,e&=-e,s.lanes|=e;var E=LL(s,a,e);Y6(s,E);break e}}s=s.return}while(s!==null)}qL(n)}catch(w){e=w,bn===n&&n!==null&&(bn=n=n.return);continue}break}while(!0)}function ZL(){var t=H0.current;return H0.current=$0,t===null?$0:t}function wT(){(Pn===0||Pn===3||Pn===2)&&(Pn=4),Wn===null||!(Bc&268435455)&&!(wv&268435455)||ka(Wn,tr)}function V0(t,e){var n=dt;dt|=2;var r=ZL();(Wn!==t||tr!==e)&&(Ao=null,Ic(t,e));do try{bG();break}catch(i){YL(t,i)}while(!0);if(iT(),dt=n,H0.current=r,bn!==null)throw Error(oe(261));return Wn=null,tr=0,Pn}function bG(){for(;bn!==null;)KL(bn)}function _G(){for(;bn!==null&&!WH();)KL(bn)}function KL(t){var e=QL(t.alternate,t,si);t.memoizedProps=t.pendingProps,e===null?qL(t):bn=e,yT.current=null}function qL(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=fG(n,e),n!==null){n.flags&=32767,bn=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{Pn=6,bn=null;return}}else if(n=hG(n,e,si),n!==null){bn=n;return}if(e=e.sibling,e!==null){bn=e;return}bn=e=t}while(e!==null);Pn===0&&(Pn=5)}function zl(t,e,n){var r=wt,i=Ai.transition;try{Ai.transition=null,wt=1,EG(t,e,n,r)}finally{Ai.transition=i,wt=r}return null}function EG(t,e,n,r){do yd();while(Ba!==null);if(dt&6)throw Error(oe(327));n=t.finishedWork;var i=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(oe(177));t.callbackNode=null,t.callbackPriority=0;var s=n.lanes|n.childLanes;if(tz(t,s),t===Wn&&(bn=Wn=null,tr=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||_1||(_1=!0,e7(S0,function(){return yd(),null})),s=(n.flags&15990)!==0,n.subtreeFlags&15990||s){s=Ai.transition,Ai.transition=null;var o=wt;wt=1;var a=dt;dt|=4,yT.current=null,mG(t,n),WL(n,t),Hz(HE),I0=!!$E,HE=$E=null,t.current=n,gG(n),jH(),dt=a,wt=o,Ai.transition=s}else t.current=n;if(_1&&(_1=!1,Ba=t,G0=i),s=t.pendingLanes,s===0&&(tl=null),ZH(n.stateNode),Yr(t,fn()),e!==null)for(r=t.onRecoverableError,n=0;n<e.length;n++)i=e[n],r(i.value,{componentStack:i.stack,digest:i.digest});if(z0)throw z0=!1,t=aw,aw=null,t;return G0&1&&t.tag!==0&&yd(),s=t.pendingLanes,s&1?t===lw?Gf++:(Gf=0,lw=t):Gf=0,Al(),null}function yd(){if(Ba!==null){var t=MP(G0),e=Ai.transition,n=wt;try{if(Ai.transition=null,wt=16>t?16:t,Ba===null)var r=!1;else{if(t=Ba,Ba=null,G0=0,dt&6)throw Error(oe(331));var i=dt;for(dt|=4,we=t.current;we!==null;){var s=we,o=s.child;if(we.flags&16){var a=s.deletions;if(a!==null){for(var l=0;l<a.length;l++){var c=a[l];for(we=c;we!==null;){var u=we;switch(u.tag){case 0:case 11:case 15:Hf(8,u,s)}var d=u.child;if(d!==null)d.return=u,we=d;else for(;we!==null;){u=we;var h=u.sibling,f=u.return;if(zL(u),u===c){we=null;break}if(h!==null){h.return=f,we=h;break}we=f}}}var p=s.alternate;if(p!==null){var m=p.child;if(m!==null){p.child=null;do{var v=m.sibling;m.sibling=null,m=v}while(m!==null)}}we=s}}if(s.subtreeFlags&2064&&o!==null)o.return=s,we=o;else e:for(;we!==null;){if(s=we,s.flags&2048)switch(s.tag){case 0:case 11:case 15:Hf(9,s,s.return)}var y=s.sibling;if(y!==null){y.return=s.return,we=y;break e}we=s.return}}var b=t.current;for(we=b;we!==null;){o=we;var _=o.child;if(o.subtreeFlags&2064&&_!==null)_.return=o,we=_;else e:for(o=b;we!==null;){if(a=we,a.flags&2048)try{switch(a.tag){case 0:case 11:case 15:Ev(9,a)}}catch(w){an(a,a.return,w)}if(a===o){we=null;break e}var E=a.sibling;if(E!==null){E.return=a.return,we=E;break e}we=a.return}}if(dt=i,Al(),ro&&typeof ro.onPostCommitFiberRoot=="function")try{ro.onPostCommitFiberRoot(fv,t)}catch{}r=!0}return r}finally{wt=n,Ai.transition=e}}return!1}function gC(t,e,n){e=$d(n,e),e=PL(t,e,1),t=el(t,e,1),e=Rr(),t!==null&&(Sm(t,1,e),Yr(t,e))}function an(t,e,n){if(t.tag===3)gC(t,t,n);else for(;e!==null;){if(e.tag===3){gC(e,t,n);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(tl===null||!tl.has(r))){t=$d(n,t),t=LL(e,t,1),e=el(e,t,1),t=Rr(),e!==null&&(Sm(e,1,t),Yr(e,t));break}}e=e.return}}function wG(t,e,n){var r=t.pingCache;r!==null&&r.delete(e),e=Rr(),t.pingedLanes|=t.suspendedLanes&n,Wn===t&&(tr&n)===n&&(Pn===4||Pn===3&&(tr&130023424)===tr&&500>fn()-bT?Ic(t,0):vT|=n),Yr(t,e)}function JL(t,e){e===0&&(t.mode&1?(e=u1,u1<<=1,!(u1&130023424)&&(u1=4194304)):e=1);var n=Rr();t=qo(t,e),t!==null&&(Sm(t,e,n),Yr(t,n))}function xG(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),JL(t,n)}function TG(t,e){var n=0;switch(t.tag){case 13:var r=t.stateNode,i=t.memoizedState;i!==null&&(n=i.retryLane);break;case 19:r=t.stateNode;break;default:throw Error(oe(314))}r!==null&&r.delete(e),JL(t,n)}var QL;QL=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||jr.current)Hr=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return Hr=!1,dG(t,e,n);Hr=!!(t.flags&131072)}else Hr=!1,Xt&&e.flags&1048576&&nL(e,O0,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;Rg(t,e),t=e.pendingProps;var i=Nd(e,yr.current);gd(e,n),i=hT(null,e,r,t,i,n);var s=fT();return e.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,Xr(r)?(s=!0,L0(e)):s=!1,e.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,aT(e),i.updater=bv,e.stateNode=i,i._reactInternals=e,KE(e,r,t,n),e=QE(null,e,r,!0,s,n)):(e.tag=0,Xt&&s&&eT(e),Cr(null,e,i,n),e=e.child),e;case 16:r=e.elementType;e:{switch(Rg(t,e),t=e.pendingProps,i=r._init,r=i(r._payload),e.type=r,i=e.tag=CG(r),t=Ji(r,t),i){case 0:e=JE(null,e,r,t,n);break e;case 1:e=oC(null,e,r,t,n);break e;case 11:e=iC(null,e,r,t,n);break e;case 14:e=sC(null,e,r,Ji(r.type,t),n);break e}throw Error(oe(306,r,""))}return e;case 0:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Ji(r,i),JE(t,e,r,i,n);case 1:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Ji(r,i),oC(t,e,r,i,n);case 3:e:{if(NL(e),t===null)throw Error(oe(387));r=e.pendingProps,s=e.memoizedState,i=s.element,oL(t,e),F0(e,r,null,n);var o=e.memoizedState;if(r=o.element,s.isDehydrated)if(s={element:r,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=s,e.memoizedState=s,e.flags&256){i=$d(Error(oe(423)),e),e=aC(t,e,r,n,i);break e}else if(r!==i){i=$d(Error(oe(424)),e),e=aC(t,e,r,n,i);break e}else for(oi=Qa(e.stateNode.containerInfo.firstChild),di=e,Xt=!0,ns=null,n=uL(e,null,r,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(Fd(),r===i){e=Jo(t,e,n);break e}Cr(t,e,r,n)}e=e.child}return e;case 5:return dL(e),t===null&&XE(e),r=e.type,i=e.pendingProps,s=t!==null?t.memoizedProps:null,o=i.children,zE(r,i)?o=null:s!==null&&zE(r,s)&&(e.flags|=32),DL(t,e),Cr(t,e,o,n),e.child;case 6:return t===null&&XE(e),null;case 13:return FL(t,e,n);case 4:return lT(e,e.stateNode.containerInfo),r=e.pendingProps,t===null?e.child=Bd(e,null,r,n):Cr(t,e,r,n),e.child;case 11:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Ji(r,i),iC(t,e,r,i,n);case 7:return Cr(t,e,e.pendingProps,n),e.child;case 8:return Cr(t,e,e.pendingProps.children,n),e.child;case 12:return Cr(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(r=e.type._context,i=e.pendingProps,s=e.memoizedProps,o=i.value,Lt(D0,r._currentValue),r._currentValue=o,s!==null)if(bs(s.value,o)){if(s.children===i.children&&!jr.current){e=Jo(t,e,n);break e}}else for(s=e.child,s!==null&&(s.return=e);s!==null;){var a=s.dependencies;if(a!==null){o=s.child;for(var l=a.firstContext;l!==null;){if(l.context===r){if(s.tag===1){l=$o(-1,n&-n),l.tag=2;var c=s.updateQueue;if(c!==null){c=c.shared;var u=c.pending;u===null?l.next=l:(l.next=u.next,u.next=l),c.pending=l}}s.lanes|=n,l=s.alternate,l!==null&&(l.lanes|=n),YE(s.return,n,e),a.lanes|=n;break}l=l.next}}else if(s.tag===10)o=s.type===e.type?null:s.child;else if(s.tag===18){if(o=s.return,o===null)throw Error(oe(341));o.lanes|=n,a=o.alternate,a!==null&&(a.lanes|=n),YE(o,n,e),o=s.sibling}else o=s.child;if(o!==null)o.return=s;else for(o=s;o!==null;){if(o===e){o=null;break}if(s=o.sibling,s!==null){s.return=o.return,o=s;break}o=o.return}s=o}Cr(t,e,i.children,n),e=e.child}return e;case 9:return i=e.type,r=e.pendingProps.children,gd(e,n),i=Ri(i),r=r(i),e.flags|=1,Cr(t,e,r,n),e.child;case 14:return r=e.type,i=Ji(r,e.pendingProps),i=Ji(r.type,i),sC(t,e,r,i,n);case 15:return RL(t,e,e.type,e.pendingProps,n);case 17:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Ji(r,i),Rg(t,e),e.tag=1,Xr(r)?(t=!0,L0(e)):t=!1,gd(e,n),lL(e,r,i),KE(e,r,i,n),QE(null,e,r,!0,t,n);case 19:return BL(t,e,n);case 22:return OL(t,e,n)}throw Error(oe(156,e.tag))};function e7(t,e){return CP(t,e)}function SG(t,e,n,r){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function xi(t,e,n,r){return new SG(t,e,n,r)}function xT(t){return t=t.prototype,!(!t||!t.isReactComponent)}function CG(t){if(typeof t=="function")return xT(t)?1:0;if(t!=null){if(t=t.$$typeof,t===z3)return 11;if(t===G3)return 14}return 2}function rl(t,e){var n=t.alternate;return n===null?(n=xi(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function Ng(t,e,n,r,i,s){var o=2;if(r=t,typeof t=="function")xT(t)&&(o=1);else if(typeof t=="string")o=5;else e:switch(t){case Wu:return Ac(n.children,i,s,e);case H3:o=8,i|=8;break;case _E:return t=xi(12,n,e,i|2),t.elementType=_E,t.lanes=s,t;case EE:return t=xi(13,n,e,i),t.elementType=EE,t.lanes=s,t;case wE:return t=xi(19,n,e,i),t.elementType=wE,t.lanes=s,t;case cP:return xv(n,i,s,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case aP:o=10;break e;case lP:o=9;break e;case z3:o=11;break e;case G3:o=14;break e;case Ta:o=16,r=null;break e}throw Error(oe(130,t==null?t:typeof t,""))}return e=xi(o,n,e,i),e.elementType=t,e.type=r,e.lanes=s,e}function Ac(t,e,n,r){return t=xi(7,t,r,e),t.lanes=n,t}function xv(t,e,n,r){return t=xi(22,t,r,e),t.elementType=cP,t.lanes=n,t.stateNode={isHidden:!1},t}function ub(t,e,n){return t=xi(6,t,null,e),t.lanes=n,t}function db(t,e,n){return e=xi(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function IG(t,e,n,r,i){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=W2(0),this.expirationTimes=W2(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=W2(0),this.identifierPrefix=r,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function TT(t,e,n,r,i,s,o,a,l){return t=new IG(t,e,n,a,l),e===1?(e=1,s===!0&&(e|=8)):e=0,s=xi(3,null,null,e),t.current=s,s.stateNode=t,s.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},aT(s),t}function AG(t,e,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Vu,key:r==null?null:""+r,children:t,containerInfo:e,implementation:n}}function t7(t){if(!t)return hl;t=t._reactInternals;e:{if(lu(t)!==t||t.tag!==1)throw Error(oe(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(Xr(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(oe(171))}if(t.tag===1){var n=t.type;if(Xr(n))return eL(t,n,e)}return e}function n7(t,e,n,r,i,s,o,a,l){return t=TT(n,r,!0,t,i,s,o,a,l),t.context=t7(null),n=t.current,r=Rr(),i=nl(n),s=$o(r,i),s.callback=e??null,el(n,s,i),t.current.lanes=i,Sm(t,i,r),Yr(t,r),t}function Tv(t,e,n,r){var i=e.current,s=Rr(),o=nl(i);return n=t7(n),e.context===null?e.context=n:e.pendingContext=n,e=$o(s,o),e.payload={element:t},r=r===void 0?null:r,r!==null&&(e.callback=r),t=el(i,e,o),t!==null&&(hs(t,i,o,s),Mg(t,i,o)),o}function W0(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function yC(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function ST(t,e){yC(t,e),(t=t.alternate)&&yC(t,e)}function kG(){return null}var r7=typeof reportError=="function"?reportError:function(t){console.error(t)};function CT(t){this._internalRoot=t}Sv.prototype.render=CT.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(oe(409));Tv(t,e,null,null)};Sv.prototype.unmount=CT.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;Uc(function(){Tv(null,t,null,null)}),e[Ko]=null}};function Sv(t){this._internalRoot=t}Sv.prototype.unstable_scheduleHydration=function(t){if(t){var e=RP();t={blockedOn:null,target:t,priority:e};for(var n=0;n<Aa.length&&e!==0&&e<Aa[n].priority;n++);Aa.splice(n,0,t),n===0&&DP(t)}};function IT(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function Cv(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function vC(){}function MG(t,e,n,r,i){if(i){if(typeof r=="function"){var s=r;r=function(){var c=W0(o);s.call(c)}}var o=n7(e,r,t,0,null,!1,!1,"",vC);return t._reactRootContainer=o,t[Ko]=o.current,Tp(t.nodeType===8?t.parentNode:t),Uc(),o}for(;i=t.lastChild;)t.removeChild(i);if(typeof r=="function"){var a=r;r=function(){var c=W0(l);a.call(c)}}var l=TT(t,0,!1,null,null,!1,!1,"",vC);return t._reactRootContainer=l,t[Ko]=l.current,Tp(t.nodeType===8?t.parentNode:t),Uc(function(){Tv(e,l,n,r)}),l}function Iv(t,e,n,r,i){var s=n._reactRootContainer;if(s){var o=s;if(typeof i=="function"){var a=i;i=function(){var l=W0(o);a.call(l)}}Tv(e,o,t,i)}else o=MG(n,e,t,i,r);return W0(o)}PP=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=mf(e.pendingLanes);n!==0&&(j3(e,n|1),Yr(e,fn()),!(dt&6)&&(Hd=fn()+500,Al()))}break;case 13:Uc(function(){var r=qo(t,1);if(r!==null){var i=Rr();hs(r,t,1,i)}}),ST(t,1)}};X3=function(t){if(t.tag===13){var e=qo(t,134217728);if(e!==null){var n=Rr();hs(e,t,134217728,n)}ST(t,134217728)}};LP=function(t){if(t.tag===13){var e=nl(t),n=qo(t,e);if(n!==null){var r=Rr();hs(n,t,e,r)}ST(t,e)}};RP=function(){return wt};OP=function(t,e){var n=wt;try{return wt=t,e()}finally{wt=n}};LE=function(t,e,n){switch(e){case"input":if(SE(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var r=n[e];if(r!==t&&r.form===t.form){var i=yv(r);if(!i)throw Error(oe(90));dP(r),SE(r,i)}}}break;case"textarea":fP(t,n);break;case"select":e=n.value,e!=null&&hd(t,!!n.multiple,e,!1)}};_P=_T;EP=Uc;var PG={usingClientEntryPoint:!1,Events:[Im,Zu,yv,vP,bP,_T]},Oh={findFiberByHostInstance:dc,bundleType:0,version:"18.2.0",rendererPackageName:"react-dom"},LG={bundleType:Oh.bundleType,version:Oh.version,rendererPackageName:Oh.rendererPackageName,rendererConfig:Oh.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:la.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=TP(t),t===null?null:t.stateNode},findFiberByHostInstance:Oh.findFiberByHostInstance||kG,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.2.0-next-9e3b772b8-20220608"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var E1=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!E1.isDisabled&&E1.supportsFiber)try{fv=E1.inject(LG),ro=E1}catch{}}pi.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=PG;pi.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!IT(e))throw Error(oe(200));return AG(t,e,null,n)};pi.createRoot=function(t,e){if(!IT(t))throw Error(oe(299));var n=!1,r="",i=r7;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(i=e.onRecoverableError)),e=TT(t,1,!1,null,null,n,!1,r,i),t[Ko]=e.current,Tp(t.nodeType===8?t.parentNode:t),new CT(e)};pi.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(oe(188)):(t=Object.keys(t).join(","),Error(oe(268,t)));return t=TP(e),t=t===null?null:t.stateNode,t};pi.flushSync=function(t){return Uc(t)};pi.hydrate=function(t,e,n){if(!Cv(e))throw Error(oe(200));return Iv(null,t,e,!0,n)};pi.hydrateRoot=function(t,e,n){if(!IT(t))throw Error(oe(405));var r=n!=null&&n.hydratedSources||null,i=!1,s="",o=r7;if(n!=null&&(n.unstable_strictMode===!0&&(i=!0),n.identifierPrefix!==void 0&&(s=n.identifierPrefix),n.onRecoverableError!==void 0&&(o=n.onRecoverableError)),e=n7(e,null,t,1,n??null,i,!1,s,o),t[Ko]=e.current,Tp(t),r)for(t=0;t<r.length;t++)n=r[t],i=n._getVersion,i=i(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,i]:e.mutableSourceEagerHydrationData.push(n,i);return new Sv(e)};pi.render=function(t,e,n){if(!Cv(e))throw Error(oe(200));return Iv(null,t,e,!1,n)};pi.unmountComponentAtNode=function(t){if(!Cv(t))throw Error(oe(40));return t._reactRootContainer?(Uc(function(){Iv(null,null,t,!1,function(){t._reactRootContainer=null,t[Ko]=null})}),!0):!1};pi.unstable_batchedUpdates=_T;pi.unstable_renderSubtreeIntoContainer=function(t,e,n,r){if(!Cv(n))throw Error(oe(200));if(t==null||t._reactInternals===void 0)throw Error(oe(38));return Iv(t,e,n,!1,r)};pi.version="18.2.0-next-9e3b772b8-20220608";function i7(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(i7)}catch(t){console.error(t)}}i7(),nP.exports=pi;var hi=nP.exports;const RG=aa(hi);var s7,bC=hi;s7=bC.createRoot,bC.hydrateRoot;const OG=()=>{Array.prototype.at||Object.defineProperty(Array.prototype,"at",{value:function(t){if(t=Math.trunc(t)||0,t<0&&(t+=this.length),!(t<0||t>=this.length))return this[t]},writable:!0,enumerable:!1,configurable:!0}),Element.prototype.replaceChildren||(Element.prototype.replaceChildren=function(...t){this.innerHTML="",this.append(...t)})};function DG(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Rp(t){"@babel/helpers - typeof";return Rp=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Rp(t)}function NG(t,e){if(Rp(t)!=="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(Rp(r)!=="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function FG(t){var e=NG(t,"string");return Rp(e)==="symbol"?e:String(e)}function _C(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,FG(r.key),r)}}function BG(t,e,n){return e&&_C(t.prototype,e),n&&_C(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}var o7=[],UG=o7.forEach,$G=o7.slice;function HG(t){return UG.call($G.call(arguments,1),function(e){if(e)for(var n in e)t[n]===void 0&&(t[n]=e[n])}),t}var EC=/^[\u0009\u0020-\u007e\u0080-\u00ff]+$/,zG=function(e,n,r){var i=r||{};i.path=i.path||"/";var s=encodeURIComponent(n),o=e+"="+s;if(i.maxAge>0){var a=i.maxAge-0;if(isNaN(a))throw new Error("maxAge should be a Number");o+="; Max-Age="+Math.floor(a)}if(i.domain){if(!EC.test(i.domain))throw new TypeError("option domain is invalid");o+="; Domain="+i.domain}if(i.path){if(!EC.test(i.path))throw new TypeError("option path is invalid");o+="; Path="+i.path}if(i.expires){if(typeof i.expires.toUTCString!="function")throw new TypeError("option expires is invalid");o+="; Expires="+i.expires.toUTCString()}if(i.httpOnly&&(o+="; HttpOnly"),i.secure&&(o+="; Secure"),i.sameSite){var l=typeof i.sameSite=="string"?i.sameSite.toLowerCase():i.sameSite;switch(l){case!0:o+="; SameSite=Strict";break;case"lax":o+="; SameSite=Lax";break;case"strict":o+="; SameSite=Strict";break;case"none":o+="; SameSite=None";break;default:throw new TypeError("option sameSite is invalid")}}return o},wC={create:function(e,n,r,i){var s=arguments.length>4&&arguments[4]!==void 0?arguments[4]:{path:"/",sameSite:"strict"};r&&(s.expires=new Date,s.expires.setTime(s.expires.getTime()+r*60*1e3)),i&&(s.domain=i),document.cookie=zG(e,encodeURIComponent(n),s)},read:function(e){for(var n=e+"=",r=document.cookie.split(";"),i=0;i<r.length;i++){for(var s=r[i];s.charAt(0)===" ";)s=s.substring(1,s.length);if(s.indexOf(n)===0)return s.substring(n.length,s.length)}return null},remove:function(e){this.create(e,"",-1)}},GG={name:"cookie",lookup:function(e){var n;if(e.lookupCookie&&typeof document<"u"){var r=wC.read(e.lookupCookie);r&&(n=r)}return n},cacheUserLanguage:function(e,n){n.lookupCookie&&typeof document<"u"&&wC.create(n.lookupCookie,e,n.cookieMinutes,n.cookieDomain,n.cookieOptions)}},VG={name:"querystring",lookup:function(e){var n;if(typeof window<"u"){var r=window.location.search;!window.location.search&&window.location.hash&&window.location.hash.indexOf("?")>-1&&(r=window.location.hash.substring(window.location.hash.indexOf("?")));for(var i=r.substring(1),s=i.split("&"),o=0;o<s.length;o++){var a=s[o].indexOf("=");if(a>0){var l=s[o].substring(0,a);l===e.lookupQuerystring&&(n=s[o].substring(a+1))}}}return n}},Dh=null,xC=function(){if(Dh!==null)return Dh;try{Dh=window!=="undefined"&&window.localStorage!==null;var e="i18next.translate.boo";window.localStorage.setItem(e,"foo"),window.localStorage.removeItem(e)}catch{Dh=!1}return Dh},WG={name:"localStorage",lookup:function(e){var n;if(e.lookupLocalStorage&&xC()){var r=window.localStorage.getItem(e.lookupLocalStorage);r&&(n=r)}return n},cacheUserLanguage:function(e,n){n.lookupLocalStorage&&xC()&&window.localStorage.setItem(n.lookupLocalStorage,e)}},Nh=null,TC=function(){if(Nh!==null)return Nh;try{Nh=window!=="undefined"&&window.sessionStorage!==null;var e="i18next.translate.boo";window.sessionStorage.setItem(e,"foo"),window.sessionStorage.removeItem(e)}catch{Nh=!1}return Nh},jG={name:"sessionStorage",lookup:function(e){var n;if(e.lookupSessionStorage&&TC()){var r=window.sessionStorage.getItem(e.lookupSessionStorage);r&&(n=r)}return n},cacheUserLanguage:function(e,n){n.lookupSessionStorage&&TC()&&window.sessionStorage.setItem(n.lookupSessionStorage,e)}},XG={name:"navigator",lookup:function(e){var n=[];if(typeof navigator<"u"){if(navigator.languages)for(var r=0;r<navigator.languages.length;r++)n.push(navigator.languages[r]);navigator.userLanguage&&n.push(navigator.userLanguage),navigator.language&&n.push(navigator.language)}return n.length>0?n:void 0}},YG={name:"htmlTag",lookup:function(e){var n,r=e.htmlTag||(typeof document<"u"?document.documentElement:null);return r&&typeof r.getAttribute=="function"&&(n=r.getAttribute("lang")),n}},ZG={name:"path",lookup:function(e){var n;if(typeof window<"u"){var r=window.location.pathname.match(/\/([a-zA-Z-]*)/g);if(r instanceof Array)if(typeof e.lookupFromPathIndex=="number"){if(typeof r[e.lookupFromPathIndex]!="string")return;n=r[e.lookupFromPathIndex].replace("/","")}else n=r[0].replace("/","")}return n}},KG={name:"subdomain",lookup:function(e){var n;if(typeof window<"u"){var r=window.location.href.match(/(?:http[s]*\:\/\/)*(.*?)\.(?=[^\/]*\..{2,5})/gi);r instanceof Array&&(typeof e.lookupFromSubdomainIndex=="number"?n=r[e.lookupFromSubdomainIndex].replace("http://","").replace("https://","").replace(".",""):n=r[0].replace("http://","").replace("https://","").replace(".",""))}return n}};function qG(){return{order:["querystring","cookie","localStorage","sessionStorage","navigator","htmlTag"],lookupQuerystring:"lng",lookupCookie:"i18next",lookupLocalStorage:"i18nextLng",lookupSessionStorage:"i18nextLng",caches:["localStorage"],excludeCacheFor:["cimode"]}}var a7=function(){function t(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};DG(this,t),this.type="languageDetector",this.detectors={},this.init(e,n)}return BG(t,[{key:"init",value:function(n){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};this.services=n,this.options=HG(r,this.options||{},qG()),this.options.lookupFromUrlIndex&&(this.options.lookupFromPathIndex=this.options.lookupFromUrlIndex),this.i18nOptions=i,this.addDetector(GG),this.addDetector(VG),this.addDetector(WG),this.addDetector(jG),this.addDetector(XG),this.addDetector(YG),this.addDetector(ZG),this.addDetector(KG)}},{key:"addDetector",value:function(n){this.detectors[n.name]=n}},{key:"detect",value:function(n){var r=this;n||(n=this.options.order);var i=[];return n.forEach(function(s){if(r.detectors[s]){var o=r.detectors[s].lookup(r.options);o&&typeof o=="string"&&(o=[o]),o&&(i=i.concat(o))}}),this.services.languageUtils.getBestMatchFromCodes?i:i.length>0?i[0]:null}},{key:"cacheUserLanguage",value:function(n,r){var i=this;r||(r=this.options.caches),r&&(this.options.excludeCacheFor&&this.options.excludeCacheFor.indexOf(n)>-1||r.forEach(function(s){i.detectors[s]&&i.detectors[s].cacheUserLanguage(n,i.options)}))}}]),t}();a7.type="languageDetector";var JG={VITE_APP_BACKEND_V2_GET_URL:"https://json.excalidraw.com/api/v2/",VITE_APP_BACKEND_V2_POST_URL:"https://json.excalidraw.com/api/v2/post/",VITE_APP_LIBRARY_URL:"https://libraries.excalidraw.com",VITE_APP_LIBRARY_BACKEND:"https://us-central1-excalidraw-room-persistence.cloudfunctions.net/libraries",VITE_APP_PORTAL_URL:"https://portal.excalidraw.com",VITE_APP_PLUS_LP:"https://plus.excalidraw.com",VITE_APP_PLUS_APP:"https://app.excalidraw.com",VITE_APP_AI_BACKEND:"https://oss-ai.excalidraw.com",VITE_APP_WS_SERVER_URL:"",VITE_APP_FIREBASE_CONFIG:'{"apiKey":"AIzaSyAd15pYlMci_xIp9ko6wkEsDzAAA0Dn0RU","authDomain":"excalidraw-room-persistence.firebaseapp.com","databaseURL":"https://excalidraw-room-persistence.firebaseio.com","projectId":"excalidraw-room-persistence","storageBucket":"excalidraw-room-persistence.appspot.com","messagingSenderId":"654800341332","appId":"1:654800341332:web:4a692de832b55bd57ce0c1"}',VITE_APP_DISABLE_TRACKING:"",VITE_APP_GIT_SHA:"",BASE_URL:"/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const QG=["ai"],at=(t,e,n,r)=>{try{typeof window>"u"||JG.VITE_WORKER_ID;return}catch(i){console.error("error during analytics",i)}},eV="#ffffff",tV="#000000",nV=["#f8f9fa","#f1f3f5","#e9ecef","#dee2e6","#ced4da","#adb5bd","#868e96","#495057","#343a40","#212529"],rV=["#fff5f5","#ffe3e3","#ffc9c9","#ffa8a8","#ff8787","#ff6b6b","#fa5252","#f03e3e","#e03131","#c92a2a"],iV=["#fff0f6","#ffdeeb","#fcc2d7","#faa2c1","#f783ac","#f06595","#e64980","#d6336c","#c2255c","#a61e4d"],sV=["#f8f0fc","#f3d9fa","#eebefa","#e599f7","#da77f2","#cc5de8","#be4bdb","#ae3ec9","#9c36b5","#862e9c"],oV=["#f3f0ff","#e5dbff","#d0bfff","#b197fc","#9775fa","#845ef7","#7950f2","#7048e8","#6741d9","#5f3dc4"],aV=["#edf2ff","#dbe4ff","#bac8ff","#91a7ff","#748ffc","#5c7cfa","#4c6ef5","#4263eb","#3b5bdb","#364fc7"],lV=["#e7f5ff","#d0ebff","#a5d8ff","#74c0fc","#4dabf7","#339af0","#228be6","#1c7ed6","#1971c2","#1864ab"],cV=["#e3fafc","#c5f6fa","#99e9f2","#66d9e8","#3bc9db","#22b8cf","#15aabf","#1098ad","#0c8599","#0b7285"],uV=["#e6fcf5","#c3fae8","#96f2d7","#63e6be","#38d9a9","#20c997","#12b886","#0ca678","#099268","#087f5b"],dV=["#ebfbee","#d3f9d8","#b2f2bb","#8ce99a","#69db7c","#51cf66","#40c057","#37b24d","#2f9e44","#2b8a3e"],hV=["#f4fce3","#e9fac8","#d8f5a2","#c0eb75","#a9e34b","#94d82d","#82c91e","#74b816","#66a80f","#5c940d"],fV=["#fff9db","#fff3bf","#ffec99","#ffe066","#ffd43b","#fcc419","#fab005","#f59f00","#f08c00","#e67700"],pV=["#fff4e6","#ffe8cc","#ffd8a8","#ffc078","#ffa94d","#ff922b","#fd7e14","#f76707","#e8590c","#d9480f"],Jt={white:eV,black:tV,gray:nV,red:rV,pink:iV,grape:sV,violet:oV,indigo:aV,blue:lV,cyan:cV,teal:uV,green:dV,lime:hV,yellow:fV,orange:pV},mV=(t,e)=>e.reduce((n,r)=>(r in t&&(n[r]=t[r]),n),{}),gV=5,Lu=5,yV=4,yf=4,vf=1,Gi=[0,2,4,6,8],Vi=(t,e)=>e.map(n=>Jt[t][n]),Ge={transparent:"transparent",black:"#1e1e1e",white:"#ffffff",gray:Vi("gray",Gi),red:Vi("red",Gi),pink:Vi("pink",Gi),grape:Vi("grape",Gi),violet:Vi("violet",Gi),blue:Vi("blue",Gi),cyan:Vi("cyan",Gi),teal:Vi("teal",Gi),green:Vi("green",Gi),yellow:Vi("yellow",Gi),orange:Vi("orange",Gi),bronze:["#f8f1ee","#eaddd7","#d2bab0","#a18072","#846358"]},l7=mV(Ge,["cyan","blue","violet","grape","pink","green","teal","yellow","orange","red"]),c7=[Ge.black,Ge.red[yf],Ge.green[yf],Ge.blue[yf],Ge.yellow[yf]],u7=[Ge.transparent,Ge.red[vf],Ge.green[vf],Ge.blue[vf],Ge.yellow[vf]],d7=[Ge.white,"#f8f9fa","#f5faff","#fffce8","#fdf8f6"],vV={transparent:Ge.transparent,white:Ge.white,gray:Ge.gray,black:Ge.black,bronze:Ge.bronze,...l7},bV={transparent:Ge.transparent,white:Ge.white,gray:Ge.gray,black:Ge.black,bronze:Ge.bronze,...l7},_V=t=>[Ge.cyan[t],Ge.blue[t],Ge.violet[t],Ge.grape[t],Ge.pink[t],Ge.green[t],Ge.teal[t],Ge.yellow[t],Ge.orange[t],Ge.red[t]],EV=(t,e,n)=>`#${((1<<24)+(t<<16)+(e<<8)+n).toString(16).slice(1)}`,wV="invert(93%) hue-rotate(180deg)",xV="302px",h7={themeFilter:wV,rightSidebarWidth:xV},uo=/Mac|iPod|iPhone|iPad/.test(navigator.platform),f7=/^Win/.test(navigator.platform),SC=/\b(android)\b/i.test(navigator.userAgent),Av="netscape"in window&&navigator.userAgent.indexOf("rv:")>1&&navigator.userAgent.indexOf("Gecko")>1,TV=navigator.userAgent.indexOf("Chrome")!==-1,p7=!TV&&navigator.userAgent.indexOf("Safari")!==-1,SV=()=>{var t,e;return((e=(t=navigator.brave)==null?void 0:t.isBrave)==null?void 0:e.name)==="isBrave"},Ho="Excalidraw",Gl=10,Fg=8,CV=5,CC=1,IV=30,fl=Math.PI/12,vt={TEXT:"text",CROSSHAIR:"crosshair",GRABBING:"grabbing",GRAB:"grab",POINTER:"pointer",MOVE:"move",AUTO:""},Fh={MAIN:0,WHEEL:1,SECONDARY:2,TOUCH:-1},Vl={enabled:"all",disabled:"none",inheritFromUI:"var(--ui-pointerEvents)"};var ee=(t=>(t.COPY="copy",t.PASTE="paste",t.CUT="cut",t.KEYDOWN="keydown",t.KEYUP="keyup",t.MOUSE_MOVE="mousemove",t.RESIZE="resize",t.UNLOAD="unload",t.FOCUS="focus",t.BLUR="blur",t.DRAG_OVER="dragover",t.DROP="drop",t.GESTURE_END="gestureend",t.BEFORE_UNLOAD="beforeunload",t.GESTURE_START="gesturestart",t.GESTURE_CHANGE="gesturechange",t.POINTER_MOVE="pointermove",t.POINTER_DOWN="pointerdown",t.POINTER_UP="pointerup",t.STATE_CHANGE="statechange",t.WHEEL="wheel",t.TOUCH_START="touchstart",t.TOUCH_END="touchend",t.HASHCHANGE="hashchange",t.VISIBILITY_CHANGE="visibilitychange",t.SCROLL="scroll",t.EXCALIDRAW_LINK="excalidraw-link",t.MENU_ITEM_SELECT="menu.itemSelect",t.MESSAGE="message",t.FULLSCREENCHANGE="fullscreenchange",t))(ee||{});const w1={UNSTARTED:-1,ENDED:0,PLAYING:1,PAUSED:2,BUFFERING:3,CUED:5},m7={SHAPE_ACTIONS_MENU:"App-menu__left"},mr={Virgil:1,Helvetica:2,Cascadia:3,Assistant:4},Vn={LIGHT:"light",DARK:"dark"},Pt={strokeColor:"#bbb",strokeWidth:2,strokeStyle:"solid",fillStyle:"solid",roughness:0,roundness:null,backgroundColor:"transparent",radius:8,nameOffsetY:3,nameColorLightTheme:"#999999",nameColorDarkTheme:"#7a7a7a",nameFontSize:14,nameLineHeight:1.25},IC="Segoe UI Emoji",AT=1,_s=20,ca=mr.Virgil,kv="left",j0="top",g7="{version}",vd=20,kT={svg:"image/svg+xml",png:"image/png",jpg:"image/jpeg",gif:"image/gif",webp:"image/webp",bmp:"image/bmp",ico:"image/x-icon",avif:"image/avif",jfif:"image/jfif"},AV=["text/plain","text/html"],Oe={json:"application/json",excalidraw:"application/vnd.excalidraw+json",excalidrawlib:"application/vnd.excalidrawlib+json","excalidraw.svg":"image/svg+xml","excalidraw.png":"image/png",binary:"application/octet-stream",...kT},hb={png:"png",svg:"svg",clipboard:"clipboard"},ki={excalidraw:"excalidraw",excalidrawClipboard:"excalidraw/clipboard",excalidrawLibrary:"excalidrawlib",excalidrawClipboardWithAPI:"excalidraw-api/clipboard"},MT=window.EXCALIDRAW_EXPORT_SOURCE||window.location.origin,kV=500,MV=300,PV=500,LV=1e4,RV=3e4,OV=100,Op=.1,y7=.1,DV=300,AC=6e4,kC=3e3,PT=h7.themeFilter,dw={addLibrary:"addLibrary"},hw={addLibrary:"addLibrary"},MC={canvasActions:{changeViewBackgroundColor:!0,clearCanvas:!0,export:{saveFileToDisk:!0},loadScene:!0,saveToActiveFile:!0,toggleTheme:null,saveAsImage:!0},tools:{image:!0}},NV=730,FV=1e3,BV=500,UV=1229,$V=parseInt(h7.rightSidebarWidth),Bh=2,LT=[1,2,3],oh=10,HV=1440,PC=2*1024*1024,Kt="http://www.w3.org/2000/svg",v7=128,Mv={excalidraw:2,excalidrawLibrary:2},Ln=5,zV=.7,GV=11,ai={TOP:"top",MIDDLE:"middle",BOTTOM:"bottom"},Dp={LEFT:"left",CENTER:"center",RIGHT:"right"},VV=20,fb=.25,WV=32,jn={LEGACY:1,PROPORTIONAL_RADIUS:2,ADAPTIVE_RADIUS:3},Ua="__precedingElement__",b7={architect:0,artist:1,cartoonist:2},pb={thin:1,bold:2,extraBold:4},en={strokeColor:Ge.black,backgroundColor:Ge.transparent,fillStyle:"solid",strokeWidth:2,strokeStyle:"solid",roughness:b7.artist,opacity:100,locked:!1},RT="library",bd={name:"default",defaultTab:RT},_7=new Set(["iframe","embeddable","image"]),kr={selection:"selection",rectangle:"rectangle",diamond:"diamond",ellipse:"ellipse",arrow:"arrow",line:"line",freedraw:"freedraw",text:"text",image:"image",eraser:"eraser",hand:"hand",frame:"frame",magicframe:"magicframe",embeddable:"embeddable",laser:"laser"},il={OAI_API_KEY:"excalidraw-oai-api-key",MERMAID_TO_EXCALIDRAW:"mermaid-to-excalidraw",PUBLISH_LIBRARY:"publish-library-data"},jV="modulepreload",XV=function(t){return"/"+t},LC={},pe=function(e,n,r){let i=Promise.resolve();if(n&&n.length>0){const s=document.getElementsByTagName("link");i=Promise.all(n.map(o=>{if(o=XV(o),o in LC)return;LC[o]=!0;const a=o.endsWith(".css"),l=a?'[rel="stylesheet"]':"";if(!!r)for(let d=s.length-1;d>=0;d--){const h=s[d];if(h.href===o&&(!a||h.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${o}"]${l}`))return;const u=document.createElement("link");if(u.rel=a?"stylesheet":jV,a||(u.as="script",u.crossOrigin=""),u.href=o,document.head.appendChild(u),a)return new Promise((d,h)=>{u.addEventListener("load",d),u.addEventListener("error",()=>h(new Error(`Unable to preload CSS for ${o}`)))})}))}return i.then(()=>e()).catch(s=>{const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=s,window.dispatchEvent(o),!o.defaultPrevented)throw s})},YV=(t,e)=>{const n=t[e];return n?typeof n=="function"?n():Promise.resolve(n):new Promise((r,i)=>{(typeof queueMicrotask=="function"?queueMicrotask:setTimeout)(i.bind(null,new Error("Unknown variable dynamic import: "+e)))})},E7={paste:"Paste",pasteAsPlaintext:"Paste as plaintext",pasteCharts:"Paste charts",selectAll:"Select all",multiSelect:"Add element to selection",moveCanvas:"Move canvas",cut:"Cut",copy:"Copy",copyAsPng:"Copy to clipboard as PNG",copyAsSvg:"Copy to clipboard as SVG",copyText:"Copy to clipboard as text",copySource:"Copy source to clipboard",convertToCode:"Convert to code",bringForward:"Bring forward",sendToBack:"Send to back",bringToFront:"Bring to front",sendBackward:"Send backward",delete:"Delete",copyStyles:"Copy styles",pasteStyles:"Paste styles",stroke:"Stroke",background:"Background",fill:"Fill",strokeWidth:"Stroke width",strokeStyle:"Stroke style",strokeStyle_solid:"Solid",strokeStyle_dashed:"Dashed",strokeStyle_dotted:"Dotted",sloppiness:"Sloppiness",opacity:"Opacity",textAlign:"Text align",edges:"Edges",sharp:"Sharp",round:"Round",arrowheads:"Arrowheads",arrowhead_none:"None",arrowhead_arrow:"Arrow",arrowhead_bar:"Bar",arrowhead_circle:"Circle",arrowhead_circle_outline:"Circle (outline)",arrowhead_triangle:"Triangle",arrowhead_triangle_outline:"Triangle (outline)",arrowhead_diamond:"Diamond",arrowhead_diamond_outline:"Diamond (outline)",fontSize:"Font size",fontFamily:"Font family",addWatermark:'Add "Made with Excalidraw"',handDrawn:"Hand-drawn",normal:"Normal",code:"Code",small:"Small",medium:"Medium",large:"Large",veryLarge:"Very large",solid:"Solid",hachure:"Hachure",zigzag:"Zigzag",crossHatch:"Cross-hatch",thin:"Thin",bold:"Bold",left:"Left",center:"Center",right:"Right",extraBold:"Extra bold",architect:"Architect",artist:"Artist",cartoonist:"Cartoonist",fileTitle:"File name",colorPicker:"Color picker",canvasColors:"Used on canvas",canvasBackground:"Canvas background",drawingCanvas:"Drawing canvas",layers:"Layers",actions:"Actions",language:"Language",liveCollaboration:"Live collaboration...",duplicateSelection:"Duplicate",untitled:"Untitled",name:"Name",yourName:"Your name",madeWithExcalidraw:"Made with Excalidraw",group:"Group selection",ungroup:"Ungroup selection",collaborators:"Collaborators",showGrid:"Show grid",addToLibrary:"Add to library",removeFromLibrary:"Remove from library",libraryLoadingMessage:"Loading library…",libraries:"Browse libraries",loadingScene:"Loading scene…",align:"Align",alignTop:"Align top",alignBottom:"Align bottom",alignLeft:"Align left",alignRight:"Align right",centerVertically:"Center vertically",centerHorizontally:"Center horizontally",distributeHorizontally:"Distribute horizontally",distributeVertically:"Distribute vertically",flipHorizontal:"Flip horizontal",flipVertical:"Flip vertical",viewMode:"View mode",share:"Share",showStroke:"Show stroke color picker",showBackground:"Show background color picker",toggleTheme:"Toggle theme",personalLib:"Personal Library",excalidrawLib:"Excalidraw Library",decreaseFontSize:"Decrease font size",increaseFontSize:"Increase font size",unbindText:"Unbind text",bindText:"Bind text to the container",createContainerFromText:"Wrap text in a container",link:{edit:"Edit link",editEmbed:"Edit link & embed",create:"Create link",createEmbed:"Create link & embed",label:"Link",labelEmbed:"Link & embed",empty:"No link is set"},lineEditor:{edit:"Edit line",exit:"Exit line editor"},elementLock:{lock:"Lock",unlock:"Unlock",lockAll:"Lock all",unlockAll:"Unlock all"},statusPublished:"Published",sidebarLock:"Keep sidebar open",selectAllElementsInFrame:"Select all elements in frame",removeAllElementsFromFrame:"Remove all elements from frame",eyeDropper:"Pick color from canvas",textToDiagram:"Text to diagram",prompt:"Prompt"},w7={noItems:"No items added yet...",hint_emptyLibrary:"Select an item on canvas to add it here, or install a library from the public repository, below.",hint_emptyPrivateLibrary:"Select an item on canvas to add it here."},x7={clearReset:"Reset the canvas",exportJSON:"Export to file",exportImage:"Export image...",export:"Save to...",copyToClipboard:"Copy to clipboard",save:"Save to current file",saveAs:"Save as",load:"Open",getShareableLink:"Get shareable link",close:"Close",selectLanguage:"Select language",scrollBackToContent:"Scroll back to content",zoomIn:"Zoom in",zoomOut:"Zoom out",resetZoom:"Reset zoom",menu:"Menu",done:"Done",edit:"Edit",undo:"Undo",redo:"Redo",resetLibrary:"Reset library",createNewRoom:"Create new room",fullScreen:"Full screen",darkMode:"Dark mode",lightMode:"Light mode",zenMode:"Zen mode",objectsSnapMode:"Snap to objects",exitZenMode:"Exit zen mode",cancel:"Cancel",clear:"Clear",remove:"Remove",embed:"Toggle embedding",publishLibrary:"Publish",submit:"Submit",confirm:"Confirm",embeddableInteractionButton:"Click to interact"},T7={clearReset:"This will clear the whole canvas. Are you sure?",couldNotCreateShareableLink:"Couldn't create shareable link.",couldNotCreateShareableLinkTooBig:"Couldn't create shareable link: the scene is too big",couldNotLoadInvalidFile:"Couldn't load invalid file",importBackendFailed:"Importing from backend failed.",cannotExportEmptyCanvas:"Cannot export empty canvas.",couldNotCopyToClipboard:"Couldn't copy to clipboard.",decryptFailed:"Couldn't decrypt data.",uploadedSecurly:"The upload has been secured with end-to-end encryption, which means that Excalidraw server and third parties can't read the content.",loadSceneOverridePrompt:"Loading external drawing will replace your existing content. Do you wish to continue?",collabStopOverridePrompt:`Stopping the session will overwrite your previous, locally stored drawing. Are you sure?

(If you want to keep your local drawing, simply close the browser tab instead.)`,errorAddingToLibrary:"Couldn't add item to the library",errorRemovingFromLibrary:"Couldn't remove item from the library",confirmAddLibrary:"This will add {{numShapes}} shape(s) to your library. Are you sure?",imageDoesNotContainScene:"This image does not seem to contain any scene data. Have you enabled scene embedding during export?",cannotRestoreFromImage:"Scene couldn't be restored from this image file",invalidSceneUrl:"Couldn't import scene from the supplied URL. It's either malformed, or doesn't contain valid Excalidraw JSON data.",resetLibrary:"This will clear your library. Are you sure?",removeItemsFromsLibrary:"Delete {{count}} item(s) from library?",invalidEncryptionKey:"Encryption key must be of 22 characters. Live collaboration is disabled.",collabOfflineWarning:`No internet connection available.
Your changes will not be saved!`},S7={unsupportedFileType:"Unsupported file type.",imageInsertError:"Couldn't insert image. Try again later...",fileTooBig:"File is too big. Maximum allowed size is {{maxSize}}.",svgImageInsertError:"Couldn't insert SVG image. The SVG markup looks invalid.",failedToFetchImage:"Failed to fetch image.",invalidSVGString:"Invalid SVG.",cannotResolveCollabServer:"Couldn't connect to the collab server. Please reload the page and try again.",importLibraryError:"Couldn't load library",collabSaveFailed:"Couldn't save to the backend database. If problems persist, you should save your file locally to ensure you don't lose your work.",collabSaveFailed_sizeExceeded:"Couldn't save to the backend database, the canvas seems to be too big. You should save the file locally to ensure you don't lose your work.",imageToolNotSupported:"Images are disabled.",brave_measure_text_error:{line1:"Looks like you are using Brave browser with the <bold>Aggressively Block Fingerprinting</bold> setting enabled.",line2:"This could result in breaking the <bold>Text Elements</bold> in your drawings.",line3:"We strongly recommend disabling this setting. You can follow <link>these steps</link> on how to do so.",line4:"If disabling this setting doesn't fix the display of text elements, please open an <issueLink>issue</issueLink> on our GitHub, or write us on <discordLink>Discord</discordLink>"},libraryElementTypeError:{embeddable:"Embeddable elements cannot be added to the library.",iframe:"IFrame elements cannot be added to the library.",image:"Support for adding images to the library coming soon!"},asyncPasteFailedOnRead:"Couldn't paste (couldn't read from system clipboard).",asyncPasteFailedOnParse:"Couldn't paste.",copyToSystemClipboardFailed:"Couldn't copy to clipboard."},C7={selection:"Selection",image:"Insert image",rectangle:"Rectangle",diamond:"Diamond",ellipse:"Ellipse",arrow:"Arrow",line:"Line",freedraw:"Draw",text:"Text",library:"Library",lock:"Keep selected tool active after drawing",penMode:"Pen mode - prevent touch",link:"Add/ Update link for a selected shape",eraser:"Eraser",frame:"Frame tool",magicframe:"Wireframe to code",embeddable:"Web Embed",laser:"Laser pointer",hand:"Hand (panning tool)",extraTools:"More tools",mermaidToExcalidraw:"Mermaid to Excalidraw",magicSettings:"AI settings"},I7={canvasActions:"Canvas actions",selectedShapeActions:"Selected shape actions",shapes:"Shapes"},A7={canvasPanning:"To move canvas, hold mouse wheel or spacebar while dragging, or use the hand tool",linearElement:"Click to start multiple points, drag for single line",freeDraw:"Click and drag, release when you're finished",text:"Tip: you can also add text by double-clicking anywhere with the selection tool",embeddable:"Click-drag to create a website embed",text_selected:"Double-click or press ENTER to edit text",text_editing:"Press Escape or CtrlOrCmd+ENTER to finish editing",linearElementMulti:"Click on last point or press Escape or Enter to finish",lockAngle:"You can constrain angle by holding SHIFT",resize:`You can constrain proportions by holding SHIFT while resizing,
hold ALT to resize from the center`,resizeImage:`You can resize freely by holding SHIFT,
hold ALT to resize from the center`,rotate:"You can constrain angles by holding SHIFT while rotating",lineEditor_info:"Hold CtrlOrCmd and Double-click or press CtrlOrCmd + Enter to edit points",lineEditor_pointSelected:`Press Delete to remove point(s),
CtrlOrCmd+D to duplicate, or drag to move`,lineEditor_nothingSelected:`Select a point to edit (hold SHIFT to select multiple),
or hold Alt and click to add new points`,placeImage:"Click to place the image, or click and drag to set its size manually",publishLibrary:"Publish your own library",bindTextToElement:"Press enter to add text",deepBoxSelect:"Hold CtrlOrCmd to deep select, and to prevent dragging",eraserRevert:"Hold Alt to revert the elements marked for deletion",firefox_clipboard_write:'This feature can likely be enabled by setting the "dom.events.asyncClipboard.clipboardItem" flag to "true". To change the browser flags in Firefox, visit the "about:config" page.',disableSnapping:"Hold CtrlOrCmd to disable snapping"},k7={cannotShowPreview:"Cannot show preview",canvasTooBig:"The canvas may be too big.",canvasTooBigTip:"Tip: try moving the farthest elements a bit closer together."},M7={headingMain:"Encountered an error. Try <button>reloading the page</button>.",clearCanvasMessage:"If reloading doesn't work, try <button>clearing the canvas</button>.",clearCanvasCaveat:" This will result in loss of work ",trackedToSentry:"The error with identifier {{eventId}} was tracked on our system.",openIssueMessage:"We were very cautious not to include your scene information on the error. If your scene is not private, please consider following up on our <button>bug tracker</button>. Please include information below by copying and pasting into the GitHub issue.",sceneContent:"Scene content:"},P7={desc_intro:"You can invite people to your current scene to collaborate with you.",desc_privacy:"Don't worry, the session uses end-to-end encryption, so whatever you draw will stay private. Not even our server will be able to see what you come up with.",button_startSession:"Start session",button_stopSession:"Stop session",desc_inProgressIntro:"Live-collaboration session is now in progress.",desc_shareLink:"Share this link with anyone you want to collaborate with:",desc_exitSession:"Stopping the session will disconnect you from the room, but you'll be able to continue working with the scene, locally. Note that this won't affect other people, and they'll still be able to collaborate on their version.",shareTitle:"Join a live collaboration session on Excalidraw"},L7={title:"Error"},R7={disk_title:"Save to disk",disk_details:"Export the scene data to a file from which you can import later.",disk_button:"Save to file",link_title:"Shareable link",link_details:"Export as a read-only link.",link_button:"Export to Link",excalidrawplus_description:"Save the scene to your Excalidraw+ workspace.",excalidrawplus_button:"Export",excalidrawplus_exportError:"Couldn't export to Excalidraw+ at this moment..."},O7={blog:"Read our blog",click:"click",deepSelect:"Deep select",deepBoxSelect:"Deep select within box, and prevent dragging",curvedArrow:"Curved arrow",curvedLine:"Curved line",documentation:"Documentation",doubleClick:"double-click",drag:"drag",editor:"Editor",editLineArrowPoints:"Edit line/arrow points",editText:"Edit text / add label",github:"Found an issue? Submit",howto:"Follow our guides",or:"or",preventBinding:"Prevent arrow binding",tools:"Tools",shortcuts:"Keyboard shortcuts",textFinish:"Finish editing (text editor)",textNewLine:"Add new line (text editor)",title:"Help",view:"View",zoomToFit:"Zoom to fit all elements",zoomToSelection:"Zoom to selection",toggleElementLock:"Lock/unlock selection",movePageUpDown:"Move page up/down",movePageLeftRight:"Move page left/right"},D7={title:"Clear canvas"},N7={title:"Publish library",itemName:"Item name",authorName:"Author name",githubUsername:"GitHub username",twitterUsername:"Twitter username",libraryName:"Library name",libraryDesc:"Library description",website:"Website",placeholder:{authorName:"Your name or username",libraryName:"Name of your library",libraryDesc:"Description of your library to help people understand its usage",githubHandle:"GitHub handle (optional), so you can edit the library once submitted for review",twitterHandle:"Twitter username (optional), so we know who to credit when promoting over Twitter",website:"Link to your personal website or elsewhere (optional)"},errors:{required:"Required",website:"Enter a valid URL"},noteDescription:"Submit your library to be included in the <link>public library repository</link> for other people to use in their drawings.",noteGuidelines:"The library needs to be manually approved first. Please read the <link>guidelines</link> before submitting. You will need a GitHub account to communicate and make changes if requested, but it is not strictly required.",noteLicense:"By submitting, you agree the library will be published under the <link>MIT License</link>, which in short means anyone can use them without restrictions.",noteItems:"Each library item must have its own name so it's filterable. The following library items will be included:",atleastOneLibItem:"Please select at least one library item to get started",republishWarning:"Note: some of the selected items are marked as already published/submitted. You should only resubmit items when updating an existing library or submission."},F7={title:"Library submitted",content:"Thank you {{authorName}}. Your library has been submitted for review. You can track the status <link>here</link>"},B7={resetLibrary:"Reset library",removeItemsFromLib:"Remove selected items from library"},U7={header:"Export image",label:{withBackground:"Background",onlySelected:"Only selected",darkMode:"Dark mode",embedScene:"Embed scene",scale:"Scale",padding:"Padding"},tooltip:{embedScene:`Scene data will be saved into the exported PNG/SVG file so that the scene can be restored from it.
Will increase exported file size.`},title:{exportToPng:"Export to PNG",exportToSvg:"Export to SVG",copyPngToClipboard:"Copy PNG to clipboard"},button:{exportToPng:"PNG",exportToSvg:"SVG",copyPngToClipboard:"Copy to clipboard"}},$7={tooltip:"Your drawings are end-to-end encrypted so Excalidraw's servers will never see them.",link:"Blog post on end-to-end encryption in Excalidraw"},H7={angle:"Angle",element:"Element",elements:"Elements",height:"Height",scene:"Scene",selected:"Selected",storage:"Storage",title:"Stats for nerds",total:"Total",version:"Version",versionCopy:"Click to copy",versionNotAvailable:"Version not available",width:"Width"},z7={addedToLibrary:"Added to library",copyStyles:"Copied styles.",copyToClipboard:"Copied to clipboard.",copyToClipboardAsPng:`Copied {{exportSelection}} to clipboard as PNG
({{exportColorScheme}})`,fileSaved:"File saved.",fileSavedToFilename:"Saved to {filename}",canvas:"canvas",selection:"selection",pasteAsSingleElement:`Use {{shortcut}} to paste as a single element,
or paste into an existing text editor`,unableToEmbed:"Embedding this url is currently not allowed. Raise an issue on GitHub to request the url whitelisted",unrecognizedLinkFormat:"The link you embedded does not match the expected format. Please try to paste the 'embed' string provided by the source site"},G7={transparent:"Transparent",black:"Black",white:"White",red:"Red",pink:"Pink",grape:"Grape",violet:"Violet",gray:"Gray",blue:"Blue",cyan:"Cyan",teal:"Teal",green:"Green",yellow:"Yellow",orange:"Orange",bronze:"Bronze"},V7={app:{center_heading:"All your data is saved locally in your browser.",center_heading_plus:"Did you want to go to the Excalidraw+ instead?",menuHint:"Export, preferences, languages, ..."},defaults:{menuHint:"Export, preferences, and more...",center_heading:"Diagrams. Made. Simple.",toolbarHint:"Pick a tool & Start drawing!",helpHint:"Shortcuts & help"}},W7={mostUsedCustomColors:"Most used custom colors",colors:"Colors",shades:"Shades",hexCode:"Hex code",noShades:"No shades available for this color"},j7={action:{exportToImage:{title:"Export as image",button:"Export as image",description:"Export the scene data as an image from which you can import later."},saveToDisk:{title:"Save to disk",button:"Save to disk",description:"Export the scene data to a file from which you can import later."},excalidrawPlus:{title:"Excalidraw+",button:"Export to Excalidraw+",description:"Save the scene to your Excalidraw+ workspace."}},modal:{loadFromFile:{title:"Load from file",button:"Load from file",description:"Loading from a file will <bold>replace your existing content</bold>.<br></br>You can back up your drawing first using one of the options below."},shareableLink:{title:"Load from link",button:"Replace my content",description:"Loading external drawing will <bold>replace your existing content</bold>.<br></br>You can back up your drawing first by using one of the options below."}}},X7={title:"Mermaid to Excalidraw",button:"Insert",description:"Currently only <flowchartLink>Flowchart</flowchartLink>,<sequenceLink> Sequence, </sequenceLink> and <classLink>Class </classLink>Diagrams are supported. The other types will be rendered as image in Excalidraw.",syntax:"Mermaid Syntax",preview:"Preview"},Y7={search:{placeholder:"Quick search",empty:"No users found"},hint:{text:"Click on user to follow",followStatus:"You're currently following this user"}},OT={labels:E7,library:w7,buttons:x7,alerts:T7,errors:S7,toolBar:C7,headings:I7,hints:A7,canvasError:k7,errorSplash:M7,roomDialog:P7,errorDialog:L7,exportDialog:R7,helpDialog:O7,clearCanvasDialog:D7,publishDialog:N7,publishSuccessDialog:F7,confirmDialog:B7,imageExportDialog:U7,encrypted:$7,stats:H7,toast:z7,colors:G7,welcomeScreen:V7,colorPicker:W7,overwriteConfirm:j7,mermaid:X7,userList:Y7},ZV=Object.freeze(Object.defineProperty({__proto__:null,alerts:T7,buttons:x7,canvasError:k7,clearCanvasDialog:D7,colorPicker:W7,colors:G7,confirmDialog:B7,default:OT,encrypted:$7,errorDialog:L7,errorSplash:M7,errors:S7,exportDialog:R7,headings:I7,helpDialog:O7,hints:A7,imageExportDialog:U7,labels:E7,library:w7,mermaid:X7,overwriteConfirm:j7,publishDialog:N7,publishSuccessDialog:F7,roomDialog:P7,stats:H7,toast:z7,toolBar:C7,userList:Y7,welcomeScreen:V7},Symbol.toStringTag,{value:"Module"})),Z7=100,K7=36,q7={"ar-SA":94,"az-AZ":17,"bg-BG":71,"bn-BD":52,"ca-ES":83,"cs-CZ":86,"da-DK":61,"de-DE":100,"el-GR":80,en:Z7,"es-ES":96,"eu-ES":97,"fa-IR":84,"fi-FI":76,"fr-FR":99,"gl-ES":86,"he-IL":77,"hi-IN":76,"hu-HU":76,"id-ID":91,"it-IT":98,"ja-JP":90,kaa:K7,"kab-KAB":76,"kk-KZ":18,"km-KH":83,"ko-KR":100,"ku-TR":87,"lt-LT":48,"lv-LV":77,"mr-IN":98,"my-MM":35,"nb-NO":93,"nl-NL":75,"nn-NO":67,"oc-FR":92,"pa-IN":78,"pl-PL":99,"pt-BR":91,"pt-PT":83,"ro-RO":99,"ru-RU":92,"si-LK":7,"sk-SK":100,"sl-SI":100,"sv-SE":100,"ta-IN":81,"th-TH":44,"tr-TR":87,"uk-UA":93,"vi-VN":49,"zh-CN":100,"zh-HK":22,"zh-TW":100},KV=Object.freeze(Object.defineProperty({__proto__:null,default:q7,en:Z7,kaa:K7},Symbol.toStringTag,{value:"Module"}));let qV=0;function JV(t,e){const n=`atom${++qV}`,r={toString:()=>n};return typeof t=="function"?r.read=t:(r.init=t,r.read=i=>i(r),r.write=(i,s,o)=>s(r,typeof o=="function"?o(i(r)):o)),e&&(r.write=e),r}var ti={VITE_APP_BACKEND_V2_GET_URL:"https://json.excalidraw.com/api/v2/",VITE_APP_BACKEND_V2_POST_URL:"https://json.excalidraw.com/api/v2/post/",VITE_APP_LIBRARY_URL:"https://libraries.excalidraw.com",VITE_APP_LIBRARY_BACKEND:"https://us-central1-excalidraw-room-persistence.cloudfunctions.net/libraries",VITE_APP_PORTAL_URL:"https://portal.excalidraw.com",VITE_APP_PLUS_LP:"https://plus.excalidraw.com",VITE_APP_PLUS_APP:"https://app.excalidraw.com",VITE_APP_AI_BACKEND:"https://oss-ai.excalidraw.com",VITE_APP_WS_SERVER_URL:"",VITE_APP_FIREBASE_CONFIG:'{"apiKey":"AIzaSyAd15pYlMci_xIp9ko6wkEsDzAAA0Dn0RU","authDomain":"excalidraw-room-persistence.firebaseapp.com","databaseURL":"https://excalidraw-room-persistence.firebaseio.com","projectId":"excalidraw-room-persistence","storageBucket":"excalidraw-room-persistence.appspot.com","messagingSenderId":"654800341332","appId":"1:654800341332:web:4a692de832b55bd57ce0c1"}',VITE_APP_DISABLE_TRACKING:"",VITE_APP_GIT_SHA:"",BASE_URL:"/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const pl=Symbol(),fw=t=>!!t[pl],x1=t=>!t[pl].c,Uh=t=>{var e;const{b:n,c:r}=t[pl];r&&(r(),(e=eW.get(n))==null||e())},Bg=(t,e)=>{const n=t[pl].o,r=e[pl].o;return n===r||t===r||fw(n)&&Bg(n,e)},pw=(t,e)=>{const n={b:t,o:e,c:null},r=new Promise(i=>{n.c=()=>{n.c=null,i()},e.finally(n.c)});return r[pl]=n,r},QV=t=>pw(t[pl].b,t[pl].o),eW=new WeakMap,T1=t=>"init"in t,Np="r",X0="w",Fp="c",Y0="s",RC="h",tW="n",nW="l",rW="a",iW="m",J7=t=>{const e=new WeakMap,n=new WeakMap,r=new Map;let i,s;if((ti&&"production")!=="production"&&(i=new Set,s=new Set),t)for(const[$,B]of t){const G={v:B,r:0,y:!0,d:new Map};(ti&&"production")!=="production"&&(Object.freeze(G),T1($)||console.warn("Found initial value for derived atom which can cause unexpected behavior",$)),e.set($,G)}const o=new WeakMap,a=($,B,G)=>{let Y=o.get(B);Y||(Y=new Map,o.set(B,Y)),G.then(()=>{Y.get($)===G&&(Y.delete($),Y.size||o.delete(B))}),Y.set($,G)},l=$=>{const B=new Set,G=o.get($);return G&&(o.delete($),G.forEach((Y,X)=>{Uh(Y),B.add(X)})),B},c=new WeakMap,u=$=>{let B=c.get($);return B||(B=new Map,c.set($,B)),B},d=($,B)=>{if($){const G=u($);let Y=G.get(B);return Y||(Y=d($.p,B),Y&&"p"in Y&&x1(Y.p)&&(Y=void 0),Y&&G.set(B,Y)),Y}return e.get(B)},h=($,B,G)=>{if((ti&&"production")!=="production"&&Object.freeze(G),$)u($).set(B,G);else{const Y=e.get(B);e.set(B,G),r.has(B)||r.set(B,Y)}},f=($,B=new Map,G)=>{if(!G)return B;const Y=new Map;let X=!1;return G.forEach(J=>{var ne;const se=((ne=d($,J))==null?void 0:ne.r)||0;Y.set(J,se),B.get(J)!==se&&(X=!0)}),B.size===Y.size&&!X?B:Y},p=($,B,G,Y,X)=>{const J=d($,B);if(J){if(X&&(!("p"in J)||!Bg(J.p,X)))return J;"p"in J&&Uh(J.p)}const ne={v:G,r:(J==null?void 0:J.r)||0,y:!0,d:f($,J==null?void 0:J.d,Y)};let se=!(J!=null&&J.y);return!J||!("v"in J)||!Object.is(J.v,G)?(se=!0,++ne.r,ne.d.has(B)&&(ne.d=new Map(ne.d).set(B,ne.r))):ne.d!==J.d&&(ne.d.size!==J.d.size||!Array.from(ne.d.keys()).every(Ue=>J.d.has(Ue)))&&(se=!0,Promise.resolve().then(()=>{W($)})),J&&!se?J:(h($,B,ne),ne)},m=($,B,G,Y,X)=>{const J=d($,B);if(J){if(X&&(!("p"in J)||!Bg(J.p,X)))return J;"p"in J&&Uh(J.p)}const ne={e:G,r:((J==null?void 0:J.r)||0)+1,y:!0,d:f($,J==null?void 0:J.d,Y)};return h($,B,ne),ne},v=($,B,G,Y)=>{const X=d($,B);if(X&&"p"in X){if(Bg(X.p,G)&&!x1(X.p))return X.y?X:{...X,y:!0};Uh(X.p)}a($,B,G);const J={p:G,r:((X==null?void 0:X.r)||0)+1,y:!0,d:f($,X==null?void 0:X.d,Y)};return h($,B,J),J},y=($,B,G,Y)=>{if(G instanceof Promise){const X=pw(G,G.then(J=>{p($,B,J,Y,X)}).catch(J=>{if(J instanceof Promise)return fw(J)?J.then(()=>{_($,B,!0)}):J;m($,B,J,Y,X)}));return v($,B,X,Y)}return p($,B,G,Y)},b=($,B)=>{const G=d($,B);if(G){const Y={...G,y:!1};h($,B,Y)}else(ti&&"production")!=="production"&&console.warn("[Bug] could not invalidate non existing atom",B)},_=($,B,G)=>{if(!G){const X=d($,B);if(X){if(X.y&&"p"in X&&!x1(X.p))return X;if(X.d.forEach((J,ne)=>{if(ne!==B)if(!n.has(ne))_($,ne);else{const se=d($,ne);se&&!se.y&&_($,ne)}}),Array.from(X.d).every(([J,ne])=>{const se=d($,J);return se&&!("p"in se)&&se.r===ne}))return X.y?X:{...X,y:!0}}}const Y=new Set;try{const X=B.read(J=>{Y.add(J);const ne=J===B?d($,J):_($,J);if(ne){if("e"in ne)throw ne.e;if("p"in ne)throw ne.p;return ne.v}if(T1(J))return J.init;throw new Error("no atom init")});return y($,B,X,Y)}catch(X){if(X instanceof Promise){const J=fw(X)&&x1(X)?QV(X):pw(X,X);return v($,B,J,Y)}return m($,B,X,Y)}},E=($,B)=>_(B,$),w=($,B)=>{let G=n.get(B);return G||(G=N($,B)),G},x=($,B)=>!B.l.size&&(!B.t.size||B.t.size===1&&B.t.has($)),T=($,B)=>{const G=n.get(B);G&&x(B,G)&&R($,B)},C=($,B)=>{const G=n.get(B);G==null||G.t.forEach(Y=>{Y!==B&&(b($,Y),C($,Y))})},k=($,B,G)=>{let Y=!0;const X=(se,Ue)=>{const De=_($,se);if("e"in De)throw De.e;if("p"in De){if(Ue!=null&&Ue.unstable_promise)return De.p.then(()=>{const Le=d($,se);return Le&&"p"in Le&&Le.p===De.p?new Promise(fe=>setTimeout(fe)).then(()=>X(se,Ue)):X(se,Ue)});throw(ti&&"production")!=="production"&&console.info("Reading pending atom state in write operation. We throw a promise for now.",se),De.p}if("v"in De)return De.v;throw(ti&&"production")!=="production"&&console.warn("[Bug] no value found while reading atom in write operation. This is probably a bug.",se),new Error("no value found")},J=(se,Ue)=>{let De;if(se===B){if(!T1(se))throw new Error("atom not writable");l(se).forEach(Xe=>{Xe!==$&&y(Xe,se,Ue)});const fe=d($,se),ke=y($,se,Ue);fe!==ke&&C($,se)}else De=k($,se,Ue);return Y||W($),De},ne=B.write(X,J,G);return Y=!1,ne},L=($,B,G)=>{const Y=k(G,$,B);return W(G),Y},F=$=>!!$.write,N=($,B,G)=>{const Y={t:new Set(G&&[G]),l:new Set};if(n.set(B,Y),(ti&&"production")!=="production"&&s.add(B),_(void 0,B).d.forEach((J,ne)=>{const se=n.get(ne);se?se.t.add(B):ne!==B&&N($,ne,B)}),F(B)&&B.onMount){const J=se=>L(B,se,$),ne=B.onMount(J);$=void 0,ne&&(Y.u=ne)}return Y},R=($,B)=>{var G;const Y=(G=n.get(B))==null?void 0:G.u;Y&&Y(),n.delete(B),(ti&&"production")!=="production"&&s.delete(B);const X=d($,B);X?("p"in X&&Uh(X.p),X.d.forEach((J,ne)=>{if(ne!==B){const se=n.get(ne);se&&(se.t.delete(B),x(ne,se)&&R($,ne))}})):(ti&&"production")!=="production"&&console.warn("[Bug] could not find atom state to unmount",B)},H=($,B,G,Y)=>{const X=new Set(G.d.keys());Y==null||Y.forEach((J,ne)=>{if(X.has(ne)){X.delete(ne);return}const se=n.get(ne);se&&(se.t.delete(B),x(ne,se)&&R($,ne))}),X.forEach(J=>{const ne=n.get(J);ne?ne.t.add(B):n.has(B)&&N($,J,B)})},W=$=>{if($){u($).forEach((G,Y)=>{const X=e.get(Y);if(G!==X){const J=n.get(Y);J==null||J.l.forEach(ne=>ne($))}});return}for(;r.size;){const B=Array.from(r);r.clear(),B.forEach(([G,Y])=>{const X=d(void 0,G);if(X&&X.d!==(Y==null?void 0:Y.d)&&H(void 0,G,X,Y==null?void 0:Y.d),Y&&!Y.y&&(X!=null&&X.y))return;const J=n.get(G);J==null||J.l.forEach(ne=>ne())})}(ti&&"production")!=="production"&&i.forEach(B=>B())},q=$=>{u($).forEach((G,Y)=>{const X=e.get(Y);(!X||G.r>X.r||G.y!==X.y||G.r===X.r&&G.d!==X.d)&&(e.set(Y,G),G.d!==(X==null?void 0:X.d)&&H($,Y,G,X==null?void 0:X.d))})},Z=($,B)=>{B&&q(B),W(void 0)},j=($,B,G)=>{const X=w(G,$).l;return X.add(B),()=>{X.delete(B),T(G,$)}},K=($,B)=>{for(const[G,Y]of $)T1(G)&&(y(B,G,Y),C(B,G));W(B)};return(ti&&"production")!=="production"?{[Np]:E,[X0]:L,[Fp]:Z,[Y0]:j,[RC]:K,[tW]:$=>(i.add($),()=>{i.delete($)}),[nW]:()=>s.values(),[rW]:$=>e.get($),[iW]:$=>n.get($)}:{[Np]:E,[X0]:L,[Fp]:Z,[Y0]:j,[RC]:K}},Q7=t=>{const e=J7(t),n=o=>{const a=e[Np](o);if("e"in a)throw a.e;if(!("p"in a))return a.v},r=o=>new Promise((a,l)=>{const c=e[Np](o);"e"in c?l(c.e):"p"in c?a(c.p.then(()=>r(o))):a(c.v)});return{get:n,asyncGet:r,set:(o,a)=>e[X0](o,a),sub:(o,a)=>e[Y0](o,a),SECRET_INTERNAL_store:e}},eR=(t,e)=>({s:e?e(t).SECRET_INTERNAL_store:J7(t)}),mb=new Map,DT=t=>(mb.has(t)||mb.set(t,A.createContext(eR())),mb.get(t)),NT=({children:t,initialValues:e,scope:n,unstable_createStore:r,unstable_enableVersionedWrite:i})=>{const[s,o]=A.useState({});A.useEffect(()=>{const c=a.current;c.w&&(c.s[Fp](null,s),delete s.p,c.v=s)},[s]);const a=A.useRef();if(!a.current){const c=eR(e,r);if(i){let u=0;c.w=d=>{o(h=>{const f=u?h:{p:h};return d(f),f})},c.v=s,c.r=d=>{++u,d(),--u}}a.current=c}const l=DT(n);return A.createElement(l.Provider,{value:a.current},t)};function Yn(t,e){return JV(t,e)}function Pv(t,e){const n=DT(e),r=A.useContext(n),{s:i,v:s}=r,o=h=>{const f=i[Np](t,h);if((ti&&"production")!=="production"&&!f.y)throw new Error("should not be invalidated");if("e"in f)throw f.e;if("p"in f)throw f.p;if("v"in f)return f.v;throw new Error("no atom value")},[[a,l,c],u]=A.useReducer((h,f)=>{const p=o(f);return Object.is(h[1],p)&&h[2]===t?h:[f,p,t]},s,h=>{const f=o(h);return[h,f,t]});let d=l;return c!==t&&(u(a),d=o(a)),A.useEffect(()=>{const{v:h}=r;h&&i[Fp](t,h);const f=i[Y0](t,u,h);return u(h),f},[i,t,r]),A.useEffect(()=>{i[Fp](t,a)}),A.useDebugValue(d),d}function ah(t,e){const n=DT(e),{s:r,w:i}=A.useContext(n);return A.useCallback(o=>{if((ti&&"production")!=="production"&&!("write"in t))throw new Error("not writable atom");const a=l=>r[X0](t,o,l);return i?i(a):a()},[r,i,t])}function Ht(t,e){return"scope"in t&&(console.warn("atom.scope is deprecated. Please do useAtom(atom, scope) instead."),e=t.scope),[Pv(t,e),ah(t,e)]}const rr=Symbol(),zo=Q7(),sW=(t,e)=>{const[n,r]=Ht(t);return A.useLayoutEffect(()=>{r(typeof e=="function"?e():e)},[]),[n,r]},oW=85,kl={code:"en",label:"English"},FT=[kl,...[{code:"ar-SA",label:"العربية",rtl:!0},{code:"bg-BG",label:"Български"},{code:"ca-ES",label:"Català"},{code:"cs-CZ",label:"Česky"},{code:"de-DE",label:"Deutsch"},{code:"el-GR",label:"Ελληνικά"},{code:"es-ES",label:"Español"},{code:"eu-ES",label:"Euskara"},{code:"fa-IR",label:"فارسی",rtl:!0},{code:"fi-FI",label:"Suomi"},{code:"fr-FR",label:"Français"},{code:"gl-ES",label:"Galego"},{code:"he-IL",label:"עברית",rtl:!0},{code:"hi-IN",label:"हिन्दी"},{code:"hu-HU",label:"Magyar"},{code:"id-ID",label:"Bahasa Indonesia"},{code:"it-IT",label:"Italiano"},{code:"ja-JP",label:"日本語"},{code:"kab-KAB",label:"Taqbaylit"},{code:"kk-KZ",label:"Қазақ тілі"},{code:"ko-KR",label:"한국어"},{code:"ku-TR",label:"Kurdî"},{code:"lt-LT",label:"Lietuvių"},{code:"lv-LV",label:"Latviešu"},{code:"my-MM",label:"Burmese"},{code:"nb-NO",label:"Norsk bokmål"},{code:"nl-NL",label:"Nederlands"},{code:"nn-NO",label:"Norsk nynorsk"},{code:"oc-FR",label:"Occitan"},{code:"pa-IN",label:"ਪੰਜਾਬੀ"},{code:"pl-PL",label:"Polski"},{code:"pt-BR",label:"Português Brasileiro"},{code:"pt-PT",label:"Português"},{code:"ro-RO",label:"Română"},{code:"ru-RU",label:"Русский"},{code:"sk-SK",label:"Slovenčina"},{code:"sv-SE",label:"Svenska"},{code:"sl-SI",label:"Slovenščina"},{code:"tr-TR",label:"Türkçe"},{code:"uk-UA",label:"Українська"},{code:"zh-CN",label:"简体中文"},{code:"zh-TW",label:"繁體中文"},{code:"vi-VN",label:"Tiếng Việt"},{code:"mr-IN",label:"मराठी"}].filter(t=>q7[t.code]>=oW).sort((t,e)=>t.label>e.label?1:-1)],tR="__test__";let nd=kl,Ug={};const nR=async t=>{if(nd=t,document.documentElement.dir=nd.rtl?"rtl":"ltr",document.documentElement.lang=nd.code,t.code.startsWith(tR))Ug={};else try{Ug=await YV(Object.assign({"./locales/ar-SA.json":()=>pe(()=>import("./locales/ar-SA.json-SV43LhYq.js"),__vite__mapDeps([])),"./locales/az-AZ.json":()=>pe(()=>import("./locales/az-AZ.json-oLcB2OJI.js"),__vite__mapDeps([])),"./locales/bg-BG.json":()=>pe(()=>import("./locales/bg-BG.json-pnAjs09s.js"),__vite__mapDeps([])),"./locales/bn-BD.json":()=>pe(()=>import("./locales/bn-BD.json-xZvqmnH0.js"),__vite__mapDeps([])),"./locales/ca-ES.json":()=>pe(()=>import("./locales/ca-ES.json-YA_IC9xZ.js"),__vite__mapDeps([])),"./locales/cs-CZ.json":()=>pe(()=>import("./locales/cs-CZ.json-xA16rUn9.js"),__vite__mapDeps([])),"./locales/da-DK.json":()=>pe(()=>import("./locales/da-DK.json-IEeMktGi.js"),__vite__mapDeps([])),"./locales/de-DE.json":()=>pe(()=>import("./locales/de-DE.json-i3JZdkyf.js"),__vite__mapDeps([])),"./locales/el-GR.json":()=>pe(()=>import("./locales/el-GR.json-HpHJuTAr.js"),__vite__mapDeps([])),"./locales/en.json":()=>pe(()=>Promise.resolve().then(()=>ZV),void 0),"./locales/es-ES.json":()=>pe(()=>import("./locales/es-ES.json-B52Lj-PT.js"),__vite__mapDeps([])),"./locales/eu-ES.json":()=>pe(()=>import("./locales/eu-ES.json-n0P55DpS.js"),__vite__mapDeps([])),"./locales/fa-IR.json":()=>pe(()=>import("./locales/fa-IR.json-Gtl9UWDE.js"),__vite__mapDeps([])),"./locales/fi-FI.json":()=>pe(()=>import("./locales/fi-FI.json-J5M8FnGK.js"),__vite__mapDeps([])),"./locales/fr-FR.json":()=>pe(()=>import("./locales/fr-FR.json-lfZo79tg.js"),__vite__mapDeps([])),"./locales/gl-ES.json":()=>pe(()=>import("./locales/gl-ES.json--WW2Ul2N.js"),__vite__mapDeps([])),"./locales/he-IL.json":()=>pe(()=>import("./locales/he-IL.json-4DiMSwaz.js"),__vite__mapDeps([])),"./locales/hi-IN.json":()=>pe(()=>import("./locales/hi-IN.json-nhvtlCpV.js"),__vite__mapDeps([])),"./locales/hu-HU.json":()=>pe(()=>import("./locales/hu-HU.json-bmZtU8U3.js"),__vite__mapDeps([])),"./locales/id-ID.json":()=>pe(()=>import("./locales/id-ID.json-XxPjS0Nx.js"),__vite__mapDeps([])),"./locales/it-IT.json":()=>pe(()=>import("./locales/it-IT.json-rBd68gJl.js"),__vite__mapDeps([])),"./locales/ja-JP.json":()=>pe(()=>import("./locales/ja-JP.json-2da-VeKb.js"),__vite__mapDeps([])),"./locales/kaa.json":()=>pe(()=>import("./locales/kaa.json-SGqCLwRa.js"),__vite__mapDeps([])),"./locales/kab-KAB.json":()=>pe(()=>import("./locales/kab-KAB.json-S8YedR0v.js"),__vite__mapDeps([])),"./locales/kk-KZ.json":()=>pe(()=>import("./locales/kk-KZ.json-3Sz1_kBi.js"),__vite__mapDeps([])),"./locales/km-KH.json":()=>pe(()=>import("./locales/km-KH.json-KP5HxHUN.js"),__vite__mapDeps([])),"./locales/ko-KR.json":()=>pe(()=>import("./locales/ko-KR.json-brzJvi-h.js"),__vite__mapDeps([])),"./locales/ku-TR.json":()=>pe(()=>import("./locales/ku-TR.json-3BiS76lb.js"),__vite__mapDeps([])),"./locales/lt-LT.json":()=>pe(()=>import("./locales/lt-LT.json-VZNCnPUp.js"),__vite__mapDeps([])),"./locales/lv-LV.json":()=>pe(()=>import("./locales/lv-LV.json-5aVXkl-5.js"),__vite__mapDeps([])),"./locales/mr-IN.json":()=>pe(()=>import("./locales/mr-IN.json-uScRhQ9i.js"),__vite__mapDeps([])),"./locales/my-MM.json":()=>pe(()=>import("./locales/my-MM.json-Rvx7mHUJ.js"),__vite__mapDeps([])),"./locales/nb-NO.json":()=>pe(()=>import("./locales/nb-NO.json-Jc97XkYt.js"),__vite__mapDeps([])),"./locales/nl-NL.json":()=>pe(()=>import("./locales/nl-NL.json-lulb62bF.js"),__vite__mapDeps([])),"./locales/nn-NO.json":()=>pe(()=>import("./locales/nn-NO.json-19EVdr9m.js"),__vite__mapDeps([])),"./locales/oc-FR.json":()=>pe(()=>import("./locales/oc-FR.json-mgdR7xZo.js"),__vite__mapDeps([])),"./locales/pa-IN.json":()=>pe(()=>import("./locales/pa-IN.json-6nU3HEBq.js"),__vite__mapDeps([])),"./locales/percentages.json":()=>pe(()=>Promise.resolve().then(()=>KV),void 0),"./locales/pl-PL.json":()=>pe(()=>import("./locales/pl-PL.json-e9P_Yfh8.js"),__vite__mapDeps([])),"./locales/pt-BR.json":()=>pe(()=>import("./locales/pt-BR.json-SvBckatZ.js"),__vite__mapDeps([])),"./locales/pt-PT.json":()=>pe(()=>import("./locales/pt-PT.json-kkhuggAD.js"),__vite__mapDeps([])),"./locales/ro-RO.json":()=>pe(()=>import("./locales/ro-RO.json-IuXq2Sgz.js"),__vite__mapDeps([])),"./locales/ru-RU.json":()=>pe(()=>import("./locales/ru-RU.json-AKny6SqI.js"),__vite__mapDeps([])),"./locales/si-LK.json":()=>pe(()=>import("./locales/si-LK.json-htW_YYt1.js"),__vite__mapDeps([])),"./locales/sk-SK.json":()=>pe(()=>import("./locales/sk-SK.json-9kwfDB_I.js"),__vite__mapDeps([])),"./locales/sl-SI.json":()=>pe(()=>import("./locales/sl-SI.json-ASsZh3wt.js"),__vite__mapDeps([])),"./locales/sv-SE.json":()=>pe(()=>import("./locales/sv-SE.json-lo_GRO0H.js"),__vite__mapDeps([])),"./locales/ta-IN.json":()=>pe(()=>import("./locales/ta-IN.json-heb0CKI9.js"),__vite__mapDeps([])),"./locales/th-TH.json":()=>pe(()=>import("./locales/th-TH.json-28RYlLeB.js"),__vite__mapDeps([])),"./locales/tr-TR.json":()=>pe(()=>import("./locales/tr-TR.json-EHF5lOjE.js"),__vite__mapDeps([])),"./locales/uk-UA.json":()=>pe(()=>import("./locales/uk-UA.json-opPb2znK.js"),__vite__mapDeps([])),"./locales/vi-VN.json":()=>pe(()=>import("./locales/vi-VN.json-lNqxPgt2.js"),__vite__mapDeps([])),"./locales/zh-CN.json":()=>pe(()=>import("./locales/zh-CN.json-I6DzD4ui.js"),__vite__mapDeps([])),"./locales/zh-HK.json":()=>pe(()=>import("./locales/zh-HK.json-0R3Wdr1t.js"),__vite__mapDeps([])),"./locales/zh-TW.json":()=>pe(()=>import("./locales/zh-TW.json-b9fBzTxw.js"),__vite__mapDeps([]))}),`./locales/${nd.code}.json`)}catch(e){console.error(`Failed to load language ${t.code}:`,e.message),Ug=OT}zo.set(rR,t.code)},km=()=>nd,OC=(t,e)=>{for(let n=0;n<e.length;++n){const r=e[n];if(t[r]===void 0)return;t=t[r]}if(typeof t=="string")return t},I=(t,e,n)=>{if(nd.code.startsWith(tR))return`‪[[${e?`${t}(${JSON.stringify(e).slice(1,-1)})`:t}]]‬`;const r=t.split(".");let i=OC(Ug,r)||OC(OT,r)||n;if(i===void 0){const s=`Can't find translation for ${t}`;return console.warn(s),""}if(e)for(const s in e)i=i.replace(`{{${s}}}`,String(e[s]));return i},rR=Yn(kl.code),Nn=()=>{const t=Pv(rR,rr);return{t:I,langCode:t}},aW=()=>{const t=new Date,e=t.getFullYear(),n=`${t.getMonth()+1}`.padStart(2,"0"),r=`${t.getDate()}`.padStart(2,"0"),i=`${t.getHours()}`.padStart(2,"0"),s=`${t.getMinutes()}`.padStart(2,"0");return`${e}-${n}-${r}-${i}${s}`},$g=t=>t.charAt(0).toUpperCase()+t.slice(1),lW=t=>t instanceof HTMLElement&&t.className.includes("ToolIcon"),iR=t=>t instanceof HTMLElement&&t.dataset.type==="wysiwyg"||t instanceof HTMLBRElement||t instanceof HTMLInputElement||t instanceof HTMLTextAreaElement||t instanceof HTMLSelectElement,cW=t=>iR(t)||t instanceof Element&&!!t.closest("label, button"),rc=t=>t instanceof HTMLElement&&t.dataset.type==="wysiwyg"||t instanceof HTMLBRElement||t instanceof HTMLTextAreaElement||t instanceof HTMLInputElement&&(t.type==="text"||t.type==="number"||t.type==="password"),BT=({fontFamily:t})=>{for(const[e,n]of Object.entries(mr))if(n===t)return`${e}, ${IC}`;return IC},mn=({fontSize:t,fontFamily:e})=>`${t}px ${BT({fontFamily:e})}`,$c=(t,e)=>{let n=0,r=null;const i=(...s)=>{r=s,clearTimeout(n),n=window.setTimeout(()=>{r=null,t(...s)},e)};return i.flush=()=>{if(clearTimeout(n),r){const s=r;r=null,t(...s)}},i.cancel=()=>{r=null,clearTimeout(n)},i},Mm=(t,e)=>{let n=null,r=null,i=null;const s=a=>{n=window.requestAnimationFrame(()=>{n=null,t(...a),r=null,i&&(r=i,i=null,s(r))})},o=(...a)=>{r=a,n===null?s(r):e!=null&&e.trailing&&(i=a)};return o.flush=()=>{n!==null&&(cancelAnimationFrame(n),n=null),r&&(t(...i||r),r=i=null)},o.cancel=()=>{r=i=null,n!==null&&(cancelAnimationFrame(n),n=null)},o},UT=t=>1-Math.pow(1-t,4),DC=(t,e,n)=>(e-t)*UT(n)+t,uW=({fromValues:t,toValues:e,onStep:n,duration:r=250,interpolateValue:i,onStart:s,onEnd:o,onCancel:a})=>{let l=!1,c=0,u;function d(h){if(l)return;u===void 0&&(u=h,s==null||s());const f=Math.min(h-u,r),p=UT(f/r),m={};if(Object.keys(t).forEach(v=>{const y=v,b=(e[y]-t[y])*p+t[y];m[y]=b}),n(m),f<r){const v=f/r,y={};Object.keys(t).forEach(b=>{const _=b,E=t[_],w=e[_];let x;x=i?i(E,w,v,_):DC(E,w,v),x==null&&(x=DC(E,w,v)),y[_]=x}),n(y),c=window.requestAnimationFrame(d)}else n(e),o==null||o()}return c=window.requestAnimationFrame(d),()=>{a==null||a(),l=!0,window.cancelAnimationFrame(c)}},dW=(t,e)=>{if(!t.length||e<1)return[];let n=0,r=0;const i=Array(Math.ceil(t.length/e));for(;n<t.length;)i[r++]=t.slice(n,n+=e);return i},fr=(t,e)=>Math.abs(t-e),kn=(t,e)=>e.type==="custom"?{...t.activeTool,type:"custom",customType:e.customType,locked:e.locked??t.activeTool.locked}:{...t.activeTool,lastActiveTool:e.lastActiveToolBeforeEraser===void 0?t.activeTool.lastActiveTool:e.lastActiveToolBeforeEraser,type:e.type,customType:null,locked:e.locked??t.activeTool.locked},re=t=>(t=t.replace(/\bAlt\b/i,"Alt").replace(/\bShift\b/i,"Shift").replace(/\b(Enter|Return)\b/i,"Enter"),uo?t.replace(/\bCtrlOrCmd\b/gi,"Cmd").replace(/\bAlt\b/i,"Option"):t.replace(/\bCtrlOrCmd\b/gi,"Ctrl")),Ft=({clientX:t,clientY:e},{zoom:n,offsetLeft:r,offsetTop:i,scrollX:s,scrollY:o})=>{const a=(t-r)/n.value-s,l=(e-i)/n.value-o;return{x:a,y:l}},li=({sceneX:t,sceneY:e},{zoom:n,offsetLeft:r,offsetTop:i,scrollX:s,scrollY:o})=>{const a=(t+s)*n.value+r,l=(e+o)*n.value+i;return{x:a,y:l}},S1=t=>getComputedStyle(document.documentElement).getPropertyValue(`--${t}`),hW="A-Za-zÀ-ÖØ-öø-ʸ̀-֐ࠀ-῿Ⰰ-﬜﷾-﹯﻽-￿",fW="֑-߿יִ-﷽ﹰ-ﻼ",pW=new RegExp(`^[^${hW}]*[${fW}]`),sR=t=>pW.test(t),$a=t=>{const[e,n]=t;return{x:e,y:n}},oR=t=>{if((t==null?void 0:t.name)==="AbortError"){console.warn(t);return}throw t},aR=(t,e,n=0)=>{n<0&&(n=t.length+n),n=Math.min(t.length,Math.max(n,0));let r=n-1;for(;++r<t.length;)if(e(t[r],r,t))return r;return-1},lR=(t,e,n=t.length-1)=>{n<0&&(n=t.length+n),n=Math.min(t.length-1,Math.max(n,0));let r=n+1;for(;--r>-1;)if(e(t[r],r,t))return r;return-1},to=t=>{const e=t.length===5&&t.substr(4,1)==="0",n=t.length===9&&t.substr(7,2)==="00";return e||n||t===Ge.transparent},cR=()=>{let t,e;const n=new Promise((r,i)=>{t=r,e=i});return n.resolve=t,n.reject=e,n},Nt=t=>e=>{hi.unstable_batchedUpdates(t,e)},gb=t=>Mm(e=>{hi.unstable_batchedUpdates(t,e)}),NC=(t,e)=>{const n=[{value:1,symbol:"b"},{value:1e3,symbol:"k"},{value:1e6,symbol:"M"},{value:1e9,symbol:"G"}],r=/\.0+$|(\.[0-9]*[1-9])0+$/;let i;for(i=n.length-1;i>0&&!(t>=n[i].value);i--);return(t/n[i].value).toFixed(e).replace(r,"$1")+n[i].symbol},mw=()=>{var t;return((t=document.querySelector('meta[name="version"]'))==null?void 0:t.content)||g7},mW=t=>{let e=t.parentElement;for(;e;){if(e===document.body)return document;const{overflowY:n}=window.getComputedStyle(e);if(e.scrollHeight>e.clientHeight&&(n==="auto"||n==="scroll"||n==="overlay"))return e;e=e.parentElement}return document},gW=t=>{let e=t.parentElement;for(;e;){if(e.tabIndex>-1){e.focus();return}e=e.parentElement}},uR=t=>{t.preventDefault(),t.returnValue=""},dR=t=>Array.from(t).map(e=>`0${e.toString(16)}`.slice(-2)).join(""),lh=()=>Date.now(),xn=t=>t.reduce((e,n)=>(e.set(typeof n=="string"?n:n.id,n),e),new Map),hR=t=>t.reduce((e,n,r)=>(e.set(n.id,[n,r]),e),new Map),fR=(t,e)=>new CustomEvent(t,{detail:{nativeEvent:e},cancelable:!0}),Hg=(t,e)=>{let n=!1;for(const r in e){const i=e[r];if(typeof i<"u"){if(t[r]===i&&(typeof i!="object"||i===null))continue;n=!0}}return n?{...t,...e}:t},Pm=()=>{try{return window.self===window.top?"top":"iframe"}catch{return"iframe"}},yW=()=>Pm()==="iframe",pR=t=>!!t&&typeof t=="object"&&"then"in t&&"catch"in t&&"finally"in t,gw=t=>{const e=t==null?void 0:t.querySelectorAll("button, a, input, select, textarea, div[tabindex], label[tabindex]");return e?Array.from(e).filter(n=>n.tabIndex>-1&&!n.disabled):[]},FC=(t,e)=>Array.isArray(t)&&Array.isArray(e)&&t.length===0&&e.length===0?!0:t===e,Pr=(t,e,n,r=!1)=>{const i=Object.keys(t),s=Object.keys(e);if(i.length!==s.length)return!1;if(n&&Array.isArray(n)){for(const o of n)if(!(t[o]===e[o]||FC(t[o],e[o])))return r&&console.warn(`%cisShallowEqual: ${o} not equal ->`,"color: #8B4000",t[o],e[o]),!1;return!0}return i.every(o=>{const a=n==null?void 0:n[o],l=a?a(t[o],e[o]):t[o]===e[o]||FC(t[o],e[o]);return!l&&r&&console.warn(`%cisShallowEqual: ${o} not equal ->`,"color: #8B4000",t[o],e[o]),l})},Lv=(t,e,{checkForDefaultPrevented:n=!0}={})=>function(i){if(t==null||t(i),!n||!i.defaultPrevented)return e==null?void 0:e(i)},zd=(t,e,n)=>{if(!e)return t;if(n)return console.error(e),t;throw new Error(e)},vW=t=>{let e,n;const r=function(i){const s=Object.entries(i);if(e){let a=!0;for(const[l,c]of s)if(e.get(l)!==c){a=!1;break}if(a)return n}const o=t(i);return e=new Map(s),n=o,o};return r.clear=()=>{e=void 0,n=void 0},r},$T=(()=>{let t;try{const n=ce.version.split(".");t=Number(n[0])>17}catch{t=!1}let e=!1;return()=>window.EXCALIDRAW_THROTTLE_RENDER===!0?t?!0:(e||(e=!0,console.warn("Excalidraw: render throttling is disabled on React versions < 18.")),!1):!1})(),yw=(t,e)=>t instanceof Set||t instanceof Map?t.has(e):"includes"in t?t.includes(e):t.hasOwnProperty(e),Hc=t=>JSON.parse(JSON.stringify(t)),BC=t=>typeof t=="number"&&Number.isFinite(t),yb=(t,e)=>Pr(t,e)?t:e,bW=LT.includes(devicePixelRatio)?devicePixelRatio:1,Es=()=>({showWelcomeScreen:!1,theme:Vn.LIGHT,webGLEnabled:!0,collaborators:new Map,currentChartType:"bar",currentItemBackgroundColor:en.backgroundColor,currentItemEndArrowhead:"arrow",currentItemFillStyle:en.fillStyle,currentItemFontFamily:ca,currentItemFontSize:_s,currentItemOpacity:en.opacity,currentItemRoughness:en.roughness,currentItemStartArrowhead:null,currentItemStrokeColor:en.strokeColor,currentItemRoundness:"round",currentItemStrokeStyle:en.strokeStyle,currentItemStrokeWidth:en.strokeWidth,currentItemTextAlign:kv,cursorButton:"up",activeEmbeddable:null,draggingElement:null,editingElement:null,editingGroupId:null,editingLinearElement:null,activeTool:{type:"selection",customType:null,locked:en.locked,lastActiveTool:null},penMode:!1,penDetected:!1,errorMessage:null,exportBackground:!0,exportScale:bW,exportEmbedScene:!1,exportWithDarkMode:!1,fileHandle:null,gridSize:null,isBindingEnabled:!0,defaultSidebarDockedPreference:!1,isLoading:!1,isResizing:!1,isRotating:!1,lastPointerDownWith:"mouse",multiElement:null,name:`${I("labels.untitled")}-${aW()}`,contextMenu:null,openMenu:null,openPopup:null,openSidebar:null,openDialog:null,pasteDialog:{shown:!1,data:null},previousSelectedElementIds:{},resizingElement:null,scrolledOutside:!1,scrollX:0,scrollY:0,selectedElementIds:{},selectedGroupIds:{},selectedElementsAreBeingDragged:!1,selectionElement:null,shouldCacheIgnoreZoom:!1,showStats:!1,startBoundElement:null,suggestedBindings:[],frameRendering:{enabled:!0,clip:!0,name:!0,outline:!0},frameToHighlight:null,editingFrame:null,elementsToHighlight:null,toast:null,viewBackgroundColor:Ge.white,zenModeEnabled:!1,zoom:{value:1},viewModeEnabled:!1,pendingImageElementId:null,showHyperlinkPopup:!1,selectedLinearElement:null,snapLines:[],originSnapOffset:{x:0,y:0},objectsSnapModeEnabled:!1,userToFollow:null,followedBy:new Set}),_W=(t=>t)({showWelcomeScreen:{browser:!0,export:!1,server:!1},theme:{browser:!0,export:!1,server:!1},collaborators:{browser:!1,export:!1,server:!1},currentChartType:{browser:!0,export:!1,server:!1},currentItemBackgroundColor:{browser:!0,export:!1,server:!1},currentItemEndArrowhead:{browser:!0,export:!1,server:!1},currentItemFillStyle:{browser:!0,export:!1,server:!1},currentItemFontFamily:{browser:!0,export:!1,server:!1},currentItemFontSize:{browser:!0,export:!1,server:!1},currentItemRoundness:{browser:!0,export:!1,server:!1},currentItemOpacity:{browser:!0,export:!1,server:!1},currentItemRoughness:{browser:!0,export:!1,server:!1},currentItemStartArrowhead:{browser:!0,export:!1,server:!1},currentItemStrokeColor:{browser:!0,export:!1,server:!1},currentItemStrokeStyle:{browser:!0,export:!1,server:!1},currentItemStrokeWidth:{browser:!0,export:!1,server:!1},currentItemTextAlign:{browser:!0,export:!1,server:!1},cursorButton:{browser:!0,export:!1,server:!1},activeEmbeddable:{browser:!1,export:!1,server:!1},draggingElement:{browser:!1,export:!1,server:!1},editingElement:{browser:!1,export:!1,server:!1},editingGroupId:{browser:!0,export:!1,server:!1},editingLinearElement:{browser:!1,export:!1,server:!1},activeTool:{browser:!0,export:!1,server:!1},penMode:{browser:!0,export:!1,server:!1},penDetected:{browser:!0,export:!1,server:!1},errorMessage:{browser:!1,export:!1,server:!1},exportBackground:{browser:!0,export:!1,server:!1},exportEmbedScene:{browser:!0,export:!1,server:!1},exportScale:{browser:!0,export:!1,server:!1},exportWithDarkMode:{browser:!0,export:!1,server:!1},fileHandle:{browser:!1,export:!1,server:!1},gridSize:{browser:!0,export:!0,server:!0},height:{browser:!1,export:!1,server:!1},webGLEnabled:{browser:!1,export:!1,server:!1},isBindingEnabled:{browser:!1,export:!1,server:!1},defaultSidebarDockedPreference:{browser:!0,export:!1,server:!1},isLoading:{browser:!1,export:!1,server:!1},isResizing:{browser:!1,export:!1,server:!1},isRotating:{browser:!1,export:!1,server:!1},lastPointerDownWith:{browser:!0,export:!1,server:!1},multiElement:{browser:!1,export:!1,server:!1},name:{browser:!0,export:!1,server:!1},offsetLeft:{browser:!1,export:!1,server:!1},offsetTop:{browser:!1,export:!1,server:!1},contextMenu:{browser:!1,export:!1,server:!1},openMenu:{browser:!0,export:!1,server:!1},openPopup:{browser:!1,export:!1,server:!1},openSidebar:{browser:!0,export:!1,server:!1},openDialog:{browser:!1,export:!1,server:!1},pasteDialog:{browser:!1,export:!1,server:!1},previousSelectedElementIds:{browser:!0,export:!1,server:!1},resizingElement:{browser:!1,export:!1,server:!1},scrolledOutside:{browser:!0,export:!1,server:!1},scrollX:{browser:!0,export:!1,server:!1},scrollY:{browser:!0,export:!1,server:!1},selectedElementIds:{browser:!0,export:!1,server:!1},selectedGroupIds:{browser:!0,export:!1,server:!1},selectedElementsAreBeingDragged:{browser:!1,export:!1,server:!1},selectionElement:{browser:!1,export:!1,server:!1},shouldCacheIgnoreZoom:{browser:!0,export:!1,server:!1},showStats:{browser:!0,export:!1,server:!1},startBoundElement:{browser:!1,export:!1,server:!1},suggestedBindings:{browser:!1,export:!1,server:!1},frameRendering:{browser:!1,export:!1,server:!1},frameToHighlight:{browser:!1,export:!1,server:!1},editingFrame:{browser:!1,export:!1,server:!1},elementsToHighlight:{browser:!1,export:!1,server:!1},toast:{browser:!1,export:!1,server:!1},viewBackgroundColor:{browser:!0,export:!0,server:!0},width:{browser:!1,export:!1,server:!1},zenModeEnabled:{browser:!0,export:!1,server:!1},zoom:{browser:!0,export:!1,server:!1},viewModeEnabled:{browser:!1,export:!1,server:!1},pendingImageElementId:{browser:!1,export:!1,server:!1},showHyperlinkPopup:{browser:!1,export:!1,server:!1},selectedLinearElement:{browser:!0,export:!1,server:!1},snapLines:{browser:!1,export:!1,server:!1},originSnapOffset:{browser:!1,export:!1,server:!1},objectsSnapModeEnabled:{browser:!0,export:!1,server:!1},userToFollow:{browser:!1,export:!1,server:!1},followedBy:{browser:!1,export:!1,server:!1}}),HT=(t,e)=>{const n={};for(const r of Object.keys(t)){const i=_W[r];if(i!=null&&i[e]){const s=t[r];n[r]=s}}return n},mR=t=>HT(t,"browser"),gR=t=>HT(t,"export"),EW=t=>HT(t,"server"),pc=({activeTool:t})=>t.type==="eraser",Gd=({activeTool:t})=>t.type==="hand";function yR(t){var e,n,r="";if(typeof t=="string"||typeof t=="number")r+=t;else if(typeof t=="object")if(Array.isArray(t))for(e=0;e<t.length;e++)t[e]&&(n=yR(t[e]))&&(r&&(r+=" "),r+=n);else for(e in t)t[e]&&(r&&(r+=" "),r+=e);return r}function Ee(){for(var t=0,e,n,r="";t<arguments.length;)(e=arguments[t++])&&(n=yR(e))&&(r&&(r+=" "),r+=n);return r}const vR=()=>{const[t,e]=A.useState(null),n=A.useCallback(r=>e(r),[]);return[t,n]};var cu=(t=>(t[t.WEBGL_LEGACY=0]="WEBGL_LEGACY",t[t.WEBGL=1]="WEBGL",t[t.WEBGL2=2]="WEBGL2",t))(cu||{}),bR=(t=>(t[t.UNKNOWN=0]="UNKNOWN",t[t.WEBGL=1]="WEBGL",t[t.CANVAS=2]="CANVAS",t))(bR||{}),vw=(t=>(t[t.COLOR=16384]="COLOR",t[t.DEPTH=256]="DEPTH",t[t.STENCIL=1024]="STENCIL",t))(vw||{}),Ne=(t=>(t[t.NORMAL=0]="NORMAL",t[t.ADD=1]="ADD",t[t.MULTIPLY=2]="MULTIPLY",t[t.SCREEN=3]="SCREEN",t[t.OVERLAY=4]="OVERLAY",t[t.DARKEN=5]="DARKEN",t[t.LIGHTEN=6]="LIGHTEN",t[t.COLOR_DODGE=7]="COLOR_DODGE",t[t.COLOR_BURN=8]="COLOR_BURN",t[t.HARD_LIGHT=9]="HARD_LIGHT",t[t.SOFT_LIGHT=10]="SOFT_LIGHT",t[t.DIFFERENCE=11]="DIFFERENCE",t[t.EXCLUSION=12]="EXCLUSION",t[t.HUE=13]="HUE",t[t.SATURATION=14]="SATURATION",t[t.COLOR=15]="COLOR",t[t.LUMINOSITY=16]="LUMINOSITY",t[t.NORMAL_NPM=17]="NORMAL_NPM",t[t.ADD_NPM=18]="ADD_NPM",t[t.SCREEN_NPM=19]="SCREEN_NPM",t[t.NONE=20]="NONE",t[t.SRC_OVER=0]="SRC_OVER",t[t.SRC_IN=21]="SRC_IN",t[t.SRC_OUT=22]="SRC_OUT",t[t.SRC_ATOP=23]="SRC_ATOP",t[t.DST_OVER=24]="DST_OVER",t[t.DST_IN=25]="DST_IN",t[t.DST_OUT=26]="DST_OUT",t[t.DST_ATOP=27]="DST_ATOP",t[t.ERASE=26]="ERASE",t[t.SUBTRACT=28]="SUBTRACT",t[t.XOR=29]="XOR",t))(Ne||{}),ls=(t=>(t[t.POINTS=0]="POINTS",t[t.LINES=1]="LINES",t[t.LINE_LOOP=2]="LINE_LOOP",t[t.LINE_STRIP=3]="LINE_STRIP",t[t.TRIANGLES=4]="TRIANGLES",t[t.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",t[t.TRIANGLE_FAN=6]="TRIANGLE_FAN",t))(ls||{}),le=(t=>(t[t.RGBA=6408]="RGBA",t[t.RGB=6407]="RGB",t[t.RG=33319]="RG",t[t.RED=6403]="RED",t[t.RGBA_INTEGER=36249]="RGBA_INTEGER",t[t.RGB_INTEGER=36248]="RGB_INTEGER",t[t.RG_INTEGER=33320]="RG_INTEGER",t[t.RED_INTEGER=36244]="RED_INTEGER",t[t.ALPHA=6406]="ALPHA",t[t.LUMINANCE=6409]="LUMINANCE",t[t.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",t[t.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",t[t.DEPTH_STENCIL=34041]="DEPTH_STENCIL",t))(le||{}),_d=(t=>(t[t.TEXTURE_2D=3553]="TEXTURE_2D",t[t.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",t[t.TEXTURE_2D_ARRAY=35866]="TEXTURE_2D_ARRAY",t[t.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",t[t.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",t[t.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",t[t.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",t[t.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",t[t.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z",t))(_d||{}),Te=(t=>(t[t.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",t[t.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",t[t.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",t[t.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",t[t.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",t[t.UNSIGNED_INT=5125]="UNSIGNED_INT",t[t.UNSIGNED_INT_10F_11F_11F_REV=35899]="UNSIGNED_INT_10F_11F_11F_REV",t[t.UNSIGNED_INT_2_10_10_10_REV=33640]="UNSIGNED_INT_2_10_10_10_REV",t[t.UNSIGNED_INT_24_8=34042]="UNSIGNED_INT_24_8",t[t.UNSIGNED_INT_5_9_9_9_REV=35902]="UNSIGNED_INT_5_9_9_9_REV",t[t.BYTE=5120]="BYTE",t[t.SHORT=5122]="SHORT",t[t.INT=5124]="INT",t[t.FLOAT=5126]="FLOAT",t[t.FLOAT_32_UNSIGNED_INT_24_8_REV=36269]="FLOAT_32_UNSIGNED_INT_24_8_REV",t[t.HALF_FLOAT=36193]="HALF_FLOAT",t))(Te||{}),be=(t=>(t[t.FLOAT=0]="FLOAT",t[t.INT=1]="INT",t[t.UINT=2]="UINT",t))(be||{}),No=(t=>(t[t.NEAREST=0]="NEAREST",t[t.LINEAR=1]="LINEAR",t))(No||{}),Go=(t=>(t[t.CLAMP=33071]="CLAMP",t[t.REPEAT=10497]="REPEAT",t[t.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT",t))(Go||{}),ho=(t=>(t[t.OFF=0]="OFF",t[t.POW2=1]="POW2",t[t.ON=2]="ON",t[t.ON_MANUAL=3]="ON_MANUAL",t))(ho||{}),zr=(t=>(t[t.NPM=0]="NPM",t[t.UNPACK=1]="UNPACK",t[t.PMA=2]="PMA",t[t.NO_PREMULTIPLIED_ALPHA=0]="NO_PREMULTIPLIED_ALPHA",t[t.PREMULTIPLY_ON_UPLOAD=1]="PREMULTIPLY_ON_UPLOAD",t[t.PREMULTIPLIED_ALPHA=2]="PREMULTIPLIED_ALPHA",t))(zr||{}),Zs=(t=>(t[t.NO=0]="NO",t[t.YES=1]="YES",t[t.AUTO=2]="AUTO",t[t.BLEND=0]="BLEND",t[t.CLEAR=1]="CLEAR",t[t.BLIT=2]="BLIT",t))(Zs||{}),zT=(t=>(t[t.AUTO=0]="AUTO",t[t.MANUAL=1]="MANUAL",t))(zT||{}),Ti=(t=>(t.LOW="lowp",t.MEDIUM="mediump",t.HIGH="highp",t))(Ti||{}),In=(t=>(t[t.NONE=0]="NONE",t[t.SCISSOR=1]="SCISSOR",t[t.STENCIL=2]="STENCIL",t[t.SPRITE=3]="SPRITE",t[t.COLOR=4]="COLOR",t))(In||{}),dn=(t=>(t[t.NONE=0]="NONE",t[t.LOW=2]="LOW",t[t.MEDIUM=4]="MEDIUM",t[t.HIGH=8]="HIGH",t))(dn||{}),so=(t=>(t[t.ELEMENT_ARRAY_BUFFER=34963]="ELEMENT_ARRAY_BUFFER",t[t.ARRAY_BUFFER=34962]="ARRAY_BUFFER",t[t.UNIFORM_BUFFER=35345]="UNIFORM_BUFFER",t))(so||{});const wW={createCanvas:(t,e)=>{const n=document.createElement("canvas");return n.width=t,n.height=e,n},getCanvasRenderingContext2D:()=>CanvasRenderingContext2D,getWebGLRenderingContext:()=>WebGLRenderingContext,getNavigator:()=>navigator,getBaseUrl:()=>document.baseURI??window.location.href,getFontFaceSet:()=>document.fonts,fetch:(t,e)=>fetch(t,e),parseXML:t=>new DOMParser().parseFromString(t,"text/xml")},_e={ADAPTER:wW,RESOLUTION:1,CREATE_IMAGE_BITMAP:!1,ROUND_PIXELS:!1};var vb=/iPhone/i,UC=/iPod/i,$C=/iPad/i,HC=/\biOS-universal(?:.+)Mac\b/i,bb=/\bAndroid(?:.+)Mobile\b/i,zC=/Android/i,vu=/(?:SD4930UR|\bSilk(?:.+)Mobile\b)/i,C1=/Silk/i,bo=/Windows Phone/i,GC=/\bWindows(?:.+)ARM\b/i,VC=/BlackBerry/i,WC=/BB10/i,jC=/Opera Mini/i,XC=/\b(CriOS|Chrome)(?:.+)Mobile/i,YC=/Mobile(?:.+)Firefox\b/i,ZC=function(t){return typeof t<"u"&&t.platform==="MacIntel"&&typeof t.maxTouchPoints=="number"&&t.maxTouchPoints>1&&typeof MSStream>"u"};function xW(t){return function(e){return e.test(t)}}function KC(t){var e={userAgent:"",platform:"",maxTouchPoints:0};!t&&typeof navigator<"u"?e={userAgent:navigator.userAgent,platform:navigator.platform,maxTouchPoints:navigator.maxTouchPoints||0}:typeof t=="string"?e.userAgent=t:t&&t.userAgent&&(e={userAgent:t.userAgent,platform:t.platform,maxTouchPoints:t.maxTouchPoints||0});var n=e.userAgent,r=n.split("[FBAN");typeof r[1]<"u"&&(n=r[0]),r=n.split("Twitter"),typeof r[1]<"u"&&(n=r[0]);var i=xW(n),s={apple:{phone:i(vb)&&!i(bo),ipod:i(UC),tablet:!i(vb)&&(i($C)||ZC(e))&&!i(bo),universal:i(HC),device:(i(vb)||i(UC)||i($C)||i(HC)||ZC(e))&&!i(bo)},amazon:{phone:i(vu),tablet:!i(vu)&&i(C1),device:i(vu)||i(C1)},android:{phone:!i(bo)&&i(vu)||!i(bo)&&i(bb),tablet:!i(bo)&&!i(vu)&&!i(bb)&&(i(C1)||i(zC)),device:!i(bo)&&(i(vu)||i(C1)||i(bb)||i(zC))||i(/\bokhttp\b/i)},windows:{phone:i(bo),tablet:i(GC),device:i(bo)||i(GC)},other:{blackberry:i(VC),blackberry10:i(WC),opera:i(jC),firefox:i(YC),chrome:i(XC),device:i(VC)||i(WC)||i(jC)||i(YC)||i(XC)},any:!1,phone:!1,tablet:!1};return s.any=s.apple.device||s.android.device||s.windows.device||s.other.device,s.phone=s.apple.phone||s.android.phone||s.windows.phone,s.tablet=s.apple.tablet||s.android.tablet||s.windows.tablet,s}const TW=KC.default??KC,Fo=TW(globalThis.navigator);_e.RETINA_PREFIX=/@([0-9\.]+)x/;_e.FAIL_IF_MAJOR_PERFORMANCE_CAVEAT=!1;var _R={exports:{}};(function(t){var e=Object.prototype.hasOwnProperty,n="~";function r(){}Object.create&&(r.prototype=Object.create(null),new r().__proto__||(n=!1));function i(l,c,u){this.fn=l,this.context=c,this.once=u||!1}function s(l,c,u,d,h){if(typeof u!="function")throw new TypeError("The listener must be a function");var f=new i(u,d||l,h),p=n?n+c:c;return l._events[p]?l._events[p].fn?l._events[p]=[l._events[p],f]:l._events[p].push(f):(l._events[p]=f,l._eventsCount++),l}function o(l,c){--l._eventsCount===0?l._events=new r:delete l._events[c]}function a(){this._events=new r,this._eventsCount=0}a.prototype.eventNames=function(){var c=[],u,d;if(this._eventsCount===0)return c;for(d in u=this._events)e.call(u,d)&&c.push(n?d.slice(1):d);return Object.getOwnPropertySymbols?c.concat(Object.getOwnPropertySymbols(u)):c},a.prototype.listeners=function(c){var u=n?n+c:c,d=this._events[u];if(!d)return[];if(d.fn)return[d.fn];for(var h=0,f=d.length,p=new Array(f);h<f;h++)p[h]=d[h].fn;return p},a.prototype.listenerCount=function(c){var u=n?n+c:c,d=this._events[u];return d?d.fn?1:d.length:0},a.prototype.emit=function(c,u,d,h,f,p){var m=n?n+c:c;if(!this._events[m])return!1;var v=this._events[m],y=arguments.length,b,_;if(v.fn){switch(v.once&&this.removeListener(c,v.fn,void 0,!0),y){case 1:return v.fn.call(v.context),!0;case 2:return v.fn.call(v.context,u),!0;case 3:return v.fn.call(v.context,u,d),!0;case 4:return v.fn.call(v.context,u,d,h),!0;case 5:return v.fn.call(v.context,u,d,h,f),!0;case 6:return v.fn.call(v.context,u,d,h,f,p),!0}for(_=1,b=new Array(y-1);_<y;_++)b[_-1]=arguments[_];v.fn.apply(v.context,b)}else{var E=v.length,w;for(_=0;_<E;_++)switch(v[_].once&&this.removeListener(c,v[_].fn,void 0,!0),y){case 1:v[_].fn.call(v[_].context);break;case 2:v[_].fn.call(v[_].context,u);break;case 3:v[_].fn.call(v[_].context,u,d);break;case 4:v[_].fn.call(v[_].context,u,d,h);break;default:if(!b)for(w=1,b=new Array(y-1);w<y;w++)b[w-1]=arguments[w];v[_].fn.apply(v[_].context,b)}}return!0},a.prototype.on=function(c,u,d){return s(this,c,u,d,!1)},a.prototype.once=function(c,u,d){return s(this,c,u,d,!0)},a.prototype.removeListener=function(c,u,d,h){var f=n?n+c:c;if(!this._events[f])return this;if(!u)return o(this,f),this;var p=this._events[f];if(p.fn)p.fn===u&&(!h||p.once)&&(!d||p.context===d)&&o(this,f);else{for(var m=0,v=[],y=p.length;m<y;m++)(p[m].fn!==u||h&&!p[m].once||d&&p[m].context!==d)&&v.push(p[m]);v.length?this._events[f]=v.length===1?v[0]:v:o(this,f)}return this},a.prototype.removeAllListeners=function(c){var u;return c?(u=n?n+c:c,this._events[u]&&o(this,u)):(this._events=new r,this._eventsCount=0),this},a.prototype.off=a.prototype.removeListener,a.prototype.addListener=a.prototype.on,a.prefixed=n,a.EventEmitter=a,t.exports=a})(_R);var SW=_R.exports;const Lm=aa(SW);var GT={exports:{}};GT.exports=Rv;GT.exports.default=Rv;function Rv(t,e,n){n=n||2;var r=e&&e.length,i=r?e[0]*n:t.length,s=ER(t,0,i,n,!0),o=[];if(!s||s.next===s.prev)return o;var a,l,c,u,d,h,f;if(r&&(s=MW(t,e,s,n)),t.length>80*n){a=c=t[0],l=u=t[1];for(var p=n;p<i;p+=n)d=t[p],h=t[p+1],d<a&&(a=d),h<l&&(l=h),d>c&&(c=d),h>u&&(u=h);f=Math.max(c-a,u-l),f=f!==0?32767/f:0}return Bp(s,o,n,a,l,f,0),o}function ER(t,e,n,r,i){var s,o;if(i===Ew(t,e,n,r)>0)for(s=e;s<n;s+=r)o=qC(s,t[s],t[s+1],o);else for(s=n-r;s>=e;s-=r)o=qC(s,t[s],t[s+1],o);return o&&Ov(o,o.next)&&($p(o),o=o.next),o}function zc(t,e){if(!t)return t;e||(e=t);var n=t,r;do if(r=!1,!n.steiner&&(Ov(n,n.next)||tn(n.prev,n,n.next)===0)){if($p(n),n=e=n.prev,n===n.next)break;r=!0}else n=n.next;while(r||n!==e);return e}function Bp(t,e,n,r,i,s,o){if(t){!o&&s&&DW(t,r,i,s);for(var a=t,l,c;t.prev!==t.next;){if(l=t.prev,c=t.next,s?IW(t,r,i,s):CW(t)){e.push(l.i/n|0),e.push(t.i/n|0),e.push(c.i/n|0),$p(t),t=c.next,a=c.next;continue}if(t=c,t===a){o?o===1?(t=AW(zc(t),e,n),Bp(t,e,n,r,i,s,2)):o===2&&kW(t,e,n,r,i,s):Bp(zc(t),e,n,r,i,s,1);break}}}}function CW(t){var e=t.prev,n=t,r=t.next;if(tn(e,n,r)>=0)return!1;for(var i=e.x,s=n.x,o=r.x,a=e.y,l=n.y,c=r.y,u=i<s?i<o?i:o:s<o?s:o,d=a<l?a<c?a:c:l<c?l:c,h=i>s?i>o?i:o:s>o?s:o,f=a>l?a>c?a:c:l>c?l:c,p=r.next;p!==e;){if(p.x>=u&&p.x<=h&&p.y>=d&&p.y<=f&&rd(i,a,s,l,o,c,p.x,p.y)&&tn(p.prev,p,p.next)>=0)return!1;p=p.next}return!0}function IW(t,e,n,r){var i=t.prev,s=t,o=t.next;if(tn(i,s,o)>=0)return!1;for(var a=i.x,l=s.x,c=o.x,u=i.y,d=s.y,h=o.y,f=a<l?a<c?a:c:l<c?l:c,p=u<d?u<h?u:h:d<h?d:h,m=a>l?a>c?a:c:l>c?l:c,v=u>d?u>h?u:h:d>h?d:h,y=bw(f,p,e,n,r),b=bw(m,v,e,n,r),_=t.prevZ,E=t.nextZ;_&&_.z>=y&&E&&E.z<=b;){if(_.x>=f&&_.x<=m&&_.y>=p&&_.y<=v&&_!==i&&_!==o&&rd(a,u,l,d,c,h,_.x,_.y)&&tn(_.prev,_,_.next)>=0||(_=_.prevZ,E.x>=f&&E.x<=m&&E.y>=p&&E.y<=v&&E!==i&&E!==o&&rd(a,u,l,d,c,h,E.x,E.y)&&tn(E.prev,E,E.next)>=0))return!1;E=E.nextZ}for(;_&&_.z>=y;){if(_.x>=f&&_.x<=m&&_.y>=p&&_.y<=v&&_!==i&&_!==o&&rd(a,u,l,d,c,h,_.x,_.y)&&tn(_.prev,_,_.next)>=0)return!1;_=_.prevZ}for(;E&&E.z<=b;){if(E.x>=f&&E.x<=m&&E.y>=p&&E.y<=v&&E!==i&&E!==o&&rd(a,u,l,d,c,h,E.x,E.y)&&tn(E.prev,E,E.next)>=0)return!1;E=E.nextZ}return!0}function AW(t,e,n){var r=t;do{var i=r.prev,s=r.next.next;!Ov(i,s)&&wR(i,r,r.next,s)&&Up(i,s)&&Up(s,i)&&(e.push(i.i/n|0),e.push(r.i/n|0),e.push(s.i/n|0),$p(r),$p(r.next),r=t=s),r=r.next}while(r!==t);return zc(r)}function kW(t,e,n,r,i,s){var o=t;do{for(var a=o.next.next;a!==o.prev;){if(o.i!==a.i&&BW(o,a)){var l=xR(o,a);o=zc(o,o.next),l=zc(l,l.next),Bp(o,e,n,r,i,s,0),Bp(l,e,n,r,i,s,0);return}a=a.next}o=o.next}while(o!==t)}function MW(t,e,n,r){var i=[],s,o,a,l,c;for(s=0,o=e.length;s<o;s++)a=e[s]*r,l=s<o-1?e[s+1]*r:t.length,c=ER(t,a,l,r,!1),c===c.next&&(c.steiner=!0),i.push(FW(c));for(i.sort(PW),s=0;s<i.length;s++)n=LW(i[s],n);return n}function PW(t,e){return t.x-e.x}function LW(t,e){var n=RW(t,e);if(!n)return e;var r=xR(n,t);return zc(r,r.next),zc(n,n.next)}function RW(t,e){var n=e,r=t.x,i=t.y,s=-1/0,o;do{if(i<=n.y&&i>=n.next.y&&n.next.y!==n.y){var a=n.x+(i-n.y)*(n.next.x-n.x)/(n.next.y-n.y);if(a<=r&&a>s&&(s=a,o=n.x<n.next.x?n:n.next,a===r))return o}n=n.next}while(n!==e);if(!o)return null;var l=o,c=o.x,u=o.y,d=1/0,h;n=o;do r>=n.x&&n.x>=c&&r!==n.x&&rd(i<u?r:s,i,c,u,i<u?s:r,i,n.x,n.y)&&(h=Math.abs(i-n.y)/(r-n.x),Up(n,t)&&(h<d||h===d&&(n.x>o.x||n.x===o.x&&OW(o,n)))&&(o=n,d=h)),n=n.next;while(n!==l);return o}function OW(t,e){return tn(t.prev,t,e.prev)<0&&tn(e.next,t,t.next)<0}function DW(t,e,n,r){var i=t;do i.z===0&&(i.z=bw(i.x,i.y,e,n,r)),i.prevZ=i.prev,i.nextZ=i.next,i=i.next;while(i!==t);i.prevZ.nextZ=null,i.prevZ=null,NW(i)}function NW(t){var e,n,r,i,s,o,a,l,c=1;do{for(n=t,t=null,s=null,o=0;n;){for(o++,r=n,a=0,e=0;e<c&&(a++,r=r.nextZ,!!r);e++);for(l=c;a>0||l>0&&r;)a!==0&&(l===0||!r||n.z<=r.z)?(i=n,n=n.nextZ,a--):(i=r,r=r.nextZ,l--),s?s.nextZ=i:t=i,i.prevZ=s,s=i;n=r}s.nextZ=null,c*=2}while(o>1);return t}function bw(t,e,n,r,i){return t=(t-n)*i|0,e=(e-r)*i|0,t=(t|t<<8)&16711935,t=(t|t<<4)&252645135,t=(t|t<<2)&858993459,t=(t|t<<1)&1431655765,e=(e|e<<8)&16711935,e=(e|e<<4)&252645135,e=(e|e<<2)&858993459,e=(e|e<<1)&1431655765,t|e<<1}function FW(t){var e=t,n=t;do(e.x<n.x||e.x===n.x&&e.y<n.y)&&(n=e),e=e.next;while(e!==t);return n}function rd(t,e,n,r,i,s,o,a){return(i-o)*(e-a)>=(t-o)*(s-a)&&(t-o)*(r-a)>=(n-o)*(e-a)&&(n-o)*(s-a)>=(i-o)*(r-a)}function BW(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!UW(t,e)&&(Up(t,e)&&Up(e,t)&&$W(t,e)&&(tn(t.prev,t,e.prev)||tn(t,e.prev,e))||Ov(t,e)&&tn(t.prev,t,t.next)>0&&tn(e.prev,e,e.next)>0)}function tn(t,e,n){return(e.y-t.y)*(n.x-e.x)-(e.x-t.x)*(n.y-e.y)}function Ov(t,e){return t.x===e.x&&t.y===e.y}function wR(t,e,n,r){var i=A1(tn(t,e,n)),s=A1(tn(t,e,r)),o=A1(tn(n,r,t)),a=A1(tn(n,r,e));return!!(i!==s&&o!==a||i===0&&I1(t,n,e)||s===0&&I1(t,r,e)||o===0&&I1(n,t,r)||a===0&&I1(n,e,r))}function I1(t,e,n){return e.x<=Math.max(t.x,n.x)&&e.x>=Math.min(t.x,n.x)&&e.y<=Math.max(t.y,n.y)&&e.y>=Math.min(t.y,n.y)}function A1(t){return t>0?1:t<0?-1:0}function UW(t,e){var n=t;do{if(n.i!==t.i&&n.next.i!==t.i&&n.i!==e.i&&n.next.i!==e.i&&wR(n,n.next,t,e))return!0;n=n.next}while(n!==t);return!1}function Up(t,e){return tn(t.prev,t,t.next)<0?tn(t,e,t.next)>=0&&tn(t,t.prev,e)>=0:tn(t,e,t.prev)<0||tn(t,t.next,e)<0}function $W(t,e){var n=t,r=!1,i=(t.x+e.x)/2,s=(t.y+e.y)/2;do n.y>s!=n.next.y>s&&n.next.y!==n.y&&i<(n.next.x-n.x)*(s-n.y)/(n.next.y-n.y)+n.x&&(r=!r),n=n.next;while(n!==t);return r}function xR(t,e){var n=new _w(t.i,t.x,t.y),r=new _w(e.i,e.x,e.y),i=t.next,s=e.prev;return t.next=e,e.prev=t,n.next=i,i.prev=n,r.next=n,n.prev=r,s.next=r,r.prev=s,r}function qC(t,e,n,r){var i=new _w(t,e,n);return r?(i.next=r.next,i.prev=r,r.next.prev=i,r.next=i):(i.prev=i,i.next=i),i}function $p(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function _w(t,e,n){this.i=t,this.x=e,this.y=n,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}Rv.deviation=function(t,e,n,r){var i=e&&e.length,s=i?e[0]*n:t.length,o=Math.abs(Ew(t,0,s,n));if(i)for(var a=0,l=e.length;a<l;a++){var c=e[a]*n,u=a<l-1?e[a+1]*n:t.length;o-=Math.abs(Ew(t,c,u,n))}var d=0;for(a=0;a<r.length;a+=3){var h=r[a]*n,f=r[a+1]*n,p=r[a+2]*n;d+=Math.abs((t[h]-t[p])*(t[f+1]-t[h+1])-(t[h]-t[f])*(t[p+1]-t[h+1]))}return o===0&&d===0?0:Math.abs((d-o)/o)};function Ew(t,e,n,r){for(var i=0,s=e,o=n-r;s<n;s+=r)i+=(t[o]-t[s])*(t[s+1]+t[o+1]),o=s;return i}Rv.flatten=function(t){for(var e=t[0][0].length,n={vertices:[],holes:[],dimensions:e},r=0,i=0;i<t.length;i++){for(var s=0;s<t[i].length;s++)for(var o=0;o<e;o++)n.vertices.push(t[i][s][o]);i>0&&(r+=t[i-1].length,n.holes.push(r))}return n};var HW=GT.exports;const TR=aa(HW);var Z0={exports:{}};Z0.exports;(function(t,e){var n={};(function(r){var i=e&&!e.nodeType&&e,s=t&&!t.nodeType&&t,o=typeof n=="object"&&n;(o.global===o||o.window===o||o.self===o)&&(r=o);var a,l=2147483647,c=36,u=1,d=26,h=38,f=700,p=72,m=128,v="-",y=/^xn--/,b=/[^\x20-\x7E]/,_=/[\x2E\u3002\uFF0E\uFF61]/g,E={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},w=c-u,x=Math.floor,T=String.fromCharCode,C;function k(B){throw new RangeError(E[B])}function L(B,G){for(var Y=B.length,X=[];Y--;)X[Y]=G(B[Y]);return X}function F(B,G){var Y=B.split("@"),X="";Y.length>1&&(X=Y[0]+"@",B=Y[1]),B=B.replace(_,".");var J=B.split("."),ne=L(J,G).join(".");return X+ne}function N(B){for(var G=[],Y=0,X=B.length,J,ne;Y<X;)J=B.charCodeAt(Y++),J>=55296&&J<=56319&&Y<X?(ne=B.charCodeAt(Y++),(ne&64512)==56320?G.push(((J&1023)<<10)+(ne&1023)+65536):(G.push(J),Y--)):G.push(J);return G}function R(B){return L(B,function(G){var Y="";return G>65535&&(G-=65536,Y+=T(G>>>10&1023|55296),G=56320|G&1023),Y+=T(G),Y}).join("")}function H(B){return B-48<10?B-22:B-65<26?B-65:B-97<26?B-97:c}function W(B,G){return B+22+75*(B<26)-((G!=0)<<5)}function q(B,G,Y){var X=0;for(B=Y?x(B/f):B>>1,B+=x(B/G);B>w*d>>1;X+=c)B=x(B/w);return x(X+(w+1)*B/(B+h))}function Z(B){var G=[],Y=B.length,X,J=0,ne=m,se=p,Ue,De,Le,fe,ke,Xe,_t,Sn,Ot;for(Ue=B.lastIndexOf(v),Ue<0&&(Ue=0),De=0;De<Ue;++De)B.charCodeAt(De)>=128&&k("not-basic"),G.push(B.charCodeAt(De));for(Le=Ue>0?Ue+1:0;Le<Y;){for(fe=J,ke=1,Xe=c;Le>=Y&&k("invalid-input"),_t=H(B.charCodeAt(Le++)),(_t>=c||_t>x((l-J)/ke))&&k("overflow"),J+=_t*ke,Sn=Xe<=se?u:Xe>=se+d?d:Xe-se,!(_t<Sn);Xe+=c)Ot=c-Sn,ke>x(l/Ot)&&k("overflow"),ke*=Ot;X=G.length+1,se=q(J-fe,X,fe==0),x(J/X)>l-ne&&k("overflow"),ne+=x(J/X),J%=X,G.splice(J++,0,ne)}return R(G)}function j(B){var G,Y,X,J,ne,se,Ue,De,Le,fe,ke,Xe=[],_t,Sn,Ot,We;for(B=N(B),_t=B.length,G=m,Y=0,ne=p,se=0;se<_t;++se)ke=B[se],ke<128&&Xe.push(T(ke));for(X=J=Xe.length,J&&Xe.push(v);X<_t;){for(Ue=l,se=0;se<_t;++se)ke=B[se],ke>=G&&ke<Ue&&(Ue=ke);for(Sn=X+1,Ue-G>x((l-Y)/Sn)&&k("overflow"),Y+=(Ue-G)*Sn,G=Ue,se=0;se<_t;++se)if(ke=B[se],ke<G&&++Y>l&&k("overflow"),ke==G){for(De=Y,Le=c;fe=Le<=ne?u:Le>=ne+d?d:Le-ne,!(De<fe);Le+=c)We=De-fe,Ot=c-fe,Xe.push(T(W(fe+We%Ot,0))),De=x(We/Ot);Xe.push(T(W(De,0))),ne=q(Y,Sn,X==J),Y=0,++X}++Y,++G}return Xe.join("")}function K(B){return F(B,function(G){return y.test(G)?Z(G.slice(4).toLowerCase()):G})}function $(B){return F(B,function(G){return b.test(G)?"xn--"+j(G):G})}if(a={version:"1.4.1",ucs2:{decode:N,encode:R},decode:Z,encode:j,toASCII:$,toUnicode:K},i&&s)if(t.exports==i)s.exports=a;else for(C in a)a.hasOwnProperty(C)&&(i[C]=a[C]);else r.punycode=a})(E0)})(Z0,Z0.exports);var zW=Z0.exports,GW=function(){if(typeof Symbol!="function"||typeof Object.getOwnPropertySymbols!="function")return!1;if(typeof Symbol.iterator=="symbol")return!0;var e={},n=Symbol("test"),r=Object(n);if(typeof n=="string"||Object.prototype.toString.call(n)!=="[object Symbol]"||Object.prototype.toString.call(r)!=="[object Symbol]")return!1;var i=42;e[n]=i;for(n in e)return!1;if(typeof Object.keys=="function"&&Object.keys(e).length!==0||typeof Object.getOwnPropertyNames=="function"&&Object.getOwnPropertyNames(e).length!==0)return!1;var s=Object.getOwnPropertySymbols(e);if(s.length!==1||s[0]!==n||!Object.prototype.propertyIsEnumerable.call(e,n))return!1;if(typeof Object.getOwnPropertyDescriptor=="function"){var o=Object.getOwnPropertyDescriptor(e,n);if(o.value!==i||o.enumerable!==!0)return!1}return!0},JC=typeof Symbol<"u"&&Symbol,VW=GW,WW=function(){return typeof JC!="function"||typeof Symbol!="function"||typeof JC("foo")!="symbol"||typeof Symbol("bar")!="symbol"?!1:VW()},jW="Function.prototype.bind called on incompatible ",_b=Array.prototype.slice,XW=Object.prototype.toString,YW="[object Function]",ZW=function(e){var n=this;if(typeof n!="function"||XW.call(n)!==YW)throw new TypeError(jW+n);for(var r=_b.call(arguments,1),i,s=function(){if(this instanceof i){var u=n.apply(this,r.concat(_b.call(arguments)));return Object(u)===u?u:this}else return n.apply(e,r.concat(_b.call(arguments)))},o=Math.max(0,n.length-r.length),a=[],l=0;l<o;l++)a.push("$"+l);if(i=Function("binder","return function ("+a.join(",")+"){ return binder.apply(this,arguments); }")(s),n.prototype){var c=function(){};c.prototype=n.prototype,i.prototype=new c,c.prototype=null}return i},KW=ZW,VT=Function.prototype.bind||KW,qW=VT,JW=qW.call(Function.call,Object.prototype.hasOwnProperty),rt,Vd=SyntaxError,SR=Function,Ed=TypeError,Eb=function(t){try{return SR('"use strict"; return ('+t+").constructor;")()}catch{}},kc=Object.getOwnPropertyDescriptor;if(kc)try{kc({},"")}catch{kc=null}var wb=function(){throw new Ed},QW=kc?function(){try{return arguments.callee,wb}catch{try{return kc(arguments,"callee").get}catch{return wb}}}():wb,bu=WW(),Ks=Object.getPrototypeOf||function(t){return t.__proto__},Ru={},ej=typeof Uint8Array>"u"?rt:Ks(Uint8Array),Mc={"%AggregateError%":typeof AggregateError>"u"?rt:AggregateError,"%Array%":Array,"%ArrayBuffer%":typeof ArrayBuffer>"u"?rt:ArrayBuffer,"%ArrayIteratorPrototype%":bu?Ks([][Symbol.iterator]()):rt,"%AsyncFromSyncIteratorPrototype%":rt,"%AsyncFunction%":Ru,"%AsyncGenerator%":Ru,"%AsyncGeneratorFunction%":Ru,"%AsyncIteratorPrototype%":Ru,"%Atomics%":typeof Atomics>"u"?rt:Atomics,"%BigInt%":typeof BigInt>"u"?rt:BigInt,"%BigInt64Array%":typeof BigInt64Array>"u"?rt:BigInt64Array,"%BigUint64Array%":typeof BigUint64Array>"u"?rt:BigUint64Array,"%Boolean%":Boolean,"%DataView%":typeof DataView>"u"?rt:DataView,"%Date%":Date,"%decodeURI%":decodeURI,"%decodeURIComponent%":decodeURIComponent,"%encodeURI%":encodeURI,"%encodeURIComponent%":encodeURIComponent,"%Error%":Error,"%eval%":eval,"%EvalError%":EvalError,"%Float32Array%":typeof Float32Array>"u"?rt:Float32Array,"%Float64Array%":typeof Float64Array>"u"?rt:Float64Array,"%FinalizationRegistry%":typeof FinalizationRegistry>"u"?rt:FinalizationRegistry,"%Function%":SR,"%GeneratorFunction%":Ru,"%Int8Array%":typeof Int8Array>"u"?rt:Int8Array,"%Int16Array%":typeof Int16Array>"u"?rt:Int16Array,"%Int32Array%":typeof Int32Array>"u"?rt:Int32Array,"%isFinite%":isFinite,"%isNaN%":isNaN,"%IteratorPrototype%":bu?Ks(Ks([][Symbol.iterator]())):rt,"%JSON%":typeof JSON=="object"?JSON:rt,"%Map%":typeof Map>"u"?rt:Map,"%MapIteratorPrototype%":typeof Map>"u"||!bu?rt:Ks(new Map()[Symbol.iterator]()),"%Math%":Math,"%Number%":Number,"%Object%":Object,"%parseFloat%":parseFloat,"%parseInt%":parseInt,"%Promise%":typeof Promise>"u"?rt:Promise,"%Proxy%":typeof Proxy>"u"?rt:Proxy,"%RangeError%":RangeError,"%ReferenceError%":ReferenceError,"%Reflect%":typeof Reflect>"u"?rt:Reflect,"%RegExp%":RegExp,"%Set%":typeof Set>"u"?rt:Set,"%SetIteratorPrototype%":typeof Set>"u"||!bu?rt:Ks(new Set()[Symbol.iterator]()),"%SharedArrayBuffer%":typeof SharedArrayBuffer>"u"?rt:SharedArrayBuffer,"%String%":String,"%StringIteratorPrototype%":bu?Ks(""[Symbol.iterator]()):rt,"%Symbol%":bu?Symbol:rt,"%SyntaxError%":Vd,"%ThrowTypeError%":QW,"%TypedArray%":ej,"%TypeError%":Ed,"%Uint8Array%":typeof Uint8Array>"u"?rt:Uint8Array,"%Uint8ClampedArray%":typeof Uint8ClampedArray>"u"?rt:Uint8ClampedArray,"%Uint16Array%":typeof Uint16Array>"u"?rt:Uint16Array,"%Uint32Array%":typeof Uint32Array>"u"?rt:Uint32Array,"%URIError%":URIError,"%WeakMap%":typeof WeakMap>"u"?rt:WeakMap,"%WeakRef%":typeof WeakRef>"u"?rt:WeakRef,"%WeakSet%":typeof WeakSet>"u"?rt:WeakSet};try{null.error}catch(t){var tj=Ks(Ks(t));Mc["%Error.prototype%"]=tj}var nj=function t(e){var n;if(e==="%AsyncFunction%")n=Eb("async function () {}");else if(e==="%GeneratorFunction%")n=Eb("function* () {}");else if(e==="%AsyncGeneratorFunction%")n=Eb("async function* () {}");else if(e==="%AsyncGenerator%"){var r=t("%AsyncGeneratorFunction%");r&&(n=r.prototype)}else if(e==="%AsyncIteratorPrototype%"){var i=t("%AsyncGenerator%");i&&(n=Ks(i.prototype))}return Mc[e]=n,n},QC={"%ArrayBufferPrototype%":["ArrayBuffer","prototype"],"%ArrayPrototype%":["Array","prototype"],"%ArrayProto_entries%":["Array","prototype","entries"],"%ArrayProto_forEach%":["Array","prototype","forEach"],"%ArrayProto_keys%":["Array","prototype","keys"],"%ArrayProto_values%":["Array","prototype","values"],"%AsyncFunctionPrototype%":["AsyncFunction","prototype"],"%AsyncGenerator%":["AsyncGeneratorFunction","prototype"],"%AsyncGeneratorPrototype%":["AsyncGeneratorFunction","prototype","prototype"],"%BooleanPrototype%":["Boolean","prototype"],"%DataViewPrototype%":["DataView","prototype"],"%DatePrototype%":["Date","prototype"],"%ErrorPrototype%":["Error","prototype"],"%EvalErrorPrototype%":["EvalError","prototype"],"%Float32ArrayPrototype%":["Float32Array","prototype"],"%Float64ArrayPrototype%":["Float64Array","prototype"],"%FunctionPrototype%":["Function","prototype"],"%Generator%":["GeneratorFunction","prototype"],"%GeneratorPrototype%":["GeneratorFunction","prototype","prototype"],"%Int8ArrayPrototype%":["Int8Array","prototype"],"%Int16ArrayPrototype%":["Int16Array","prototype"],"%Int32ArrayPrototype%":["Int32Array","prototype"],"%JSONParse%":["JSON","parse"],"%JSONStringify%":["JSON","stringify"],"%MapPrototype%":["Map","prototype"],"%NumberPrototype%":["Number","prototype"],"%ObjectPrototype%":["Object","prototype"],"%ObjProto_toString%":["Object","prototype","toString"],"%ObjProto_valueOf%":["Object","prototype","valueOf"],"%PromisePrototype%":["Promise","prototype"],"%PromiseProto_then%":["Promise","prototype","then"],"%Promise_all%":["Promise","all"],"%Promise_reject%":["Promise","reject"],"%Promise_resolve%":["Promise","resolve"],"%RangeErrorPrototype%":["RangeError","prototype"],"%ReferenceErrorPrototype%":["ReferenceError","prototype"],"%RegExpPrototype%":["RegExp","prototype"],"%SetPrototype%":["Set","prototype"],"%SharedArrayBufferPrototype%":["SharedArrayBuffer","prototype"],"%StringPrototype%":["String","prototype"],"%SymbolPrototype%":["Symbol","prototype"],"%SyntaxErrorPrototype%":["SyntaxError","prototype"],"%TypedArrayPrototype%":["TypedArray","prototype"],"%TypeErrorPrototype%":["TypeError","prototype"],"%Uint8ArrayPrototype%":["Uint8Array","prototype"],"%Uint8ClampedArrayPrototype%":["Uint8ClampedArray","prototype"],"%Uint16ArrayPrototype%":["Uint16Array","prototype"],"%Uint32ArrayPrototype%":["Uint32Array","prototype"],"%URIErrorPrototype%":["URIError","prototype"],"%WeakMapPrototype%":["WeakMap","prototype"],"%WeakSetPrototype%":["WeakSet","prototype"]},Rm=VT,K0=JW,rj=Rm.call(Function.call,Array.prototype.concat),ij=Rm.call(Function.apply,Array.prototype.splice),e5=Rm.call(Function.call,String.prototype.replace),q0=Rm.call(Function.call,String.prototype.slice),sj=Rm.call(Function.call,RegExp.prototype.exec),oj=/[^%.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|%$))/g,aj=/\\(\\)?/g,lj=function(e){var n=q0(e,0,1),r=q0(e,-1);if(n==="%"&&r!=="%")throw new Vd("invalid intrinsic syntax, expected closing `%`");if(r==="%"&&n!=="%")throw new Vd("invalid intrinsic syntax, expected opening `%`");var i=[];return e5(e,oj,function(s,o,a,l){i[i.length]=a?e5(l,aj,"$1"):o||s}),i},cj=function(e,n){var r=e,i;if(K0(QC,r)&&(i=QC[r],r="%"+i[0]+"%"),K0(Mc,r)){var s=Mc[r];if(s===Ru&&(s=nj(r)),typeof s>"u"&&!n)throw new Ed("intrinsic "+e+" exists, but is not available. Please file an issue!");return{alias:i,name:r,value:s}}throw new Vd("intrinsic "+e+" does not exist!")},WT=function(e,n){if(typeof e!="string"||e.length===0)throw new Ed("intrinsic name must be a non-empty string");if(arguments.length>1&&typeof n!="boolean")throw new Ed('"allowMissing" argument must be a boolean');if(sj(/^%?[^%]*%?$/,e)===null)throw new Vd("`%` may not be present anywhere but at the beginning and end of the intrinsic name");var r=lj(e),i=r.length>0?r[0]:"",s=cj("%"+i+"%",n),o=s.name,a=s.value,l=!1,c=s.alias;c&&(i=c[0],ij(r,rj([0,1],c)));for(var u=1,d=!0;u<r.length;u+=1){var h=r[u],f=q0(h,0,1),p=q0(h,-1);if((f==='"'||f==="'"||f==="`"||p==='"'||p==="'"||p==="`")&&f!==p)throw new Vd("property names with quotes must have matching quotes");if((h==="constructor"||!d)&&(l=!0),i+="."+h,o="%"+i+"%",K0(Mc,o))a=Mc[o];else if(a!=null){if(!(h in a)){if(!n)throw new Ed("base intrinsic for "+e+" exists, but the property is not available.");return}if(kc&&u+1>=r.length){var m=kc(a,h);d=!!m,d&&"get"in m&&!("originalValue"in m.get)?a=m.get:a=a[h]}else d=K0(a,h),a=a[h];d&&!l&&(Mc[o]=a)}}return a},CR={exports:{}};(function(t){var e=VT,n=WT,r=n("%Function.prototype.apply%"),i=n("%Function.prototype.call%"),s=n("%Reflect.apply%",!0)||e.call(i,r),o=n("%Object.getOwnPropertyDescriptor%",!0),a=n("%Object.defineProperty%",!0),l=n("%Math.max%");if(a)try{a({},"a",{value:1})}catch{a=null}t.exports=function(d){var h=s(e,i,arguments);if(o&&a){var f=o(h,"length");f.configurable&&a(h,"length",{value:1+l(0,d.length-(arguments.length-1))})}return h};var c=function(){return s(e,r,arguments)};a?a(t.exports,"apply",{value:c}):t.exports.apply=c})(CR);var uj=CR.exports,IR=WT,AR=uj,dj=AR(IR("String.prototype.indexOf")),hj=function(e,n){var r=IR(e,!!n);return typeof r=="function"&&dj(e,".prototype.")>-1?AR(r):r};const fj={},pj=Object.freeze(Object.defineProperty({__proto__:null,default:fj},Symbol.toStringTag,{value:"Module"})),mj=aH(pj);var jT=typeof Map=="function"&&Map.prototype,xb=Object.getOwnPropertyDescriptor&&jT?Object.getOwnPropertyDescriptor(Map.prototype,"size"):null,J0=jT&&xb&&typeof xb.get=="function"?xb.get:null,t5=jT&&Map.prototype.forEach,XT=typeof Set=="function"&&Set.prototype,Tb=Object.getOwnPropertyDescriptor&&XT?Object.getOwnPropertyDescriptor(Set.prototype,"size"):null,Q0=XT&&Tb&&typeof Tb.get=="function"?Tb.get:null,n5=XT&&Set.prototype.forEach,gj=typeof WeakMap=="function"&&WeakMap.prototype,Vf=gj?WeakMap.prototype.has:null,yj=typeof WeakSet=="function"&&WeakSet.prototype,Wf=yj?WeakSet.prototype.has:null,vj=typeof WeakRef=="function"&&WeakRef.prototype,r5=vj?WeakRef.prototype.deref:null,bj=Boolean.prototype.valueOf,_j=Object.prototype.toString,Ej=Function.prototype.toString,wj=String.prototype.match,YT=String.prototype.slice,Ha=String.prototype.replace,xj=String.prototype.toUpperCase,i5=String.prototype.toLowerCase,kR=RegExp.prototype.test,s5=Array.prototype.concat,qs=Array.prototype.join,Tj=Array.prototype.slice,o5=Math.floor,ww=typeof BigInt=="function"?BigInt.prototype.valueOf:null,Sb=Object.getOwnPropertySymbols,xw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Symbol.prototype.toString:null,Wd=typeof Symbol=="function"&&typeof Symbol.iterator=="object",vr=typeof Symbol=="function"&&Symbol.toStringTag&&(typeof Symbol.toStringTag===Wd||!0)?Symbol.toStringTag:null,MR=Object.prototype.propertyIsEnumerable,a5=(typeof Reflect=="function"?Reflect.getPrototypeOf:Object.getPrototypeOf)||([].__proto__===Array.prototype?function(t){return t.__proto__}:null);function l5(t,e){if(t===1/0||t===-1/0||t!==t||t&&t>-1e3&&t<1e3||kR.call(/e/,e))return e;var n=/[0-9](?=(?:[0-9]{3})+(?![0-9]))/g;if(typeof t=="number"){var r=t<0?-o5(-t):o5(t);if(r!==t){var i=String(r),s=YT.call(e,i.length+1);return Ha.call(i,n,"$&_")+"."+Ha.call(Ha.call(s,/([0-9]{3})/g,"$&_"),/_$/,"")}}return Ha.call(e,n,"$&_")}var Tw=mj,c5=Tw.custom,u5=LR(c5)?c5:null,Sj=function t(e,n,r,i){var s=n||{};if(Ca(s,"quoteStyle")&&s.quoteStyle!=="single"&&s.quoteStyle!=="double")throw new TypeError('option "quoteStyle" must be "single" or "double"');if(Ca(s,"maxStringLength")&&(typeof s.maxStringLength=="number"?s.maxStringLength<0&&s.maxStringLength!==1/0:s.maxStringLength!==null))throw new TypeError('option "maxStringLength", if provided, must be a positive integer, Infinity, or `null`');var o=Ca(s,"customInspect")?s.customInspect:!0;if(typeof o!="boolean"&&o!=="symbol")throw new TypeError("option \"customInspect\", if provided, must be `true`, `false`, or `'symbol'`");if(Ca(s,"indent")&&s.indent!==null&&s.indent!=="	"&&!(parseInt(s.indent,10)===s.indent&&s.indent>0))throw new TypeError('option "indent" must be "\\t", an integer > 0, or `null`');if(Ca(s,"numericSeparator")&&typeof s.numericSeparator!="boolean")throw new TypeError('option "numericSeparator", if provided, must be `true` or `false`');var a=s.numericSeparator;if(typeof e>"u")return"undefined";if(e===null)return"null";if(typeof e=="boolean")return e?"true":"false";if(typeof e=="string")return OR(e,s);if(typeof e=="number"){if(e===0)return 1/0/e>0?"0":"-0";var l=String(e);return a?l5(e,l):l}if(typeof e=="bigint"){var c=String(e)+"n";return a?l5(e,c):c}var u=typeof s.depth>"u"?5:s.depth;if(typeof r>"u"&&(r=0),r>=u&&u>0&&typeof e=="object")return Sw(e)?"[Array]":"[Object]";var d=Gj(s,r);if(typeof i>"u")i=[];else if(RR(i,e)>=0)return"[Circular]";function h(R,H,W){if(H&&(i=Tj.call(i),i.push(H)),W){var q={depth:s.depth};return Ca(s,"quoteStyle")&&(q.quoteStyle=s.quoteStyle),t(R,q,r+1,i)}return t(R,s,r+1,i)}if(typeof e=="function"&&!d5(e)){var f=Oj(e),p=k1(e,h);return"[Function"+(f?": "+f:" (anonymous)")+"]"+(p.length>0?" { "+qs.call(p,", ")+" }":"")}if(LR(e)){var m=Wd?Ha.call(String(e),/^(Symbol\(.*\))_[^)]*$/,"$1"):xw.call(e);return typeof e=="object"&&!Wd?$h(m):m}if($j(e)){for(var v="<"+i5.call(String(e.nodeName)),y=e.attributes||[],b=0;b<y.length;b++)v+=" "+y[b].name+"="+PR(Cj(y[b].value),"double",s);return v+=">",e.childNodes&&e.childNodes.length&&(v+="..."),v+="</"+i5.call(String(e.nodeName))+">",v}if(Sw(e)){if(e.length===0)return"[]";var _=k1(e,h);return d&&!zj(_)?"["+Cw(_,d)+"]":"[ "+qs.call(_,", ")+" ]"}if(Aj(e)){var E=k1(e,h);return!("cause"in Error.prototype)&&"cause"in e&&!MR.call(e,"cause")?"{ ["+String(e)+"] "+qs.call(s5.call("[cause]: "+h(e.cause),E),", ")+" }":E.length===0?"["+String(e)+"]":"{ ["+String(e)+"] "+qs.call(E,", ")+" }"}if(typeof e=="object"&&o){if(u5&&typeof e[u5]=="function"&&Tw)return Tw(e,{depth:u-r});if(o!=="symbol"&&typeof e.inspect=="function")return e.inspect()}if(Dj(e)){var w=[];return t5&&t5.call(e,function(R,H){w.push(h(H,e,!0)+" => "+h(R,e))}),h5("Map",J0.call(e),w,d)}if(Bj(e)){var x=[];return n5&&n5.call(e,function(R){x.push(h(R,e))}),h5("Set",Q0.call(e),x,d)}if(Nj(e))return Cb("WeakMap");if(Uj(e))return Cb("WeakSet");if(Fj(e))return Cb("WeakRef");if(Mj(e))return $h(h(Number(e)));if(Lj(e))return $h(h(ww.call(e)));if(Pj(e))return $h(bj.call(e));if(kj(e))return $h(h(String(e)));if(!Ij(e)&&!d5(e)){var T=k1(e,h),C=a5?a5(e)===Object.prototype:e instanceof Object||e.constructor===Object,k=e instanceof Object?"":"null prototype",L=!C&&vr&&Object(e)===e&&vr in e?YT.call(Ml(e),8,-1):k?"Object":"",F=C||typeof e.constructor!="function"?"":e.constructor.name?e.constructor.name+" ":"",N=F+(L||k?"["+qs.call(s5.call([],L||[],k||[]),": ")+"] ":"");return T.length===0?N+"{}":d?N+"{"+Cw(T,d)+"}":N+"{ "+qs.call(T,", ")+" }"}return String(e)};function PR(t,e,n){var r=(n.quoteStyle||e)==="double"?'"':"'";return r+t+r}function Cj(t){return Ha.call(String(t),/"/g,"&quot;")}function Sw(t){return Ml(t)==="[object Array]"&&(!vr||!(typeof t=="object"&&vr in t))}function Ij(t){return Ml(t)==="[object Date]"&&(!vr||!(typeof t=="object"&&vr in t))}function d5(t){return Ml(t)==="[object RegExp]"&&(!vr||!(typeof t=="object"&&vr in t))}function Aj(t){return Ml(t)==="[object Error]"&&(!vr||!(typeof t=="object"&&vr in t))}function kj(t){return Ml(t)==="[object String]"&&(!vr||!(typeof t=="object"&&vr in t))}function Mj(t){return Ml(t)==="[object Number]"&&(!vr||!(typeof t=="object"&&vr in t))}function Pj(t){return Ml(t)==="[object Boolean]"&&(!vr||!(typeof t=="object"&&vr in t))}function LR(t){if(Wd)return t&&typeof t=="object"&&t instanceof Symbol;if(typeof t=="symbol")return!0;if(!t||typeof t!="object"||!xw)return!1;try{return xw.call(t),!0}catch{}return!1}function Lj(t){if(!t||typeof t!="object"||!ww)return!1;try{return ww.call(t),!0}catch{}return!1}var Rj=Object.prototype.hasOwnProperty||function(t){return t in this};function Ca(t,e){return Rj.call(t,e)}function Ml(t){return _j.call(t)}function Oj(t){if(t.name)return t.name;var e=wj.call(Ej.call(t),/^function\s*([\w$]+)/);return e?e[1]:null}function RR(t,e){if(t.indexOf)return t.indexOf(e);for(var n=0,r=t.length;n<r;n++)if(t[n]===e)return n;return-1}function Dj(t){if(!J0||!t||typeof t!="object")return!1;try{J0.call(t);try{Q0.call(t)}catch{return!0}return t instanceof Map}catch{}return!1}function Nj(t){if(!Vf||!t||typeof t!="object")return!1;try{Vf.call(t,Vf);try{Wf.call(t,Wf)}catch{return!0}return t instanceof WeakMap}catch{}return!1}function Fj(t){if(!r5||!t||typeof t!="object")return!1;try{return r5.call(t),!0}catch{}return!1}function Bj(t){if(!Q0||!t||typeof t!="object")return!1;try{Q0.call(t);try{J0.call(t)}catch{return!0}return t instanceof Set}catch{}return!1}function Uj(t){if(!Wf||!t||typeof t!="object")return!1;try{Wf.call(t,Wf);try{Vf.call(t,Vf)}catch{return!0}return t instanceof WeakSet}catch{}return!1}function $j(t){return!t||typeof t!="object"?!1:typeof HTMLElement<"u"&&t instanceof HTMLElement?!0:typeof t.nodeName=="string"&&typeof t.getAttribute=="function"}function OR(t,e){if(t.length>e.maxStringLength){var n=t.length-e.maxStringLength,r="... "+n+" more character"+(n>1?"s":"");return OR(YT.call(t,0,e.maxStringLength),e)+r}var i=Ha.call(Ha.call(t,/(['\\])/g,"\\$1"),/[\x00-\x1f]/g,Hj);return PR(i,"single",e)}function Hj(t){var e=t.charCodeAt(0),n={8:"b",9:"t",10:"n",12:"f",13:"r"}[e];return n?"\\"+n:"\\x"+(e<16?"0":"")+xj.call(e.toString(16))}function $h(t){return"Object("+t+")"}function Cb(t){return t+" { ? }"}function h5(t,e,n,r){var i=r?Cw(n,r):qs.call(n,", ");return t+" ("+e+") {"+i+"}"}function zj(t){for(var e=0;e<t.length;e++)if(RR(t[e],`
`)>=0)return!1;return!0}function Gj(t,e){var n;if(t.indent==="	")n="	";else if(typeof t.indent=="number"&&t.indent>0)n=qs.call(Array(t.indent+1)," ");else return null;return{base:n,prev:qs.call(Array(e+1),n)}}function Cw(t,e){if(t.length===0)return"";var n=`
`+e.prev+e.base;return n+qs.call(t,","+n)+`
`+e.prev}function k1(t,e){var n=Sw(t),r=[];if(n){r.length=t.length;for(var i=0;i<t.length;i++)r[i]=Ca(t,i)?e(t[i],t):""}var s=typeof Sb=="function"?Sb(t):[],o;if(Wd){o={};for(var a=0;a<s.length;a++)o["$"+s[a]]=s[a]}for(var l in t)Ca(t,l)&&(n&&String(Number(l))===l&&l<t.length||Wd&&o["$"+l]instanceof Symbol||(kR.call(/[^\w$]/,l)?r.push(e(l,t)+": "+e(t[l],t)):r.push(l+": "+e(t[l],t))));if(typeof Sb=="function")for(var c=0;c<s.length;c++)MR.call(t,s[c])&&r.push("["+e(s[c])+"]: "+e(t[s[c]],t));return r}var ZT=WT,ch=hj,Vj=Sj,Wj=ZT("%TypeError%"),M1=ZT("%WeakMap%",!0),P1=ZT("%Map%",!0),jj=ch("WeakMap.prototype.get",!0),Xj=ch("WeakMap.prototype.set",!0),Yj=ch("WeakMap.prototype.has",!0),Zj=ch("Map.prototype.get",!0),Kj=ch("Map.prototype.set",!0),qj=ch("Map.prototype.has",!0),KT=function(t,e){for(var n=t,r;(r=n.next)!==null;n=r)if(r.key===e)return n.next=r.next,r.next=t.next,t.next=r,r},Jj=function(t,e){var n=KT(t,e);return n&&n.value},Qj=function(t,e,n){var r=KT(t,e);r?r.value=n:t.next={key:e,next:t.next,value:n}},eX=function(t,e){return!!KT(t,e)},tX=function(){var e,n,r,i={assert:function(s){if(!i.has(s))throw new Wj("Side channel does not contain "+Vj(s))},get:function(s){if(M1&&s&&(typeof s=="object"||typeof s=="function")){if(e)return jj(e,s)}else if(P1){if(n)return Zj(n,s)}else if(r)return Jj(r,s)},has:function(s){if(M1&&s&&(typeof s=="object"||typeof s=="function")){if(e)return Yj(e,s)}else if(P1){if(n)return qj(n,s)}else if(r)return eX(r,s);return!1},set:function(s,o){M1&&s&&(typeof s=="object"||typeof s=="function")?(e||(e=new M1),Xj(e,s,o)):P1?(n||(n=new P1),Kj(n,s,o)):(r||(r={key:{},next:null}),Qj(r,s,o))}};return i},nX=String.prototype.replace,rX=/%20/g,Ib={RFC1738:"RFC1738",RFC3986:"RFC3986"},qT={default:Ib.RFC3986,formatters:{RFC1738:function(t){return nX.call(t,rX,"+")},RFC3986:function(t){return String(t)}},RFC1738:Ib.RFC1738,RFC3986:Ib.RFC3986},iX=qT,Ab=Object.prototype.hasOwnProperty,ic=Array.isArray,Ms=function(){for(var t=[],e=0;e<256;++e)t.push("%"+((e<16?"0":"")+e.toString(16)).toUpperCase());return t}(),sX=function(e){for(;e.length>1;){var n=e.pop(),r=n.obj[n.prop];if(ic(r)){for(var i=[],s=0;s<r.length;++s)typeof r[s]<"u"&&i.push(r[s]);n.obj[n.prop]=i}}},DR=function(e,n){for(var r=n&&n.plainObjects?Object.create(null):{},i=0;i<e.length;++i)typeof e[i]<"u"&&(r[i]=e[i]);return r},oX=function t(e,n,r){if(!n)return e;if(typeof n!="object"){if(ic(e))e.push(n);else if(e&&typeof e=="object")(r&&(r.plainObjects||r.allowPrototypes)||!Ab.call(Object.prototype,n))&&(e[n]=!0);else return[e,n];return e}if(!e||typeof e!="object")return[e].concat(n);var i=e;return ic(e)&&!ic(n)&&(i=DR(e,r)),ic(e)&&ic(n)?(n.forEach(function(s,o){if(Ab.call(e,o)){var a=e[o];a&&typeof a=="object"&&s&&typeof s=="object"?e[o]=t(a,s,r):e.push(s)}else e[o]=s}),e):Object.keys(n).reduce(function(s,o){var a=n[o];return Ab.call(s,o)?s[o]=t(s[o],a,r):s[o]=a,s},i)},aX=function(e,n){return Object.keys(n).reduce(function(r,i){return r[i]=n[i],r},e)},lX=function(t,e,n){var r=t.replace(/\+/g," ");if(n==="iso-8859-1")return r.replace(/%[0-9a-f]{2}/gi,unescape);try{return decodeURIComponent(r)}catch{return r}},cX=function(e,n,r,i,s){if(e.length===0)return e;var o=e;if(typeof e=="symbol"?o=Symbol.prototype.toString.call(e):typeof e!="string"&&(o=String(e)),r==="iso-8859-1")return escape(o).replace(/%u[0-9a-f]{4}/gi,function(u){return"%26%23"+parseInt(u.slice(2),16)+"%3B"});for(var a="",l=0;l<o.length;++l){var c=o.charCodeAt(l);if(c===45||c===46||c===95||c===126||c>=48&&c<=57||c>=65&&c<=90||c>=97&&c<=122||s===iX.RFC1738&&(c===40||c===41)){a+=o.charAt(l);continue}if(c<128){a=a+Ms[c];continue}if(c<2048){a=a+(Ms[192|c>>6]+Ms[128|c&63]);continue}if(c<55296||c>=57344){a=a+(Ms[224|c>>12]+Ms[128|c>>6&63]+Ms[128|c&63]);continue}l+=1,c=65536+((c&1023)<<10|o.charCodeAt(l)&1023),a+=Ms[240|c>>18]+Ms[128|c>>12&63]+Ms[128|c>>6&63]+Ms[128|c&63]}return a},uX=function(e){for(var n=[{obj:{o:e},prop:"o"}],r=[],i=0;i<n.length;++i)for(var s=n[i],o=s.obj[s.prop],a=Object.keys(o),l=0;l<a.length;++l){var c=a[l],u=o[c];typeof u=="object"&&u!==null&&r.indexOf(u)===-1&&(n.push({obj:o,prop:c}),r.push(u))}return sX(n),e},dX=function(e){return Object.prototype.toString.call(e)==="[object RegExp]"},hX=function(e){return!e||typeof e!="object"?!1:!!(e.constructor&&e.constructor.isBuffer&&e.constructor.isBuffer(e))},fX=function(e,n){return[].concat(e,n)},pX=function(e,n){if(ic(e)){for(var r=[],i=0;i<e.length;i+=1)r.push(n(e[i]));return r}return n(e)},NR={arrayToObject:DR,assign:aX,combine:fX,compact:uX,decode:lX,encode:cX,isBuffer:hX,isRegExp:dX,maybeMap:pX,merge:oX},FR=tX,zg=NR,jf=qT,mX=Object.prototype.hasOwnProperty,f5={brackets:function(e){return e+"[]"},comma:"comma",indices:function(e,n){return e+"["+n+"]"},repeat:function(e){return e}},Lo=Array.isArray,gX=Array.prototype.push,BR=function(t,e){gX.apply(t,Lo(e)?e:[e])},yX=Date.prototype.toISOString,p5=jf.default,lr={addQueryPrefix:!1,allowDots:!1,charset:"utf-8",charsetSentinel:!1,delimiter:"&",encode:!0,encoder:zg.encode,encodeValuesOnly:!1,format:p5,formatter:jf.formatters[p5],indices:!1,serializeDate:function(e){return yX.call(e)},skipNulls:!1,strictNullHandling:!1},vX=function(e){return typeof e=="string"||typeof e=="number"||typeof e=="boolean"||typeof e=="symbol"||typeof e=="bigint"},kb={},bX=function t(e,n,r,i,s,o,a,l,c,u,d,h,f,p,m,v){for(var y=e,b=v,_=0,E=!1;(b=b.get(kb))!==void 0&&!E;){var w=b.get(e);if(_+=1,typeof w<"u"){if(w===_)throw new RangeError("Cyclic object value");E=!0}typeof b.get(kb)>"u"&&(_=0)}if(typeof l=="function"?y=l(n,y):y instanceof Date?y=d(y):r==="comma"&&Lo(y)&&(y=zg.maybeMap(y,function(q){return q instanceof Date?d(q):q})),y===null){if(s)return a&&!p?a(n,lr.encoder,m,"key",h):n;y=""}if(vX(y)||zg.isBuffer(y)){if(a){var x=p?n:a(n,lr.encoder,m,"key",h);return[f(x)+"="+f(a(y,lr.encoder,m,"value",h))]}return[f(n)+"="+f(String(y))]}var T=[];if(typeof y>"u")return T;var C;if(r==="comma"&&Lo(y))p&&a&&(y=zg.maybeMap(y,a)),C=[{value:y.length>0?y.join(",")||null:void 0}];else if(Lo(l))C=l;else{var k=Object.keys(y);C=c?k.sort(c):k}for(var L=i&&Lo(y)&&y.length===1?n+"[]":n,F=0;F<C.length;++F){var N=C[F],R=typeof N=="object"&&typeof N.value<"u"?N.value:y[N];if(!(o&&R===null)){var H=Lo(y)?typeof r=="function"?r(L,N):L:L+(u?"."+N:"["+N+"]");v.set(e,_);var W=FR();W.set(kb,v),BR(T,t(R,H,r,i,s,o,r==="comma"&&p&&Lo(y)?null:a,l,c,u,d,h,f,p,m,W))}}return T},_X=function(e){if(!e)return lr;if(e.encoder!==null&&typeof e.encoder<"u"&&typeof e.encoder!="function")throw new TypeError("Encoder has to be a function.");var n=e.charset||lr.charset;if(typeof e.charset<"u"&&e.charset!=="utf-8"&&e.charset!=="iso-8859-1")throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");var r=jf.default;if(typeof e.format<"u"){if(!mX.call(jf.formatters,e.format))throw new TypeError("Unknown format option provided.");r=e.format}var i=jf.formatters[r],s=lr.filter;return(typeof e.filter=="function"||Lo(e.filter))&&(s=e.filter),{addQueryPrefix:typeof e.addQueryPrefix=="boolean"?e.addQueryPrefix:lr.addQueryPrefix,allowDots:typeof e.allowDots>"u"?lr.allowDots:!!e.allowDots,charset:n,charsetSentinel:typeof e.charsetSentinel=="boolean"?e.charsetSentinel:lr.charsetSentinel,delimiter:typeof e.delimiter>"u"?lr.delimiter:e.delimiter,encode:typeof e.encode=="boolean"?e.encode:lr.encode,encoder:typeof e.encoder=="function"?e.encoder:lr.encoder,encodeValuesOnly:typeof e.encodeValuesOnly=="boolean"?e.encodeValuesOnly:lr.encodeValuesOnly,filter:s,format:r,formatter:i,serializeDate:typeof e.serializeDate=="function"?e.serializeDate:lr.serializeDate,skipNulls:typeof e.skipNulls=="boolean"?e.skipNulls:lr.skipNulls,sort:typeof e.sort=="function"?e.sort:null,strictNullHandling:typeof e.strictNullHandling=="boolean"?e.strictNullHandling:lr.strictNullHandling}},EX=function(t,e){var n=t,r=_X(e),i,s;typeof r.filter=="function"?(s=r.filter,n=s("",n)):Lo(r.filter)&&(s=r.filter,i=s);var o=[];if(typeof n!="object"||n===null)return"";var a;e&&e.arrayFormat in f5?a=e.arrayFormat:e&&"indices"in e?a=e.indices?"indices":"repeat":a="indices";var l=f5[a];if(e&&"commaRoundTrip"in e&&typeof e.commaRoundTrip!="boolean")throw new TypeError("`commaRoundTrip` must be a boolean, or absent");var c=l==="comma"&&e&&e.commaRoundTrip;i||(i=Object.keys(n)),r.sort&&i.sort(r.sort);for(var u=FR(),d=0;d<i.length;++d){var h=i[d];r.skipNulls&&n[h]===null||BR(o,bX(n[h],h,l,c,r.strictNullHandling,r.skipNulls,r.encode?r.encoder:null,r.filter,r.sort,r.allowDots,r.serializeDate,r.format,r.formatter,r.encodeValuesOnly,r.charset,u))}var f=o.join(r.delimiter),p=r.addQueryPrefix===!0?"?":"";return r.charsetSentinel&&(r.charset==="iso-8859-1"?p+="utf8=%26%2310003%3B&":p+="utf8=%E2%9C%93&"),f.length>0?p+f:""},jd=NR,Iw=Object.prototype.hasOwnProperty,wX=Array.isArray,$n={allowDots:!1,allowPrototypes:!1,allowSparse:!1,arrayLimit:20,charset:"utf-8",charsetSentinel:!1,comma:!1,decoder:jd.decode,delimiter:"&",depth:5,ignoreQueryPrefix:!1,interpretNumericEntities:!1,parameterLimit:1e3,parseArrays:!0,plainObjects:!1,strictNullHandling:!1},xX=function(t){return t.replace(/&#(\d+);/g,function(e,n){return String.fromCharCode(parseInt(n,10))})},UR=function(t,e){return t&&typeof t=="string"&&e.comma&&t.indexOf(",")>-1?t.split(","):t},TX="utf8=%26%2310003%3B",SX="utf8=%E2%9C%93",CX=function(e,n){var r={__proto__:null},i=n.ignoreQueryPrefix?e.replace(/^\?/,""):e,s=n.parameterLimit===1/0?void 0:n.parameterLimit,o=i.split(n.delimiter,s),a=-1,l,c=n.charset;if(n.charsetSentinel)for(l=0;l<o.length;++l)o[l].indexOf("utf8=")===0&&(o[l]===SX?c="utf-8":o[l]===TX&&(c="iso-8859-1"),a=l,l=o.length);for(l=0;l<o.length;++l)if(l!==a){var u=o[l],d=u.indexOf("]="),h=d===-1?u.indexOf("="):d+1,f,p;h===-1?(f=n.decoder(u,$n.decoder,c,"key"),p=n.strictNullHandling?null:""):(f=n.decoder(u.slice(0,h),$n.decoder,c,"key"),p=jd.maybeMap(UR(u.slice(h+1),n),function(m){return n.decoder(m,$n.decoder,c,"value")})),p&&n.interpretNumericEntities&&c==="iso-8859-1"&&(p=xX(p)),u.indexOf("[]=")>-1&&(p=wX(p)?[p]:p),Iw.call(r,f)?r[f]=jd.combine(r[f],p):r[f]=p}return r},IX=function(t,e,n,r){for(var i=r?e:UR(e,n),s=t.length-1;s>=0;--s){var o,a=t[s];if(a==="[]"&&n.parseArrays)o=[].concat(i);else{o=n.plainObjects?Object.create(null):{};var l=a.charAt(0)==="["&&a.charAt(a.length-1)==="]"?a.slice(1,-1):a,c=parseInt(l,10);!n.parseArrays&&l===""?o={0:i}:!isNaN(c)&&a!==l&&String(c)===l&&c>=0&&n.parseArrays&&c<=n.arrayLimit?(o=[],o[c]=i):l!=="__proto__"&&(o[l]=i)}i=o}return i},AX=function(e,n,r,i){if(e){var s=r.allowDots?e.replace(/\.([^.[]+)/g,"[$1]"):e,o=/(\[[^[\]]*])/,a=/(\[[^[\]]*])/g,l=r.depth>0&&o.exec(s),c=l?s.slice(0,l.index):s,u=[];if(c){if(!r.plainObjects&&Iw.call(Object.prototype,c)&&!r.allowPrototypes)return;u.push(c)}for(var d=0;r.depth>0&&(l=a.exec(s))!==null&&d<r.depth;){if(d+=1,!r.plainObjects&&Iw.call(Object.prototype,l[1].slice(1,-1))&&!r.allowPrototypes)return;u.push(l[1])}return l&&u.push("["+s.slice(l.index)+"]"),IX(u,n,r,i)}},kX=function(e){if(!e)return $n;if(e.decoder!==null&&e.decoder!==void 0&&typeof e.decoder!="function")throw new TypeError("Decoder has to be a function.");if(typeof e.charset<"u"&&e.charset!=="utf-8"&&e.charset!=="iso-8859-1")throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");var n=typeof e.charset>"u"?$n.charset:e.charset;return{allowDots:typeof e.allowDots>"u"?$n.allowDots:!!e.allowDots,allowPrototypes:typeof e.allowPrototypes=="boolean"?e.allowPrototypes:$n.allowPrototypes,allowSparse:typeof e.allowSparse=="boolean"?e.allowSparse:$n.allowSparse,arrayLimit:typeof e.arrayLimit=="number"?e.arrayLimit:$n.arrayLimit,charset:n,charsetSentinel:typeof e.charsetSentinel=="boolean"?e.charsetSentinel:$n.charsetSentinel,comma:typeof e.comma=="boolean"?e.comma:$n.comma,decoder:typeof e.decoder=="function"?e.decoder:$n.decoder,delimiter:typeof e.delimiter=="string"||jd.isRegExp(e.delimiter)?e.delimiter:$n.delimiter,depth:typeof e.depth=="number"||e.depth===!1?+e.depth:$n.depth,ignoreQueryPrefix:e.ignoreQueryPrefix===!0,interpretNumericEntities:typeof e.interpretNumericEntities=="boolean"?e.interpretNumericEntities:$n.interpretNumericEntities,parameterLimit:typeof e.parameterLimit=="number"?e.parameterLimit:$n.parameterLimit,parseArrays:e.parseArrays!==!1,plainObjects:typeof e.plainObjects=="boolean"?e.plainObjects:$n.plainObjects,strictNullHandling:typeof e.strictNullHandling=="boolean"?e.strictNullHandling:$n.strictNullHandling}},MX=function(t,e){var n=kX(e);if(t===""||t===null||typeof t>"u")return n.plainObjects?Object.create(null):{};for(var r=typeof t=="string"?CX(t,n):t,i=n.plainObjects?Object.create(null):{},s=Object.keys(r),o=0;o<s.length;++o){var a=s[o],l=AX(a,r[a],n,typeof t=="string");i=jd.merge(i,l,n)}return n.allowSparse===!0?i:jd.compact(i)},PX=EX,LX=MX,RX=qT,OX={formats:RX,parse:LX,stringify:PX},DX=zW;function Vo(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}var NX=/^([a-z0-9.+-]+:)/i,FX=/:[0-9]*$/,BX=/^(\/\/?(?!\/)[^?\s]*)(\?[^\s]*)?$/,UX=["<",">",'"',"`"," ","\r",`
`,"	"],$X=["{","}","|","\\","^","`"].concat(UX),Aw=["'"].concat($X),m5=["%","/","?",";","#"].concat(Aw),g5=["/","?","#"],HX=255,y5=/^[+a-z0-9A-Z_-]{0,63}$/,zX=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,GX={javascript:!0,"javascript:":!0},kw={javascript:!0,"javascript:":!0},wd={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},Mw=OX;function VX(t,e,n){if(t&&typeof t=="object"&&t instanceof Vo)return t;var r=new Vo;return r.parse(t,e,n),r}Vo.prototype.parse=function(t,e,n){if(typeof t!="string")throw new TypeError("Parameter 'url' must be a string, not "+typeof t);var r=t.indexOf("?"),i=r!==-1&&r<t.indexOf("#")?"?":"#",s=t.split(i),o=/\\/g;s[0]=s[0].replace(o,"/"),t=s.join(i);var a=t;if(a=a.trim(),!n&&t.split("#").length===1){var l=BX.exec(a);if(l)return this.path=a,this.href=a,this.pathname=l[1],l[2]?(this.search=l[2],e?this.query=Mw.parse(this.search.substr(1)):this.query=this.search.substr(1)):e&&(this.search="",this.query={}),this}var c=NX.exec(a);if(c){c=c[0];var u=c.toLowerCase();this.protocol=u,a=a.substr(c.length)}if(n||c||a.match(/^\/\/[^@/]+@[^@/]+/)){var d=a.substr(0,2)==="//";d&&!(c&&kw[c])&&(a=a.substr(2),this.slashes=!0)}if(!kw[c]&&(d||c&&!wd[c])){for(var h=-1,f=0;f<g5.length;f++){var p=a.indexOf(g5[f]);p!==-1&&(h===-1||p<h)&&(h=p)}var m,v;h===-1?v=a.lastIndexOf("@"):v=a.lastIndexOf("@",h),v!==-1&&(m=a.slice(0,v),a=a.slice(v+1),this.auth=decodeURIComponent(m)),h=-1;for(var f=0;f<m5.length;f++){var p=a.indexOf(m5[f]);p!==-1&&(h===-1||p<h)&&(h=p)}h===-1&&(h=a.length),this.host=a.slice(0,h),a=a.slice(h),this.parseHost(),this.hostname=this.hostname||"";var y=this.hostname[0]==="["&&this.hostname[this.hostname.length-1]==="]";if(!y)for(var b=this.hostname.split(/\./),f=0,_=b.length;f<_;f++){var E=b[f];if(E&&!E.match(y5)){for(var w="",x=0,T=E.length;x<T;x++)E.charCodeAt(x)>127?w+="x":w+=E[x];if(!w.match(y5)){var C=b.slice(0,f),k=b.slice(f+1),L=E.match(zX);L&&(C.push(L[1]),k.unshift(L[2])),k.length&&(a="/"+k.join(".")+a),this.hostname=C.join(".");break}}}this.hostname.length>HX?this.hostname="":this.hostname=this.hostname.toLowerCase(),y||(this.hostname=DX.toASCII(this.hostname));var F=this.port?":"+this.port:"",N=this.hostname||"";this.host=N+F,this.href+=this.host,y&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),a[0]!=="/"&&(a="/"+a))}if(!GX[u])for(var f=0,_=Aw.length;f<_;f++){var R=Aw[f];if(a.indexOf(R)!==-1){var H=encodeURIComponent(R);H===R&&(H=escape(R)),a=a.split(R).join(H)}}var W=a.indexOf("#");W!==-1&&(this.hash=a.substr(W),a=a.slice(0,W));var q=a.indexOf("?");if(q!==-1?(this.search=a.substr(q),this.query=a.substr(q+1),e&&(this.query=Mw.parse(this.query)),a=a.slice(0,q)):e&&(this.search="",this.query={}),a&&(this.pathname=a),wd[u]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){var F=this.pathname||"",Z=this.search||"";this.path=F+Z}return this.href=this.format(),this};Vo.prototype.format=function(){var t=this.auth||"";t&&(t=encodeURIComponent(t),t=t.replace(/%3A/i,":"),t+="@");var e=this.protocol||"",n=this.pathname||"",r=this.hash||"",i=!1,s="";this.host?i=t+this.host:this.hostname&&(i=t+(this.hostname.indexOf(":")===-1?this.hostname:"["+this.hostname+"]"),this.port&&(i+=":"+this.port)),this.query&&typeof this.query=="object"&&Object.keys(this.query).length&&(s=Mw.stringify(this.query,{arrayFormat:"repeat",addQueryPrefix:!1}));var o=this.search||s&&"?"+s||"";return e&&e.substr(-1)!==":"&&(e+=":"),this.slashes||(!e||wd[e])&&i!==!1?(i="//"+(i||""),n&&n.charAt(0)!=="/"&&(n="/"+n)):i||(i=""),r&&r.charAt(0)!=="#"&&(r="#"+r),o&&o.charAt(0)!=="?"&&(o="?"+o),n=n.replace(/[?#]/g,function(a){return encodeURIComponent(a)}),o=o.replace("#","%23"),e+i+n+o+r};Vo.prototype.resolve=function(t){return this.resolveObject(VX(t,!1,!0)).format()};Vo.prototype.resolveObject=function(t){if(typeof t=="string"){var e=new Vo;e.parse(t,!1,!0),t=e}for(var n=new Vo,r=Object.keys(this),i=0;i<r.length;i++){var s=r[i];n[s]=this[s]}if(n.hash=t.hash,t.href==="")return n.href=n.format(),n;if(t.slashes&&!t.protocol){for(var o=Object.keys(t),a=0;a<o.length;a++){var l=o[a];l!=="protocol"&&(n[l]=t[l])}return wd[n.protocol]&&n.hostname&&!n.pathname&&(n.pathname="/",n.path=n.pathname),n.href=n.format(),n}if(t.protocol&&t.protocol!==n.protocol){if(!wd[t.protocol]){for(var c=Object.keys(t),u=0;u<c.length;u++){var d=c[u];n[d]=t[d]}return n.href=n.format(),n}if(n.protocol=t.protocol,!t.host&&!kw[t.protocol]){for(var _=(t.pathname||"").split("/");_.length&&!(t.host=_.shift()););t.host||(t.host=""),t.hostname||(t.hostname=""),_[0]!==""&&_.unshift(""),_.length<2&&_.unshift(""),n.pathname=_.join("/")}else n.pathname=t.pathname;if(n.search=t.search,n.query=t.query,n.host=t.host||"",n.auth=t.auth,n.hostname=t.hostname||t.host,n.port=t.port,n.pathname||n.search){var h=n.pathname||"",f=n.search||"";n.path=h+f}return n.slashes=n.slashes||t.slashes,n.href=n.format(),n}var p=n.pathname&&n.pathname.charAt(0)==="/",m=t.host||t.pathname&&t.pathname.charAt(0)==="/",v=m||p||n.host&&t.pathname,y=v,b=n.pathname&&n.pathname.split("/")||[],_=t.pathname&&t.pathname.split("/")||[],E=n.protocol&&!wd[n.protocol];if(E&&(n.hostname="",n.port=null,n.host&&(b[0]===""?b[0]=n.host:b.unshift(n.host)),n.host="",t.protocol&&(t.hostname=null,t.port=null,t.host&&(_[0]===""?_[0]=t.host:_.unshift(t.host)),t.host=null),v=v&&(_[0]===""||b[0]==="")),m)n.host=t.host||t.host===""?t.host:n.host,n.hostname=t.hostname||t.hostname===""?t.hostname:n.hostname,n.search=t.search,n.query=t.query,b=_;else if(_.length)b||(b=[]),b.pop(),b=b.concat(_),n.search=t.search,n.query=t.query;else if(t.search!=null){if(E){n.host=b.shift(),n.hostname=n.host;var w=n.host&&n.host.indexOf("@")>0?n.host.split("@"):!1;w&&(n.auth=w.shift(),n.hostname=w.shift(),n.host=n.hostname)}return n.search=t.search,n.query=t.query,(n.pathname!==null||n.search!==null)&&(n.path=(n.pathname?n.pathname:"")+(n.search?n.search:"")),n.href=n.format(),n}if(!b.length)return n.pathname=null,n.search?n.path="/"+n.search:n.path=null,n.href=n.format(),n;for(var x=b.slice(-1)[0],T=(n.host||t.host||b.length>1)&&(x==="."||x==="..")||x==="",C=0,k=b.length;k>=0;k--)x=b[k],x==="."?b.splice(k,1):x===".."?(b.splice(k,1),C++):C&&(b.splice(k,1),C--);if(!v&&!y)for(;C--;C)b.unshift("..");v&&b[0]!==""&&(!b[0]||b[0].charAt(0)!=="/")&&b.unshift(""),T&&b.join("/").substr(-1)!=="/"&&b.push("");var L=b[0]===""||b[0]&&b[0].charAt(0)==="/";if(E){n.hostname=L?"":b.length?b.shift():"",n.host=n.hostname;var w=n.host&&n.host.indexOf("@")>0?n.host.split("@"):!1;w&&(n.auth=w.shift(),n.hostname=w.shift(),n.host=n.hostname)}return v=v||n.host&&b.length,v&&!L&&b.unshift(""),b.length>0?n.pathname=b.join("/"):(n.pathname=null,n.path=null),(n.pathname!==null||n.search!==null)&&(n.path=(n.pathname?n.pathname:"")+(n.search?n.search:"")),n.auth=t.auth||n.auth,n.slashes=n.slashes||t.slashes,n.href=n.format(),n};Vo.prototype.parseHost=function(){var t=this.host,e=FX.exec(t);e&&(e=e[0],e!==":"&&(this.port=e.substr(1)),t=t.substr(0,t.length-e.length)),t&&(this.hostname=t)};const v5={};function Qe(t,e,n=3){if(v5[e])return;let r=new Error().stack;typeof r>"u"?console.warn("PixiJS Deprecation Warning: ",`${e}
Deprecated since v${t}`):(r=r.split(`
`).splice(n).join(`
`),console.groupCollapsed?(console.groupCollapsed("%cPixiJS Deprecation Warning: %c%s","color:#614108;background:#fffbe6","font-weight:normal;color:#614108;background:#fffbe6",`${e}
Deprecated since v${t}`),console.warn(r),console.groupEnd()):(console.warn("PixiJS Deprecation Warning: ",`${e}
Deprecated since v${t}`),console.warn(r))),v5[e]=!0}function Wi(t){if(typeof t!="string")throw new TypeError(`Path must be a string. Received ${JSON.stringify(t)}`)}function Hh(t){return t.split("?")[0].split("#")[0]}function WX(t){return t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function jX(t,e,n){return t.replace(new RegExp(WX(e),"g"),n)}function XX(t,e){let n="",r=0,i=-1,s=0,o=-1;for(let a=0;a<=t.length;++a){if(a<t.length)o=t.charCodeAt(a);else{if(o===47)break;o=47}if(o===47){if(!(i===a-1||s===1))if(i!==a-1&&s===2){if(n.length<2||r!==2||n.charCodeAt(n.length-1)!==46||n.charCodeAt(n.length-2)!==46){if(n.length>2){const l=n.lastIndexOf("/");if(l!==n.length-1){l===-1?(n="",r=0):(n=n.slice(0,l),r=n.length-1-n.lastIndexOf("/")),i=a,s=0;continue}}else if(n.length===2||n.length===1){n="",r=0,i=a,s=0;continue}}e&&(n.length>0?n+="/..":n="..",r=2)}else n.length>0?n+=`/${t.slice(i+1,a)}`:n=t.slice(i+1,a),r=a-i-1;i=a,s=0}else o===46&&s!==-1?++s:s=-1}return n}const Rn={toPosix(t){return jX(t,"\\","/")},isUrl(t){return/^https?:/.test(this.toPosix(t))},isDataUrl(t){return/^data:([a-z]+\/[a-z0-9-+.]+(;[a-z0-9-.!#$%*+.{}|~`]+=[a-z0-9-.!#$%*+.{}()_|~`]+)*)?(;base64)?,([a-z0-9!$&',()*+;=\-._~:@\/?%\s<>]*?)$/i.test(t)},isBlobUrl(t){return t.startsWith("blob:")},hasProtocol(t){return/^[^/:]+:/.test(this.toPosix(t))},getProtocol(t){Wi(t),t=this.toPosix(t);const e=/^file:\/\/\//.exec(t);if(e)return e[0];const n=/^[^/:]+:\/{0,2}/.exec(t);return n?n[0]:""},toAbsolute(t,e,n){if(Wi(t),this.isDataUrl(t)||this.isBlobUrl(t))return t;const r=Hh(this.toPosix(e??_e.ADAPTER.getBaseUrl())),i=Hh(this.toPosix(n??this.rootname(r)));return t=this.toPosix(t),t.startsWith("/")?Rn.join(i,t.slice(1)):this.isAbsolute(t)?t:this.join(r,t)},normalize(t){if(Wi(t),t.length===0)return".";if(this.isDataUrl(t)||this.isBlobUrl(t))return t;t=this.toPosix(t);let e="";const n=t.startsWith("/");this.hasProtocol(t)&&(e=this.rootname(t),t=t.slice(e.length));const r=t.endsWith("/");return t=XX(t,!1),t.length>0&&r&&(t+="/"),n?`/${t}`:e+t},isAbsolute(t){return Wi(t),t=this.toPosix(t),this.hasProtocol(t)?!0:t.startsWith("/")},join(...t){if(t.length===0)return".";let e;for(let n=0;n<t.length;++n){const r=t[n];if(Wi(r),r.length>0)if(e===void 0)e=r;else{const i=t[n-1]??"";this.joinExtensions.includes(this.extname(i).toLowerCase())?e+=`/../${r}`:e+=`/${r}`}}return e===void 0?".":this.normalize(e)},dirname(t){if(Wi(t),t.length===0)return".";t=this.toPosix(t);let e=t.charCodeAt(0);const n=e===47;let r=-1,i=!0;const s=this.getProtocol(t),o=t;t=t.slice(s.length);for(let a=t.length-1;a>=1;--a)if(e=t.charCodeAt(a),e===47){if(!i){r=a;break}}else i=!1;return r===-1?n?"/":this.isUrl(o)?s+t:s:n&&r===1?"//":s+t.slice(0,r)},rootname(t){Wi(t),t=this.toPosix(t);let e="";if(t.startsWith("/")?e="/":e=this.getProtocol(t),this.isUrl(t)){const n=t.indexOf("/",e.length);n!==-1?e=t.slice(0,n):e=t,e.endsWith("/")||(e+="/")}return e},basename(t,e){Wi(t),e&&Wi(e),t=Hh(this.toPosix(t));let n=0,r=-1,i=!0,s;if(e!==void 0&&e.length>0&&e.length<=t.length){if(e.length===t.length&&e===t)return"";let o=e.length-1,a=-1;for(s=t.length-1;s>=0;--s){const l=t.charCodeAt(s);if(l===47){if(!i){n=s+1;break}}else a===-1&&(i=!1,a=s+1),o>=0&&(l===e.charCodeAt(o)?--o===-1&&(r=s):(o=-1,r=a))}return n===r?r=a:r===-1&&(r=t.length),t.slice(n,r)}for(s=t.length-1;s>=0;--s)if(t.charCodeAt(s)===47){if(!i){n=s+1;break}}else r===-1&&(i=!1,r=s+1);return r===-1?"":t.slice(n,r)},extname(t){Wi(t),t=Hh(this.toPosix(t));let e=-1,n=0,r=-1,i=!0,s=0;for(let o=t.length-1;o>=0;--o){const a=t.charCodeAt(o);if(a===47){if(!i){n=o+1;break}continue}r===-1&&(i=!1,r=o+1),a===46?e===-1?e=o:s!==1&&(s=1):e!==-1&&(s=-1)}return e===-1||r===-1||s===0||s===1&&e===r-1&&e===n+1?"":t.slice(e,r)},parse(t){Wi(t);const e={root:"",dir:"",base:"",ext:"",name:""};if(t.length===0)return e;t=Hh(this.toPosix(t));let n=t.charCodeAt(0);const r=this.isAbsolute(t);let i;e.root=this.rootname(t),r||this.hasProtocol(t)?i=1:i=0;let s=-1,o=0,a=-1,l=!0,c=t.length-1,u=0;for(;c>=i;--c){if(n=t.charCodeAt(c),n===47){if(!l){o=c+1;break}continue}a===-1&&(l=!1,a=c+1),n===46?s===-1?s=c:u!==1&&(u=1):s!==-1&&(u=-1)}return s===-1||a===-1||u===0||u===1&&s===a-1&&s===o+1?a!==-1&&(o===0&&r?e.base=e.name=t.slice(1,a):e.base=e.name=t.slice(o,a)):(o===0&&r?(e.name=t.slice(1,s),e.base=t.slice(1,a)):(e.name=t.slice(o,s),e.base=t.slice(o,a)),e.ext=t.slice(s,a)),e.dir=this.dirname(t),e},sep:"/",delimiter:":",joinExtensions:[".html"]};let Mb;async function YX(){return Mb??(Mb=(async()=>{var s;const t=document.createElement("canvas").getContext("webgl");if(!t)return zr.UNPACK;const e=await new Promise(o=>{const a=document.createElement("video");a.onloadeddata=()=>o(a),a.onerror=()=>o(null),a.autoplay=!1,a.crossOrigin="anonymous",a.preload="auto",a.src="data:video/webm;base64,GkXfo59ChoEBQveBAULygQRC84EIQoKEd2VibUKHgQJChYECGFOAZwEAAAAAAAHTEU2bdLpNu4tTq4QVSalmU6yBoU27i1OrhBZUrmtTrIHGTbuMU6uEElTDZ1OsggEXTbuMU6uEHFO7a1OsggG97AEAAAAAAABZAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAVSalmoCrXsYMPQkBNgIRMYXZmV0GETGF2ZkSJiEBEAAAAAAAAFlSua8yuAQAAAAAAAEPXgQFzxYgAAAAAAAAAAZyBACK1nIN1bmSIgQCGhVZfVlA5g4EBI+ODhAJiWgDglLCBArqBApqBAlPAgQFVsIRVuYEBElTDZ9Vzc9JjwItjxYgAAAAAAAAAAWfInEWjh0VOQ09ERVJEh49MYXZjIGxpYnZweC12cDlnyKJFo4hEVVJBVElPTkSHlDAwOjAwOjAwLjA0MDAwMDAwMAAAH0O2dcfngQCgwqGggQAAAIJJg0IAABAAFgA4JBwYSgAAICAAEb///4r+AAB1oZ2mm+6BAaWWgkmDQgAAEAAWADgkHBhKAAAgIABIQBxTu2uRu4+zgQC3iveBAfGCAXHwgQM=",a.load()});if(!e)return zr.UNPACK;const n=t.createTexture();t.bindTexture(t.TEXTURE_2D,n);const r=t.createFramebuffer();t.bindFramebuffer(t.FRAMEBUFFER,r),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,n,0),t.pixelStorei(t.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),t.pixelStorei(t.UNPACK_COLORSPACE_CONVERSION_WEBGL,t.NONE),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,e);const i=new Uint8Array(4);return t.readPixels(0,0,1,1,t.RGBA,t.UNSIGNED_BYTE,i),t.deleteFramebuffer(r),t.deleteTexture(n),(s=t.getExtension("WEBGL_lose_context"))==null||s.loseContext(),i[0]<=i[3]?zr.PMA:zr.UNPACK})()),Mb}let Pb;function ZX(){return typeof Pb>"u"&&(Pb=function(){var e;const t={stencil:!0,failIfMajorPerformanceCaveat:_e.FAIL_IF_MAJOR_PERFORMANCE_CAVEAT};try{if(!_e.ADAPTER.getWebGLRenderingContext())return!1;const n=_e.ADAPTER.createCanvas();let r=n.getContext("webgl",t)||n.getContext("experimental-webgl",t);const i=!!((e=r==null?void 0:r.getContextAttributes())!=null&&e.stencil);if(r){const s=r.getExtension("WEBGL_lose_context");s&&s.loseContext()}return r=null,i}catch{return!1}}()),Pb}var KX={grad:.9,turn:360,rad:360/(2*Math.PI)},_o=function(t){return typeof t=="string"?t.length>0:typeof t=="number"},zn=function(t,e,n){return e===void 0&&(e=0),n===void 0&&(n=Math.pow(10,e)),Math.round(n*t)/n+0},Si=function(t,e,n){return e===void 0&&(e=0),n===void 0&&(n=1),t>n?n:t>e?t:e},$R=function(t){return(t=isFinite(t)?t%360:0)>0?t:t+360},b5=function(t){return{r:Si(t.r,0,255),g:Si(t.g,0,255),b:Si(t.b,0,255),a:Si(t.a)}},Lb=function(t){return{r:zn(t.r),g:zn(t.g),b:zn(t.b),a:zn(t.a,3)}},qX=/^#([0-9a-f]{3,8})$/i,L1=function(t){var e=t.toString(16);return e.length<2?"0"+e:e},HR=function(t){var e=t.r,n=t.g,r=t.b,i=t.a,s=Math.max(e,n,r),o=s-Math.min(e,n,r),a=o?s===e?(n-r)/o:s===n?2+(r-e)/o:4+(e-n)/o:0;return{h:60*(a<0?a+6:a),s:s?o/s*100:0,v:s/255*100,a:i}},zR=function(t){var e=t.h,n=t.s,r=t.v,i=t.a;e=e/360*6,n/=100,r/=100;var s=Math.floor(e),o=r*(1-n),a=r*(1-(e-s)*n),l=r*(1-(1-e+s)*n),c=s%6;return{r:255*[r,a,o,o,l,r][c],g:255*[l,r,r,a,o,o][c],b:255*[o,o,l,r,r,a][c],a:i}},_5=function(t){return{h:$R(t.h),s:Si(t.s,0,100),l:Si(t.l,0,100),a:Si(t.a)}},E5=function(t){return{h:zn(t.h),s:zn(t.s),l:zn(t.l),a:zn(t.a,3)}},w5=function(t){return zR((n=(e=t).s,{h:e.h,s:(n*=((r=e.l)<50?r:100-r)/100)>0?2*n/(r+n)*100:0,v:r+n,a:e.a}));var e,n,r},Xf=function(t){return{h:(e=HR(t)).h,s:(i=(200-(n=e.s))*(r=e.v)/100)>0&&i<200?n*r/100/(i<=100?i:200-i)*100:0,l:i/2,a:e.a};var e,n,r,i},JX=/^hsla?\(\s*([+-]?\d*\.?\d+)(deg|rad|grad|turn)?\s*,\s*([+-]?\d*\.?\d+)%\s*,\s*([+-]?\d*\.?\d+)%\s*(?:,\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,QX=/^hsla?\(\s*([+-]?\d*\.?\d+)(deg|rad|grad|turn)?\s+([+-]?\d*\.?\d+)%\s+([+-]?\d*\.?\d+)%\s*(?:\/\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,eY=/^rgba?\(\s*([+-]?\d*\.?\d+)(%)?\s*,\s*([+-]?\d*\.?\d+)(%)?\s*,\s*([+-]?\d*\.?\d+)(%)?\s*(?:,\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,tY=/^rgba?\(\s*([+-]?\d*\.?\d+)(%)?\s+([+-]?\d*\.?\d+)(%)?\s+([+-]?\d*\.?\d+)(%)?\s*(?:\/\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,Pw={string:[[function(t){var e=qX.exec(t);return e?(t=e[1]).length<=4?{r:parseInt(t[0]+t[0],16),g:parseInt(t[1]+t[1],16),b:parseInt(t[2]+t[2],16),a:t.length===4?zn(parseInt(t[3]+t[3],16)/255,2):1}:t.length===6||t.length===8?{r:parseInt(t.substr(0,2),16),g:parseInt(t.substr(2,2),16),b:parseInt(t.substr(4,2),16),a:t.length===8?zn(parseInt(t.substr(6,2),16)/255,2):1}:null:null},"hex"],[function(t){var e=eY.exec(t)||tY.exec(t);return e?e[2]!==e[4]||e[4]!==e[6]?null:b5({r:Number(e[1])/(e[2]?100/255:1),g:Number(e[3])/(e[4]?100/255:1),b:Number(e[5])/(e[6]?100/255:1),a:e[7]===void 0?1:Number(e[7])/(e[8]?100:1)}):null},"rgb"],[function(t){var e=JX.exec(t)||QX.exec(t);if(!e)return null;var n,r,i=_5({h:(n=e[1],r=e[2],r===void 0&&(r="deg"),Number(n)*(KX[r]||1)),s:Number(e[3]),l:Number(e[4]),a:e[5]===void 0?1:Number(e[5])/(e[6]?100:1)});return w5(i)},"hsl"]],object:[[function(t){var e=t.r,n=t.g,r=t.b,i=t.a,s=i===void 0?1:i;return _o(e)&&_o(n)&&_o(r)?b5({r:Number(e),g:Number(n),b:Number(r),a:Number(s)}):null},"rgb"],[function(t){var e=t.h,n=t.s,r=t.l,i=t.a,s=i===void 0?1:i;if(!_o(e)||!_o(n)||!_o(r))return null;var o=_5({h:Number(e),s:Number(n),l:Number(r),a:Number(s)});return w5(o)},"hsl"],[function(t){var e=t.h,n=t.s,r=t.v,i=t.a,s=i===void 0?1:i;if(!_o(e)||!_o(n)||!_o(r))return null;var o=function(a){return{h:$R(a.h),s:Si(a.s,0,100),v:Si(a.v,0,100),a:Si(a.a)}}({h:Number(e),s:Number(n),v:Number(r),a:Number(s)});return zR(o)},"hsv"]]},x5=function(t,e){for(var n=0;n<e.length;n++){var r=e[n][0](t);if(r)return[r,e[n][1]]}return[null,void 0]},nY=function(t){return typeof t=="string"?x5(t.trim(),Pw.string):typeof t=="object"&&t!==null?x5(t,Pw.object):[null,void 0]},Rb=function(t,e){var n=Xf(t);return{h:n.h,s:Si(n.s+100*e,0,100),l:n.l,a:n.a}},Ob=function(t){return(299*t.r+587*t.g+114*t.b)/1e3/255},T5=function(t,e){var n=Xf(t);return{h:n.h,s:n.s,l:Si(n.l+100*e,0,100),a:n.a}},Lw=function(){function t(e){this.parsed=nY(e)[0],this.rgba=this.parsed||{r:0,g:0,b:0,a:1}}return t.prototype.isValid=function(){return this.parsed!==null},t.prototype.brightness=function(){return zn(Ob(this.rgba),2)},t.prototype.isDark=function(){return Ob(this.rgba)<.5},t.prototype.isLight=function(){return Ob(this.rgba)>=.5},t.prototype.toHex=function(){return e=Lb(this.rgba),n=e.r,r=e.g,i=e.b,o=(s=e.a)<1?L1(zn(255*s)):"","#"+L1(n)+L1(r)+L1(i)+o;var e,n,r,i,s,o},t.prototype.toRgb=function(){return Lb(this.rgba)},t.prototype.toRgbString=function(){return e=Lb(this.rgba),n=e.r,r=e.g,i=e.b,(s=e.a)<1?"rgba("+n+", "+r+", "+i+", "+s+")":"rgb("+n+", "+r+", "+i+")";var e,n,r,i,s},t.prototype.toHsl=function(){return E5(Xf(this.rgba))},t.prototype.toHslString=function(){return e=E5(Xf(this.rgba)),n=e.h,r=e.s,i=e.l,(s=e.a)<1?"hsla("+n+", "+r+"%, "+i+"%, "+s+")":"hsl("+n+", "+r+"%, "+i+"%)";var e,n,r,i,s},t.prototype.toHsv=function(){return e=HR(this.rgba),{h:zn(e.h),s:zn(e.s),v:zn(e.v),a:zn(e.a,3)};var e},t.prototype.invert=function(){return Fs({r:255-(e=this.rgba).r,g:255-e.g,b:255-e.b,a:e.a});var e},t.prototype.saturate=function(e){return e===void 0&&(e=.1),Fs(Rb(this.rgba,e))},t.prototype.desaturate=function(e){return e===void 0&&(e=.1),Fs(Rb(this.rgba,-e))},t.prototype.grayscale=function(){return Fs(Rb(this.rgba,-1))},t.prototype.lighten=function(e){return e===void 0&&(e=.1),Fs(T5(this.rgba,e))},t.prototype.darken=function(e){return e===void 0&&(e=.1),Fs(T5(this.rgba,-e))},t.prototype.rotate=function(e){return e===void 0&&(e=15),this.hue(this.hue()+e)},t.prototype.alpha=function(e){return typeof e=="number"?Fs({r:(n=this.rgba).r,g:n.g,b:n.b,a:e}):zn(this.rgba.a,3);var n},t.prototype.hue=function(e){var n=Xf(this.rgba);return typeof e=="number"?Fs({h:e,s:n.s,l:n.l,a:n.a}):zn(n.h)},t.prototype.isEqual=function(e){return this.toHex()===Fs(e).toHex()},t}(),Fs=function(t){return t instanceof Lw?t:new Lw(t)},S5=[],rY=function(t){t.forEach(function(e){S5.indexOf(e)<0&&(e(Lw,Pw),S5.push(e))})};function iY(t,e){var n={white:"#ffffff",bisque:"#ffe4c4",blue:"#0000ff",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",antiquewhite:"#faebd7",aqua:"#00ffff",azure:"#f0ffff",whitesmoke:"#f5f5f5",papayawhip:"#ffefd5",plum:"#dda0dd",blanchedalmond:"#ffebcd",black:"#000000",gold:"#ffd700",goldenrod:"#daa520",gainsboro:"#dcdcdc",cornsilk:"#fff8dc",cornflowerblue:"#6495ed",burlywood:"#deb887",aquamarine:"#7fffd4",beige:"#f5f5dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkkhaki:"#bdb76b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",peachpuff:"#ffdab9",darkmagenta:"#8b008b",darkred:"#8b0000",darkorchid:"#9932cc",darkorange:"#ff8c00",darkslateblue:"#483d8b",gray:"#808080",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",deeppink:"#ff1493",deepskyblue:"#00bfff",wheat:"#f5deb3",firebrick:"#b22222",floralwhite:"#fffaf0",ghostwhite:"#f8f8ff",darkviolet:"#9400d3",magenta:"#ff00ff",green:"#008000",dodgerblue:"#1e90ff",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",blueviolet:"#8a2be2",forestgreen:"#228b22",lawngreen:"#7cfc00",indianred:"#cd5c5c",indigo:"#4b0082",fuchsia:"#ff00ff",brown:"#a52a2a",maroon:"#800000",mediumblue:"#0000cd",lightcoral:"#f08080",darkturquoise:"#00ced1",lightcyan:"#e0ffff",ivory:"#fffff0",lightyellow:"#ffffe0",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",linen:"#faf0e6",mediumaquamarine:"#66cdaa",lemonchiffon:"#fffacd",lime:"#00ff00",khaki:"#f0e68c",mediumseagreen:"#3cb371",limegreen:"#32cd32",mediumspringgreen:"#00fa9a",lightskyblue:"#87cefa",lightblue:"#add8e6",midnightblue:"#191970",lightpink:"#ffb6c1",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",mintcream:"#f5fffa",lightslategray:"#778899",lightslategrey:"#778899",navajowhite:"#ffdead",navy:"#000080",mediumvioletred:"#c71585",powderblue:"#b0e0e6",palegoldenrod:"#eee8aa",oldlace:"#fdf5e6",paleturquoise:"#afeeee",mediumturquoise:"#48d1cc",mediumorchid:"#ba55d3",rebeccapurple:"#663399",lightsteelblue:"#b0c4de",mediumslateblue:"#7b68ee",thistle:"#d8bfd8",tan:"#d2b48c",orchid:"#da70d6",mediumpurple:"#9370db",purple:"#800080",pink:"#ffc0cb",skyblue:"#87ceeb",springgreen:"#00ff7f",palegreen:"#98fb98",red:"#ff0000",yellow:"#ffff00",slateblue:"#6a5acd",lavenderblush:"#fff0f5",peru:"#cd853f",palevioletred:"#db7093",violet:"#ee82ee",teal:"#008080",slategray:"#708090",slategrey:"#708090",aliceblue:"#f0f8ff",darkseagreen:"#8fbc8f",darkolivegreen:"#556b2f",greenyellow:"#adff2f",seagreen:"#2e8b57",seashell:"#fff5ee",tomato:"#ff6347",silver:"#c0c0c0",sienna:"#a0522d",lavender:"#e6e6fa",lightgreen:"#90ee90",orange:"#ffa500",orangered:"#ff4500",steelblue:"#4682b4",royalblue:"#4169e1",turquoise:"#40e0d0",yellowgreen:"#9acd32",salmon:"#fa8072",saddlebrown:"#8b4513",sandybrown:"#f4a460",rosybrown:"#bc8f8f",darksalmon:"#e9967a",lightgoldenrodyellow:"#fafad2",snow:"#fffafa",lightgrey:"#d3d3d3",lightgray:"#d3d3d3",dimgray:"#696969",dimgrey:"#696969",olivedrab:"#6b8e23",olive:"#808000"},r={};for(var i in n)r[n[i]]=i;var s={};t.prototype.toName=function(o){if(!(this.rgba.a||this.rgba.r||this.rgba.g||this.rgba.b))return"transparent";var a,l,c=r[this.toHex()];if(c)return c;if(o!=null&&o.closest){var u=this.toRgb(),d=1/0,h="black";if(!s.length)for(var f in n)s[f]=new t(n[f]).toRgb();for(var p in n){var m=(a=u,l=s[p],Math.pow(a.r-l.r,2)+Math.pow(a.g-l.g,2)+Math.pow(a.b-l.b,2));m<d&&(d=m,h=p)}return h}},e.string.push([function(o){var a=o.toLowerCase(),l=a==="transparent"?"#0000":n[a];return l?new t(l).toRgb():null},"name"])}rY([iY]);const Ou=class Gg{constructor(e=16777215){this._value=null,this._components=new Float32Array(4),this._components.fill(1),this._int=16777215,this.value=e}get red(){return this._components[0]}get green(){return this._components[1]}get blue(){return this._components[2]}get alpha(){return this._components[3]}setValue(e){return this.value=e,this}set value(e){if(e instanceof Gg)this._value=this.cloneSource(e._value),this._int=e._int,this._components.set(e._components);else{if(e===null)throw new Error("Cannot set PIXI.Color#value to null");(this._value===null||!this.isSourceEqual(this._value,e))&&(this.normalize(e),this._value=this.cloneSource(e))}}get value(){return this._value}cloneSource(e){return typeof e=="string"||typeof e=="number"||e instanceof Number||e===null?e:Array.isArray(e)||ArrayBuffer.isView(e)?e.slice(0):typeof e=="object"&&e!==null?{...e}:e}isSourceEqual(e,n){const r=typeof e;if(r!==typeof n)return!1;if(r==="number"||r==="string"||e instanceof Number)return e===n;if(Array.isArray(e)&&Array.isArray(n)||ArrayBuffer.isView(e)&&ArrayBuffer.isView(n))return e.length!==n.length?!1:e.every((i,s)=>i===n[s]);if(e!==null&&n!==null){const i=Object.keys(e),s=Object.keys(n);return i.length!==s.length?!1:i.every(o=>e[o]===n[o])}return e===n}toRgba(){const[e,n,r,i]=this._components;return{r:e,g:n,b:r,a:i}}toRgb(){const[e,n,r]=this._components;return{r:e,g:n,b:r}}toRgbaString(){const[e,n,r]=this.toUint8RgbArray();return`rgba(${e},${n},${r},${this.alpha})`}toUint8RgbArray(e){const[n,r,i]=this._components;return e=e??[],e[0]=Math.round(n*255),e[1]=Math.round(r*255),e[2]=Math.round(i*255),e}toRgbArray(e){e=e??[];const[n,r,i]=this._components;return e[0]=n,e[1]=r,e[2]=i,e}toNumber(){return this._int}toLittleEndianNumber(){const e=this._int;return(e>>16)+(e&65280)+((e&255)<<16)}multiply(e){const[n,r,i,s]=Gg.temp.setValue(e)._components;return this._components[0]*=n,this._components[1]*=r,this._components[2]*=i,this._components[3]*=s,this.refreshInt(),this._value=null,this}premultiply(e,n=!0){return n&&(this._components[0]*=e,this._components[1]*=e,this._components[2]*=e),this._components[3]=e,this.refreshInt(),this._value=null,this}toPremultiplied(e,n=!0){if(e===1)return(255<<24)+this._int;if(e===0)return n?0:this._int;let r=this._int>>16&255,i=this._int>>8&255,s=this._int&255;return n&&(r=r*e+.5|0,i=i*e+.5|0,s=s*e+.5|0),(e*255<<24)+(r<<16)+(i<<8)+s}toHex(){const e=this._int.toString(16);return`#${"000000".substring(0,6-e.length)+e}`}toHexa(){const e=Math.round(this._components[3]*255).toString(16);return this.toHex()+"00".substring(0,2-e.length)+e}setAlpha(e){return this._components[3]=this._clamp(e),this}round(e){const[n,r,i]=this._components;return this._components[0]=Math.round(n*e)/e,this._components[1]=Math.round(r*e)/e,this._components[2]=Math.round(i*e)/e,this.refreshInt(),this._value=null,this}toArray(e){e=e??[];const[n,r,i,s]=this._components;return e[0]=n,e[1]=r,e[2]=i,e[3]=s,e}normalize(e){let n,r,i,s;if((typeof e=="number"||e instanceof Number)&&e>=0&&e<=16777215){const o=e;n=(o>>16&255)/255,r=(o>>8&255)/255,i=(o&255)/255,s=1}else if((Array.isArray(e)||e instanceof Float32Array)&&e.length>=3&&e.length<=4)e=this._clamp(e),[n,r,i,s=1]=e;else if((e instanceof Uint8Array||e instanceof Uint8ClampedArray)&&e.length>=3&&e.length<=4)e=this._clamp(e,0,255),[n,r,i,s=255]=e,n/=255,r/=255,i/=255,s/=255;else if(typeof e=="string"||typeof e=="object"){if(typeof e=="string"){const a=Gg.HEX_PATTERN.exec(e);a&&(e=`#${a[2]}`)}const o=Fs(e);o.isValid()&&({r:n,g:r,b:i,a:s}=o.rgba,n/=255,r/=255,i/=255)}if(n!==void 0)this._components[0]=n,this._components[1]=r,this._components[2]=i,this._components[3]=s,this.refreshInt();else throw new Error(`Unable to convert color ${e}`)}refreshInt(){this._clamp(this._components);const[e,n,r]=this._components;this._int=(e*255<<16)+(n*255<<8)+(r*255|0)}_clamp(e,n=0,r=1){return typeof e=="number"?Math.min(Math.max(e,n),r):(e.forEach((i,s)=>{e[s]=Math.min(Math.max(i,n),r)}),e)}};Ou.shared=new Ou,Ou.temp=new Ou,Ou.HEX_PATTERN=/^(#|0x)?(([a-f0-9]{3}){1,2}([a-f0-9]{2})?)$/i;let pt=Ou;function sY(t,e=[]){return Qe("7.2.0","utils.hex2rgb is deprecated, use Color#toRgbArray instead"),pt.shared.setValue(t).toRgbArray(e)}function oY(t){return Qe("7.2.0","utils.hex2string is deprecated, use Color#toHex instead"),pt.shared.setValue(t).toHex()}function aY(t){return Qe("7.2.0","utils.rgb2hex is deprecated, use Color#toNumber instead"),pt.shared.setValue(t).toNumber()}function lY(){const t=[],e=[];for(let r=0;r<32;r++)t[r]=r,e[r]=r;t[Ne.NORMAL_NPM]=Ne.NORMAL,t[Ne.ADD_NPM]=Ne.ADD,t[Ne.SCREEN_NPM]=Ne.SCREEN,e[Ne.NORMAL]=Ne.NORMAL_NPM,e[Ne.ADD]=Ne.ADD_NPM,e[Ne.SCREEN]=Ne.SCREEN_NPM;const n=[];return n.push(e),n.push(t),n}const GR=lY();function VR(t,e){return GR[e?1:0][t]}function cY(t,e=null){const n=t*6;if(e=e||new Uint16Array(n),e.length!==n)throw new Error(`Out buffer length is incorrect, got ${e.length} and expected ${n}`);for(let r=0,i=0;r<n;r+=6,i+=4)e[r+0]=i+0,e[r+1]=i+1,e[r+2]=i+2,e[r+3]=i+0,e[r+4]=i+2,e[r+5]=i+3;return e}function WR(t){if(t.BYTES_PER_ELEMENT===4)return t instanceof Float32Array?"Float32Array":t instanceof Uint32Array?"Uint32Array":"Int32Array";if(t.BYTES_PER_ELEMENT===2){if(t instanceof Uint16Array)return"Uint16Array"}else if(t.BYTES_PER_ELEMENT===1&&t instanceof Uint8Array)return"Uint8Array";return null}function ey(t){return t+=t===0?1:0,--t,t|=t>>>1,t|=t>>>2,t|=t>>>4,t|=t>>>8,t|=t>>>16,t+1}function C5(t){return!(t&t-1)&&!!t}function I5(t){let e=(t>65535?1:0)<<4;t>>>=e;let n=(t>255?1:0)<<3;return t>>>=n,e|=n,n=(t>15?1:0)<<2,t>>>=n,e|=n,n=(t>3?1:0)<<1,t>>>=n,e|=n,e|t>>1}function xd(t,e,n){const r=t.length;let i;if(e>=r||n===0)return;n=e+n>r?r-e:n;const s=r-n;for(i=e;i<s;++i)t[i]=t[i+n];t.length=s}function za(t){return t===0?0:t<0?-1:1}let uY=0;function Gc(){return++uY}const Rw=class{constructor(t,e,n,r){this.left=t,this.top=e,this.right=n,this.bottom=r}get width(){return this.right-this.left}get height(){return this.bottom-this.top}isEmpty(){return this.left===this.right||this.top===this.bottom}};Rw.EMPTY=new Rw(0,0,0,0);let A5=Rw;const k5={},Bs=Object.create(null),ga=Object.create(null);class dY{constructor(e,n,r){this._canvas=_e.ADAPTER.createCanvas(),this._context=this._canvas.getContext("2d"),this.resolution=r||_e.RESOLUTION,this.resize(e,n)}clear(){this._checkDestroyed(),this._context.setTransform(1,0,0,1,0,0),this._context.clearRect(0,0,this._canvas.width,this._canvas.height)}resize(e,n){this._checkDestroyed(),this._canvas.width=Math.round(e*this.resolution),this._canvas.height=Math.round(n*this.resolution)}destroy(){this._context=null,this._canvas=null}get width(){return this._checkDestroyed(),this._canvas.width}set width(e){this._checkDestroyed(),this._canvas.width=Math.round(e)}get height(){return this._checkDestroyed(),this._canvas.height}set height(e){this._checkDestroyed(),this._canvas.height=Math.round(e)}get canvas(){return this._checkDestroyed(),this._canvas}get context(){return this._checkDestroyed(),this._context}_checkDestroyed(){if(this._canvas===null)throw new TypeError("The CanvasRenderTarget has already been destroyed")}}function M5(t,e,n){for(let r=0,i=4*n*e;r<e;++r,i+=4)if(t[i+3]!==0)return!1;return!0}function P5(t,e,n,r,i){const s=4*e;for(let o=r,a=r*s+4*n;o<=i;++o,a+=s)if(t[a+3]!==0)return!1;return!0}function hY(t){const{width:e,height:n}=t,r=t.getContext("2d",{willReadFrequently:!0});if(r===null)throw new TypeError("Failed to get canvas 2D context");const i=r.getImageData(0,0,e,n).data;let s=0,o=0,a=e-1,l=n-1;for(;o<n&&M5(i,e,o);)++o;if(o===n)return A5.EMPTY;for(;M5(i,e,l);)--l;for(;P5(i,e,s,o,l);)++s;for(;P5(i,e,a,o,l);)--a;return++a,++l,new A5(s,o,a,l)}function fY(t){const e=hY(t),{width:n,height:r}=e;let i=null;if(!e.isEmpty()){const s=t.getContext("2d");if(s===null)throw new TypeError("Failed to get canvas 2D context");i=s.getImageData(e.left,e.top,n,r)}return{width:n,height:r,data:i}}function pY(t,e=globalThis.location){if(t.startsWith("data:"))return"";e=e||globalThis.location;const n=new URL(t,document.baseURI);return n.hostname!==e.hostname||n.port!==e.port||n.protocol!==e.protocol?"anonymous":""}function Qo(t,e=1){var r;const n=(r=_e.RETINA_PREFIX)==null?void 0:r.exec(t);return n?parseFloat(n[1]):e}var me=(t=>(t.Renderer="renderer",t.Application="application",t.RendererSystem="renderer-webgl-system",t.RendererPlugin="renderer-webgl-plugin",t.CanvasRendererSystem="renderer-canvas-system",t.CanvasRendererPlugin="renderer-canvas-plugin",t.Asset="asset",t.LoadParser="load-parser",t.ResolveParser="resolve-parser",t.CacheParser="cache-parser",t.DetectionParser="detection-parser",t))(me||{});const Ow=t=>{if(typeof t=="function"||typeof t=="object"&&t.extension){if(!t.extension)throw new Error("Extension class must have an extension object");t={...typeof t.extension!="object"?{type:t.extension}:t.extension,ref:t}}if(typeof t=="object")t={...t};else throw new Error("Invalid extension type");return typeof t.type=="string"&&(t.type=[t.type]),t},L5=(t,e)=>Ow(t).priority??e,Ce={_addHandlers:{},_removeHandlers:{},_queue:{},remove(...t){return t.map(Ow).forEach(e=>{e.type.forEach(n=>{var r,i;return(i=(r=this._removeHandlers)[n])==null?void 0:i.call(r,e)})}),this},add(...t){return t.map(Ow).forEach(e=>{e.type.forEach(n=>{const r=this._addHandlers,i=this._queue;r[n]?r[n](e):(i[n]=i[n]||[],i[n].push(e))})}),this},handle(t,e,n){const r=this._addHandlers,i=this._removeHandlers;if(r[t]||i[t])throw new Error(`Extension type ${t} already has a handler`);r[t]=e,i[t]=n;const s=this._queue;return s[t]&&(s[t].forEach(o=>e(o)),delete s[t]),this},handleByMap(t,e){return this.handle(t,n=>{e[n.name]=n.ref},n=>{delete e[n.name]})},handleByList(t,e,n=-1){return this.handle(t,r=>{e.includes(r.ref)||(e.push(r.ref),e.sort((i,s)=>L5(s,n)-L5(i,n)))},r=>{const i=e.indexOf(r.ref);i!==-1&&e.splice(i,1)})}};class Dw{constructor(e){typeof e=="number"?this.rawBinaryData=new ArrayBuffer(e):e instanceof Uint8Array?this.rawBinaryData=e.buffer:this.rawBinaryData=e,this.uint32View=new Uint32Array(this.rawBinaryData),this.float32View=new Float32Array(this.rawBinaryData)}get int8View(){return this._int8View||(this._int8View=new Int8Array(this.rawBinaryData)),this._int8View}get uint8View(){return this._uint8View||(this._uint8View=new Uint8Array(this.rawBinaryData)),this._uint8View}get int16View(){return this._int16View||(this._int16View=new Int16Array(this.rawBinaryData)),this._int16View}get uint16View(){return this._uint16View||(this._uint16View=new Uint16Array(this.rawBinaryData)),this._uint16View}get int32View(){return this._int32View||(this._int32View=new Int32Array(this.rawBinaryData)),this._int32View}view(e){return this[`${e}View`]}destroy(){this.rawBinaryData=null,this._int8View=null,this._uint8View=null,this._int16View=null,this._uint16View=null,this._int32View=null,this.uint32View=null,this.float32View=null}static sizeOf(e){switch(e){case"int8":case"uint8":return 1;case"int16":case"uint16":return 2;case"int32":case"uint32":case"float32":return 4;default:throw new Error(`${e} isn't a valid view type`)}}}const mY=["precision mediump float;","void main(void){","float test = 0.1;","%forloop%","gl_FragColor = vec4(0.0);","}"].join(`
`);function gY(t){let e="";for(let n=0;n<t;++n)n>0&&(e+=`
else `),n<t-1&&(e+=`if(test == ${n}.0){}`);return e}function yY(t,e){if(t===0)throw new Error("Invalid value of `0` passed to `checkMaxIfStatementsInShader`");const n=e.createShader(e.FRAGMENT_SHADER);for(;;){const r=mY.replace(/%forloop%/gi,gY(t));if(e.shaderSource(n,r),e.compileShader(n),!e.getShaderParameter(n,e.COMPILE_STATUS))t=t/2|0;else break}return t}const Db=0,Nb=1,Fb=2,Bb=3,Ub=4,$b=5;class Ts{constructor(){this.data=0,this.blendMode=Ne.NORMAL,this.polygonOffset=0,this.blend=!0,this.depthMask=!0}get blend(){return!!(this.data&1<<Db)}set blend(e){!!(this.data&1<<Db)!==e&&(this.data^=1<<Db)}get offsets(){return!!(this.data&1<<Nb)}set offsets(e){!!(this.data&1<<Nb)!==e&&(this.data^=1<<Nb)}get culling(){return!!(this.data&1<<Fb)}set culling(e){!!(this.data&1<<Fb)!==e&&(this.data^=1<<Fb)}get depthTest(){return!!(this.data&1<<Bb)}set depthTest(e){!!(this.data&1<<Bb)!==e&&(this.data^=1<<Bb)}get depthMask(){return!!(this.data&1<<$b)}set depthMask(e){!!(this.data&1<<$b)!==e&&(this.data^=1<<$b)}get clockwiseFrontFace(){return!!(this.data&1<<Ub)}set clockwiseFrontFace(e){!!(this.data&1<<Ub)!==e&&(this.data^=1<<Ub)}get blendMode(){return this._blendMode}set blendMode(e){this.blend=e!==Ne.NONE,this._blendMode=e}get polygonOffset(){return this._polygonOffset}set polygonOffset(e){this.offsets=!!e,this._polygonOffset=e}static for2d(){const e=new Ts;return e.depthTest=!1,e.blend=!0,e}}Ts.prototype.toString=function(){return`[@pixi/core:State blendMode=${this.blendMode} clockwiseFrontFace=${this.clockwiseFrontFace} culling=${this.culling} depthMask=${this.depthMask} polygonOffset=${this.polygonOffset}]`};const Nw=[];function jR(t,e){if(!t)return null;let n="";if(typeof t=="string"){const r=/\.(\w{3,4})(?:$|\?|#)/i.exec(t);r&&(n=r[1].toLowerCase())}for(let r=Nw.length-1;r>=0;--r){const i=Nw[r];if(i.test&&i.test(t,n))return new i(t,e)}throw new Error("Unrecognized source type to auto-detect Resource")}class fs{constructor(e){this.items=[],this._name=e,this._aliasCount=0}emit(e,n,r,i,s,o,a,l){if(arguments.length>8)throw new Error("max arguments reached");const{name:c,items:u}=this;this._aliasCount++;for(let d=0,h=u.length;d<h;d++)u[d][c](e,n,r,i,s,o,a,l);return u===this.items&&this._aliasCount--,this}ensureNonAliasedItems(){this._aliasCount>0&&this.items.length>1&&(this._aliasCount=0,this.items=this.items.slice(0))}add(e){return e[this._name]&&(this.ensureNonAliasedItems(),this.remove(e),this.items.push(e)),this}remove(e){const n=this.items.indexOf(e);return n!==-1&&(this.ensureNonAliasedItems(),this.items.splice(n,1)),this}contains(e){return this.items.includes(e)}removeAll(){return this.ensureNonAliasedItems(),this.items.length=0,this}destroy(){this.removeAll(),this.items=null,this._name=null}get empty(){return this.items.length===0}get name(){return this._name}}Object.defineProperties(fs.prototype,{dispatch:{value:fs.prototype.emit},run:{value:fs.prototype.emit}});class Hp{constructor(e=0,n=0){this._width=e,this._height=n,this.destroyed=!1,this.internal=!1,this.onResize=new fs("setRealSize"),this.onUpdate=new fs("update"),this.onError=new fs("onError")}bind(e){this.onResize.add(e),this.onUpdate.add(e),this.onError.add(e),(this._width||this._height)&&this.onResize.emit(this._width,this._height)}unbind(e){this.onResize.remove(e),this.onUpdate.remove(e),this.onError.remove(e)}resize(e,n){(e!==this._width||n!==this._height)&&(this._width=e,this._height=n,this.onResize.emit(e,n))}get valid(){return!!this._width&&!!this._height}update(){this.destroyed||this.onUpdate.emit()}load(){return Promise.resolve(this)}get width(){return this._width}get height(){return this._height}style(e,n,r){return!1}dispose(){}destroy(){this.destroyed||(this.destroyed=!0,this.dispose(),this.onError.removeAll(),this.onError=null,this.onResize.removeAll(),this.onResize=null,this.onUpdate.removeAll(),this.onUpdate=null)}static test(e,n){return!1}}class Dv extends Hp{constructor(e,n){const{width:r,height:i}=n||{};if(!r||!i)throw new Error("BufferResource width or height invalid");super(r,i),this.data=e,this.unpackAlignment=n.unpackAlignment??4}upload(e,n,r){const i=e.gl;i.pixelStorei(i.UNPACK_ALIGNMENT,this.unpackAlignment),i.pixelStorei(i.UNPACK_PREMULTIPLY_ALPHA_WEBGL,n.alphaMode===zr.UNPACK);const s=n.realWidth,o=n.realHeight;return r.width===s&&r.height===o?i.texSubImage2D(n.target,0,0,0,s,o,n.format,r.type,this.data):(r.width=s,r.height=o,i.texImage2D(n.target,0,r.internalFormat,s,o,0,n.format,r.type,this.data)),!0}dispose(){this.data=null}static test(e){return e===null||e instanceof Int8Array||e instanceof Uint8Array||e instanceof Uint8ClampedArray||e instanceof Int16Array||e instanceof Uint16Array||e instanceof Int32Array||e instanceof Uint32Array||e instanceof Float32Array}}const vY={scaleMode:No.NEAREST,alphaMode:zr.NPM},Fw=class Du extends Lm{constructor(e=null,n=null){super(),n=Object.assign({},Du.defaultOptions,n);const{alphaMode:r,mipmap:i,anisotropicLevel:s,scaleMode:o,width:a,height:l,wrapMode:c,format:u,type:d,target:h,resolution:f,resourceOptions:p}=n;e&&!(e instanceof Hp)&&(e=jR(e,p),e.internal=!0),this.resolution=f||_e.RESOLUTION,this.width=Math.round((a||0)*this.resolution)/this.resolution,this.height=Math.round((l||0)*this.resolution)/this.resolution,this._mipmap=i,this.anisotropicLevel=s,this._wrapMode=c,this._scaleMode=o,this.format=u,this.type=d,this.target=h,this.alphaMode=r,this.uid=Gc(),this.touched=0,this.isPowerOfTwo=!1,this._refreshPOT(),this._glTextures={},this.dirtyId=0,this.dirtyStyleId=0,this.cacheId=null,this.valid=a>0&&l>0,this.textureCacheIds=[],this.destroyed=!1,this.resource=null,this._batchEnabled=0,this._batchLocation=0,this.parentTextureArray=null,this.setResource(e)}get realWidth(){return Math.round(this.width*this.resolution)}get realHeight(){return Math.round(this.height*this.resolution)}get mipmap(){return this._mipmap}set mipmap(e){this._mipmap!==e&&(this._mipmap=e,this.dirtyStyleId++)}get scaleMode(){return this._scaleMode}set scaleMode(e){this._scaleMode!==e&&(this._scaleMode=e,this.dirtyStyleId++)}get wrapMode(){return this._wrapMode}set wrapMode(e){this._wrapMode!==e&&(this._wrapMode=e,this.dirtyStyleId++)}setStyle(e,n){let r;return e!==void 0&&e!==this.scaleMode&&(this.scaleMode=e,r=!0),n!==void 0&&n!==this.mipmap&&(this.mipmap=n,r=!0),r&&this.dirtyStyleId++,this}setSize(e,n,r){return r=r||this.resolution,this.setRealSize(e*r,n*r,r)}setRealSize(e,n,r){return this.resolution=r||this.resolution,this.width=Math.round(e)/this.resolution,this.height=Math.round(n)/this.resolution,this._refreshPOT(),this.update(),this}_refreshPOT(){this.isPowerOfTwo=C5(this.realWidth)&&C5(this.realHeight)}setResolution(e){const n=this.resolution;return n===e?this:(this.resolution=e,this.valid&&(this.width=Math.round(this.width*n)/e,this.height=Math.round(this.height*n)/e,this.emit("update",this)),this._refreshPOT(),this)}setResource(e){if(this.resource===e)return this;if(this.resource)throw new Error("Resource can be set only once");return e.bind(this),this.resource=e,this}update(){this.valid?(this.dirtyId++,this.dirtyStyleId++,this.emit("update",this)):this.width>0&&this.height>0&&(this.valid=!0,this.emit("loaded",this),this.emit("update",this))}onError(e){this.emit("error",this,e)}destroy(){this.resource&&(this.resource.unbind(this),this.resource.internal&&this.resource.destroy(),this.resource=null),this.cacheId&&(delete ga[this.cacheId],delete Bs[this.cacheId],this.cacheId=null),this.valid=!1,this.dispose(),Du.removeFromCache(this),this.textureCacheIds=null,this.destroyed=!0,this.emit("destroyed",this),this.removeAllListeners()}dispose(){this.emit("dispose",this)}castToBaseTexture(){return this}static from(e,n,r=_e.STRICT_TEXTURE_CACHE){const i=typeof e=="string";let s=null;if(i)s=e;else{if(!e._pixiId){const a=(n==null?void 0:n.pixiIdPrefix)||"pixiid";e._pixiId=`${a}_${Gc()}`}s=e._pixiId}let o=ga[s];if(i&&r&&!o)throw new Error(`The cacheId "${s}" does not exist in BaseTextureCache.`);return o||(o=new Du(e,n),o.cacheId=s,Du.addToCache(o,s)),o}static fromBuffer(e,n,r,i){e=e||new Float32Array(n*r*4);const s=new Dv(e,{width:n,height:r,...i==null?void 0:i.resourceOptions});let o,a;return e instanceof Float32Array?(o=le.RGBA,a=Te.FLOAT):e instanceof Int32Array?(o=le.RGBA_INTEGER,a=Te.INT):e instanceof Uint32Array?(o=le.RGBA_INTEGER,a=Te.UNSIGNED_INT):e instanceof Int16Array?(o=le.RGBA_INTEGER,a=Te.SHORT):e instanceof Uint16Array?(o=le.RGBA_INTEGER,a=Te.UNSIGNED_SHORT):e instanceof Int8Array?(o=le.RGBA,a=Te.BYTE):(o=le.RGBA,a=Te.UNSIGNED_BYTE),s.internal=!0,new Du(s,Object.assign({},vY,{type:a,format:o},i))}static addToCache(e,n){n&&(e.textureCacheIds.includes(n)||e.textureCacheIds.push(n),ga[n]&&ga[n]!==e&&console.warn(`BaseTexture added to the cache with an id [${n}] that already had an entry`),ga[n]=e)}static removeFromCache(e){if(typeof e=="string"){const n=ga[e];if(n){const r=n.textureCacheIds.indexOf(e);return r>-1&&n.textureCacheIds.splice(r,1),delete ga[e],n}}else if(e!=null&&e.textureCacheIds){for(let n=0;n<e.textureCacheIds.length;++n)delete ga[e.textureCacheIds[n]];return e.textureCacheIds.length=0,e}return null}};Fw.defaultOptions={mipmap:ho.POW2,anisotropicLevel:0,scaleMode:No.LINEAR,wrapMode:Go.CLAMP,alphaMode:zr.UNPACK,target:_d.TEXTURE_2D,format:le.RGBA,type:Te.UNSIGNED_BYTE},Fw._globalBatch=0;let ze=Fw,Bw=class{constructor(){this.texArray=null,this.blend=0,this.type=ls.TRIANGLES,this.start=0,this.size=0,this.data=null}},bY=0,hn=class XR{constructor(e,n=!0,r=!1){this.data=e||new Float32Array(1),this._glBuffers={},this._updateID=0,this.index=r,this.static=n,this.id=bY++,this.disposeRunner=new fs("disposeBuffer")}update(e){e instanceof Array&&(e=new Float32Array(e)),this.data=e||this.data,this._updateID++}dispose(){this.disposeRunner.emit(this,!1)}destroy(){this.dispose(),this.data=null}set index(e){this.type=e?so.ELEMENT_ARRAY_BUFFER:so.ARRAY_BUFFER}get index(){return this.type===so.ELEMENT_ARRAY_BUFFER}static from(e){return e instanceof Array&&(e=new Float32Array(e)),new XR(e)}};class ty{constructor(e,n=0,r=!1,i=Te.FLOAT,s,o,a,l=1){this.buffer=e,this.size=n,this.normalized=r,this.type=i,this.stride=s,this.start=o,this.instance=a,this.divisor=l}destroy(){this.buffer=null}static from(e,n,r,i,s){return new ty(e,n,r,i,s)}}const _Y={Float32Array,Uint32Array,Int32Array,Uint8Array};function EY(t,e){let n=0,r=0;const i={};for(let l=0;l<t.length;l++)r+=e[l],n+=t[l].length;const s=new ArrayBuffer(n*4);let o=null,a=0;for(let l=0;l<t.length;l++){const c=e[l],u=t[l],d=WR(u);i[d]||(i[d]=new _Y[d](s)),o=i[d];for(let h=0;h<u.length;h++){const f=(h/c|0)*r+a,p=h%c;o[f+p]=u[h]}a+=c}return new Float32Array(s)}const R5={5126:4,5123:2,5121:1};let wY=0;const xY={Float32Array,Uint32Array,Int32Array,Uint8Array,Uint16Array};class ea{constructor(e=[],n={}){this.buffers=e,this.indexBuffer=null,this.attributes=n,this.glVertexArrayObjects={},this.id=wY++,this.instanced=!1,this.instanceCount=1,this.disposeRunner=new fs("disposeGeometry"),this.refCount=0}addAttribute(e,n,r=0,i=!1,s,o,a,l=!1){if(!n)throw new Error("You must pass a buffer when creating an attribute");n instanceof hn||(n instanceof Array&&(n=new Float32Array(n)),n=new hn(n));const c=e.split("|");if(c.length>1){for(let d=0;d<c.length;d++)this.addAttribute(c[d],n,r,i,s);return this}let u=this.buffers.indexOf(n);return u===-1&&(this.buffers.push(n),u=this.buffers.length-1),this.attributes[e]=new ty(u,r,i,s,o,a,l),this.instanced=this.instanced||l,this}getAttribute(e){return this.attributes[e]}getBuffer(e){return this.buffers[this.getAttribute(e).buffer]}addIndex(e){return e instanceof hn||(e instanceof Array&&(e=new Uint16Array(e)),e=new hn(e)),e.type=so.ELEMENT_ARRAY_BUFFER,this.indexBuffer=e,this.buffers.includes(e)||this.buffers.push(e),this}getIndex(){return this.indexBuffer}interleave(){if(this.buffers.length===1||this.buffers.length===2&&this.indexBuffer)return this;const e=[],n=[],r=new hn;let i;for(i in this.attributes){const s=this.attributes[i],o=this.buffers[s.buffer];e.push(o.data),n.push(s.size*R5[s.type]/4),s.buffer=0}for(r.data=EY(e,n),i=0;i<this.buffers.length;i++)this.buffers[i]!==this.indexBuffer&&this.buffers[i].destroy();return this.buffers=[r],this.indexBuffer&&this.buffers.push(this.indexBuffer),this}getSize(){for(const e in this.attributes){const n=this.attributes[e];return this.buffers[n.buffer].data.length/(n.stride/4||n.size)}return 0}dispose(){this.disposeRunner.emit(this,!1)}destroy(){this.dispose(),this.buffers=null,this.indexBuffer=null,this.attributes=null}clone(){const e=new ea;for(let n=0;n<this.buffers.length;n++)e.buffers[n]=new hn(this.buffers[n].data.slice(0));for(const n in this.attributes){const r=this.attributes[n];e.attributes[n]=new ty(r.buffer,r.size,r.normalized,r.type,r.stride,r.start,r.instance)}return this.indexBuffer&&(e.indexBuffer=e.buffers[this.buffers.indexOf(this.indexBuffer)],e.indexBuffer.type=so.ELEMENT_ARRAY_BUFFER),e}static merge(e){const n=new ea,r=[],i=[],s=[];let o;for(let a=0;a<e.length;a++){o=e[a];for(let l=0;l<o.buffers.length;l++)i[l]=i[l]||0,i[l]+=o.buffers[l].data.length,s[l]=0}for(let a=0;a<o.buffers.length;a++)r[a]=new xY[WR(o.buffers[a].data)](i[a]),n.buffers[a]=new hn(r[a]);for(let a=0;a<e.length;a++){o=e[a];for(let l=0;l<o.buffers.length;l++)r[l].set(o.buffers[l].data,s[l]),s[l]+=o.buffers[l].data.length}if(n.attributes=o.attributes,o.indexBuffer){n.indexBuffer=n.buffers[o.buffers.indexOf(o.indexBuffer)],n.indexBuffer.type=so.ELEMENT_ARRAY_BUFFER;let a=0,l=0,c=0,u=0;for(let d=0;d<o.buffers.length;d++)if(o.buffers[d]!==o.indexBuffer){u=d;break}for(const d in o.attributes){const h=o.attributes[d];(h.buffer|0)===u&&(l+=h.size*R5[h.type]/4)}for(let d=0;d<e.length;d++){const h=e[d].indexBuffer.data;for(let f=0;f<h.length;f++)n.indexBuffer.data[f+c]+=a;a+=e[d].buffers[u].data.length/l,c+=h.length}}return n}}class YR extends ea{constructor(e=!1){super(),this._buffer=new hn(null,e,!1),this._indexBuffer=new hn(null,e,!0),this.addAttribute("aVertexPosition",this._buffer,2,!1,Te.FLOAT).addAttribute("aTextureCoord",this._buffer,2,!1,Te.FLOAT).addAttribute("aColor",this._buffer,4,!0,Te.UNSIGNED_BYTE).addAttribute("aTextureId",this._buffer,1,!0,Te.FLOAT).addIndex(this._indexBuffer)}}const Xd=Math.PI*2,TY=180/Math.PI,SY=Math.PI/180;var ut=(t=>(t[t.POLY=0]="POLY",t[t.RECT=1]="RECT",t[t.CIRC=2]="CIRC",t[t.ELIP=3]="ELIP",t[t.RREC=4]="RREC",t))(ut||{});class Ke{constructor(e=0,n=0){this.x=0,this.y=0,this.x=e,this.y=n}clone(){return new Ke(this.x,this.y)}copyFrom(e){return this.set(e.x,e.y),this}copyTo(e){return e.set(this.x,this.y),e}equals(e){return e.x===this.x&&e.y===this.y}set(e=0,n=e){return this.x=e,this.y=n,this}}Ke.prototype.toString=function(){return`[@pixi/math:Point x=${this.x} y=${this.y}]`};const R1=[new Ke,new Ke,new Ke,new Ke];class Me{constructor(e=0,n=0,r=0,i=0){this.x=Number(e),this.y=Number(n),this.width=Number(r),this.height=Number(i),this.type=ut.RECT}get left(){return this.x}get right(){return this.x+this.width}get top(){return this.y}get bottom(){return this.y+this.height}static get EMPTY(){return new Me(0,0,0,0)}clone(){return new Me(this.x,this.y,this.width,this.height)}copyFrom(e){return this.x=e.x,this.y=e.y,this.width=e.width,this.height=e.height,this}copyTo(e){return e.x=this.x,e.y=this.y,e.width=this.width,e.height=this.height,e}contains(e,n){return this.width<=0||this.height<=0?!1:e>=this.x&&e<this.x+this.width&&n>=this.y&&n<this.y+this.height}intersects(e,n){if(!n){const C=this.x<e.x?e.x:this.x;if((this.right>e.right?e.right:this.right)<=C)return!1;const k=this.y<e.y?e.y:this.y;return(this.bottom>e.bottom?e.bottom:this.bottom)>k}const r=this.left,i=this.right,s=this.top,o=this.bottom;if(i<=r||o<=s)return!1;const a=R1[0].set(e.left,e.top),l=R1[1].set(e.left,e.bottom),c=R1[2].set(e.right,e.top),u=R1[3].set(e.right,e.bottom);if(c.x<=a.x||l.y<=a.y)return!1;const d=Math.sign(n.a*n.d-n.b*n.c);if(d===0||(n.apply(a,a),n.apply(l,l),n.apply(c,c),n.apply(u,u),Math.max(a.x,l.x,c.x,u.x)<=r||Math.min(a.x,l.x,c.x,u.x)>=i||Math.max(a.y,l.y,c.y,u.y)<=s||Math.min(a.y,l.y,c.y,u.y)>=o))return!1;const h=d*(l.y-a.y),f=d*(a.x-l.x),p=h*r+f*s,m=h*i+f*s,v=h*r+f*o,y=h*i+f*o;if(Math.max(p,m,v,y)<=h*a.x+f*a.y||Math.min(p,m,v,y)>=h*u.x+f*u.y)return!1;const b=d*(a.y-c.y),_=d*(c.x-a.x),E=b*r+_*s,w=b*i+_*s,x=b*r+_*o,T=b*i+_*o;return!(Math.max(E,w,x,T)<=b*a.x+_*a.y||Math.min(E,w,x,T)>=b*u.x+_*u.y)}pad(e=0,n=e){return this.x-=e,this.y-=n,this.width+=e*2,this.height+=n*2,this}fit(e){const n=Math.max(this.x,e.x),r=Math.min(this.x+this.width,e.x+e.width),i=Math.max(this.y,e.y),s=Math.min(this.y+this.height,e.y+e.height);return this.x=n,this.width=Math.max(r-n,0),this.y=i,this.height=Math.max(s-i,0),this}ceil(e=1,n=.001){const r=Math.ceil((this.x+this.width-n)*e)/e,i=Math.ceil((this.y+this.height-n)*e)/e;return this.x=Math.floor((this.x+n)*e)/e,this.y=Math.floor((this.y+n)*e)/e,this.width=r-this.x,this.height=i-this.y,this}enlarge(e){const n=Math.min(this.x,e.x),r=Math.max(this.x+this.width,e.x+e.width),i=Math.min(this.y,e.y),s=Math.max(this.y+this.height,e.y+e.height);return this.x=n,this.width=r-n,this.y=i,this.height=s-i,this}}Me.prototype.toString=function(){return`[@pixi/math:Rectangle x=${this.x} y=${this.y} width=${this.width} height=${this.height}]`};class Om{constructor(e=0,n=0,r=0){this.x=e,this.y=n,this.radius=r,this.type=ut.CIRC}clone(){return new Om(this.x,this.y,this.radius)}contains(e,n){if(this.radius<=0)return!1;const r=this.radius*this.radius;let i=this.x-e,s=this.y-n;return i*=i,s*=s,i+s<=r}getBounds(){return new Me(this.x-this.radius,this.y-this.radius,this.radius*2,this.radius*2)}}Om.prototype.toString=function(){return`[@pixi/math:Circle x=${this.x} y=${this.y} radius=${this.radius}]`};class Dm{constructor(e=0,n=0,r=0,i=0){this.x=e,this.y=n,this.width=r,this.height=i,this.type=ut.ELIP}clone(){return new Dm(this.x,this.y,this.width,this.height)}contains(e,n){if(this.width<=0||this.height<=0)return!1;let r=(e-this.x)/this.width,i=(n-this.y)/this.height;return r*=r,i*=i,r+i<=1}getBounds(){return new Me(this.x-this.width,this.y-this.height,this.width,this.height)}}Dm.prototype.toString=function(){return`[@pixi/math:Ellipse x=${this.x} y=${this.y} width=${this.width} height=${this.height}]`};class oo{constructor(...e){let n=Array.isArray(e[0])?e[0]:e;if(typeof n[0]!="number"){const r=[];for(let i=0,s=n.length;i<s;i++)r.push(n[i].x,n[i].y);n=r}this.points=n,this.type=ut.POLY,this.closeStroke=!0}clone(){const e=this.points.slice(),n=new oo(e);return n.closeStroke=this.closeStroke,n}contains(e,n){let r=!1;const i=this.points.length/2;for(let s=0,o=i-1;s<i;o=s++){const a=this.points[s*2],l=this.points[s*2+1],c=this.points[o*2],u=this.points[o*2+1];l>n!=u>n&&e<(c-a)*((n-l)/(u-l))+a&&(r=!r)}return r}}oo.prototype.toString=function(){return`[@pixi/math:PolygoncloseStroke=${this.closeStroke}points=${this.points.reduce((t,e)=>`${t}, ${e}`,"")}]`};class Nm{constructor(e=0,n=0,r=0,i=0,s=20){this.x=e,this.y=n,this.width=r,this.height=i,this.radius=s,this.type=ut.RREC}clone(){return new Nm(this.x,this.y,this.width,this.height,this.radius)}contains(e,n){if(this.width<=0||this.height<=0)return!1;if(e>=this.x&&e<=this.x+this.width&&n>=this.y&&n<=this.y+this.height){const r=Math.max(0,Math.min(this.radius,Math.min(this.width,this.height)/2));if(n>=this.y+r&&n<=this.y+this.height-r||e>=this.x+r&&e<=this.x+this.width-r)return!0;let i=e-(this.x+r),s=n-(this.y+r);const o=r*r;if(i*i+s*s<=o||(i=e-(this.x+this.width-r),i*i+s*s<=o)||(s=n-(this.y+this.height-r),i*i+s*s<=o)||(i=e-(this.x+r),i*i+s*s<=o))return!0}return!1}}Nm.prototype.toString=function(){return`[@pixi/math:RoundedRectangle x=${this.x} y=${this.y}width=${this.width} height=${this.height} radius=${this.radius}]`};class Ze{constructor(e=1,n=0,r=0,i=1,s=0,o=0){this.array=null,this.a=e,this.b=n,this.c=r,this.d=i,this.tx=s,this.ty=o}fromArray(e){this.a=e[0],this.b=e[1],this.c=e[3],this.d=e[4],this.tx=e[2],this.ty=e[5]}set(e,n,r,i,s,o){return this.a=e,this.b=n,this.c=r,this.d=i,this.tx=s,this.ty=o,this}toArray(e,n){this.array||(this.array=new Float32Array(9));const r=n||this.array;return e?(r[0]=this.a,r[1]=this.b,r[2]=0,r[3]=this.c,r[4]=this.d,r[5]=0,r[6]=this.tx,r[7]=this.ty,r[8]=1):(r[0]=this.a,r[1]=this.c,r[2]=this.tx,r[3]=this.b,r[4]=this.d,r[5]=this.ty,r[6]=0,r[7]=0,r[8]=1),r}apply(e,n){n=n||new Ke;const r=e.x,i=e.y;return n.x=this.a*r+this.c*i+this.tx,n.y=this.b*r+this.d*i+this.ty,n}applyInverse(e,n){n=n||new Ke;const r=1/(this.a*this.d+this.c*-this.b),i=e.x,s=e.y;return n.x=this.d*r*i+-this.c*r*s+(this.ty*this.c-this.tx*this.d)*r,n.y=this.a*r*s+-this.b*r*i+(-this.ty*this.a+this.tx*this.b)*r,n}translate(e,n){return this.tx+=e,this.ty+=n,this}scale(e,n){return this.a*=e,this.d*=n,this.c*=e,this.b*=n,this.tx*=e,this.ty*=n,this}rotate(e){const n=Math.cos(e),r=Math.sin(e),i=this.a,s=this.c,o=this.tx;return this.a=i*n-this.b*r,this.b=i*r+this.b*n,this.c=s*n-this.d*r,this.d=s*r+this.d*n,this.tx=o*n-this.ty*r,this.ty=o*r+this.ty*n,this}append(e){const n=this.a,r=this.b,i=this.c,s=this.d;return this.a=e.a*n+e.b*i,this.b=e.a*r+e.b*s,this.c=e.c*n+e.d*i,this.d=e.c*r+e.d*s,this.tx=e.tx*n+e.ty*i+this.tx,this.ty=e.tx*r+e.ty*s+this.ty,this}setTransform(e,n,r,i,s,o,a,l,c){return this.a=Math.cos(a+c)*s,this.b=Math.sin(a+c)*s,this.c=-Math.sin(a-l)*o,this.d=Math.cos(a-l)*o,this.tx=e-(r*this.a+i*this.c),this.ty=n-(r*this.b+i*this.d),this}prepend(e){const n=this.tx;if(e.a!==1||e.b!==0||e.c!==0||e.d!==1){const r=this.a,i=this.c;this.a=r*e.a+this.b*e.c,this.b=r*e.b+this.b*e.d,this.c=i*e.a+this.d*e.c,this.d=i*e.b+this.d*e.d}return this.tx=n*e.a+this.ty*e.c+e.tx,this.ty=n*e.b+this.ty*e.d+e.ty,this}decompose(e){const n=this.a,r=this.b,i=this.c,s=this.d,o=e.pivot,a=-Math.atan2(-i,s),l=Math.atan2(r,n),c=Math.abs(a+l);return c<1e-5||Math.abs(Xd-c)<1e-5?(e.rotation=l,e.skew.x=e.skew.y=0):(e.rotation=0,e.skew.x=a,e.skew.y=l),e.scale.x=Math.sqrt(n*n+r*r),e.scale.y=Math.sqrt(i*i+s*s),e.position.x=this.tx+(o.x*n+o.y*i),e.position.y=this.ty+(o.x*r+o.y*s),e}invert(){const e=this.a,n=this.b,r=this.c,i=this.d,s=this.tx,o=e*i-n*r;return this.a=i/o,this.b=-n/o,this.c=-r/o,this.d=e/o,this.tx=(r*this.ty-i*s)/o,this.ty=-(e*this.ty-n*s)/o,this}identity(){return this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this}clone(){const e=new Ze;return e.a=this.a,e.b=this.b,e.c=this.c,e.d=this.d,e.tx=this.tx,e.ty=this.ty,e}copyTo(e){return e.a=this.a,e.b=this.b,e.c=this.c,e.d=this.d,e.tx=this.tx,e.ty=this.ty,e}copyFrom(e){return this.a=e.a,this.b=e.b,this.c=e.c,this.d=e.d,this.tx=e.tx,this.ty=e.ty,this}static get IDENTITY(){return new Ze}static get TEMP_MATRIX(){return new Ze}}Ze.prototype.toString=function(){return`[@pixi/math:Matrix a=${this.a} b=${this.b} c=${this.c} d=${this.d} tx=${this.tx} ty=${this.ty}]`};const Wl=[1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1,0,1],jl=[0,1,1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1],Xl=[0,-1,-1,-1,0,1,1,1,0,1,1,1,0,-1,-1,-1],Yl=[1,1,0,-1,-1,-1,0,1,-1,-1,0,1,1,1,0,-1],Uw=[],ZR=[],O1=Math.sign;function CY(){for(let t=0;t<16;t++){const e=[];Uw.push(e);for(let n=0;n<16;n++){const r=O1(Wl[t]*Wl[n]+Xl[t]*jl[n]),i=O1(jl[t]*Wl[n]+Yl[t]*jl[n]),s=O1(Wl[t]*Xl[n]+Xl[t]*Yl[n]),o=O1(jl[t]*Xl[n]+Yl[t]*Yl[n]);for(let a=0;a<16;a++)if(Wl[a]===r&&jl[a]===i&&Xl[a]===s&&Yl[a]===o){e.push(a);break}}}for(let t=0;t<16;t++){const e=new Ze;e.set(Wl[t],jl[t],Xl[t],Yl[t],0,0),ZR.push(e)}}CY();const qt={E:0,SE:1,S:2,SW:3,W:4,NW:5,N:6,NE:7,MIRROR_VERTICAL:8,MAIN_DIAGONAL:10,MIRROR_HORIZONTAL:12,REVERSE_DIAGONAL:14,uX:t=>Wl[t],uY:t=>jl[t],vX:t=>Xl[t],vY:t=>Yl[t],inv:t=>t&8?t&15:-t&7,add:(t,e)=>Uw[t][e],sub:(t,e)=>Uw[t][qt.inv(e)],rotate180:t=>t^4,isVertical:t=>(t&3)===2,byDirection:(t,e)=>Math.abs(t)*2<=Math.abs(e)?e>=0?qt.S:qt.N:Math.abs(e)*2<=Math.abs(t)?t>0?qt.E:qt.W:e>0?t>0?qt.SE:qt.SW:t>0?qt.NE:qt.NW,matrixAppendRotationInv:(t,e,n=0,r=0)=>{const i=ZR[qt.inv(e)];i.tx=n,i.ty=r,t.append(i)}};class Bo{constructor(e,n,r=0,i=0){this._x=r,this._y=i,this.cb=e,this.scope=n}clone(e=this.cb,n=this.scope){return new Bo(e,n,this._x,this._y)}set(e=0,n=e){return(this._x!==e||this._y!==n)&&(this._x=e,this._y=n,this.cb.call(this.scope)),this}copyFrom(e){return(this._x!==e.x||this._y!==e.y)&&(this._x=e.x,this._y=e.y,this.cb.call(this.scope)),this}copyTo(e){return e.set(this._x,this._y),e}equals(e){return e.x===this._x&&e.y===this._y}get x(){return this._x}set x(e){this._x!==e&&(this._x=e,this.cb.call(this.scope))}get y(){return this._y}set y(e){this._y!==e&&(this._y=e,this.cb.call(this.scope))}}Bo.prototype.toString=function(){return`[@pixi/math:ObservablePoint x=${this.x} y=${this.y} scope=${this.scope}]`};const $w=class{constructor(){this.worldTransform=new Ze,this.localTransform=new Ze,this.position=new Bo(this.onChange,this,0,0),this.scale=new Bo(this.onChange,this,1,1),this.pivot=new Bo(this.onChange,this,0,0),this.skew=new Bo(this.updateSkew,this,0,0),this._rotation=0,this._cx=1,this._sx=0,this._cy=0,this._sy=1,this._localID=0,this._currentLocalID=0,this._worldID=0,this._parentID=0}onChange(){this._localID++}updateSkew(){this._cx=Math.cos(this._rotation+this.skew.y),this._sx=Math.sin(this._rotation+this.skew.y),this._cy=-Math.sin(this._rotation-this.skew.x),this._sy=Math.cos(this._rotation-this.skew.x),this._localID++}updateLocalTransform(){const t=this.localTransform;this._localID!==this._currentLocalID&&(t.a=this._cx*this.scale.x,t.b=this._sx*this.scale.x,t.c=this._cy*this.scale.y,t.d=this._sy*this.scale.y,t.tx=this.position.x-(this.pivot.x*t.a+this.pivot.y*t.c),t.ty=this.position.y-(this.pivot.x*t.b+this.pivot.y*t.d),this._currentLocalID=this._localID,this._parentID=-1)}updateTransform(t){const e=this.localTransform;if(this._localID!==this._currentLocalID&&(e.a=this._cx*this.scale.x,e.b=this._sx*this.scale.x,e.c=this._cy*this.scale.y,e.d=this._sy*this.scale.y,e.tx=this.position.x-(this.pivot.x*e.a+this.pivot.y*e.c),e.ty=this.position.y-(this.pivot.x*e.b+this.pivot.y*e.d),this._currentLocalID=this._localID,this._parentID=-1),this._parentID!==t._worldID){const n=t.worldTransform,r=this.worldTransform;r.a=e.a*n.a+e.b*n.c,r.b=e.a*n.b+e.b*n.d,r.c=e.c*n.a+e.d*n.c,r.d=e.c*n.b+e.d*n.d,r.tx=e.tx*n.a+e.ty*n.c+n.tx,r.ty=e.tx*n.b+e.ty*n.d+n.ty,this._parentID=t._worldID,this._worldID++}}setFromMatrix(t){t.decompose(this),this._localID++}get rotation(){return this._rotation}set rotation(t){this._rotation!==t&&(this._rotation=t,this.updateSkew())}};$w.IDENTITY=new $w;let JT=$w;JT.prototype.toString=function(){return`[@pixi/math:Transform position=(${this.position.x}, ${this.position.y}) rotation=${this.rotation} scale=(${this.scale.x}, ${this.scale.y}) skew=(${this.skew.x}, ${this.skew.y}) ]`};var IY=`varying vec2 vTextureCoord;

uniform sampler2D uSampler;

void main(void){
   gl_FragColor *= texture2D(uSampler, vTextureCoord);
}`,AY=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void){
   gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
   vTextureCoord = aTextureCoord;
}
`;function O5(t,e,n){const r=t.createShader(e);return t.shaderSource(r,n),t.compileShader(r),r}function Hb(t){const e=new Array(t);for(let n=0;n<e.length;n++)e[n]=!1;return e}function KR(t,e){switch(t){case"float":return 0;case"vec2":return new Float32Array(2*e);case"vec3":return new Float32Array(3*e);case"vec4":return new Float32Array(4*e);case"int":case"uint":case"sampler2D":case"sampler2DArray":return 0;case"ivec2":return new Int32Array(2*e);case"ivec3":return new Int32Array(3*e);case"ivec4":return new Int32Array(4*e);case"uvec2":return new Uint32Array(2*e);case"uvec3":return new Uint32Array(3*e);case"uvec4":return new Uint32Array(4*e);case"bool":return!1;case"bvec2":return Hb(2*e);case"bvec3":return Hb(3*e);case"bvec4":return Hb(4*e);case"mat2":return new Float32Array([1,0,0,1]);case"mat3":return new Float32Array([1,0,0,0,1,0,0,0,1]);case"mat4":return new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}return null}const Td=[{test:t=>t.type==="float"&&t.size===1&&!t.isArray,code:t=>`
            if(uv["${t}"] !== ud["${t}"].value)
            {
                ud["${t}"].value = uv["${t}"]
                gl.uniform1f(ud["${t}"].location, uv["${t}"])
            }
            `},{test:(t,e)=>(t.type==="sampler2D"||t.type==="samplerCube"||t.type==="sampler2DArray")&&t.size===1&&!t.isArray&&(e==null||e.castToBaseTexture!==void 0),code:t=>`t = syncData.textureCount++;

            renderer.texture.bind(uv["${t}"], t);

            if(ud["${t}"].value !== t)
            {
                ud["${t}"].value = t;
                gl.uniform1i(ud["${t}"].location, t);
; // eslint-disable-line max-len
            }`},{test:(t,e)=>t.type==="mat3"&&t.size===1&&!t.isArray&&e.a!==void 0,code:t=>`
            gl.uniformMatrix3fv(ud["${t}"].location, false, uv["${t}"].toArray(true));
            `,codeUbo:t=>`
                var ${t}_matrix = uv.${t}.toArray(true);

                data[offset] = ${t}_matrix[0];
                data[offset+1] = ${t}_matrix[1];
                data[offset+2] = ${t}_matrix[2];
        
                data[offset + 4] = ${t}_matrix[3];
                data[offset + 5] = ${t}_matrix[4];
                data[offset + 6] = ${t}_matrix[5];
        
                data[offset + 8] = ${t}_matrix[6];
                data[offset + 9] = ${t}_matrix[7];
                data[offset + 10] = ${t}_matrix[8];
            `},{test:(t,e)=>t.type==="vec2"&&t.size===1&&!t.isArray&&e.x!==void 0,code:t=>`
                cv = ud["${t}"].value;
                v = uv["${t}"];

                if(cv[0] !== v.x || cv[1] !== v.y)
                {
                    cv[0] = v.x;
                    cv[1] = v.y;
                    gl.uniform2f(ud["${t}"].location, v.x, v.y);
                }`,codeUbo:t=>`
                v = uv.${t};

                data[offset] = v.x;
                data[offset+1] = v.y;
            `},{test:t=>t.type==="vec2"&&t.size===1&&!t.isArray,code:t=>`
                cv = ud["${t}"].value;
                v = uv["${t}"];

                if(cv[0] !== v[0] || cv[1] !== v[1])
                {
                    cv[0] = v[0];
                    cv[1] = v[1];
                    gl.uniform2f(ud["${t}"].location, v[0], v[1]);
                }
            `},{test:(t,e)=>t.type==="vec4"&&t.size===1&&!t.isArray&&e.width!==void 0,code:t=>`
                cv = ud["${t}"].value;
                v = uv["${t}"];

                if(cv[0] !== v.x || cv[1] !== v.y || cv[2] !== v.width || cv[3] !== v.height)
                {
                    cv[0] = v.x;
                    cv[1] = v.y;
                    cv[2] = v.width;
                    cv[3] = v.height;
                    gl.uniform4f(ud["${t}"].location, v.x, v.y, v.width, v.height)
                }`,codeUbo:t=>`
                    v = uv.${t};

                    data[offset] = v.x;
                    data[offset+1] = v.y;
                    data[offset+2] = v.width;
                    data[offset+3] = v.height;
                `},{test:(t,e)=>t.type==="vec4"&&t.size===1&&!t.isArray&&e.red!==void 0,code:t=>`
                cv = ud["${t}"].value;
                v = uv["${t}"];

                if(cv[0] !== v.red || cv[1] !== v.green || cv[2] !== v.blue || cv[3] !== v.alpha)
                {
                    cv[0] = v.red;
                    cv[1] = v.green;
                    cv[2] = v.blue;
                    cv[3] = v.alpha;
                    gl.uniform4f(ud["${t}"].location, v.red, v.green, v.blue, v.alpha)
                }`,codeUbo:t=>`
                    v = uv.${t};

                    data[offset] = v.red;
                    data[offset+1] = v.green;
                    data[offset+2] = v.blue;
                    data[offset+3] = v.alpha;
                `},{test:(t,e)=>t.type==="vec3"&&t.size===1&&!t.isArray&&e.red!==void 0,code:t=>`
                cv = ud["${t}"].value;
                v = uv["${t}"];

                if(cv[0] !== v.red || cv[1] !== v.green || cv[2] !== v.blue || cv[3] !== v.a)
                {
                    cv[0] = v.red;
                    cv[1] = v.green;
                    cv[2] = v.blue;
    
                    gl.uniform3f(ud["${t}"].location, v.red, v.green, v.blue)
                }`,codeUbo:t=>`
                    v = uv.${t};

                    data[offset] = v.red;
                    data[offset+1] = v.green;
                    data[offset+2] = v.blue;
                `},{test:t=>t.type==="vec4"&&t.size===1&&!t.isArray,code:t=>`
                cv = ud["${t}"].value;
                v = uv["${t}"];

                if(cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
                {
                    cv[0] = v[0];
                    cv[1] = v[1];
                    cv[2] = v[2];
                    cv[3] = v[3];

                    gl.uniform4f(ud["${t}"].location, v[0], v[1], v[2], v[3])
                }`}],kY={float:`
    if (cv !== v)
    {
        cu.value = v;
        gl.uniform1f(location, v);
    }`,vec2:`
    if (cv[0] !== v[0] || cv[1] !== v[1])
    {
        cv[0] = v[0];
        cv[1] = v[1];

        gl.uniform2f(location, v[0], v[1])
    }`,vec3:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];

        gl.uniform3f(location, v[0], v[1], v[2])
    }`,vec4:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];
        cv[3] = v[3];

        gl.uniform4f(location, v[0], v[1], v[2], v[3]);
    }`,int:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1i(location, v);
    }`,ivec2:`
    if (cv[0] !== v[0] || cv[1] !== v[1])
    {
        cv[0] = v[0];
        cv[1] = v[1];

        gl.uniform2i(location, v[0], v[1]);
    }`,ivec3:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];

        gl.uniform3i(location, v[0], v[1], v[2]);
    }`,ivec4:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];
        cv[3] = v[3];

        gl.uniform4i(location, v[0], v[1], v[2], v[3]);
    }`,uint:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1ui(location, v);
    }`,uvec2:`
    if (cv[0] !== v[0] || cv[1] !== v[1])
    {
        cv[0] = v[0];
        cv[1] = v[1];

        gl.uniform2ui(location, v[0], v[1]);
    }`,uvec3:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];

        gl.uniform3ui(location, v[0], v[1], v[2]);
    }`,uvec4:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];
        cv[3] = v[3];

        gl.uniform4ui(location, v[0], v[1], v[2], v[3]);
    }`,bool:`
    if (cv !== v)
    {
        cu.value = v;
        gl.uniform1i(location, v);
    }`,bvec2:`
    if (cv[0] != v[0] || cv[1] != v[1])
    {
        cv[0] = v[0];
        cv[1] = v[1];

        gl.uniform2i(location, v[0], v[1]);
    }`,bvec3:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];

        gl.uniform3i(location, v[0], v[1], v[2]);
    }`,bvec4:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];
        cv[3] = v[3];

        gl.uniform4i(location, v[0], v[1], v[2], v[3]);
    }`,mat2:"gl.uniformMatrix2fv(location, false, v)",mat3:"gl.uniformMatrix3fv(location, false, v)",mat4:"gl.uniformMatrix4fv(location, false, v)",sampler2D:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1i(location, v);
    }`,samplerCube:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1i(location, v);
    }`,sampler2DArray:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1i(location, v);
    }`},MY={float:"gl.uniform1fv(location, v)",vec2:"gl.uniform2fv(location, v)",vec3:"gl.uniform3fv(location, v)",vec4:"gl.uniform4fv(location, v)",mat4:"gl.uniformMatrix4fv(location, false, v)",mat3:"gl.uniformMatrix3fv(location, false, v)",mat2:"gl.uniformMatrix2fv(location, false, v)",int:"gl.uniform1iv(location, v)",ivec2:"gl.uniform2iv(location, v)",ivec3:"gl.uniform3iv(location, v)",ivec4:"gl.uniform4iv(location, v)",uint:"gl.uniform1uiv(location, v)",uvec2:"gl.uniform2uiv(location, v)",uvec3:"gl.uniform3uiv(location, v)",uvec4:"gl.uniform4uiv(location, v)",bool:"gl.uniform1iv(location, v)",bvec2:"gl.uniform2iv(location, v)",bvec3:"gl.uniform3iv(location, v)",bvec4:"gl.uniform4iv(location, v)",sampler2D:"gl.uniform1iv(location, v)",samplerCube:"gl.uniform1iv(location, v)",sampler2DArray:"gl.uniform1iv(location, v)"};function PY(t,e){var r;const n=[`
        var v = null;
        var cv = null;
        var cu = null;
        var t = 0;
        var gl = renderer.gl;
    `];for(const i in t.uniforms){const s=e[i];if(!s){((r=t.uniforms[i])==null?void 0:r.group)===!0&&(t.uniforms[i].ubo?n.push(`
                        renderer.shader.syncUniformBufferGroup(uv.${i}, '${i}');
                    `):n.push(`
                        renderer.shader.syncUniformGroup(uv.${i}, syncData);
                    `));continue}const o=t.uniforms[i];let a=!1;for(let l=0;l<Td.length;l++)if(Td[l].test(s,o)){n.push(Td[l].code(i,o)),a=!0;break}if(!a){const l=(s.size===1&&!s.isArray?kY:MY)[s.type].replace("location",`ud["${i}"].location`);n.push(`
            cu = ud["${i}"];
            cv = cu.value;
            v = uv["${i}"];
            ${l};`)}}return new Function("ud","uv","renderer","syncData",n.join(`
`))}const qR={};let _u=qR;function LY(){if(_u===qR||_u!=null&&_u.isContextLost()){const t=_e.ADAPTER.createCanvas();let e;_e.PREFER_ENV>=cu.WEBGL2&&(e=t.getContext("webgl2",{})),e||(e=t.getContext("webgl",{})||t.getContext("experimental-webgl",{}),e?e.getExtension("WEBGL_draw_buffers"):e=null),_u=e}return _u}let D1;function RY(){if(!D1){D1=Ti.MEDIUM;const t=LY();if(t&&t.getShaderPrecisionFormat){const e=t.getShaderPrecisionFormat(t.FRAGMENT_SHADER,t.HIGH_FLOAT);e&&(D1=e.precision?Ti.HIGH:Ti.MEDIUM)}}return D1}function D5(t,e){const n=t.getShaderSource(e).split(`
`).map((c,u)=>`${u}: ${c}`),r=t.getShaderInfoLog(e),i=r.split(`
`),s={},o=i.map(c=>parseFloat(c.replace(/^ERROR\: 0\:([\d]+)\:.*$/,"$1"))).filter(c=>c&&!s[c]?(s[c]=!0,!0):!1),a=[""];o.forEach(c=>{n[c-1]=`%c${n[c-1]}%c`,a.push("background: #FF0000; color:#FFFFFF; font-size: 10px","font-size: 10px")});const l=n.join(`
`);a[0]=l,console.error(r),console.groupCollapsed("click to view full shader code"),console.warn(...a),console.groupEnd()}function OY(t,e,n,r){t.getProgramParameter(e,t.LINK_STATUS)||(t.getShaderParameter(n,t.COMPILE_STATUS)||D5(t,n),t.getShaderParameter(r,t.COMPILE_STATUS)||D5(t,r),console.error("PixiJS Error: Could not initialize shader."),t.getProgramInfoLog(e)!==""&&console.warn("PixiJS Warning: gl.getProgramInfoLog()",t.getProgramInfoLog(e)))}const DY={float:1,vec2:2,vec3:3,vec4:4,int:1,ivec2:2,ivec3:3,ivec4:4,uint:1,uvec2:2,uvec3:3,uvec4:4,bool:1,bvec2:2,bvec3:3,bvec4:4,mat2:4,mat3:9,mat4:16,sampler2D:1};function JR(t){return DY[t]}let N1=null;const N5={FLOAT:"float",FLOAT_VEC2:"vec2",FLOAT_VEC3:"vec3",FLOAT_VEC4:"vec4",INT:"int",INT_VEC2:"ivec2",INT_VEC3:"ivec3",INT_VEC4:"ivec4",UNSIGNED_INT:"uint",UNSIGNED_INT_VEC2:"uvec2",UNSIGNED_INT_VEC3:"uvec3",UNSIGNED_INT_VEC4:"uvec4",BOOL:"bool",BOOL_VEC2:"bvec2",BOOL_VEC3:"bvec3",BOOL_VEC4:"bvec4",FLOAT_MAT2:"mat2",FLOAT_MAT3:"mat3",FLOAT_MAT4:"mat4",SAMPLER_2D:"sampler2D",INT_SAMPLER_2D:"sampler2D",UNSIGNED_INT_SAMPLER_2D:"sampler2D",SAMPLER_CUBE:"samplerCube",INT_SAMPLER_CUBE:"samplerCube",UNSIGNED_INT_SAMPLER_CUBE:"samplerCube",SAMPLER_2D_ARRAY:"sampler2DArray",INT_SAMPLER_2D_ARRAY:"sampler2DArray",UNSIGNED_INT_SAMPLER_2D_ARRAY:"sampler2DArray"};function QR(t,e){if(!N1){const n=Object.keys(N5);N1={};for(let r=0;r<n.length;++r){const i=n[r];N1[t[i]]=N5[i]}}return N1[e]}function F5(t,e,n){if(t.substring(0,9)!=="precision"){let r=e;return e===Ti.HIGH&&n!==Ti.HIGH&&(r=Ti.MEDIUM),`precision ${r} float;
${t}`}else if(n!==Ti.HIGH&&t.substring(0,15)==="precision highp")return t.replace("precision highp","precision mediump");return t}let zh;function NY(){if(typeof zh=="boolean")return zh;try{zh=new Function("param1","param2","param3","return param1[param2] === param3;")({a:"b"},"a","b")===!0}catch{zh=!1}return zh}let FY=0;const F1={},Hw=class Nu{constructor(e,n,r="pixi-shader",i={}){this.extra={},this.id=FY++,this.vertexSrc=e||Nu.defaultVertexSrc,this.fragmentSrc=n||Nu.defaultFragmentSrc,this.vertexSrc=this.vertexSrc.trim(),this.fragmentSrc=this.fragmentSrc.trim(),this.extra=i,this.vertexSrc.substring(0,8)!=="#version"&&(r=r.replace(/\s+/g,"-"),F1[r]?(F1[r]++,r+=`-${F1[r]}`):F1[r]=1,this.vertexSrc=`#define SHADER_NAME ${r}
${this.vertexSrc}`,this.fragmentSrc=`#define SHADER_NAME ${r}
${this.fragmentSrc}`,this.vertexSrc=F5(this.vertexSrc,Nu.defaultVertexPrecision,Ti.HIGH),this.fragmentSrc=F5(this.fragmentSrc,Nu.defaultFragmentPrecision,RY())),this.glPrograms={},this.syncUniforms=null}static get defaultVertexSrc(){return AY}static get defaultFragmentSrc(){return IY}static from(e,n,r){const i=e+n;let s=k5[i];return s||(k5[i]=s=new Nu(e,n,r)),s}};Hw.defaultVertexPrecision=Ti.HIGH,Hw.defaultFragmentPrecision=Fo.apple.device?Ti.HIGH:Ti.MEDIUM;let no=Hw,BY=0;class ps{constructor(e,n,r){this.group=!0,this.syncUniforms={},this.dirtyId=0,this.id=BY++,this.static=!!n,this.ubo=!!r,e instanceof hn?(this.buffer=e,this.buffer.type=so.UNIFORM_BUFFER,this.autoManage=!1,this.ubo=!0):(this.uniforms=e,this.ubo&&(this.buffer=new hn(new Float32Array(1)),this.buffer.type=so.UNIFORM_BUFFER,this.autoManage=!0))}update(){this.dirtyId++,!this.autoManage&&this.buffer&&this.buffer.update()}add(e,n,r){if(!this.ubo)this.uniforms[e]=new ps(n,r);else throw new Error("[UniformGroup] uniform groups in ubo mode cannot be modified, or have uniform groups nested in them")}static from(e,n,r){return new ps(e,n,r)}static uboFrom(e,n){return new ps(e,n??!0,!0)}}class ms{constructor(e,n){this.uniformBindCount=0,this.program=e,n?n instanceof ps?this.uniformGroup=n:this.uniformGroup=new ps(n):this.uniformGroup=new ps({}),this.disposeRunner=new fs("disposeShader")}checkUniformExists(e,n){if(n.uniforms[e])return!0;for(const r in n.uniforms){const i=n.uniforms[r];if(i.group===!0&&this.checkUniformExists(e,i))return!0}return!1}destroy(){this.uniformGroup=null,this.disposeRunner.emit(this),this.disposeRunner.destroy()}get uniforms(){return this.uniformGroup.uniforms}static from(e,n,r){const i=no.from(e,n);return new ms(i,r)}}class UY{constructor(e,n){if(this.vertexSrc=e,this.fragTemplate=n,this.programCache={},this.defaultGroupCache={},!n.includes("%count%"))throw new Error('Fragment template must contain "%count%".');if(!n.includes("%forloop%"))throw new Error('Fragment template must contain "%forloop%".')}generateShader(e){if(!this.programCache[e]){const r=new Int32Array(e);for(let s=0;s<e;s++)r[s]=s;this.defaultGroupCache[e]=ps.from({uSamplers:r},!0);let i=this.fragTemplate;i=i.replace(/%count%/gi,`${e}`),i=i.replace(/%forloop%/gi,this.generateSampleSrc(e)),this.programCache[e]=new no(this.vertexSrc,i)}const n={tint:new Float32Array([1,1,1,1]),translationMatrix:new Ze,default:this.defaultGroupCache[e]};return new ms(this.programCache[e],n)}generateSampleSrc(e){let n="";n+=`
`,n+=`
`;for(let r=0;r<e;r++)r>0&&(n+=`
else `),r<e-1&&(n+=`if(vTextureId < ${r}.5)`),n+=`
{`,n+=`
	color = texture2D(uSamplers[${r}], vTextureCoord);`,n+=`
}`;return n+=`
`,n+=`
`,n}}class ny{constructor(){this.elements=[],this.ids=[],this.count=0}clear(){for(let e=0;e<this.count;e++)this.elements[e]=null;this.count=0}}function $Y(){return!Fo.apple.device}function HY(t){let e=!0;const n=_e.ADAPTER.getNavigator();if(Fo.tablet||Fo.phone){if(Fo.apple.device){const r=n.userAgent.match(/OS (\d+)_(\d+)?/);r&&parseInt(r[1],10)<11&&(e=!1)}if(Fo.android.device){const r=n.userAgent.match(/Android\s([0-9.]*)/);r&&parseInt(r[1],10)<7&&(e=!1)}}return e?t:4}class Nv{constructor(e){this.renderer=e}flush(){}destroy(){this.renderer=null}start(){}stop(){this.flush()}render(e){}}var zY=`varying vec2 vTextureCoord;
varying vec4 vColor;
varying float vTextureId;
uniform sampler2D uSamplers[%count%];

void main(void){
    vec4 color;
    %forloop%
    gl_FragColor = color * vColor;
}
`,GY=`precision highp float;
attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;
attribute vec4 aColor;
attribute float aTextureId;

uniform mat3 projectionMatrix;
uniform mat3 translationMatrix;
uniform vec4 tint;

varying vec2 vTextureCoord;
varying vec4 vColor;
varying float vTextureId;

void main(void){
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = aTextureCoord;
    vTextureId = aTextureId;
    vColor = aColor * tint;
}
`;const bf=class Xi extends Nv{constructor(e){super(e),this.setShaderGenerator(),this.geometryClass=YR,this.vertexSize=6,this.state=Ts.for2d(),this.size=Xi.defaultBatchSize*4,this._vertexCount=0,this._indexCount=0,this._bufferedElements=[],this._bufferedTextures=[],this._bufferSize=0,this._shader=null,this._packedGeometries=[],this._packedGeometryPoolSize=2,this._flushId=0,this._aBuffers={},this._iBuffers={},this.maxTextures=1,this.renderer.on("prerender",this.onPrerender,this),e.runners.contextChange.add(this),this._dcIndex=0,this._aIndex=0,this._iIndex=0,this._attributeBuffer=null,this._indexBuffer=null,this._tempBoundTextures=[]}static get defaultMaxTextures(){return this._defaultMaxTextures=this._defaultMaxTextures??HY(32),this._defaultMaxTextures}static set defaultMaxTextures(e){this._defaultMaxTextures=e}static get canUploadSameBuffer(){return this._canUploadSameBuffer=this._canUploadSameBuffer??$Y(),this._canUploadSameBuffer}static set canUploadSameBuffer(e){this._canUploadSameBuffer=e}get MAX_TEXTURES(){return Qe("7.1.0","BatchRenderer#MAX_TEXTURES renamed to BatchRenderer#maxTextures"),this.maxTextures}static get defaultVertexSrc(){return GY}static get defaultFragmentTemplate(){return zY}setShaderGenerator({vertex:e=Xi.defaultVertexSrc,fragment:n=Xi.defaultFragmentTemplate}={}){this.shaderGenerator=new UY(e,n)}contextChange(){const e=this.renderer.gl;_e.PREFER_ENV===cu.WEBGL_LEGACY?this.maxTextures=1:(this.maxTextures=Math.min(e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS),Xi.defaultMaxTextures),this.maxTextures=yY(this.maxTextures,e)),this._shader=this.shaderGenerator.generateShader(this.maxTextures);for(let n=0;n<this._packedGeometryPoolSize;n++)this._packedGeometries[n]=new this.geometryClass;this.initFlushBuffers()}initFlushBuffers(){const{_drawCallPool:e,_textureArrayPool:n}=Xi,r=this.size/4,i=Math.floor(r/this.maxTextures)+1;for(;e.length<r;)e.push(new Bw);for(;n.length<i;)n.push(new ny);for(let s=0;s<this.maxTextures;s++)this._tempBoundTextures[s]=null}onPrerender(){this._flushId=0}render(e){e._texture.valid&&(this._vertexCount+e.vertexData.length/2>this.size&&this.flush(),this._vertexCount+=e.vertexData.length/2,this._indexCount+=e.indices.length,this._bufferedTextures[this._bufferSize]=e._texture.baseTexture,this._bufferedElements[this._bufferSize++]=e)}buildTexturesAndDrawCalls(){const{_bufferedTextures:e,maxTextures:n}=this,r=Xi._textureArrayPool,i=this.renderer.batch,s=this._tempBoundTextures,o=this.renderer.textureGC.count;let a=++ze._globalBatch,l=0,c=r[0],u=0;i.copyBoundTextures(s,n);for(let d=0;d<this._bufferSize;++d){const h=e[d];e[d]=null,h._batchEnabled!==a&&(c.count>=n&&(i.boundArray(c,s,a,n),this.buildDrawCalls(c,u,d),u=d,c=r[++l],++a),h._batchEnabled=a,h.touched=o,c.elements[c.count++]=h)}c.count>0&&(i.boundArray(c,s,a,n),this.buildDrawCalls(c,u,this._bufferSize),++l,++a);for(let d=0;d<s.length;d++)s[d]=null;ze._globalBatch=a}buildDrawCalls(e,n,r){const{_bufferedElements:i,_attributeBuffer:s,_indexBuffer:o,vertexSize:a}=this,l=Xi._drawCallPool;let c=this._dcIndex,u=this._aIndex,d=this._iIndex,h=l[c];h.start=this._iIndex,h.texArray=e;for(let f=n;f<r;++f){const p=i[f],m=p._texture.baseTexture,v=GR[m.alphaMode?1:0][p.blendMode];i[f]=null,n<f&&h.blend!==v&&(h.size=d-h.start,n=f,h=l[++c],h.texArray=e,h.start=d),this.packInterleavedGeometry(p,s,o,u,d),u+=p.vertexData.length/2*a,d+=p.indices.length,h.blend=v}n<r&&(h.size=d-h.start,++c),this._dcIndex=c,this._aIndex=u,this._iIndex=d}bindAndClearTexArray(e){const n=this.renderer.texture;for(let r=0;r<e.count;r++)n.bind(e.elements[r],e.ids[r]),e.elements[r]=null;e.count=0}updateGeometry(){const{_packedGeometries:e,_attributeBuffer:n,_indexBuffer:r}=this;Xi.canUploadSameBuffer?(e[this._flushId]._buffer.update(n.rawBinaryData),e[this._flushId]._indexBuffer.update(r),this.renderer.geometry.updateBuffers()):(this._packedGeometryPoolSize<=this._flushId&&(this._packedGeometryPoolSize++,e[this._flushId]=new this.geometryClass),e[this._flushId]._buffer.update(n.rawBinaryData),e[this._flushId]._indexBuffer.update(r),this.renderer.geometry.bind(e[this._flushId]),this.renderer.geometry.updateBuffers(),this._flushId++)}drawBatches(){const e=this._dcIndex,{gl:n,state:r}=this.renderer,i=Xi._drawCallPool;let s=null;for(let o=0;o<e;o++){const{texArray:a,type:l,size:c,start:u,blend:d}=i[o];s!==a&&(s=a,this.bindAndClearTexArray(a)),this.state.blendMode=d,r.set(this.state),n.drawElements(l,c,n.UNSIGNED_SHORT,u*2)}}flush(){this._vertexCount!==0&&(this._attributeBuffer=this.getAttributeBuffer(this._vertexCount),this._indexBuffer=this.getIndexBuffer(this._indexCount),this._aIndex=0,this._iIndex=0,this._dcIndex=0,this.buildTexturesAndDrawCalls(),this.updateGeometry(),this.drawBatches(),this._bufferSize=0,this._vertexCount=0,this._indexCount=0)}start(){this.renderer.state.set(this.state),this.renderer.texture.ensureSamplerType(this.maxTextures),this.renderer.shader.bind(this._shader),Xi.canUploadSameBuffer&&this.renderer.geometry.bind(this._packedGeometries[this._flushId])}stop(){this.flush()}destroy(){for(let e=0;e<this._packedGeometryPoolSize;e++)this._packedGeometries[e]&&this._packedGeometries[e].destroy();this.renderer.off("prerender",this.onPrerender,this),this._aBuffers=null,this._iBuffers=null,this._packedGeometries=null,this._attributeBuffer=null,this._indexBuffer=null,this._shader&&(this._shader.destroy(),this._shader=null),super.destroy()}getAttributeBuffer(e){const n=ey(Math.ceil(e/8)),r=I5(n),i=n*8;this._aBuffers.length<=r&&(this._iBuffers.length=r+1);let s=this._aBuffers[i];return s||(this._aBuffers[i]=s=new Dw(i*this.vertexSize*4)),s}getIndexBuffer(e){const n=ey(Math.ceil(e/12)),r=I5(n),i=n*12;this._iBuffers.length<=r&&(this._iBuffers.length=r+1);let s=this._iBuffers[r];return s||(this._iBuffers[r]=s=new Uint16Array(i)),s}packInterleavedGeometry(e,n,r,i,s){const{uint32View:o,float32View:a}=n,l=i/this.vertexSize,c=e.uvs,u=e.indices,d=e.vertexData,h=e._texture.baseTexture._batchLocation,f=Math.min(e.worldAlpha,1),p=pt.shared.setValue(e._tintRGB).toPremultiplied(f,e._texture.baseTexture.alphaMode>0);for(let m=0;m<d.length;m+=2)a[i++]=d[m],a[i++]=d[m+1],a[i++]=c[m],a[i++]=c[m+1],o[i++]=p,a[i++]=h;for(let m=0;m<u.length;m++)r[s++]=l+u[m]}};bf.defaultBatchSize=4096,bf.extension={name:"batch",type:me.RendererPlugin},bf._drawCallPool=[],bf._textureArrayPool=[];let Zl=bf;Ce.add(Zl);var VY=`varying vec2 vTextureCoord;

uniform sampler2D uSampler;

void main(void){
   gl_FragColor = texture2D(uSampler, vTextureCoord);
}
`,WY=`attribute vec2 aVertexPosition;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

uniform vec4 inputSize;
uniform vec4 outputFrame;

vec4 filterVertexPosition( void )
{
    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
}

vec2 filterTextureCoord( void )
{
    return aVertexPosition * (outputFrame.zw * inputSize.zw);
}

void main(void)
{
    gl_Position = filterVertexPosition();
    vTextureCoord = filterTextureCoord();
}
`;const zw=class _f extends ms{constructor(e,n,r){const i=no.from(e||_f.defaultVertexSrc,n||_f.defaultFragmentSrc);super(i,r),this.padding=0,this.resolution=_f.defaultResolution,this.multisample=_f.defaultMultisample,this.enabled=!0,this.autoFit=!0,this.state=new Ts}apply(e,n,r,i,s){e.applyFilter(this,n,r,i)}get blendMode(){return this.state.blendMode}set blendMode(e){this.state.blendMode=e}get resolution(){return this._resolution}set resolution(e){this._resolution=e}static get defaultVertexSrc(){return WY}static get defaultFragmentSrc(){return VY}};zw.defaultResolution=1,zw.defaultMultisample=dn.NONE;let Lr=zw;class ry{constructor(){this.clearBeforeRender=!0,this._backgroundColor=new pt(0),this.alpha=1}init(e){this.clearBeforeRender=e.clearBeforeRender;const{backgroundColor:n,background:r,backgroundAlpha:i}=e,s=r??n;s!==void 0&&(this.color=s),this.alpha=i}get color(){return this._backgroundColor.value}set color(e){this._backgroundColor.setValue(e)}get alpha(){return this._backgroundColor.alpha}set alpha(e){this._backgroundColor.setAlpha(e)}get backgroundColor(){return this._backgroundColor}destroy(){}}ry.defaultOptions={backgroundAlpha:1,backgroundColor:0,clearBeforeRender:!0},ry.extension={type:[me.RendererSystem,me.CanvasRendererSystem],name:"background"};Ce.add(ry);class e9{constructor(e){this.renderer=e,this.emptyRenderer=new Nv(e),this.currentRenderer=this.emptyRenderer}setObjectRenderer(e){this.currentRenderer!==e&&(this.currentRenderer.stop(),this.currentRenderer=e,this.currentRenderer.start())}flush(){this.setObjectRenderer(this.emptyRenderer)}reset(){this.setObjectRenderer(this.emptyRenderer)}copyBoundTextures(e,n){const{boundTextures:r}=this.renderer.texture;for(let i=n-1;i>=0;--i)e[i]=r[i]||null,e[i]&&(e[i]._batchLocation=i)}boundArray(e,n,r,i){const{elements:s,ids:o,count:a}=e;let l=0;for(let c=0;c<a;c++){const u=s[c],d=u._batchLocation;if(d>=0&&d<i&&n[d]===u){o[c]=d;continue}for(;l<i;){const h=n[l];if(h&&h._batchEnabled===r&&h._batchLocation===l){l++;continue}o[c]=l,u._batchLocation=l,n[l]=u;break}}}destroy(){this.renderer=null}}e9.extension={type:me.RendererSystem,name:"batch"};Ce.add(e9);let B5=0;class iy{constructor(e){this.renderer=e,this.webGLVersion=1,this.extensions={},this.supports={uint32Indices:!1},this.handleContextLost=this.handleContextLost.bind(this),this.handleContextRestored=this.handleContextRestored.bind(this)}get isLost(){return!this.gl||this.gl.isContextLost()}contextChange(e){this.gl=e,this.renderer.gl=e,this.renderer.CONTEXT_UID=B5++}init(e){if(e.context)this.initFromContext(e.context);else{const n=this.renderer.background.alpha<1,r=e.premultipliedAlpha;this.preserveDrawingBuffer=e.preserveDrawingBuffer,this.useContextAlpha=e.useContextAlpha,this.powerPreference=e.powerPreference,this.initFromOptions({alpha:n,premultipliedAlpha:r,antialias:e.antialias,stencil:!0,preserveDrawingBuffer:e.preserveDrawingBuffer,powerPreference:e.powerPreference})}}initFromContext(e){this.gl=e,this.validateContext(e),this.renderer.gl=e,this.renderer.CONTEXT_UID=B5++,this.renderer.runners.contextChange.emit(e);const n=this.renderer.view;n.addEventListener!==void 0&&(n.addEventListener("webglcontextlost",this.handleContextLost,!1),n.addEventListener("webglcontextrestored",this.handleContextRestored,!1))}initFromOptions(e){const n=this.createContext(this.renderer.view,e);this.initFromContext(n)}createContext(e,n){let r;if(_e.PREFER_ENV>=cu.WEBGL2&&(r=e.getContext("webgl2",n)),r)this.webGLVersion=2;else if(this.webGLVersion=1,r=e.getContext("webgl",n)||e.getContext("experimental-webgl",n),!r)throw new Error("This browser does not support WebGL. Try using the canvas renderer");return this.gl=r,this.getExtensions(),this.gl}getExtensions(){const{gl:e}=this,n={loseContext:e.getExtension("WEBGL_lose_context"),anisotropicFiltering:e.getExtension("EXT_texture_filter_anisotropic"),floatTextureLinear:e.getExtension("OES_texture_float_linear"),s3tc:e.getExtension("WEBGL_compressed_texture_s3tc"),s3tc_sRGB:e.getExtension("WEBGL_compressed_texture_s3tc_srgb"),etc:e.getExtension("WEBGL_compressed_texture_etc"),etc1:e.getExtension("WEBGL_compressed_texture_etc1"),pvrtc:e.getExtension("WEBGL_compressed_texture_pvrtc")||e.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc"),atc:e.getExtension("WEBGL_compressed_texture_atc"),astc:e.getExtension("WEBGL_compressed_texture_astc")};this.webGLVersion===1?Object.assign(this.extensions,n,{drawBuffers:e.getExtension("WEBGL_draw_buffers"),depthTexture:e.getExtension("WEBGL_depth_texture"),vertexArrayObject:e.getExtension("OES_vertex_array_object")||e.getExtension("MOZ_OES_vertex_array_object")||e.getExtension("WEBKIT_OES_vertex_array_object"),uint32ElementIndex:e.getExtension("OES_element_index_uint"),floatTexture:e.getExtension("OES_texture_float"),floatTextureLinear:e.getExtension("OES_texture_float_linear"),textureHalfFloat:e.getExtension("OES_texture_half_float"),textureHalfFloatLinear:e.getExtension("OES_texture_half_float_linear")}):this.webGLVersion===2&&Object.assign(this.extensions,n,{colorBufferFloat:e.getExtension("EXT_color_buffer_float")})}handleContextLost(e){e.preventDefault(),setTimeout(()=>{this.gl.isContextLost()&&this.extensions.loseContext&&this.extensions.loseContext.restoreContext()},0)}handleContextRestored(){this.renderer.runners.contextChange.emit(this.gl)}destroy(){const e=this.renderer.view;this.renderer=null,e.removeEventListener!==void 0&&(e.removeEventListener("webglcontextlost",this.handleContextLost),e.removeEventListener("webglcontextrestored",this.handleContextRestored)),this.gl.useProgram(null),this.extensions.loseContext&&this.extensions.loseContext.loseContext()}postrender(){this.renderer.objectRenderer.renderingToScreen&&this.gl.flush()}validateContext(e){const n=e.getContextAttributes(),r="WebGL2RenderingContext"in globalThis&&e instanceof globalThis.WebGL2RenderingContext;r&&(this.webGLVersion=2),n&&!n.stencil&&console.warn("Provided WebGL context does not have a stencil buffer, masks may not render correctly");const i=r||!!e.getExtension("OES_element_index_uint");this.supports.uint32Indices=i,i||console.warn("Provided WebGL context does not support 32 index buffer, complex graphics may not render correctly")}}iy.defaultOptions={context:null,antialias:!1,premultipliedAlpha:!0,preserveDrawingBuffer:!1,powerPreference:"default"},iy.extension={type:me.RendererSystem,name:"context"};Ce.add(iy);class Gw{constructor(e,n){if(this.width=Math.round(e),this.height=Math.round(n),!this.width||!this.height)throw new Error("Framebuffer width or height is zero");this.stencil=!1,this.depth=!1,this.dirtyId=0,this.dirtyFormat=0,this.dirtySize=0,this.depthTexture=null,this.colorTextures=[],this.glFramebuffers={},this.disposeRunner=new fs("disposeFramebuffer"),this.multisample=dn.NONE}get colorTexture(){return this.colorTextures[0]}addColorTexture(e=0,n){return this.colorTextures[e]=n||new ze(null,{scaleMode:No.NEAREST,resolution:1,mipmap:ho.OFF,width:this.width,height:this.height}),this.dirtyId++,this.dirtyFormat++,this}addDepthTexture(e){return this.depthTexture=e||new ze(null,{scaleMode:No.NEAREST,resolution:1,width:this.width,height:this.height,mipmap:ho.OFF,format:le.DEPTH_COMPONENT,type:Te.UNSIGNED_SHORT}),this.dirtyId++,this.dirtyFormat++,this}enableDepth(){return this.depth=!0,this.dirtyId++,this.dirtyFormat++,this}enableStencil(){return this.stencil=!0,this.dirtyId++,this.dirtyFormat++,this}resize(e,n){if(e=Math.round(e),n=Math.round(n),!e||!n)throw new Error("Framebuffer width and height must not be zero");if(!(e===this.width&&n===this.height)){this.width=e,this.height=n,this.dirtyId++,this.dirtySize++;for(let r=0;r<this.colorTextures.length;r++){const i=this.colorTextures[r],s=i.resolution;i.setSize(e/s,n/s)}if(this.depthTexture){const r=this.depthTexture.resolution;this.depthTexture.setSize(e/r,n/r)}}}dispose(){this.disposeRunner.emit(this,!1)}destroyDepthTexture(){this.depthTexture&&(this.depthTexture.destroy(),this.depthTexture=null,++this.dirtyId,++this.dirtyFormat)}}class t9 extends ze{constructor(e={}){if(typeof e=="number"){const n=arguments[0],r=arguments[1],i=arguments[2],s=arguments[3];e={width:n,height:r,scaleMode:i,resolution:s}}e.width=e.width??100,e.height=e.height??100,e.multisample??(e.multisample=dn.NONE),super(null,e),this.mipmap=ho.OFF,this.valid=!0,this._clear=new pt([0,0,0,0]),this.framebuffer=new Gw(this.realWidth,this.realHeight).addColorTexture(0,this),this.framebuffer.multisample=e.multisample,this.maskStack=[],this.filterStack=[{}]}set clearColor(e){this._clear.setValue(e)}get clearColor(){return this._clear.value}get clear(){return this._clear}get multisample(){return this.framebuffer.multisample}set multisample(e){this.framebuffer.multisample=e}resize(e,n){this.framebuffer.resize(e*this.resolution,n*this.resolution),this.setRealSize(this.framebuffer.width,this.framebuffer.height)}dispose(){this.framebuffer.dispose(),super.dispose()}destroy(){super.destroy(),this.framebuffer.destroyDepthTexture(),this.framebuffer=null}}class ml extends Hp{constructor(e){const n=e,r=n.naturalWidth||n.videoWidth||n.width,i=n.naturalHeight||n.videoHeight||n.height;super(r,i),this.source=e,this.noSubImage=!1}static crossOrigin(e,n,r){r===void 0&&!n.startsWith("data:")?e.crossOrigin=pY(n):r!==!1&&(e.crossOrigin=typeof r=="string"?r:"anonymous")}upload(e,n,r,i){const s=e.gl,o=n.realWidth,a=n.realHeight;if(i=i||this.source,typeof HTMLImageElement<"u"&&i instanceof HTMLImageElement){if(!i.complete||i.naturalWidth===0)return!1}else if(typeof HTMLVideoElement<"u"&&i instanceof HTMLVideoElement&&i.readyState<=1)return!1;return s.pixelStorei(s.UNPACK_PREMULTIPLY_ALPHA_WEBGL,n.alphaMode===zr.UNPACK),!this.noSubImage&&n.target===s.TEXTURE_2D&&r.width===o&&r.height===a?s.texSubImage2D(s.TEXTURE_2D,0,0,0,n.format,r.type,i):(r.width=o,r.height=a,s.texImage2D(n.target,0,r.internalFormat,n.format,r.type,i)),!0}update(){if(this.destroyed)return;const e=this.source,n=e.naturalWidth||e.videoWidth||e.width,r=e.naturalHeight||e.videoHeight||e.height;this.resize(n,r),super.update()}dispose(){this.source=null}}class n9 extends ml{constructor(e,n){if(n=n||{},typeof e=="string"){const r=new Image;ml.crossOrigin(r,e,n.crossorigin),r.src=e,e=r}super(e),!e.complete&&this._width&&this._height&&(this._width=0,this._height=0),this.url=e.src,this._process=null,this.preserveBitmap=!1,this.createBitmap=(n.createBitmap??_e.CREATE_IMAGE_BITMAP)&&!!globalThis.createImageBitmap,this.alphaMode=typeof n.alphaMode=="number"?n.alphaMode:null,this.bitmap=null,this._load=null,n.autoLoad!==!1&&this.load()}load(e){return this._load?this._load:(e!==void 0&&(this.createBitmap=e),this._load=new Promise((n,r)=>{const i=this.source;this.url=i.src;const s=()=>{this.destroyed||(i.onload=null,i.onerror=null,this.update(),this._load=null,this.createBitmap?n(this.process()):n(this))};i.complete&&i.src?s():(i.onload=s,i.onerror=o=>{r(o),this.onError.emit(o)})}),this._load)}process(){const e=this.source;if(this._process!==null)return this._process;if(this.bitmap!==null||!globalThis.createImageBitmap)return Promise.resolve(this);const n=globalThis.createImageBitmap,r=!e.crossOrigin||e.crossOrigin==="anonymous";return this._process=fetch(e.src,{mode:r?"cors":"no-cors"}).then(i=>i.blob()).then(i=>n(i,0,0,e.width,e.height,{premultiplyAlpha:this.alphaMode===null||this.alphaMode===zr.UNPACK?"premultiply":"none"})).then(i=>this.destroyed?Promise.reject():(this.bitmap=i,this.update(),this._process=null,Promise.resolve(this))),this._process}upload(e,n,r){if(typeof this.alphaMode=="number"&&(n.alphaMode=this.alphaMode),!this.createBitmap)return super.upload(e,n,r);if(!this.bitmap&&(this.process(),!this.bitmap))return!1;if(super.upload(e,n,r,this.bitmap),!this.preserveBitmap){let i=!0;const s=n._glTextures;for(const o in s){const a=s[o];if(a!==r&&a.dirtyId!==n.dirtyId){i=!1;break}}i&&(this.bitmap.close&&this.bitmap.close(),this.bitmap=null)}return!0}dispose(){this.source.onload=null,this.source.onerror=null,super.dispose(),this.bitmap&&(this.bitmap.close(),this.bitmap=null),this._process=null,this._load=null}static test(e){return typeof HTMLImageElement<"u"&&(typeof e=="string"||e instanceof HTMLImageElement)}}class QT{constructor(){this.x0=0,this.y0=0,this.x1=1,this.y1=0,this.x2=1,this.y2=1,this.x3=0,this.y3=1,this.uvsFloat32=new Float32Array(8)}set(e,n,r){const i=n.width,s=n.height;if(r){const o=e.width/2/i,a=e.height/2/s,l=e.x/i+o,c=e.y/s+a;r=qt.add(r,qt.NW),this.x0=l+o*qt.uX(r),this.y0=c+a*qt.uY(r),r=qt.add(r,2),this.x1=l+o*qt.uX(r),this.y1=c+a*qt.uY(r),r=qt.add(r,2),this.x2=l+o*qt.uX(r),this.y2=c+a*qt.uY(r),r=qt.add(r,2),this.x3=l+o*qt.uX(r),this.y3=c+a*qt.uY(r)}else this.x0=e.x/i,this.y0=e.y/s,this.x1=(e.x+e.width)/i,this.y1=e.y/s,this.x2=(e.x+e.width)/i,this.y2=(e.y+e.height)/s,this.x3=e.x/i,this.y3=(e.y+e.height)/s;this.uvsFloat32[0]=this.x0,this.uvsFloat32[1]=this.y0,this.uvsFloat32[2]=this.x1,this.uvsFloat32[3]=this.y1,this.uvsFloat32[4]=this.x2,this.uvsFloat32[5]=this.y2,this.uvsFloat32[6]=this.x3,this.uvsFloat32[7]=this.y3}}QT.prototype.toString=function(){return`[@pixi/core:TextureUvs x0=${this.x0} y0=${this.y0} x1=${this.x1} y1=${this.y1} x2=${this.x2} y2=${this.y2} x3=${this.x3} y3=${this.y3}]`};const U5=new QT;function B1(t){t.destroy=function(){},t.on=function(){},t.once=function(){},t.emit=function(){}}class he extends Lm{constructor(e,n,r,i,s,o,a){if(super(),this.noFrame=!1,n||(this.noFrame=!0,n=new Me(0,0,1,1)),e instanceof he&&(e=e.baseTexture),this.baseTexture=e,this._frame=n,this.trim=i,this.valid=!1,this.destroyed=!1,this._uvs=U5,this.uvMatrix=null,this.orig=r||n,this._rotate=Number(s||0),s===!0)this._rotate=2;else if(this._rotate%2!==0)throw new Error("attempt to use diamond-shaped UVs. If you are sure, set rotation manually");this.defaultAnchor=o?new Ke(o.x,o.y):new Ke(0,0),this.defaultBorders=a,this._updateID=0,this.textureCacheIds=[],e.valid?this.noFrame?e.valid&&this.onBaseTextureUpdated(e):this.frame=n:e.once("loaded",this.onBaseTextureUpdated,this),this.noFrame&&e.on("update",this.onBaseTextureUpdated,this)}update(){this.baseTexture.resource&&this.baseTexture.resource.update()}onBaseTextureUpdated(e){if(this.noFrame){if(!this.baseTexture.valid)return;this._frame.width=e.width,this._frame.height=e.height,this.valid=!0,this.updateUvs()}else this.frame=this._frame;this.emit("update",this)}destroy(e){if(this.baseTexture){if(e){const{resource:n}=this.baseTexture;n!=null&&n.url&&Bs[n.url]&&he.removeFromCache(n.url),this.baseTexture.destroy()}this.baseTexture.off("loaded",this.onBaseTextureUpdated,this),this.baseTexture.off("update",this.onBaseTextureUpdated,this),this.baseTexture=null}this._frame=null,this._uvs=null,this.trim=null,this.orig=null,this.valid=!1,he.removeFromCache(this),this.textureCacheIds=null,this.destroyed=!0,this.emit("destroyed",this),this.removeAllListeners()}clone(){var i;const e=this._frame.clone(),n=this._frame===this.orig?e:this.orig.clone(),r=new he(this.baseTexture,!this.noFrame&&e,n,(i=this.trim)==null?void 0:i.clone(),this.rotate,this.defaultAnchor,this.defaultBorders);return this.noFrame&&(r._frame=e),r}updateUvs(){this._uvs===U5&&(this._uvs=new QT),this._uvs.set(this._frame,this.baseTexture,this.rotate),this._updateID++}static from(e,n={},r=_e.STRICT_TEXTURE_CACHE){const i=typeof e=="string";let s=null;if(i)s=e;else if(e instanceof ze){if(!e.cacheId){const a=(n==null?void 0:n.pixiIdPrefix)||"pixiid";e.cacheId=`${a}-${Gc()}`,ze.addToCache(e,e.cacheId)}s=e.cacheId}else{if(!e._pixiId){const a=(n==null?void 0:n.pixiIdPrefix)||"pixiid";e._pixiId=`${a}_${Gc()}`}s=e._pixiId}let o=Bs[s];if(i&&r&&!o)throw new Error(`The cacheId "${s}" does not exist in TextureCache.`);return!o&&!(e instanceof ze)?(n.resolution||(n.resolution=Qo(e)),o=new he(new ze(e,n)),o.baseTexture.cacheId=s,ze.addToCache(o.baseTexture,s),he.addToCache(o,s)):!o&&e instanceof ze&&(o=new he(e),he.addToCache(o,s)),o}static fromURL(e,n){const r=Object.assign({autoLoad:!1},n==null?void 0:n.resourceOptions),i=he.from(e,Object.assign({resourceOptions:r},n),!1),s=i.baseTexture.resource;return i.baseTexture.valid?Promise.resolve(i):s.load().then(()=>Promise.resolve(i))}static fromBuffer(e,n,r,i){return new he(ze.fromBuffer(e,n,r,i))}static fromLoader(e,n,r,i){const s=new ze(e,Object.assign({scaleMode:ze.defaultOptions.scaleMode,resolution:Qo(n)},i)),{resource:o}=s;o instanceof n9&&(o.url=n);const a=new he(s);return r||(r=n),ze.addToCache(a.baseTexture,r),he.addToCache(a,r),r!==n&&(ze.addToCache(a.baseTexture,n),he.addToCache(a,n)),a.baseTexture.valid?Promise.resolve(a):new Promise(l=>{a.baseTexture.once("loaded",()=>l(a))})}static addToCache(e,n){n&&(e.textureCacheIds.includes(n)||e.textureCacheIds.push(n),Bs[n]&&Bs[n]!==e&&console.warn(`Texture added to the cache with an id [${n}] that already had an entry`),Bs[n]=e)}static removeFromCache(e){if(typeof e=="string"){const n=Bs[e];if(n){const r=n.textureCacheIds.indexOf(e);return r>-1&&n.textureCacheIds.splice(r,1),delete Bs[e],n}}else if(e!=null&&e.textureCacheIds){for(let n=0;n<e.textureCacheIds.length;++n)Bs[e.textureCacheIds[n]]===e&&delete Bs[e.textureCacheIds[n]];return e.textureCacheIds.length=0,e}return null}get resolution(){return this.baseTexture.resolution}get frame(){return this._frame}set frame(e){this._frame=e,this.noFrame=!1;const{x:n,y:r,width:i,height:s}=e,o=n+i>this.baseTexture.width,a=r+s>this.baseTexture.height;if(o||a){const l=o&&a?"and":"or",c=`X: ${n} + ${i} = ${n+i} > ${this.baseTexture.width}`,u=`Y: ${r} + ${s} = ${r+s} > ${this.baseTexture.height}`;throw new Error(`Texture Error: frame does not fit inside the base Texture dimensions: ${c} ${l} ${u}`)}this.valid=i&&s&&this.baseTexture.valid,!this.trim&&!this.rotate&&(this.orig=e),this.valid&&this.updateUvs()}get rotate(){return this._rotate}set rotate(e){this._rotate=e,this.valid&&this.updateUvs()}get width(){return this.orig.width}get height(){return this.orig.height}castToBaseTexture(){return this.baseTexture}static get EMPTY(){return he._EMPTY||(he._EMPTY=new he(new ze),B1(he._EMPTY),B1(he._EMPTY.baseTexture)),he._EMPTY}static get WHITE(){if(!he._WHITE){const e=_e.ADAPTER.createCanvas(16,16),n=e.getContext("2d");e.width=16,e.height=16,n.fillStyle="white",n.fillRect(0,0,16,16),he._WHITE=new he(ze.from(e)),B1(he._WHITE),B1(he._WHITE.baseTexture)}return he._WHITE}}class ta extends he{constructor(e,n){super(e,n),this.valid=!0,this.filterFrame=null,this.filterPoolKey=null,this.updateUvs()}get framebuffer(){return this.baseTexture.framebuffer}get multisample(){return this.framebuffer.multisample}set multisample(e){this.framebuffer.multisample=e}resize(e,n,r=!0){const i=this.baseTexture.resolution,s=Math.round(e*i)/i,o=Math.round(n*i)/i;this.valid=s>0&&o>0,this._frame.width=this.orig.width=s,this._frame.height=this.orig.height=o,r&&this.baseTexture.resize(s,o),this.updateUvs()}setResolution(e){const{baseTexture:n}=this;n.resolution!==e&&(n.setResolution(e),this.resize(n.width,n.height,!1))}static create(e){return new ta(new t9(e))}}class r9{constructor(e){this.texturePool={},this.textureOptions=e||{},this.enableFullScreen=!1,this._pixelsWidth=0,this._pixelsHeight=0}createTexture(e,n,r=dn.NONE){const i=new t9(Object.assign({width:e,height:n,resolution:1,multisample:r},this.textureOptions));return new ta(i)}getOptimalTexture(e,n,r=1,i=dn.NONE){let s;e=Math.max(Math.ceil(e*r-1e-6),1),n=Math.max(Math.ceil(n*r-1e-6),1),!this.enableFullScreen||e!==this._pixelsWidth||n!==this._pixelsHeight?(e=ey(e),n=ey(n),s=((e&65535)<<16|n&65535)>>>0,i>1&&(s+=i*4294967296)):s=i>1?-i:-1,this.texturePool[s]||(this.texturePool[s]=[]);let o=this.texturePool[s].pop();return o||(o=this.createTexture(e,n,i)),o.filterPoolKey=s,o.setResolution(r),o}getFilterTexture(e,n,r){const i=this.getOptimalTexture(e.width,e.height,n||e.resolution,r||dn.NONE);return i.filterFrame=e.filterFrame,i}returnTexture(e){const n=e.filterPoolKey;e.filterFrame=null,this.texturePool[n].push(e)}returnFilterTexture(e){this.returnTexture(e)}clear(e){if(e=e!==!1,e)for(const n in this.texturePool){const r=this.texturePool[n];if(r)for(let i=0;i<r.length;i++)r[i].destroy(!0)}this.texturePool={}}setScreenSize(e){if(!(e.width===this._pixelsWidth&&e.height===this._pixelsHeight)){this.enableFullScreen=e.width>0&&e.height>0;for(const n in this.texturePool){if(!(Number(n)<0))continue;const r=this.texturePool[n];if(r)for(let i=0;i<r.length;i++)r[i].destroy(!0);this.texturePool[n]=[]}this._pixelsWidth=e.width,this._pixelsHeight=e.height}}}r9.SCREEN_KEY=-1;class jY extends ea{constructor(){super(),this.addAttribute("aVertexPosition",new Float32Array([0,0,1,0,1,1,0,1])).addIndex([0,1,3,2])}}class i9 extends ea{constructor(){super(),this.vertices=new Float32Array([-1,-1,1,-1,1,1,-1,1]),this.uvs=new Float32Array([0,0,1,0,1,1,0,1]),this.vertexBuffer=new hn(this.vertices),this.uvBuffer=new hn(this.uvs),this.addAttribute("aVertexPosition",this.vertexBuffer).addAttribute("aTextureCoord",this.uvBuffer).addIndex([0,1,2,0,2,3])}map(e,n){let r=0,i=0;return this.uvs[0]=r,this.uvs[1]=i,this.uvs[2]=r+n.width/e.width,this.uvs[3]=i,this.uvs[4]=r+n.width/e.width,this.uvs[5]=i+n.height/e.height,this.uvs[6]=r,this.uvs[7]=i+n.height/e.height,r=n.x,i=n.y,this.vertices[0]=r,this.vertices[1]=i,this.vertices[2]=r+n.width,this.vertices[3]=i,this.vertices[4]=r+n.width,this.vertices[5]=i+n.height,this.vertices[6]=r,this.vertices[7]=i+n.height,this.invalidate(),this}invalidate(){return this.vertexBuffer._updateID++,this.uvBuffer._updateID++,this}}class XY{constructor(){this.renderTexture=null,this.target=null,this.legacy=!1,this.resolution=1,this.multisample=dn.NONE,this.sourceFrame=new Me,this.destinationFrame=new Me,this.bindingSourceFrame=new Me,this.bindingDestinationFrame=new Me,this.filters=[],this.transform=null}clear(){this.target=null,this.filters=null,this.renderTexture=null}}const U1=[new Ke,new Ke,new Ke,new Ke],zb=new Ze;class s9{constructor(e){this.renderer=e,this.defaultFilterStack=[{}],this.texturePool=new r9,this.statePool=[],this.quad=new jY,this.quadUv=new i9,this.tempRect=new Me,this.activeState={},this.globalUniforms=new ps({outputFrame:new Me,inputSize:new Float32Array(4),inputPixel:new Float32Array(4),inputClamp:new Float32Array(4),resolution:1,filterArea:new Float32Array(4),filterClamp:new Float32Array(4)},!0),this.forceClear=!1,this.useMaxPadding=!1}init(){this.texturePool.setScreenSize(this.renderer.view)}push(e,n){const r=this.renderer,i=this.defaultFilterStack,s=this.statePool.pop()||new XY,o=r.renderTexture;let a,l;if(o.current){const v=o.current;a=v.resolution,l=v.multisample}else a=r.resolution,l=r.multisample;let c=n[0].resolution||a,u=n[0].multisample??l,d=n[0].padding,h=n[0].autoFit,f=n[0].legacy??!0;for(let v=1;v<n.length;v++){const y=n[v];c=Math.min(c,y.resolution||a),u=Math.min(u,y.multisample??l),d=this.useMaxPadding?Math.max(d,y.padding):d+y.padding,h=h&&y.autoFit,f=f||(y.legacy??!0)}i.length===1&&(this.defaultFilterStack[0].renderTexture=o.current),i.push(s),s.resolution=c,s.multisample=u,s.legacy=f,s.target=e,s.sourceFrame.copyFrom(e.filterArea||e.getBounds(!0)),s.sourceFrame.pad(d);const p=this.tempRect.copyFrom(o.sourceFrame);r.projection.transform&&this.transformAABB(zb.copyFrom(r.projection.transform).invert(),p),h?(s.sourceFrame.fit(p),(s.sourceFrame.width<=0||s.sourceFrame.height<=0)&&(s.sourceFrame.width=0,s.sourceFrame.height=0)):s.sourceFrame.intersects(p)||(s.sourceFrame.width=0,s.sourceFrame.height=0),this.roundFrame(s.sourceFrame,o.current?o.current.resolution:r.resolution,o.sourceFrame,o.destinationFrame,r.projection.transform),s.renderTexture=this.getOptimalFilterTexture(s.sourceFrame.width,s.sourceFrame.height,c,u),s.filters=n,s.destinationFrame.width=s.renderTexture.width,s.destinationFrame.height=s.renderTexture.height;const m=this.tempRect;m.x=0,m.y=0,m.width=s.sourceFrame.width,m.height=s.sourceFrame.height,s.renderTexture.filterFrame=s.sourceFrame,s.bindingSourceFrame.copyFrom(o.sourceFrame),s.bindingDestinationFrame.copyFrom(o.destinationFrame),s.transform=r.projection.transform,r.projection.transform=null,o.bind(s.renderTexture,s.sourceFrame,m),r.framebuffer.clear(0,0,0,0)}pop(){const e=this.defaultFilterStack,n=e.pop(),r=n.filters;this.activeState=n;const i=this.globalUniforms.uniforms;i.outputFrame=n.sourceFrame,i.resolution=n.resolution;const s=i.inputSize,o=i.inputPixel,a=i.inputClamp;if(s[0]=n.destinationFrame.width,s[1]=n.destinationFrame.height,s[2]=1/s[0],s[3]=1/s[1],o[0]=Math.round(s[0]*n.resolution),o[1]=Math.round(s[1]*n.resolution),o[2]=1/o[0],o[3]=1/o[1],a[0]=.5*o[2],a[1]=.5*o[3],a[2]=n.sourceFrame.width*s[2]-.5*o[2],a[3]=n.sourceFrame.height*s[3]-.5*o[3],n.legacy){const c=i.filterArea;c[0]=n.destinationFrame.width,c[1]=n.destinationFrame.height,c[2]=n.sourceFrame.x,c[3]=n.sourceFrame.y,i.filterClamp=i.inputClamp}this.globalUniforms.update();const l=e[e.length-1];if(this.renderer.framebuffer.blit(),r.length===1)r[0].apply(this,n.renderTexture,l.renderTexture,Zs.BLEND,n),this.returnFilterTexture(n.renderTexture);else{let c=n.renderTexture,u=this.getOptimalFilterTexture(c.width,c.height,n.resolution);u.filterFrame=c.filterFrame;let d=0;for(d=0;d<r.length-1;++d){d===1&&n.multisample>1&&(u=this.getOptimalFilterTexture(c.width,c.height,n.resolution),u.filterFrame=c.filterFrame),r[d].apply(this,c,u,Zs.CLEAR,n);const h=c;c=u,u=h}r[d].apply(this,c,l.renderTexture,Zs.BLEND,n),d>1&&n.multisample>1&&this.returnFilterTexture(n.renderTexture),this.returnFilterTexture(c),this.returnFilterTexture(u)}n.clear(),this.statePool.push(n)}bindAndClear(e,n=Zs.CLEAR){const{renderTexture:r,state:i}=this.renderer;if(e===this.defaultFilterStack[this.defaultFilterStack.length-1].renderTexture?this.renderer.projection.transform=this.activeState.transform:this.renderer.projection.transform=null,e==null?void 0:e.filterFrame){const o=this.tempRect;o.x=0,o.y=0,o.width=e.filterFrame.width,o.height=e.filterFrame.height,r.bind(e,e.filterFrame,o)}else e!==this.defaultFilterStack[this.defaultFilterStack.length-1].renderTexture?r.bind(e):this.renderer.renderTexture.bind(e,this.activeState.bindingSourceFrame,this.activeState.bindingDestinationFrame);const s=i.stateId&1||this.forceClear;(n===Zs.CLEAR||n===Zs.BLIT&&s)&&this.renderer.framebuffer.clear(0,0,0,0)}applyFilter(e,n,r,i){const s=this.renderer;s.state.set(e.state),this.bindAndClear(r,i),e.uniforms.uSampler=n,e.uniforms.filterGlobals=this.globalUniforms,s.shader.bind(e),e.legacy=!!e.program.attributeData.aTextureCoord,e.legacy?(this.quadUv.map(n._frame,n.filterFrame),s.geometry.bind(this.quadUv),s.geometry.draw(ls.TRIANGLES)):(s.geometry.bind(this.quad),s.geometry.draw(ls.TRIANGLE_STRIP))}calculateSpriteMatrix(e,n){const{sourceFrame:r,destinationFrame:i}=this.activeState,{orig:s}=n._texture,o=e.set(i.width,0,0,i.height,r.x,r.y),a=n.worldTransform.copyTo(Ze.TEMP_MATRIX);return a.invert(),o.prepend(a),o.scale(1/s.width,1/s.height),o.translate(n.anchor.x,n.anchor.y),o}destroy(){this.renderer=null,this.texturePool.clear(!1)}getOptimalFilterTexture(e,n,r=1,i=dn.NONE){return this.texturePool.getOptimalTexture(e,n,r,i)}getFilterTexture(e,n,r){if(typeof e=="number"){const s=e;e=n,n=s}e=e||this.activeState.renderTexture;const i=this.texturePool.getOptimalTexture(e.width,e.height,n||e.resolution,r||dn.NONE);return i.filterFrame=e.filterFrame,i}returnFilterTexture(e){this.texturePool.returnTexture(e)}emptyPool(){this.texturePool.clear(!0)}resize(){this.texturePool.setScreenSize(this.renderer.view)}transformAABB(e,n){const r=U1[0],i=U1[1],s=U1[2],o=U1[3];r.set(n.left,n.top),i.set(n.left,n.bottom),s.set(n.right,n.top),o.set(n.right,n.bottom),e.apply(r,r),e.apply(i,i),e.apply(s,s),e.apply(o,o);const a=Math.min(r.x,i.x,s.x,o.x),l=Math.min(r.y,i.y,s.y,o.y),c=Math.max(r.x,i.x,s.x,o.x),u=Math.max(r.y,i.y,s.y,o.y);n.x=a,n.y=l,n.width=c-a,n.height=u-l}roundFrame(e,n,r,i,s){if(!(e.width<=0||e.height<=0||r.width<=0||r.height<=0)){if(s){const{a:o,b:a,c:l,d:c}=s;if((Math.abs(a)>1e-4||Math.abs(l)>1e-4)&&(Math.abs(o)>1e-4||Math.abs(c)>1e-4))return}s=s?zb.copyFrom(s):zb.identity(),s.translate(-r.x,-r.y).scale(i.width/r.width,i.height/r.height).translate(i.x,i.y),this.transformAABB(s,e),e.ceil(n),this.transformAABB(s.invert(),e)}}}s9.extension={type:me.RendererSystem,name:"filter"};Ce.add(s9);class YY{constructor(e){this.framebuffer=e,this.stencil=null,this.dirtyId=-1,this.dirtyFormat=-1,this.dirtySize=-1,this.multisample=dn.NONE,this.msaaBuffer=null,this.blitFramebuffer=null,this.mipLevel=0}}const ZY=new Me;class o9{constructor(e){this.renderer=e,this.managedFramebuffers=[],this.unknownFramebuffer=new Gw(10,10),this.msaaSamples=null}contextChange(){this.disposeAll(!0);const e=this.gl=this.renderer.gl;if(this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.current=this.unknownFramebuffer,this.viewport=new Me,this.hasMRT=!0,this.writeDepthTexture=!0,this.renderer.context.webGLVersion===1){let n=this.renderer.context.extensions.drawBuffers,r=this.renderer.context.extensions.depthTexture;_e.PREFER_ENV===cu.WEBGL_LEGACY&&(n=null,r=null),n?e.drawBuffers=i=>n.drawBuffersWEBGL(i):(this.hasMRT=!1,e.drawBuffers=()=>{}),r||(this.writeDepthTexture=!1)}else this.msaaSamples=e.getInternalformatParameter(e.RENDERBUFFER,e.RGBA8,e.SAMPLES)}bind(e,n,r=0){const{gl:i}=this;if(e){const s=e.glFramebuffers[this.CONTEXT_UID]||this.initFramebuffer(e);this.current!==e&&(this.current=e,i.bindFramebuffer(i.FRAMEBUFFER,s.framebuffer)),s.mipLevel!==r&&(e.dirtyId++,e.dirtyFormat++,s.mipLevel=r),s.dirtyId!==e.dirtyId&&(s.dirtyId=e.dirtyId,s.dirtyFormat!==e.dirtyFormat?(s.dirtyFormat=e.dirtyFormat,s.dirtySize=e.dirtySize,this.updateFramebuffer(e,r)):s.dirtySize!==e.dirtySize&&(s.dirtySize=e.dirtySize,this.resizeFramebuffer(e)));for(let o=0;o<e.colorTextures.length;o++){const a=e.colorTextures[o];this.renderer.texture.unbind(a.parentTextureArray||a)}if(e.depthTexture&&this.renderer.texture.unbind(e.depthTexture),n){const o=n.width>>r,a=n.height>>r,l=o/n.width;this.setViewport(n.x*l,n.y*l,o,a)}else{const o=e.width>>r,a=e.height>>r;this.setViewport(0,0,o,a)}}else this.current&&(this.current=null,i.bindFramebuffer(i.FRAMEBUFFER,null)),n?this.setViewport(n.x,n.y,n.width,n.height):this.setViewport(0,0,this.renderer.width,this.renderer.height)}setViewport(e,n,r,i){const s=this.viewport;e=Math.round(e),n=Math.round(n),r=Math.round(r),i=Math.round(i),(s.width!==r||s.height!==i||s.x!==e||s.y!==n)&&(s.x=e,s.y=n,s.width=r,s.height=i,this.gl.viewport(e,n,r,i))}get size(){return this.current?{x:0,y:0,width:this.current.width,height:this.current.height}:{x:0,y:0,width:this.renderer.width,height:this.renderer.height}}clear(e,n,r,i,s=vw.COLOR|vw.DEPTH){const{gl:o}=this;o.clearColor(e,n,r,i),o.clear(s)}initFramebuffer(e){const{gl:n}=this,r=new YY(n.createFramebuffer());return r.multisample=this.detectSamples(e.multisample),e.glFramebuffers[this.CONTEXT_UID]=r,this.managedFramebuffers.push(e),e.disposeRunner.add(this),r}resizeFramebuffer(e){const{gl:n}=this,r=e.glFramebuffers[this.CONTEXT_UID];if(r.stencil){n.bindRenderbuffer(n.RENDERBUFFER,r.stencil);let o;this.renderer.context.webGLVersion===1?o=n.DEPTH_STENCIL:e.depth&&e.stencil?o=n.DEPTH24_STENCIL8:e.depth?o=n.DEPTH_COMPONENT24:o=n.STENCIL_INDEX8,r.msaaBuffer?n.renderbufferStorageMultisample(n.RENDERBUFFER,r.multisample,o,e.width,e.height):n.renderbufferStorage(n.RENDERBUFFER,o,e.width,e.height)}const i=e.colorTextures;let s=i.length;n.drawBuffers||(s=Math.min(s,1));for(let o=0;o<s;o++){const a=i[o],l=a.parentTextureArray||a;this.renderer.texture.bind(l,0),o===0&&r.msaaBuffer&&(n.bindRenderbuffer(n.RENDERBUFFER,r.msaaBuffer),n.renderbufferStorageMultisample(n.RENDERBUFFER,r.multisample,l._glTextures[this.CONTEXT_UID].internalFormat,e.width,e.height))}e.depthTexture&&this.writeDepthTexture&&this.renderer.texture.bind(e.depthTexture,0)}updateFramebuffer(e,n){const{gl:r}=this,i=e.glFramebuffers[this.CONTEXT_UID],s=e.colorTextures;let o=s.length;r.drawBuffers||(o=Math.min(o,1)),i.multisample>1&&this.canMultisampleFramebuffer(e)?i.msaaBuffer=i.msaaBuffer||r.createRenderbuffer():i.msaaBuffer&&(r.deleteRenderbuffer(i.msaaBuffer),i.msaaBuffer=null,i.blitFramebuffer&&(i.blitFramebuffer.dispose(),i.blitFramebuffer=null));const a=[];for(let l=0;l<o;l++){const c=s[l],u=c.parentTextureArray||c;this.renderer.texture.bind(u,0),l===0&&i.msaaBuffer?(r.bindRenderbuffer(r.RENDERBUFFER,i.msaaBuffer),r.renderbufferStorageMultisample(r.RENDERBUFFER,i.multisample,u._glTextures[this.CONTEXT_UID].internalFormat,e.width,e.height),r.framebufferRenderbuffer(r.FRAMEBUFFER,r.COLOR_ATTACHMENT0,r.RENDERBUFFER,i.msaaBuffer)):(r.framebufferTexture2D(r.FRAMEBUFFER,r.COLOR_ATTACHMENT0+l,c.target,u._glTextures[this.CONTEXT_UID].texture,n),a.push(r.COLOR_ATTACHMENT0+l))}if(a.length>1&&r.drawBuffers(a),e.depthTexture&&this.writeDepthTexture){const l=e.depthTexture;this.renderer.texture.bind(l,0),r.framebufferTexture2D(r.FRAMEBUFFER,r.DEPTH_ATTACHMENT,r.TEXTURE_2D,l._glTextures[this.CONTEXT_UID].texture,n)}if((e.stencil||e.depth)&&!(e.depthTexture&&this.writeDepthTexture)){i.stencil=i.stencil||r.createRenderbuffer();let l,c;this.renderer.context.webGLVersion===1?(l=r.DEPTH_STENCIL_ATTACHMENT,c=r.DEPTH_STENCIL):e.depth&&e.stencil?(l=r.DEPTH_STENCIL_ATTACHMENT,c=r.DEPTH24_STENCIL8):e.depth?(l=r.DEPTH_ATTACHMENT,c=r.DEPTH_COMPONENT24):(l=r.STENCIL_ATTACHMENT,c=r.STENCIL_INDEX8),r.bindRenderbuffer(r.RENDERBUFFER,i.stencil),i.msaaBuffer?r.renderbufferStorageMultisample(r.RENDERBUFFER,i.multisample,c,e.width,e.height):r.renderbufferStorage(r.RENDERBUFFER,c,e.width,e.height),r.framebufferRenderbuffer(r.FRAMEBUFFER,l,r.RENDERBUFFER,i.stencil)}else i.stencil&&(r.deleteRenderbuffer(i.stencil),i.stencil=null)}canMultisampleFramebuffer(e){return this.renderer.context.webGLVersion!==1&&e.colorTextures.length<=1&&!e.depthTexture}detectSamples(e){const{msaaSamples:n}=this;let r=dn.NONE;if(e<=1||n===null)return r;for(let i=0;i<n.length;i++)if(n[i]<=e){r=n[i];break}return r===1&&(r=dn.NONE),r}blit(e,n,r){const{current:i,renderer:s,gl:o,CONTEXT_UID:a}=this;if(s.context.webGLVersion!==2||!i)return;const l=i.glFramebuffers[a];if(!l)return;if(!e){if(!l.msaaBuffer)return;const u=i.colorTextures[0];if(!u)return;l.blitFramebuffer||(l.blitFramebuffer=new Gw(i.width,i.height),l.blitFramebuffer.addColorTexture(0,u)),e=l.blitFramebuffer,e.colorTextures[0]!==u&&(e.colorTextures[0]=u,e.dirtyId++,e.dirtyFormat++),(e.width!==i.width||e.height!==i.height)&&(e.width=i.width,e.height=i.height,e.dirtyId++,e.dirtySize++)}n||(n=ZY,n.width=i.width,n.height=i.height),r||(r=n);const c=n.width===r.width&&n.height===r.height;this.bind(e),o.bindFramebuffer(o.READ_FRAMEBUFFER,l.framebuffer),o.blitFramebuffer(n.left,n.top,n.right,n.bottom,r.left,r.top,r.right,r.bottom,o.COLOR_BUFFER_BIT,c?o.NEAREST:o.LINEAR),o.bindFramebuffer(o.READ_FRAMEBUFFER,e.glFramebuffers[this.CONTEXT_UID].framebuffer)}disposeFramebuffer(e,n){const r=e.glFramebuffers[this.CONTEXT_UID],i=this.gl;if(!r)return;delete e.glFramebuffers[this.CONTEXT_UID];const s=this.managedFramebuffers.indexOf(e);s>=0&&this.managedFramebuffers.splice(s,1),e.disposeRunner.remove(this),n||(i.deleteFramebuffer(r.framebuffer),r.msaaBuffer&&i.deleteRenderbuffer(r.msaaBuffer),r.stencil&&i.deleteRenderbuffer(r.stencil)),r.blitFramebuffer&&this.disposeFramebuffer(r.blitFramebuffer,n)}disposeAll(e){const n=this.managedFramebuffers;this.managedFramebuffers=[];for(let r=0;r<n.length;r++)this.disposeFramebuffer(n[r],e)}forceStencil(){const e=this.current;if(!e)return;const n=e.glFramebuffers[this.CONTEXT_UID];if(!n||n.stencil&&e.stencil)return;e.stencil=!0;const r=e.width,i=e.height,s=this.gl,o=n.stencil=s.createRenderbuffer();s.bindRenderbuffer(s.RENDERBUFFER,o);let a,l;this.renderer.context.webGLVersion===1?(a=s.DEPTH_STENCIL_ATTACHMENT,l=s.DEPTH_STENCIL):e.depth?(a=s.DEPTH_STENCIL_ATTACHMENT,l=s.DEPTH24_STENCIL8):(a=s.STENCIL_ATTACHMENT,l=s.STENCIL_INDEX8),n.msaaBuffer?s.renderbufferStorageMultisample(s.RENDERBUFFER,n.multisample,l,r,i):s.renderbufferStorage(s.RENDERBUFFER,l,r,i),s.framebufferRenderbuffer(s.FRAMEBUFFER,a,s.RENDERBUFFER,o)}reset(){this.current=this.unknownFramebuffer,this.viewport=new Me}destroy(){this.renderer=null}}o9.extension={type:me.RendererSystem,name:"framebuffer"};Ce.add(o9);const Gb={5126:4,5123:2,5121:1};class a9{constructor(e){this.renderer=e,this._activeGeometry=null,this._activeVao=null,this.hasVao=!0,this.hasInstance=!0,this.canUseUInt32ElementIndex=!1,this.managedGeometries={}}contextChange(){this.disposeAll(!0);const e=this.gl=this.renderer.gl,n=this.renderer.context;if(this.CONTEXT_UID=this.renderer.CONTEXT_UID,n.webGLVersion!==2){let r=this.renderer.context.extensions.vertexArrayObject;_e.PREFER_ENV===cu.WEBGL_LEGACY&&(r=null),r?(e.createVertexArray=()=>r.createVertexArrayOES(),e.bindVertexArray=i=>r.bindVertexArrayOES(i),e.deleteVertexArray=i=>r.deleteVertexArrayOES(i)):(this.hasVao=!1,e.createVertexArray=()=>null,e.bindVertexArray=()=>null,e.deleteVertexArray=()=>null)}if(n.webGLVersion!==2){const r=e.getExtension("ANGLE_instanced_arrays");r?(e.vertexAttribDivisor=(i,s)=>r.vertexAttribDivisorANGLE(i,s),e.drawElementsInstanced=(i,s,o,a,l)=>r.drawElementsInstancedANGLE(i,s,o,a,l),e.drawArraysInstanced=(i,s,o,a)=>r.drawArraysInstancedANGLE(i,s,o,a)):this.hasInstance=!1}this.canUseUInt32ElementIndex=n.webGLVersion===2||!!n.extensions.uint32ElementIndex}bind(e,n){n=n||this.renderer.shader.shader;const{gl:r}=this;let i=e.glVertexArrayObjects[this.CONTEXT_UID],s=!1;i||(this.managedGeometries[e.id]=e,e.disposeRunner.add(this),e.glVertexArrayObjects[this.CONTEXT_UID]=i={},s=!0);const o=i[n.program.id]||this.initGeometryVao(e,n,s);this._activeGeometry=e,this._activeVao!==o&&(this._activeVao=o,this.hasVao?r.bindVertexArray(o):this.activateVao(e,n.program)),this.updateBuffers()}reset(){this.unbind()}updateBuffers(){const e=this._activeGeometry,n=this.renderer.buffer;for(let r=0;r<e.buffers.length;r++){const i=e.buffers[r];n.update(i)}}checkCompatibility(e,n){const r=e.attributes,i=n.attributeData;for(const s in i)if(!r[s])throw new Error(`shader and geometry incompatible, geometry missing the "${s}" attribute`)}getSignature(e,n){const r=e.attributes,i=n.attributeData,s=["g",e.id];for(const o in r)i[o]&&s.push(o,i[o].location);return s.join("-")}initGeometryVao(e,n,r=!0){const i=this.gl,s=this.CONTEXT_UID,o=this.renderer.buffer,a=n.program;a.glPrograms[s]||this.renderer.shader.generateProgram(n),this.checkCompatibility(e,a);const l=this.getSignature(e,a),c=e.glVertexArrayObjects[this.CONTEXT_UID];let u=c[l];if(u)return c[a.id]=u,u;const d=e.buffers,h=e.attributes,f={},p={};for(const m in d)f[m]=0,p[m]=0;for(const m in h)!h[m].size&&a.attributeData[m]?h[m].size=a.attributeData[m].size:h[m].size||console.warn(`PIXI Geometry attribute '${m}' size cannot be determined (likely the bound shader does not have the attribute)`),f[h[m].buffer]+=h[m].size*Gb[h[m].type];for(const m in h){const v=h[m],y=v.size;v.stride===void 0&&(f[v.buffer]===y*Gb[v.type]?v.stride=0:v.stride=f[v.buffer]),v.start===void 0&&(v.start=p[v.buffer],p[v.buffer]+=y*Gb[v.type])}u=i.createVertexArray(),i.bindVertexArray(u);for(let m=0;m<d.length;m++){const v=d[m];o.bind(v),r&&v._glBuffers[s].refCount++}return this.activateVao(e,a),c[a.id]=u,c[l]=u,i.bindVertexArray(null),o.unbind(so.ARRAY_BUFFER),u}disposeGeometry(e,n){var a;if(!this.managedGeometries[e.id])return;delete this.managedGeometries[e.id];const r=e.glVertexArrayObjects[this.CONTEXT_UID],i=this.gl,s=e.buffers,o=(a=this.renderer)==null?void 0:a.buffer;if(e.disposeRunner.remove(this),!!r){if(o)for(let l=0;l<s.length;l++){const c=s[l]._glBuffers[this.CONTEXT_UID];c&&(c.refCount--,c.refCount===0&&!n&&o.dispose(s[l],n))}if(!n){for(const l in r)if(l[0]==="g"){const c=r[l];this._activeVao===c&&this.unbind(),i.deleteVertexArray(c)}}delete e.glVertexArrayObjects[this.CONTEXT_UID]}}disposeAll(e){const n=Object.keys(this.managedGeometries);for(let r=0;r<n.length;r++)this.disposeGeometry(this.managedGeometries[n[r]],e)}activateVao(e,n){const r=this.gl,i=this.CONTEXT_UID,s=this.renderer.buffer,o=e.buffers,a=e.attributes;e.indexBuffer&&s.bind(e.indexBuffer);let l=null;for(const c in a){const u=a[c],d=o[u.buffer],h=d._glBuffers[i];if(n.attributeData[c]){l!==h&&(s.bind(d),l=h);const f=n.attributeData[c].location;if(r.enableVertexAttribArray(f),r.vertexAttribPointer(f,u.size,u.type||r.FLOAT,u.normalized,u.stride,u.start),u.instance)if(this.hasInstance)r.vertexAttribDivisor(f,u.divisor);else throw new Error("geometry error, GPU Instancing is not supported on this device")}}}draw(e,n,r,i){const{gl:s}=this,o=this._activeGeometry;if(o.indexBuffer){const a=o.indexBuffer.data.BYTES_PER_ELEMENT,l=a===2?s.UNSIGNED_SHORT:s.UNSIGNED_INT;a===2||a===4&&this.canUseUInt32ElementIndex?o.instanced?s.drawElementsInstanced(e,n||o.indexBuffer.data.length,l,(r||0)*a,i||1):s.drawElements(e,n||o.indexBuffer.data.length,l,(r||0)*a):console.warn("unsupported index buffer type: uint32")}else o.instanced?s.drawArraysInstanced(e,r,n||o.getSize(),i||1):s.drawArrays(e,r,n||o.getSize());return this}unbind(){this.gl.bindVertexArray(null),this._activeVao=null,this._activeGeometry=null}destroy(){this.renderer=null}}a9.extension={type:me.RendererSystem,name:"geometry"};Ce.add(a9);const $5=new Ze;class l9{constructor(e,n){this._texture=e,this.mapCoord=new Ze,this.uClampFrame=new Float32Array(4),this.uClampOffset=new Float32Array(2),this._textureID=-1,this._updateID=0,this.clampOffset=0,this.clampMargin=typeof n>"u"?.5:n,this.isSimple=!1}get texture(){return this._texture}set texture(e){this._texture=e,this._textureID=-1}multiplyUvs(e,n){n===void 0&&(n=e);const r=this.mapCoord;for(let i=0;i<e.length;i+=2){const s=e[i],o=e[i+1];n[i]=s*r.a+o*r.c+r.tx,n[i+1]=s*r.b+o*r.d+r.ty}return n}update(e){const n=this._texture;if(!n||!n.valid||!e&&this._textureID===n._updateID)return!1;this._textureID=n._updateID,this._updateID++;const r=n._uvs;this.mapCoord.set(r.x1-r.x0,r.y1-r.y0,r.x3-r.x0,r.y3-r.y0,r.x0,r.y0);const i=n.orig,s=n.trim;s&&($5.set(i.width/s.width,0,0,i.height/s.height,-s.x/s.width,-s.y/s.height),this.mapCoord.append($5));const o=n.baseTexture,a=this.uClampFrame,l=this.clampMargin/o.resolution,c=this.clampOffset;return a[0]=(n._frame.x+l+c)/o.width,a[1]=(n._frame.y+l+c)/o.height,a[2]=(n._frame.x+n._frame.width-l+c)/o.width,a[3]=(n._frame.y+n._frame.height-l+c)/o.height,this.uClampOffset[0]=c/o.realWidth,this.uClampOffset[1]=c/o.realHeight,this.isSimple=n._frame.width===o.width&&n._frame.height===o.height&&n.rotate===0,!0}}var KY=`varying vec2 vMaskCoord;
varying vec2 vTextureCoord;

uniform sampler2D uSampler;
uniform sampler2D mask;
uniform float alpha;
uniform float npmAlpha;
uniform vec4 maskClamp;

void main(void)
{
    float clip = step(3.5,
        step(maskClamp.x, vMaskCoord.x) +
        step(maskClamp.y, vMaskCoord.y) +
        step(vMaskCoord.x, maskClamp.z) +
        step(vMaskCoord.y, maskClamp.w));

    vec4 original = texture2D(uSampler, vTextureCoord);
    vec4 masky = texture2D(mask, vMaskCoord);
    float alphaMul = 1.0 - npmAlpha * (1.0 - masky.a);

    original *= (alphaMul * masky.r * alpha * clip);

    gl_FragColor = original;
}
`,qY=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;
uniform mat3 otherMatrix;

varying vec2 vMaskCoord;
varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = aTextureCoord;
    vMaskCoord = ( otherMatrix * vec3( aTextureCoord, 1.0)  ).xy;
}
`;class c9 extends Lr{constructor(e,n,r){let i=null;typeof e!="string"&&n===void 0&&r===void 0&&(i=e,e=void 0,n=void 0,r=void 0),super(e||qY,n||KY,r),this.maskSprite=i,this.maskMatrix=new Ze}get maskSprite(){return this._maskSprite}set maskSprite(e){this._maskSprite=e,this._maskSprite&&(this._maskSprite.renderable=!1)}apply(e,n,r,i){const s=this._maskSprite,o=s._texture;o.valid&&(o.uvMatrix||(o.uvMatrix=new l9(o,0)),o.uvMatrix.update(),this.uniforms.npmAlpha=o.baseTexture.alphaMode?0:1,this.uniforms.mask=o,this.uniforms.otherMatrix=e.calculateSpriteMatrix(this.maskMatrix,s).prepend(o.uvMatrix.mapCoord),this.uniforms.alpha=s.worldAlpha,this.uniforms.maskClamp=o.uvMatrix.uClampFrame,e.applyFilter(this,n,r,i))}}class JY{constructor(e=null){this.type=In.NONE,this.autoDetect=!0,this.maskObject=e||null,this.pooled=!1,this.isMaskData=!0,this.resolution=null,this.multisample=Lr.defaultMultisample,this.enabled=!0,this.colorMask=15,this._filters=null,this._stencilCounter=0,this._scissorCounter=0,this._scissorRect=null,this._scissorRectLocal=null,this._colorMask=15,this._target=null}get filter(){return this._filters?this._filters[0]:null}set filter(e){e?this._filters?this._filters[0]=e:this._filters=[e]:this._filters=null}reset(){this.pooled&&(this.maskObject=null,this.type=In.NONE,this.autoDetect=!0),this._target=null,this._scissorRectLocal=null}copyCountersOrReset(e){e?(this._stencilCounter=e._stencilCounter,this._scissorCounter=e._scissorCounter,this._scissorRect=e._scissorRect):(this._stencilCounter=0,this._scissorCounter=0,this._scissorRect=null)}}class u9{constructor(e){this.renderer=e,this.enableScissor=!0,this.alphaMaskPool=[],this.maskDataPool=[],this.maskStack=[],this.alphaMaskIndex=0}setMaskStack(e){this.maskStack=e,this.renderer.scissor.setMaskStack(e),this.renderer.stencil.setMaskStack(e)}push(e,n){let r=n;if(!r.isMaskData){const s=this.maskDataPool.pop()||new JY;s.pooled=!0,s.maskObject=n,r=s}const i=this.maskStack.length!==0?this.maskStack[this.maskStack.length-1]:null;if(r.copyCountersOrReset(i),r._colorMask=i?i._colorMask:15,r.autoDetect&&this.detect(r),r._target=e,r.type!==In.SPRITE&&this.maskStack.push(r),r.enabled)switch(r.type){case In.SCISSOR:this.renderer.scissor.push(r);break;case In.STENCIL:this.renderer.stencil.push(r);break;case In.SPRITE:r.copyCountersOrReset(null),this.pushSpriteMask(r);break;case In.COLOR:this.pushColorMask(r);break}r.type===In.SPRITE&&this.maskStack.push(r)}pop(e){const n=this.maskStack.pop();if(!(!n||n._target!==e)){if(n.enabled)switch(n.type){case In.SCISSOR:this.renderer.scissor.pop(n);break;case In.STENCIL:this.renderer.stencil.pop(n.maskObject);break;case In.SPRITE:this.popSpriteMask(n);break;case In.COLOR:this.popColorMask(n);break}if(n.reset(),n.pooled&&this.maskDataPool.push(n),this.maskStack.length!==0){const r=this.maskStack[this.maskStack.length-1];r.type===In.SPRITE&&r._filters&&(r._filters[0].maskSprite=r.maskObject)}}}detect(e){const n=e.maskObject;n?n.isSprite?e.type=In.SPRITE:this.enableScissor&&this.renderer.scissor.testScissor(e)?e.type=In.SCISSOR:e.type=In.STENCIL:e.type=In.COLOR}pushSpriteMask(e){const{maskObject:n}=e,r=e._target;let i=e._filters;i||(i=this.alphaMaskPool[this.alphaMaskIndex],i||(i=this.alphaMaskPool[this.alphaMaskIndex]=[new c9])),i[0].resolution=e.resolution,i[0].multisample=e.multisample,i[0].maskSprite=n;const s=r.filterArea;r.filterArea=n.getBounds(!0),this.renderer.filter.push(r,i),r.filterArea=s,e._filters||this.alphaMaskIndex++}popSpriteMask(e){this.renderer.filter.pop(),e._filters?e._filters[0].maskSprite=null:(this.alphaMaskIndex--,this.alphaMaskPool[this.alphaMaskIndex][0].maskSprite=null)}pushColorMask(e){const n=e._colorMask,r=e._colorMask=n&e.colorMask;r!==n&&this.renderer.gl.colorMask((r&1)!==0,(r&2)!==0,(r&4)!==0,(r&8)!==0)}popColorMask(e){const n=e._colorMask,r=this.maskStack.length>0?this.maskStack[this.maskStack.length-1]._colorMask:15;r!==n&&this.renderer.gl.colorMask((r&1)!==0,(r&2)!==0,(r&4)!==0,(r&8)!==0)}destroy(){this.renderer=null}}u9.extension={type:me.RendererSystem,name:"mask"};Ce.add(u9);class d9{constructor(e){this.renderer=e,this.maskStack=[],this.glConst=0}getStackLength(){return this.maskStack.length}setMaskStack(e){const{gl:n}=this.renderer,r=this.getStackLength();this.maskStack=e;const i=this.getStackLength();i!==r&&(i===0?n.disable(this.glConst):(n.enable(this.glConst),this._useCurrent()))}_useCurrent(){}destroy(){this.renderer=null,this.maskStack=null}}const H5=new Ze,z5=[],h9=class Vg extends d9{constructor(e){super(e),this.glConst=_e.ADAPTER.getWebGLRenderingContext().SCISSOR_TEST}getStackLength(){const e=this.maskStack[this.maskStack.length-1];return e?e._scissorCounter:0}calcScissorRect(e){if(e._scissorRectLocal)return;const n=e._scissorRect,{maskObject:r}=e,{renderer:i}=this,s=i.renderTexture,o=r.getBounds(!0,z5.pop()??new Me);this.roundFrameToPixels(o,s.current?s.current.resolution:i.resolution,s.sourceFrame,s.destinationFrame,i.projection.transform),n&&o.fit(n),e._scissorRectLocal=o}static isMatrixRotated(e){if(!e)return!1;const{a:n,b:r,c:i,d:s}=e;return(Math.abs(r)>1e-4||Math.abs(i)>1e-4)&&(Math.abs(n)>1e-4||Math.abs(s)>1e-4)}testScissor(e){const{maskObject:n}=e;if(!n.isFastRect||!n.isFastRect()||Vg.isMatrixRotated(n.worldTransform)||Vg.isMatrixRotated(this.renderer.projection.transform))return!1;this.calcScissorRect(e);const r=e._scissorRectLocal;return r.width>0&&r.height>0}roundFrameToPixels(e,n,r,i,s){Vg.isMatrixRotated(s)||(s=s?H5.copyFrom(s):H5.identity(),s.translate(-r.x,-r.y).scale(i.width/r.width,i.height/r.height).translate(i.x,i.y),this.renderer.filter.transformAABB(s,e),e.fit(i),e.x=Math.round(e.x*n),e.y=Math.round(e.y*n),e.width=Math.round(e.width*n),e.height=Math.round(e.height*n))}push(e){e._scissorRectLocal||this.calcScissorRect(e);const{gl:n}=this.renderer;e._scissorRect||n.enable(n.SCISSOR_TEST),e._scissorCounter++,e._scissorRect=e._scissorRectLocal,this._useCurrent()}pop(e){const{gl:n}=this.renderer;e&&z5.push(e._scissorRectLocal),this.getStackLength()>0?this._useCurrent():n.disable(n.SCISSOR_TEST)}_useCurrent(){const e=this.maskStack[this.maskStack.length-1]._scissorRect;let n;this.renderer.renderTexture.current?n=e.y:n=this.renderer.height-e.height-e.y,this.renderer.gl.scissor(e.x,n,e.width,e.height)}};h9.extension={type:me.RendererSystem,name:"scissor"};let QY=h9;Ce.add(QY);class f9 extends d9{constructor(e){super(e),this.glConst=_e.ADAPTER.getWebGLRenderingContext().STENCIL_TEST}getStackLength(){const e=this.maskStack[this.maskStack.length-1];return e?e._stencilCounter:0}push(e){const n=e.maskObject,{gl:r}=this.renderer,i=e._stencilCounter;i===0&&(this.renderer.framebuffer.forceStencil(),r.clearStencil(0),r.clear(r.STENCIL_BUFFER_BIT),r.enable(r.STENCIL_TEST)),e._stencilCounter++;const s=e._colorMask;s!==0&&(e._colorMask=0,r.colorMask(!1,!1,!1,!1)),r.stencilFunc(r.EQUAL,i,4294967295),r.stencilOp(r.KEEP,r.KEEP,r.INCR),n.renderable=!0,n.render(this.renderer),this.renderer.batch.flush(),n.renderable=!1,s!==0&&(e._colorMask=s,r.colorMask((s&1)!==0,(s&2)!==0,(s&4)!==0,(s&8)!==0)),this._useCurrent()}pop(e){const n=this.renderer.gl;if(this.getStackLength()===0)n.disable(n.STENCIL_TEST);else{const r=this.maskStack.length!==0?this.maskStack[this.maskStack.length-1]:null,i=r?r._colorMask:15;i!==0&&(r._colorMask=0,n.colorMask(!1,!1,!1,!1)),n.stencilOp(n.KEEP,n.KEEP,n.DECR),e.renderable=!0,e.render(this.renderer),this.renderer.batch.flush(),e.renderable=!1,i!==0&&(r._colorMask=i,n.colorMask((i&1)!==0,(i&2)!==0,(i&4)!==0,(i&8)!==0)),this._useCurrent()}}_useCurrent(){const e=this.renderer.gl;e.stencilFunc(e.EQUAL,this.getStackLength(),4294967295),e.stencilOp(e.KEEP,e.KEEP,e.KEEP)}}f9.extension={type:me.RendererSystem,name:"stencil"};Ce.add(f9);class p9{constructor(e){this.renderer=e,this.plugins={},Object.defineProperties(this.plugins,{extract:{enumerable:!1,get(){return Qe("7.0.0","renderer.plugins.extract has moved to renderer.extract"),e.extract}},prepare:{enumerable:!1,get(){return Qe("7.0.0","renderer.plugins.prepare has moved to renderer.prepare"),e.prepare}},interaction:{enumerable:!1,get(){return Qe("7.0.0","renderer.plugins.interaction has been deprecated, use renderer.events"),e.events}}})}init(){const e=this.rendererPlugins;for(const n in e)this.plugins[n]=new e[n](this.renderer)}destroy(){for(const e in this.plugins)this.plugins[e].destroy(),this.plugins[e]=null}}p9.extension={type:[me.RendererSystem,me.CanvasRendererSystem],name:"_plugin"};Ce.add(p9);class m9{constructor(e){this.renderer=e,this.destinationFrame=null,this.sourceFrame=null,this.defaultFrame=null,this.projectionMatrix=new Ze,this.transform=null}update(e,n,r,i){this.destinationFrame=e||this.destinationFrame||this.defaultFrame,this.sourceFrame=n||this.sourceFrame||e,this.calculateProjection(this.destinationFrame,this.sourceFrame,r,i),this.transform&&this.projectionMatrix.append(this.transform);const s=this.renderer;s.globalUniforms.uniforms.projectionMatrix=this.projectionMatrix,s.globalUniforms.update(),s.shader.shader&&s.shader.syncUniformGroup(s.shader.shader.uniforms.globals)}calculateProjection(e,n,r,i){const s=this.projectionMatrix,o=i?-1:1;s.identity(),s.a=1/n.width*2,s.d=o*(1/n.height*2),s.tx=-1-n.x*s.a,s.ty=-o-n.y*s.d}setTransform(e){}destroy(){this.renderer=null}}m9.extension={type:me.RendererSystem,name:"projection"};Ce.add(m9);const eZ=new JT,G5=new Me;class g9{constructor(e){this.renderer=e,this._tempMatrix=new Ze}generateTexture(e,n){const{region:r,...i}=n||{},s=(r==null?void 0:r.copyTo(G5))||e.getLocalBounds(G5,!0),o=i.resolution||this.renderer.resolution;s.width=Math.max(s.width,1/o),s.height=Math.max(s.height,1/o),i.width=s.width,i.height=s.height,i.resolution=o,i.multisample??(i.multisample=this.renderer.multisample);const a=ta.create(i);this._tempMatrix.tx=-s.x,this._tempMatrix.ty=-s.y;const l=e.transform;return e.transform=eZ,this.renderer.render(e,{renderTexture:a,transform:this._tempMatrix,skipUpdateTransform:!!e.parent,blit:!0}),e.transform=l,a}destroy(){}}g9.extension={type:[me.RendererSystem,me.CanvasRendererSystem],name:"textureGenerator"};Ce.add(g9);const Nl=new Me,Gh=new Me;class y9{constructor(e){this.renderer=e,this.defaultMaskStack=[],this.current=null,this.sourceFrame=new Me,this.destinationFrame=new Me,this.viewportFrame=new Me}contextChange(){var n;const e=(n=this.renderer)==null?void 0:n.gl.getContextAttributes();this._rendererPremultipliedAlpha=!!(e&&e.alpha&&e.premultipliedAlpha)}bind(e=null,n,r){const i=this.renderer;this.current=e;let s,o,a;e?(s=e.baseTexture,a=s.resolution,n||(Nl.width=e.frame.width,Nl.height=e.frame.height,n=Nl),r||(Gh.x=e.frame.x,Gh.y=e.frame.y,Gh.width=n.width,Gh.height=n.height,r=Gh),o=s.framebuffer):(a=i.resolution,n||(Nl.width=i._view.screen.width,Nl.height=i._view.screen.height,n=Nl),r||(r=Nl,r.width=n.width,r.height=n.height));const l=this.viewportFrame;l.x=r.x*a,l.y=r.y*a,l.width=r.width*a,l.height=r.height*a,e||(l.y=i.view.height-(l.y+l.height)),l.ceil(),this.renderer.framebuffer.bind(o,l),this.renderer.projection.update(r,n,a,!o),e?this.renderer.mask.setMaskStack(s.maskStack):this.renderer.mask.setMaskStack(this.defaultMaskStack),this.sourceFrame.copyFrom(n),this.destinationFrame.copyFrom(r)}clear(e,n){const r=this.current?this.current.baseTexture.clear:this.renderer.background.backgroundColor,i=pt.shared.setValue(e||r);(this.current&&this.current.baseTexture.alphaMode>0||!this.current&&this._rendererPremultipliedAlpha)&&i.premultiply(i.alpha);const s=this.destinationFrame,o=this.current?this.current.baseTexture:this.renderer._view.screen,a=s.width!==o.width||s.height!==o.height;if(a){let{x:l,y:c,width:u,height:d}=this.viewportFrame;l=Math.round(l),c=Math.round(c),u=Math.round(u),d=Math.round(d),this.renderer.gl.enable(this.renderer.gl.SCISSOR_TEST),this.renderer.gl.scissor(l,c,u,d)}this.renderer.framebuffer.clear(i.red,i.green,i.blue,i.alpha,n),a&&this.renderer.scissor.pop()}resize(){this.bind(null)}reset(){this.bind(null)}destroy(){this.renderer=null}}y9.extension={type:me.RendererSystem,name:"renderTexture"};Ce.add(y9);class tZ{constructor(e,n){this.program=e,this.uniformData=n,this.uniformGroups={},this.uniformDirtyGroups={},this.uniformBufferBindings={}}destroy(){this.uniformData=null,this.uniformGroups=null,this.uniformDirtyGroups=null,this.uniformBufferBindings=null,this.program=null}}function nZ(t,e){const n={},r=e.getProgramParameter(t,e.ACTIVE_ATTRIBUTES);for(let i=0;i<r;i++){const s=e.getActiveAttrib(t,i);if(s.name.startsWith("gl_"))continue;const o=QR(e,s.type),a={type:o,name:s.name,size:JR(o),location:e.getAttribLocation(t,s.name)};n[s.name]=a}return n}function rZ(t,e){const n={},r=e.getProgramParameter(t,e.ACTIVE_UNIFORMS);for(let i=0;i<r;i++){const s=e.getActiveUniform(t,i),o=s.name.replace(/\[.*?\]$/,""),a=!!s.name.match(/\[.*?\]$/),l=QR(e,s.type);n[o]={name:o,index:i,type:l,size:s.size,isArray:a,value:KR(l,s.size)}}return n}function iZ(t,e){var a;const n=O5(t,t.VERTEX_SHADER,e.vertexSrc),r=O5(t,t.FRAGMENT_SHADER,e.fragmentSrc),i=t.createProgram();t.attachShader(i,n),t.attachShader(i,r);const s=(a=e.extra)==null?void 0:a.transformFeedbackVaryings;if(s&&(typeof t.transformFeedbackVaryings!="function"?console.warn("TransformFeedback is not supported but TransformFeedbackVaryings are given."):t.transformFeedbackVaryings(i,s.names,s.bufferMode==="separate"?t.SEPARATE_ATTRIBS:t.INTERLEAVED_ATTRIBS)),t.linkProgram(i),t.getProgramParameter(i,t.LINK_STATUS)||OY(t,i,n,r),e.attributeData=nZ(i,t),e.uniformData=rZ(i,t),!/^[ \t]*#[ \t]*version[ \t]+300[ \t]+es[ \t]*$/m.test(e.vertexSrc)){const l=Object.keys(e.attributeData);l.sort((c,u)=>c>u?1:-1);for(let c=0;c<l.length;c++)e.attributeData[l[c]].location=c,t.bindAttribLocation(i,c,l[c]);t.linkProgram(i)}t.deleteShader(n),t.deleteShader(r);const o={};for(const l in e.uniformData){const c=e.uniformData[l];o[l]={location:t.getUniformLocation(i,l),value:KR(c.type,c.size)}}return new tZ(i,o)}function sZ(t,e,n,r,i){n.buffer.update(i)}const oZ={float:`
        data[offset] = v;
    `,vec2:`
        data[offset] = v[0];
        data[offset+1] = v[1];
    `,vec3:`
        data[offset] = v[0];
        data[offset+1] = v[1];
        data[offset+2] = v[2];

    `,vec4:`
        data[offset] = v[0];
        data[offset+1] = v[1];
        data[offset+2] = v[2];
        data[offset+3] = v[3];
    `,mat2:`
        data[offset] = v[0];
        data[offset+1] = v[1];

        data[offset+4] = v[2];
        data[offset+5] = v[3];
    `,mat3:`
        data[offset] = v[0];
        data[offset+1] = v[1];
        data[offset+2] = v[2];

        data[offset + 4] = v[3];
        data[offset + 5] = v[4];
        data[offset + 6] = v[5];

        data[offset + 8] = v[6];
        data[offset + 9] = v[7];
        data[offset + 10] = v[8];
    `,mat4:`
        for(var i = 0; i < 16; i++)
        {
            data[offset + i] = v[i];
        }
    `},v9={float:4,vec2:8,vec3:12,vec4:16,int:4,ivec2:8,ivec3:12,ivec4:16,uint:4,uvec2:8,uvec3:12,uvec4:16,bool:4,bvec2:8,bvec3:12,bvec4:16,mat2:16*2,mat3:16*3,mat4:16*4};function aZ(t){const e=t.map(s=>({data:s,offset:0,dataLen:0,dirty:0}));let n=0,r=0,i=0;for(let s=0;s<e.length;s++){const o=e[s];if(n=v9[o.data.type],o.data.size>1&&(n=Math.max(n,16)*o.data.size),o.dataLen=n,r%n!==0&&r<16){const a=r%n%16;r+=a,i+=a}r+n>16?(i=Math.ceil(i/16)*16,o.offset=i,i+=n,r=n):(o.offset=i,r+=n,i+=n)}return i=Math.ceil(i/16)*16,{uboElements:e,size:i}}function lZ(t,e){const n=[];for(const r in t)e[r]&&n.push(e[r]);return n.sort((r,i)=>r.index-i.index),n}function cZ(t,e){if(!t.autoManage)return{size:0,syncFunc:sZ};const n=lZ(t.uniforms,e),{uboElements:r,size:i}=aZ(n),s=[`
    var v = null;
    var v2 = null;
    var cv = null;
    var t = 0;
    var gl = renderer.gl
    var index = 0;
    var data = buffer.data;
    `];for(let o=0;o<r.length;o++){const a=r[o],l=t.uniforms[a.data.name],c=a.data.name;let u=!1;for(let d=0;d<Td.length;d++){const h=Td[d];if(h.codeUbo&&h.test(a.data,l)){s.push(`offset = ${a.offset/4};`,Td[d].codeUbo(a.data.name,l)),u=!0;break}}if(!u)if(a.data.size>1){const d=JR(a.data.type),h=Math.max(v9[a.data.type]/16,1),f=d/h,p=(4-f%4)%4;s.push(`
                cv = ud.${c}.value;
                v = uv.${c};
                offset = ${a.offset/4};

                t = 0;

                for(var i=0; i < ${a.data.size*h}; i++)
                {
                    for(var j = 0; j < ${f}; j++)
                    {
                        data[offset++] = v[t++];
                    }
                    offset += ${p};
                }

                `)}else{const d=oZ[a.data.type];s.push(`
                cv = ud.${c}.value;
                v = uv.${c};
                offset = ${a.offset/4};
                ${d};
                `)}}return s.push(`
       renderer.buffer.update(buffer);
    `),{size:i,syncFunc:new Function("ud","uv","renderer","syncData","buffer",s.join(`
`))}}let uZ=0;const $1={textureCount:0,uboCount:0};class b9{constructor(e){this.destroyed=!1,this.renderer=e,this.systemCheck(),this.gl=null,this.shader=null,this.program=null,this.cache={},this._uboCache={},this.id=uZ++}systemCheck(){if(!NY())throw new Error("Current environment does not allow unsafe-eval, please use @pixi/unsafe-eval module to enable support.")}contextChange(e){this.gl=e,this.reset()}bind(e,n){e.disposeRunner.add(this),e.uniforms.globals=this.renderer.globalUniforms;const r=e.program,i=r.glPrograms[this.renderer.CONTEXT_UID]||this.generateProgram(e);return this.shader=e,this.program!==r&&(this.program=r,this.gl.useProgram(i.program)),n||($1.textureCount=0,$1.uboCount=0,this.syncUniformGroup(e.uniformGroup,$1)),i}setUniforms(e){const n=this.shader.program,r=n.glPrograms[this.renderer.CONTEXT_UID];n.syncUniforms(r.uniformData,e,this.renderer)}syncUniformGroup(e,n){const r=this.getGlProgram();(!e.static||e.dirtyId!==r.uniformDirtyGroups[e.id])&&(r.uniformDirtyGroups[e.id]=e.dirtyId,this.syncUniforms(e,r,n))}syncUniforms(e,n,r){(e.syncUniforms[this.shader.program.id]||this.createSyncGroups(e))(n.uniformData,e.uniforms,this.renderer,r)}createSyncGroups(e){const n=this.getSignature(e,this.shader.program.uniformData,"u");return this.cache[n]||(this.cache[n]=PY(e,this.shader.program.uniformData)),e.syncUniforms[this.shader.program.id]=this.cache[n],e.syncUniforms[this.shader.program.id]}syncUniformBufferGroup(e,n){const r=this.getGlProgram();if(!e.static||e.dirtyId!==0||!r.uniformGroups[e.id]){e.dirtyId=0;const i=r.uniformGroups[e.id]||this.createSyncBufferGroup(e,r,n);e.buffer.update(),i(r.uniformData,e.uniforms,this.renderer,$1,e.buffer)}this.renderer.buffer.bindBufferBase(e.buffer,r.uniformBufferBindings[n])}createSyncBufferGroup(e,n,r){const{gl:i}=this.renderer;this.renderer.buffer.bind(e.buffer);const s=this.gl.getUniformBlockIndex(n.program,r);n.uniformBufferBindings[r]=this.shader.uniformBindCount,i.uniformBlockBinding(n.program,s,this.shader.uniformBindCount),this.shader.uniformBindCount++;const o=this.getSignature(e,this.shader.program.uniformData,"ubo");let a=this._uboCache[o];if(a||(a=this._uboCache[o]=cZ(e,this.shader.program.uniformData)),e.autoManage){const l=new Float32Array(a.size/4);e.buffer.update(l)}return n.uniformGroups[e.id]=a.syncFunc,n.uniformGroups[e.id]}getSignature(e,n,r){const i=e.uniforms,s=[`${r}-`];for(const o in i)s.push(o),n[o]&&s.push(n[o].type);return s.join("-")}getGlProgram(){return this.shader?this.shader.program.glPrograms[this.renderer.CONTEXT_UID]:null}generateProgram(e){const n=this.gl,r=e.program,i=iZ(n,r);return r.glPrograms[this.renderer.CONTEXT_UID]=i,i}reset(){this.program=null,this.shader=null}disposeShader(e){this.shader===e&&(this.shader=null)}destroy(){this.renderer=null,this.destroyed=!0}}b9.extension={type:me.RendererSystem,name:"shader"};Ce.add(b9);class sy{constructor(e){this.renderer=e}run(e){const{renderer:n}=this;n.runners.init.emit(n.options),e.hello&&console.log(`PixiJS 7.3.3 - ${n.rendererLogId} - https://pixijs.com`),n.resize(n.screen.width,n.screen.height)}destroy(){}}sy.defaultOptions={hello:!1},sy.extension={type:[me.RendererSystem,me.CanvasRendererSystem],name:"startup"};Ce.add(sy);function dZ(t,e=[]){return e[Ne.NORMAL]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[Ne.ADD]=[t.ONE,t.ONE],e[Ne.MULTIPLY]=[t.DST_COLOR,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE_MINUS_SRC_ALPHA],e[Ne.SCREEN]=[t.ONE,t.ONE_MINUS_SRC_COLOR,t.ONE,t.ONE_MINUS_SRC_ALPHA],e[Ne.OVERLAY]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[Ne.DARKEN]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[Ne.LIGHTEN]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[Ne.COLOR_DODGE]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[Ne.COLOR_BURN]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[Ne.HARD_LIGHT]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[Ne.SOFT_LIGHT]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[Ne.DIFFERENCE]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[Ne.EXCLUSION]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[Ne.HUE]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[Ne.SATURATION]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[Ne.COLOR]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[Ne.LUMINOSITY]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[Ne.NONE]=[0,0],e[Ne.NORMAL_NPM]=[t.SRC_ALPHA,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE_MINUS_SRC_ALPHA],e[Ne.ADD_NPM]=[t.SRC_ALPHA,t.ONE,t.ONE,t.ONE],e[Ne.SCREEN_NPM]=[t.SRC_ALPHA,t.ONE_MINUS_SRC_COLOR,t.ONE,t.ONE_MINUS_SRC_ALPHA],e[Ne.SRC_IN]=[t.DST_ALPHA,t.ZERO],e[Ne.SRC_OUT]=[t.ONE_MINUS_DST_ALPHA,t.ZERO],e[Ne.SRC_ATOP]=[t.DST_ALPHA,t.ONE_MINUS_SRC_ALPHA],e[Ne.DST_OVER]=[t.ONE_MINUS_DST_ALPHA,t.ONE],e[Ne.DST_IN]=[t.ZERO,t.SRC_ALPHA],e[Ne.DST_OUT]=[t.ZERO,t.ONE_MINUS_SRC_ALPHA],e[Ne.DST_ATOP]=[t.ONE_MINUS_DST_ALPHA,t.SRC_ALPHA],e[Ne.XOR]=[t.ONE_MINUS_DST_ALPHA,t.ONE_MINUS_SRC_ALPHA],e[Ne.SUBTRACT]=[t.ONE,t.ONE,t.ONE,t.ONE,t.FUNC_REVERSE_SUBTRACT,t.FUNC_ADD],e}const hZ=0,fZ=1,pZ=2,mZ=3,gZ=4,yZ=5,_9=class Vw{constructor(){this.gl=null,this.stateId=0,this.polygonOffset=0,this.blendMode=Ne.NONE,this._blendEq=!1,this.map=[],this.map[hZ]=this.setBlend,this.map[fZ]=this.setOffset,this.map[pZ]=this.setCullFace,this.map[mZ]=this.setDepthTest,this.map[gZ]=this.setFrontFace,this.map[yZ]=this.setDepthMask,this.checks=[],this.defaultState=new Ts,this.defaultState.blend=!0}contextChange(e){this.gl=e,this.blendModes=dZ(e),this.set(this.defaultState),this.reset()}set(e){if(e=e||this.defaultState,this.stateId!==e.data){let n=this.stateId^e.data,r=0;for(;n;)n&1&&this.map[r].call(this,!!(e.data&1<<r)),n=n>>1,r++;this.stateId=e.data}for(let n=0;n<this.checks.length;n++)this.checks[n](this,e)}forceState(e){e=e||this.defaultState;for(let n=0;n<this.map.length;n++)this.map[n].call(this,!!(e.data&1<<n));for(let n=0;n<this.checks.length;n++)this.checks[n](this,e);this.stateId=e.data}setBlend(e){this.updateCheck(Vw.checkBlendMode,e),this.gl[e?"enable":"disable"](this.gl.BLEND)}setOffset(e){this.updateCheck(Vw.checkPolygonOffset,e),this.gl[e?"enable":"disable"](this.gl.POLYGON_OFFSET_FILL)}setDepthTest(e){this.gl[e?"enable":"disable"](this.gl.DEPTH_TEST)}setDepthMask(e){this.gl.depthMask(e)}setCullFace(e){this.gl[e?"enable":"disable"](this.gl.CULL_FACE)}setFrontFace(e){this.gl.frontFace(this.gl[e?"CW":"CCW"])}setBlendMode(e){if(e===this.blendMode)return;this.blendMode=e;const n=this.blendModes[e],r=this.gl;n.length===2?r.blendFunc(n[0],n[1]):r.blendFuncSeparate(n[0],n[1],n[2],n[3]),n.length===6?(this._blendEq=!0,r.blendEquationSeparate(n[4],n[5])):this._blendEq&&(this._blendEq=!1,r.blendEquationSeparate(r.FUNC_ADD,r.FUNC_ADD))}setPolygonOffset(e,n){this.gl.polygonOffset(e,n)}reset(){this.gl.pixelStorei(this.gl.UNPACK_FLIP_Y_WEBGL,!1),this.forceState(this.defaultState),this._blendEq=!0,this.blendMode=-1,this.setBlendMode(0)}updateCheck(e,n){const r=this.checks.indexOf(e);n&&r===-1?this.checks.push(e):!n&&r!==-1&&this.checks.splice(r,1)}static checkBlendMode(e,n){e.setBlendMode(n.blendMode)}static checkPolygonOffset(e,n){e.setPolygonOffset(1,n.polygonOffset)}destroy(){this.gl=null}};_9.extension={type:me.RendererSystem,name:"state"};let vZ=_9;Ce.add(vZ);class bZ extends Lm{constructor(){super(...arguments),this.runners={},this._systemsHash={}}setup(e){this.addRunners(...e.runners);const n=(e.priority??[]).filter(i=>e.systems[i]),r=[...n,...Object.keys(e.systems).filter(i=>!n.includes(i))];for(const i of r)this.addSystem(e.systems[i],i)}addRunners(...e){e.forEach(n=>{this.runners[n]=new fs(n)})}addSystem(e,n){const r=new e(this);if(this[n])throw new Error(`Whoops! The name "${n}" is already in use`);this[n]=r,this._systemsHash[n]=r;for(const i in this.runners)this.runners[i].add(r);return this}emitWithCustomOptions(e,n){const r=Object.keys(this._systemsHash);e.items.forEach(i=>{const s=r.find(o=>this._systemsHash[o]===i);i[e.name](n[s])})}destroy(){Object.values(this.runners).forEach(e=>{e.destroy()}),this._systemsHash={}}}const Ef=class Wg{constructor(e){this.renderer=e,this.count=0,this.checkCount=0,this.maxIdle=Wg.defaultMaxIdle,this.checkCountMax=Wg.defaultCheckCountMax,this.mode=Wg.defaultMode}postrender(){this.renderer.objectRenderer.renderingToScreen&&(this.count++,this.mode!==zT.MANUAL&&(this.checkCount++,this.checkCount>this.checkCountMax&&(this.checkCount=0,this.run())))}run(){const e=this.renderer.texture,n=e.managedTextures;let r=!1;for(let i=0;i<n.length;i++){const s=n[i];s.resource&&this.count-s.touched>this.maxIdle&&(e.destroyTexture(s,!0),n[i]=null,r=!0)}if(r){let i=0;for(let s=0;s<n.length;s++)n[s]!==null&&(n[i++]=n[s]);n.length=i}}unload(e){const n=this.renderer.texture,r=e._texture;r&&!r.framebuffer&&n.destroyTexture(r);for(let i=e.children.length-1;i>=0;i--)this.unload(e.children[i])}destroy(){this.renderer=null}};Ef.defaultMode=zT.AUTO,Ef.defaultMaxIdle=60*60,Ef.defaultCheckCountMax=60*10,Ef.extension={type:me.RendererSystem,name:"textureGC"};let Kl=Ef;Ce.add(Kl);class Vb{constructor(e){this.texture=e,this.width=-1,this.height=-1,this.dirtyId=-1,this.dirtyStyleId=-1,this.mipmap=!1,this.wrapMode=33071,this.type=Te.UNSIGNED_BYTE,this.internalFormat=le.RGBA,this.samplerType=0}}function _Z(t){let e;return"WebGL2RenderingContext"in globalThis&&t instanceof globalThis.WebGL2RenderingContext?e={[t.RGB]:be.FLOAT,[t.RGBA]:be.FLOAT,[t.ALPHA]:be.FLOAT,[t.LUMINANCE]:be.FLOAT,[t.LUMINANCE_ALPHA]:be.FLOAT,[t.R8]:be.FLOAT,[t.R8_SNORM]:be.FLOAT,[t.RG8]:be.FLOAT,[t.RG8_SNORM]:be.FLOAT,[t.RGB8]:be.FLOAT,[t.RGB8_SNORM]:be.FLOAT,[t.RGB565]:be.FLOAT,[t.RGBA4]:be.FLOAT,[t.RGB5_A1]:be.FLOAT,[t.RGBA8]:be.FLOAT,[t.RGBA8_SNORM]:be.FLOAT,[t.RGB10_A2]:be.FLOAT,[t.RGB10_A2UI]:be.FLOAT,[t.SRGB8]:be.FLOAT,[t.SRGB8_ALPHA8]:be.FLOAT,[t.R16F]:be.FLOAT,[t.RG16F]:be.FLOAT,[t.RGB16F]:be.FLOAT,[t.RGBA16F]:be.FLOAT,[t.R32F]:be.FLOAT,[t.RG32F]:be.FLOAT,[t.RGB32F]:be.FLOAT,[t.RGBA32F]:be.FLOAT,[t.R11F_G11F_B10F]:be.FLOAT,[t.RGB9_E5]:be.FLOAT,[t.R8I]:be.INT,[t.R8UI]:be.UINT,[t.R16I]:be.INT,[t.R16UI]:be.UINT,[t.R32I]:be.INT,[t.R32UI]:be.UINT,[t.RG8I]:be.INT,[t.RG8UI]:be.UINT,[t.RG16I]:be.INT,[t.RG16UI]:be.UINT,[t.RG32I]:be.INT,[t.RG32UI]:be.UINT,[t.RGB8I]:be.INT,[t.RGB8UI]:be.UINT,[t.RGB16I]:be.INT,[t.RGB16UI]:be.UINT,[t.RGB32I]:be.INT,[t.RGB32UI]:be.UINT,[t.RGBA8I]:be.INT,[t.RGBA8UI]:be.UINT,[t.RGBA16I]:be.INT,[t.RGBA16UI]:be.UINT,[t.RGBA32I]:be.INT,[t.RGBA32UI]:be.UINT,[t.DEPTH_COMPONENT16]:be.FLOAT,[t.DEPTH_COMPONENT24]:be.FLOAT,[t.DEPTH_COMPONENT32F]:be.FLOAT,[t.DEPTH_STENCIL]:be.FLOAT,[t.DEPTH24_STENCIL8]:be.FLOAT,[t.DEPTH32F_STENCIL8]:be.FLOAT}:e={[t.RGB]:be.FLOAT,[t.RGBA]:be.FLOAT,[t.ALPHA]:be.FLOAT,[t.LUMINANCE]:be.FLOAT,[t.LUMINANCE_ALPHA]:be.FLOAT,[t.DEPTH_STENCIL]:be.FLOAT},e}function EZ(t){let e;return"WebGL2RenderingContext"in globalThis&&t instanceof globalThis.WebGL2RenderingContext?e={[Te.UNSIGNED_BYTE]:{[le.RGBA]:t.RGBA8,[le.RGB]:t.RGB8,[le.RG]:t.RG8,[le.RED]:t.R8,[le.RGBA_INTEGER]:t.RGBA8UI,[le.RGB_INTEGER]:t.RGB8UI,[le.RG_INTEGER]:t.RG8UI,[le.RED_INTEGER]:t.R8UI,[le.ALPHA]:t.ALPHA,[le.LUMINANCE]:t.LUMINANCE,[le.LUMINANCE_ALPHA]:t.LUMINANCE_ALPHA},[Te.BYTE]:{[le.RGBA]:t.RGBA8_SNORM,[le.RGB]:t.RGB8_SNORM,[le.RG]:t.RG8_SNORM,[le.RED]:t.R8_SNORM,[le.RGBA_INTEGER]:t.RGBA8I,[le.RGB_INTEGER]:t.RGB8I,[le.RG_INTEGER]:t.RG8I,[le.RED_INTEGER]:t.R8I},[Te.UNSIGNED_SHORT]:{[le.RGBA_INTEGER]:t.RGBA16UI,[le.RGB_INTEGER]:t.RGB16UI,[le.RG_INTEGER]:t.RG16UI,[le.RED_INTEGER]:t.R16UI,[le.DEPTH_COMPONENT]:t.DEPTH_COMPONENT16},[Te.SHORT]:{[le.RGBA_INTEGER]:t.RGBA16I,[le.RGB_INTEGER]:t.RGB16I,[le.RG_INTEGER]:t.RG16I,[le.RED_INTEGER]:t.R16I},[Te.UNSIGNED_INT]:{[le.RGBA_INTEGER]:t.RGBA32UI,[le.RGB_INTEGER]:t.RGB32UI,[le.RG_INTEGER]:t.RG32UI,[le.RED_INTEGER]:t.R32UI,[le.DEPTH_COMPONENT]:t.DEPTH_COMPONENT24},[Te.INT]:{[le.RGBA_INTEGER]:t.RGBA32I,[le.RGB_INTEGER]:t.RGB32I,[le.RG_INTEGER]:t.RG32I,[le.RED_INTEGER]:t.R32I},[Te.FLOAT]:{[le.RGBA]:t.RGBA32F,[le.RGB]:t.RGB32F,[le.RG]:t.RG32F,[le.RED]:t.R32F,[le.DEPTH_COMPONENT]:t.DEPTH_COMPONENT32F},[Te.HALF_FLOAT]:{[le.RGBA]:t.RGBA16F,[le.RGB]:t.RGB16F,[le.RG]:t.RG16F,[le.RED]:t.R16F},[Te.UNSIGNED_SHORT_5_6_5]:{[le.RGB]:t.RGB565},[Te.UNSIGNED_SHORT_4_4_4_4]:{[le.RGBA]:t.RGBA4},[Te.UNSIGNED_SHORT_5_5_5_1]:{[le.RGBA]:t.RGB5_A1},[Te.UNSIGNED_INT_2_10_10_10_REV]:{[le.RGBA]:t.RGB10_A2,[le.RGBA_INTEGER]:t.RGB10_A2UI},[Te.UNSIGNED_INT_10F_11F_11F_REV]:{[le.RGB]:t.R11F_G11F_B10F},[Te.UNSIGNED_INT_5_9_9_9_REV]:{[le.RGB]:t.RGB9_E5},[Te.UNSIGNED_INT_24_8]:{[le.DEPTH_STENCIL]:t.DEPTH24_STENCIL8},[Te.FLOAT_32_UNSIGNED_INT_24_8_REV]:{[le.DEPTH_STENCIL]:t.DEPTH32F_STENCIL8}}:e={[Te.UNSIGNED_BYTE]:{[le.RGBA]:t.RGBA,[le.RGB]:t.RGB,[le.ALPHA]:t.ALPHA,[le.LUMINANCE]:t.LUMINANCE,[le.LUMINANCE_ALPHA]:t.LUMINANCE_ALPHA},[Te.UNSIGNED_SHORT_5_6_5]:{[le.RGB]:t.RGB},[Te.UNSIGNED_SHORT_4_4_4_4]:{[le.RGBA]:t.RGBA},[Te.UNSIGNED_SHORT_5_5_5_1]:{[le.RGBA]:t.RGBA}},e}class E9{constructor(e){this.renderer=e,this.boundTextures=[],this.currentLocation=-1,this.managedTextures=[],this._unknownBoundTextures=!1,this.unknownTexture=new ze,this.hasIntegerTextures=!1}contextChange(){const e=this.gl=this.renderer.gl;this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.webGLVersion=this.renderer.context.webGLVersion,this.internalFormats=EZ(e),this.samplerTypes=_Z(e);const n=e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS);this.boundTextures.length=n;for(let i=0;i<n;i++)this.boundTextures[i]=null;this.emptyTextures={};const r=new Vb(e.createTexture());e.bindTexture(e.TEXTURE_2D,r.texture),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,1,1,0,e.RGBA,e.UNSIGNED_BYTE,new Uint8Array(4)),this.emptyTextures[e.TEXTURE_2D]=r,this.emptyTextures[e.TEXTURE_CUBE_MAP]=new Vb(e.createTexture()),e.bindTexture(e.TEXTURE_CUBE_MAP,this.emptyTextures[e.TEXTURE_CUBE_MAP].texture);for(let i=0;i<6;i++)e.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+i,0,e.RGBA,1,1,0,e.RGBA,e.UNSIGNED_BYTE,null);e.texParameteri(e.TEXTURE_CUBE_MAP,e.TEXTURE_MAG_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_CUBE_MAP,e.TEXTURE_MIN_FILTER,e.LINEAR);for(let i=0;i<this.boundTextures.length;i++)this.bind(null,i)}bind(e,n=0){const{gl:r}=this;if(e=e==null?void 0:e.castToBaseTexture(),(e==null?void 0:e.valid)&&!e.parentTextureArray){e.touched=this.renderer.textureGC.count;const i=e._glTextures[this.CONTEXT_UID]||this.initTexture(e);this.boundTextures[n]!==e&&(this.currentLocation!==n&&(this.currentLocation=n,r.activeTexture(r.TEXTURE0+n)),r.bindTexture(e.target,i.texture)),i.dirtyId!==e.dirtyId?(this.currentLocation!==n&&(this.currentLocation=n,r.activeTexture(r.TEXTURE0+n)),this.updateTexture(e)):i.dirtyStyleId!==e.dirtyStyleId&&this.updateTextureStyle(e),this.boundTextures[n]=e}else this.currentLocation!==n&&(this.currentLocation=n,r.activeTexture(r.TEXTURE0+n)),r.bindTexture(r.TEXTURE_2D,this.emptyTextures[r.TEXTURE_2D].texture),this.boundTextures[n]=null}reset(){this._unknownBoundTextures=!0,this.hasIntegerTextures=!1,this.currentLocation=-1;for(let e=0;e<this.boundTextures.length;e++)this.boundTextures[e]=this.unknownTexture}unbind(e){const{gl:n,boundTextures:r}=this;if(this._unknownBoundTextures){this._unknownBoundTextures=!1;for(let i=0;i<r.length;i++)r[i]===this.unknownTexture&&this.bind(null,i)}for(let i=0;i<r.length;i++)r[i]===e&&(this.currentLocation!==i&&(n.activeTexture(n.TEXTURE0+i),this.currentLocation=i),n.bindTexture(e.target,this.emptyTextures[e.target].texture),r[i]=null)}ensureSamplerType(e){const{boundTextures:n,hasIntegerTextures:r,CONTEXT_UID:i}=this;if(r)for(let s=e-1;s>=0;--s){const o=n[s];o&&o._glTextures[i].samplerType!==be.FLOAT&&this.renderer.texture.unbind(o)}}initTexture(e){const n=new Vb(this.gl.createTexture());return n.dirtyId=-1,e._glTextures[this.CONTEXT_UID]=n,this.managedTextures.push(e),e.on("dispose",this.destroyTexture,this),n}initTextureType(e,n){var r;n.internalFormat=((r=this.internalFormats[e.type])==null?void 0:r[e.format])??e.format,n.samplerType=this.samplerTypes[n.internalFormat]??be.FLOAT,this.webGLVersion===2&&e.type===Te.HALF_FLOAT?n.type=this.gl.HALF_FLOAT:n.type=e.type}updateTexture(e){var i;const n=e._glTextures[this.CONTEXT_UID];if(!n)return;const r=this.renderer;if(this.initTextureType(e,n),(i=e.resource)==null?void 0:i.upload(r,e,n))n.samplerType!==be.FLOAT&&(this.hasIntegerTextures=!0);else{const s=e.realWidth,o=e.realHeight,a=r.gl;(n.width!==s||n.height!==o||n.dirtyId<0)&&(n.width=s,n.height=o,a.texImage2D(e.target,0,n.internalFormat,s,o,0,e.format,n.type,null))}e.dirtyStyleId!==n.dirtyStyleId&&this.updateTextureStyle(e),n.dirtyId=e.dirtyId}destroyTexture(e,n){const{gl:r}=this;if(e=e.castToBaseTexture(),e._glTextures[this.CONTEXT_UID]&&(this.unbind(e),r.deleteTexture(e._glTextures[this.CONTEXT_UID].texture),e.off("dispose",this.destroyTexture,this),delete e._glTextures[this.CONTEXT_UID],!n)){const i=this.managedTextures.indexOf(e);i!==-1&&xd(this.managedTextures,i,1)}}updateTextureStyle(e){var r;const n=e._glTextures[this.CONTEXT_UID];n&&((e.mipmap===ho.POW2||this.webGLVersion!==2)&&!e.isPowerOfTwo?n.mipmap=!1:n.mipmap=e.mipmap>=1,this.webGLVersion!==2&&!e.isPowerOfTwo?n.wrapMode=Go.CLAMP:n.wrapMode=e.wrapMode,(r=e.resource)!=null&&r.style(this.renderer,e,n)||this.setStyle(e,n),n.dirtyStyleId=e.dirtyStyleId)}setStyle(e,n){const r=this.gl;if(n.mipmap&&e.mipmap!==ho.ON_MANUAL&&r.generateMipmap(e.target),r.texParameteri(e.target,r.TEXTURE_WRAP_S,n.wrapMode),r.texParameteri(e.target,r.TEXTURE_WRAP_T,n.wrapMode),n.mipmap){r.texParameteri(e.target,r.TEXTURE_MIN_FILTER,e.scaleMode===No.LINEAR?r.LINEAR_MIPMAP_LINEAR:r.NEAREST_MIPMAP_NEAREST);const i=this.renderer.context.extensions.anisotropicFiltering;if(i&&e.anisotropicLevel>0&&e.scaleMode===No.LINEAR){const s=Math.min(e.anisotropicLevel,r.getParameter(i.MAX_TEXTURE_MAX_ANISOTROPY_EXT));r.texParameterf(e.target,i.TEXTURE_MAX_ANISOTROPY_EXT,s)}}else r.texParameteri(e.target,r.TEXTURE_MIN_FILTER,e.scaleMode===No.LINEAR?r.LINEAR:r.NEAREST);r.texParameteri(e.target,r.TEXTURE_MAG_FILTER,e.scaleMode===No.LINEAR?r.LINEAR:r.NEAREST)}destroy(){this.renderer=null}}E9.extension={type:me.RendererSystem,name:"texture"};Ce.add(E9);class w9{constructor(e){this.renderer=e}contextChange(){this.gl=this.renderer.gl,this.CONTEXT_UID=this.renderer.CONTEXT_UID}bind(e){const{gl:n,CONTEXT_UID:r}=this,i=e._glTransformFeedbacks[r]||this.createGLTransformFeedback(e);n.bindTransformFeedback(n.TRANSFORM_FEEDBACK,i)}unbind(){const{gl:e}=this;e.bindTransformFeedback(e.TRANSFORM_FEEDBACK,null)}beginTransformFeedback(e,n){const{gl:r,renderer:i}=this;n&&i.shader.bind(n),r.beginTransformFeedback(e)}endTransformFeedback(){const{gl:e}=this;e.endTransformFeedback()}createGLTransformFeedback(e){const{gl:n,renderer:r,CONTEXT_UID:i}=this,s=n.createTransformFeedback();e._glTransformFeedbacks[i]=s,n.bindTransformFeedback(n.TRANSFORM_FEEDBACK,s);for(let o=0;o<e.buffers.length;o++){const a=e.buffers[o];a&&(r.buffer.update(a),a._glBuffers[i].refCount++,n.bindBufferBase(n.TRANSFORM_FEEDBACK_BUFFER,o,a._glBuffers[i].buffer||null))}return n.bindTransformFeedback(n.TRANSFORM_FEEDBACK,null),e.disposeRunner.add(this),s}disposeTransformFeedback(e,n){const r=e._glTransformFeedbacks[this.CONTEXT_UID],i=this.gl;e.disposeRunner.remove(this);const s=this.renderer.buffer;if(s)for(let o=0;o<e.buffers.length;o++){const a=e.buffers[o];if(!a)continue;const l=a._glBuffers[this.CONTEXT_UID];l&&(l.refCount--,l.refCount===0&&!n&&s.dispose(a,n))}r&&(n||i.deleteTransformFeedback(r),delete e._glTransformFeedbacks[this.CONTEXT_UID])}destroy(){this.renderer=null}}w9.extension={type:me.RendererSystem,name:"transformFeedback"};Ce.add(w9);class oy{constructor(e){this.renderer=e}init(e){this.screen=new Me(0,0,e.width,e.height),this.element=e.view||_e.ADAPTER.createCanvas(),this.resolution=e.resolution||_e.RESOLUTION,this.autoDensity=!!e.autoDensity}resizeView(e,n){this.element.width=Math.round(e*this.resolution),this.element.height=Math.round(n*this.resolution);const r=this.element.width/this.resolution,i=this.element.height/this.resolution;this.screen.width=r,this.screen.height=i,this.autoDensity&&(this.element.style.width=`${r}px`,this.element.style.height=`${i}px`),this.renderer.emit("resize",r,i),this.renderer.runners.resize.emit(this.screen.width,this.screen.height)}destroy(e){var n;e&&((n=this.element.parentNode)==null||n.removeChild(this.element)),this.renderer=null,this.element=null,this.screen=null}}oy.defaultOptions={width:800,height:600,resolution:void 0,autoDensity:!1},oy.extension={type:[me.RendererSystem,me.CanvasRendererSystem],name:"_view"};Ce.add(oy);_e.PREFER_ENV=cu.WEBGL2;_e.STRICT_TEXTURE_CACHE=!1;_e.RENDER_OPTIONS={...iy.defaultOptions,...ry.defaultOptions,...oy.defaultOptions,...sy.defaultOptions};Object.defineProperties(_e,{WRAP_MODE:{get(){return ze.defaultOptions.wrapMode},set(t){Qe("7.1.0","settings.WRAP_MODE is deprecated, use BaseTexture.defaultOptions.wrapMode"),ze.defaultOptions.wrapMode=t}},SCALE_MODE:{get(){return ze.defaultOptions.scaleMode},set(t){Qe("7.1.0","settings.SCALE_MODE is deprecated, use BaseTexture.defaultOptions.scaleMode"),ze.defaultOptions.scaleMode=t}},MIPMAP_TEXTURES:{get(){return ze.defaultOptions.mipmap},set(t){Qe("7.1.0","settings.MIPMAP_TEXTURES is deprecated, use BaseTexture.defaultOptions.mipmap"),ze.defaultOptions.mipmap=t}},ANISOTROPIC_LEVEL:{get(){return ze.defaultOptions.anisotropicLevel},set(t){Qe("7.1.0","settings.ANISOTROPIC_LEVEL is deprecated, use BaseTexture.defaultOptions.anisotropicLevel"),ze.defaultOptions.anisotropicLevel=t}},FILTER_RESOLUTION:{get(){return Qe("7.1.0","settings.FILTER_RESOLUTION is deprecated, use Filter.defaultResolution"),Lr.defaultResolution},set(t){Lr.defaultResolution=t}},FILTER_MULTISAMPLE:{get(){return Qe("7.1.0","settings.FILTER_MULTISAMPLE is deprecated, use Filter.defaultMultisample"),Lr.defaultMultisample},set(t){Lr.defaultMultisample=t}},SPRITE_MAX_TEXTURES:{get(){return Zl.defaultMaxTextures},set(t){Qe("7.1.0","settings.SPRITE_MAX_TEXTURES is deprecated, use BatchRenderer.defaultMaxTextures"),Zl.defaultMaxTextures=t}},SPRITE_BATCH_SIZE:{get(){return Zl.defaultBatchSize},set(t){Qe("7.1.0","settings.SPRITE_BATCH_SIZE is deprecated, use BatchRenderer.defaultBatchSize"),Zl.defaultBatchSize=t}},CAN_UPLOAD_SAME_BUFFER:{get(){return Zl.canUploadSameBuffer},set(t){Qe("7.1.0","settings.CAN_UPLOAD_SAME_BUFFER is deprecated, use BatchRenderer.canUploadSameBuffer"),Zl.canUploadSameBuffer=t}},GC_MODE:{get(){return Kl.defaultMode},set(t){Qe("7.1.0","settings.GC_MODE is deprecated, use TextureGCSystem.defaultMode"),Kl.defaultMode=t}},GC_MAX_IDLE:{get(){return Kl.defaultMaxIdle},set(t){Qe("7.1.0","settings.GC_MAX_IDLE is deprecated, use TextureGCSystem.defaultMaxIdle"),Kl.defaultMaxIdle=t}},GC_MAX_CHECK_COUNT:{get(){return Kl.defaultCheckCountMax},set(t){Qe("7.1.0","settings.GC_MAX_CHECK_COUNT is deprecated, use TextureGCSystem.defaultCheckCountMax"),Kl.defaultCheckCountMax=t}},PRECISION_VERTEX:{get(){return no.defaultVertexPrecision},set(t){Qe("7.1.0","settings.PRECISION_VERTEX is deprecated, use Program.defaultVertexPrecision"),no.defaultVertexPrecision=t}},PRECISION_FRAGMENT:{get(){return no.defaultFragmentPrecision},set(t){Qe("7.1.0","settings.PRECISION_FRAGMENT is deprecated, use Program.defaultFragmentPrecision"),no.defaultFragmentPrecision=t}}});var Vc=(t=>(t[t.INTERACTION=50]="INTERACTION",t[t.HIGH=25]="HIGH",t[t.NORMAL=0]="NORMAL",t[t.LOW=-25]="LOW",t[t.UTILITY=-50]="UTILITY",t))(Vc||{});class Wb{constructor(e,n=null,r=0,i=!1){this.next=null,this.previous=null,this._destroyed=!1,this.fn=e,this.context=n,this.priority=r,this.once=i}match(e,n=null){return this.fn===e&&this.context===n}emit(e){this.fn&&(this.context?this.fn.call(this.context,e):this.fn(e));const n=this.next;return this.once&&this.destroy(!0),this._destroyed&&(this.next=null),n}connect(e){this.previous=e,e.next&&(e.next.previous=this),this.next=e.next,e.next=this}destroy(e=!1){this._destroyed=!0,this.fn=null,this.context=null,this.previous&&(this.previous.next=this.next),this.next&&(this.next.previous=this.previous);const n=this.next;return this.next=e?null:n,this.previous=null,n}}const x9=class Qr{constructor(){this.autoStart=!1,this.deltaTime=1,this.lastTime=-1,this.speed=1,this.started=!1,this._requestId=null,this._maxElapsedMS=100,this._minElapsedMS=0,this._protected=!1,this._lastFrame=-1,this._head=new Wb(null,null,1/0),this.deltaMS=1/Qr.targetFPMS,this.elapsedMS=1/Qr.targetFPMS,this._tick=e=>{this._requestId=null,this.started&&(this.update(e),this.started&&this._requestId===null&&this._head.next&&(this._requestId=requestAnimationFrame(this._tick)))}}_requestIfNeeded(){this._requestId===null&&this._head.next&&(this.lastTime=performance.now(),this._lastFrame=this.lastTime,this._requestId=requestAnimationFrame(this._tick))}_cancelIfNeeded(){this._requestId!==null&&(cancelAnimationFrame(this._requestId),this._requestId=null)}_startIfPossible(){this.started?this._requestIfNeeded():this.autoStart&&this.start()}add(e,n,r=Vc.NORMAL){return this._addListener(new Wb(e,n,r))}addOnce(e,n,r=Vc.NORMAL){return this._addListener(new Wb(e,n,r,!0))}_addListener(e){let n=this._head.next,r=this._head;if(!n)e.connect(r);else{for(;n;){if(e.priority>n.priority){e.connect(r);break}r=n,n=n.next}e.previous||e.connect(r)}return this._startIfPossible(),this}remove(e,n){let r=this._head.next;for(;r;)r.match(e,n)?r=r.destroy():r=r.next;return this._head.next||this._cancelIfNeeded(),this}get count(){if(!this._head)return 0;let e=0,n=this._head;for(;n=n.next;)e++;return e}start(){this.started||(this.started=!0,this._requestIfNeeded())}stop(){this.started&&(this.started=!1,this._cancelIfNeeded())}destroy(){if(!this._protected){this.stop();let e=this._head.next;for(;e;)e=e.destroy(!0);this._head.destroy(),this._head=null}}update(e=performance.now()){let n;if(e>this.lastTime){if(n=this.elapsedMS=e-this.lastTime,n>this._maxElapsedMS&&(n=this._maxElapsedMS),n*=this.speed,this._minElapsedMS){const s=e-this._lastFrame|0;if(s<this._minElapsedMS)return;this._lastFrame=e-s%this._minElapsedMS}this.deltaMS=n,this.deltaTime=this.deltaMS*Qr.targetFPMS;const r=this._head;let i=r.next;for(;i;)i=i.emit(this.deltaTime);r.next||this._cancelIfNeeded()}else this.deltaTime=this.deltaMS=this.elapsedMS=0;this.lastTime=e}get FPS(){return 1e3/this.elapsedMS}get minFPS(){return 1e3/this._maxElapsedMS}set minFPS(e){const n=Math.min(this.maxFPS,e),r=Math.min(Math.max(0,n)/1e3,Qr.targetFPMS);this._maxElapsedMS=1/r}get maxFPS(){return this._minElapsedMS?Math.round(1e3/this._minElapsedMS):0}set maxFPS(e){if(e===0)this._minElapsedMS=0;else{const n=Math.max(this.minFPS,e);this._minElapsedMS=1/(n/1e3)}}static get shared(){if(!Qr._shared){const e=Qr._shared=new Qr;e.autoStart=!0,e._protected=!0}return Qr._shared}static get system(){if(!Qr._system){const e=Qr._system=new Qr;e.autoStart=!0,e._protected=!0}return Qr._system}};x9.targetFPMS=.06;let ci=x9;Object.defineProperties(_e,{TARGET_FPMS:{get(){return ci.targetFPMS},set(t){Qe("7.1.0","settings.TARGET_FPMS is deprecated, use Ticker.targetFPMS"),ci.targetFPMS=t}}});class T9{static init(e){e=Object.assign({autoStart:!0,sharedTicker:!1},e),Object.defineProperty(this,"ticker",{set(n){this._ticker&&this._ticker.remove(this.render,this),this._ticker=n,n&&n.add(this.render,this,Vc.LOW)},get(){return this._ticker}}),this.stop=()=>{this._ticker.stop()},this.start=()=>{this._ticker.start()},this._ticker=null,this.ticker=e.sharedTicker?ci.shared:new ci,e.autoStart&&this.start()}static destroy(){if(this._ticker){const e=this._ticker;this.ticker=null,e.destroy()}}}T9.extension=me.Application;Ce.add(T9);const S9=[];Ce.handleByList(me.Renderer,S9);function wZ(t){for(const e of S9)if(e.test(t))return new e(t);throw new Error("Unable to auto-detect a suitable renderer.")}var xZ=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
    vTextureCoord = aTextureCoord;
}`,TZ=`attribute vec2 aVertexPosition;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

uniform vec4 inputSize;
uniform vec4 outputFrame;

vec4 filterVertexPosition( void )
{
    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
}

vec2 filterTextureCoord( void )
{
    return aVertexPosition * (outputFrame.zw * inputSize.zw);
}

void main(void)
{
    gl_Position = filterVertexPosition();
    vTextureCoord = filterTextureCoord();
}
`;const SZ=xZ,C9=TZ;class I9{constructor(e){this.renderer=e}contextChange(e){let n;if(this.renderer.context.webGLVersion===1){const r=e.getParameter(e.FRAMEBUFFER_BINDING);e.bindFramebuffer(e.FRAMEBUFFER,null),n=e.getParameter(e.SAMPLES),e.bindFramebuffer(e.FRAMEBUFFER,r)}else{const r=e.getParameter(e.DRAW_FRAMEBUFFER_BINDING);e.bindFramebuffer(e.DRAW_FRAMEBUFFER,null),n=e.getParameter(e.SAMPLES),e.bindFramebuffer(e.DRAW_FRAMEBUFFER,r)}n>=dn.HIGH?this.multisample=dn.HIGH:n>=dn.MEDIUM?this.multisample=dn.MEDIUM:n>=dn.LOW?this.multisample=dn.LOW:this.multisample=dn.NONE}destroy(){}}I9.extension={type:me.RendererSystem,name:"_multisample"};Ce.add(I9);class CZ{constructor(e){this.buffer=e||null,this.updateID=-1,this.byteLength=-1,this.refCount=0}}class A9{constructor(e){this.renderer=e,this.managedBuffers={},this.boundBufferBases={}}destroy(){this.renderer=null}contextChange(){this.disposeAll(!0),this.gl=this.renderer.gl,this.CONTEXT_UID=this.renderer.CONTEXT_UID}bind(e){const{gl:n,CONTEXT_UID:r}=this,i=e._glBuffers[r]||this.createGLBuffer(e);n.bindBuffer(e.type,i.buffer)}unbind(e){const{gl:n}=this;n.bindBuffer(e,null)}bindBufferBase(e,n){const{gl:r,CONTEXT_UID:i}=this;if(this.boundBufferBases[n]!==e){const s=e._glBuffers[i]||this.createGLBuffer(e);this.boundBufferBases[n]=e,r.bindBufferBase(r.UNIFORM_BUFFER,n,s.buffer)}}bindBufferRange(e,n,r){const{gl:i,CONTEXT_UID:s}=this;r=r||0;const o=e._glBuffers[s]||this.createGLBuffer(e);i.bindBufferRange(i.UNIFORM_BUFFER,n||0,o.buffer,r*256,256)}update(e){const{gl:n,CONTEXT_UID:r}=this,i=e._glBuffers[r]||this.createGLBuffer(e);if(e._updateID!==i.updateID)if(i.updateID=e._updateID,n.bindBuffer(e.type,i.buffer),i.byteLength>=e.data.byteLength)n.bufferSubData(e.type,0,e.data);else{const s=e.static?n.STATIC_DRAW:n.DYNAMIC_DRAW;i.byteLength=e.data.byteLength,n.bufferData(e.type,e.data,s)}}dispose(e,n){if(!this.managedBuffers[e.id])return;delete this.managedBuffers[e.id];const r=e._glBuffers[this.CONTEXT_UID],i=this.gl;e.disposeRunner.remove(this),r&&(n||i.deleteBuffer(r.buffer),delete e._glBuffers[this.CONTEXT_UID])}disposeAll(e){const n=Object.keys(this.managedBuffers);for(let r=0;r<n.length;r++)this.dispose(this.managedBuffers[n[r]],e)}createGLBuffer(e){const{CONTEXT_UID:n,gl:r}=this;return e._glBuffers[n]=new CZ(r.createBuffer()),this.managedBuffers[e.id]=e,e.disposeRunner.add(this),e._glBuffers[n]}}A9.extension={type:me.RendererSystem,name:"buffer"};Ce.add(A9);class k9{constructor(e){this.renderer=e}render(e,n){const r=this.renderer;let i,s,o,a;if(n&&(i=n.renderTexture,s=n.clear,o=n.transform,a=n.skipUpdateTransform),this.renderingToScreen=!i,r.runners.prerender.emit(),r.emit("prerender"),r.projection.transform=o,!r.context.isLost){if(i||(this.lastObjectRendered=e),!a){const l=e.enableTempParent();e.updateTransform(),e.disableTempParent(l)}r.renderTexture.bind(i),r.batch.currentRenderer.start(),(s??r.background.clearBeforeRender)&&r.renderTexture.clear(),e.render(r),r.batch.currentRenderer.flush(),i&&(n.blit&&r.framebuffer.blit(),i.baseTexture.update()),r.runners.postrender.emit(),r.projection.transform=null,r.emit("postrender")}}destroy(){this.renderer=null,this.lastObjectRendered=null}}k9.extension={type:me.RendererSystem,name:"objectRenderer"};Ce.add(k9);const jg=class Ww extends bZ{constructor(e){super(),this.type=bR.WEBGL,e=Object.assign({},_e.RENDER_OPTIONS,e),this.gl=null,this.CONTEXT_UID=0,this.globalUniforms=new ps({projectionMatrix:new Ze},!0);const n={runners:["init","destroy","contextChange","resolutionChange","reset","update","postrender","prerender","resize"],systems:Ww.__systems,priority:["_view","textureGenerator","background","_plugin","startup","context","state","texture","buffer","geometry","framebuffer","transformFeedback","mask","scissor","stencil","projection","textureGC","filter","renderTexture","batch","objectRenderer","_multisample"]};this.setup(n),"useContextAlpha"in e&&(Qe("7.0.0","options.useContextAlpha is deprecated, use options.premultipliedAlpha and options.backgroundAlpha instead"),e.premultipliedAlpha=e.useContextAlpha&&e.useContextAlpha!=="notMultiplied",e.backgroundAlpha=e.useContextAlpha===!1?1:e.backgroundAlpha),this._plugin.rendererPlugins=Ww.__plugins,this.options=e,this.startup.run(this.options)}static test(e){return e!=null&&e.forceCanvas?!1:ZX()}render(e,n){this.objectRenderer.render(e,n)}resize(e,n){this._view.resizeView(e,n)}reset(){return this.runners.reset.emit(),this}clear(){this.renderTexture.bind(),this.renderTexture.clear()}destroy(e=!1){this.runners.destroy.items.reverse(),this.emitWithCustomOptions(this.runners.destroy,{_view:e}),super.destroy()}get plugins(){return this._plugin.plugins}get multisample(){return this._multisample.multisample}get width(){return this._view.element.width}get height(){return this._view.element.height}get resolution(){return this._view.resolution}set resolution(e){this._view.resolution=e,this.runners.resolutionChange.emit(e)}get autoDensity(){return this._view.autoDensity}get view(){return this._view.element}get screen(){return this._view.screen}get lastObjectRendered(){return this.objectRenderer.lastObjectRendered}get renderingToScreen(){return this.objectRenderer.renderingToScreen}get rendererLogId(){return`WebGL ${this.context.webGLVersion}`}get clearBeforeRender(){return Qe("7.0.0","renderer.clearBeforeRender has been deprecated, please use renderer.background.clearBeforeRender instead."),this.background.clearBeforeRender}get useContextAlpha(){return Qe("7.0.0","renderer.useContextAlpha has been deprecated, please use renderer.context.premultipliedAlpha instead."),this.context.useContextAlpha}get preserveDrawingBuffer(){return Qe("7.0.0","renderer.preserveDrawingBuffer has been deprecated, we cannot truly know this unless pixi created the context"),this.context.preserveDrawingBuffer}get backgroundColor(){return Qe("7.0.0","renderer.backgroundColor has been deprecated, use renderer.background.color instead."),this.background.color}set backgroundColor(e){Qe("7.0.0","renderer.backgroundColor has been deprecated, use renderer.background.color instead."),this.background.color=e}get backgroundAlpha(){return Qe("7.0.0","renderer.backgroundAlpha has been deprecated, use renderer.background.alpha instead."),this.background.alpha}set backgroundAlpha(e){Qe("7.0.0","renderer.backgroundAlpha has been deprecated, use renderer.background.alpha instead."),this.background.alpha=e}get powerPreference(){return Qe("7.0.0","renderer.powerPreference has been deprecated, we can only know this if pixi creates the context"),this.context.powerPreference}generateTexture(e,n){return this.textureGenerator.generateTexture(e,n)}};jg.extension={type:me.Renderer,priority:1},jg.__plugins={},jg.__systems={};let eS=jg;Ce.handleByMap(me.RendererPlugin,eS.__plugins);Ce.handleByMap(me.RendererSystem,eS.__systems);Ce.add(eS);class M9 extends Hp{constructor(e,n){const{width:r,height:i}=n||{};super(r,i),this.items=[],this.itemDirtyIds=[];for(let s=0;s<e;s++){const o=new ze;this.items.push(o),this.itemDirtyIds.push(-2)}this.length=e,this._load=null,this.baseTexture=null}initFromArray(e,n){for(let r=0;r<this.length;r++)e[r]&&(e[r].castToBaseTexture?this.addBaseTextureAt(e[r].castToBaseTexture(),r):e[r]instanceof Hp?this.addResourceAt(e[r],r):this.addResourceAt(jR(e[r],n),r))}dispose(){for(let e=0,n=this.length;e<n;e++)this.items[e].destroy();this.items=null,this.itemDirtyIds=null,this._load=null}addResourceAt(e,n){if(!this.items[n])throw new Error(`Index ${n} is out of bounds`);return e.valid&&!this.valid&&this.resize(e.width,e.height),this.items[n].setResource(e),this}bind(e){if(this.baseTexture!==null)throw new Error("Only one base texture per TextureArray is allowed");super.bind(e);for(let n=0;n<this.length;n++)this.items[n].parentTextureArray=e,this.items[n].on("update",e.update,e)}unbind(e){super.unbind(e);for(let n=0;n<this.length;n++)this.items[n].parentTextureArray=null,this.items[n].off("update",e.update,e)}load(){if(this._load)return this._load;const e=this.items.map(n=>n.resource).filter(n=>n).map(n=>n.load());return this._load=Promise.all(e).then(()=>{const{realWidth:n,realHeight:r}=this.items[0];return this.resize(n,r),this.update(),Promise.resolve(this)}),this._load}}class IZ extends M9{constructor(e,n){const{width:r,height:i}=n||{};let s,o;Array.isArray(e)?(s=e,o=e.length):o=e,super(o,{width:r,height:i}),s&&this.initFromArray(s,n)}addBaseTextureAt(e,n){if(e.resource)this.addResourceAt(e.resource,n);else throw new Error("ArrayResource does not support RenderTexture");return this}bind(e){super.bind(e),e.target=_d.TEXTURE_2D_ARRAY}upload(e,n,r){const{length:i,itemDirtyIds:s,items:o}=this,{gl:a}=e;r.dirtyId<0&&a.texImage3D(a.TEXTURE_2D_ARRAY,0,r.internalFormat,this._width,this._height,i,0,n.format,r.type,null);for(let l=0;l<i;l++){const c=o[l];s[l]<c.dirtyId&&(s[l]=c.dirtyId,c.valid&&a.texSubImage3D(a.TEXTURE_2D_ARRAY,0,0,0,l,c.resource.width,c.resource.height,1,n.format,r.type,c.resource.source))}return!0}}class AZ extends ml{constructor(e){super(e)}static test(e){const{OffscreenCanvas:n}=globalThis;return n&&e instanceof n?!0:globalThis.HTMLCanvasElement&&e instanceof HTMLCanvasElement}}const P9=class wf extends M9{constructor(e,n){const{width:r,height:i,autoLoad:s,linkBaseTexture:o}=n||{};if(e&&e.length!==wf.SIDES)throw new Error(`Invalid length. Got ${e.length}, expected 6`);super(6,{width:r,height:i});for(let a=0;a<wf.SIDES;a++)this.items[a].target=_d.TEXTURE_CUBE_MAP_POSITIVE_X+a;this.linkBaseTexture=o!==!1,e&&this.initFromArray(e,n),s!==!1&&this.load()}bind(e){super.bind(e),e.target=_d.TEXTURE_CUBE_MAP}addBaseTextureAt(e,n,r){if(r===void 0&&(r=this.linkBaseTexture),!this.items[n])throw new Error(`Index ${n} is out of bounds`);if(!this.linkBaseTexture||e.parentTextureArray||Object.keys(e._glTextures).length>0)if(e.resource)this.addResourceAt(e.resource,n);else throw new Error("CubeResource does not support copying of renderTexture.");else e.target=_d.TEXTURE_CUBE_MAP_POSITIVE_X+n,e.parentTextureArray=this.baseTexture,this.items[n]=e;return e.valid&&!this.valid&&this.resize(e.realWidth,e.realHeight),this.items[n]=e,this}upload(e,n,r){const i=this.itemDirtyIds;for(let s=0;s<wf.SIDES;s++){const o=this.items[s];(i[s]<o.dirtyId||r.dirtyId<n.dirtyId)&&(o.valid&&o.resource?(o.resource.upload(e,o,r),i[s]=o.dirtyId):i[s]<-1&&(e.gl.texImage2D(o.target,0,r.internalFormat,n.realWidth,n.realHeight,0,n.format,r.type,null),i[s]=-1))}return!0}static test(e){return Array.isArray(e)&&e.length===wf.SIDES}};P9.SIDES=6;let kZ=P9;class id extends ml{constructor(e,n){n=n||{};let r,i,s;typeof e=="string"?(r=id.EMPTY,i=e,s=!0):(r=e,i=null,s=!1),super(r),this.url=i,this.crossOrigin=n.crossOrigin??!0,this.alphaMode=typeof n.alphaMode=="number"?n.alphaMode:null,this.ownsImageBitmap=n.ownsImageBitmap??s,this._load=null,n.autoLoad!==!1&&this.load()}load(){return this._load?this._load:(this._load=new Promise(async(e,n)=>{if(this.url===null){e(this);return}try{const r=await _e.ADAPTER.fetch(this.url,{mode:this.crossOrigin?"cors":"no-cors"});if(this.destroyed)return;const i=await r.blob();if(this.destroyed)return;const s=await createImageBitmap(i,{premultiplyAlpha:this.alphaMode===null||this.alphaMode===zr.UNPACK?"premultiply":"none"});if(this.destroyed){s.close();return}this.source=s,this.update(),e(this)}catch(r){if(this.destroyed)return;n(r),this.onError.emit(r)}}),this._load)}upload(e,n,r){return this.source instanceof ImageBitmap?(typeof this.alphaMode=="number"&&(n.alphaMode=this.alphaMode),super.upload(e,n,r)):(this.load(),!1)}dispose(){this.ownsImageBitmap&&this.source instanceof ImageBitmap&&this.source.close(),super.dispose(),this._load=null}static test(e){return!!globalThis.createImageBitmap&&typeof ImageBitmap<"u"&&(typeof e=="string"||e instanceof ImageBitmap)}static get EMPTY(){return id._EMPTY=id._EMPTY??_e.ADAPTER.createCanvas(0,0),id._EMPTY}}const jw=class Xg extends ml{constructor(e,n){n=n||{},super(_e.ADAPTER.createCanvas()),this._width=0,this._height=0,this.svg=e,this.scale=n.scale||1,this._overrideWidth=n.width,this._overrideHeight=n.height,this._resolve=null,this._crossorigin=n.crossorigin,this._load=null,n.autoLoad!==!1&&this.load()}load(){return this._load?this._load:(this._load=new Promise(e=>{if(this._resolve=()=>{this.update(),e(this)},Xg.SVG_XML.test(this.svg.trim())){if(!btoa)throw new Error("Your browser doesn't support base64 conversions.");this.svg=`data:image/svg+xml;base64,${btoa(unescape(encodeURIComponent(this.svg)))}`}this._loadSvg()}),this._load)}_loadSvg(){const e=new Image;ml.crossOrigin(e,this.svg,this._crossorigin),e.src=this.svg,e.onerror=n=>{this._resolve&&(e.onerror=null,this.onError.emit(n))},e.onload=()=>{if(!this._resolve)return;const n=e.width,r=e.height;if(!n||!r)throw new Error("The SVG image must have width and height defined (in pixels), canvas API needs them.");let i=n*this.scale,s=r*this.scale;(this._overrideWidth||this._overrideHeight)&&(i=this._overrideWidth||this._overrideHeight/r*n,s=this._overrideHeight||this._overrideWidth/n*r),i=Math.round(i),s=Math.round(s);const o=this.source;o.width=i,o.height=s,o._pixiId=`canvas_${Gc()}`,o.getContext("2d").drawImage(e,0,0,n,r,0,0,i,s),this._resolve(),this._resolve=null}}static getSize(e){const n=Xg.SVG_SIZE.exec(e),r={};return n&&(r[n[1]]=Math.round(parseFloat(n[3])),r[n[5]]=Math.round(parseFloat(n[7]))),r}dispose(){super.dispose(),this._resolve=null,this._crossorigin=null}static test(e,n){return n==="svg"||typeof e=="string"&&e.startsWith("data:image/svg+xml")||typeof e=="string"&&Xg.SVG_XML.test(e)}};jw.SVG_XML=/^(<\?xml[^?]+\?>)?\s*(<!--[^(-->)]*-->)?\s*\<svg/m,jw.SVG_SIZE=/<svg[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*>/i;let Xw=jw;const Yw=class Zw extends ml{constructor(e,n){if(n=n||{},!(e instanceof HTMLVideoElement)){const r=document.createElement("video");n.autoLoad!==!1&&r.setAttribute("preload","auto"),n.playsinline!==!1&&(r.setAttribute("webkit-playsinline",""),r.setAttribute("playsinline","")),n.muted===!0&&(r.setAttribute("muted",""),r.muted=!0),n.loop===!0&&r.setAttribute("loop",""),n.autoPlay!==!1&&r.setAttribute("autoplay",""),typeof e=="string"&&(e=[e]);const i=e[0].src||e[0];ml.crossOrigin(r,i,n.crossorigin);for(let s=0;s<e.length;++s){const o=document.createElement("source");let{src:a,mime:l}=e[s];if(a=a||e[s],a.startsWith("data:"))l=a.slice(5,a.indexOf(";"));else if(!a.startsWith("blob:")){const c=a.split("?").shift().toLowerCase(),u=c.slice(c.lastIndexOf(".")+1);l=l||Zw.MIME_TYPES[u]||`video/${u}`}o.src=a,l&&(o.type=l),r.appendChild(o)}e=r}super(e),this.noSubImage=!0,this._autoUpdate=!0,this._isConnectedToTicker=!1,this._updateFPS=n.updateFPS||0,this._msToNextUpdate=0,this.autoPlay=n.autoPlay!==!1,this._videoFrameRequestCallback=this._videoFrameRequestCallback.bind(this),this._videoFrameRequestCallbackHandle=null,this._load=null,this._resolve=null,this._reject=null,this._onCanPlay=this._onCanPlay.bind(this),this._onError=this._onError.bind(this),this._onPlayStart=this._onPlayStart.bind(this),this._onPlayStop=this._onPlayStop.bind(this),this._onSeeked=this._onSeeked.bind(this),n.autoLoad!==!1&&this.load()}update(e=0){if(!this.destroyed){if(this._updateFPS){const n=ci.shared.elapsedMS*this.source.playbackRate;this._msToNextUpdate=Math.floor(this._msToNextUpdate-n)}(!this._updateFPS||this._msToNextUpdate<=0)&&(super.update(),this._msToNextUpdate=this._updateFPS?Math.floor(1e3/this._updateFPS):0)}}_videoFrameRequestCallback(){this.update(),this.destroyed?this._videoFrameRequestCallbackHandle=null:this._videoFrameRequestCallbackHandle=this.source.requestVideoFrameCallback(this._videoFrameRequestCallback)}load(){if(this._load)return this._load;const e=this.source;return(e.readyState===e.HAVE_ENOUGH_DATA||e.readyState===e.HAVE_FUTURE_DATA)&&e.width&&e.height&&(e.complete=!0),e.addEventListener("play",this._onPlayStart),e.addEventListener("pause",this._onPlayStop),e.addEventListener("seeked",this._onSeeked),this._isSourceReady()?this._onCanPlay():(e.addEventListener("canplay",this._onCanPlay),e.addEventListener("canplaythrough",this._onCanPlay),e.addEventListener("error",this._onError,!0)),this._load=new Promise((n,r)=>{this.valid?n(this):(this._resolve=n,this._reject=r,e.load())}),this._load}_onError(e){this.source.removeEventListener("error",this._onError,!0),this.onError.emit(e),this._reject&&(this._reject(e),this._reject=null,this._resolve=null)}_isSourcePlaying(){const e=this.source;return!e.paused&&!e.ended}_isSourceReady(){return this.source.readyState>2}_onPlayStart(){this.valid||this._onCanPlay(),this._configureAutoUpdate()}_onPlayStop(){this._configureAutoUpdate()}_onSeeked(){this._autoUpdate&&!this._isSourcePlaying()&&(this._msToNextUpdate=0,this.update(),this._msToNextUpdate=0)}_onCanPlay(){const e=this.source;e.removeEventListener("canplay",this._onCanPlay),e.removeEventListener("canplaythrough",this._onCanPlay);const n=this.valid;this._msToNextUpdate=0,this.update(),this._msToNextUpdate=0,!n&&this._resolve&&(this._resolve(this),this._resolve=null,this._reject=null),this._isSourcePlaying()?this._onPlayStart():this.autoPlay&&e.play()}dispose(){this._configureAutoUpdate();const e=this.source;e&&(e.removeEventListener("play",this._onPlayStart),e.removeEventListener("pause",this._onPlayStop),e.removeEventListener("seeked",this._onSeeked),e.removeEventListener("canplay",this._onCanPlay),e.removeEventListener("canplaythrough",this._onCanPlay),e.removeEventListener("error",this._onError,!0),e.pause(),e.src="",e.load()),super.dispose()}get autoUpdate(){return this._autoUpdate}set autoUpdate(e){e!==this._autoUpdate&&(this._autoUpdate=e,this._configureAutoUpdate())}get updateFPS(){return this._updateFPS}set updateFPS(e){e!==this._updateFPS&&(this._updateFPS=e,this._configureAutoUpdate())}_configureAutoUpdate(){this._autoUpdate&&this._isSourcePlaying()?!this._updateFPS&&this.source.requestVideoFrameCallback?(this._isConnectedToTicker&&(ci.shared.remove(this.update,this),this._isConnectedToTicker=!1,this._msToNextUpdate=0),this._videoFrameRequestCallbackHandle===null&&(this._videoFrameRequestCallbackHandle=this.source.requestVideoFrameCallback(this._videoFrameRequestCallback))):(this._videoFrameRequestCallbackHandle!==null&&(this.source.cancelVideoFrameCallback(this._videoFrameRequestCallbackHandle),this._videoFrameRequestCallbackHandle=null),this._isConnectedToTicker||(ci.shared.add(this.update,this),this._isConnectedToTicker=!0,this._msToNextUpdate=0)):(this._videoFrameRequestCallbackHandle!==null&&(this.source.cancelVideoFrameCallback(this._videoFrameRequestCallbackHandle),this._videoFrameRequestCallbackHandle=null),this._isConnectedToTicker&&(ci.shared.remove(this.update,this),this._isConnectedToTicker=!1,this._msToNextUpdate=0))}static test(e,n){return globalThis.HTMLVideoElement&&e instanceof HTMLVideoElement||Zw.TYPES.includes(n)}};Yw.TYPES=["mp4","m4v","webm","ogg","ogv","h264","avi","mov"],Yw.MIME_TYPES={ogv:"video/ogg",mov:"video/quicktime",m4v:"video/mp4"};let L9=Yw;Nw.push(id,n9,AZ,L9,Xw,Dv,kZ,IZ);class gl{constructor(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0,this.rect=null,this.updateID=-1}isEmpty(){return this.minX>this.maxX||this.minY>this.maxY}clear(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0}getRectangle(e){return this.minX>this.maxX||this.minY>this.maxY?Me.EMPTY:(e=e||new Me(0,0,1,1),e.x=this.minX,e.y=this.minY,e.width=this.maxX-this.minX,e.height=this.maxY-this.minY,e)}addPoint(e){this.minX=Math.min(this.minX,e.x),this.maxX=Math.max(this.maxX,e.x),this.minY=Math.min(this.minY,e.y),this.maxY=Math.max(this.maxY,e.y)}addPointMatrix(e,n){const{a:r,b:i,c:s,d:o,tx:a,ty:l}=e,c=r*n.x+s*n.y+a,u=i*n.x+o*n.y+l;this.minX=Math.min(this.minX,c),this.maxX=Math.max(this.maxX,c),this.minY=Math.min(this.minY,u),this.maxY=Math.max(this.maxY,u)}addQuad(e){let n=this.minX,r=this.minY,i=this.maxX,s=this.maxY,o=e[0],a=e[1];n=o<n?o:n,r=a<r?a:r,i=o>i?o:i,s=a>s?a:s,o=e[2],a=e[3],n=o<n?o:n,r=a<r?a:r,i=o>i?o:i,s=a>s?a:s,o=e[4],a=e[5],n=o<n?o:n,r=a<r?a:r,i=o>i?o:i,s=a>s?a:s,o=e[6],a=e[7],n=o<n?o:n,r=a<r?a:r,i=o>i?o:i,s=a>s?a:s,this.minX=n,this.minY=r,this.maxX=i,this.maxY=s}addFrame(e,n,r,i,s){this.addFrameMatrix(e.worldTransform,n,r,i,s)}addFrameMatrix(e,n,r,i,s){const o=e.a,a=e.b,l=e.c,c=e.d,u=e.tx,d=e.ty;let h=this.minX,f=this.minY,p=this.maxX,m=this.maxY,v=o*n+l*r+u,y=a*n+c*r+d;h=v<h?v:h,f=y<f?y:f,p=v>p?v:p,m=y>m?y:m,v=o*i+l*r+u,y=a*i+c*r+d,h=v<h?v:h,f=y<f?y:f,p=v>p?v:p,m=y>m?y:m,v=o*n+l*s+u,y=a*n+c*s+d,h=v<h?v:h,f=y<f?y:f,p=v>p?v:p,m=y>m?y:m,v=o*i+l*s+u,y=a*i+c*s+d,h=v<h?v:h,f=y<f?y:f,p=v>p?v:p,m=y>m?y:m,this.minX=h,this.minY=f,this.maxX=p,this.maxY=m}addVertexData(e,n,r){let i=this.minX,s=this.minY,o=this.maxX,a=this.maxY;for(let l=n;l<r;l+=2){const c=e[l],u=e[l+1];i=c<i?c:i,s=u<s?u:s,o=c>o?c:o,a=u>a?u:a}this.minX=i,this.minY=s,this.maxX=o,this.maxY=a}addVertices(e,n,r,i){this.addVerticesMatrix(e.worldTransform,n,r,i)}addVerticesMatrix(e,n,r,i,s=0,o=s){const a=e.a,l=e.b,c=e.c,u=e.d,d=e.tx,h=e.ty;let f=this.minX,p=this.minY,m=this.maxX,v=this.maxY;for(let y=r;y<i;y+=2){const b=n[y],_=n[y+1],E=a*b+c*_+d,w=u*_+l*b+h;f=Math.min(f,E-s),m=Math.max(m,E+s),p=Math.min(p,w-o),v=Math.max(v,w+o)}this.minX=f,this.minY=p,this.maxX=m,this.maxY=v}addBounds(e){const n=this.minX,r=this.minY,i=this.maxX,s=this.maxY;this.minX=e.minX<n?e.minX:n,this.minY=e.minY<r?e.minY:r,this.maxX=e.maxX>i?e.maxX:i,this.maxY=e.maxY>s?e.maxY:s}addBoundsMask(e,n){const r=e.minX>n.minX?e.minX:n.minX,i=e.minY>n.minY?e.minY:n.minY,s=e.maxX<n.maxX?e.maxX:n.maxX,o=e.maxY<n.maxY?e.maxY:n.maxY;if(r<=s&&i<=o){const a=this.minX,l=this.minY,c=this.maxX,u=this.maxY;this.minX=r<a?r:a,this.minY=i<l?i:l,this.maxX=s>c?s:c,this.maxY=o>u?o:u}}addBoundsMatrix(e,n){this.addFrameMatrix(n,e.minX,e.minY,e.maxX,e.maxY)}addBoundsArea(e,n){const r=e.minX>n.x?e.minX:n.x,i=e.minY>n.y?e.minY:n.y,s=e.maxX<n.x+n.width?e.maxX:n.x+n.width,o=e.maxY<n.y+n.height?e.maxY:n.y+n.height;if(r<=s&&i<=o){const a=this.minX,l=this.minY,c=this.maxX,u=this.maxY;this.minX=r<a?r:a,this.minY=i<l?i:l,this.maxX=s>c?s:c,this.maxY=o>u?o:u}}pad(e=0,n=e){this.isEmpty()||(this.minX-=e,this.maxX+=e,this.minY-=n,this.maxY+=n)}addFramePad(e,n,r,i,s,o){e-=s,n-=o,r+=s,i+=o,this.minX=this.minX<e?this.minX:e,this.maxX=this.maxX>r?this.maxX:r,this.minY=this.minY<n?this.minY:n,this.maxY=this.maxY>i?this.maxY:i}}class Zt extends Lm{constructor(){super(),this.tempDisplayObjectParent=null,this.transform=new JT,this.alpha=1,this.visible=!0,this.renderable=!0,this.cullable=!1,this.cullArea=null,this.parent=null,this.worldAlpha=1,this._lastSortedIndex=0,this._zIndex=0,this.filterArea=null,this.filters=null,this._enabledFilters=null,this._bounds=new gl,this._localBounds=null,this._boundsID=0,this._boundsRect=null,this._localBoundsRect=null,this._mask=null,this._maskRefCount=0,this._destroyed=!1,this.isSprite=!1,this.isMask=!1}static mixin(e){const n=Object.keys(e);for(let r=0;r<n.length;++r){const i=n[r];Object.defineProperty(Zt.prototype,i,Object.getOwnPropertyDescriptor(e,i))}}get destroyed(){return this._destroyed}_recursivePostUpdateTransform(){this.parent?(this.parent._recursivePostUpdateTransform(),this.transform.updateTransform(this.parent.transform)):this.transform.updateTransform(this._tempDisplayObjectParent.transform)}updateTransform(){this._boundsID++,this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha}getBounds(e,n){return e||(this.parent?(this._recursivePostUpdateTransform(),this.updateTransform()):(this.parent=this._tempDisplayObjectParent,this.updateTransform(),this.parent=null)),this._bounds.updateID!==this._boundsID&&(this.calculateBounds(),this._bounds.updateID=this._boundsID),n||(this._boundsRect||(this._boundsRect=new Me),n=this._boundsRect),this._bounds.getRectangle(n)}getLocalBounds(e){e||(this._localBoundsRect||(this._localBoundsRect=new Me),e=this._localBoundsRect),this._localBounds||(this._localBounds=new gl);const n=this.transform,r=this.parent;this.parent=null,this._tempDisplayObjectParent.worldAlpha=(r==null?void 0:r.worldAlpha)??1,this.transform=this._tempDisplayObjectParent.transform;const i=this._bounds,s=this._boundsID;this._bounds=this._localBounds;const o=this.getBounds(!1,e);return this.parent=r,this.transform=n,this._bounds=i,this._bounds.updateID+=this._boundsID-s,o}toGlobal(e,n,r=!1){return r||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)),this.worldTransform.apply(e,n)}toLocal(e,n,r,i){return n&&(e=n.toGlobal(e,r,i)),i||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)),this.worldTransform.applyInverse(e,r)}setParent(e){if(!e||!e.addChild)throw new Error("setParent: Argument must be a Container");return e.addChild(this),e}removeFromParent(){var e;(e=this.parent)==null||e.removeChild(this)}setTransform(e=0,n=0,r=1,i=1,s=0,o=0,a=0,l=0,c=0){return this.position.x=e,this.position.y=n,this.scale.x=r||1,this.scale.y=i||1,this.rotation=s,this.skew.x=o,this.skew.y=a,this.pivot.x=l,this.pivot.y=c,this}destroy(e){this.removeFromParent(),this._destroyed=!0,this.transform=null,this.parent=null,this._bounds=null,this.mask=null,this.cullArea=null,this.filters=null,this.filterArea=null,this.hitArea=null,this.eventMode="auto",this.interactiveChildren=!1,this.emit("destroyed"),this.removeAllListeners()}get _tempDisplayObjectParent(){return this.tempDisplayObjectParent===null&&(this.tempDisplayObjectParent=new MZ),this.tempDisplayObjectParent}enableTempParent(){const e=this.parent;return this.parent=this._tempDisplayObjectParent,e}disableTempParent(e){this.parent=e}get x(){return this.position.x}set x(e){this.transform.position.x=e}get y(){return this.position.y}set y(e){this.transform.position.y=e}get worldTransform(){return this.transform.worldTransform}get localTransform(){return this.transform.localTransform}get position(){return this.transform.position}set position(e){this.transform.position.copyFrom(e)}get scale(){return this.transform.scale}set scale(e){this.transform.scale.copyFrom(e)}get pivot(){return this.transform.pivot}set pivot(e){this.transform.pivot.copyFrom(e)}get skew(){return this.transform.skew}set skew(e){this.transform.skew.copyFrom(e)}get rotation(){return this.transform.rotation}set rotation(e){this.transform.rotation=e}get angle(){return this.transform.rotation*TY}set angle(e){this.transform.rotation=e*SY}get zIndex(){return this._zIndex}set zIndex(e){this._zIndex!==e&&(this._zIndex=e,this.parent&&(this.parent.sortDirty=!0))}get worldVisible(){let e=this;do{if(!e.visible)return!1;e=e.parent}while(e);return!0}get mask(){return this._mask}set mask(e){if(this._mask!==e){if(this._mask){const n=this._mask.isMaskData?this._mask.maskObject:this._mask;n&&(n._maskRefCount--,n._maskRefCount===0&&(n.renderable=!0,n.isMask=!1))}if(this._mask=e,this._mask){const n=this._mask.isMaskData?this._mask.maskObject:this._mask;n&&(n._maskRefCount===0&&(n.renderable=!1,n.isMask=!0),n._maskRefCount++)}}}}class MZ extends Zt{constructor(){super(...arguments),this.sortDirty=null}}Zt.prototype.displayObjectUpdateTransform=Zt.prototype.updateTransform;const PZ=new Ze;function LZ(t,e){return t.zIndex===e.zIndex?t._lastSortedIndex-e._lastSortedIndex:t.zIndex-e.zIndex}const R9=class Kw extends Zt{constructor(){super(),this.children=[],this.sortableChildren=Kw.defaultSortableChildren,this.sortDirty=!1}onChildrenChange(e){}addChild(...e){if(e.length>1)for(let n=0;n<e.length;n++)this.addChild(e[n]);else{const n=e[0];n.parent&&n.parent.removeChild(n),n.parent=this,this.sortDirty=!0,n.transform._parentID=-1,this.children.push(n),this._boundsID++,this.onChildrenChange(this.children.length-1),this.emit("childAdded",n,this,this.children.length-1),n.emit("added",this)}return e[0]}addChildAt(e,n){if(n<0||n>this.children.length)throw new Error(`${e}addChildAt: The index ${n} supplied is out of bounds ${this.children.length}`);return e.parent&&e.parent.removeChild(e),e.parent=this,this.sortDirty=!0,e.transform._parentID=-1,this.children.splice(n,0,e),this._boundsID++,this.onChildrenChange(n),e.emit("added",this),this.emit("childAdded",e,this,n),e}swapChildren(e,n){if(e===n)return;const r=this.getChildIndex(e),i=this.getChildIndex(n);this.children[r]=n,this.children[i]=e,this.onChildrenChange(r<i?r:i)}getChildIndex(e){const n=this.children.indexOf(e);if(n===-1)throw new Error("The supplied DisplayObject must be a child of the caller");return n}setChildIndex(e,n){if(n<0||n>=this.children.length)throw new Error(`The index ${n} supplied is out of bounds ${this.children.length}`);const r=this.getChildIndex(e);xd(this.children,r,1),this.children.splice(n,0,e),this.onChildrenChange(n)}getChildAt(e){if(e<0||e>=this.children.length)throw new Error(`getChildAt: Index (${e}) does not exist.`);return this.children[e]}removeChild(...e){if(e.length>1)for(let n=0;n<e.length;n++)this.removeChild(e[n]);else{const n=e[0],r=this.children.indexOf(n);if(r===-1)return null;n.parent=null,n.transform._parentID=-1,xd(this.children,r,1),this._boundsID++,this.onChildrenChange(r),n.emit("removed",this),this.emit("childRemoved",n,this,r)}return e[0]}removeChildAt(e){const n=this.getChildAt(e);return n.parent=null,n.transform._parentID=-1,xd(this.children,e,1),this._boundsID++,this.onChildrenChange(e),n.emit("removed",this),this.emit("childRemoved",n,this,e),n}removeChildren(e=0,n=this.children.length){const r=e,i=n,s=i-r;let o;if(s>0&&s<=i){o=this.children.splice(r,s);for(let a=0;a<o.length;++a)o[a].parent=null,o[a].transform&&(o[a].transform._parentID=-1);this._boundsID++,this.onChildrenChange(e);for(let a=0;a<o.length;++a)o[a].emit("removed",this),this.emit("childRemoved",o[a],this,a);return o}else if(s===0&&this.children.length===0)return[];throw new RangeError("removeChildren: numeric values are outside the acceptable range.")}sortChildren(){let e=!1;for(let n=0,r=this.children.length;n<r;++n){const i=this.children[n];i._lastSortedIndex=n,!e&&i.zIndex!==0&&(e=!0)}e&&this.children.length>1&&this.children.sort(LZ),this.sortDirty=!1}updateTransform(){this.sortableChildren&&this.sortDirty&&this.sortChildren(),this._boundsID++,this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha;for(let e=0,n=this.children.length;e<n;++e){const r=this.children[e];r.visible&&r.updateTransform()}}calculateBounds(){this._bounds.clear(),this._calculateBounds();for(let e=0;e<this.children.length;e++){const n=this.children[e];if(!(!n.visible||!n.renderable))if(n.calculateBounds(),n._mask){const r=n._mask.isMaskData?n._mask.maskObject:n._mask;r?(r.calculateBounds(),this._bounds.addBoundsMask(n._bounds,r._bounds)):this._bounds.addBounds(n._bounds)}else n.filterArea?this._bounds.addBoundsArea(n._bounds,n.filterArea):this._bounds.addBounds(n._bounds)}this._bounds.updateID=this._boundsID}getLocalBounds(e,n=!1){const r=super.getLocalBounds(e);if(!n)for(let i=0,s=this.children.length;i<s;++i){const o=this.children[i];o.visible&&o.updateTransform()}return r}_calculateBounds(){}_renderWithCulling(e){const n=e.renderTexture.sourceFrame;if(!(n.width>0&&n.height>0))return;let r,i;this.cullArea?(r=this.cullArea,i=this.worldTransform):this._render!==Kw.prototype._render&&(r=this.getBounds(!0));const s=e.projection.transform;if(s&&(i?(i=PZ.copyFrom(i),i.prepend(s)):i=s),r&&n.intersects(r,i))this._render(e);else if(this.cullArea)return;for(let o=0,a=this.children.length;o<a;++o){const l=this.children[o],c=l.cullable;l.cullable=c||!this.cullArea,l.render(e),l.cullable=c}}render(e){var n;if(!(!this.visible||this.worldAlpha<=0||!this.renderable))if(this._mask||(n=this.filters)!=null&&n.length)this.renderAdvanced(e);else if(this.cullable)this._renderWithCulling(e);else{this._render(e);for(let r=0,i=this.children.length;r<i;++r)this.children[r].render(e)}}renderAdvanced(e){var s,o,a;const n=this.filters,r=this._mask;if(n){this._enabledFilters||(this._enabledFilters=[]),this._enabledFilters.length=0;for(let l=0;l<n.length;l++)n[l].enabled&&this._enabledFilters.push(n[l])}const i=n&&((s=this._enabledFilters)==null?void 0:s.length)||r&&(!r.isMaskData||r.enabled&&(r.autoDetect||r.type!==In.NONE));if(i&&e.batch.flush(),n&&((o=this._enabledFilters)!=null&&o.length)&&e.filter.push(this,this._enabledFilters),r&&e.mask.push(this,this._mask),this.cullable)this._renderWithCulling(e);else{this._render(e);for(let l=0,c=this.children.length;l<c;++l)this.children[l].render(e)}i&&e.batch.flush(),r&&e.mask.pop(this),n&&((a=this._enabledFilters)!=null&&a.length)&&e.filter.pop()}_render(e){}destroy(e){super.destroy(),this.sortDirty=!1;const n=typeof e=="boolean"?e:e==null?void 0:e.children,r=this.removeChildren(0,this.children.length);if(n)for(let i=0;i<r.length;++i)r[i].destroy(e)}get width(){return this.scale.x*this.getLocalBounds().width}set width(e){const n=this.getLocalBounds().width;n!==0?this.scale.x=e/n:this.scale.x=1,this._width=e}get height(){return this.scale.y*this.getLocalBounds().height}set height(e){const n=this.getLocalBounds().height;n!==0?this.scale.y=e/n:this.scale.y=1,this._height=e}};R9.defaultSortableChildren=!1;let Xn=R9;Xn.prototype.containerUpdateTransform=Xn.prototype.updateTransform;Object.defineProperties(_e,{SORTABLE_CHILDREN:{get(){return Xn.defaultSortableChildren},set(t){Qe("7.1.0","settings.SORTABLE_CHILDREN is deprecated, use Container.defaultSortableChildren"),Xn.defaultSortableChildren=t}}});const Vh=new Ke,RZ=new Uint16Array([0,1,2,0,2,3]);class On extends Xn{constructor(e){super(),this._anchor=new Bo(this._onAnchorUpdate,this,e?e.defaultAnchor.x:0,e?e.defaultAnchor.y:0),this._texture=null,this._width=0,this._height=0,this._tintColor=new pt(16777215),this._tintRGB=null,this.tint=16777215,this.blendMode=Ne.NORMAL,this._cachedTint=16777215,this.uvs=null,this.texture=e||he.EMPTY,this.vertexData=new Float32Array(8),this.vertexTrimmedData=null,this._transformID=-1,this._textureID=-1,this._transformTrimmedID=-1,this._textureTrimmedID=-1,this.indices=RZ,this.pluginName="batch",this.isSprite=!0,this._roundPixels=_e.ROUND_PIXELS}_onTextureUpdate(){this._textureID=-1,this._textureTrimmedID=-1,this._cachedTint=16777215,this._width&&(this.scale.x=za(this.scale.x)*this._width/this._texture.orig.width),this._height&&(this.scale.y=za(this.scale.y)*this._height/this._texture.orig.height)}_onAnchorUpdate(){this._transformID=-1,this._transformTrimmedID=-1}calculateVertices(){const e=this._texture;if(this._transformID===this.transform._worldID&&this._textureID===e._updateID)return;this._textureID!==e._updateID&&(this.uvs=this._texture._uvs.uvsFloat32),this._transformID=this.transform._worldID,this._textureID=e._updateID;const n=this.transform.worldTransform,r=n.a,i=n.b,s=n.c,o=n.d,a=n.tx,l=n.ty,c=this.vertexData,u=e.trim,d=e.orig,h=this._anchor;let f=0,p=0,m=0,v=0;if(u?(p=u.x-h._x*d.width,f=p+u.width,v=u.y-h._y*d.height,m=v+u.height):(p=-h._x*d.width,f=p+d.width,v=-h._y*d.height,m=v+d.height),c[0]=r*p+s*v+a,c[1]=o*v+i*p+l,c[2]=r*f+s*v+a,c[3]=o*v+i*f+l,c[4]=r*f+s*m+a,c[5]=o*m+i*f+l,c[6]=r*p+s*m+a,c[7]=o*m+i*p+l,this._roundPixels){const y=_e.RESOLUTION;for(let b=0;b<c.length;++b)c[b]=Math.round(c[b]*y)/y}}calculateTrimmedVertices(){if(!this.vertexTrimmedData)this.vertexTrimmedData=new Float32Array(8);else if(this._transformTrimmedID===this.transform._worldID&&this._textureTrimmedID===this._texture._updateID)return;this._transformTrimmedID=this.transform._worldID,this._textureTrimmedID=this._texture._updateID;const e=this._texture,n=this.vertexTrimmedData,r=e.orig,i=this._anchor,s=this.transform.worldTransform,o=s.a,a=s.b,l=s.c,c=s.d,u=s.tx,d=s.ty,h=-i._x*r.width,f=h+r.width,p=-i._y*r.height,m=p+r.height;if(n[0]=o*h+l*p+u,n[1]=c*p+a*h+d,n[2]=o*f+l*p+u,n[3]=c*p+a*f+d,n[4]=o*f+l*m+u,n[5]=c*m+a*f+d,n[6]=o*h+l*m+u,n[7]=c*m+a*h+d,this._roundPixels){const v=_e.RESOLUTION;for(let y=0;y<n.length;++y)n[y]=Math.round(n[y]*v)/v}}_render(e){this.calculateVertices(),e.batch.setObjectRenderer(e.plugins[this.pluginName]),e.plugins[this.pluginName].render(this)}_calculateBounds(){const e=this._texture.trim,n=this._texture.orig;!e||e.width===n.width&&e.height===n.height?(this.calculateVertices(),this._bounds.addQuad(this.vertexData)):(this.calculateTrimmedVertices(),this._bounds.addQuad(this.vertexTrimmedData))}getLocalBounds(e){return this.children.length===0?(this._localBounds||(this._localBounds=new gl),this._localBounds.minX=this._texture.orig.width*-this._anchor._x,this._localBounds.minY=this._texture.orig.height*-this._anchor._y,this._localBounds.maxX=this._texture.orig.width*(1-this._anchor._x),this._localBounds.maxY=this._texture.orig.height*(1-this._anchor._y),e||(this._localBoundsRect||(this._localBoundsRect=new Me),e=this._localBoundsRect),this._localBounds.getRectangle(e)):super.getLocalBounds.call(this,e)}containsPoint(e){this.worldTransform.applyInverse(e,Vh);const n=this._texture.orig.width,r=this._texture.orig.height,i=-n*this.anchor.x;let s=0;return Vh.x>=i&&Vh.x<i+n&&(s=-r*this.anchor.y,Vh.y>=s&&Vh.y<s+r)}destroy(e){if(super.destroy(e),this._texture.off("update",this._onTextureUpdate,this),this._anchor=null,typeof e=="boolean"?e:e==null?void 0:e.texture){const n=typeof e=="boolean"?e:e==null?void 0:e.baseTexture;this._texture.destroy(!!n)}this._texture=null}static from(e,n){const r=e instanceof he?e:he.from(e,n);return new On(r)}set roundPixels(e){this._roundPixels!==e&&(this._transformID=-1,this._transformTrimmedID=-1),this._roundPixels=e}get roundPixels(){return this._roundPixels}get width(){return Math.abs(this.scale.x)*this._texture.orig.width}set width(e){const n=za(this.scale.x)||1;this.scale.x=n*e/this._texture.orig.width,this._width=e}get height(){return Math.abs(this.scale.y)*this._texture.orig.height}set height(e){const n=za(this.scale.y)||1;this.scale.y=n*e/this._texture.orig.height,this._height=e}get anchor(){return this._anchor}set anchor(e){this._anchor.copyFrom(e)}get tint(){return this._tintColor.value}set tint(e){this._tintColor.setValue(e),this._tintRGB=this._tintColor.toLittleEndianNumber()}get tintValue(){return this._tintColor.toNumber()}get texture(){return this._texture}set texture(e){this._texture!==e&&(this._texture&&this._texture.off("update",this._onTextureUpdate,this),this._texture=e||he.EMPTY,this._cachedTint=16777215,this._textureID=-1,this._textureTrimmedID=-1,e&&(e.baseTexture.valid?this._onTextureUpdate():e.once("update",this._onTextureUpdate,this)))}}const O9=new Ze;Zt.prototype._cacheAsBitmap=!1;Zt.prototype._cacheData=null;Zt.prototype._cacheAsBitmapResolution=null;Zt.prototype._cacheAsBitmapMultisample=null;class OZ{constructor(){this.textureCacheId=null,this.originalRender=null,this.originalRenderCanvas=null,this.originalCalculateBounds=null,this.originalGetLocalBounds=null,this.originalUpdateTransform=null,this.originalDestroy=null,this.originalMask=null,this.originalFilterArea=null,this.originalContainsPoint=null,this.sprite=null}}Object.defineProperties(Zt.prototype,{cacheAsBitmapResolution:{get(){return this._cacheAsBitmapResolution},set(t){t!==this._cacheAsBitmapResolution&&(this._cacheAsBitmapResolution=t,this.cacheAsBitmap&&(this.cacheAsBitmap=!1,this.cacheAsBitmap=!0))}},cacheAsBitmapMultisample:{get(){return this._cacheAsBitmapMultisample},set(t){t!==this._cacheAsBitmapMultisample&&(this._cacheAsBitmapMultisample=t,this.cacheAsBitmap&&(this.cacheAsBitmap=!1,this.cacheAsBitmap=!0))}},cacheAsBitmap:{get(){return this._cacheAsBitmap},set(t){if(this._cacheAsBitmap===t)return;this._cacheAsBitmap=t;let e;t?(this._cacheData||(this._cacheData=new OZ),e=this._cacheData,e.originalRender=this.render,e.originalRenderCanvas=this.renderCanvas,e.originalUpdateTransform=this.updateTransform,e.originalCalculateBounds=this.calculateBounds,e.originalGetLocalBounds=this.getLocalBounds,e.originalDestroy=this.destroy,e.originalContainsPoint=this.containsPoint,e.originalMask=this._mask,e.originalFilterArea=this.filterArea,this.render=this._renderCached,this.renderCanvas=this._renderCachedCanvas,this.destroy=this._cacheAsBitmapDestroy):(e=this._cacheData,e.sprite&&this._destroyCachedDisplayObject(),this.render=e.originalRender,this.renderCanvas=e.originalRenderCanvas,this.calculateBounds=e.originalCalculateBounds,this.getLocalBounds=e.originalGetLocalBounds,this.destroy=e.originalDestroy,this.updateTransform=e.originalUpdateTransform,this.containsPoint=e.originalContainsPoint,this._mask=e.originalMask,this.filterArea=e.originalFilterArea)}}});Zt.prototype._renderCached=function(t){!this.visible||this.worldAlpha<=0||!this.renderable||(this._initCachedDisplayObject(t),this._cacheData.sprite.transform._worldID=this.transform._worldID,this._cacheData.sprite.worldAlpha=this.worldAlpha,this._cacheData.sprite._render(t))};Zt.prototype._initCachedDisplayObject=function(t){var h,f;if((h=this._cacheData)!=null&&h.sprite)return;const e=this.alpha;this.alpha=1,t.batch.flush();const n=this.getLocalBounds(new Me,!0);if((f=this.filters)!=null&&f.length){const p=this.filters[0].padding;n.pad(p)}const r=this.cacheAsBitmapResolution||t.resolution;n.ceil(r),n.width=Math.max(n.width,1/r),n.height=Math.max(n.height,1/r);const i=t.renderTexture.current,s=t.renderTexture.sourceFrame.clone(),o=t.renderTexture.destinationFrame.clone(),a=t.projection.transform,l=ta.create({width:n.width,height:n.height,resolution:r,multisample:this.cacheAsBitmapMultisample??t.multisample}),c=`cacheAsBitmap_${Gc()}`;this._cacheData.textureCacheId=c,ze.addToCache(l.baseTexture,c),he.addToCache(l,c);const u=this.transform.localTransform.copyTo(O9).invert().translate(-n.x,-n.y);this.render=this._cacheData.originalRender,t.render(this,{renderTexture:l,clear:!0,transform:u,skipUpdateTransform:!1}),t.framebuffer.blit(),t.projection.transform=a,t.renderTexture.bind(i,s,o),this.render=this._renderCached,this.updateTransform=this.displayObjectUpdateTransform,this.calculateBounds=this._calculateCachedBounds,this.getLocalBounds=this._getCachedLocalBounds,this._mask=null,this.filterArea=null,this.alpha=e;const d=new On(l);d.transform.worldTransform=this.transform.worldTransform,d.anchor.x=-(n.x/n.width),d.anchor.y=-(n.y/n.height),d.alpha=e,d._bounds=this._bounds,this._cacheData.sprite=d,this.transform._parentID=-1,this.parent?this.updateTransform():(this.enableTempParent(),this.updateTransform(),this.disableTempParent(null)),this.containsPoint=d.containsPoint.bind(d)};Zt.prototype._renderCachedCanvas=function(t){!this.visible||this.worldAlpha<=0||!this.renderable||(this._initCachedDisplayObjectCanvas(t),this._cacheData.sprite.worldAlpha=this.worldAlpha,this._cacheData.sprite._renderCanvas(t))};Zt.prototype._initCachedDisplayObjectCanvas=function(t){var u;if((u=this._cacheData)!=null&&u.sprite)return;const e=this.getLocalBounds(new Me,!0),n=this.alpha;this.alpha=1;const r=t.canvasContext.activeContext,i=t._projTransform,s=this.cacheAsBitmapResolution||t.resolution;e.ceil(s),e.width=Math.max(e.width,1/s),e.height=Math.max(e.height,1/s);const o=ta.create({width:e.width,height:e.height,resolution:s}),a=`cacheAsBitmap_${Gc()}`;this._cacheData.textureCacheId=a,ze.addToCache(o.baseTexture,a),he.addToCache(o,a);const l=O9;this.transform.localTransform.copyTo(l),l.invert(),l.tx-=e.x,l.ty-=e.y,this.renderCanvas=this._cacheData.originalRenderCanvas,t.render(this,{renderTexture:o,clear:!0,transform:l,skipUpdateTransform:!1}),t.canvasContext.activeContext=r,t._projTransform=i,this.renderCanvas=this._renderCachedCanvas,this.updateTransform=this.displayObjectUpdateTransform,this.calculateBounds=this._calculateCachedBounds,this.getLocalBounds=this._getCachedLocalBounds,this._mask=null,this.filterArea=null,this.alpha=n;const c=new On(o);c.transform.worldTransform=this.transform.worldTransform,c.anchor.x=-(e.x/e.width),c.anchor.y=-(e.y/e.height),c.alpha=n,c._bounds=this._bounds,this._cacheData.sprite=c,this.transform._parentID=-1,this.parent?this.updateTransform():(this.parent=t._tempDisplayObjectParent,this.updateTransform(),this.parent=null),this.containsPoint=c.containsPoint.bind(c)};Zt.prototype._calculateCachedBounds=function(){this._bounds.clear(),this._cacheData.sprite.transform._worldID=this.transform._worldID,this._cacheData.sprite._calculateBounds(),this._bounds.updateID=this._boundsID};Zt.prototype._getCachedLocalBounds=function(){return this._cacheData.sprite.getLocalBounds(null)};Zt.prototype._destroyCachedDisplayObject=function(){this._cacheData.sprite._texture.destroy(!0),this._cacheData.sprite=null,ze.removeFromCache(this._cacheData.textureCacheId),he.removeFromCache(this._cacheData.textureCacheId),this._cacheData.textureCacheId=null};Zt.prototype._cacheAsBitmapDestroy=function(t){this.cacheAsBitmap=!1,this.destroy(t)};Zt.prototype.name=null;Xn.prototype.getChildByName=function(t,e){for(let n=0,r=this.children.length;n<r;n++)if(this.children[n].name===t)return this.children[n];if(e)for(let n=0,r=this.children.length;n<r;n++){const i=this.children[n];if(!i.getChildByName)continue;const s=i.getChildByName(t,!0);if(s)return s}return null};Zt.prototype.getGlobalPosition=function(t=new Ke,e=!1){return this.parent?this.parent.toGlobal(this.position,t,e):(t.x=this.position.x,t.y=this.position.y),t};var DZ=`varying vec2 vTextureCoord;

uniform sampler2D uSampler;
uniform float uAlpha;

void main(void)
{
   gl_FragColor = texture2D(uSampler, vTextureCoord) * uAlpha;
}
`;class NZ extends Lr{constructor(e=1){super(SZ,DZ,{uAlpha:1}),this.alpha=e}get alpha(){return this.uniforms.uAlpha}set alpha(e){this.uniforms.uAlpha=e}}const FZ={5:[.153388,.221461,.250301],7:[.071303,.131514,.189879,.214607],9:[.028532,.067234,.124009,.179044,.20236],11:[.0093,.028002,.065984,.121703,.175713,.198596],13:[.002406,.009255,.027867,.065666,.121117,.174868,.197641],15:[489e-6,.002403,.009246,.02784,.065602,.120999,.174697,.197448]},BZ=["varying vec2 vBlurTexCoords[%size%];","uniform sampler2D uSampler;","void main(void)","{","    gl_FragColor = vec4(0.0);","    %blur%","}"].join(`
`);function UZ(t){const e=FZ[t],n=e.length;let r=BZ,i="";const s="gl_FragColor += texture2D(uSampler, vBlurTexCoords[%index%]) * %value%;";let o;for(let a=0;a<t;a++){let l=s.replace("%index%",a.toString());o=a,a>=n&&(o=t-a-1),l=l.replace("%value%",e[o].toString()),i+=l,i+=`
`}return r=r.replace("%blur%",i),r=r.replace("%size%",t.toString()),r}const $Z=`
    attribute vec2 aVertexPosition;

    uniform mat3 projectionMatrix;

    uniform float strength;

    varying vec2 vBlurTexCoords[%size%];

    uniform vec4 inputSize;
    uniform vec4 outputFrame;

    vec4 filterVertexPosition( void )
    {
        vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

        return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
    }

    vec2 filterTextureCoord( void )
    {
        return aVertexPosition * (outputFrame.zw * inputSize.zw);
    }

    void main(void)
    {
        gl_Position = filterVertexPosition();

        vec2 textureCoord = filterTextureCoord();
        %blur%
    }`;function HZ(t,e){const n=Math.ceil(t/2);let r=$Z,i="",s;e?s="vBlurTexCoords[%index%] =  textureCoord + vec2(%sampleIndex% * strength, 0.0);":s="vBlurTexCoords[%index%] =  textureCoord + vec2(0.0, %sampleIndex% * strength);";for(let o=0;o<t;o++){let a=s.replace("%index%",o.toString());a=a.replace("%sampleIndex%",`${o-(n-1)}.0`),i+=a,i+=`
`}return r=r.replace("%blur%",i),r=r.replace("%size%",t.toString()),r}class qw extends Lr{constructor(e,n=8,r=4,i=Lr.defaultResolution,s=5){const o=HZ(s,e),a=UZ(s);super(o,a),this.horizontal=e,this.resolution=i,this._quality=0,this.quality=r,this.blur=n}apply(e,n,r,i){if(r?this.horizontal?this.uniforms.strength=1/r.width*(r.width/n.width):this.uniforms.strength=1/r.height*(r.height/n.height):this.horizontal?this.uniforms.strength=1/e.renderer.width*(e.renderer.width/n.width):this.uniforms.strength=1/e.renderer.height*(e.renderer.height/n.height),this.uniforms.strength*=this.strength,this.uniforms.strength/=this.passes,this.passes===1)e.applyFilter(this,n,r,i);else{const s=e.getFilterTexture(),o=e.renderer;let a=n,l=s;this.state.blend=!1,e.applyFilter(this,a,l,Zs.CLEAR);for(let c=1;c<this.passes-1;c++){e.bindAndClear(a,Zs.BLIT),this.uniforms.uSampler=l;const u=l;l=a,a=u,o.shader.bind(this),o.geometry.draw(5)}this.state.blend=!0,e.applyFilter(this,l,r,i),e.returnFilterTexture(s)}}get blur(){return this.strength}set blur(e){this.padding=1+Math.abs(e)*2,this.strength=e}get quality(){return this._quality}set quality(e){this._quality=e,this.passes=e}}class zZ extends Lr{constructor(e=8,n=4,r=Lr.defaultResolution,i=5){super(),this._repeatEdgePixels=!1,this.blurXFilter=new qw(!0,e,n,r,i),this.blurYFilter=new qw(!1,e,n,r,i),this.resolution=r,this.quality=n,this.blur=e,this.repeatEdgePixels=!1}apply(e,n,r,i){const s=Math.abs(this.blurXFilter.strength),o=Math.abs(this.blurYFilter.strength);if(s&&o){const a=e.getFilterTexture();this.blurXFilter.apply(e,n,a,Zs.CLEAR),this.blurYFilter.apply(e,a,r,i),e.returnFilterTexture(a)}else o?this.blurYFilter.apply(e,n,r,i):this.blurXFilter.apply(e,n,r,i)}updatePadding(){this._repeatEdgePixels?this.padding=0:this.padding=Math.max(Math.abs(this.blurXFilter.strength),Math.abs(this.blurYFilter.strength))*2}get blur(){return this.blurXFilter.blur}set blur(e){this.blurXFilter.blur=this.blurYFilter.blur=e,this.updatePadding()}get quality(){return this.blurXFilter.quality}set quality(e){this.blurXFilter.quality=this.blurYFilter.quality=e}get blurX(){return this.blurXFilter.blur}set blurX(e){this.blurXFilter.blur=e,this.updatePadding()}get blurY(){return this.blurYFilter.blur}set blurY(e){this.blurYFilter.blur=e,this.updatePadding()}get blendMode(){return this.blurYFilter.blendMode}set blendMode(e){this.blurYFilter.blendMode=e}get repeatEdgePixels(){return this._repeatEdgePixels}set repeatEdgePixels(e){this._repeatEdgePixels=e,this.updatePadding()}}var GZ=`varying vec2 vTextureCoord;
uniform sampler2D uSampler;
uniform float m[20];
uniform float uAlpha;

void main(void)
{
    vec4 c = texture2D(uSampler, vTextureCoord);

    if (uAlpha == 0.0) {
        gl_FragColor = c;
        return;
    }

    // Un-premultiply alpha before applying the color matrix. See issue #3539.
    if (c.a > 0.0) {
      c.rgb /= c.a;
    }

    vec4 result;

    result.r = (m[0] * c.r);
        result.r += (m[1] * c.g);
        result.r += (m[2] * c.b);
        result.r += (m[3] * c.a);
        result.r += m[4];

    result.g = (m[5] * c.r);
        result.g += (m[6] * c.g);
        result.g += (m[7] * c.b);
        result.g += (m[8] * c.a);
        result.g += m[9];

    result.b = (m[10] * c.r);
       result.b += (m[11] * c.g);
       result.b += (m[12] * c.b);
       result.b += (m[13] * c.a);
       result.b += m[14];

    result.a = (m[15] * c.r);
       result.a += (m[16] * c.g);
       result.a += (m[17] * c.b);
       result.a += (m[18] * c.a);
       result.a += m[19];

    vec3 rgb = mix(c.rgb, result.rgb, uAlpha);

    // Premultiply alpha again.
    rgb *= result.a;

    gl_FragColor = vec4(rgb, result.a);
}
`;class ay extends Lr{constructor(){const e={m:new Float32Array([1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0]),uAlpha:1};super(C9,GZ,e),this.alpha=1}_loadMatrix(e,n=!1){let r=e;n&&(this._multiply(r,this.uniforms.m,e),r=this._colorMatrix(r)),this.uniforms.m=r}_multiply(e,n,r){return e[0]=n[0]*r[0]+n[1]*r[5]+n[2]*r[10]+n[3]*r[15],e[1]=n[0]*r[1]+n[1]*r[6]+n[2]*r[11]+n[3]*r[16],e[2]=n[0]*r[2]+n[1]*r[7]+n[2]*r[12]+n[3]*r[17],e[3]=n[0]*r[3]+n[1]*r[8]+n[2]*r[13]+n[3]*r[18],e[4]=n[0]*r[4]+n[1]*r[9]+n[2]*r[14]+n[3]*r[19]+n[4],e[5]=n[5]*r[0]+n[6]*r[5]+n[7]*r[10]+n[8]*r[15],e[6]=n[5]*r[1]+n[6]*r[6]+n[7]*r[11]+n[8]*r[16],e[7]=n[5]*r[2]+n[6]*r[7]+n[7]*r[12]+n[8]*r[17],e[8]=n[5]*r[3]+n[6]*r[8]+n[7]*r[13]+n[8]*r[18],e[9]=n[5]*r[4]+n[6]*r[9]+n[7]*r[14]+n[8]*r[19]+n[9],e[10]=n[10]*r[0]+n[11]*r[5]+n[12]*r[10]+n[13]*r[15],e[11]=n[10]*r[1]+n[11]*r[6]+n[12]*r[11]+n[13]*r[16],e[12]=n[10]*r[2]+n[11]*r[7]+n[12]*r[12]+n[13]*r[17],e[13]=n[10]*r[3]+n[11]*r[8]+n[12]*r[13]+n[13]*r[18],e[14]=n[10]*r[4]+n[11]*r[9]+n[12]*r[14]+n[13]*r[19]+n[14],e[15]=n[15]*r[0]+n[16]*r[5]+n[17]*r[10]+n[18]*r[15],e[16]=n[15]*r[1]+n[16]*r[6]+n[17]*r[11]+n[18]*r[16],e[17]=n[15]*r[2]+n[16]*r[7]+n[17]*r[12]+n[18]*r[17],e[18]=n[15]*r[3]+n[16]*r[8]+n[17]*r[13]+n[18]*r[18],e[19]=n[15]*r[4]+n[16]*r[9]+n[17]*r[14]+n[18]*r[19]+n[19],e}_colorMatrix(e){const n=new Float32Array(e);return n[4]/=255,n[9]/=255,n[14]/=255,n[19]/=255,n}brightness(e,n){const r=[e,0,0,0,0,0,e,0,0,0,0,0,e,0,0,0,0,0,1,0];this._loadMatrix(r,n)}tint(e,n){const[r,i,s]=pt.shared.setValue(e).toArray(),o=[r,0,0,0,0,0,i,0,0,0,0,0,s,0,0,0,0,0,1,0];this._loadMatrix(o,n)}greyscale(e,n){const r=[e,e,e,0,0,e,e,e,0,0,e,e,e,0,0,0,0,0,1,0];this._loadMatrix(r,n)}blackAndWhite(e){const n=[.3,.6,.1,0,0,.3,.6,.1,0,0,.3,.6,.1,0,0,0,0,0,1,0];this._loadMatrix(n,e)}hue(e,n){e=(e||0)/180*Math.PI;const r=Math.cos(e),i=Math.sin(e),s=Math.sqrt,o=1/3,a=s(o),l=r+(1-r)*o,c=o*(1-r)-a*i,u=o*(1-r)+a*i,d=o*(1-r)+a*i,h=r+o*(1-r),f=o*(1-r)-a*i,p=o*(1-r)-a*i,m=o*(1-r)+a*i,v=r+o*(1-r),y=[l,c,u,0,0,d,h,f,0,0,p,m,v,0,0,0,0,0,1,0];this._loadMatrix(y,n)}contrast(e,n){const r=(e||0)+1,i=-.5*(r-1),s=[r,0,0,0,i,0,r,0,0,i,0,0,r,0,i,0,0,0,1,0];this._loadMatrix(s,n)}saturate(e=0,n){const r=e*2/3+1,i=(r-1)*-.5,s=[r,i,i,0,0,i,r,i,0,0,i,i,r,0,0,0,0,0,1,0];this._loadMatrix(s,n)}desaturate(){this.saturate(-1)}negative(e){const n=[-1,0,0,1,0,0,-1,0,1,0,0,0,-1,1,0,0,0,0,1,0];this._loadMatrix(n,e)}sepia(e){const n=[.393,.7689999,.18899999,0,0,.349,.6859999,.16799999,0,0,.272,.5339999,.13099999,0,0,0,0,0,1,0];this._loadMatrix(n,e)}technicolor(e){const n=[1.9125277891456083,-.8545344976951645,-.09155508482755585,0,11.793603434377337,-.3087833385928097,1.7658908555458428,-.10601743074722245,0,-70.35205161461398,-.231103377548616,-.7501899197440212,1.847597816108189,0,30.950940869491138,0,0,0,1,0];this._loadMatrix(n,e)}polaroid(e){const n=[1.438,-.062,-.062,0,0,-.122,1.378,-.122,0,0,-.016,-.016,1.483,0,0,0,0,0,1,0];this._loadMatrix(n,e)}toBGR(e){const n=[0,0,1,0,0,0,1,0,0,0,1,0,0,0,0,0,0,0,1,0];this._loadMatrix(n,e)}kodachrome(e){const n=[1.1285582396593525,-.3967382283601348,-.03992559172921793,0,63.72958762196502,-.16404339962244616,1.0835251566291304,-.05498805115633132,0,24.732407896706203,-.16786010706155763,-.5603416277695248,1.6014850761964943,0,35.62982807460946,0,0,0,1,0];this._loadMatrix(n,e)}browni(e){const n=[.5997023498159715,.34553243048391263,-.2708298674538042,0,47.43192855600873,-.037703249837783157,.8609577587992641,.15059552388459913,0,-36.96841498319127,.24113635128153335,-.07441037908422492,.44972182064877153,0,-7.562075277591283,0,0,0,1,0];this._loadMatrix(n,e)}vintage(e){const n=[.6279345635605994,.3202183420819367,-.03965408211312453,0,9.651285835294123,.02578397704808868,.6441188644374771,.03259127616149294,0,7.462829176470591,.0466055556782719,-.0851232987247891,.5241648018700465,0,5.159190588235296,0,0,0,1,0];this._loadMatrix(n,e)}colorTone(e,n,r,i,s){e=e||.2,n=n||.15,r=r||16770432,i=i||3375104;const o=pt.shared,[a,l,c]=o.setValue(r).toArray(),[u,d,h]=o.setValue(i).toArray(),f=[.3,.59,.11,0,0,a,l,c,e,0,u,d,h,n,0,a-u,l-d,c-h,0,0];this._loadMatrix(f,s)}night(e,n){e=e||.1;const r=[e*-2,-e,0,0,0,-e,0,e,0,0,0,e,e*2,0,0,0,0,0,1,0];this._loadMatrix(r,n)}predator(e,n){const r=[11.224130630493164*e,-4.794486999511719*e,-2.8746118545532227*e,0*e,.40342438220977783*e,-3.6330697536468506*e,9.193157196044922*e,-2.951810836791992*e,0*e,-1.316135048866272*e,-3.2184197902679443*e,-4.2375030517578125*e,7.476448059082031*e,0*e,.8044459223747253*e,0,0,0,1,0];this._loadMatrix(r,n)}lsd(e){const n=[2,-.4,.5,0,0,-.5,2,-.4,0,0,-.4,-.5,3,0,0,0,0,0,1,0];this._loadMatrix(n,e)}reset(){const e=[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0];this._loadMatrix(e,!1)}get matrix(){return this.uniforms.m}set matrix(e){this.uniforms.m=e}get alpha(){return this.uniforms.uAlpha}set alpha(e){this.uniforms.uAlpha=e}}ay.prototype.grayscale=ay.prototype.greyscale;var VZ=`varying vec2 vFilterCoord;
varying vec2 vTextureCoord;

uniform vec2 scale;
uniform mat2 rotation;
uniform sampler2D uSampler;
uniform sampler2D mapSampler;

uniform highp vec4 inputSize;
uniform vec4 inputClamp;

void main(void)
{
  vec4 map =  texture2D(mapSampler, vFilterCoord);

  map -= 0.5;
  map.xy = scale * inputSize.zw * (rotation * map.xy);

  gl_FragColor = texture2D(uSampler, clamp(vec2(vTextureCoord.x + map.x, vTextureCoord.y + map.y), inputClamp.xy, inputClamp.zw));
}
`,WZ=`attribute vec2 aVertexPosition;

uniform mat3 projectionMatrix;
uniform mat3 filterMatrix;

varying vec2 vTextureCoord;
varying vec2 vFilterCoord;

uniform vec4 inputSize;
uniform vec4 outputFrame;

vec4 filterVertexPosition( void )
{
    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
}

vec2 filterTextureCoord( void )
{
    return aVertexPosition * (outputFrame.zw * inputSize.zw);
}

void main(void)
{
	gl_Position = filterVertexPosition();
	vTextureCoord = filterTextureCoord();
	vFilterCoord = ( filterMatrix * vec3( vTextureCoord, 1.0)  ).xy;
}
`;class jZ extends Lr{constructor(e,n){const r=new Ze;e.renderable=!1,super(WZ,VZ,{mapSampler:e._texture,filterMatrix:r,scale:{x:1,y:1},rotation:new Float32Array([1,0,0,1])}),this.maskSprite=e,this.maskMatrix=r,n==null&&(n=20),this.scale=new Ke(n,n)}apply(e,n,r,i){this.uniforms.filterMatrix=e.calculateSpriteMatrix(this.maskMatrix,this.maskSprite),this.uniforms.scale.x=this.scale.x,this.uniforms.scale.y=this.scale.y;const s=this.maskSprite.worldTransform,o=Math.sqrt(s.a*s.a+s.b*s.b),a=Math.sqrt(s.c*s.c+s.d*s.d);o!==0&&a!==0&&(this.uniforms.rotation[0]=s.a/o,this.uniforms.rotation[1]=s.b/o,this.uniforms.rotation[2]=s.c/a,this.uniforms.rotation[3]=s.d/a),e.applyFilter(this,n,r,i)}get map(){return this.uniforms.mapSampler}set map(e){this.uniforms.mapSampler=e}}var XZ=`varying vec2 v_rgbNW;
varying vec2 v_rgbNE;
varying vec2 v_rgbSW;
varying vec2 v_rgbSE;
varying vec2 v_rgbM;

varying vec2 vFragCoord;
uniform sampler2D uSampler;
uniform highp vec4 inputSize;


/**
 Basic FXAA implementation based on the code on geeks3d.com with the
 modification that the texture2DLod stuff was removed since it's
 unsupported by WebGL.

 --

 From:
 https://github.com/mitsuhiko/webgl-meincraft

 Copyright (c) 2011 by Armin Ronacher.

 Some rights reserved.

 Redistribution and use in source and binary forms, with or without
 modification, are permitted provided that the following conditions are
 met:

 * Redistributions of source code must retain the above copyright
 notice, this list of conditions and the following disclaimer.

 * Redistributions in binary form must reproduce the above
 copyright notice, this list of conditions and the following
 disclaimer in the documentation and/or other materials provided
 with the distribution.

 * The names of the contributors may not be used to endorse or
 promote products derived from this software without specific
 prior written permission.

 THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS
 "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT
 LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR
 A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT
 OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
 SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
 LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
 DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY
 THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
 (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
 OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 */

#ifndef FXAA_REDUCE_MIN
#define FXAA_REDUCE_MIN   (1.0/ 128.0)
#endif
#ifndef FXAA_REDUCE_MUL
#define FXAA_REDUCE_MUL   (1.0 / 8.0)
#endif
#ifndef FXAA_SPAN_MAX
#define FXAA_SPAN_MAX     8.0
#endif

//optimized version for mobile, where dependent
//texture reads can be a bottleneck
vec4 fxaa(sampler2D tex, vec2 fragCoord, vec2 inverseVP,
          vec2 v_rgbNW, vec2 v_rgbNE,
          vec2 v_rgbSW, vec2 v_rgbSE,
          vec2 v_rgbM) {
    vec4 color;
    vec3 rgbNW = texture2D(tex, v_rgbNW).xyz;
    vec3 rgbNE = texture2D(tex, v_rgbNE).xyz;
    vec3 rgbSW = texture2D(tex, v_rgbSW).xyz;
    vec3 rgbSE = texture2D(tex, v_rgbSE).xyz;
    vec4 texColor = texture2D(tex, v_rgbM);
    vec3 rgbM  = texColor.xyz;
    vec3 luma = vec3(0.299, 0.587, 0.114);
    float lumaNW = dot(rgbNW, luma);
    float lumaNE = dot(rgbNE, luma);
    float lumaSW = dot(rgbSW, luma);
    float lumaSE = dot(rgbSE, luma);
    float lumaM  = dot(rgbM,  luma);
    float lumaMin = min(lumaM, min(min(lumaNW, lumaNE), min(lumaSW, lumaSE)));
    float lumaMax = max(lumaM, max(max(lumaNW, lumaNE), max(lumaSW, lumaSE)));

    mediump vec2 dir;
    dir.x = -((lumaNW + lumaNE) - (lumaSW + lumaSE));
    dir.y =  ((lumaNW + lumaSW) - (lumaNE + lumaSE));

    float dirReduce = max((lumaNW + lumaNE + lumaSW + lumaSE) *
                          (0.25 * FXAA_REDUCE_MUL), FXAA_REDUCE_MIN);

    float rcpDirMin = 1.0 / (min(abs(dir.x), abs(dir.y)) + dirReduce);
    dir = min(vec2(FXAA_SPAN_MAX, FXAA_SPAN_MAX),
              max(vec2(-FXAA_SPAN_MAX, -FXAA_SPAN_MAX),
                  dir * rcpDirMin)) * inverseVP;

    vec3 rgbA = 0.5 * (
                       texture2D(tex, fragCoord * inverseVP + dir * (1.0 / 3.0 - 0.5)).xyz +
                       texture2D(tex, fragCoord * inverseVP + dir * (2.0 / 3.0 - 0.5)).xyz);
    vec3 rgbB = rgbA * 0.5 + 0.25 * (
                                     texture2D(tex, fragCoord * inverseVP + dir * -0.5).xyz +
                                     texture2D(tex, fragCoord * inverseVP + dir * 0.5).xyz);

    float lumaB = dot(rgbB, luma);
    if ((lumaB < lumaMin) || (lumaB > lumaMax))
        color = vec4(rgbA, texColor.a);
    else
        color = vec4(rgbB, texColor.a);
    return color;
}

void main() {

      vec4 color;

      color = fxaa(uSampler, vFragCoord, inputSize.zw, v_rgbNW, v_rgbNE, v_rgbSW, v_rgbSE, v_rgbM);

      gl_FragColor = color;
}
`,YZ=`
attribute vec2 aVertexPosition;

uniform mat3 projectionMatrix;

varying vec2 v_rgbNW;
varying vec2 v_rgbNE;
varying vec2 v_rgbSW;
varying vec2 v_rgbSE;
varying vec2 v_rgbM;

varying vec2 vFragCoord;

uniform vec4 inputSize;
uniform vec4 outputFrame;

vec4 filterVertexPosition( void )
{
    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
}

void texcoords(vec2 fragCoord, vec2 inverseVP,
               out vec2 v_rgbNW, out vec2 v_rgbNE,
               out vec2 v_rgbSW, out vec2 v_rgbSE,
               out vec2 v_rgbM) {
    v_rgbNW = (fragCoord + vec2(-1.0, -1.0)) * inverseVP;
    v_rgbNE = (fragCoord + vec2(1.0, -1.0)) * inverseVP;
    v_rgbSW = (fragCoord + vec2(-1.0, 1.0)) * inverseVP;
    v_rgbSE = (fragCoord + vec2(1.0, 1.0)) * inverseVP;
    v_rgbM = vec2(fragCoord * inverseVP);
}

void main(void) {

   gl_Position = filterVertexPosition();

   vFragCoord = aVertexPosition * outputFrame.zw;

   texcoords(vFragCoord, inputSize.zw, v_rgbNW, v_rgbNE, v_rgbSW, v_rgbSE, v_rgbM);
}
`;class ZZ extends Lr{constructor(){super(YZ,XZ)}}var KZ=`precision highp float;

varying vec2 vTextureCoord;
varying vec4 vColor;

uniform float uNoise;
uniform float uSeed;
uniform sampler2D uSampler;

float rand(vec2 co)
{
    return fract(sin(dot(co.xy, vec2(12.9898, 78.233))) * 43758.5453);
}

void main()
{
    vec4 color = texture2D(uSampler, vTextureCoord);
    float randomValue = rand(gl_FragCoord.xy * uSeed);
    float diff = (randomValue - 0.5) * uNoise;

    // Un-premultiply alpha before applying the color matrix. See issue #3539.
    if (color.a > 0.0) {
        color.rgb /= color.a;
    }

    color.r += diff;
    color.g += diff;
    color.b += diff;

    // Premultiply alpha again.
    color.rgb *= color.a;

    gl_FragColor = color;
}
`;class qZ extends Lr{constructor(e=.5,n=Math.random()){super(C9,KZ,{uNoise:0,uSeed:0}),this.noise=e,this.seed=n}get noise(){return this.uniforms.uNoise}set noise(e){this.uniforms.uNoise=e}get seed(){return this.uniforms.uSeed}set seed(e){this.uniforms.uSeed=e}}const V5={AlphaFilter:NZ,BlurFilter:zZ,BlurFilterPass:qw,ColorMatrixFilter:ay,DisplacementFilter:jZ,FXAAFilter:ZZ,NoiseFilter:qZ};Object.entries(V5).forEach(([t,e])=>{Object.defineProperty(V5,t,{get(){return Qe("7.1.0",`filters.${t} has moved to ${t}`),e}})});class JZ{constructor(){this.interactionFrequency=10,this._deltaTime=0,this._didMove=!1,this.tickerAdded=!1,this._pauseUpdate=!0}init(e){this.removeTickerListener(),this.events=e,this.interactionFrequency=10,this._deltaTime=0,this._didMove=!1,this.tickerAdded=!1,this._pauseUpdate=!0}get pauseUpdate(){return this._pauseUpdate}set pauseUpdate(e){this._pauseUpdate=e}addTickerListener(){this.tickerAdded||!this.domElement||(ci.system.add(this.tickerUpdate,this,Vc.INTERACTION),this.tickerAdded=!0)}removeTickerListener(){this.tickerAdded&&(ci.system.remove(this.tickerUpdate,this),this.tickerAdded=!1)}pointerMoved(){this._didMove=!0}update(){if(!this.domElement||this._pauseUpdate)return;if(this._didMove){this._didMove=!1;return}const e=this.events.rootPointerEvent;this.events.supportsTouchEvents&&e.pointerType==="touch"||globalThis.document.dispatchEvent(new PointerEvent("pointermove",{clientX:e.clientX,clientY:e.clientY}))}tickerUpdate(e){this._deltaTime+=e,!(this._deltaTime<this.interactionFrequency)&&(this._deltaTime=0,this.update())}}const Ma=new JZ;class Fm{constructor(e){this.bubbles=!0,this.cancelBubble=!0,this.cancelable=!1,this.composed=!1,this.defaultPrevented=!1,this.eventPhase=Fm.prototype.NONE,this.propagationStopped=!1,this.propagationImmediatelyStopped=!1,this.layer=new Ke,this.page=new Ke,this.NONE=0,this.CAPTURING_PHASE=1,this.AT_TARGET=2,this.BUBBLING_PHASE=3,this.manager=e}get layerX(){return this.layer.x}get layerY(){return this.layer.y}get pageX(){return this.page.x}get pageY(){return this.page.y}get data(){return this}composedPath(){return this.manager&&(!this.path||this.path[this.path.length-1]!==this.target)&&(this.path=this.target?this.manager.propagationPath(this.target):[]),this.path}initEvent(e,n,r){throw new Error("initEvent() is a legacy DOM API. It is not implemented in the Federated Events API.")}initUIEvent(e,n,r,i,s){throw new Error("initUIEvent() is a legacy DOM API. It is not implemented in the Federated Events API.")}preventDefault(){this.nativeEvent instanceof Event&&this.nativeEvent.cancelable&&this.nativeEvent.preventDefault(),this.defaultPrevented=!0}stopImmediatePropagation(){this.propagationImmediatelyStopped=!0}stopPropagation(){this.propagationStopped=!0}}class ly extends Fm{constructor(){super(...arguments),this.client=new Ke,this.movement=new Ke,this.offset=new Ke,this.global=new Ke,this.screen=new Ke}get clientX(){return this.client.x}get clientY(){return this.client.y}get x(){return this.clientX}get y(){return this.clientY}get movementX(){return this.movement.x}get movementY(){return this.movement.y}get offsetX(){return this.offset.x}get offsetY(){return this.offset.y}get globalX(){return this.global.x}get globalY(){return this.global.y}get screenX(){return this.screen.x}get screenY(){return this.screen.y}getLocalPosition(e,n,r){return e.worldTransform.applyInverse(r||this.global,n)}getModifierState(e){return"getModifierState"in this.nativeEvent&&this.nativeEvent.getModifierState(e)}initMouseEvent(e,n,r,i,s,o,a,l,c,u,d,h,f,p,m){throw new Error("Method not implemented.")}}class Yi extends ly{constructor(){super(...arguments),this.width=0,this.height=0,this.isPrimary=!1}getCoalescedEvents(){return this.type==="pointermove"||this.type==="mousemove"||this.type==="touchmove"?[this]:[]}getPredictedEvents(){throw new Error("getPredictedEvents is not supported!")}}class Sd extends ly{constructor(){super(...arguments),this.DOM_DELTA_PIXEL=0,this.DOM_DELTA_LINE=1,this.DOM_DELTA_PAGE=2}}Sd.DOM_DELTA_PIXEL=0,Sd.DOM_DELTA_LINE=1,Sd.DOM_DELTA_PAGE=2;const QZ=2048,eK=new Ke,jb=new Ke;class tK{constructor(e){this.dispatch=new Lm,this.moveOnAll=!1,this.enableGlobalMoveEvents=!0,this.mappingState={trackingData:{}},this.eventPool=new Map,this._allInteractiveElements=[],this._hitElements=[],this._isPointerMoveEvent=!1,this.rootTarget=e,this.hitPruneFn=this.hitPruneFn.bind(this),this.hitTestFn=this.hitTestFn.bind(this),this.mapPointerDown=this.mapPointerDown.bind(this),this.mapPointerMove=this.mapPointerMove.bind(this),this.mapPointerOut=this.mapPointerOut.bind(this),this.mapPointerOver=this.mapPointerOver.bind(this),this.mapPointerUp=this.mapPointerUp.bind(this),this.mapPointerUpOutside=this.mapPointerUpOutside.bind(this),this.mapWheel=this.mapWheel.bind(this),this.mappingTable={},this.addEventMapping("pointerdown",this.mapPointerDown),this.addEventMapping("pointermove",this.mapPointerMove),this.addEventMapping("pointerout",this.mapPointerOut),this.addEventMapping("pointerleave",this.mapPointerOut),this.addEventMapping("pointerover",this.mapPointerOver),this.addEventMapping("pointerup",this.mapPointerUp),this.addEventMapping("pointerupoutside",this.mapPointerUpOutside),this.addEventMapping("wheel",this.mapWheel)}addEventMapping(e,n){this.mappingTable[e]||(this.mappingTable[e]=[]),this.mappingTable[e].push({fn:n,priority:0}),this.mappingTable[e].sort((r,i)=>r.priority-i.priority)}dispatchEvent(e,n){e.propagationStopped=!1,e.propagationImmediatelyStopped=!1,this.propagate(e,n),this.dispatch.emit(n||e.type,e)}mapEvent(e){if(!this.rootTarget)return;const n=this.mappingTable[e.type];if(n)for(let r=0,i=n.length;r<i;r++)n[r].fn(e);else console.warn(`[EventBoundary]: Event mapping not defined for ${e.type}`)}hitTest(e,n){Ma.pauseUpdate=!0;const r=this._isPointerMoveEvent&&this.enableGlobalMoveEvents?"hitTestMoveRecursive":"hitTestRecursive",i=this[r](this.rootTarget,this.rootTarget.eventMode,eK.set(e,n),this.hitTestFn,this.hitPruneFn);return i&&i[0]}propagate(e,n){if(!e.target)return;const r=e.composedPath();e.eventPhase=e.CAPTURING_PHASE;for(let i=0,s=r.length-1;i<s;i++)if(e.currentTarget=r[i],this.notifyTarget(e,n),e.propagationStopped||e.propagationImmediatelyStopped)return;if(e.eventPhase=e.AT_TARGET,e.currentTarget=e.target,this.notifyTarget(e,n),!(e.propagationStopped||e.propagationImmediatelyStopped)){e.eventPhase=e.BUBBLING_PHASE;for(let i=r.length-2;i>=0;i--)if(e.currentTarget=r[i],this.notifyTarget(e,n),e.propagationStopped||e.propagationImmediatelyStopped)return}}all(e,n,r=this._allInteractiveElements){if(r.length===0)return;e.eventPhase=e.BUBBLING_PHASE;const i=Array.isArray(n)?n:[n];for(let s=r.length-1;s>=0;s--)i.forEach(o=>{e.currentTarget=r[s],this.notifyTarget(e,o)})}propagationPath(e){const n=[e];for(let r=0;r<QZ&&e!==this.rootTarget;r++){if(!e.parent)throw new Error("Cannot find propagation path to disconnected target");n.push(e.parent),e=e.parent}return n.reverse(),n}hitTestMoveRecursive(e,n,r,i,s,o=!1){let a=!1;if(this._interactivePrune(e))return null;if((e.eventMode==="dynamic"||n==="dynamic")&&(Ma.pauseUpdate=!1),e.interactiveChildren&&e.children){const u=e.children;for(let d=u.length-1;d>=0;d--){const h=u[d],f=this.hitTestMoveRecursive(h,this._isInteractive(n)?n:h.eventMode,r,i,s,o||s(e,r));if(f){if(f.length>0&&!f[f.length-1].parent)continue;const p=e.isInteractive();(f.length>0||p)&&(p&&this._allInteractiveElements.push(e),f.push(e)),this._hitElements.length===0&&(this._hitElements=f),a=!0}}}const l=this._isInteractive(n),c=e.isInteractive();return l&&c&&this._allInteractiveElements.push(e),o||this._hitElements.length>0?null:a?this._hitElements:l&&!s(e,r)&&i(e,r)?c?[e]:[]:null}hitTestRecursive(e,n,r,i,s){if(this._interactivePrune(e)||s(e,r))return null;if((e.eventMode==="dynamic"||n==="dynamic")&&(Ma.pauseUpdate=!1),e.interactiveChildren&&e.children){const l=e.children;for(let c=l.length-1;c>=0;c--){const u=l[c],d=this.hitTestRecursive(u,this._isInteractive(n)?n:u.eventMode,r,i,s);if(d){if(d.length>0&&!d[d.length-1].parent)continue;const h=e.isInteractive();return(d.length>0||h)&&d.push(e),d}}}const o=this._isInteractive(n),a=e.isInteractive();return o&&i(e,r)?a?[e]:[]:null}_isInteractive(e){return e==="static"||e==="dynamic"}_interactivePrune(e){return!!(!e||e.isMask||!e.visible||!e.renderable||e.eventMode==="none"||e.eventMode==="passive"&&!e.interactiveChildren||e.isMask)}hitPruneFn(e,n){var r;if(e.hitArea&&(e.worldTransform.applyInverse(n,jb),!e.hitArea.contains(jb.x,jb.y)))return!0;if(e._mask){const i=e._mask.isMaskData?e._mask.maskObject:e._mask;if(i&&!((r=i.containsPoint)!=null&&r.call(i,n)))return!0}return!1}hitTestFn(e,n){return e.eventMode==="passive"?!1:e.hitArea?!0:e.containsPoint?e.containsPoint(n):!1}notifyTarget(e,n){var s,o;n=n??e.type;const r=`on${n}`;(o=(s=e.currentTarget)[r])==null||o.call(s,e);const i=e.eventPhase===e.CAPTURING_PHASE||e.eventPhase===e.AT_TARGET?`${n}capture`:n;this.notifyListeners(e,i),e.eventPhase===e.AT_TARGET&&this.notifyListeners(e,n)}mapPointerDown(e){if(!(e instanceof Yi)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}const n=this.createPointerEvent(e);if(this.dispatchEvent(n,"pointerdown"),n.pointerType==="touch")this.dispatchEvent(n,"touchstart");else if(n.pointerType==="mouse"||n.pointerType==="pen"){const i=n.button===2;this.dispatchEvent(n,i?"rightdown":"mousedown")}const r=this.trackingData(e.pointerId);r.pressTargetsByButton[e.button]=n.composedPath(),this.freeEvent(n)}mapPointerMove(e){var l,c;if(!(e instanceof Yi)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}this._allInteractiveElements.length=0,this._hitElements.length=0,this._isPointerMoveEvent=!0;const n=this.createPointerEvent(e);this._isPointerMoveEvent=!1;const r=n.pointerType==="mouse"||n.pointerType==="pen",i=this.trackingData(e.pointerId),s=this.findMountedTarget(i.overTargets);if(((l=i.overTargets)==null?void 0:l.length)>0&&s!==n.target){const u=e.type==="mousemove"?"mouseout":"pointerout",d=this.createPointerEvent(e,u,s);if(this.dispatchEvent(d,"pointerout"),r&&this.dispatchEvent(d,"mouseout"),!n.composedPath().includes(s)){const h=this.createPointerEvent(e,"pointerleave",s);for(h.eventPhase=h.AT_TARGET;h.target&&!n.composedPath().includes(h.target);)h.currentTarget=h.target,this.notifyTarget(h),r&&this.notifyTarget(h,"mouseleave"),h.target=h.target.parent;this.freeEvent(h)}this.freeEvent(d)}if(s!==n.target){const u=e.type==="mousemove"?"mouseover":"pointerover",d=this.clonePointerEvent(n,u);this.dispatchEvent(d,"pointerover"),r&&this.dispatchEvent(d,"mouseover");let h=s==null?void 0:s.parent;for(;h&&h!==this.rootTarget.parent&&h!==n.target;)h=h.parent;if(!h||h===this.rootTarget.parent){const f=this.clonePointerEvent(n,"pointerenter");for(f.eventPhase=f.AT_TARGET;f.target&&f.target!==s&&f.target!==this.rootTarget.parent;)f.currentTarget=f.target,this.notifyTarget(f),r&&this.notifyTarget(f,"mouseenter"),f.target=f.target.parent;this.freeEvent(f)}this.freeEvent(d)}const o=[],a=this.enableGlobalMoveEvents??!0;this.moveOnAll?o.push("pointermove"):this.dispatchEvent(n,"pointermove"),a&&o.push("globalpointermove"),n.pointerType==="touch"&&(this.moveOnAll?o.splice(1,0,"touchmove"):this.dispatchEvent(n,"touchmove"),a&&o.push("globaltouchmove")),r&&(this.moveOnAll?o.splice(1,0,"mousemove"):this.dispatchEvent(n,"mousemove"),a&&o.push("globalmousemove"),this.cursor=(c=n.target)==null?void 0:c.cursor),o.length>0&&this.all(n,o),this._allInteractiveElements.length=0,this._hitElements.length=0,i.overTargets=n.composedPath(),this.freeEvent(n)}mapPointerOver(e){var o;if(!(e instanceof Yi)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}const n=this.trackingData(e.pointerId),r=this.createPointerEvent(e),i=r.pointerType==="mouse"||r.pointerType==="pen";this.dispatchEvent(r,"pointerover"),i&&this.dispatchEvent(r,"mouseover"),r.pointerType==="mouse"&&(this.cursor=(o=r.target)==null?void 0:o.cursor);const s=this.clonePointerEvent(r,"pointerenter");for(s.eventPhase=s.AT_TARGET;s.target&&s.target!==this.rootTarget.parent;)s.currentTarget=s.target,this.notifyTarget(s),i&&this.notifyTarget(s,"mouseenter"),s.target=s.target.parent;n.overTargets=r.composedPath(),this.freeEvent(r),this.freeEvent(s)}mapPointerOut(e){if(!(e instanceof Yi)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}const n=this.trackingData(e.pointerId);if(n.overTargets){const r=e.pointerType==="mouse"||e.pointerType==="pen",i=this.findMountedTarget(n.overTargets),s=this.createPointerEvent(e,"pointerout",i);this.dispatchEvent(s),r&&this.dispatchEvent(s,"mouseout");const o=this.createPointerEvent(e,"pointerleave",i);for(o.eventPhase=o.AT_TARGET;o.target&&o.target!==this.rootTarget.parent;)o.currentTarget=o.target,this.notifyTarget(o),r&&this.notifyTarget(o,"mouseleave"),o.target=o.target.parent;n.overTargets=null,this.freeEvent(s),this.freeEvent(o)}this.cursor=null}mapPointerUp(e){if(!(e instanceof Yi)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}const n=performance.now(),r=this.createPointerEvent(e);if(this.dispatchEvent(r,"pointerup"),r.pointerType==="touch")this.dispatchEvent(r,"touchend");else if(r.pointerType==="mouse"||r.pointerType==="pen"){const a=r.button===2;this.dispatchEvent(r,a?"rightup":"mouseup")}const i=this.trackingData(e.pointerId),s=this.findMountedTarget(i.pressTargetsByButton[e.button]);let o=s;if(s&&!r.composedPath().includes(s)){let a=s;for(;a&&!r.composedPath().includes(a);){if(r.currentTarget=a,this.notifyTarget(r,"pointerupoutside"),r.pointerType==="touch")this.notifyTarget(r,"touchendoutside");else if(r.pointerType==="mouse"||r.pointerType==="pen"){const l=r.button===2;this.notifyTarget(r,l?"rightupoutside":"mouseupoutside")}a=a.parent}delete i.pressTargetsByButton[e.button],o=a}if(o){const a=this.clonePointerEvent(r,"click");a.target=o,a.path=null,i.clicksByButton[e.button]||(i.clicksByButton[e.button]={clickCount:0,target:a.target,timeStamp:n});const l=i.clicksByButton[e.button];if(l.target===a.target&&n-l.timeStamp<200?++l.clickCount:l.clickCount=1,l.target=a.target,l.timeStamp=n,a.detail=l.clickCount,a.pointerType==="mouse"){const c=a.button===2;this.dispatchEvent(a,c?"rightclick":"click")}else a.pointerType==="touch"&&this.dispatchEvent(a,"tap");this.dispatchEvent(a,"pointertap"),this.freeEvent(a)}this.freeEvent(r)}mapPointerUpOutside(e){if(!(e instanceof Yi)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}const n=this.trackingData(e.pointerId),r=this.findMountedTarget(n.pressTargetsByButton[e.button]),i=this.createPointerEvent(e);if(r){let s=r;for(;s;)i.currentTarget=s,this.notifyTarget(i,"pointerupoutside"),i.pointerType==="touch"?this.notifyTarget(i,"touchendoutside"):(i.pointerType==="mouse"||i.pointerType==="pen")&&this.notifyTarget(i,i.button===2?"rightupoutside":"mouseupoutside"),s=s.parent;delete n.pressTargetsByButton[e.button]}this.freeEvent(i)}mapWheel(e){if(!(e instanceof Sd)){console.warn("EventBoundary cannot map a non-wheel event as a wheel event");return}const n=this.createWheelEvent(e);this.dispatchEvent(n),this.freeEvent(n)}findMountedTarget(e){if(!e)return null;let n=e[0];for(let r=1;r<e.length&&e[r].parent===n;r++)n=e[r];return n}createPointerEvent(e,n,r){const i=this.allocateEvent(Yi);return this.copyPointerData(e,i),this.copyMouseData(e,i),this.copyData(e,i),i.nativeEvent=e.nativeEvent,i.originalEvent=e,i.target=r??this.hitTest(i.global.x,i.global.y)??this._hitElements[0],typeof n=="string"&&(i.type=n),i}createWheelEvent(e){const n=this.allocateEvent(Sd);return this.copyWheelData(e,n),this.copyMouseData(e,n),this.copyData(e,n),n.nativeEvent=e.nativeEvent,n.originalEvent=e,n.target=this.hitTest(n.global.x,n.global.y),n}clonePointerEvent(e,n){const r=this.allocateEvent(Yi);return r.nativeEvent=e.nativeEvent,r.originalEvent=e.originalEvent,this.copyPointerData(e,r),this.copyMouseData(e,r),this.copyData(e,r),r.target=e.target,r.path=e.composedPath().slice(),r.type=n??r.type,r}copyWheelData(e,n){n.deltaMode=e.deltaMode,n.deltaX=e.deltaX,n.deltaY=e.deltaY,n.deltaZ=e.deltaZ}copyPointerData(e,n){e instanceof Yi&&n instanceof Yi&&(n.pointerId=e.pointerId,n.width=e.width,n.height=e.height,n.isPrimary=e.isPrimary,n.pointerType=e.pointerType,n.pressure=e.pressure,n.tangentialPressure=e.tangentialPressure,n.tiltX=e.tiltX,n.tiltY=e.tiltY,n.twist=e.twist)}copyMouseData(e,n){e instanceof ly&&n instanceof ly&&(n.altKey=e.altKey,n.button=e.button,n.buttons=e.buttons,n.client.copyFrom(e.client),n.ctrlKey=e.ctrlKey,n.metaKey=e.metaKey,n.movement.copyFrom(e.movement),n.screen.copyFrom(e.screen),n.shiftKey=e.shiftKey,n.global.copyFrom(e.global))}copyData(e,n){n.isTrusted=e.isTrusted,n.srcElement=e.srcElement,n.timeStamp=performance.now(),n.type=e.type,n.detail=e.detail,n.view=e.view,n.which=e.which,n.layer.copyFrom(e.layer),n.page.copyFrom(e.page)}trackingData(e){return this.mappingState.trackingData[e]||(this.mappingState.trackingData[e]={pressTargetsByButton:{},clicksByButton:{},overTarget:null}),this.mappingState.trackingData[e]}allocateEvent(e){this.eventPool.has(e)||this.eventPool.set(e,[]);const n=this.eventPool.get(e).pop()||new e(this);return n.eventPhase=n.NONE,n.currentTarget=null,n.path=null,n.target=null,n}freeEvent(e){if(e.manager!==this)throw new Error("It is illegal to free an event not managed by this EventBoundary!");const n=e.constructor;this.eventPool.has(n)||this.eventPool.set(n,[]),this.eventPool.get(n).push(e)}notifyListeners(e,n){const r=e.currentTarget._events[n];if(r&&e.currentTarget.isInteractive())if("fn"in r)r.once&&e.currentTarget.removeListener(n,r.fn,void 0,!0),r.fn.call(r.context,e);else for(let i=0,s=r.length;i<s&&!e.propagationImmediatelyStopped;i++)r[i].once&&e.currentTarget.removeListener(n,r[i].fn,void 0,!0),r[i].fn.call(r[i].context,e)}}const nK=1,rK={touchstart:"pointerdown",touchend:"pointerup",touchendoutside:"pointerupoutside",touchmove:"pointermove",touchcancel:"pointercancel"},Jw=class Qw{constructor(e){this.supportsTouchEvents="ontouchstart"in globalThis,this.supportsPointerEvents=!!globalThis.PointerEvent,this.domElement=null,this.resolution=1,this.renderer=e,this.rootBoundary=new tK(null),Ma.init(this),this.autoPreventDefault=!0,this.eventsAdded=!1,this.rootPointerEvent=new Yi(null),this.rootWheelEvent=new Sd(null),this.cursorStyles={default:"inherit",pointer:"pointer"},this.features=new Proxy({...Qw.defaultEventFeatures},{set:(n,r,i)=>(r==="globalMove"&&(this.rootBoundary.enableGlobalMoveEvents=i),n[r]=i,!0)}),this.onPointerDown=this.onPointerDown.bind(this),this.onPointerMove=this.onPointerMove.bind(this),this.onPointerUp=this.onPointerUp.bind(this),this.onPointerOverOut=this.onPointerOverOut.bind(this),this.onWheel=this.onWheel.bind(this)}static get defaultEventMode(){return this._defaultEventMode}init(e){const{view:n,resolution:r}=this.renderer;this.setTargetElement(n),this.resolution=r,Qw._defaultEventMode=e.eventMode??"auto",Object.assign(this.features,e.eventFeatures??{}),this.rootBoundary.enableGlobalMoveEvents=this.features.globalMove}resolutionChange(e){this.resolution=e}destroy(){this.setTargetElement(null),this.renderer=null}setCursor(e){e=e||"default";let n=!0;if(globalThis.OffscreenCanvas&&this.domElement instanceof OffscreenCanvas&&(n=!1),this.currentCursor===e)return;this.currentCursor=e;const r=this.cursorStyles[e];if(r)switch(typeof r){case"string":n&&(this.domElement.style.cursor=r);break;case"function":r(e);break;case"object":n&&Object.assign(this.domElement.style,r);break}else n&&typeof e=="string"&&!Object.prototype.hasOwnProperty.call(this.cursorStyles,e)&&(this.domElement.style.cursor=e)}get pointer(){return this.rootPointerEvent}onPointerDown(e){if(!this.features.click)return;this.rootBoundary.rootTarget=this.renderer.lastObjectRendered;const n=this.normalizeToPointerData(e);this.autoPreventDefault&&n[0].isNormalized&&(e.cancelable||!("cancelable"in e))&&e.preventDefault();for(let r=0,i=n.length;r<i;r++){const s=n[r],o=this.bootstrapEvent(this.rootPointerEvent,s);this.rootBoundary.mapEvent(o)}this.setCursor(this.rootBoundary.cursor)}onPointerMove(e){if(!this.features.move)return;this.rootBoundary.rootTarget=this.renderer.lastObjectRendered,Ma.pointerMoved();const n=this.normalizeToPointerData(e);for(let r=0,i=n.length;r<i;r++){const s=this.bootstrapEvent(this.rootPointerEvent,n[r]);this.rootBoundary.mapEvent(s)}this.setCursor(this.rootBoundary.cursor)}onPointerUp(e){if(!this.features.click)return;this.rootBoundary.rootTarget=this.renderer.lastObjectRendered;let n=e.target;e.composedPath&&e.composedPath().length>0&&(n=e.composedPath()[0]);const r=n!==this.domElement?"outside":"",i=this.normalizeToPointerData(e);for(let s=0,o=i.length;s<o;s++){const a=this.bootstrapEvent(this.rootPointerEvent,i[s]);a.type+=r,this.rootBoundary.mapEvent(a)}this.setCursor(this.rootBoundary.cursor)}onPointerOverOut(e){if(!this.features.click)return;this.rootBoundary.rootTarget=this.renderer.lastObjectRendered;const n=this.normalizeToPointerData(e);for(let r=0,i=n.length;r<i;r++){const s=this.bootstrapEvent(this.rootPointerEvent,n[r]);this.rootBoundary.mapEvent(s)}this.setCursor(this.rootBoundary.cursor)}onWheel(e){if(!this.features.wheel)return;const n=this.normalizeWheelEvent(e);this.rootBoundary.rootTarget=this.renderer.lastObjectRendered,this.rootBoundary.mapEvent(n)}setTargetElement(e){this.removeEvents(),this.domElement=e,Ma.domElement=e,this.addEvents()}addEvents(){if(this.eventsAdded||!this.domElement)return;Ma.addTickerListener();const e=this.domElement.style;e&&(globalThis.navigator.msPointerEnabled?(e.msContentZooming="none",e.msTouchAction="none"):this.supportsPointerEvents&&(e.touchAction="none")),this.supportsPointerEvents?(globalThis.document.addEventListener("pointermove",this.onPointerMove,!0),this.domElement.addEventListener("pointerdown",this.onPointerDown,!0),this.domElement.addEventListener("pointerleave",this.onPointerOverOut,!0),this.domElement.addEventListener("pointerover",this.onPointerOverOut,!0),globalThis.addEventListener("pointerup",this.onPointerUp,!0)):(globalThis.document.addEventListener("mousemove",this.onPointerMove,!0),this.domElement.addEventListener("mousedown",this.onPointerDown,!0),this.domElement.addEventListener("mouseout",this.onPointerOverOut,!0),this.domElement.addEventListener("mouseover",this.onPointerOverOut,!0),globalThis.addEventListener("mouseup",this.onPointerUp,!0),this.supportsTouchEvents&&(this.domElement.addEventListener("touchstart",this.onPointerDown,!0),this.domElement.addEventListener("touchend",this.onPointerUp,!0),this.domElement.addEventListener("touchmove",this.onPointerMove,!0))),this.domElement.addEventListener("wheel",this.onWheel,{passive:!0,capture:!0}),this.eventsAdded=!0}removeEvents(){if(!this.eventsAdded||!this.domElement)return;Ma.removeTickerListener();const e=this.domElement.style;globalThis.navigator.msPointerEnabled?(e.msContentZooming="",e.msTouchAction=""):this.supportsPointerEvents&&(e.touchAction=""),this.supportsPointerEvents?(globalThis.document.removeEventListener("pointermove",this.onPointerMove,!0),this.domElement.removeEventListener("pointerdown",this.onPointerDown,!0),this.domElement.removeEventListener("pointerleave",this.onPointerOverOut,!0),this.domElement.removeEventListener("pointerover",this.onPointerOverOut,!0),globalThis.removeEventListener("pointerup",this.onPointerUp,!0)):(globalThis.document.removeEventListener("mousemove",this.onPointerMove,!0),this.domElement.removeEventListener("mousedown",this.onPointerDown,!0),this.domElement.removeEventListener("mouseout",this.onPointerOverOut,!0),this.domElement.removeEventListener("mouseover",this.onPointerOverOut,!0),globalThis.removeEventListener("mouseup",this.onPointerUp,!0),this.supportsTouchEvents&&(this.domElement.removeEventListener("touchstart",this.onPointerDown,!0),this.domElement.removeEventListener("touchend",this.onPointerUp,!0),this.domElement.removeEventListener("touchmove",this.onPointerMove,!0))),this.domElement.removeEventListener("wheel",this.onWheel,!0),this.domElement=null,this.eventsAdded=!1}mapPositionToPoint(e,n,r){const i=this.domElement.isConnected?this.domElement.getBoundingClientRect():{x:0,y:0,width:this.domElement.width,height:this.domElement.height,left:0,top:0},s=1/this.resolution;e.x=(n-i.left)*(this.domElement.width/i.width)*s,e.y=(r-i.top)*(this.domElement.height/i.height)*s}normalizeToPointerData(e){const n=[];if(this.supportsTouchEvents&&e instanceof TouchEvent)for(let r=0,i=e.changedTouches.length;r<i;r++){const s=e.changedTouches[r];typeof s.button>"u"&&(s.button=0),typeof s.buttons>"u"&&(s.buttons=1),typeof s.isPrimary>"u"&&(s.isPrimary=e.touches.length===1&&e.type==="touchstart"),typeof s.width>"u"&&(s.width=s.radiusX||1),typeof s.height>"u"&&(s.height=s.radiusY||1),typeof s.tiltX>"u"&&(s.tiltX=0),typeof s.tiltY>"u"&&(s.tiltY=0),typeof s.pointerType>"u"&&(s.pointerType="touch"),typeof s.pointerId>"u"&&(s.pointerId=s.identifier||0),typeof s.pressure>"u"&&(s.pressure=s.force||.5),typeof s.twist>"u"&&(s.twist=0),typeof s.tangentialPressure>"u"&&(s.tangentialPressure=0),typeof s.layerX>"u"&&(s.layerX=s.offsetX=s.clientX),typeof s.layerY>"u"&&(s.layerY=s.offsetY=s.clientY),s.isNormalized=!0,s.type=e.type,n.push(s)}else if(!globalThis.MouseEvent||e instanceof MouseEvent&&(!this.supportsPointerEvents||!(e instanceof globalThis.PointerEvent))){const r=e;typeof r.isPrimary>"u"&&(r.isPrimary=!0),typeof r.width>"u"&&(r.width=1),typeof r.height>"u"&&(r.height=1),typeof r.tiltX>"u"&&(r.tiltX=0),typeof r.tiltY>"u"&&(r.tiltY=0),typeof r.pointerType>"u"&&(r.pointerType="mouse"),typeof r.pointerId>"u"&&(r.pointerId=nK),typeof r.pressure>"u"&&(r.pressure=.5),typeof r.twist>"u"&&(r.twist=0),typeof r.tangentialPressure>"u"&&(r.tangentialPressure=0),r.isNormalized=!0,n.push(r)}else n.push(e);return n}normalizeWheelEvent(e){const n=this.rootWheelEvent;return this.transferMouseData(n,e),n.deltaX=e.deltaX,n.deltaY=e.deltaY,n.deltaZ=e.deltaZ,n.deltaMode=e.deltaMode,this.mapPositionToPoint(n.screen,e.clientX,e.clientY),n.global.copyFrom(n.screen),n.offset.copyFrom(n.screen),n.nativeEvent=e,n.type=e.type,n}bootstrapEvent(e,n){return e.originalEvent=null,e.nativeEvent=n,e.pointerId=n.pointerId,e.width=n.width,e.height=n.height,e.isPrimary=n.isPrimary,e.pointerType=n.pointerType,e.pressure=n.pressure,e.tangentialPressure=n.tangentialPressure,e.tiltX=n.tiltX,e.tiltY=n.tiltY,e.twist=n.twist,this.transferMouseData(e,n),this.mapPositionToPoint(e.screen,n.clientX,n.clientY),e.global.copyFrom(e.screen),e.offset.copyFrom(e.screen),e.isTrusted=n.isTrusted,e.type==="pointerleave"&&(e.type="pointerout"),e.type.startsWith("mouse")&&(e.type=e.type.replace("mouse","pointer")),e.type.startsWith("touch")&&(e.type=rK[e.type]||e.type),e}transferMouseData(e,n){e.isTrusted=n.isTrusted,e.srcElement=n.srcElement,e.timeStamp=performance.now(),e.type=n.type,e.altKey=n.altKey,e.button=n.button,e.buttons=n.buttons,e.client.x=n.clientX,e.client.y=n.clientY,e.ctrlKey=n.ctrlKey,e.metaKey=n.metaKey,e.movement.x=n.movementX,e.movement.y=n.movementY,e.page.x=n.pageX,e.page.y=n.pageY,e.relatedTarget=null,e.shiftKey=n.shiftKey}};Jw.extension={name:"events",type:[me.RendererSystem,me.CanvasRendererSystem]},Jw.defaultEventFeatures={move:!0,globalMove:!0,click:!0,wheel:!0};let ex=Jw;Ce.add(ex);function W5(t){return t==="dynamic"||t==="static"}const iK={onclick:null,onmousedown:null,onmouseenter:null,onmouseleave:null,onmousemove:null,onglobalmousemove:null,onmouseout:null,onmouseover:null,onmouseup:null,onmouseupoutside:null,onpointercancel:null,onpointerdown:null,onpointerenter:null,onpointerleave:null,onpointermove:null,onglobalpointermove:null,onpointerout:null,onpointerover:null,onpointertap:null,onpointerup:null,onpointerupoutside:null,onrightclick:null,onrightdown:null,onrightup:null,onrightupoutside:null,ontap:null,ontouchcancel:null,ontouchend:null,ontouchendoutside:null,ontouchmove:null,onglobaltouchmove:null,ontouchstart:null,onwheel:null,_internalInteractive:void 0,get interactive(){return this._internalInteractive??W5(ex.defaultEventMode)},set interactive(t){Qe("7.2.0","Setting interactive is deprecated, use eventMode = 'none'/'passive'/'auto'/'static'/'dynamic' instead."),this._internalInteractive=t,this.eventMode=t?"static":"auto"},_internalEventMode:void 0,get eventMode(){return this._internalEventMode??ex.defaultEventMode},set eventMode(t){this._internalInteractive=W5(t),this._internalEventMode=t},isInteractive(){return this.eventMode==="static"||this.eventMode==="dynamic"},interactiveChildren:!0,hitArea:null,addEventListener(t,e,n){const r=typeof n=="boolean"&&n||typeof n=="object"&&n.capture,i=typeof e=="function"?void 0:e;t=r?`${t}capture`:t,e=typeof e=="function"?e:e.handleEvent,this.on(t,e,i)},removeEventListener(t,e,n){const r=typeof n=="boolean"&&n||typeof n=="object"&&n.capture,i=typeof e=="function"?void 0:e;t=r?`${t}capture`:t,e=typeof e=="function"?e:e.handleEvent,this.off(t,e,i)},dispatchEvent(t){if(!(t instanceof Fm))throw new Error("DisplayObject cannot propagate events outside of the Federated Events API");return t.defaultPrevented=!1,t.path=null,t.target=this,t.manager.dispatchEvent(t),!t.defaultPrevented}};Zt.mixin(iK);const sK={accessible:!1,accessibleTitle:null,accessibleHint:null,tabIndex:0,_accessibleActive:!1,_accessibleDiv:null,accessibleType:"button",accessiblePointerEvents:"auto",accessibleChildren:!0,renderId:-1};Zt.mixin(sK);const oK=9,H1=100,aK=0,lK=0,j5=2,X5=1,cK=-1e3,uK=-1e3,dK=2;class D9{constructor(e){this.debug=!1,this._isActive=!1,this._isMobileAccessibility=!1,this.pool=[],this.renderId=0,this.children=[],this.androidUpdateCount=0,this.androidUpdateFrequency=500,this._hookDiv=null,(Fo.tablet||Fo.phone)&&this.createTouchHook();const n=document.createElement("div");n.style.width=`${H1}px`,n.style.height=`${H1}px`,n.style.position="absolute",n.style.top=`${aK}px`,n.style.left=`${lK}px`,n.style.zIndex=j5.toString(),this.div=n,this.renderer=e,this._onKeyDown=this._onKeyDown.bind(this),this._onMouseMove=this._onMouseMove.bind(this),globalThis.addEventListener("keydown",this._onKeyDown,!1)}get isActive(){return this._isActive}get isMobileAccessibility(){return this._isMobileAccessibility}createTouchHook(){const e=document.createElement("button");e.style.width=`${X5}px`,e.style.height=`${X5}px`,e.style.position="absolute",e.style.top=`${cK}px`,e.style.left=`${uK}px`,e.style.zIndex=dK.toString(),e.style.backgroundColor="#FF0000",e.title="select to enable accessibility for this content",e.addEventListener("focus",()=>{this._isMobileAccessibility=!0,this.activate(),this.destroyTouchHook()}),document.body.appendChild(e),this._hookDiv=e}destroyTouchHook(){this._hookDiv&&(document.body.removeChild(this._hookDiv),this._hookDiv=null)}activate(){var e;this._isActive||(this._isActive=!0,globalThis.document.addEventListener("mousemove",this._onMouseMove,!0),globalThis.removeEventListener("keydown",this._onKeyDown,!1),this.renderer.on("postrender",this.update,this),(e=this.renderer.view.parentNode)==null||e.appendChild(this.div))}deactivate(){var e;!this._isActive||this._isMobileAccessibility||(this._isActive=!1,globalThis.document.removeEventListener("mousemove",this._onMouseMove,!0),globalThis.addEventListener("keydown",this._onKeyDown,!1),this.renderer.off("postrender",this.update),(e=this.div.parentNode)==null||e.removeChild(this.div))}updateAccessibleObjects(e){if(!e.visible||!e.accessibleChildren)return;e.accessible&&e.isInteractive()&&(e._accessibleActive||this.addChild(e),e.renderId=this.renderId);const n=e.children;if(n)for(let r=0;r<n.length;r++)this.updateAccessibleObjects(n[r])}update(){const e=performance.now();if(Fo.android.device&&e<this.androidUpdateCount||(this.androidUpdateCount=e+this.androidUpdateFrequency,!this.renderer.renderingToScreen))return;this.renderer.lastObjectRendered&&this.updateAccessibleObjects(this.renderer.lastObjectRendered);const{x:n,y:r,width:i,height:s}=this.renderer.view.getBoundingClientRect(),{width:o,height:a,resolution:l}=this.renderer,c=i/o*l,u=s/a*l;let d=this.div;d.style.left=`${n}px`,d.style.top=`${r}px`,d.style.width=`${o}px`,d.style.height=`${a}px`;for(let h=0;h<this.children.length;h++){const f=this.children[h];if(f.renderId!==this.renderId)f._accessibleActive=!1,xd(this.children,h,1),this.div.removeChild(f._accessibleDiv),this.pool.push(f._accessibleDiv),f._accessibleDiv=null,h--;else{d=f._accessibleDiv;let p=f.hitArea;const m=f.worldTransform;f.hitArea?(d.style.left=`${(m.tx+p.x*m.a)*c}px`,d.style.top=`${(m.ty+p.y*m.d)*u}px`,d.style.width=`${p.width*m.a*c}px`,d.style.height=`${p.height*m.d*u}px`):(p=f.getBounds(),this.capHitArea(p),d.style.left=`${p.x*c}px`,d.style.top=`${p.y*u}px`,d.style.width=`${p.width*c}px`,d.style.height=`${p.height*u}px`,d.title!==f.accessibleTitle&&f.accessibleTitle!==null&&(d.title=f.accessibleTitle),d.getAttribute("aria-label")!==f.accessibleHint&&f.accessibleHint!==null&&d.setAttribute("aria-label",f.accessibleHint)),(f.accessibleTitle!==d.title||f.tabIndex!==d.tabIndex)&&(d.title=f.accessibleTitle,d.tabIndex=f.tabIndex,this.debug&&this.updateDebugHTML(d))}}this.renderId++}updateDebugHTML(e){e.innerHTML=`type: ${e.type}</br> title : ${e.title}</br> tabIndex: ${e.tabIndex}`}capHitArea(e){e.x<0&&(e.width+=e.x,e.x=0),e.y<0&&(e.height+=e.y,e.y=0);const{width:n,height:r}=this.renderer;e.x+e.width>n&&(e.width=n-e.x),e.y+e.height>r&&(e.height=r-e.y)}addChild(e){let n=this.pool.pop();n||(n=document.createElement("button"),n.style.width=`${H1}px`,n.style.height=`${H1}px`,n.style.backgroundColor=this.debug?"rgba(255,255,255,0.5)":"transparent",n.style.position="absolute",n.style.zIndex=j5.toString(),n.style.borderStyle="none",navigator.userAgent.toLowerCase().includes("chrome")?n.setAttribute("aria-live","off"):n.setAttribute("aria-live","polite"),navigator.userAgent.match(/rv:.*Gecko\//)?n.setAttribute("aria-relevant","additions"):n.setAttribute("aria-relevant","text"),n.addEventListener("click",this._onClick.bind(this)),n.addEventListener("focus",this._onFocus.bind(this)),n.addEventListener("focusout",this._onFocusOut.bind(this))),n.style.pointerEvents=e.accessiblePointerEvents,n.type=e.accessibleType,e.accessibleTitle&&e.accessibleTitle!==null?n.title=e.accessibleTitle:(!e.accessibleHint||e.accessibleHint===null)&&(n.title=`displayObject ${e.tabIndex}`),e.accessibleHint&&e.accessibleHint!==null&&n.setAttribute("aria-label",e.accessibleHint),this.debug&&this.updateDebugHTML(n),e._accessibleActive=!0,e._accessibleDiv=n,n.displayObject=e,this.children.push(e),this.div.appendChild(e._accessibleDiv),e._accessibleDiv.tabIndex=e.tabIndex}_dispatchEvent(e,n){const{displayObject:r}=e.target,i=this.renderer.events.rootBoundary,s=Object.assign(new Fm(i),{target:r});i.rootTarget=this.renderer.lastObjectRendered,n.forEach(o=>i.dispatchEvent(s,o))}_onClick(e){this._dispatchEvent(e,["click","pointertap","tap"])}_onFocus(e){e.target.getAttribute("aria-live")||e.target.setAttribute("aria-live","assertive"),this._dispatchEvent(e,["mouseover"])}_onFocusOut(e){e.target.getAttribute("aria-live")||e.target.setAttribute("aria-live","polite"),this._dispatchEvent(e,["mouseout"])}_onKeyDown(e){e.keyCode===oK&&this.activate()}_onMouseMove(e){e.movementX===0&&e.movementY===0||this.deactivate()}destroy(){this.destroyTouchHook(),this.div=null,globalThis.document.removeEventListener("mousemove",this._onMouseMove,!0),globalThis.removeEventListener("keydown",this._onKeyDown),this.pool=null,this.children=null,this.renderer=null}}D9.extension={name:"accessibility",type:[me.RendererPlugin,me.CanvasRendererPlugin]};Ce.add(D9);const N9=class tx{constructor(e){this.stage=new Xn,e=Object.assign({forceCanvas:!1},e),this.renderer=wZ(e),tx._plugins.forEach(n=>{n.init.call(this,e)})}render(){this.renderer.render(this.stage)}get view(){var e;return(e=this.renderer)==null?void 0:e.view}get screen(){var e;return(e=this.renderer)==null?void 0:e.screen}destroy(e,n){const r=tx._plugins.slice(0);r.reverse(),r.forEach(i=>{i.destroy.call(this)}),this.stage.destroy(n),this.stage=null,this.renderer.destroy(e),this.renderer=null}};N9._plugins=[];let F9=N9;Ce.handleByList(me.Application,F9._plugins);class B9{static init(e){Object.defineProperty(this,"resizeTo",{set(n){globalThis.removeEventListener("resize",this.queueResize),this._resizeTo=n,n&&(globalThis.addEventListener("resize",this.queueResize),this.resize())},get(){return this._resizeTo}}),this.queueResize=()=>{this._resizeTo&&(this.cancelResize(),this._resizeId=requestAnimationFrame(()=>this.resize()))},this.cancelResize=()=>{this._resizeId&&(cancelAnimationFrame(this._resizeId),this._resizeId=null)},this.resize=()=>{if(!this._resizeTo)return;this.cancelResize();let n,r;if(this._resizeTo===globalThis.window)n=globalThis.innerWidth,r=globalThis.innerHeight;else{const{clientWidth:i,clientHeight:s}=this._resizeTo;n=i,r=s}this.renderer.resize(n,r),this.render()},this._resizeId=null,this._resizeTo=null,this.resizeTo=e.resizeTo||null}static destroy(){globalThis.removeEventListener("resize",this.queueResize),this.cancelResize(),this.cancelResize=null,this.queueResize=null,this.resizeTo=null,this.resize=null}}B9.extension=me.Application;Ce.add(B9);const Y5={loader:me.LoadParser,resolver:me.ResolveParser,cache:me.CacheParser,detection:me.DetectionParser};Ce.handle(me.Asset,t=>{const e=t.ref;Object.entries(Y5).filter(([n])=>!!e[n]).forEach(([n,r])=>Ce.add(Object.assign(e[n],{extension:e[n].extension??r})))},t=>{const e=t.ref;Object.keys(Y5).filter(n=>!!e[n]).forEach(n=>Ce.remove(e[n]))});class hK{constructor(e,n=!1){this._loader=e,this._assetList=[],this._isLoading=!1,this._maxConcurrent=1,this.verbose=n}add(e){e.forEach(n=>{this._assetList.push(n)}),this.verbose&&console.log("[BackgroundLoader] assets: ",this._assetList),this._isActive&&!this._isLoading&&this._next()}async _next(){if(this._assetList.length&&this._isActive){this._isLoading=!0;const e=[],n=Math.min(this._assetList.length,this._maxConcurrent);for(let r=0;r<n;r++)e.push(this._assetList.pop());await this._loader.load(e),this._isLoading=!1,this._next()}}get active(){return this._isActive}set active(e){this._isActive!==e&&(this._isActive=e,e&&!this._isLoading&&this._next())}}function uh(t,e){if(Array.isArray(e)){for(const n of e)if(t.startsWith(`data:${n}`))return!0;return!1}return t.startsWith(`data:${e}`)}function Pl(t,e){const n=t.split("?")[0],r=Rn.extname(n).toLowerCase();return Array.isArray(e)?e.includes(r):r===e}const ss=(t,e,n=!1)=>(Array.isArray(t)||(t=[t]),e?t.map(r=>typeof r=="string"||n?e(r):r):t),nx=(t,e)=>{const n=e.split("?")[1];return n&&(t+=`?${n}`),t};function U9(t,e,n,r,i){const s=e[n];for(let o=0;o<s.length;o++){const a=s[o];n<e.length-1?U9(t.replace(r[n],a),e,n+1,r,i):i.push(t.replace(r[n],a))}}function fK(t){const e=/\{(.*?)\}/g,n=t.match(e),r=[];if(n){const i=[];n.forEach(s=>{const o=s.substring(1,s.length-1).split(",");i.push(o)}),U9(t,i,0,n,r)}else r.push(t);return r}const cy=t=>!Array.isArray(t);class pK{constructor(){this._parsers=[],this._cache=new Map,this._cacheMap=new Map}reset(){this._cacheMap.clear(),this._cache.clear()}has(e){return this._cache.has(e)}get(e){const n=this._cache.get(e);return n||console.warn(`[Assets] Asset id ${e} was not found in the Cache`),n}set(e,n){const r=ss(e);let i;for(let a=0;a<this.parsers.length;a++){const l=this.parsers[a];if(l.test(n)){i=l.getCacheableAssets(r,n);break}}i||(i={},r.forEach(a=>{i[a]=n}));const s=Object.keys(i),o={cacheKeys:s,keys:r};if(r.forEach(a=>{this._cacheMap.set(a,o)}),s.forEach(a=>{this._cache.has(a)&&this._cache.get(a)!==n&&console.warn("[Cache] already has key:",a),this._cache.set(a,i[a])}),n instanceof he){const a=n;r.forEach(l=>{a.baseTexture!==he.EMPTY.baseTexture&&ze.addToCache(a.baseTexture,l),he.addToCache(a,l)})}}remove(e){if(!this._cacheMap.has(e)){console.warn(`[Assets] Asset id ${e} was not found in the Cache`);return}const n=this._cacheMap.get(e);n.cacheKeys.forEach(r=>{this._cache.delete(r)}),n.keys.forEach(r=>{this._cacheMap.delete(r)})}get parsers(){return this._parsers}}const sc=new pK;class mK{constructor(){this._parsers=[],this._parsersValidated=!1,this.parsers=new Proxy(this._parsers,{set:(e,n,r)=>(this._parsersValidated=!1,e[n]=r,!0)}),this.promiseCache={}}reset(){this._parsersValidated=!1,this.promiseCache={}}_getLoadPromiseAndParser(e,n){const r={promise:null,parser:null};return r.promise=(async()=>{var o,a;let i=null,s=null;if(n.loadParser&&(s=this._parserHash[n.loadParser],s||console.warn(`[Assets] specified load parser "${n.loadParser}" not found while loading ${e}`)),!s){for(let l=0;l<this.parsers.length;l++){const c=this.parsers[l];if(c.load&&((o=c.test)!=null&&o.call(c,e,n,this))){s=c;break}}if(!s)return console.warn(`[Assets] ${e} could not be loaded as we don't know how to parse it, ensure the correct parser has been added`),null}i=await s.load(e,n,this),r.parser=s;for(let l=0;l<this.parsers.length;l++){const c=this.parsers[l];c.parse&&c.parse&&await((a=c.testParse)==null?void 0:a.call(c,i,n,this))&&(i=await c.parse(i,n,this)||i,r.parser=c)}return i})(),r}async load(e,n){this._parsersValidated||this._validateParsers();let r=0;const i={},s=cy(e),o=ss(e,c=>({alias:[c],src:c})),a=o.length,l=o.map(async c=>{const u=Rn.toAbsolute(c.src);if(!i[c.src])try{this.promiseCache[u]||(this.promiseCache[u]=this._getLoadPromiseAndParser(u,c)),i[c.src]=await this.promiseCache[u].promise,n&&n(++r/a)}catch(d){throw delete this.promiseCache[u],delete i[c.src],new Error(`[Loader.load] Failed to load ${u}.
${d}`)}});return await Promise.all(l),s?i[o[0].src]:i}async unload(e){const n=ss(e,r=>({alias:[r],src:r})).map(async r=>{var o,a;const i=Rn.toAbsolute(r.src),s=this.promiseCache[i];if(s){const l=await s.promise;delete this.promiseCache[i],(a=(o=s.parser)==null?void 0:o.unload)==null||a.call(o,l,r,this)}});await Promise.all(n)}_validateParsers(){this._parsersValidated=!0,this._parserHash=this._parsers.filter(e=>e.name).reduce((e,n)=>(e[n.name]&&console.warn(`[Assets] loadParser name conflict "${n.name}"`),{...e,[n.name]:n}),{})}}var Ss=(t=>(t[t.Low=0]="Low",t[t.Normal=1]="Normal",t[t.High=2]="High",t))(Ss||{});const gK=".json",yK="application/json",vK={extension:{type:me.LoadParser,priority:Ss.Low},name:"loadJson",test(t){return uh(t,yK)||Pl(t,gK)},async load(t){return await(await _e.ADAPTER.fetch(t)).json()}};Ce.add(vK);const bK=".txt",_K="text/plain",EK={name:"loadTxt",extension:{type:me.LoadParser,priority:Ss.Low},test(t){return uh(t,_K)||Pl(t,bK)},async load(t){return await(await _e.ADAPTER.fetch(t)).text()}};Ce.add(EK);const wK=["normal","bold","100","200","300","400","500","600","700","800","900"],xK=[".ttf",".otf",".woff",".woff2"],TK=["font/ttf","font/otf","font/woff","font/woff2"],SK=/^(--|-?[A-Z_])[0-9A-Z_-]*$/i;function CK(t){const e=Rn.extname(t),n=Rn.basename(t,e).replace(/(-|_)/g," ").toLowerCase().split(" ").map(s=>s.charAt(0).toUpperCase()+s.slice(1));let r=n.length>0;for(const s of n)if(!s.match(SK)){r=!1;break}let i=n.join(" ");return r||(i=`"${i.replace(/[\\"]/g,"\\$&")}"`),i}const IK=/^[0-9A-Za-z%:/?#\[\]@!\$&'()\*\+,;=\-._~]*$/;function AK(t){return IK.test(t)?t:encodeURI(t)}const kK={extension:{type:me.LoadParser,priority:Ss.Low},name:"loadWebFont",test(t){return uh(t,TK)||Pl(t,xK)},async load(t,e){var r,i,s;const n=_e.ADAPTER.getFontFaceSet();if(n){const o=[],a=((r=e.data)==null?void 0:r.family)??CK(t),l=((s=(i=e.data)==null?void 0:i.weights)==null?void 0:s.filter(u=>wK.includes(u)))??["normal"],c=e.data??{};for(let u=0;u<l.length;u++){const d=l[u],h=new FontFace(a,`url(${AK(t)})`,{...c,weight:d});await h.load(),n.add(h),o.push(h)}return o.length===1?o[0]:o}return console.warn("[loadWebFont] FontFace API is not supported. Skipping loading font"),null},unload(t){(Array.isArray(t)?t:[t]).forEach(e=>_e.ADAPTER.getFontFaceSet().delete(e))}};Ce.add(kK);let Z5=0,Xb;const MK="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mP8/x8AAwMCAO+ip1sAAAAASUVORK5CYII=",PK={id:"checkImageBitmap",code:`
    async function checkImageBitmap()
    {
        try
        {
            if (typeof createImageBitmap !== 'function') return false;

            const response = await fetch('${MK}');
            const imageBlob =  await response.blob();
            const imageBitmap = await createImageBitmap(imageBlob);

            return imageBitmap.width === 1 && imageBitmap.height === 1;
        }
        catch (e)
        {
            return false;
        }
    }
    checkImageBitmap().then((result) => { self.postMessage(result); });
    `},LK={id:"loadImageBitmap",code:`
    async function loadImageBitmap(url)
    {
        const response = await fetch(url);

        if (!response.ok)
        {
            throw new Error(\`[WorkerManager.loadImageBitmap] Failed to fetch \${url}: \`
                + \`\${response.status} \${response.statusText}\`);
        }

        const imageBlob =  await response.blob();
        const imageBitmap = await createImageBitmap(imageBlob);

        return imageBitmap;
    }
    self.onmessage = async (event) =>
    {
        try
        {
            const imageBitmap = await loadImageBitmap(event.data.data[0]);

            self.postMessage({
                data: imageBitmap,
                uuid: event.data.uuid,
                id: event.data.id,
            }, [imageBitmap]);
        }
        catch(e)
        {
            self.postMessage({
                error: e,
                uuid: event.data.uuid,
                id: event.data.id,
            });
        }
    };`};let Yb;class RK{constructor(){this._initialized=!1,this._createdWorkers=0,this.workerPool=[],this.queue=[],this.resolveHash={}}isImageBitmapSupported(){return this._isImageBitmapSupported!==void 0?this._isImageBitmapSupported:(this._isImageBitmapSupported=new Promise(e=>{const n=URL.createObjectURL(new Blob([PK.code],{type:"application/javascript"})),r=new Worker(n);r.addEventListener("message",i=>{r.terminate(),URL.revokeObjectURL(n),e(i.data)})}),this._isImageBitmapSupported)}loadImageBitmap(e){return this._run("loadImageBitmap",[e])}async _initWorkers(){this._initialized||(this._initialized=!0)}getWorker(){Xb===void 0&&(Xb=navigator.hardwareConcurrency||4);let e=this.workerPool.pop();return!e&&this._createdWorkers<Xb&&(Yb||(Yb=URL.createObjectURL(new Blob([LK.code],{type:"application/javascript"}))),this._createdWorkers++,e=new Worker(Yb),e.addEventListener("message",n=>{this.complete(n.data),this.returnWorker(n.target),this.next()})),e}returnWorker(e){this.workerPool.push(e)}complete(e){e.error!==void 0?this.resolveHash[e.uuid].reject(e.error):this.resolveHash[e.uuid].resolve(e.data),this.resolveHash[e.uuid]=null}async _run(e,n){await this._initWorkers();const r=new Promise((i,s)=>{this.queue.push({id:e,arguments:n,resolve:i,reject:s})});return this.next(),r}next(){if(!this.queue.length)return;const e=this.getWorker();if(!e)return;const n=this.queue.pop(),r=n.id;this.resolveHash[Z5]={resolve:n.resolve,reject:n.reject},e.postMessage({data:n.arguments,uuid:Z5++,id:r})}}const K5=new RK;function Bm(t,e,n){t.resource.internal=!0;const r=new he(t),i=()=>{delete e.promiseCache[n],sc.has(n)&&sc.remove(n)};return r.baseTexture.once("destroyed",()=>{n in e.promiseCache&&(console.warn("[Assets] A BaseTexture managed by Assets was destroyed instead of unloaded! Use Assets.unload() instead of destroying the BaseTexture."),i())}),r.once("destroyed",()=>{t.destroyed||(console.warn("[Assets] A Texture managed by Assets was destroyed instead of unloaded! Use Assets.unload() instead of destroying the Texture."),i())}),r}const OK=[".jpeg",".jpg",".png",".webp",".avif"],DK=["image/jpeg","image/png","image/webp","image/avif"];async function NK(t){const e=await _e.ADAPTER.fetch(t);if(!e.ok)throw new Error(`[loadImageBitmap] Failed to fetch ${t}: ${e.status} ${e.statusText}`);const n=await e.blob();return await createImageBitmap(n)}const Fv={name:"loadTextures",extension:{type:me.LoadParser,priority:Ss.High},config:{preferWorkers:!0,preferCreateImageBitmap:!0,crossOrigin:"anonymous"},test(t){return uh(t,DK)||Pl(t,OK)},async load(t,e,n){var a;const r=globalThis.createImageBitmap&&this.config.preferCreateImageBitmap;let i;r?this.config.preferWorkers&&await K5.isImageBitmapSupported()?i=await K5.loadImageBitmap(t):i=await NK(t):i=await new Promise((l,c)=>{const u=new Image;u.crossOrigin=this.config.crossOrigin,u.src=t,u.complete?l(u):(u.onload=()=>l(u),u.onerror=d=>c(d))});const s={...e.data};s.resolution??(s.resolution=Qo(t)),r&&((a=s.resourceOptions)==null?void 0:a.ownsImageBitmap)===void 0&&(s.resourceOptions={...s.resourceOptions},s.resourceOptions.ownsImageBitmap=!0);const o=new ze(i,s);return o.resource.src=t,Bm(o,n,t)},unload(t){t.destroy(!0)}};Ce.add(Fv);const FK=".svg",BK="image/svg+xml",UK={extension:{type:me.LoadParser,priority:Ss.High},name:"loadSVG",test(t){return uh(t,BK)||Pl(t,FK)},async testParse(t){return Xw.test(t)},async parse(t,e,n){var s;const r=new Xw(t,(s=e==null?void 0:e.data)==null?void 0:s.resourceOptions);await r.load();const i=new ze(r,{resolution:Qo(t),...e==null?void 0:e.data});return i.resource.src=e.src,Bm(i,n,e.src)},async load(t,e){return(await _e.ADAPTER.fetch(t)).text()},unload:Fv.unload};Ce.add(UK);const $K=[".mp4",".m4v",".webm",".ogv"],HK=["video/mp4","video/webm","video/ogg"],zK={name:"loadVideo",extension:{type:me.LoadParser,priority:Ss.High},config:{defaultAutoPlay:!0},test(t){return uh(t,HK)||Pl(t,$K)},async load(t,e,n){var o;let r;const i=await(await _e.ADAPTER.fetch(t)).blob(),s=URL.createObjectURL(i);try{const a={autoPlay:this.config.defaultAutoPlay,...(o=e==null?void 0:e.data)==null?void 0:o.resourceOptions},l=new L9(s,a);await l.load();const c=new ze(l,{alphaMode:await YX(),resolution:Qo(t),...e==null?void 0:e.data});c.resource.src=t,r=Bm(c,n,t),r.baseTexture.once("destroyed",()=>{URL.revokeObjectURL(s)})}catch(a){throw URL.revokeObjectURL(s),a}return r},unload(t){t.destroy(!0)}};Ce.add(zK);class GK{constructor(){this._defaultBundleIdentifierOptions={connector:"-",createBundleAssetId:(e,n)=>`${e}${this._bundleIdConnector}${n}`,extractAssetIdFromBundle:(e,n)=>n.replace(`${e}${this._bundleIdConnector}`,"")},this._bundleIdConnector=this._defaultBundleIdentifierOptions.connector,this._createBundleAssetId=this._defaultBundleIdentifierOptions.createBundleAssetId,this._extractAssetIdFromBundle=this._defaultBundleIdentifierOptions.extractAssetIdFromBundle,this._assetMap={},this._preferredOrder=[],this._parsers=[],this._resolverHash={},this._bundles={}}setBundleIdentifier(e){if(this._bundleIdConnector=e.connector??this._bundleIdConnector,this._createBundleAssetId=e.createBundleAssetId??this._createBundleAssetId,this._extractAssetIdFromBundle=e.extractAssetIdFromBundle??this._extractAssetIdFromBundle,this._extractAssetIdFromBundle("foo",this._createBundleAssetId("foo","bar"))!=="bar")throw new Error("[Resolver] GenerateBundleAssetId are not working correctly")}prefer(...e){e.forEach(n=>{this._preferredOrder.push(n),n.priority||(n.priority=Object.keys(n.params))}),this._resolverHash={}}set basePath(e){this._basePath=e}get basePath(){return this._basePath}set rootPath(e){this._rootPath=e}get rootPath(){return this._rootPath}get parsers(){return this._parsers}reset(){this.setBundleIdentifier(this._defaultBundleIdentifierOptions),this._assetMap={},this._preferredOrder=[],this._resolverHash={},this._rootPath=null,this._basePath=null,this._manifest=null,this._bundles={},this._defaultSearchParams=null}setDefaultSearchParams(e){if(typeof e=="string")this._defaultSearchParams=e;else{const n=e;this._defaultSearchParams=Object.keys(n).map(r=>`${encodeURIComponent(r)}=${encodeURIComponent(n[r])}`).join("&")}}getAlias(e){const{alias:n,name:r,src:i,srcs:s}=e;return ss(n||r||i||s,o=>typeof o=="string"?o:Array.isArray(o)?o.map(a=>(a==null?void 0:a.src)??(a==null?void 0:a.srcs)??a):o!=null&&o.src||o!=null&&o.srcs?o.src??o.srcs:o,!0)}addManifest(e){this._manifest&&console.warn("[Resolver] Manifest already exists, this will be overwritten"),this._manifest=e,e.bundles.forEach(n=>{this.addBundle(n.name,n.assets)})}addBundle(e,n){const r=[];Array.isArray(n)?n.forEach(i=>{const s=i.src??i.srcs,o=i.alias??i.name;let a;if(typeof o=="string"){const l=this._createBundleAssetId(e,o);r.push(l),a=[o,l]}else{const l=o.map(c=>this._createBundleAssetId(e,c));r.push(...l),a=[...o,...l]}this.add({...i,alias:a,src:s})}):Object.keys(n).forEach(i=>{const s=[i,this._createBundleAssetId(e,i)];if(typeof n[i]=="string")this.add({alias:s,src:n[i]});else if(Array.isArray(n[i]))this.add({alias:s,src:n[i]});else{const o=n[i],a=o.src??o.srcs;this.add({...o,alias:s,src:Array.isArray(a)?a:[a]})}r.push(...s)}),this._bundles[e]=r}add(e,n,r,i,s){const o=[];typeof e=="string"||Array.isArray(e)&&typeof e[0]=="string"?(Qe("7.2.0",`Assets.add now uses an object instead of individual parameters.
Please use Assets.add({ alias, src, data, format, loadParser }) instead.`),o.push({alias:e,src:n,data:r,format:i,loadParser:s})):Array.isArray(e)?o.push(...e):o.push(e);let a;a=l=>{this.hasKey(l)&&console.warn(`[Resolver] already has key: ${l} overwriting`)},ss(o).forEach(l=>{const{src:c,srcs:u}=l;let{data:d,format:h,loadParser:f}=l;const p=ss(c||u).map(y=>typeof y=="string"?fK(y):Array.isArray(y)?y:[y]),m=this.getAlias(l);Array.isArray(m)?m.forEach(a):a(m);const v=[];p.forEach(y=>{y.forEach(b=>{let _={};if(typeof b!="object"){_.src=b;for(let E=0;E<this._parsers.length;E++){const w=this._parsers[E];if(w.test(b)){_=w.parse(b);break}}}else d=b.data??d,h=b.format??h,f=b.loadParser??f,_={..._,...b};if(!m)throw new Error(`[Resolver] alias is undefined for this asset: ${_.src}`);_=this.buildResolvedAsset(_,{aliases:m,data:d,format:h,loadParser:f}),v.push(_)})}),m.forEach(y=>{this._assetMap[y]=v})})}resolveBundle(e){const n=cy(e);e=ss(e);const r={};return e.forEach(i=>{const s=this._bundles[i];if(s){const o=this.resolve(s),a={};for(const l in o){const c=o[l];a[this._extractAssetIdFromBundle(i,l)]=c}r[i]=a}}),n?r[e[0]]:r}resolveUrl(e){const n=this.resolve(e);if(typeof e!="string"){const r={};for(const i in n)r[i]=n[i].src;return r}return n.src}resolve(e){const n=cy(e);e=ss(e);const r={};return e.forEach(i=>{if(!this._resolverHash[i])if(this._assetMap[i]){let s=this._assetMap[i];const o=s[0],a=this._getPreferredOrder(s);a==null||a.priority.forEach(l=>{a.params[l].forEach(c=>{const u=s.filter(d=>d[l]?d[l]===c:!1);u.length&&(s=u)})}),this._resolverHash[i]=s[0]??o}else this._resolverHash[i]=this.buildResolvedAsset({alias:[i],src:i},{});r[i]=this._resolverHash[i]}),n?r[e[0]]:r}hasKey(e){return!!this._assetMap[e]}hasBundle(e){return!!this._bundles[e]}_getPreferredOrder(e){for(let n=0;n<e.length;n++){const r=e[0],i=this._preferredOrder.find(s=>s.params.format.includes(r.format));if(i)return i}return this._preferredOrder[0]}_appendDefaultSearchParams(e){if(!this._defaultSearchParams)return e;const n=/\?/.test(e)?"&":"?";return`${e}${n}${this._defaultSearchParams}`}buildResolvedAsset(e,n){const{aliases:r,data:i,loadParser:s,format:o}=n;return(this._basePath||this._rootPath)&&(e.src=Rn.toAbsolute(e.src,this._basePath,this._rootPath)),e.alias=r??e.alias??[e.src],e.src=this._appendDefaultSearchParams(e.src),e.data={...i||{},...e.data},e.loadParser=s??e.loadParser,e.format=o??Rn.extname(e.src).slice(1),e.srcs=e.src,e.name=e.alias,e}}class VK{constructor(){this._detections=[],this._initialized=!1,this.resolver=new GK,this.loader=new mK,this.cache=sc,this._backgroundLoader=new hK(this.loader),this._backgroundLoader.active=!0,this.reset()}async init(e={}){var s,o;if(this._initialized){console.warn("[Assets]AssetManager already initialized, did you load before calling this Assets.init()?");return}if(this._initialized=!0,e.defaultSearchParams&&this.resolver.setDefaultSearchParams(e.defaultSearchParams),e.basePath&&(this.resolver.basePath=e.basePath),e.bundleIdentifier&&this.resolver.setBundleIdentifier(e.bundleIdentifier),e.manifest){let a=e.manifest;typeof a=="string"&&(a=await this.load(a)),this.resolver.addManifest(a)}const n=((s=e.texturePreference)==null?void 0:s.resolution)??1,r=typeof n=="number"?[n]:n,i=await this._detectFormats({preferredFormats:(o=e.texturePreference)==null?void 0:o.format,skipDetections:e.skipDetections,detections:this._detections});this.resolver.prefer({params:{format:i,resolution:r}}),e.preferences&&this.setPreferences(e.preferences)}add(e,n,r,i,s){this.resolver.add(e,n,r,i,s)}async load(e,n){this._initialized||await this.init();const r=cy(e),i=ss(e).map(a=>{if(typeof a!="string"){const l=this.resolver.getAlias(a);return l.some(c=>!this.resolver.hasKey(c))&&this.add(a),Array.isArray(l)?l[0]:l}return this.resolver.hasKey(a)||this.add({alias:a,src:a}),a}),s=this.resolver.resolve(i),o=await this._mapLoadToResolve(s,n);return r?o[i[0]]:o}addBundle(e,n){this.resolver.addBundle(e,n)}async loadBundle(e,n){this._initialized||await this.init();let r=!1;typeof e=="string"&&(r=!0,e=[e]);const i=this.resolver.resolveBundle(e),s={},o=Object.keys(i);let a=0,l=0;const c=()=>{n==null||n(++a/l)},u=o.map(d=>{const h=i[d];return l+=Object.keys(h).length,this._mapLoadToResolve(h,c).then(f=>{s[d]=f})});return await Promise.all(u),r?s[e[0]]:s}async backgroundLoad(e){this._initialized||await this.init(),typeof e=="string"&&(e=[e]);const n=this.resolver.resolve(e);this._backgroundLoader.add(Object.values(n))}async backgroundLoadBundle(e){this._initialized||await this.init(),typeof e=="string"&&(e=[e]);const n=this.resolver.resolveBundle(e);Object.values(n).forEach(r=>{this._backgroundLoader.add(Object.values(r))})}reset(){this.resolver.reset(),this.loader.reset(),this.cache.reset(),this._initialized=!1}get(e){if(typeof e=="string")return sc.get(e);const n={};for(let r=0;r<e.length;r++)n[r]=sc.get(e[r]);return n}async _mapLoadToResolve(e,n){const r=Object.values(e),i=Object.keys(e);this._backgroundLoader.active=!1;const s=await this.loader.load(r,n);this._backgroundLoader.active=!0;const o={};return r.forEach((a,l)=>{const c=s[a.src],u=[a.src];a.alias&&u.push(...a.alias),o[i[l]]=c,sc.set(u,c)}),o}async unload(e){this._initialized||await this.init();const n=ss(e).map(i=>typeof i!="string"?i.src:i),r=this.resolver.resolve(n);await this._unloadFromResolved(r)}async unloadBundle(e){this._initialized||await this.init(),e=ss(e);const n=this.resolver.resolveBundle(e),r=Object.keys(n).map(i=>this._unloadFromResolved(n[i]));await Promise.all(r)}async _unloadFromResolved(e){const n=Object.values(e);n.forEach(r=>{sc.remove(r.src)}),await this.loader.unload(n)}async _detectFormats(e){let n=[];e.preferredFormats&&(n=Array.isArray(e.preferredFormats)?e.preferredFormats:[e.preferredFormats]);for(const r of e.detections)e.skipDetections||await r.test()?n=await r.add(n):e.skipDetections||(n=await r.remove(n));return n=n.filter((r,i)=>n.indexOf(r)===i),n}get detections(){return this._detections}get preferWorkers(){return Fv.config.preferWorkers}set preferWorkers(e){Qe("7.2.0","Assets.prefersWorkers is deprecated, use Assets.setPreferences({ preferWorkers: true }) instead."),this.setPreferences({preferWorkers:e})}setPreferences(e){this.loader.parsers.forEach(n=>{n.config&&Object.keys(n.config).filter(r=>r in e).forEach(r=>{n.config[r]=e[r]})})}}const z1=new VK;Ce.handleByList(me.LoadParser,z1.loader.parsers).handleByList(me.ResolveParser,z1.resolver.parsers).handleByList(me.CacheParser,z1.cache.parsers).handleByList(me.DetectionParser,z1.detections);const WK={extension:me.CacheParser,test:t=>Array.isArray(t)&&t.every(e=>e instanceof he),getCacheableAssets:(t,e)=>{const n={};return t.forEach(r=>{e.forEach((i,s)=>{n[r+(s===0?"":s+1)]=i})}),n}};Ce.add(WK);async function $9(t){if("Image"in globalThis)return new Promise(e=>{const n=new Image;n.onload=()=>{e(!0)},n.onerror=()=>{e(!1)},n.src=t});if("createImageBitmap"in globalThis&&"fetch"in globalThis){try{const e=await(await fetch(t)).blob();await createImageBitmap(e)}catch{return!1}return!0}return!1}const jK={extension:{type:me.DetectionParser,priority:1},test:async()=>$9("data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAAB0AAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAIAAAACAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQ0MAAAAABNjb2xybmNseAACAAIAAYAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAACVtZGF0EgAKCBgANogQEAwgMg8f8D///8WfhwB8+ErK42A="),add:async t=>[...t,"avif"],remove:async t=>t.filter(e=>e!=="avif")};Ce.add(jK);const XK={extension:{type:me.DetectionParser,priority:0},test:async()=>$9("data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAAAAAAfQ//73v/+BiOh/AAA="),add:async t=>[...t,"webp"],remove:async t=>t.filter(e=>e!=="webp")};Ce.add(XK);const q5=["png","jpg","jpeg"],YK={extension:{type:me.DetectionParser,priority:-1},test:()=>Promise.resolve(!0),add:async t=>[...t,...q5],remove:async t=>t.filter(e=>!q5.includes(e))};Ce.add(YK);const ZK="WorkerGlobalScope"in globalThis&&globalThis instanceof globalThis.WorkerGlobalScope;function tS(t){return ZK?!1:document.createElement("video").canPlayType(t)!==""}const KK={extension:{type:me.DetectionParser,priority:0},test:async()=>tS("video/webm"),add:async t=>[...t,"webm"],remove:async t=>t.filter(e=>e!=="webm")};Ce.add(KK);const qK={extension:{type:me.DetectionParser,priority:0},test:async()=>tS("video/mp4"),add:async t=>[...t,"mp4","m4v"],remove:async t=>t.filter(e=>e!=="mp4"&&e!=="m4v")};Ce.add(qK);const JK={extension:{type:me.DetectionParser,priority:0},test:async()=>tS("video/ogg"),add:async t=>[...t,"ogv"],remove:async t=>t.filter(e=>e!=="ogv")};Ce.add(JK);const QK={extension:me.ResolveParser,test:Fv.test,parse:t=>{var e;return{resolution:parseFloat(((e=_e.RETINA_PREFIX.exec(t))==null?void 0:e[1])??"1"),format:Rn.extname(t).slice(1),src:t}}};Ce.add(QK);var ii=(t=>(t[t.COMPRESSED_RGB_S3TC_DXT1_EXT=33776]="COMPRESSED_RGB_S3TC_DXT1_EXT",t[t.COMPRESSED_RGBA_S3TC_DXT1_EXT=33777]="COMPRESSED_RGBA_S3TC_DXT1_EXT",t[t.COMPRESSED_RGBA_S3TC_DXT3_EXT=33778]="COMPRESSED_RGBA_S3TC_DXT3_EXT",t[t.COMPRESSED_RGBA_S3TC_DXT5_EXT=33779]="COMPRESSED_RGBA_S3TC_DXT5_EXT",t[t.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT=35917]="COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT",t[t.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT=35918]="COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT",t[t.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT=35919]="COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT",t[t.COMPRESSED_SRGB_S3TC_DXT1_EXT=35916]="COMPRESSED_SRGB_S3TC_DXT1_EXT",t[t.COMPRESSED_R11_EAC=37488]="COMPRESSED_R11_EAC",t[t.COMPRESSED_SIGNED_R11_EAC=37489]="COMPRESSED_SIGNED_R11_EAC",t[t.COMPRESSED_RG11_EAC=37490]="COMPRESSED_RG11_EAC",t[t.COMPRESSED_SIGNED_RG11_EAC=37491]="COMPRESSED_SIGNED_RG11_EAC",t[t.COMPRESSED_RGB8_ETC2=37492]="COMPRESSED_RGB8_ETC2",t[t.COMPRESSED_RGBA8_ETC2_EAC=37496]="COMPRESSED_RGBA8_ETC2_EAC",t[t.COMPRESSED_SRGB8_ETC2=37493]="COMPRESSED_SRGB8_ETC2",t[t.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC=37497]="COMPRESSED_SRGB8_ALPHA8_ETC2_EAC",t[t.COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2=37494]="COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2",t[t.COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2=37495]="COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2",t[t.COMPRESSED_RGB_PVRTC_4BPPV1_IMG=35840]="COMPRESSED_RGB_PVRTC_4BPPV1_IMG",t[t.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG=35842]="COMPRESSED_RGBA_PVRTC_4BPPV1_IMG",t[t.COMPRESSED_RGB_PVRTC_2BPPV1_IMG=35841]="COMPRESSED_RGB_PVRTC_2BPPV1_IMG",t[t.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG=35843]="COMPRESSED_RGBA_PVRTC_2BPPV1_IMG",t[t.COMPRESSED_RGB_ETC1_WEBGL=36196]="COMPRESSED_RGB_ETC1_WEBGL",t[t.COMPRESSED_RGB_ATC_WEBGL=35986]="COMPRESSED_RGB_ATC_WEBGL",t[t.COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL=35987]="COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL",t[t.COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL=34798]="COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL",t[t.COMPRESSED_RGBA_ASTC_4x4_KHR=37808]="COMPRESSED_RGBA_ASTC_4x4_KHR",t))(ii||{});const uy={33776:.5,33777:.5,33778:1,33779:1,35916:.5,35917:.5,35918:1,35919:1,37488:.5,37489:.5,37490:1,37491:1,37492:.5,37496:1,37493:.5,37497:1,37494:.5,37495:.5,35840:.5,35842:.5,35841:.25,35843:.25,36196:.5,35986:.5,35987:1,34798:1,37808:1};let Io,Fu;function J5(){Fu={s3tc:Io.getExtension("WEBGL_compressed_texture_s3tc"),s3tc_sRGB:Io.getExtension("WEBGL_compressed_texture_s3tc_srgb"),etc:Io.getExtension("WEBGL_compressed_texture_etc"),etc1:Io.getExtension("WEBGL_compressed_texture_etc1"),pvrtc:Io.getExtension("WEBGL_compressed_texture_pvrtc")||Io.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc"),atc:Io.getExtension("WEBGL_compressed_texture_atc"),astc:Io.getExtension("WEBGL_compressed_texture_astc")}}const eq={extension:{type:me.DetectionParser,priority:2},test:async()=>{const t=_e.ADAPTER.createCanvas().getContext("webgl");return t?(Io=t,!0):(console.warn("WebGL not available for compressed textures."),!1)},add:async t=>{Fu||J5();const e=[];for(const n in Fu)Fu[n]&&e.push(n);return[...e,...t]},remove:async t=>(Fu||J5(),t.filter(e=>!(e in Fu)))};Ce.add(eq);class tq extends Dv{constructor(e,n={width:1,height:1,autoLoad:!0}){let r,i;typeof e=="string"?(r=e,i=new Uint8Array):(r=null,i=e),super(i,n),this.origin=r,this.buffer=i?new Dw(i):null,this._load=null,this.loaded=!1,this.origin!==null&&n.autoLoad!==!1&&this.load(),this.origin===null&&this.buffer&&(this._load=Promise.resolve(this),this.loaded=!0,this.onBlobLoaded(this.buffer.rawBinaryData))}onBlobLoaded(e){}load(){return this._load?this._load:(this._load=fetch(this.origin).then(e=>e.blob()).then(e=>e.arrayBuffer()).then(e=>(this.data=new Uint32Array(e),this.buffer=new Dw(e),this.loaded=!0,this.onBlobLoaded(e),this.update(),this)),this._load)}}class Pc extends tq{constructor(e,n){super(e,n),this.format=n.format,this.levels=n.levels||1,this._width=n.width,this._height=n.height,this._extension=Pc._formatToExtension(this.format),(n.levelBuffers||this.buffer)&&(this._levelBuffers=n.levelBuffers||Pc._createLevelBuffers(e instanceof Uint8Array?e:this.buffer.uint8View,this.format,this.levels,4,4,this.width,this.height))}upload(e,n,r){const i=e.gl;if(!e.context.extensions[this._extension])throw new Error(`${this._extension} textures are not supported on the current machine`);if(!this._levelBuffers)return!1;i.pixelStorei(i.UNPACK_ALIGNMENT,4);for(let s=0,o=this.levels;s<o;s++){const{levelID:a,levelWidth:l,levelHeight:c,levelBuffer:u}=this._levelBuffers[s];i.compressedTexImage2D(i.TEXTURE_2D,a,this.format,l,c,0,u)}return!0}onBlobLoaded(){this._levelBuffers=Pc._createLevelBuffers(this.buffer.uint8View,this.format,this.levels,4,4,this.width,this.height)}static _formatToExtension(e){if(e>=33776&&e<=33779)return"s3tc";if(e>=37488&&e<=37497)return"etc";if(e>=35840&&e<=35843)return"pvrtc";if(e>=36196)return"etc1";if(e>=35986&&e<=34798)return"atc";throw new Error("Invalid (compressed) texture format given!")}static _createLevelBuffers(e,n,r,i,s,o,a){const l=new Array(r);let c=e.byteOffset,u=o,d=a,h=u+i-1&~(i-1),f=d+s-1&~(s-1),p=h*f*uy[n];for(let m=0;m<r;m++)l[m]={levelID:m,levelWidth:r>1?u:h,levelHeight:r>1?d:f,levelBuffer:new Uint8Array(e.buffer,c,p)},c+=p,u=u>>1||1,d=d>>1||1,h=u+i-1&~(i-1),f=d+s-1&~(s-1),p=h*f*uy[n];return l}}const Zb=4,G1=124,nq=32,Q5=20,rq=542327876,V1={SIZE:1,FLAGS:2,HEIGHT:3,WIDTH:4,MIPMAP_COUNT:7,PIXEL_FORMAT:19},iq={SIZE:0,FLAGS:1,FOURCC:2,RGB_BITCOUNT:3,R_BIT_MASK:4,G_BIT_MASK:5,B_BIT_MASK:6,A_BIT_MASK:7},W1={DXGI_FORMAT:0,RESOURCE_DIMENSION:1,MISC_FLAG:2,ARRAY_SIZE:3,MISC_FLAGS2:4},sq=1,oq=2,aq=4,lq=64,cq=512,uq=131072,dq=827611204,hq=861165636,fq=894720068,pq=808540228,mq=4,gq={[dq]:ii.COMPRESSED_RGBA_S3TC_DXT1_EXT,[hq]:ii.COMPRESSED_RGBA_S3TC_DXT3_EXT,[fq]:ii.COMPRESSED_RGBA_S3TC_DXT5_EXT},yq={70:ii.COMPRESSED_RGBA_S3TC_DXT1_EXT,71:ii.COMPRESSED_RGBA_S3TC_DXT1_EXT,73:ii.COMPRESSED_RGBA_S3TC_DXT3_EXT,74:ii.COMPRESSED_RGBA_S3TC_DXT3_EXT,76:ii.COMPRESSED_RGBA_S3TC_DXT5_EXT,77:ii.COMPRESSED_RGBA_S3TC_DXT5_EXT,72:ii.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT,75:ii.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT,78:ii.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT};function vq(t){const e=new Uint32Array(t);if(e[0]!==rq)throw new Error("Invalid DDS file magic word");const n=new Uint32Array(t,0,G1/Uint32Array.BYTES_PER_ELEMENT),r=n[V1.HEIGHT],i=n[V1.WIDTH],s=n[V1.MIPMAP_COUNT],o=new Uint32Array(t,V1.PIXEL_FORMAT*Uint32Array.BYTES_PER_ELEMENT,nq/Uint32Array.BYTES_PER_ELEMENT),a=o[sq];if(a&aq){const l=o[iq.FOURCC];if(l!==pq){const b=gq[l],_=Zb+G1,E=new Uint8Array(t,_);return[new Pc(E,{format:b,width:i,height:r,levels:s})]}const c=Zb+G1,u=new Uint32Array(e.buffer,c,Q5/Uint32Array.BYTES_PER_ELEMENT),d=u[W1.DXGI_FORMAT],h=u[W1.RESOURCE_DIMENSION],f=u[W1.MISC_FLAG],p=u[W1.ARRAY_SIZE],m=yq[d];if(m===void 0)throw new Error(`DDSParser cannot parse texture data with DXGI format ${d}`);if(f===mq)throw new Error("DDSParser does not support cubemap textures");if(h===6)throw new Error("DDSParser does not supported 3D texture data");const v=new Array,y=Zb+G1+Q5;if(p===1)v.push(new Uint8Array(t,y));else{const b=uy[m];let _=0,E=i,w=r;for(let T=0;T<s;T++){const C=Math.max(1,E+3&-4),k=Math.max(1,w+3&-4),L=C*k*b;_+=L,E=E>>>1,w=w>>>1}let x=y;for(let T=0;T<p;T++)v.push(new Uint8Array(t,x,_)),x+=_}return v.map(b=>new Pc(b,{format:m,width:i,height:r,levels:s}))}throw a&lq?new Error("DDSParser does not support uncompressed texture data."):a&cq?new Error("DDSParser does not supported YUV uncompressed texture data."):a&uq?new Error("DDSParser does not support single-channel (lumninance) texture data!"):a&oq?new Error("DDSParser does not support single-channel (alpha) texture data!"):new Error("DDSParser failed to load a texture file due to an unknown reason!")}const eI=[171,75,84,88,32,49,49,187,13,10,26,10],bq=67305985,ji={FILE_IDENTIFIER:0,ENDIANNESS:12,GL_TYPE:16,GL_TYPE_SIZE:20,GL_FORMAT:24,GL_INTERNAL_FORMAT:28,GL_BASE_INTERNAL_FORMAT:32,PIXEL_WIDTH:36,PIXEL_HEIGHT:40,PIXEL_DEPTH:44,NUMBER_OF_ARRAY_ELEMENTS:48,NUMBER_OF_FACES:52,NUMBER_OF_MIPMAP_LEVELS:56,BYTES_OF_KEY_VALUE_DATA:60},rx=64,tI={[Te.UNSIGNED_BYTE]:1,[Te.UNSIGNED_SHORT]:2,[Te.INT]:4,[Te.UNSIGNED_INT]:4,[Te.FLOAT]:4,[Te.HALF_FLOAT]:8},_q={[le.RGBA]:4,[le.RGB]:3,[le.RG]:2,[le.RED]:1,[le.LUMINANCE]:1,[le.LUMINANCE_ALPHA]:2,[le.ALPHA]:1},Eq={[Te.UNSIGNED_SHORT_4_4_4_4]:2,[Te.UNSIGNED_SHORT_5_5_5_1]:2,[Te.UNSIGNED_SHORT_5_6_5]:2};function wq(t,e,n=!1){const r=new DataView(e);if(!xq(t,r))return null;const i=r.getUint32(ji.ENDIANNESS,!0)===bq,s=r.getUint32(ji.GL_TYPE,i),o=r.getUint32(ji.GL_FORMAT,i),a=r.getUint32(ji.GL_INTERNAL_FORMAT,i),l=r.getUint32(ji.PIXEL_WIDTH,i),c=r.getUint32(ji.PIXEL_HEIGHT,i)||1,u=r.getUint32(ji.PIXEL_DEPTH,i)||1,d=r.getUint32(ji.NUMBER_OF_ARRAY_ELEMENTS,i)||1,h=r.getUint32(ji.NUMBER_OF_FACES,i),f=r.getUint32(ji.NUMBER_OF_MIPMAP_LEVELS,i),p=r.getUint32(ji.BYTES_OF_KEY_VALUE_DATA,i);if(c===0||u!==1)throw new Error("Only 2D textures are supported");if(h!==1)throw new Error("CubeTextures are not supported by KTXLoader yet!");if(d!==1)throw new Error("WebGL does not support array textures");const m=4,v=4,y=l+3&-4,b=c+3&-4,_=new Array(d);let E=l*c;s===0&&(E=y*b);let w;if(s!==0?tI[s]?w=tI[s]*_q[o]:w=Eq[s]:w=uy[a],w===void 0)throw new Error("Unable to resolve the pixel format stored in the *.ktx file!");const x=n?Sq(r,p,i):null;let T=E*w,C=l,k=c,L=y,F=b,N=rx+p;for(let R=0;R<f;R++){const H=r.getUint32(N,i);let W=N+4;for(let q=0;q<d;q++){let Z=_[q];Z||(Z=_[q]=new Array(f)),Z[R]={levelID:R,levelWidth:f>1||s!==0?C:L,levelHeight:f>1||s!==0?k:F,levelBuffer:new Uint8Array(e,W,T)},W+=T}N+=H+4,N=N%4!==0?N+4-N%4:N,C=C>>1||1,k=k>>1||1,L=C+m-1&~(m-1),F=k+v-1&~(v-1),T=L*F*w}return s!==0?{uncompressed:_.map(R=>{let H=R[0].levelBuffer,W=!1;return s===Te.FLOAT?H=new Float32Array(R[0].levelBuffer.buffer,R[0].levelBuffer.byteOffset,R[0].levelBuffer.byteLength/4):s===Te.UNSIGNED_INT?(W=!0,H=new Uint32Array(R[0].levelBuffer.buffer,R[0].levelBuffer.byteOffset,R[0].levelBuffer.byteLength/4)):s===Te.INT&&(W=!0,H=new Int32Array(R[0].levelBuffer.buffer,R[0].levelBuffer.byteOffset,R[0].levelBuffer.byteLength/4)),{resource:new Dv(H,{width:R[0].levelWidth,height:R[0].levelHeight}),type:s,format:W?Tq(o):o}}),kvData:x}:{compressed:_.map(R=>new Pc(null,{format:a,width:l,height:c,levels:f,levelBuffers:R})),kvData:x}}function xq(t,e){for(let n=0;n<eI.length;n++)if(e.getUint8(n)!==eI[n])return console.error(`${t} is not a valid *.ktx file!`),!1;return!0}function Tq(t){switch(t){case le.RGBA:return le.RGBA_INTEGER;case le.RGB:return le.RGB_INTEGER;case le.RG:return le.RG_INTEGER;case le.RED:return le.RED_INTEGER;default:return t}}function Sq(t,e,n){const r=new Map;let i=0;for(;i<e;){const s=t.getUint32(rx+i,n),o=rx+i+4,a=3-(s+3)%4;if(s===0||s>e-i){console.error("KTXLoader: keyAndValueByteSize out of bounds");break}let l=0;for(;l<s&&t.getUint8(o+l)!==0;l++);if(l===-1){console.error("KTXLoader: Failed to find null byte terminating kvData key");break}const c=new TextDecoder().decode(new Uint8Array(t.buffer,o,l)),u=new DataView(t.buffer,o+l+1,s-l-1);r.set(c,u),i+=4+s+a}return r}const Cq={extension:{type:me.LoadParser,priority:Ss.High},name:"loadDDS",test(t){return Pl(t,".dds")},async load(t,e,n){const r=await(await _e.ADAPTER.fetch(t)).arrayBuffer(),i=vq(r).map(s=>{const o=new ze(s,{mipmap:ho.OFF,alphaMode:zr.NO_PREMULTIPLIED_ALPHA,resolution:Qo(t),...e.data});return Bm(o,n,t)});return i.length===1?i[0]:i},unload(t){Array.isArray(t)?t.forEach(e=>e.destroy(!0)):t.destroy(!0)}};Ce.add(Cq);const Iq={extension:{type:me.LoadParser,priority:Ss.High},name:"loadKTX",test(t){return Pl(t,".ktx")},async load(t,e,n){const r=await(await _e.ADAPTER.fetch(t)).arrayBuffer(),{compressed:i,uncompressed:s,kvData:o}=wq(t,r),a=i??s,l={mipmap:ho.OFF,alphaMode:zr.NO_PREMULTIPLIED_ALPHA,resolution:Qo(t),...e.data},c=a.map(u=>{a===s&&Object.assign(l,{type:u.type,format:u.format});const d=u.resource??u,h=new ze(d,l);return h.ktxKeyValueData=o,Bm(h,n,t)});return c.length===1?c[0]:c},unload(t){Array.isArray(t)?t.forEach(e=>e.destroy(!0)):t.destroy(!0)}};Ce.add(Iq);const Aq={extension:me.ResolveParser,test:t=>{const e=Rn.extname(t).slice(1);return["basis","ktx","dds"].includes(e)},parse:t=>{var n,r;const e=Rn.extname(t).slice(1);if(e==="ktx"){const i=[".s3tc.ktx",".s3tc_sRGB.ktx",".etc.ktx",".etc1.ktx",".pvrt.ktx",".atc.ktx",".astc.ktx"];if(i.some(s=>t.endsWith(s)))return{resolution:parseFloat(((n=_e.RETINA_PREFIX.exec(t))==null?void 0:n[1])??"1"),format:i.find(s=>t.endsWith(s)),src:t}}return{resolution:parseFloat(((r=_e.RETINA_PREFIX.exec(t))==null?void 0:r[1])??"1"),format:e,src:t}}};Ce.add(Aq);const j1=new Me,kq=4,H9=class xf{constructor(e){this.renderer=e,this._rendererPremultipliedAlpha=!1}contextChange(){var n;const e=(n=this.renderer)==null?void 0:n.gl.getContextAttributes();this._rendererPremultipliedAlpha=!!(e&&e.alpha&&e.premultipliedAlpha)}async image(e,n,r,i){const s=new Image;return s.src=await this.base64(e,n,r,i),s}async base64(e,n,r,i){const s=this.canvas(e,i);if(s.toBlob!==void 0)return new Promise((o,a)=>{s.toBlob(l=>{if(!l){a(new Error("ICanvas.toBlob failed!"));return}const c=new FileReader;c.onload=()=>o(c.result),c.onerror=a,c.readAsDataURL(l)},n,r)});if(s.toDataURL!==void 0)return s.toDataURL(n,r);if(s.convertToBlob!==void 0){const o=await s.convertToBlob({type:n,quality:r});return new Promise((a,l)=>{const c=new FileReader;c.onload=()=>a(c.result),c.onerror=l,c.readAsDataURL(o)})}throw new Error("Extract.base64() requires ICanvas.toDataURL, ICanvas.toBlob, or ICanvas.convertToBlob to be implemented")}canvas(e,n){const{pixels:r,width:i,height:s,flipY:o,premultipliedAlpha:a}=this._rawPixels(e,n);o&&xf._flipY(r,i,s),a&&xf._unpremultiplyAlpha(r);const l=new dY(i,s,1),c=new ImageData(new Uint8ClampedArray(r.buffer),i,s);return l.context.putImageData(c,0,0),l.canvas}pixels(e,n){const{pixels:r,width:i,height:s,flipY:o,premultipliedAlpha:a}=this._rawPixels(e,n);return o&&xf._flipY(r,i,s),a&&xf._unpremultiplyAlpha(r),r}_rawPixels(e,n){const r=this.renderer;if(!r)throw new Error("The Extract has already been destroyed");let i,s=!1,o=!1,a,l=!1;e&&(e instanceof ta?a=e:(a=r.generateTexture(e,{region:n,resolution:r.resolution,multisample:r.multisample}),l=!0,n&&(j1.width=n.width,j1.height=n.height,n=j1)));const c=r.gl;if(a){if(i=a.baseTexture.resolution,n=n??a.frame,s=!1,o=a.baseTexture.alphaMode>0&&a.baseTexture.format===le.RGBA,!l){r.renderTexture.bind(a);const f=a.framebuffer.glFramebuffers[r.CONTEXT_UID];f.blitFramebuffer&&r.framebuffer.bind(f.blitFramebuffer)}}else i=r.resolution,n||(n=j1,n.width=r.width/i,n.height=r.height/i),s=!0,o=this._rendererPremultipliedAlpha,r.renderTexture.bind();const u=Math.max(Math.round(n.width*i),1),d=Math.max(Math.round(n.height*i),1),h=new Uint8Array(kq*u*d);return c.readPixels(Math.round(n.x*i),Math.round(n.y*i),u,d,c.RGBA,c.UNSIGNED_BYTE,h),l&&(a==null||a.destroy(!0)),{pixels:h,width:u,height:d,flipY:s,premultipliedAlpha:o}}destroy(){this.renderer=null}static _flipY(e,n,r){const i=n<<2,s=r>>1,o=new Uint8Array(i);for(let a=0;a<s;a++){const l=a*i,c=(r-a-1)*i;o.set(e.subarray(l,l+i)),e.copyWithin(l,c,c+i),e.set(o,c)}}static _unpremultiplyAlpha(e){e instanceof Uint8ClampedArray&&(e=new Uint8Array(e.buffer));const n=e.length;for(let r=0;r<n;r+=4){const i=e[r+3];if(i!==0){const s=255.001/i;e[r]=e[r]*s+.5,e[r+1]=e[r+1]*s+.5,e[r+2]=e[r+2]*s+.5}}}};H9.extension={name:"extract",type:me.RendererSystem};let Mq=H9;Ce.add(Mq);const zp={build(t){const e=t.points;let n,r,i,s,o,a;if(t.type===ut.CIRC){const p=t.shape;n=p.x,r=p.y,o=a=p.radius,i=s=0}else if(t.type===ut.ELIP){const p=t.shape;n=p.x,r=p.y,o=p.width,a=p.height,i=s=0}else{const p=t.shape,m=p.width/2,v=p.height/2;n=p.x+m,r=p.y+v,o=a=Math.max(0,Math.min(p.radius,Math.min(m,v))),i=m-o,s=v-a}if(!(o>=0&&a>=0&&i>=0&&s>=0)){e.length=0;return}const l=Math.ceil(2.3*Math.sqrt(o+a)),c=l*8+(i?4:0)+(s?4:0);if(e.length=c,c===0)return;if(l===0){e.length=8,e[0]=e[6]=n+i,e[1]=e[3]=r+s,e[2]=e[4]=n-i,e[5]=e[7]=r-s;return}let u=0,d=l*4+(i?2:0)+2,h=d,f=c;{const p=i+o,m=s,v=n+p,y=n-p,b=r+m;if(e[u++]=v,e[u++]=b,e[--d]=b,e[--d]=y,s){const _=r-m;e[h++]=y,e[h++]=_,e[--f]=_,e[--f]=v}}for(let p=1;p<l;p++){const m=Math.PI/2*(p/l),v=i+Math.cos(m)*o,y=s+Math.sin(m)*a,b=n+v,_=n-v,E=r+y,w=r-y;e[u++]=b,e[u++]=E,e[--d]=E,e[--d]=_,e[h++]=_,e[h++]=w,e[--f]=w,e[--f]=b}{const p=i,m=s+a,v=n+p,y=n-p,b=r+m,_=r-m;e[u++]=v,e[u++]=b,e[--f]=_,e[--f]=v,i&&(e[u++]=y,e[u++]=b,e[--f]=_,e[--f]=y)}},triangulate(t,e){const n=t.points,r=e.points,i=e.indices;if(n.length===0)return;let s=r.length/2;const o=s;let a,l;if(t.type!==ut.RREC){const u=t.shape;a=u.x,l=u.y}else{const u=t.shape;a=u.x+u.width/2,l=u.y+u.height/2}const c=t.matrix;r.push(t.matrix?c.a*a+c.c*l+c.tx:a,t.matrix?c.b*a+c.d*l+c.ty:l),s++,r.push(n[0],n[1]);for(let u=2;u<n.length;u+=2)r.push(n[u],n[u+1]),i.push(s++,o,s);i.push(o+1,o,s)}};function nI(t,e=!1){const n=t.length;if(n<6)return;let r=0;for(let i=0,s=t[n-2],o=t[n-1];i<n;i+=2){const a=t[i],l=t[i+1];r+=(a-s)*(l+o),s=a,o=l}if(!e&&r>0||e&&r<=0){const i=n/2;for(let s=i+i%2;s<n;s+=2){const o=n-s-2,a=n-s-1,l=s,c=s+1;[t[o],t[l]]=[t[l],t[o]],[t[a],t[c]]=[t[c],t[a]]}}}const nS={build(t){t.points=t.shape.points.slice()},triangulate(t,e){let n=t.points;const r=t.holes,i=e.points,s=e.indices;if(n.length>=6){nI(n,!1);const o=[];for(let c=0;c<r.length;c++){const u=r[c];nI(u.points,!0),o.push(n.length/2),n=n.concat(u.points)}const a=TR(n,o,2);if(!a)return;const l=i.length/2;for(let c=0;c<a.length;c+=3)s.push(a[c]+l),s.push(a[c+1]+l),s.push(a[c+2]+l);for(let c=0;c<n.length;c++)i.push(n[c])}}},z9={build(t){const e=t.shape,n=e.x,r=e.y,i=e.width,s=e.height,o=t.points;o.length=0,i>=0&&s>=0&&o.push(n,r,n+i,r,n+i,r+s,n,r+s)},triangulate(t,e){const n=t.points,r=e.points;if(n.length===0)return;const i=r.length/2;r.push(n[0],n[1],n[2],n[3],n[6],n[7],n[4],n[5]),e.indices.push(i,i+1,i+2,i+1,i+2,i+3)}},G9={build(t){zp.build(t)},triangulate(t,e){zp.triangulate(t,e)}};var Vt=(t=>(t.MITER="miter",t.BEVEL="bevel",t.ROUND="round",t))(Vt||{}),_n=(t=>(t.BUTT="butt",t.ROUND="round",t.SQUARE="square",t))(_n||{});const yl={adaptive:!0,maxLength:10,minSegments:8,maxSegments:2048,epsilon:1e-4,_segmentsCount(t,e=20){if(!this.adaptive||!t||isNaN(t))return e;let n=Math.ceil(t/this.maxLength);return n<this.minSegments?n=this.minSegments:n>this.maxSegments&&(n=this.maxSegments),n}},Gp=yl;let ix=class{static curveTo(e,n,r,i,s,o){const a=o[o.length-2],l=o[o.length-1]-n,c=a-e,u=i-n,d=r-e,h=Math.abs(l*d-c*u);if(h<1e-8||s===0)return(o[o.length-2]!==e||o[o.length-1]!==n)&&o.push(e,n),null;const f=l*l+c*c,p=u*u+d*d,m=l*u+c*d,v=s*Math.sqrt(f)/h,y=s*Math.sqrt(p)/h,b=v*m/f,_=y*m/p,E=v*d+y*c,w=v*u+y*l,x=c*(y+b),T=l*(y+b),C=d*(v+_),k=u*(v+_),L=Math.atan2(T-w,x-E),F=Math.atan2(k-w,C-E);return{cx:E+e,cy:w+n,radius:s,startAngle:L,endAngle:F,anticlockwise:c*u>d*l}}static arc(e,n,r,i,s,o,a,l,c){const u=a-o,d=yl._segmentsCount(Math.abs(u)*s,Math.ceil(Math.abs(u)/Xd)*40),h=u/(d*2),f=h*2,p=Math.cos(h),m=Math.sin(h),v=d-1,y=v%1/v;for(let b=0;b<=v;++b){const _=b+y*b,E=h+o+f*_,w=Math.cos(E),x=-Math.sin(E);c.push((p*w+m*x)*s+r,(p*-x+m*w)*s+i)}}},V9=class{constructor(){this.reset()}begin(e,n,r){this.reset(),this.style=e,this.start=n,this.attribStart=r}end(e,n){this.attribSize=n-this.attribStart,this.size=e-this.start}reset(){this.style=null,this.size=0,this.start=0,this.attribStart=0,this.attribSize=0}},W9=class j9{static curveLength(e,n,r,i,s,o,a,l){let c=0,u=0,d=0,h=0,f=0,p=0,m=0,v=0,y=0,b=0,_=0,E=e,w=n;for(let x=1;x<=10;++x)u=x/10,d=u*u,h=d*u,f=1-u,p=f*f,m=p*f,v=m*e+3*p*u*r+3*f*d*s+h*a,y=m*n+3*p*u*i+3*f*d*o+h*l,b=E-v,_=w-y,E=v,w=y,c+=Math.sqrt(b*b+_*_);return c}static curveTo(e,n,r,i,s,o,a){const l=a[a.length-2],c=a[a.length-1];a.length-=2;const u=yl._segmentsCount(j9.curveLength(l,c,e,n,r,i,s,o));let d=0,h=0,f=0,p=0,m=0;a.push(l,c);for(let v=1,y=0;v<=u;++v)y=v/u,d=1-y,h=d*d,f=h*d,p=y*y,m=p*y,a.push(f*l+3*h*y*e+3*d*p*r+m*s,f*c+3*h*y*n+3*d*p*i+m*o)}};function rI(t,e,n,r,i,s,o,a){const l=t-n*i,c=e-r*i,u=t+n*s,d=e+r*s;let h,f;o?(h=r,f=-n):(h=-r,f=n);const p=l+h,m=c+f,v=u+h,y=d+f;return a.push(p,m,v,y),2}function Fl(t,e,n,r,i,s,o,a){const l=n-t,c=r-e;let u=Math.atan2(l,c),d=Math.atan2(i-t,s-e);a&&u<d?u+=Math.PI*2:!a&&u>d&&(d+=Math.PI*2);let h=u;const f=d-u,p=Math.abs(f),m=Math.sqrt(l*l+c*c),v=(15*p*Math.sqrt(m)/Math.PI>>0)+1,y=f/v;if(h+=y,a){o.push(t,e,n,r);for(let b=1,_=h;b<v;b++,_+=y)o.push(t,e,t+Math.sin(_)*m,e+Math.cos(_)*m);o.push(t,e,i,s)}else{o.push(n,r,t,e);for(let b=1,_=h;b<v;b++,_+=y)o.push(t+Math.sin(_)*m,e+Math.cos(_)*m,t,e);o.push(i,s,t,e)}return v*2}function Pq(t,e){const n=t.shape;let r=t.points||n.points.slice();const i=e.closePointEps;if(r.length===0)return;const s=t.lineStyle,o=new Ke(r[0],r[1]),a=new Ke(r[r.length-2],r[r.length-1]),l=n.type!==ut.POLY||n.closeStroke,c=Math.abs(o.x-a.x)<i&&Math.abs(o.y-a.y)<i;if(l){r=r.slice(),c&&(r.pop(),r.pop(),a.set(r[r.length-2],r[r.length-1]));const Z=(o.x+a.x)*.5,j=(a.y+o.y)*.5;r.unshift(Z,j),r.push(Z,j)}const u=e.points,d=r.length/2;let h=r.length;const f=u.length/2,p=s.width/2,m=p*p,v=s.miterLimit*s.miterLimit;let y=r[0],b=r[1],_=r[2],E=r[3],w=0,x=0,T=-(b-E),C=y-_,k=0,L=0,F=Math.sqrt(T*T+C*C);T/=F,C/=F,T*=p,C*=p;const N=s.alignment,R=(1-N)*2,H=N*2;l||(s.cap===_n.ROUND?h+=Fl(y-T*(R-H)*.5,b-C*(R-H)*.5,y-T*R,b-C*R,y+T*H,b+C*H,u,!0)+2:s.cap===_n.SQUARE&&(h+=rI(y,b,T,C,R,H,!0,u))),u.push(y-T*R,b-C*R,y+T*H,b+C*H);for(let Z=1;Z<d-1;++Z){y=r[(Z-1)*2],b=r[(Z-1)*2+1],_=r[Z*2],E=r[Z*2+1],w=r[(Z+1)*2],x=r[(Z+1)*2+1],T=-(b-E),C=y-_,F=Math.sqrt(T*T+C*C),T/=F,C/=F,T*=p,C*=p,k=-(E-x),L=_-w,F=Math.sqrt(k*k+L*L),k/=F,L/=F,k*=p,L*=p;const j=_-y,K=b-E,$=_-w,B=x-E,G=j*$+K*B,Y=K*$-B*j,X=Y<0;if(Math.abs(Y)<.001*Math.abs(G)){u.push(_-T*R,E-C*R,_+T*H,E+C*H),G>=0&&(s.join===Vt.ROUND?h+=Fl(_,E,_-T*R,E-C*R,_-k*R,E-L*R,u,!1)+4:h+=2,u.push(_-k*H,E-L*H,_+k*R,E+L*R));continue}const J=(-T+y)*(-C+E)-(-T+_)*(-C+b),ne=(-k+w)*(-L+E)-(-k+_)*(-L+x),se=(j*ne-$*J)/Y,Ue=(B*J-K*ne)/Y,De=(se-_)*(se-_)+(Ue-E)*(Ue-E),Le=_+(se-_)*R,fe=E+(Ue-E)*R,ke=_-(se-_)*H,Xe=E-(Ue-E)*H,_t=Math.min(j*j+K*K,$*$+B*B),Sn=X?R:H,Ot=_t+Sn*Sn*m,We=De<=Ot;let ir=s.join;if(ir===Vt.MITER&&De/m>v&&(ir=Vt.BEVEL),We)switch(ir){case Vt.MITER:{u.push(Le,fe,ke,Xe);break}case Vt.BEVEL:{X?u.push(Le,fe,_+T*H,E+C*H,Le,fe,_+k*H,E+L*H):u.push(_-T*R,E-C*R,ke,Xe,_-k*R,E-L*R,ke,Xe),h+=2;break}case Vt.ROUND:{X?(u.push(Le,fe,_+T*H,E+C*H),h+=Fl(_,E,_+T*H,E+C*H,_+k*H,E+L*H,u,!0)+4,u.push(Le,fe,_+k*H,E+L*H)):(u.push(_-T*R,E-C*R,ke,Xe),h+=Fl(_,E,_-T*R,E-C*R,_-k*R,E-L*R,u,!1)+4,u.push(_-k*R,E-L*R,ke,Xe));break}}else{switch(u.push(_-T*R,E-C*R,_+T*H,E+C*H),ir){case Vt.MITER:{X?u.push(ke,Xe,ke,Xe):u.push(Le,fe,Le,fe),h+=2;break}case Vt.ROUND:{X?h+=Fl(_,E,_+T*H,E+C*H,_+k*H,E+L*H,u,!0)+2:h+=Fl(_,E,_-T*R,E-C*R,_-k*R,E-L*R,u,!1)+2;break}}u.push(_-k*R,E-L*R,_+k*H,E+L*H),h+=2}}y=r[(d-2)*2],b=r[(d-2)*2+1],_=r[(d-1)*2],E=r[(d-1)*2+1],T=-(b-E),C=y-_,F=Math.sqrt(T*T+C*C),T/=F,C/=F,T*=p,C*=p,u.push(_-T*R,E-C*R,_+T*H,E+C*H),l||(s.cap===_n.ROUND?h+=Fl(_-T*(R-H)*.5,E-C*(R-H)*.5,_-T*R,E-C*R,_+T*H,E+C*H,u,!1)+2:s.cap===_n.SQUARE&&(h+=rI(_,E,T,C,R,H,!1,u)));const W=e.indices,q=yl.epsilon*yl.epsilon;for(let Z=f;Z<h+f-2;++Z)y=u[Z*2],b=u[Z*2+1],_=u[(Z+1)*2],E=u[(Z+1)*2+1],w=u[(Z+2)*2],x=u[(Z+2)*2+1],!(Math.abs(y*(E-x)+_*(x-b)+w*(b-E))<q)&&W.push(Z,Z+1,Z+2)}function Lq(t,e){let n=0;const r=t.shape,i=t.points||r.points,s=r.type!==ut.POLY||r.closeStroke;if(i.length===0)return;const o=e.points,a=e.indices,l=i.length/2,c=o.length/2;let u=c;for(o.push(i[0],i[1]),n=1;n<l;n++)o.push(i[n*2],i[n*2+1]),a.push(u,u+1),u++;s&&a.push(u,c)}function sx(t,e){t.lineStyle.native?Lq(t,e):Pq(t,e)}let X9=class Y9{static curveLength(e,n,r,i,s,o){const a=e-2*r+s,l=n-2*i+o,c=2*r-2*e,u=2*i-2*n,d=4*(a*a+l*l),h=4*(a*c+l*u),f=c*c+u*u,p=2*Math.sqrt(d+h+f),m=Math.sqrt(d),v=2*d*m,y=2*Math.sqrt(f),b=h/m;return(v*p+m*h*(p-y)+(4*f*d-h*h)*Math.log((2*m+b+p)/(b+y)))/(4*v)}static curveTo(e,n,r,i,s){const o=s[s.length-2],a=s[s.length-1],l=yl._segmentsCount(Y9.curveLength(o,a,e,n,r,i));let c=0,u=0;for(let d=1;d<=l;++d){const h=d/l;c=o+(e-o)*h,u=a+(n-a)*h,s.push(c+(e+(r-e)*h-c)*h,u+(n+(i-n)*h-u)*h)}}};const Yg={[ut.POLY]:nS,[ut.CIRC]:zp,[ut.ELIP]:zp,[ut.RECT]:z9,[ut.RREC]:G9},ox=[],Tf=[];class dy{constructor(e,n=null,r=null,i=null){this.points=[],this.holes=[],this.shape=e,this.lineStyle=r,this.fillStyle=n,this.matrix=i,this.type=e.type}clone(){return new dy(this.shape,this.fillStyle,this.lineStyle,this.matrix)}destroy(){this.shape=null,this.holes.length=0,this.holes=null,this.points.length=0,this.points=null,this.lineStyle=null,this.fillStyle=null}}const Eu=new Ke,Z9=class K9 extends YR{constructor(){super(),this.closePointEps=1e-4,this.boundsPadding=0,this.uvsFloat32=null,this.indicesUint16=null,this.batchable=!1,this.points=[],this.colors=[],this.uvs=[],this.indices=[],this.textureIds=[],this.graphicsData=[],this.drawCalls=[],this.batchDirty=-1,this.batches=[],this.dirty=0,this.cacheDirty=-1,this.clearDirty=0,this.shapeIndex=0,this._bounds=new gl,this.boundsDirty=-1}get bounds(){return this.updateBatches(),this.boundsDirty!==this.dirty&&(this.boundsDirty=this.dirty,this.calculateBounds()),this._bounds}invalidate(){this.boundsDirty=-1,this.dirty++,this.batchDirty++,this.shapeIndex=0,this.points.length=0,this.colors.length=0,this.uvs.length=0,this.indices.length=0,this.textureIds.length=0;for(let e=0;e<this.drawCalls.length;e++)this.drawCalls[e].texArray.clear(),Tf.push(this.drawCalls[e]);this.drawCalls.length=0;for(let e=0;e<this.batches.length;e++){const n=this.batches[e];n.reset(),ox.push(n)}this.batches.length=0}clear(){return this.graphicsData.length>0&&(this.invalidate(),this.clearDirty++,this.graphicsData.length=0),this}drawShape(e,n=null,r=null,i=null){const s=new dy(e,n,r,i);return this.graphicsData.push(s),this.dirty++,this}drawHole(e,n=null){if(!this.graphicsData.length)return null;const r=new dy(e,null,null,n),i=this.graphicsData[this.graphicsData.length-1];return r.lineStyle=i.lineStyle,i.holes.push(r),this.dirty++,this}destroy(){super.destroy();for(let e=0;e<this.graphicsData.length;++e)this.graphicsData[e].destroy();this.points.length=0,this.points=null,this.colors.length=0,this.colors=null,this.uvs.length=0,this.uvs=null,this.indices.length=0,this.indices=null,this.indexBuffer.destroy(),this.indexBuffer=null,this.graphicsData.length=0,this.graphicsData=null,this.drawCalls.length=0,this.drawCalls=null,this.batches.length=0,this.batches=null,this._bounds=null}containsPoint(e){const n=this.graphicsData;for(let r=0;r<n.length;++r){const i=n[r];if(i.fillStyle.visible&&i.shape&&(i.matrix?i.matrix.applyInverse(e,Eu):Eu.copyFrom(e),i.shape.contains(Eu.x,Eu.y))){let s=!1;if(i.holes){for(let o=0;o<i.holes.length;o++)if(i.holes[o].shape.contains(Eu.x,Eu.y)){s=!0;break}}if(!s)return!0}}return!1}updateBatches(){if(!this.graphicsData.length){this.batchable=!0;return}if(!this.validateBatching())return;this.cacheDirty=this.dirty;const e=this.uvs,n=this.graphicsData;let r=null,i=null;this.batches.length>0&&(r=this.batches[this.batches.length-1],i=r.style);for(let l=this.shapeIndex;l<n.length;l++){this.shapeIndex++;const c=n[l],u=c.fillStyle,d=c.lineStyle;Yg[c.type].build(c),c.matrix&&this.transformPoints(c.points,c.matrix),(u.visible||d.visible)&&this.processHoles(c.holes);for(let h=0;h<2;h++){const f=h===0?u:d;if(!f.visible)continue;const p=f.texture.baseTexture,m=this.indices.length,v=this.points.length/2;p.wrapMode=Go.REPEAT,h===0?this.processFill(c):this.processLine(c);const y=this.points.length/2-v;y!==0&&(r&&!this._compareStyles(i,f)&&(r.end(m,v),r=null),r||(r=ox.pop()||new V9,r.begin(f,m,v),this.batches.push(r),i=f),this.addUvs(this.points,e,f.texture,v,y,f.matrix))}}const s=this.indices.length,o=this.points.length/2;if(r&&r.end(s,o),this.batches.length===0){this.batchable=!0;return}const a=o>65535;this.indicesUint16&&this.indices.length===this.indicesUint16.length&&a===this.indicesUint16.BYTES_PER_ELEMENT>2?this.indicesUint16.set(this.indices):this.indicesUint16=a?new Uint32Array(this.indices):new Uint16Array(this.indices),this.batchable=this.isBatchable(),this.batchable?this.packBatches():this.buildDrawCalls()}_compareStyles(e,n){return!(!e||!n||e.texture.baseTexture!==n.texture.baseTexture||e.color+e.alpha!==n.color+n.alpha||!!e.native!=!!n.native)}validateBatching(){if(this.dirty===this.cacheDirty||!this.graphicsData.length)return!1;for(let e=0,n=this.graphicsData.length;e<n;e++){const r=this.graphicsData[e],i=r.fillStyle,s=r.lineStyle;if(i&&!i.texture.baseTexture.valid||s&&!s.texture.baseTexture.valid)return!1}return!0}packBatches(){this.batchDirty++,this.uvsFloat32=new Float32Array(this.uvs);const e=this.batches;for(let n=0,r=e.length;n<r;n++){const i=e[n];for(let s=0;s<i.size;s++){const o=i.start+s;this.indicesUint16[o]=this.indicesUint16[o]-i.attribStart}}}isBatchable(){if(this.points.length>65535*2)return!1;const e=this.batches;for(let n=0;n<e.length;n++)if(e[n].style.native)return!1;return this.points.length<K9.BATCHABLE_SIZE*2}buildDrawCalls(){let e=++ze._globalBatch;for(let d=0;d<this.drawCalls.length;d++)this.drawCalls[d].texArray.clear(),Tf.push(this.drawCalls[d]);this.drawCalls.length=0;const n=this.colors,r=this.textureIds;let i=Tf.pop();i||(i=new Bw,i.texArray=new ny),i.texArray.count=0,i.start=0,i.size=0,i.type=ls.TRIANGLES;let s=0,o=null,a=0,l=!1,c=ls.TRIANGLES,u=0;this.drawCalls.push(i);for(let d=0;d<this.batches.length;d++){const h=this.batches[d],f=8,p=h.style,m=p.texture.baseTexture;l!==!!p.native&&(l=!!p.native,c=l?ls.LINES:ls.TRIANGLES,o=null,s=f,e++),o!==m&&(o=m,m._batchEnabled!==e&&(s===f&&(e++,s=0,i.size>0&&(i=Tf.pop(),i||(i=new Bw,i.texArray=new ny),this.drawCalls.push(i)),i.start=u,i.size=0,i.texArray.count=0,i.type=c),m.touched=1,m._batchEnabled=e,m._batchLocation=s,m.wrapMode=Go.REPEAT,i.texArray.elements[i.texArray.count++]=m,s++)),i.size+=h.size,u+=h.size,a=m._batchLocation,this.addColors(n,p.color,p.alpha,h.attribSize,h.attribStart),this.addTextureIds(r,a,h.attribSize,h.attribStart)}ze._globalBatch=e,this.packAttributes()}packAttributes(){const e=this.points,n=this.uvs,r=this.colors,i=this.textureIds,s=new ArrayBuffer(e.length*3*4),o=new Float32Array(s),a=new Uint32Array(s);let l=0;for(let c=0;c<e.length/2;c++)o[l++]=e[c*2],o[l++]=e[c*2+1],o[l++]=n[c*2],o[l++]=n[c*2+1],a[l++]=r[c],o[l++]=i[c];this._buffer.update(s),this._indexBuffer.update(this.indicesUint16)}processFill(e){e.holes.length?nS.triangulate(e,this):Yg[e.type].triangulate(e,this)}processLine(e){sx(e,this);for(let n=0;n<e.holes.length;n++)sx(e.holes[n],this)}processHoles(e){for(let n=0;n<e.length;n++){const r=e[n];Yg[r.type].build(r),r.matrix&&this.transformPoints(r.points,r.matrix)}}calculateBounds(){const e=this._bounds;e.clear(),e.addVertexData(this.points,0,this.points.length),e.pad(this.boundsPadding,this.boundsPadding)}transformPoints(e,n){for(let r=0;r<e.length/2;r++){const i=e[r*2],s=e[r*2+1];e[r*2]=n.a*i+n.c*s+n.tx,e[r*2+1]=n.b*i+n.d*s+n.ty}}addColors(e,n,r,i,s=0){const o=pt.shared.setValue(n).toLittleEndianNumber(),a=pt.shared.setValue(o).toPremultiplied(r);e.length=Math.max(e.length,s+i);for(let l=0;l<i;l++)e[s+l]=a}addTextureIds(e,n,r,i=0){e.length=Math.max(e.length,i+r);for(let s=0;s<r;s++)e[i+s]=n}addUvs(e,n,r,i,s,o=null){let a=0;const l=n.length,c=r.frame;for(;a<s;){let d=e[(i+a)*2],h=e[(i+a)*2+1];if(o){const f=o.a*d+o.c*h+o.tx;h=o.b*d+o.d*h+o.ty,d=f}a++,n.push(d/c.width,h/c.height)}const u=r.baseTexture;(c.width<u.width||c.height<u.height)&&this.adjustUvs(n,r,l,s)}adjustUvs(e,n,r,i){const s=n.baseTexture,o=1e-6,a=r+i*2,l=n.frame,c=l.width/s.width,u=l.height/s.height;let d=l.x/l.width,h=l.y/l.height,f=Math.floor(e[r]+o),p=Math.floor(e[r+1]+o);for(let m=r+2;m<a;m+=2)f=Math.min(f,Math.floor(e[m]+o)),p=Math.min(p,Math.floor(e[m+1]+o));d-=f,h-=p;for(let m=r;m<a;m+=2)e[m]=(e[m]+d)*c,e[m+1]=(e[m+1]+h)*u}};Z9.BATCHABLE_SIZE=100;let q9=Z9,J9=class Q9{constructor(){this.color=16777215,this.alpha=1,this.texture=he.WHITE,this.matrix=null,this.visible=!1,this.reset()}clone(){const e=new Q9;return e.color=this.color,e.alpha=this.alpha,e.texture=this.texture,e.matrix=this.matrix,e.visible=this.visible,e}reset(){this.color=16777215,this.alpha=1,this.texture=he.WHITE,this.matrix=null,this.visible=!1}destroy(){this.texture=null,this.matrix=null}},eO=class tO extends J9{constructor(){super(...arguments),this.width=0,this.alignment=.5,this.native=!1,this.cap=_n.BUTT,this.join=Vt.MITER,this.miterLimit=10}clone(){const e=new tO;return e.color=this.color,e.alpha=this.alpha,e.texture=this.texture,e.matrix=this.matrix,e.visible=this.visible,e.width=this.width,e.alignment=this.alignment,e.native=this.native,e.cap=this.cap,e.join=this.join,e.miterLimit=this.miterLimit,e}reset(){super.reset(),this.color=0,this.alignment=.5,this.width=0,this.native=!1,this.cap=_n.BUTT,this.join=Vt.MITER,this.miterLimit=10}};const Kb={},ax=class Zg extends Xn{constructor(e=null){super(),this.shader=null,this.pluginName="batch",this.currentPath=null,this.batches=[],this.batchTint=-1,this.batchDirty=-1,this.vertexData=null,this._fillStyle=new J9,this._lineStyle=new eO,this._matrix=null,this._holeMode=!1,this.state=Ts.for2d(),this._geometry=e||new q9,this._geometry.refCount++,this._transformID=-1,this._tintColor=new pt(16777215),this.blendMode=Ne.NORMAL}get geometry(){return this._geometry}clone(){return this.finishPoly(),new Zg(this._geometry)}set blendMode(e){this.state.blendMode=e}get blendMode(){return this.state.blendMode}get tint(){return this._tintColor.value}set tint(e){this._tintColor.setValue(e)}get fill(){return this._fillStyle}get line(){return this._lineStyle}lineStyle(e=null,n=0,r,i=.5,s=!1){return typeof e=="number"&&(e={width:e,color:n,alpha:r,alignment:i,native:s}),this.lineTextureStyle(e)}lineTextureStyle(e){const n={width:0,texture:he.WHITE,color:e!=null&&e.texture?16777215:0,matrix:null,alignment:.5,native:!1,cap:_n.BUTT,join:Vt.MITER,miterLimit:10};e=Object.assign(n,e),this.normalizeColor(e),this.currentPath&&this.startPoly();const r=e.width>0&&e.alpha>0;return r?(e.matrix&&(e.matrix=e.matrix.clone(),e.matrix.invert()),Object.assign(this._lineStyle,{visible:r},e)):this._lineStyle.reset(),this}startPoly(){if(this.currentPath){const e=this.currentPath.points,n=this.currentPath.points.length;n>2&&(this.drawShape(this.currentPath),this.currentPath=new oo,this.currentPath.closeStroke=!1,this.currentPath.points.push(e[n-2],e[n-1]))}else this.currentPath=new oo,this.currentPath.closeStroke=!1}finishPoly(){this.currentPath&&(this.currentPath.points.length>2?(this.drawShape(this.currentPath),this.currentPath=null):this.currentPath.points.length=0)}moveTo(e,n){return this.startPoly(),this.currentPath.points[0]=e,this.currentPath.points[1]=n,this}lineTo(e,n){this.currentPath||this.moveTo(0,0);const r=this.currentPath.points,i=r[r.length-2],s=r[r.length-1];return(i!==e||s!==n)&&r.push(e,n),this}_initCurve(e=0,n=0){this.currentPath?this.currentPath.points.length===0&&(this.currentPath.points=[e,n]):this.moveTo(e,n)}quadraticCurveTo(e,n,r,i){this._initCurve();const s=this.currentPath.points;return s.length===0&&this.moveTo(0,0),X9.curveTo(e,n,r,i,s),this}bezierCurveTo(e,n,r,i,s,o){return this._initCurve(),W9.curveTo(e,n,r,i,s,o,this.currentPath.points),this}arcTo(e,n,r,i,s){this._initCurve(e,n);const o=this.currentPath.points,a=ix.curveTo(e,n,r,i,s,o);if(a){const{cx:l,cy:c,radius:u,startAngle:d,endAngle:h,anticlockwise:f}=a;this.arc(l,c,u,d,h,f)}return this}arc(e,n,r,i,s,o=!1){if(i===s)return this;if(!o&&s<=i?s+=Xd:o&&i<=s&&(i+=Xd),s-i===0)return this;const a=e+Math.cos(i)*r,l=n+Math.sin(i)*r,c=this._geometry.closePointEps;let u=this.currentPath?this.currentPath.points:null;if(u){const d=Math.abs(u[u.length-2]-a),h=Math.abs(u[u.length-1]-l);d<c&&h<c||u.push(a,l)}else this.moveTo(a,l),u=this.currentPath.points;return ix.arc(a,l,e,n,r,i,s,o,u),this}beginFill(e=0,n){return this.beginTextureFill({texture:he.WHITE,color:e,alpha:n})}normalizeColor(e){const n=pt.shared.setValue(e.color??0);e.color=n.toNumber(),e.alpha??(e.alpha=n.alpha)}beginTextureFill(e){const n={texture:he.WHITE,color:16777215,matrix:null};e=Object.assign(n,e),this.normalizeColor(e),this.currentPath&&this.startPoly();const r=e.alpha>0;return r?(e.matrix&&(e.matrix=e.matrix.clone(),e.matrix.invert()),Object.assign(this._fillStyle,{visible:r},e)):this._fillStyle.reset(),this}endFill(){return this.finishPoly(),this._fillStyle.reset(),this}drawRect(e,n,r,i){return this.drawShape(new Me(e,n,r,i))}drawRoundedRect(e,n,r,i,s){return this.drawShape(new Nm(e,n,r,i,s))}drawCircle(e,n,r){return this.drawShape(new Om(e,n,r))}drawEllipse(e,n,r,i){return this.drawShape(new Dm(e,n,r,i))}drawPolygon(...e){let n,r=!0;const i=e[0];i.points?(r=i.closeStroke,n=i.points):Array.isArray(e[0])?n=e[0]:n=e;const s=new oo(n);return s.closeStroke=r,this.drawShape(s),this}drawShape(e){return this._holeMode?this._geometry.drawHole(e,this._matrix):this._geometry.drawShape(e,this._fillStyle.clone(),this._lineStyle.clone(),this._matrix),this}clear(){return this._geometry.clear(),this._lineStyle.reset(),this._fillStyle.reset(),this._boundsID++,this._matrix=null,this._holeMode=!1,this.currentPath=null,this}isFastRect(){const e=this._geometry.graphicsData;return e.length===1&&e[0].shape.type===ut.RECT&&!e[0].matrix&&!e[0].holes.length&&!(e[0].lineStyle.visible&&e[0].lineStyle.width)}_render(e){this.finishPoly();const n=this._geometry;n.updateBatches(),n.batchable?(this.batchDirty!==n.batchDirty&&this._populateBatches(),this._renderBatched(e)):(e.batch.flush(),this._renderDirect(e))}_populateBatches(){const e=this._geometry,n=this.blendMode,r=e.batches.length;this.batchTint=-1,this._transformID=-1,this.batchDirty=e.batchDirty,this.batches.length=r,this.vertexData=new Float32Array(e.points);for(let i=0;i<r;i++){const s=e.batches[i],o=s.style.color,a=new Float32Array(this.vertexData.buffer,s.attribStart*4*2,s.attribSize*2),l=new Float32Array(e.uvsFloat32.buffer,s.attribStart*4*2,s.attribSize*2),c=new Uint16Array(e.indicesUint16.buffer,s.start*2,s.size),u={vertexData:a,blendMode:n,indices:c,uvs:l,_batchRGB:pt.shared.setValue(o).toRgbArray(),_tintRGB:o,_texture:s.style.texture,alpha:s.style.alpha,worldAlpha:1};this.batches[i]=u}}_renderBatched(e){if(this.batches.length){e.batch.setObjectRenderer(e.plugins[this.pluginName]),this.calculateVertices(),this.calculateTints();for(let n=0,r=this.batches.length;n<r;n++){const i=this.batches[n];i.worldAlpha=this.worldAlpha*i.alpha,e.plugins[this.pluginName].render(i)}}}_renderDirect(e){const n=this._resolveDirectShader(e),r=this._geometry,i=this.worldAlpha,s=n.uniforms,o=r.drawCalls;s.translationMatrix=this.transform.worldTransform,pt.shared.setValue(this._tintColor).premultiply(i).toArray(s.tint),e.shader.bind(n),e.geometry.bind(r,n),e.state.set(this.state);for(let a=0,l=o.length;a<l;a++)this._renderDrawCallDirect(e,r.drawCalls[a])}_renderDrawCallDirect(e,n){const{texArray:r,type:i,size:s,start:o}=n,a=r.count;for(let l=0;l<a;l++)e.texture.bind(r.elements[l],l);e.geometry.draw(i,s,o)}_resolveDirectShader(e){let n=this.shader;const r=this.pluginName;if(!n){if(!Kb[r]){const{maxTextures:i}=e.plugins[r],s=new Int32Array(i);for(let l=0;l<i;l++)s[l]=l;const o={tint:new Float32Array([1,1,1,1]),translationMatrix:new Ze,default:ps.from({uSamplers:s},!0)},a=e.plugins[r]._shader.program;Kb[r]=new ms(a,o)}n=Kb[r]}return n}_calculateBounds(){this.finishPoly();const e=this._geometry;if(!e.graphicsData.length)return;const{minX:n,minY:r,maxX:i,maxY:s}=e.bounds;this._bounds.addFrame(this.transform,n,r,i,s)}containsPoint(e){return this.worldTransform.applyInverse(e,Zg._TEMP_POINT),this._geometry.containsPoint(Zg._TEMP_POINT)}calculateTints(){if(this.batchTint!==this.tint){this.batchTint=this._tintColor.toNumber();for(let e=0;e<this.batches.length;e++){const n=this.batches[e];n._tintRGB=pt.shared.setValue(this._tintColor).multiply(n._batchRGB).toLittleEndianNumber()}}}calculateVertices(){const e=this.transform._worldID;if(this._transformID===e)return;this._transformID=e;const n=this.transform.worldTransform,r=n.a,i=n.b,s=n.c,o=n.d,a=n.tx,l=n.ty,c=this._geometry.points,u=this.vertexData;let d=0;for(let h=0;h<c.length;h+=2){const f=c[h],p=c[h+1];u[d++]=r*f+s*p+a,u[d++]=o*p+i*f+l}}closePath(){const e=this.currentPath;return e&&(e.closeStroke=!0,this.finishPoly()),this}setMatrix(e){return this._matrix=e,this}beginHole(){return this.finishPoly(),this._holeMode=!0,this}endHole(){return this.finishPoly(),this._holeMode=!1,this}destroy(e){this._geometry.refCount--,this._geometry.refCount===0&&this._geometry.dispose(),this._matrix=null,this.currentPath=null,this._lineStyle.destroy(),this._lineStyle=null,this._fillStyle.destroy(),this._fillStyle=null,this._geometry=null,this.shader=null,this.vertexData=null,this.batches.length=0,this.batches=null,super.destroy(e)}};ax.curves=yl,ax._TEMP_POINT=new Ke;let uu=ax;const nO={buildPoly:nS,buildCircle:zp,buildRectangle:z9,buildRoundedRectangle:G9,buildLine:sx,ArcUtils:ix,BezierUtils:W9,QuadraticUtils:X9,BatchPart:V9,FILL_COMMANDS:Yg,BATCH_POOL:ox,DRAW_CALL_POOL:Tf};class Rq{constructor(e,n){this.uvBuffer=e,this.uvMatrix=n,this.data=null,this._bufferUpdateId=-1,this._textureUpdateId=-1,this._updateID=0}update(e){if(!e&&this._bufferUpdateId===this.uvBuffer._updateID&&this._textureUpdateId===this.uvMatrix._updateID)return;this._bufferUpdateId=this.uvBuffer._updateID,this._textureUpdateId=this.uvMatrix._updateID;const n=this.uvBuffer.data;(!this.data||this.data.length!==n.length)&&(this.data=new Float32Array(n.length)),this.uvMatrix.multiplyUvs(n,this.data),this._updateID++}}const qb=new Ke,iI=new oo,rO=class iO extends Xn{constructor(e,n,r,i=ls.TRIANGLES){super(),this.geometry=e,this.shader=n,this.state=r||Ts.for2d(),this.drawMode=i,this.start=0,this.size=0,this.uvs=null,this.indices=null,this.vertexData=new Float32Array(1),this.vertexDirty=-1,this._transformID=-1,this._roundPixels=_e.ROUND_PIXELS,this.batchUvs=null}get geometry(){return this._geometry}set geometry(e){this._geometry!==e&&(this._geometry&&(this._geometry.refCount--,this._geometry.refCount===0&&this._geometry.dispose()),this._geometry=e,this._geometry&&this._geometry.refCount++,this.vertexDirty=-1)}get uvBuffer(){return this.geometry.buffers[1]}get verticesBuffer(){return this.geometry.buffers[0]}set material(e){this.shader=e}get material(){return this.shader}set blendMode(e){this.state.blendMode=e}get blendMode(){return this.state.blendMode}set roundPixels(e){this._roundPixels!==e&&(this._transformID=-1),this._roundPixels=e}get roundPixels(){return this._roundPixels}get tint(){return"tint"in this.shader?this.shader.tint:null}set tint(e){this.shader.tint=e}get tintValue(){return this.shader.tintValue}get texture(){return"texture"in this.shader?this.shader.texture:null}set texture(e){this.shader.texture=e}_render(e){const n=this.geometry.buffers[0].data;this.shader.batchable&&this.drawMode===ls.TRIANGLES&&n.length<iO.BATCHABLE_SIZE*2?this._renderToBatch(e):this._renderDefault(e)}_renderDefault(e){const n=this.shader;n.alpha=this.worldAlpha,n.update&&n.update(),e.batch.flush(),n.uniforms.translationMatrix=this.transform.worldTransform.toArray(!0),e.shader.bind(n),e.state.set(this.state),e.geometry.bind(this.geometry,n),e.geometry.draw(this.drawMode,this.size,this.start,this.geometry.instanceCount)}_renderToBatch(e){const n=this.geometry,r=this.shader;r.uvMatrix&&(r.uvMatrix.update(),this.calculateUvs()),this.calculateVertices(),this.indices=n.indexBuffer.data,this._tintRGB=r._tintRGB,this._texture=r.texture;const i=this.material.pluginName;e.batch.setObjectRenderer(e.plugins[i]),e.plugins[i].render(this)}calculateVertices(){const e=this.geometry.buffers[0],n=e.data,r=e._updateID;if(r===this.vertexDirty&&this._transformID===this.transform._worldID)return;this._transformID=this.transform._worldID,this.vertexData.length!==n.length&&(this.vertexData=new Float32Array(n.length));const i=this.transform.worldTransform,s=i.a,o=i.b,a=i.c,l=i.d,c=i.tx,u=i.ty,d=this.vertexData;for(let h=0;h<d.length/2;h++){const f=n[h*2],p=n[h*2+1];d[h*2]=s*f+a*p+c,d[h*2+1]=o*f+l*p+u}if(this._roundPixels){const h=_e.RESOLUTION;for(let f=0;f<d.length;++f)d[f]=Math.round(d[f]*h)/h}this.vertexDirty=r}calculateUvs(){const e=this.geometry.buffers[1],n=this.shader;n.uvMatrix.isSimple?this.uvs=e.data:(this.batchUvs||(this.batchUvs=new Rq(e,n.uvMatrix)),this.batchUvs.update(),this.uvs=this.batchUvs.data)}_calculateBounds(){this.calculateVertices(),this._bounds.addVertexData(this.vertexData,0,this.vertexData.length)}containsPoint(e){if(!this.getBounds().contains(e.x,e.y))return!1;this.worldTransform.applyInverse(e,qb);const n=this.geometry.getBuffer("aVertexPosition").data,r=iI.points,i=this.geometry.getIndex().data,s=i.length,o=this.drawMode===4?3:1;for(let a=0;a+2<s;a+=o){const l=i[a]*2,c=i[a+1]*2,u=i[a+2]*2;if(r[0]=n[l],r[1]=n[l+1],r[2]=n[c],r[3]=n[c+1],r[4]=n[u],r[5]=n[u+1],iI.contains(qb.x,qb.y))return!0}return!1}destroy(e){super.destroy(e),this._cachedTexture&&(this._cachedTexture.destroy(),this._cachedTexture=null),this.geometry=null,this.shader=null,this.state=null,this.uvs=null,this.indices=null,this.vertexData=null}};rO.BATCHABLE_SIZE=100;let sI=rO;class Oq extends ea{constructor(e,n,r){super();const i=new hn(e),s=new hn(n,!0),o=new hn(r,!0,!0);this.addAttribute("aVertexPosition",i,2,!1,Te.FLOAT).addAttribute("aTextureCoord",s,2,!1,Te.FLOAT).addIndex(o),this._updateId=-1}get vertexDirtyId(){return this.buffers[0]._updateID}}var Dq=`varying vec2 vTextureCoord;
uniform vec4 uColor;

uniform sampler2D uSampler;

void main(void)
{
    gl_FragColor = texture2D(uSampler, vTextureCoord) * uColor;
}
`,Nq=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;
uniform mat3 translationMatrix;
uniform mat3 uTextureMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = (uTextureMatrix * vec3(aTextureCoord, 1.0)).xy;
}
`;class oI extends ms{constructor(e,n){const r={uSampler:e,alpha:1,uTextureMatrix:Ze.IDENTITY,uColor:new Float32Array([1,1,1,1])};n=Object.assign({tint:16777215,alpha:1,pluginName:"batch"},n),n.uniforms&&Object.assign(r,n.uniforms),super(n.program||no.from(Nq,Dq),r),this._colorDirty=!1,this.uvMatrix=new l9(e),this.batchable=n.program===void 0,this.pluginName=n.pluginName,this._tintColor=new pt(n.tint),this._tintRGB=this._tintColor.toLittleEndianNumber(),this._colorDirty=!0,this.alpha=n.alpha}get texture(){return this.uniforms.uSampler}set texture(e){this.uniforms.uSampler!==e&&(!this.uniforms.uSampler.baseTexture.alphaMode!=!e.baseTexture.alphaMode&&(this._colorDirty=!0),this.uniforms.uSampler=e,this.uvMatrix.texture=e)}set alpha(e){e!==this._alpha&&(this._alpha=e,this._colorDirty=!0)}get alpha(){return this._alpha}set tint(e){e!==this.tint&&(this._tintColor.setValue(e),this._tintRGB=this._tintColor.toLittleEndianNumber(),this._colorDirty=!0)}get tint(){return this._tintColor.value}get tintValue(){return this._tintColor.toNumber()}update(){if(this._colorDirty){this._colorDirty=!1;const e=this.texture.baseTexture.alphaMode;pt.shared.setValue(this._tintColor).premultiply(this._alpha,e).toArray(this.uniforms.uColor)}this.uvMatrix.update()&&(this.uniforms.uTextureMatrix=this.uvMatrix.mapCoord)}}class aI{constructor(e,n,r){this.geometry=new ea,this.indexBuffer=null,this.size=r,this.dynamicProperties=[],this.staticProperties=[];for(let i=0;i<e.length;++i){let s=e[i];s={attributeName:s.attributeName,size:s.size,uploadFunction:s.uploadFunction,type:s.type||Te.FLOAT,offset:s.offset},n[i]?this.dynamicProperties.push(s):this.staticProperties.push(s)}this.staticStride=0,this.staticBuffer=null,this.staticData=null,this.staticDataUint32=null,this.dynamicStride=0,this.dynamicBuffer=null,this.dynamicData=null,this.dynamicDataUint32=null,this._updateID=0,this.initBuffers()}initBuffers(){const e=this.geometry;let n=0;this.indexBuffer=new hn(cY(this.size),!0,!0),e.addIndex(this.indexBuffer),this.dynamicStride=0;for(let o=0;o<this.dynamicProperties.length;++o){const a=this.dynamicProperties[o];a.offset=n,n+=a.size,this.dynamicStride+=a.size}const r=new ArrayBuffer(this.size*this.dynamicStride*4*4);this.dynamicData=new Float32Array(r),this.dynamicDataUint32=new Uint32Array(r),this.dynamicBuffer=new hn(this.dynamicData,!1,!1);let i=0;this.staticStride=0;for(let o=0;o<this.staticProperties.length;++o){const a=this.staticProperties[o];a.offset=i,i+=a.size,this.staticStride+=a.size}const s=new ArrayBuffer(this.size*this.staticStride*4*4);this.staticData=new Float32Array(s),this.staticDataUint32=new Uint32Array(s),this.staticBuffer=new hn(this.staticData,!0,!1);for(let o=0;o<this.dynamicProperties.length;++o){const a=this.dynamicProperties[o];e.addAttribute(a.attributeName,this.dynamicBuffer,0,a.type===Te.UNSIGNED_BYTE,a.type,this.dynamicStride*4,a.offset*4)}for(let o=0;o<this.staticProperties.length;++o){const a=this.staticProperties[o];e.addAttribute(a.attributeName,this.staticBuffer,0,a.type===Te.UNSIGNED_BYTE,a.type,this.staticStride*4,a.offset*4)}}uploadDynamic(e,n,r){for(let i=0;i<this.dynamicProperties.length;i++){const s=this.dynamicProperties[i];s.uploadFunction(e,n,r,s.type===Te.UNSIGNED_BYTE?this.dynamicDataUint32:this.dynamicData,this.dynamicStride,s.offset)}this.dynamicBuffer._updateID++}uploadStatic(e,n,r){for(let i=0;i<this.staticProperties.length;i++){const s=this.staticProperties[i];s.uploadFunction(e,n,r,s.type===Te.UNSIGNED_BYTE?this.staticDataUint32:this.staticData,this.staticStride,s.offset)}this.staticBuffer._updateID++}destroy(){this.indexBuffer=null,this.dynamicProperties=null,this.dynamicBuffer=null,this.dynamicData=null,this.dynamicDataUint32=null,this.staticProperties=null,this.staticBuffer=null,this.staticData=null,this.staticDataUint32=null,this.geometry.destroy()}}var Fq=`varying vec2 vTextureCoord;
varying vec4 vColor;

uniform sampler2D uSampler;

void main(void){
    vec4 color = texture2D(uSampler, vTextureCoord) * vColor;
    gl_FragColor = color;
}`,Bq=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;
attribute vec4 aColor;

attribute vec2 aPositionCoord;
attribute float aRotation;

uniform mat3 translationMatrix;
uniform vec4 uColor;

varying vec2 vTextureCoord;
varying vec4 vColor;

void main(void){
    float x = (aVertexPosition.x) * cos(aRotation) - (aVertexPosition.y) * sin(aRotation);
    float y = (aVertexPosition.x) * sin(aRotation) + (aVertexPosition.y) * cos(aRotation);

    vec2 v = vec2(x, y);
    v = v + aPositionCoord;

    gl_Position = vec4((translationMatrix * vec3(v, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = aTextureCoord;
    vColor = aColor * uColor;
}
`;class sO extends Nv{constructor(e){super(e),this.shader=null,this.properties=null,this.tempMatrix=new Ze,this.properties=[{attributeName:"aVertexPosition",size:2,uploadFunction:this.uploadVertices,offset:0},{attributeName:"aPositionCoord",size:2,uploadFunction:this.uploadPosition,offset:0},{attributeName:"aRotation",size:1,uploadFunction:this.uploadRotation,offset:0},{attributeName:"aTextureCoord",size:2,uploadFunction:this.uploadUvs,offset:0},{attributeName:"aColor",size:1,type:Te.UNSIGNED_BYTE,uploadFunction:this.uploadTint,offset:0}],this.shader=ms.from(Bq,Fq,{}),this.state=Ts.for2d()}render(e){const n=e.children,r=e._maxSize,i=e._batchSize,s=this.renderer;let o=n.length;if(o===0)return;o>r&&!e.autoResize&&(o=r);let a=e._buffers;a||(a=e._buffers=this.generateBuffers(e));const l=n[0]._texture.baseTexture,c=l.alphaMode>0;this.state.blendMode=VR(e.blendMode,c),s.state.set(this.state);const u=s.gl,d=e.worldTransform.copyTo(this.tempMatrix);d.prepend(s.globalUniforms.uniforms.projectionMatrix),this.shader.uniforms.translationMatrix=d.toArray(!0),this.shader.uniforms.uColor=pt.shared.setValue(e.tintRgb).premultiply(e.worldAlpha,c).toArray(this.shader.uniforms.uColor),this.shader.uniforms.uSampler=l,this.renderer.shader.bind(this.shader);let h=!1;for(let f=0,p=0;f<o;f+=i,p+=1){let m=o-f;m>i&&(m=i),p>=a.length&&a.push(this._generateOneMoreBuffer(e));const v=a[p];v.uploadDynamic(n,f,m);const y=e._bufferUpdateIDs[p]||0;h=h||v._updateID<y,h&&(v._updateID=e._updateID,v.uploadStatic(n,f,m)),s.geometry.bind(v.geometry),u.drawElements(u.TRIANGLES,m*6,u.UNSIGNED_SHORT,0)}}generateBuffers(e){const n=[],r=e._maxSize,i=e._batchSize,s=e._properties;for(let o=0;o<r;o+=i)n.push(new aI(this.properties,s,i));return n}_generateOneMoreBuffer(e){const n=e._batchSize,r=e._properties;return new aI(this.properties,r,n)}uploadVertices(e,n,r,i,s,o){let a=0,l=0,c=0,u=0;for(let d=0;d<r;++d){const h=e[n+d],f=h._texture,p=h.scale.x,m=h.scale.y,v=f.trim,y=f.orig;v?(l=v.x-h.anchor.x*y.width,a=l+v.width,u=v.y-h.anchor.y*y.height,c=u+v.height):(a=y.width*(1-h.anchor.x),l=y.width*-h.anchor.x,c=y.height*(1-h.anchor.y),u=y.height*-h.anchor.y),i[o]=l*p,i[o+1]=u*m,i[o+s]=a*p,i[o+s+1]=u*m,i[o+s*2]=a*p,i[o+s*2+1]=c*m,i[o+s*3]=l*p,i[o+s*3+1]=c*m,o+=s*4}}uploadPosition(e,n,r,i,s,o){for(let a=0;a<r;a++){const l=e[n+a].position;i[o]=l.x,i[o+1]=l.y,i[o+s]=l.x,i[o+s+1]=l.y,i[o+s*2]=l.x,i[o+s*2+1]=l.y,i[o+s*3]=l.x,i[o+s*3+1]=l.y,o+=s*4}}uploadRotation(e,n,r,i,s,o){for(let a=0;a<r;a++){const l=e[n+a].rotation;i[o]=l,i[o+s]=l,i[o+s*2]=l,i[o+s*3]=l,o+=s*4}}uploadUvs(e,n,r,i,s,o){for(let a=0;a<r;++a){const l=e[n+a]._texture._uvs;l?(i[o]=l.x0,i[o+1]=l.y0,i[o+s]=l.x1,i[o+s+1]=l.y1,i[o+s*2]=l.x2,i[o+s*2+1]=l.y2,i[o+s*3]=l.x3,i[o+s*3+1]=l.y3,o+=s*4):(i[o]=0,i[o+1]=0,i[o+s]=0,i[o+s+1]=0,i[o+s*2]=0,i[o+s*2+1]=0,i[o+s*3]=0,i[o+s*3+1]=0,o+=s*4)}}uploadTint(e,n,r,i,s,o){for(let a=0;a<r;++a){const l=e[n+a],c=pt.shared.setValue(l._tintRGB).toPremultiplied(l.alpha,l.texture.baseTexture.alphaMode>0);i[o]=c,i[o+s]=c,i[o+s*2]=c,i[o+s*3]=c,o+=s*4}}destroy(){super.destroy(),this.shader&&(this.shader.destroy(),this.shader=null),this.tempMatrix=null}}sO.extension={name:"particle",type:me.RendererPlugin};Ce.add(sO);var Bv=(t=>(t[t.LINEAR_VERTICAL=0]="LINEAR_VERTICAL",t[t.LINEAR_HORIZONTAL=1]="LINEAR_HORIZONTAL",t))(Bv||{});const X1={willReadFrequently:!0},Us=class Ie{static get experimentalLetterSpacingSupported(){let e=Ie._experimentalLetterSpacingSupported;if(e!==void 0){const n=_e.ADAPTER.getCanvasRenderingContext2D().prototype;e=Ie._experimentalLetterSpacingSupported="letterSpacing"in n||"textLetterSpacing"in n}return e}constructor(e,n,r,i,s,o,a,l,c){this.text=e,this.style=n,this.width=r,this.height=i,this.lines=s,this.lineWidths=o,this.lineHeight=a,this.maxLineWidth=l,this.fontProperties=c}static measureText(e,n,r,i=Ie._canvas){r=r??n.wordWrap;const s=n.toFontString(),o=Ie.measureFont(s);o.fontSize===0&&(o.fontSize=n.fontSize,o.ascent=n.fontSize);const a=i.getContext("2d",X1);a.font=s;const l=(r?Ie.wordWrap(e,n,i):e).split(/(?:\r\n|\r|\n)/),c=new Array(l.length);let u=0;for(let p=0;p<l.length;p++){const m=Ie._measureText(l[p],n.letterSpacing,a);c[p]=m,u=Math.max(u,m)}let d=u+n.strokeThickness;n.dropShadow&&(d+=n.dropShadowDistance);const h=n.lineHeight||o.fontSize+n.strokeThickness;let f=Math.max(h,o.fontSize+n.strokeThickness*2)+n.leading+(l.length-1)*(h+n.leading);return n.dropShadow&&(f+=n.dropShadowDistance),new Ie(e,n,d,f,l,c,h+n.leading,u,o)}static _measureText(e,n,r){let i=!1;Ie.experimentalLetterSpacingSupported&&(Ie.experimentalLetterSpacing?(r.letterSpacing=`${n}px`,r.textLetterSpacing=`${n}px`,i=!0):(r.letterSpacing="0px",r.textLetterSpacing="0px"));let s=r.measureText(e).width;return s>0&&(i?s-=n:s+=(Ie.graphemeSegmenter(e).length-1)*n),s}static wordWrap(e,n,r=Ie._canvas){const i=r.getContext("2d",X1);let s=0,o="",a="";const l=Object.create(null),{letterSpacing:c,whiteSpace:u}=n,d=Ie.collapseSpaces(u),h=Ie.collapseNewlines(u);let f=!d;const p=n.wordWrapWidth+c,m=Ie.tokenize(e);for(let v=0;v<m.length;v++){let y=m[v];if(Ie.isNewline(y)){if(!h){a+=Ie.addLine(o),f=!d,o="",s=0;continue}y=" "}if(d){const _=Ie.isBreakingSpace(y),E=Ie.isBreakingSpace(o[o.length-1]);if(_&&E)continue}const b=Ie.getFromCache(y,c,l,i);if(b>p)if(o!==""&&(a+=Ie.addLine(o),o="",s=0),Ie.canBreakWords(y,n.breakWords)){const _=Ie.wordWrapSplit(y);for(let E=0;E<_.length;E++){let w=_[E],x=w,T=1;for(;_[E+T];){const k=_[E+T];if(!Ie.canBreakChars(x,k,y,E,n.breakWords))w+=k;else break;x=k,T++}E+=T-1;const C=Ie.getFromCache(w,c,l,i);C+s>p&&(a+=Ie.addLine(o),f=!1,o="",s=0),o+=w,s+=C}}else{o.length>0&&(a+=Ie.addLine(o),o="",s=0);const _=v===m.length-1;a+=Ie.addLine(y,!_),f=!1,o="",s=0}else b+s>p&&(f=!1,a+=Ie.addLine(o),o="",s=0),(o.length>0||!Ie.isBreakingSpace(y)||f)&&(o+=y,s+=b)}return a+=Ie.addLine(o,!1),a}static addLine(e,n=!0){return e=Ie.trimRight(e),e=n?`${e}
`:e,e}static getFromCache(e,n,r,i){let s=r[e];return typeof s!="number"&&(s=Ie._measureText(e,n,i)+n,r[e]=s),s}static collapseSpaces(e){return e==="normal"||e==="pre-line"}static collapseNewlines(e){return e==="normal"}static trimRight(e){if(typeof e!="string")return"";for(let n=e.length-1;n>=0;n--){const r=e[n];if(!Ie.isBreakingSpace(r))break;e=e.slice(0,-1)}return e}static isNewline(e){return typeof e!="string"?!1:Ie._newlines.includes(e.charCodeAt(0))}static isBreakingSpace(e,n){return typeof e!="string"?!1:Ie._breakingSpaces.includes(e.charCodeAt(0))}static tokenize(e){const n=[];let r="";if(typeof e!="string")return n;for(let i=0;i<e.length;i++){const s=e[i],o=e[i+1];if(Ie.isBreakingSpace(s,o)||Ie.isNewline(s)){r!==""&&(n.push(r),r=""),n.push(s);continue}r+=s}return r!==""&&n.push(r),n}static canBreakWords(e,n){return n}static canBreakChars(e,n,r,i,s){return!0}static wordWrapSplit(e){return Ie.graphemeSegmenter(e)}static measureFont(e){if(Ie._fonts[e])return Ie._fonts[e];const n={ascent:0,descent:0,fontSize:0},r=Ie._canvas,i=Ie._context;i.font=e;const s=Ie.METRICS_STRING+Ie.BASELINE_SYMBOL,o=Math.ceil(i.measureText(s).width);let a=Math.ceil(i.measureText(Ie.BASELINE_SYMBOL).width);const l=Math.ceil(Ie.HEIGHT_MULTIPLIER*a);if(a=a*Ie.BASELINE_MULTIPLIER|0,o===0||l===0)return Ie._fonts[e]=n,n;r.width=o,r.height=l,i.fillStyle="#f00",i.fillRect(0,0,o,l),i.font=e,i.textBaseline="alphabetic",i.fillStyle="#000",i.fillText(s,0,a);const c=i.getImageData(0,0,o,l).data,u=c.length,d=o*4;let h=0,f=0,p=!1;for(h=0;h<a;++h){for(let m=0;m<d;m+=4)if(c[f+m]!==255){p=!0;break}if(!p)f+=d;else break}for(n.ascent=a-h,f=u-d,p=!1,h=l;h>a;--h){for(let m=0;m<d;m+=4)if(c[f+m]!==255){p=!0;break}if(!p)f-=d;else break}return n.descent=h-a,n.fontSize=n.ascent+n.descent,Ie._fonts[e]=n,n}static clearMetrics(e=""){e?delete Ie._fonts[e]:Ie._fonts={}}static get _canvas(){var e;if(!Ie.__canvas){let n;try{const r=new OffscreenCanvas(0,0);if((e=r.getContext("2d",X1))!=null&&e.measureText)return Ie.__canvas=r,r;n=_e.ADAPTER.createCanvas()}catch{n=_e.ADAPTER.createCanvas()}n.width=n.height=10,Ie.__canvas=n}return Ie.__canvas}static get _context(){return Ie.__context||(Ie.__context=Ie._canvas.getContext("2d",X1)),Ie.__context}};Us.METRICS_STRING="|ÉqÅ",Us.BASELINE_SYMBOL="M",Us.BASELINE_MULTIPLIER=1.4,Us.HEIGHT_MULTIPLIER=2,Us.graphemeSegmenter=(()=>{if(typeof(Intl==null?void 0:Intl.Segmenter)=="function"){const t=new Intl.Segmenter;return e=>[...t.segment(e)].map(n=>n.segment)}return t=>[...t]})(),Us.experimentalLetterSpacing=!1,Us._fonts={},Us._newlines=[10,13],Us._breakingSpaces=[9,32,8192,8193,8194,8195,8196,8197,8198,8200,8201,8202,8287,12288];let rs=Us;const Uq=["serif","sans-serif","monospace","cursive","fantasy","system-ui"],oO=class Sf{constructor(e){this.styleID=0,this.reset(),Qb(this,e,e)}clone(){const e={};return Qb(e,this,Sf.defaultStyle),new Sf(e)}reset(){Qb(this,Sf.defaultStyle,Sf.defaultStyle)}get align(){return this._align}set align(e){this._align!==e&&(this._align=e,this.styleID++)}get breakWords(){return this._breakWords}set breakWords(e){this._breakWords!==e&&(this._breakWords=e,this.styleID++)}get dropShadow(){return this._dropShadow}set dropShadow(e){this._dropShadow!==e&&(this._dropShadow=e,this.styleID++)}get dropShadowAlpha(){return this._dropShadowAlpha}set dropShadowAlpha(e){this._dropShadowAlpha!==e&&(this._dropShadowAlpha=e,this.styleID++)}get dropShadowAngle(){return this._dropShadowAngle}set dropShadowAngle(e){this._dropShadowAngle!==e&&(this._dropShadowAngle=e,this.styleID++)}get dropShadowBlur(){return this._dropShadowBlur}set dropShadowBlur(e){this._dropShadowBlur!==e&&(this._dropShadowBlur=e,this.styleID++)}get dropShadowColor(){return this._dropShadowColor}set dropShadowColor(e){const n=Jb(e);this._dropShadowColor!==n&&(this._dropShadowColor=n,this.styleID++)}get dropShadowDistance(){return this._dropShadowDistance}set dropShadowDistance(e){this._dropShadowDistance!==e&&(this._dropShadowDistance=e,this.styleID++)}get fill(){return this._fill}set fill(e){const n=Jb(e);this._fill!==n&&(this._fill=n,this.styleID++)}get fillGradientType(){return this._fillGradientType}set fillGradientType(e){this._fillGradientType!==e&&(this._fillGradientType=e,this.styleID++)}get fillGradientStops(){return this._fillGradientStops}set fillGradientStops(e){$q(this._fillGradientStops,e)||(this._fillGradientStops=e,this.styleID++)}get fontFamily(){return this._fontFamily}set fontFamily(e){this.fontFamily!==e&&(this._fontFamily=e,this.styleID++)}get fontSize(){return this._fontSize}set fontSize(e){this._fontSize!==e&&(this._fontSize=e,this.styleID++)}get fontStyle(){return this._fontStyle}set fontStyle(e){this._fontStyle!==e&&(this._fontStyle=e,this.styleID++)}get fontVariant(){return this._fontVariant}set fontVariant(e){this._fontVariant!==e&&(this._fontVariant=e,this.styleID++)}get fontWeight(){return this._fontWeight}set fontWeight(e){this._fontWeight!==e&&(this._fontWeight=e,this.styleID++)}get letterSpacing(){return this._letterSpacing}set letterSpacing(e){this._letterSpacing!==e&&(this._letterSpacing=e,this.styleID++)}get lineHeight(){return this._lineHeight}set lineHeight(e){this._lineHeight!==e&&(this._lineHeight=e,this.styleID++)}get leading(){return this._leading}set leading(e){this._leading!==e&&(this._leading=e,this.styleID++)}get lineJoin(){return this._lineJoin}set lineJoin(e){this._lineJoin!==e&&(this._lineJoin=e,this.styleID++)}get miterLimit(){return this._miterLimit}set miterLimit(e){this._miterLimit!==e&&(this._miterLimit=e,this.styleID++)}get padding(){return this._padding}set padding(e){this._padding!==e&&(this._padding=e,this.styleID++)}get stroke(){return this._stroke}set stroke(e){const n=Jb(e);this._stroke!==n&&(this._stroke=n,this.styleID++)}get strokeThickness(){return this._strokeThickness}set strokeThickness(e){this._strokeThickness!==e&&(this._strokeThickness=e,this.styleID++)}get textBaseline(){return this._textBaseline}set textBaseline(e){this._textBaseline!==e&&(this._textBaseline=e,this.styleID++)}get trim(){return this._trim}set trim(e){this._trim!==e&&(this._trim=e,this.styleID++)}get whiteSpace(){return this._whiteSpace}set whiteSpace(e){this._whiteSpace!==e&&(this._whiteSpace=e,this.styleID++)}get wordWrap(){return this._wordWrap}set wordWrap(e){this._wordWrap!==e&&(this._wordWrap=e,this.styleID++)}get wordWrapWidth(){return this._wordWrapWidth}set wordWrapWidth(e){this._wordWrapWidth!==e&&(this._wordWrapWidth=e,this.styleID++)}toFontString(){const e=typeof this.fontSize=="number"?`${this.fontSize}px`:this.fontSize;let n=this.fontFamily;Array.isArray(this.fontFamily)||(n=this.fontFamily.split(","));for(let r=n.length-1;r>=0;r--){let i=n[r].trim();!/([\"\'])[^\'\"]+\1/.test(i)&&!Uq.includes(i)&&(i=`"${i}"`),n[r]=i}return`${this.fontStyle} ${this.fontVariant} ${this.fontWeight} ${e} ${n.join(",")}`}};oO.defaultStyle={align:"left",breakWords:!1,dropShadow:!1,dropShadowAlpha:1,dropShadowAngle:Math.PI/6,dropShadowBlur:0,dropShadowColor:"black",dropShadowDistance:5,fill:"black",fillGradientType:Bv.LINEAR_VERTICAL,fillGradientStops:[],fontFamily:"Arial",fontSize:26,fontStyle:"normal",fontVariant:"normal",fontWeight:"normal",leading:0,letterSpacing:0,lineHeight:0,lineJoin:"miter",miterLimit:10,padding:0,stroke:"black",strokeThickness:0,textBaseline:"alphabetic",trim:!1,whiteSpace:"pre",wordWrap:!1,wordWrapWidth:100};let Ci=oO;function Jb(t){const e=pt.shared,n=r=>{const i=e.setValue(r);return i.alpha===1?i.toHex():i.toRgbaString()};return Array.isArray(t)?t.map(n):n(t)}function $q(t,e){if(!Array.isArray(t)||!Array.isArray(e)||t.length!==e.length)return!1;for(let n=0;n<t.length;++n)if(t[n]!==e[n])return!1;return!0}function Qb(t,e,n){for(const r in n)Array.isArray(e[r])?t[r]=e[r].slice():t[r]=e[r]}const Hq={texture:!0,children:!1,baseTexture:!0},aO=class lx extends On{constructor(e,n,r){let i=!1;r||(r=_e.ADAPTER.createCanvas(),i=!0),r.width=3,r.height=3;const s=he.from(r);s.orig=new Me,s.trim=new Me,super(s),this._ownCanvas=i,this.canvas=r,this.context=r.getContext("2d",{willReadFrequently:!0}),this._resolution=lx.defaultResolution??_e.RESOLUTION,this._autoResolution=lx.defaultAutoResolution,this._text=null,this._style=null,this._styleListener=null,this._font="",this.text=e,this.style=n,this.localStyleID=-1}static get experimentalLetterSpacing(){return rs.experimentalLetterSpacing}static set experimentalLetterSpacing(e){Qe("7.1.0","Text.experimentalLetterSpacing is deprecated, use TextMetrics.experimentalLetterSpacing"),rs.experimentalLetterSpacing=e}updateText(e){const n=this._style;if(this.localStyleID!==n.styleID&&(this.dirty=!0,this.localStyleID=n.styleID),!this.dirty&&e)return;this._font=this._style.toFontString();const r=this.context,i=rs.measureText(this._text||" ",this._style,this._style.wordWrap,this.canvas),s=i.width,o=i.height,a=i.lines,l=i.lineHeight,c=i.lineWidths,u=i.maxLineWidth,d=i.fontProperties;this.canvas.width=Math.ceil(Math.ceil(Math.max(1,s)+n.padding*2)*this._resolution),this.canvas.height=Math.ceil(Math.ceil(Math.max(1,o)+n.padding*2)*this._resolution),r.scale(this._resolution,this._resolution),r.clearRect(0,0,this.canvas.width,this.canvas.height),r.font=this._font,r.lineWidth=n.strokeThickness,r.textBaseline=n.textBaseline,r.lineJoin=n.lineJoin,r.miterLimit=n.miterLimit;let h,f;const p=n.dropShadow?2:1;for(let m=0;m<p;++m){const v=n.dropShadow&&m===0,y=v?Math.ceil(Math.max(1,o)+n.padding*2):0,b=y*this._resolution;if(v){r.fillStyle="black",r.strokeStyle="black";const E=n.dropShadowColor,w=n.dropShadowBlur*this._resolution,x=n.dropShadowDistance*this._resolution;r.shadowColor=pt.shared.setValue(E).setAlpha(n.dropShadowAlpha).toRgbaString(),r.shadowBlur=w,r.shadowOffsetX=Math.cos(n.dropShadowAngle)*x,r.shadowOffsetY=Math.sin(n.dropShadowAngle)*x+b}else r.fillStyle=this._generateFillStyle(n,a,i),r.strokeStyle=n.stroke,r.shadowColor="black",r.shadowBlur=0,r.shadowOffsetX=0,r.shadowOffsetY=0;let _=(l-d.fontSize)/2;l-d.fontSize<0&&(_=0);for(let E=0;E<a.length;E++)h=n.strokeThickness/2,f=n.strokeThickness/2+E*l+d.ascent+_,n.align==="right"?h+=u-c[E]:n.align==="center"&&(h+=(u-c[E])/2),n.stroke&&n.strokeThickness&&this.drawLetterSpacing(a[E],h+n.padding,f+n.padding-y,!0),n.fill&&this.drawLetterSpacing(a[E],h+n.padding,f+n.padding-y)}this.updateTexture()}drawLetterSpacing(e,n,r,i=!1){const s=this._style.letterSpacing;let o=!1;if(rs.experimentalLetterSpacingSupported&&(rs.experimentalLetterSpacing?(this.context.letterSpacing=`${s}px`,this.context.textLetterSpacing=`${s}px`,o=!0):(this.context.letterSpacing="0px",this.context.textLetterSpacing="0px")),s===0||o){i?this.context.strokeText(e,n,r):this.context.fillText(e,n,r);return}let a=n;const l=rs.graphemeSegmenter(e);let c=this.context.measureText(e).width,u=0;for(let d=0;d<l.length;++d){const h=l[d];i?this.context.strokeText(h,a,r):this.context.fillText(h,a,r);let f="";for(let p=d+1;p<l.length;++p)f+=l[p];u=this.context.measureText(f).width,a+=c-u+s,c=u}}updateTexture(){const e=this.canvas;if(this._style.trim){const o=fY(e);o.data&&(e.width=o.width,e.height=o.height,this.context.putImageData(o.data,0,0))}const n=this._texture,r=this._style,i=r.trim?0:r.padding,s=n.baseTexture;n.trim.width=n._frame.width=e.width/this._resolution,n.trim.height=n._frame.height=e.height/this._resolution,n.trim.x=-i,n.trim.y=-i,n.orig.width=n._frame.width-i*2,n.orig.height=n._frame.height-i*2,this._onTextureUpdate(),s.setRealSize(e.width,e.height,this._resolution),n.updateUvs(),this.dirty=!1}_render(e){this._autoResolution&&this._resolution!==e.resolution&&(this._resolution=e.resolution,this.dirty=!0),this.updateText(!0),super._render(e)}updateTransform(){this.updateText(!0),super.updateTransform()}getBounds(e,n){return this.updateText(!0),this._textureID===-1&&(e=!1),super.getBounds(e,n)}getLocalBounds(e){return this.updateText(!0),super.getLocalBounds.call(this,e)}_calculateBounds(){this.calculateVertices(),this._bounds.addQuad(this.vertexData)}_generateFillStyle(e,n,r){const i=e.fill;if(Array.isArray(i)){if(i.length===1)return i[0]}else return i;let s;const o=e.dropShadow?e.dropShadowDistance:0,a=e.padding||0,l=this.canvas.width/this._resolution-o-a*2,c=this.canvas.height/this._resolution-o-a*2,u=i.slice(),d=e.fillGradientStops.slice();if(!d.length){const h=u.length+1;for(let f=1;f<h;++f)d.push(f/h)}if(u.unshift(i[0]),d.unshift(0),u.push(i[i.length-1]),d.push(1),e.fillGradientType===Bv.LINEAR_VERTICAL){s=this.context.createLinearGradient(l/2,a,l/2,c+a);const h=r.fontProperties.fontSize+e.strokeThickness;for(let f=0;f<n.length;f++){const p=r.lineHeight*(f-1)+h,m=r.lineHeight*f;let v=m;f>0&&p>m&&(v=(m+p)/2);const y=m+h,b=r.lineHeight*(f+1);let _=y;f+1<n.length&&b<y&&(_=(y+b)/2);const E=(_-v)/c;for(let w=0;w<u.length;w++){let x=0;typeof d[w]=="number"?x=d[w]:x=w/u.length;let T=Math.min(1,Math.max(0,v/c+x*E));T=Number(T.toFixed(5)),s.addColorStop(T,u[w])}}}else{s=this.context.createLinearGradient(a,c/2,l+a,c/2);const h=u.length+1;let f=1;for(let p=0;p<u.length;p++){let m;typeof d[p]=="number"?m=d[p]:m=f/h,s.addColorStop(m,u[p]),f++}}return s}destroy(e){typeof e=="boolean"&&(e={children:e}),e=Object.assign({},Hq,e),super.destroy(e),this._ownCanvas&&(this.canvas.height=this.canvas.width=0),this.context=null,this.canvas=null,this._style=null}get width(){return this.updateText(!0),Math.abs(this.scale.x)*this._texture.orig.width}set width(e){this.updateText(!0);const n=za(this.scale.x)||1;this.scale.x=n*e/this._texture.orig.width,this._width=e}get height(){return this.updateText(!0),Math.abs(this.scale.y)*this._texture.orig.height}set height(e){this.updateText(!0);const n=za(this.scale.y)||1;this.scale.y=n*e/this._texture.orig.height,this._height=e}get style(){return this._style}set style(e){e=e||{},e instanceof Ci?this._style=e:this._style=new Ci(e),this.localStyleID=-1,this.dirty=!0}get text(){return this._text}set text(e){e=String(e??""),this._text!==e&&(this._text=e,this.dirty=!0)}get resolution(){return this._resolution}set resolution(e){this._autoResolution=!1,this._resolution!==e&&(this._resolution=e,this.dirty=!0)}};aO.defaultAutoResolution=!0;let rS=aO;class zq{constructor(e){this.maxItemsPerFrame=e,this.itemsLeft=0}beginFrame(){this.itemsLeft=this.maxItemsPerFrame}allowedToUpload(){return this.itemsLeft-- >0}}function Gq(t,e){var r;let n=!1;if((r=t==null?void 0:t._textures)!=null&&r.length){for(let i=0;i<t._textures.length;i++)if(t._textures[i]instanceof he){const s=t._textures[i].baseTexture;e.includes(s)||(e.push(s),n=!0)}}return n}function Vq(t,e){if(t.baseTexture instanceof ze){const n=t.baseTexture;return e.includes(n)||e.push(n),!0}return!1}function Wq(t,e){if(t._texture&&t._texture instanceof he){const n=t._texture.baseTexture;return e.includes(n)||e.push(n),!0}return!1}function jq(t,e){return e instanceof rS?(e.updateText(!0),!0):!1}function Xq(t,e){if(e instanceof Ci){const n=e.toFontString();return rs.measureFont(n),!0}return!1}function Yq(t,e){if(t instanceof rS){e.includes(t.style)||e.push(t.style),e.includes(t)||e.push(t);const n=t._texture.baseTexture;return e.includes(n)||e.push(n),!0}return!1}function Zq(t,e){return t instanceof Ci?(e.includes(t)||e.push(t),!0):!1}const lO=class cO{constructor(e){this.limiter=new zq(cO.uploadsPerFrame),this.renderer=e,this.uploadHookHelper=null,this.queue=[],this.addHooks=[],this.uploadHooks=[],this.completes=[],this.ticking=!1,this.delayedTick=()=>{this.queue&&this.prepareItems()},this.registerFindHook(Yq),this.registerFindHook(Zq),this.registerFindHook(Gq),this.registerFindHook(Vq),this.registerFindHook(Wq),this.registerUploadHook(jq),this.registerUploadHook(Xq)}upload(e){return new Promise(n=>{e&&this.add(e),this.queue.length?(this.completes.push(n),this.ticking||(this.ticking=!0,ci.system.addOnce(this.tick,this,Vc.UTILITY))):n()})}tick(){setTimeout(this.delayedTick,0)}prepareItems(){for(this.limiter.beginFrame();this.queue.length&&this.limiter.allowedToUpload();){const e=this.queue[0];let n=!1;if(e&&!e._destroyed){for(let r=0,i=this.uploadHooks.length;r<i;r++)if(this.uploadHooks[r](this.uploadHookHelper,e)){this.queue.shift(),n=!0;break}}n||this.queue.shift()}if(this.queue.length)ci.system.addOnce(this.tick,this,Vc.UTILITY);else{this.ticking=!1;const e=this.completes.slice(0);this.completes.length=0;for(let n=0,r=e.length;n<r;n++)e[n]()}}registerFindHook(e){return e&&this.addHooks.push(e),this}registerUploadHook(e){return e&&this.uploadHooks.push(e),this}add(e){for(let n=0,r=this.addHooks.length;n<r&&!this.addHooks[n](e,this.queue);n++);if(e instanceof Xn)for(let n=e.children.length-1;n>=0;n--)this.add(e.children[n]);return this}destroy(){this.ticking&&ci.system.remove(this.tick,this),this.ticking=!1,this.addHooks=null,this.uploadHooks=null,this.renderer=null,this.completes=null,this.queue=null,this.limiter=null,this.uploadHookHelper=null}};lO.uploadsPerFrame=4;let cx=lO;Object.defineProperties(_e,{UPLOADS_PER_FRAME:{get(){return cx.uploadsPerFrame},set(t){Qe("7.1.0","settings.UPLOADS_PER_FRAME is deprecated, use prepare.BasePrepare.uploadsPerFrame"),cx.uploadsPerFrame=t}}});function uO(t,e){return e instanceof ze?(e._glTextures[t.CONTEXT_UID]||t.texture.bind(e),!0):!1}function Kq(t,e){if(!(e instanceof uu))return!1;const{geometry:n}=e;e.finishPoly(),n.updateBatches();const{batches:r}=n;for(let i=0;i<r.length;i++){const{texture:s}=r[i].style;s&&uO(t,s.baseTexture)}return n.batchable||t.geometry.bind(n,e._resolveDirectShader(t)),!0}function qq(t,e){return t instanceof uu?(e.push(t),!0):!1}class dO extends cx{constructor(e){super(e),this.uploadHookHelper=this.renderer,this.registerFindHook(qq),this.registerUploadHook(uO),this.registerUploadHook(Kq)}}dO.extension={name:"prepare",type:me.RendererSystem};Ce.add(dO);var Jq=`#version 300 es
#define SHADER_NAME Tiling-Sprite-100

precision lowp float;

in vec2 vTextureCoord;

out vec4 fragmentColor;

uniform sampler2D uSampler;
uniform vec4 uColor;
uniform mat3 uMapCoord;
uniform vec4 uClampFrame;
uniform vec2 uClampOffset;

void main(void)
{
    vec2 coord = vTextureCoord + ceil(uClampOffset - vTextureCoord);
    coord = (uMapCoord * vec3(coord, 1.0)).xy;
    vec2 unclamped = coord;
    coord = clamp(coord, uClampFrame.xy, uClampFrame.zw);

    vec4 texSample = texture(uSampler, coord, unclamped == coord ? 0.0f : -32.0f);// lod-bias very negative to force lod 0

    fragmentColor = texSample * uColor;
}
`,Qq=`#version 300 es
#define SHADER_NAME Tiling-Sprite-300

precision lowp float;

in vec2 aVertexPosition;
in vec2 aTextureCoord;

uniform mat3 projectionMatrix;
uniform mat3 translationMatrix;
uniform mat3 uTransform;

out vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = (uTransform * vec3(aTextureCoord, 1.0)).xy;
}
`,eJ=`#version 100
#ifdef GL_EXT_shader_texture_lod
    #extension GL_EXT_shader_texture_lod : enable
#endif
#define SHADER_NAME Tiling-Sprite-100

precision lowp float;

varying vec2 vTextureCoord;

uniform sampler2D uSampler;
uniform vec4 uColor;
uniform mat3 uMapCoord;
uniform vec4 uClampFrame;
uniform vec2 uClampOffset;

void main(void)
{
    vec2 coord = vTextureCoord + ceil(uClampOffset - vTextureCoord);
    coord = (uMapCoord * vec3(coord, 1.0)).xy;
    vec2 unclamped = coord;
    coord = clamp(coord, uClampFrame.xy, uClampFrame.zw);

    #ifdef GL_EXT_shader_texture_lod
        vec4 texSample = unclamped == coord
            ? texture2D(uSampler, coord) 
            : texture2DLodEXT(uSampler, coord, 0);
    #else
        vec4 texSample = texture2D(uSampler, coord);
    #endif

    gl_FragColor = texSample * uColor;
}
`,lI=`#version 100
#define SHADER_NAME Tiling-Sprite-100

precision lowp float;

attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;
uniform mat3 translationMatrix;
uniform mat3 uTransform;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = (uTransform * vec3(aTextureCoord, 1.0)).xy;
}
`,tJ=`#version 100
#define SHADER_NAME Tiling-Sprite-Simple-100

precision lowp float;

varying vec2 vTextureCoord;

uniform sampler2D uSampler;
uniform vec4 uColor;

void main(void)
{
    vec4 texSample = texture2D(uSampler, vTextureCoord);
    gl_FragColor = texSample * uColor;
}
`;const Y1=new Ze;class hO extends Nv{constructor(e){super(e),e.runners.contextChange.add(this),this.quad=new i9,this.state=Ts.for2d()}contextChange(){const e=this.renderer,n={globals:e.globalUniforms};this.simpleShader=ms.from(lI,tJ,n),this.shader=e.context.webGLVersion>1?ms.from(Qq,Jq,n):ms.from(lI,eJ,n)}render(e){const n=this.renderer,r=this.quad;let i=r.vertices;i[0]=i[6]=e._width*-e.anchor.x,i[1]=i[3]=e._height*-e.anchor.y,i[2]=i[4]=e._width*(1-e.anchor.x),i[5]=i[7]=e._height*(1-e.anchor.y);const s=e.uvRespectAnchor?e.anchor.x:0,o=e.uvRespectAnchor?e.anchor.y:0;i=r.uvs,i[0]=i[6]=-s,i[1]=i[3]=-o,i[2]=i[4]=1-s,i[5]=i[7]=1-o,r.invalidate();const a=e._texture,l=a.baseTexture,c=l.alphaMode>0,u=e.tileTransform.localTransform,d=e.uvMatrix;let h=l.isPowerOfTwo&&a.frame.width===l.width&&a.frame.height===l.height;h&&(l._glTextures[n.CONTEXT_UID]?h=l.wrapMode!==Go.CLAMP:l.wrapMode===Go.CLAMP&&(l.wrapMode=Go.REPEAT));const f=h?this.simpleShader:this.shader,p=a.width,m=a.height,v=e._width,y=e._height;Y1.set(u.a*p/v,u.b*p/y,u.c*m/v,u.d*m/y,u.tx/v,u.ty/y),Y1.invert(),h?Y1.prepend(d.mapCoord):(f.uniforms.uMapCoord=d.mapCoord.toArray(!0),f.uniforms.uClampFrame=d.uClampFrame,f.uniforms.uClampOffset=d.uClampOffset),f.uniforms.uTransform=Y1.toArray(!0),f.uniforms.uColor=pt.shared.setValue(e.tint).premultiply(e.worldAlpha,c).toArray(f.uniforms.uColor),f.uniforms.translationMatrix=e.transform.worldTransform.toArray(!0),f.uniforms.uSampler=a,n.shader.bind(f),n.geometry.bind(r),this.state.blendMode=VR(e.blendMode,c),n.state.set(this.state),n.geometry.draw(this.renderer.gl.TRIANGLES,6,0)}}hO.extension={name:"tilingSprite",type:me.RendererPlugin};Ce.add(hO);const fO=class Cf{constructor(e,n,r=null){this.linkedSheets=[],this._texture=e instanceof he?e:null,this.baseTexture=e instanceof ze?e:this._texture.baseTexture,this.textures={},this.animations={},this.data=n;const i=this.baseTexture.resource;this.resolution=this._updateResolution(r||(i?i.url:null)),this._frames=this.data.frames,this._frameKeys=Object.keys(this._frames),this._batchIndex=0,this._callback=null}_updateResolution(e=null){const{scale:n}=this.data.meta;let r=Qo(e,null);return r===null&&(r=typeof n=="number"?n:parseFloat(n??"1")),r!==1&&this.baseTexture.setResolution(r),r}parse(){return new Promise(e=>{this._callback=e,this._batchIndex=0,this._frameKeys.length<=Cf.BATCH_SIZE?(this._processFrames(0),this._processAnimations(),this._parseComplete()):this._nextBatch()})}_processFrames(e){let n=e;const r=Cf.BATCH_SIZE;for(;n-e<r&&n<this._frameKeys.length;){const i=this._frameKeys[n],s=this._frames[i],o=s.frame;if(o){let a=null,l=null;const c=s.trimmed!==!1&&s.sourceSize?s.sourceSize:s.frame,u=new Me(0,0,Math.floor(c.w)/this.resolution,Math.floor(c.h)/this.resolution);s.rotated?a=new Me(Math.floor(o.x)/this.resolution,Math.floor(o.y)/this.resolution,Math.floor(o.h)/this.resolution,Math.floor(o.w)/this.resolution):a=new Me(Math.floor(o.x)/this.resolution,Math.floor(o.y)/this.resolution,Math.floor(o.w)/this.resolution,Math.floor(o.h)/this.resolution),s.trimmed!==!1&&s.spriteSourceSize&&(l=new Me(Math.floor(s.spriteSourceSize.x)/this.resolution,Math.floor(s.spriteSourceSize.y)/this.resolution,Math.floor(o.w)/this.resolution,Math.floor(o.h)/this.resolution)),this.textures[i]=new he(this.baseTexture,a,u,l,s.rotated?2:0,s.anchor,s.borders),he.addToCache(this.textures[i],i.toString())}n++}}_processAnimations(){const e=this.data.animations||{};for(const n in e){this.animations[n]=[];for(let r=0;r<e[n].length;r++){const i=e[n][r];this.animations[n].push(this.textures[i])}}}_parseComplete(){const e=this._callback;this._callback=null,this._batchIndex=0,e.call(this,this.textures)}_nextBatch(){this._processFrames(this._batchIndex*Cf.BATCH_SIZE),this._batchIndex++,setTimeout(()=>{this._batchIndex*Cf.BATCH_SIZE<this._frameKeys.length?this._nextBatch():(this._processAnimations(),this._parseComplete())},0)}destroy(e=!1){var n;for(const r in this.textures)this.textures[r].destroy();this._frames=null,this._frameKeys=null,this.data=null,this.textures=null,e&&((n=this._texture)==null||n.destroy(),this.baseTexture.destroy()),this._texture=null,this.baseTexture=null,this.linkedSheets=[]}};fO.BATCH_SIZE=1e3;let cI=fO;const nJ=["jpg","png","jpeg","avif","webp"];function pO(t,e,n){const r={};if(t.forEach(i=>{r[i]=e}),Object.keys(e.textures).forEach(i=>{r[i]=e.textures[i]}),!n){const i=Rn.dirname(t[0]);e.linkedSheets.forEach((s,o)=>{const a=pO([`${i}/${e.data.meta.related_multi_packs[o]}`],s,!0);Object.assign(r,a)})}return r}const rJ={extension:me.Asset,cache:{test:t=>t instanceof cI,getCacheableAssets:(t,e)=>pO(t,e,!1)},resolver:{test:t=>{const e=t.split("?")[0].split("."),n=e.pop(),r=e.pop();return n==="json"&&nJ.includes(r)},parse:t=>{var n;const e=t.split(".");return{resolution:parseFloat(((n=_e.RETINA_PREFIX.exec(t))==null?void 0:n[1])??"1"),format:e[e.length-2],src:t}}},loader:{name:"spritesheetLoader",extension:{type:me.LoadParser,priority:Ss.Normal},async testParse(t,e){return Rn.extname(e.src).toLowerCase()===".json"&&!!t.frames},async parse(t,e,n){var l,c;let r=Rn.dirname(e.src);r&&r.lastIndexOf("/")!==r.length-1&&(r+="/");let i=r+t.meta.image;i=nx(i,e.src);const s=(await n.load([i]))[i],o=new cI(s.baseTexture,t,e.src);await o.parse();const a=(l=t==null?void 0:t.meta)==null?void 0:l.related_multi_packs;if(Array.isArray(a)){const u=[];for(const h of a){if(typeof h!="string")continue;let f=r+h;(c=e.data)!=null&&c.ignoreMultiPack||(f=nx(f,e.src),u.push(n.load({src:f,data:{ignoreMultiPack:!0}})))}const d=await Promise.all(u);o.linkedSheets=d,d.forEach(h=>{h.linkedSheets=[o].concat(o.linkedSheets.filter(f=>f!==h))})}return o},unload(t){t.destroy(!0)}}};Ce.add(rJ);class hy{constructor(){this.info=[],this.common=[],this.page=[],this.char=[],this.kerning=[],this.distanceField=[]}}class Kg{static test(e){return typeof e=="string"&&e.startsWith("info face=")}static parse(e){const n=e.match(/^[a-z]+\s+.+$/gm),r={info:[],common:[],page:[],char:[],chars:[],kerning:[],kernings:[],distanceField:[]};for(const s in n){const o=n[s].match(/^[a-z]+/gm)[0],a=n[s].match(/[a-zA-Z]+=([^\s"']+|"([^"]*)")/gm),l={};for(const c in a){const u=a[c].split("="),d=u[0],h=u[1].replace(/"/gm,""),f=parseFloat(h),p=isNaN(f)?h:f;l[d]=p}r[o].push(l)}const i=new hy;return r.info.forEach(s=>i.info.push({face:s.face,size:parseInt(s.size,10)})),r.common.forEach(s=>i.common.push({lineHeight:parseInt(s.lineHeight,10)})),r.page.forEach(s=>i.page.push({id:parseInt(s.id,10),file:s.file})),r.char.forEach(s=>i.char.push({id:parseInt(s.id,10),page:parseInt(s.page,10),x:parseInt(s.x,10),y:parseInt(s.y,10),width:parseInt(s.width,10),height:parseInt(s.height,10),xoffset:parseInt(s.xoffset,10),yoffset:parseInt(s.yoffset,10),xadvance:parseInt(s.xadvance,10)})),r.kerning.forEach(s=>i.kerning.push({first:parseInt(s.first,10),second:parseInt(s.second,10),amount:parseInt(s.amount,10)})),r.distanceField.forEach(s=>i.distanceField.push({distanceRange:parseInt(s.distanceRange,10),fieldType:s.fieldType})),i}}class ux{static test(e){const n=e;return typeof e!="string"&&"getElementsByTagName"in e&&n.getElementsByTagName("page").length&&n.getElementsByTagName("info")[0].getAttribute("face")!==null}static parse(e){const n=new hy,r=e.getElementsByTagName("info"),i=e.getElementsByTagName("common"),s=e.getElementsByTagName("page"),o=e.getElementsByTagName("char"),a=e.getElementsByTagName("kerning"),l=e.getElementsByTagName("distanceField");for(let c=0;c<r.length;c++)n.info.push({face:r[c].getAttribute("face"),size:parseInt(r[c].getAttribute("size"),10)});for(let c=0;c<i.length;c++)n.common.push({lineHeight:parseInt(i[c].getAttribute("lineHeight"),10)});for(let c=0;c<s.length;c++)n.page.push({id:parseInt(s[c].getAttribute("id"),10)||0,file:s[c].getAttribute("file")});for(let c=0;c<o.length;c++){const u=o[c];n.char.push({id:parseInt(u.getAttribute("id"),10),page:parseInt(u.getAttribute("page"),10)||0,x:parseInt(u.getAttribute("x"),10),y:parseInt(u.getAttribute("y"),10),width:parseInt(u.getAttribute("width"),10),height:parseInt(u.getAttribute("height"),10),xoffset:parseInt(u.getAttribute("xoffset"),10),yoffset:parseInt(u.getAttribute("yoffset"),10),xadvance:parseInt(u.getAttribute("xadvance"),10)})}for(let c=0;c<a.length;c++)n.kerning.push({first:parseInt(a[c].getAttribute("first"),10),second:parseInt(a[c].getAttribute("second"),10),amount:parseInt(a[c].getAttribute("amount"),10)});for(let c=0;c<l.length;c++)n.distanceField.push({fieldType:l[c].getAttribute("fieldType"),distanceRange:parseInt(l[c].getAttribute("distanceRange"),10)});return n}}class dx{static test(e){return typeof e=="string"&&e.includes("<font>")?ux.test(_e.ADAPTER.parseXML(e)):!1}static parse(e){return ux.parse(_e.ADAPTER.parseXML(e))}}const e_=[Kg,ux,dx];function iJ(t){for(let e=0;e<e_.length;e++)if(e_[e].test(t))return e_[e];return null}function sJ(t,e,n,r,i,s){const o=n.fill;if(Array.isArray(o)){if(o.length===1)return o[0]}else return o;let a;const l=n.dropShadow?n.dropShadowDistance:0,c=n.padding||0,u=t.width/r-l-c*2,d=t.height/r-l-c*2,h=o.slice(),f=n.fillGradientStops.slice();if(!f.length){const p=h.length+1;for(let m=1;m<p;++m)f.push(m/p)}if(h.unshift(o[0]),f.unshift(0),h.push(o[o.length-1]),f.push(1),n.fillGradientType===Bv.LINEAR_VERTICAL){a=e.createLinearGradient(u/2,c,u/2,d+c);let p=0;const m=(s.fontProperties.fontSize+n.strokeThickness)/d;for(let v=0;v<i.length;v++){const y=s.lineHeight*v;for(let b=0;b<h.length;b++){let _=0;typeof f[b]=="number"?_=f[b]:_=b/h.length;const E=y/d+_*m;let w=Math.max(p,E);w=Math.min(w,1),a.addColorStop(w,h[b]),p=w}}}else{a=e.createLinearGradient(c,d/2,u+c,d/2);const p=h.length+1;let m=1;for(let v=0;v<h.length;v++){let y;typeof f[v]=="number"?y=f[v]:y=m/p,a.addColorStop(y,h[v]),m++}}return a}function oJ(t,e,n,r,i,s,o){const a=n.text,l=n.fontProperties;e.translate(r,i),e.scale(s,s);const c=o.strokeThickness/2,u=-(o.strokeThickness/2);if(e.font=o.toFontString(),e.lineWidth=o.strokeThickness,e.textBaseline=o.textBaseline,e.lineJoin=o.lineJoin,e.miterLimit=o.miterLimit,e.fillStyle=sJ(t,e,o,s,[a],n),e.strokeStyle=o.stroke,o.dropShadow){const d=o.dropShadowColor,h=o.dropShadowBlur*s,f=o.dropShadowDistance*s;e.shadowColor=pt.shared.setValue(d).setAlpha(o.dropShadowAlpha).toRgbaString(),e.shadowBlur=h,e.shadowOffsetX=Math.cos(o.dropShadowAngle)*f,e.shadowOffsetY=Math.sin(o.dropShadowAngle)*f}else e.shadowColor="black",e.shadowBlur=0,e.shadowOffsetX=0,e.shadowOffsetY=0;o.stroke&&o.strokeThickness&&e.strokeText(a,c,u+n.lineHeight-l.descent),o.fill&&e.fillText(a,c,u+n.lineHeight-l.descent),e.setTransform(1,0,0,1,0,0),e.fillStyle="rgba(0, 0, 0, 0)"}function qg(t){return t.codePointAt?t.codePointAt(0):t.charCodeAt(0)}function mO(t){return Array.from?Array.from(t):t.split("")}function aJ(t){typeof t=="string"&&(t=[t]);const e=[];for(let n=0,r=t.length;n<r;n++){const i=t[n];if(Array.isArray(i)){if(i.length!==2)throw new Error(`[BitmapFont]: Invalid character range length, expecting 2 got ${i.length}.`);const s=i[0].charCodeAt(0),o=i[1].charCodeAt(0);if(o<s)throw new Error("[BitmapFont]: Invalid character range.");for(let a=s,l=o;a<=l;a++)e.push(String.fromCharCode(a))}else e.push(...mO(i))}if(e.length===0)throw new Error("[BitmapFont]: Empty set when resolving characters.");return e}const _a=class $s{constructor(e,n,r){var u;const[i]=e.info,[s]=e.common,[o]=e.page,[a]=e.distanceField,l=Qo(o.file),c={};this._ownsTextures=r,this.font=i.face,this.size=i.size,this.lineHeight=s.lineHeight/l,this.chars={},this.pageTextures=c;for(let d=0;d<e.page.length;d++){const{id:h,file:f}=e.page[d];c[h]=n instanceof Array?n[d]:n[f],a!=null&&a.fieldType&&a.fieldType!=="none"&&(c[h].baseTexture.alphaMode=zr.NO_PREMULTIPLIED_ALPHA,c[h].baseTexture.mipmap=ho.OFF)}for(let d=0;d<e.char.length;d++){const{id:h,page:f}=e.char[d];let{x:p,y:m,width:v,height:y,xoffset:b,yoffset:_,xadvance:E}=e.char[d];p/=l,m/=l,v/=l,y/=l,b/=l,_/=l,E/=l;const w=new Me(p+c[f].frame.x/l,m+c[f].frame.y/l,v,y);this.chars[h]={xOffset:b,yOffset:_,xAdvance:E,kerning:{},texture:new he(c[f].baseTexture,w),page:f}}for(let d=0;d<e.kerning.length;d++){let{first:h,second:f,amount:p}=e.kerning[d];h/=l,f/=l,p/=l,this.chars[f]&&(this.chars[f].kerning[h]=p)}this.distanceFieldRange=a==null?void 0:a.distanceRange,this.distanceFieldType=((u=a==null?void 0:a.fieldType)==null?void 0:u.toLowerCase())??"none"}destroy(){for(const e in this.chars)this.chars[e].texture.destroy(),this.chars[e].texture=null;for(const e in this.pageTextures)this._ownsTextures&&this.pageTextures[e].destroy(!0),this.pageTextures[e]=null;this.chars=null,this.pageTextures=null}static install(e,n,r){let i;if(e instanceof hy)i=e;else{const o=iJ(e);if(!o)throw new Error("Unrecognized data format for font.");i=o.parse(e)}n instanceof he&&(n=[n]);const s=new $s(i,n,r);return $s.available[s.font]=s,s}static uninstall(e){const n=$s.available[e];if(!n)throw new Error(`No font found named '${e}'`);n.destroy(),delete $s.available[e]}static from(e,n,r){if(!e)throw new Error("[BitmapFont] Property `name` is required.");const{chars:i,padding:s,resolution:o,textureWidth:a,textureHeight:l,...c}=Object.assign({},$s.defaultOptions,r),u=aJ(i),d=n instanceof Ci?n:new Ci(n),h=a,f=new hy;f.info[0]={face:d.fontFamily,size:d.fontSize},f.common[0]={lineHeight:d.fontSize};let p=0,m=0,v,y,b,_=0;const E=[];for(let x=0;x<u.length;x++){v||(v=_e.ADAPTER.createCanvas(),v.width=a,v.height=l,y=v.getContext("2d"),b=new ze(v,{resolution:o,...c}),E.push(new he(b)),f.page.push({id:E.length-1,file:""}));const T=u[x],C=rs.measureText(T,d,!1,v),k=C.width,L=Math.ceil(C.height),F=Math.ceil((d.fontStyle==="italic"?2:1)*k);if(m>=l-L*o){if(m===0)throw new Error(`[BitmapFont] textureHeight ${l}px is too small (fontFamily: '${d.fontFamily}', fontSize: ${d.fontSize}px, char: '${T}')`);--x,v=null,y=null,b=null,m=0,p=0,_=0;continue}if(_=Math.max(L+C.fontProperties.descent,_),F*o+p>=h){if(p===0)throw new Error(`[BitmapFont] textureWidth ${a}px is too small (fontFamily: '${d.fontFamily}', fontSize: ${d.fontSize}px, char: '${T}')`);--x,m+=_*o,m=Math.ceil(m),p=0,_=0;continue}oJ(v,y,C,p,m,o,d);const N=qg(C.text);f.char.push({id:N,page:E.length-1,x:p/o,y:m/o,width:F,height:L,xoffset:0,yoffset:0,xadvance:k-(d.dropShadow?d.dropShadowDistance:0)-(d.stroke?d.strokeThickness:0)}),p+=(F+2*s)*o,p=Math.ceil(p)}if(!(r!=null&&r.skipKerning))for(let x=0,T=u.length;x<T;x++){const C=u[x];for(let k=0;k<T;k++){const L=u[k],F=y.measureText(C).width,N=y.measureText(L).width,R=y.measureText(C+L).width-(F+N);R&&f.kerning.push({first:qg(C),second:qg(L),amount:R})}}const w=new $s(f,E,!0);return $s.available[e]!==void 0&&$s.uninstall(e),$s.available[e]=w,w}};_a.ALPHA=[["a","z"],["A","Z"]," "],_a.NUMERIC=[["0","9"]],_a.ALPHANUMERIC=[["a","z"],["A","Z"],["0","9"]," "],_a.ASCII=[[" ","~"]],_a.defaultOptions={resolution:1,textureWidth:512,textureHeight:512,padding:4,chars:_a.ALPHANUMERIC},_a.available={};let Ea=_a;var lJ=`// Pixi texture info\r
varying vec2 vTextureCoord;\r
uniform sampler2D uSampler;\r
\r
// Tint\r
uniform vec4 uColor;\r
\r
// on 2D applications fwidth is screenScale / glyphAtlasScale * distanceFieldRange\r
uniform float uFWidth;\r
\r
void main(void) {\r
\r
  // To stack MSDF and SDF we need a non-pre-multiplied-alpha texture.\r
  vec4 texColor = texture2D(uSampler, vTextureCoord);\r
\r
  // MSDF\r
  float median = texColor.r + texColor.g + texColor.b -\r
                  min(texColor.r, min(texColor.g, texColor.b)) -\r
                  max(texColor.r, max(texColor.g, texColor.b));\r
  // SDF\r
  median = min(median, texColor.a);\r
\r
  float screenPxDistance = uFWidth * (median - 0.5);\r
  float alpha = clamp(screenPxDistance + 0.5, 0.0, 1.0);\r
  if (median < 0.01) {\r
    alpha = 0.0;\r
  } else if (median > 0.99) {\r
    alpha = 1.0;\r
  }\r
\r
  // Gamma correction for coverage-like alpha\r
  float luma = dot(uColor.rgb, vec3(0.299, 0.587, 0.114));\r
  float gamma = mix(1.0, 1.0 / 2.2, luma);\r
  float coverage = pow(uColor.a * alpha, gamma);  \r
\r
  // NPM Textures, NPM outputs\r
  gl_FragColor = vec4(uColor.rgb, coverage);\r
}\r
`,cJ=`// Mesh material default fragment\r
attribute vec2 aVertexPosition;\r
attribute vec2 aTextureCoord;\r
\r
uniform mat3 projectionMatrix;\r
uniform mat3 translationMatrix;\r
uniform mat3 uTextureMatrix;\r
\r
varying vec2 vTextureCoord;\r
\r
void main(void)\r
{\r
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\r
\r
    vTextureCoord = (uTextureMatrix * vec3(aTextureCoord, 1.0)).xy;\r
}\r
`;const uI=[],dI=[],hI=[],uJ=class gO extends Xn{constructor(e,n={}){super();const{align:r,tint:i,maxWidth:s,letterSpacing:o,fontName:a,fontSize:l}=Object.assign({},gO.styleDefaults,n);if(!Ea.available[a])throw new Error(`Missing BitmapFont "${a}"`);this._activePagesMeshData=[],this._textWidth=0,this._textHeight=0,this._align=r,this._tintColor=new pt(i),this._font=void 0,this._fontName=a,this._fontSize=l,this.text=e,this._maxWidth=s,this._maxLineHeight=0,this._letterSpacing=o,this._anchor=new Bo(()=>{this.dirty=!0},this,0,0),this._roundPixels=_e.ROUND_PIXELS,this.dirty=!0,this._resolution=_e.RESOLUTION,this._autoResolution=!0,this._textureCache={}}updateText(){var F;const e=Ea.available[this._fontName],n=this.fontSize,r=n/e.size,i=new Ke,s=[],o=[],a=[],l=this._text.replace(/(?:\r\n|\r)/g,`
`)||" ",c=mO(l),u=this._maxWidth*e.size/n,d=e.distanceFieldType==="none"?uI:dI;let h=null,f=0,p=0,m=0,v=-1,y=0,b=0,_=0,E=0;for(let N=0;N<c.length;N++){const R=c[N],H=qg(R);if(/(?:\s)/.test(R)&&(v=N,y=f,E++),R==="\r"||R===`
`){o.push(f),a.push(-1),p=Math.max(p,f),++m,++b,i.x=0,i.y+=e.lineHeight,h=null,E=0;continue}const W=e.chars[H];if(!W)continue;h&&W.kerning[h]&&(i.x+=W.kerning[h]);const q=hI.pop()||{texture:he.EMPTY,line:0,charCode:0,prevSpaces:0,position:new Ke};q.texture=W.texture,q.line=m,q.charCode=H,q.position.x=Math.round(i.x+W.xOffset+this._letterSpacing/2),q.position.y=Math.round(i.y+W.yOffset),q.prevSpaces=E,s.push(q),f=q.position.x+Math.max(W.xAdvance-W.xOffset,W.texture.orig.width),i.x+=W.xAdvance+this._letterSpacing,_=Math.max(_,W.yOffset+W.texture.height),h=H,v!==-1&&u>0&&i.x>u&&(++b,xd(s,1+v-b,1+N-v),N=v,v=-1,o.push(y),a.push(s.length>0?s[s.length-1].prevSpaces:0),p=Math.max(p,y),m++,i.x=0,i.y+=e.lineHeight,h=null,E=0)}const w=c[c.length-1];w!=="\r"&&w!==`
`&&(/(?:\s)/.test(w)&&(f=y),o.push(f),p=Math.max(p,f),a.push(-1));const x=[];for(let N=0;N<=m;N++){let R=0;this._align==="right"?R=p-o[N]:this._align==="center"?R=(p-o[N])/2:this._align==="justify"&&(R=a[N]<0?0:(p-o[N])/a[N]),x.push(R)}const T=s.length,C={},k=[],L=this._activePagesMeshData;d.push(...L);for(let N=0;N<T;N++){const R=s[N].texture,H=R.baseTexture.uid;if(!C[H]){let W=d.pop();if(!W){const Z=new Oq;let j,K;e.distanceFieldType==="none"?(j=new oI(he.EMPTY),K=Ne.NORMAL):(j=new oI(he.EMPTY,{program:no.from(cJ,lJ),uniforms:{uFWidth:0}}),K=Ne.NORMAL_NPM);const $=new sI(Z,j);$.blendMode=K,W={index:0,indexCount:0,vertexCount:0,uvsCount:0,total:0,mesh:$,vertices:null,uvs:null,indices:null}}W.index=0,W.indexCount=0,W.vertexCount=0,W.uvsCount=0,W.total=0;const{_textureCache:q}=this;q[H]=q[H]||new he(R.baseTexture),W.mesh.texture=q[H],W.mesh.tint=this._tintColor.value,k.push(W),C[H]=W}C[H].total++}for(let N=0;N<L.length;N++)k.includes(L[N])||this.removeChild(L[N].mesh);for(let N=0;N<k.length;N++)k[N].mesh.parent!==this&&this.addChild(k[N].mesh);this._activePagesMeshData=k;for(const N in C){const R=C[N],H=R.total;if(!(((F=R.indices)==null?void 0:F.length)>6*H)||R.vertices.length<sI.BATCHABLE_SIZE*2)R.vertices=new Float32Array(4*2*H),R.uvs=new Float32Array(4*2*H),R.indices=new Uint16Array(6*H);else{const W=R.total,q=R.vertices;for(let Z=W*4*2;Z<q.length;Z++)q[Z]=0}R.mesh.size=6*H}for(let N=0;N<T;N++){const R=s[N];let H=R.position.x+x[R.line]*(this._align==="justify"?R.prevSpaces:1);this._roundPixels&&(H=Math.round(H));const W=H*r,q=R.position.y*r,Z=R.texture,j=C[Z.baseTexture.uid],K=Z.frame,$=Z._uvs,B=j.index++;j.indices[B*6+0]=0+B*4,j.indices[B*6+1]=1+B*4,j.indices[B*6+2]=2+B*4,j.indices[B*6+3]=0+B*4,j.indices[B*6+4]=2+B*4,j.indices[B*6+5]=3+B*4,j.vertices[B*8+0]=W,j.vertices[B*8+1]=q,j.vertices[B*8+2]=W+K.width*r,j.vertices[B*8+3]=q,j.vertices[B*8+4]=W+K.width*r,j.vertices[B*8+5]=q+K.height*r,j.vertices[B*8+6]=W,j.vertices[B*8+7]=q+K.height*r,j.uvs[B*8+0]=$.x0,j.uvs[B*8+1]=$.y0,j.uvs[B*8+2]=$.x1,j.uvs[B*8+3]=$.y1,j.uvs[B*8+4]=$.x2,j.uvs[B*8+5]=$.y2,j.uvs[B*8+6]=$.x3,j.uvs[B*8+7]=$.y3}this._textWidth=p*r,this._textHeight=(i.y+e.lineHeight)*r;for(const N in C){const R=C[N];if(this.anchor.x!==0||this.anchor.y!==0){let Z=0;const j=this._textWidth*this.anchor.x,K=this._textHeight*this.anchor.y;for(let $=0;$<R.total;$++)R.vertices[Z++]-=j,R.vertices[Z++]-=K,R.vertices[Z++]-=j,R.vertices[Z++]-=K,R.vertices[Z++]-=j,R.vertices[Z++]-=K,R.vertices[Z++]-=j,R.vertices[Z++]-=K}this._maxLineHeight=_*r;const H=R.mesh.geometry.getBuffer("aVertexPosition"),W=R.mesh.geometry.getBuffer("aTextureCoord"),q=R.mesh.geometry.getIndex();H.data=R.vertices,W.data=R.uvs,q.data=R.indices,H.update(),W.update(),q.update()}for(let N=0;N<s.length;N++)hI.push(s[N]);this._font=e,this.dirty=!1}updateTransform(){this.validate(),this.containerUpdateTransform()}_render(e){this._autoResolution&&this._resolution!==e.resolution&&(this._resolution=e.resolution,this.dirty=!0);const{distanceFieldRange:n,distanceFieldType:r,size:i}=Ea.available[this._fontName];if(r!=="none"){const{a:s,b:o,c:a,d:l}=this.worldTransform,c=Math.sqrt(s*s+o*o),u=Math.sqrt(a*a+l*l),d=(Math.abs(c)+Math.abs(u))/2,h=this.fontSize/i,f=e._view.resolution;for(const p of this._activePagesMeshData)p.mesh.shader.uniforms.uFWidth=d*n*h*f}super._render(e)}getLocalBounds(){return this.validate(),super.getLocalBounds()}validate(){const e=Ea.available[this._fontName];if(!e)throw new Error(`Missing BitmapFont "${this._fontName}"`);this._font!==e&&(this.dirty=!0),this.dirty&&this.updateText()}get tint(){return this._tintColor.value}set tint(e){if(this.tint!==e){this._tintColor.setValue(e);for(let n=0;n<this._activePagesMeshData.length;n++)this._activePagesMeshData[n].mesh.tint=e}}get align(){return this._align}set align(e){this._align!==e&&(this._align=e,this.dirty=!0)}get fontName(){return this._fontName}set fontName(e){if(!Ea.available[e])throw new Error(`Missing BitmapFont "${e}"`);this._fontName!==e&&(this._fontName=e,this.dirty=!0)}get fontSize(){return this._fontSize??Ea.available[this._fontName].size}set fontSize(e){this._fontSize!==e&&(this._fontSize=e,this.dirty=!0)}get anchor(){return this._anchor}set anchor(e){typeof e=="number"?this._anchor.set(e):this._anchor.copyFrom(e)}get text(){return this._text}set text(e){e=String(e??""),this._text!==e&&(this._text=e,this.dirty=!0)}get maxWidth(){return this._maxWidth}set maxWidth(e){this._maxWidth!==e&&(this._maxWidth=e,this.dirty=!0)}get maxLineHeight(){return this.validate(),this._maxLineHeight}get textWidth(){return this.validate(),this._textWidth}get letterSpacing(){return this._letterSpacing}set letterSpacing(e){this._letterSpacing!==e&&(this._letterSpacing=e,this.dirty=!0)}get roundPixels(){return this._roundPixels}set roundPixels(e){e!==this._roundPixels&&(this._roundPixels=e,this.dirty=!0)}get textHeight(){return this.validate(),this._textHeight}get resolution(){return this._resolution}set resolution(e){this._autoResolution=!1,this._resolution!==e&&(this._resolution=e,this.dirty=!0)}destroy(e){const{_textureCache:n}=this,r=Ea.available[this._fontName].distanceFieldType==="none"?uI:dI;r.push(...this._activePagesMeshData);for(const i of this._activePagesMeshData)this.removeChild(i.mesh);this._activePagesMeshData=[],r.filter(i=>n[i.mesh.texture.baseTexture.uid]).forEach(i=>{i.mesh.texture=he.EMPTY});for(const i in n)n[i].destroy(),delete n[i];this._font=null,this._tintColor=null,this._textureCache=null,super.destroy(e)}};uJ.styleDefaults={align:"left",tint:16777215,maxWidth:0,letterSpacing:0};const dJ=[".xml",".fnt"],hJ={extension:{type:me.LoadParser,priority:Ss.Normal},name:"loadBitmapFont",test(t){return dJ.includes(Rn.extname(t).toLowerCase())},async testParse(t){return Kg.test(t)||dx.test(t)},async parse(t,e,n){const r=Kg.test(t)?Kg.parse(t):dx.parse(t),{src:i}=e,{page:s}=r,o=[];for(let c=0;c<s.length;++c){const u=s[c].file;let d=Rn.join(Rn.dirname(i),u);d=nx(d,i),o.push(d)}const a=await n.load(o),l=o.map(c=>a[c]);return Ea.install(r,l,!0)},async load(t,e){return(await _e.ADAPTER.fetch(t)).text()},unload(t){t.destroy()}};Ce.add(hJ);const hx=class Bu extends Ci{constructor(){super(...arguments),this._fonts=[],this._overrides=[],this._stylesheet="",this.fontsDirty=!1}static from(e){return new Bu(Object.keys(Bu.defaultOptions).reduce((n,r)=>({...n,[r]:e[r]}),{}))}cleanFonts(){this._fonts.length>0&&(this._fonts.forEach(e=>{URL.revokeObjectURL(e.src),e.refs--,e.refs===0&&(e.fontFace&&document.fonts.delete(e.fontFace),delete Bu.availableFonts[e.originalUrl])}),this.fontFamily="Arial",this._fonts.length=0,this.styleID++,this.fontsDirty=!0)}loadFont(e,n={}){const{availableFonts:r}=Bu;if(r[e]){const i=r[e];return this._fonts.push(i),i.refs++,this.styleID++,this.fontsDirty=!0,Promise.resolve()}return _e.ADAPTER.fetch(e).then(i=>i.blob()).then(async i=>new Promise((s,o)=>{const a=URL.createObjectURL(i),l=new FileReader;l.onload=()=>s([a,l.result]),l.onerror=o,l.readAsDataURL(i)})).then(async([i,s])=>{const o=Object.assign({family:Rn.basename(e,Rn.extname(e)),weight:"normal",style:"normal",display:"auto",src:i,dataSrc:s,refs:1,originalUrl:e,fontFace:null},n);r[e]=o,this._fonts.push(o),this.styleID++;const a=new FontFace(o.family,`url(${o.src})`,{weight:o.weight,style:o.style,display:o.display});o.fontFace=a,await a.load(),document.fonts.add(a),await document.fonts.ready,this.styleID++,this.fontsDirty=!0})}addOverride(...e){const n=e.filter(r=>!this._overrides.includes(r));n.length>0&&(this._overrides.push(...n),this.styleID++)}removeOverride(...e){const n=e.filter(r=>this._overrides.includes(r));n.length>0&&(this._overrides=this._overrides.filter(r=>!n.includes(r)),this.styleID++)}toCSS(e){return[`transform: scale(${e})`,"transform-origin: top left","display: inline-block",`color: ${this.normalizeColor(this.fill)}`,`font-size: ${this.fontSize}px`,`font-family: ${this.fontFamily}`,`font-weight: ${this.fontWeight}`,`font-style: ${this.fontStyle}`,`font-variant: ${this.fontVariant}`,`letter-spacing: ${this.letterSpacing}px`,`text-align: ${this.align}`,`padding: ${this.padding}px`,`white-space: ${this.whiteSpace}`,...this.lineHeight?[`line-height: ${this.lineHeight}px`]:[],...this.wordWrap?[`word-wrap: ${this.breakWords?"break-all":"break-word"}`,`max-width: ${this.wordWrapWidth}px`]:[],...this.strokeThickness?[`-webkit-text-stroke-width: ${this.strokeThickness}px`,`-webkit-text-stroke-color: ${this.normalizeColor(this.stroke)}`,`text-stroke-width: ${this.strokeThickness}px`,`text-stroke-color: ${this.normalizeColor(this.stroke)}`,"paint-order: stroke"]:[],...this.dropShadow?[this.dropShadowToCSS()]:[],...this._overrides].join(";")}toGlobalCSS(){return this._fonts.reduce((e,n)=>`${e}
            @font-face {
                font-family: "${n.family}";
                src: url('${n.dataSrc}');
                font-weight: ${n.weight};
                font-style: ${n.style};
                font-display: ${n.display};
            }`,this._stylesheet)}get stylesheet(){return this._stylesheet}set stylesheet(e){this._stylesheet!==e&&(this._stylesheet=e,this.styleID++)}normalizeColor(e){return Array.isArray(e)&&(e=aY(e)),typeof e=="number"?oY(e):e}dropShadowToCSS(){let e=this.normalizeColor(this.dropShadowColor);const n=this.dropShadowAlpha,r=Math.round(Math.cos(this.dropShadowAngle)*this.dropShadowDistance),i=Math.round(Math.sin(this.dropShadowAngle)*this.dropShadowDistance);e.startsWith("#")&&n<1&&(e+=(n*255|0).toString(16).padStart(2,"0"));const s=`${r}px ${i}px`;return this.dropShadowBlur>0?`text-shadow: ${s} ${this.dropShadowBlur}px ${e}`:`text-shadow: ${s} ${e}`}reset(){Object.assign(this,Bu.defaultOptions)}onBeforeDraw(){const{fontsDirty:e}=this;return this.fontsDirty=!1,this.isSafari&&this._fonts.length>0&&e?new Promise(n=>setTimeout(n,100)):Promise.resolve()}get isSafari(){const{userAgent:e}=_e.ADAPTER.getNavigator();return/^((?!chrome|android).)*safari/i.test(e)}set fillGradientStops(e){console.warn("[HTMLTextStyle] fillGradientStops is not supported by HTMLText")}get fillGradientStops(){return super.fillGradientStops}set fillGradientType(e){console.warn("[HTMLTextStyle] fillGradientType is not supported by HTMLText")}get fillGradientType(){return super.fillGradientType}set miterLimit(e){console.warn("[HTMLTextStyle] miterLimit is not supported by HTMLText")}get miterLimit(){return super.miterLimit}set trim(e){console.warn("[HTMLTextStyle] trim is not supported by HTMLText")}get trim(){return super.trim}set textBaseline(e){console.warn("[HTMLTextStyle] textBaseline is not supported by HTMLText")}get textBaseline(){return super.textBaseline}set leading(e){console.warn("[HTMLTextStyle] leading is not supported by HTMLText")}get leading(){return super.leading}set lineJoin(e){console.warn("[HTMLTextStyle] lineJoin is not supported by HTMLText")}get lineJoin(){return super.lineJoin}};hx.availableFonts={},hx.defaultOptions={align:"left",breakWords:!1,dropShadow:!1,dropShadowAlpha:1,dropShadowAngle:Math.PI/6,dropShadowBlur:0,dropShadowColor:"black",dropShadowDistance:5,fill:"black",fontFamily:"Arial",fontSize:26,fontStyle:"normal",fontVariant:"normal",fontWeight:"normal",letterSpacing:0,lineHeight:0,padding:0,stroke:"black",strokeThickness:0,whiteSpace:"normal",wordWrap:!1,wordWrapWidth:100};let t_=hx;const Z1=class Uu extends On{constructor(e="",n={}){super(he.EMPTY),this._text=null,this._style=null,this._autoResolution=!0,this.localStyleID=-1,this.dirty=!1,this._updateID=0,this.ownsStyle=!1;const r=new Image,i=he.from(r,{scaleMode:_e.SCALE_MODE,resourceOptions:{autoLoad:!1}});i.orig=new Me,i.trim=new Me,this.texture=i;const s="http://www.w3.org/2000/svg",o="http://www.w3.org/1999/xhtml",a=document.createElementNS(s,"svg"),l=document.createElementNS(s,"foreignObject"),c=document.createElementNS(o,"div"),u=document.createElementNS(o,"style");l.setAttribute("width","10000"),l.setAttribute("height","10000"),l.style.overflow="hidden",a.appendChild(l),this.maxWidth=Uu.defaultMaxWidth,this.maxHeight=Uu.defaultMaxHeight,this._domElement=c,this._styleElement=u,this._svgRoot=a,this._foreignObject=l,this._foreignObject.appendChild(u),this._foreignObject.appendChild(c),this._image=r,this._loadImage=new Image,this._autoResolution=Uu.defaultAutoResolution,this._resolution=Uu.defaultResolution??_e.RESOLUTION,this.text=e,this.style=n}measureText(e){var u,d;const{text:n,style:r,resolution:i}=Object.assign({text:this._text,style:this._style,resolution:this._resolution},e);Object.assign(this._domElement,{innerHTML:n,style:r.toCSS(i)}),this._styleElement.textContent=r.toGlobalCSS(),document.body.appendChild(this._svgRoot);const s=this._domElement.getBoundingClientRect();this._svgRoot.remove();const{width:o,height:a}=s;(o>this.maxWidth||a>this.maxHeight)&&console.warn("[HTMLText] Large expanse of text, increase HTMLText.maxWidth or HTMLText.maxHeight property.");const l=Math.min(this.maxWidth,Math.ceil(o)),c=Math.min(this.maxHeight,Math.ceil(a));return this._svgRoot.setAttribute("width",l.toString()),this._svgRoot.setAttribute("height",c.toString()),n!==this._text&&(this._domElement.innerHTML=this._text),r!==this._style&&(Object.assign(this._domElement,{style:(u=this._style)==null?void 0:u.toCSS(i)}),this._styleElement.textContent=(d=this._style)==null?void 0:d.toGlobalCSS()),{width:l+r.padding*2,height:c+r.padding*2}}async updateText(e=!0){const{style:n,_image:r,_loadImage:i}=this;if(this.localStyleID!==n.styleID&&(this.dirty=!0,this.localStyleID=n.styleID),!this.dirty&&e)return;const{width:s,height:o}=this.measureText();r.width=i.width=Math.ceil(Math.max(1,s)),r.height=i.height=Math.ceil(Math.max(1,o)),this._updateID++;const a=this._updateID;await new Promise(l=>{i.onload=async()=>{if(a<this._updateID){l();return}await n.onBeforeDraw(),r.src=i.src,i.onload=null,i.src="",this.updateTexture(),l()};const c=new XMLSerializer().serializeToString(this._svgRoot);i.src=`data:image/svg+xml;charset=utf8,${encodeURIComponent(c)}`})}get source(){return this._image}updateTexture(){const{style:e,texture:n,_image:r,resolution:i}=this,{padding:s}=e,{baseTexture:o}=n;n.trim.width=n._frame.width=r.width/i,n.trim.height=n._frame.height=r.height/i,n.trim.x=-s,n.trim.y=-s,n.orig.width=n._frame.width-s*2,n.orig.height=n._frame.height-s*2,this._onTextureUpdate(),o.setRealSize(r.width,r.height,i),this.dirty=!1}_render(e){this._autoResolution&&this._resolution!==e.resolution&&(this._resolution=e.resolution,this.dirty=!0),this.updateText(!0),super._render(e)}_renderCanvas(e){this._autoResolution&&this._resolution!==e.resolution&&(this._resolution=e.resolution,this.dirty=!0),this.updateText(!0),super._renderCanvas(e)}getLocalBounds(e){return this.updateText(!0),super.getLocalBounds(e)}_calculateBounds(){this.updateText(!0),this.calculateVertices(),this._bounds.addQuad(this.vertexData)}_onStyleChange(){this.dirty=!0}destroy(e){var r,i,s,o,a;typeof e=="boolean"&&(e={children:e}),e=Object.assign({},Uu.defaultDestroyOptions,e),super.destroy(e);const n=null;this.ownsStyle&&((r=this._style)==null||r.cleanFonts()),this._style=n,(i=this._svgRoot)==null||i.remove(),this._svgRoot=n,(s=this._domElement)==null||s.remove(),this._domElement=n,(o=this._foreignObject)==null||o.remove(),this._foreignObject=n,(a=this._styleElement)==null||a.remove(),this._styleElement=n,this._loadImage.src="",this._loadImage.onload=null,this._loadImage=n,this._image.src="",this._image=n}get width(){return this.updateText(!0),Math.abs(this.scale.x)*this._image.width/this.resolution}set width(e){this.updateText(!0);const n=za(this.scale.x)||1;this.scale.x=n*e/this._image.width/this.resolution,this._width=e}get height(){return this.updateText(!0),Math.abs(this.scale.y)*this._image.height/this.resolution}set height(e){this.updateText(!0);const n=za(this.scale.y)||1;this.scale.y=n*e/this._image.height/this.resolution,this._height=e}get style(){return this._style}set style(e){this._style!==e&&(e=e||{},e instanceof t_?(this.ownsStyle=!1,this._style=e):e instanceof Ci?(console.warn("[HTMLText] Cloning TextStyle, if this is not what you want, use HTMLTextStyle"),this.ownsStyle=!0,this._style=t_.from(e)):(this.ownsStyle=!0,this._style=new t_(e)),this.localStyleID=-1,this.dirty=!0)}get text(){return this._text}set text(e){e=String(e===""||e===null||e===void 0?" ":e),e=this.sanitiseText(e),this._text!==e&&(this._text=e,this.dirty=!0)}get resolution(){return this._resolution}set resolution(e){this._autoResolution=!1,this._resolution!==e&&(this._resolution=e,this.dirty=!0)}sanitiseText(e){return e.replace(/<br>/gi,"<br/>").replace(/<hr>/gi,"<hr/>").replace(/&nbsp;/gi,"&#160;")}};Z1.defaultDestroyOptions={texture:!0,children:!1,baseTexture:!0},Z1.defaultMaxWidth=2024,Z1.defaultMaxHeight=2024,Z1.defaultAutoResolution=!0;function fx(t,e,n){if(t&&t.length){const[r,i]=e,s=Math.PI/180*n,o=Math.cos(s),a=Math.sin(s);for(const l of t){const[c,u]=l;l[0]=(c-r)*o-(u-i)*a+r,l[1]=(c-r)*a+(u-i)*o+i}}}function fJ(t,e,n){const r=[];t.forEach(i=>r.push(...i)),fx(r,e,n)}function pJ(t,e){return t[0]===e[0]&&t[1]===e[1]}function mJ(t,e,n,r=1){const i=n,s=Math.max(e,.1),o=t[0]&&t[0][0]&&typeof t[0][0]=="number"?[t]:t,a=[0,0];if(i)for(const c of o)fx(c,a,i);const l=gJ(o,s,r);if(i){for(const c of o)fx(c,a,-i);fJ(l,a,-i)}return l}function gJ(t,e,n){const r=[];for(const c of t){const u=[...c];pJ(u[0],u[u.length-1])||u.push([u[0][0],u[0][1]]),u.length>2&&r.push(u)}const i=[];e=Math.max(e,.1);const s=[];for(const c of r)for(let u=0;u<c.length-1;u++){const d=c[u],h=c[u+1];if(d[1]!==h[1]){const f=Math.min(d[1],h[1]);s.push({ymin:f,ymax:Math.max(d[1],h[1]),x:f===d[1]?d[0]:h[0],islope:(h[0]-d[0])/(h[1]-d[1])})}}if(s.sort((c,u)=>c.ymin<u.ymin?-1:c.ymin>u.ymin?1:c.x<u.x?-1:c.x>u.x?1:c.ymax===u.ymax?0:(c.ymax-u.ymax)/Math.abs(c.ymax-u.ymax)),!s.length)return i;let o=[],a=s[0].ymin,l=0;for(;o.length||s.length;){if(s.length){let c=-1;for(let d=0;d<s.length&&!(s[d].ymin>a);d++)c=d;s.splice(0,c+1).forEach(d=>{o.push({s:a,edge:d})})}if(o=o.filter(c=>!(c.edge.ymax<=a)),o.sort((c,u)=>c.edge.x===u.edge.x?0:(c.edge.x-u.edge.x)/Math.abs(c.edge.x-u.edge.x)),(n!==1||l%e===0)&&o.length>1)for(let c=0;c<o.length;c=c+2){const u=c+1;if(u>=o.length)break;const d=o[c].edge,h=o[u].edge;i.push([[Math.round(d.x),a],[Math.round(h.x),a]])}a+=n,o.forEach(c=>{c.edge.x=c.edge.x+n*c.edge.islope}),l++}return i}function Um(t,e){var n;const r=e.hachureAngle+90;let i=e.hachureGap;i<0&&(i=e.strokeWidth*4),i=Math.max(i,.1);let s=1;return e.roughness>=1&&(((n=e.randomizer)===null||n===void 0?void 0:n.next())||Math.random())>.7&&(s=i),mJ(t,i,r,s||1)}class iS{constructor(e){this.helper=e}fillPolygons(e,n){return this._fillPolygons(e,n)}_fillPolygons(e,n){const r=Um(e,n);return{type:"fillSketch",ops:this.renderLines(r,n)}}renderLines(e,n){const r=[];for(const i of e)r.push(...this.helper.doubleLineOps(i[0][0],i[0][1],i[1][0],i[1][1],n));return r}}function Uv(t){const e=t[0],n=t[1];return Math.sqrt(Math.pow(e[0]-n[0],2)+Math.pow(e[1]-n[1],2))}class yJ extends iS{fillPolygons(e,n){let r=n.hachureGap;r<0&&(r=n.strokeWidth*4),r=Math.max(r,.1);const i=Object.assign({},n,{hachureGap:r}),s=Um(e,i),o=Math.PI/180*n.hachureAngle,a=[],l=r*.5*Math.cos(o),c=r*.5*Math.sin(o);for(const[d,h]of s)Uv([d,h])&&a.push([[d[0]-l,d[1]+c],[...h]],[[d[0]+l,d[1]-c],[...h]]);return{type:"fillSketch",ops:this.renderLines(a,n)}}}class vJ extends iS{fillPolygons(e,n){const r=this._fillPolygons(e,n),i=Object.assign({},n,{hachureAngle:n.hachureAngle+90}),s=this._fillPolygons(e,i);return r.ops=r.ops.concat(s.ops),r}}class bJ{constructor(e){this.helper=e}fillPolygons(e,n){n=Object.assign({},n,{hachureAngle:0});const r=Um(e,n);return this.dotsOnLines(r,n)}dotsOnLines(e,n){const r=[];let i=n.hachureGap;i<0&&(i=n.strokeWidth*4),i=Math.max(i,.1);let s=n.fillWeight;s<0&&(s=n.strokeWidth/2);const o=i/4;for(const a of e){const l=Uv(a),c=l/i,u=Math.ceil(c)-1,d=l-u*i,h=(a[0][0]+a[1][0])/2-i/4,f=Math.min(a[0][1],a[1][1]);for(let p=0;p<u;p++){const m=f+d+p*i,v=h-o+Math.random()*2*o,y=m-o+Math.random()*2*o,b=this.helper.ellipse(v,y,s,s,n);r.push(...b.ops)}}return{type:"fillSketch",ops:r}}}class _J{constructor(e){this.helper=e}fillPolygons(e,n){const r=Um(e,n);return{type:"fillSketch",ops:this.dashedLine(r,n)}}dashedLine(e,n){const r=n.dashOffset<0?n.hachureGap<0?n.strokeWidth*4:n.hachureGap:n.dashOffset,i=n.dashGap<0?n.hachureGap<0?n.strokeWidth*4:n.hachureGap:n.dashGap,s=[];return e.forEach(o=>{const a=Uv(o),l=Math.floor(a/(r+i)),c=(a+i-l*(r+i))/2;let u=o[0],d=o[1];u[0]>d[0]&&(u=o[1],d=o[0]);const h=Math.atan((d[1]-u[1])/(d[0]-u[0]));for(let f=0;f<l;f++){const p=f*(r+i),m=p+r,v=[u[0]+p*Math.cos(h)+c*Math.cos(h),u[1]+p*Math.sin(h)+c*Math.sin(h)],y=[u[0]+m*Math.cos(h)+c*Math.cos(h),u[1]+m*Math.sin(h)+c*Math.sin(h)];s.push(...this.helper.doubleLineOps(v[0],v[1],y[0],y[1],n))}}),s}}class EJ{constructor(e){this.helper=e}fillPolygons(e,n){const r=n.hachureGap<0?n.strokeWidth*4:n.hachureGap,i=n.zigzagOffset<0?r:n.zigzagOffset;n=Object.assign({},n,{hachureGap:r+i});const s=Um(e,n);return{type:"fillSketch",ops:this.zigzagLines(s,i,n)}}zigzagLines(e,n,r){const i=[];return e.forEach(s=>{const o=Uv(s),a=Math.round(o/(2*n));let l=s[0],c=s[1];l[0]>c[0]&&(l=s[1],c=s[0]);const u=Math.atan((c[1]-l[1])/(c[0]-l[0]));for(let d=0;d<a;d++){const h=d*2*n,f=(d+1)*2*n,p=Math.sqrt(2*Math.pow(n,2)),m=[l[0]+h*Math.cos(u),l[1]+h*Math.sin(u)],v=[l[0]+f*Math.cos(u),l[1]+f*Math.sin(u)],y=[m[0]+p*Math.cos(u+Math.PI/4),m[1]+p*Math.sin(u+Math.PI/4)];i.push(...this.helper.doubleLineOps(m[0],m[1],y[0],y[1],r),...this.helper.doubleLineOps(y[0],y[1],v[0],v[1],r))}}),i}}const Br={};function wJ(t,e){let n=t.fillStyle||"hachure";if(!Br[n])switch(n){case"zigzag":Br[n]||(Br[n]=new yJ(e));break;case"cross-hatch":Br[n]||(Br[n]=new vJ(e));break;case"dots":Br[n]||(Br[n]=new bJ(e));break;case"dashed":Br[n]||(Br[n]=new _J(e));break;case"zigzag-line":Br[n]||(Br[n]=new EJ(e));break;case"hachure":default:n="hachure",Br[n]||(Br[n]=new iS(e));break}return Br[n]}function xJ(){return Math.floor(Math.random()*2**31)}class yO{constructor(e){this.seed=e}next(){return this.seed?(2**31-1&(this.seed=Math.imul(48271,this.seed)))/2**31:Math.random()}}const TJ=0,px=1,vO=2,K1={A:7,a:7,C:6,c:6,H:1,h:1,L:2,l:2,M:2,m:2,Q:4,q:4,S:4,s:4,T:2,t:2,V:1,v:1,Z:0,z:0};function SJ(t){const e=new Array;for(;t!=="";)if(t.match(/^([ \t\r\n,]+)/))t=t.substr(RegExp.$1.length);else if(t.match(/^([aAcChHlLmMqQsStTvVzZ])/))e[e.length]={type:TJ,text:RegExp.$1},t=t.substr(RegExp.$1.length);else if(t.match(/^(([-+]?[0-9]+(\.[0-9]*)?|[-+]?\.[0-9]+)([eE][-+]?[0-9]+)?)/))e[e.length]={type:px,text:`${parseFloat(RegExp.$1)}`},t=t.substr(RegExp.$1.length);else return[];return e[e.length]={type:vO,text:""},e}function n_(t,e){return t.type===e}function sS(t){const e=[],n=SJ(t);let r="BOD",i=0,s=n[i];for(;!n_(s,vO);){let o=0;const a=[];if(r==="BOD")if(s.text==="M"||s.text==="m")i++,o=K1[s.text],r=s.text;else return sS("M0,0"+t);else n_(s,px)?o=K1[r]:(i++,o=K1[s.text],r=s.text);if(i+o<n.length){for(let l=i;l<i+o;l++){const c=n[l];if(n_(c,px))a[a.length]=+c.text;else throw new Error("Param not a number: "+r+","+c.text)}if(typeof K1[r]=="number"){const l={key:r,data:a};e.push(l),i+=o,s=n[i],r==="M"&&(r="L"),r==="m"&&(r="l")}else throw new Error("Bad segment: "+r)}else throw new Error("Path data ended short")}return e}function bO(t){let e=0,n=0,r=0,i=0;const s=[];for(const{key:o,data:a}of t)switch(o){case"M":s.push({key:"M",data:[...a]}),[e,n]=a,[r,i]=a;break;case"m":e+=a[0],n+=a[1],s.push({key:"M",data:[e,n]}),r=e,i=n;break;case"L":s.push({key:"L",data:[...a]}),[e,n]=a;break;case"l":e+=a[0],n+=a[1],s.push({key:"L",data:[e,n]});break;case"C":s.push({key:"C",data:[...a]}),e=a[4],n=a[5];break;case"c":{const l=a.map((c,u)=>u%2?c+n:c+e);s.push({key:"C",data:l}),e=l[4],n=l[5];break}case"Q":s.push({key:"Q",data:[...a]}),e=a[2],n=a[3];break;case"q":{const l=a.map((c,u)=>u%2?c+n:c+e);s.push({key:"Q",data:l}),e=l[2],n=l[3];break}case"A":s.push({key:"A",data:[...a]}),e=a[5],n=a[6];break;case"a":e+=a[5],n+=a[6],s.push({key:"A",data:[a[0],a[1],a[2],a[3],a[4],e,n]});break;case"H":s.push({key:"H",data:[...a]}),e=a[0];break;case"h":e+=a[0],s.push({key:"H",data:[e]});break;case"V":s.push({key:"V",data:[...a]}),n=a[0];break;case"v":n+=a[0],s.push({key:"V",data:[n]});break;case"S":s.push({key:"S",data:[...a]}),e=a[2],n=a[3];break;case"s":{const l=a.map((c,u)=>u%2?c+n:c+e);s.push({key:"S",data:l}),e=l[2],n=l[3];break}case"T":s.push({key:"T",data:[...a]}),e=a[0],n=a[1];break;case"t":e+=a[0],n+=a[1],s.push({key:"T",data:[e,n]});break;case"Z":case"z":s.push({key:"Z",data:[]}),e=r,n=i;break}return s}function _O(t){const e=[];let n="",r=0,i=0,s=0,o=0,a=0,l=0;for(const{key:c,data:u}of t){switch(c){case"M":e.push({key:"M",data:[...u]}),[r,i]=u,[s,o]=u;break;case"C":e.push({key:"C",data:[...u]}),r=u[4],i=u[5],a=u[2],l=u[3];break;case"L":e.push({key:"L",data:[...u]}),[r,i]=u;break;case"H":r=u[0],e.push({key:"L",data:[r,i]});break;case"V":i=u[0],e.push({key:"L",data:[r,i]});break;case"S":{let d=0,h=0;n==="C"||n==="S"?(d=r+(r-a),h=i+(i-l)):(d=r,h=i),e.push({key:"C",data:[d,h,...u]}),a=u[0],l=u[1],r=u[2],i=u[3];break}case"T":{const[d,h]=u;let f=0,p=0;n==="Q"||n==="T"?(f=r+(r-a),p=i+(i-l)):(f=r,p=i);const m=r+2*(f-r)/3,v=i+2*(p-i)/3,y=d+2*(f-d)/3,b=h+2*(p-h)/3;e.push({key:"C",data:[m,v,y,b,d,h]}),a=f,l=p,r=d,i=h;break}case"Q":{const[d,h,f,p]=u,m=r+2*(d-r)/3,v=i+2*(h-i)/3,y=f+2*(d-f)/3,b=p+2*(h-p)/3;e.push({key:"C",data:[m,v,y,b,f,p]}),a=d,l=h,r=f,i=p;break}case"A":{const d=Math.abs(u[0]),h=Math.abs(u[1]),f=u[2],p=u[3],m=u[4],v=u[5],y=u[6];d===0||h===0?(e.push({key:"C",data:[r,i,v,y,v,y]}),r=v,i=y):(r!==v||i!==y)&&(EO(r,i,v,y,d,h,f,p,m).forEach(function(_){e.push({key:"C",data:_})}),r=v,i=y);break}case"Z":e.push({key:"Z",data:[]}),r=s,i=o;break}n=c}return e}function CJ(t){return Math.PI*t/180}function Wh(t,e,n){const r=t*Math.cos(n)-e*Math.sin(n),i=t*Math.sin(n)+e*Math.cos(n);return[r,i]}function EO(t,e,n,r,i,s,o,a,l,c){const u=CJ(o);let d=[],h=0,f=0,p=0,m=0;if(c)[h,f,p,m]=c;else{[t,e]=Wh(t,e,-u),[n,r]=Wh(n,r,-u);const N=(t-n)/2,R=(e-r)/2;let H=N*N/(i*i)+R*R/(s*s);H>1&&(H=Math.sqrt(H),i=H*i,s=H*s);const W=a===l?-1:1,q=i*i,Z=s*s,j=q*Z-q*R*R-Z*N*N,K=q*R*R+Z*N*N,$=W*Math.sqrt(Math.abs(j/K));p=$*i*R/s+(t+n)/2,m=$*-s*N/i+(e+r)/2,h=Math.asin(parseFloat(((e-m)/s).toFixed(9))),f=Math.asin(parseFloat(((r-m)/s).toFixed(9))),t<p&&(h=Math.PI-h),n<p&&(f=Math.PI-f),h<0&&(h=Math.PI*2+h),f<0&&(f=Math.PI*2+f),l&&h>f&&(h=h-Math.PI*2),!l&&f>h&&(f=f-Math.PI*2)}let v=f-h;if(Math.abs(v)>Math.PI*120/180){const N=f,R=n,H=r;l&&f>h?f=h+Math.PI*120/180*1:f=h+Math.PI*120/180*-1,n=p+i*Math.cos(f),r=m+s*Math.sin(f),d=EO(n,r,R,H,i,s,o,0,l,[f,N,p,m])}v=f-h;const y=Math.cos(h),b=Math.sin(h),_=Math.cos(f),E=Math.sin(f),w=Math.tan(v/4),x=4/3*i*w,T=4/3*s*w,C=[t,e],k=[t+x*b,e-T*y],L=[n+x*E,r-T*_],F=[n,r];if(k[0]=2*C[0]-k[0],k[1]=2*C[1]-k[1],c)return[k,L,F].concat(d);{d=[k,L,F].concat(d);const N=[];for(let R=0;R<d.length;R+=3){const H=Wh(d[R][0],d[R][1],u),W=Wh(d[R+1][0],d[R+1][1],u),q=Wh(d[R+2][0],d[R+2][1],u);N.push([H[0],H[1],W[0],W[1],q[0],q[1]])}return N}}const IJ={randOffset:LJ,randOffsetWithRange:RJ,ellipse:MJ,doubleLineOps:OJ};function wO(t,e,n,r,i){return{type:"path",ops:na(t,e,n,r,i)}}function Jg(t,e,n){const r=(t||[]).length;if(r>2){const i=[];for(let s=0;s<r-1;s++)i.push(...na(t[s][0],t[s][1],t[s+1][0],t[s+1][1],n));return e&&i.push(...na(t[r-1][0],t[r-1][1],t[0][0],t[0][1],n)),{type:"path",ops:i}}else if(r===2)return wO(t[0][0],t[0][1],t[1][0],t[1][1],n);return{type:"path",ops:[]}}function AJ(t,e){return Jg(t,!0,e)}function kJ(t,e,n,r,i){const s=[[t,e],[t+n,e],[t+n,e+r],[t,e+r]];return AJ(s,i)}function fI(t,e){let n=yI(t,1*(1+e.roughness*.2),e);if(!e.disableMultiStroke){const r=yI(t,1.5*(1+e.roughness*.22),DJ(e));n=n.concat(r)}return{type:"path",ops:n}}function MJ(t,e,n,r,i){const s=xO(n,r,i);return mx(t,e,i,s).opset}function xO(t,e,n){const r=Math.sqrt(Math.PI*2*Math.sqrt((Math.pow(t/2,2)+Math.pow(e/2,2))/2)),i=Math.ceil(Math.max(n.curveStepCount,n.curveStepCount/Math.sqrt(200)*r)),s=Math.PI*2/i;let o=Math.abs(t/2),a=Math.abs(e/2);const l=1-n.curveFitting;return o+=Be(o*l,n),a+=Be(a*l,n),{increment:s,rx:o,ry:a}}function mx(t,e,n,r){const[i,s]=vI(r.increment,t,e,r.rx,r.ry,1,r.increment*fy(.1,fy(.4,1,n),n),n);let o=py(i,null,n);if(!n.disableMultiStroke&&n.roughness!==0){const[a]=vI(r.increment,t,e,r.rx,r.ry,1.5,0,n),l=py(a,null,n);o=o.concat(l)}return{estimatedPoints:s,opset:{type:"path",ops:o}}}function pI(t,e,n,r,i,s,o,a,l){const c=t,u=e;let d=Math.abs(n/2),h=Math.abs(r/2);d+=Be(d*.01,l),h+=Be(h*.01,l);let f=i,p=s;for(;f<0;)f+=Math.PI*2,p+=Math.PI*2;p-f>Math.PI*2&&(f=0,p=Math.PI*2);const m=Math.PI*2/l.curveStepCount,v=Math.min(m/2,(p-f)/2),y=bI(v,c,u,d,h,f,p,1,l);if(!l.disableMultiStroke){const b=bI(v,c,u,d,h,f,p,1.5,l);y.push(...b)}return o&&(a?y.push(...na(c,u,c+d*Math.cos(f),u+h*Math.sin(f),l),...na(c,u,c+d*Math.cos(p),u+h*Math.sin(p),l)):y.push({op:"lineTo",data:[c,u]},{op:"lineTo",data:[c+d*Math.cos(f),u+h*Math.sin(f)]})),{type:"path",ops:y}}function mI(t,e){const n=_O(bO(sS(t))),r=[];let i=[0,0],s=[0,0];for(const{key:o,data:a}of n)switch(o){case"M":{s=[a[0],a[1]],i=[a[0],a[1]];break}case"L":r.push(...na(s[0],s[1],a[0],a[1],e)),s=[a[0],a[1]];break;case"C":{const[l,c,u,d,h,f]=a;r.push(...NJ(l,c,u,d,h,f,s,e)),s=[h,f];break}case"Z":r.push(...na(s[0],s[1],i[0],i[1],e)),s=[i[0],i[1]];break}return{type:"path",ops:r}}function r_(t,e){const n=[];for(const r of t)if(r.length){const i=e.maxRandomnessOffset||0,s=r.length;if(s>2){n.push({op:"move",data:[r[0][0]+Be(i,e),r[0][1]+Be(i,e)]});for(let o=1;o<s;o++)n.push({op:"lineTo",data:[r[o][0]+Be(i,e),r[o][1]+Be(i,e)]})}}return{type:"fillPath",ops:n}}function $u(t,e){return wJ(e,IJ).fillPolygons(t,e)}function PJ(t,e,n,r,i,s,o){const a=t,l=e;let c=Math.abs(n/2),u=Math.abs(r/2);c+=Be(c*.01,o),u+=Be(u*.01,o);let d=i,h=s;for(;d<0;)d+=Math.PI*2,h+=Math.PI*2;h-d>Math.PI*2&&(d=0,h=Math.PI*2);const f=(h-d)/o.curveStepCount,p=[];for(let m=d;m<=h;m=m+f)p.push([a+c*Math.cos(m),l+u*Math.sin(m)]);return p.push([a+c*Math.cos(h),l+u*Math.sin(h)]),p.push([a,l]),$u([p],o)}function LJ(t,e){return Be(t,e)}function RJ(t,e,n){return fy(t,e,n)}function OJ(t,e,n,r,i){return na(t,e,n,r,i,!0)}function DJ(t){const e=Object.assign({},t);return e.randomizer=void 0,t.seed&&(e.seed=t.seed+1),e}function TO(t){return t.randomizer||(t.randomizer=new yO(t.seed||0)),t.randomizer.next()}function fy(t,e,n,r=1){return n.roughness*r*(TO(n)*(e-t)+t)}function Be(t,e,n=1){return fy(-t,t,e,n)}function na(t,e,n,r,i,s=!1){const o=s?i.disableMultiStrokeFill:i.disableMultiStroke,a=gI(t,e,n,r,i,!0,!1);if(o)return a;const l=gI(t,e,n,r,i,!0,!0);return a.concat(l)}function gI(t,e,n,r,i,s,o){const a=Math.pow(t-n,2)+Math.pow(e-r,2),l=Math.sqrt(a);let c=1;l<200?c=1:l>500?c=.4:c=-.0016668*l+1.233334;let u=i.maxRandomnessOffset||0;u*u*100>a&&(u=l/10);const d=u/2,h=.2+TO(i)*.2;let f=i.bowing*i.maxRandomnessOffset*(r-e)/200,p=i.bowing*i.maxRandomnessOffset*(t-n)/200;f=Be(f,i,c),p=Be(p,i,c);const m=[],v=()=>Be(d,i,c),y=()=>Be(u,i,c),b=i.preserveVertices;return s&&(o?m.push({op:"move",data:[t+(b?0:v()),e+(b?0:v())]}):m.push({op:"move",data:[t+(b?0:Be(u,i,c)),e+(b?0:Be(u,i,c))]})),o?m.push({op:"bcurveTo",data:[f+t+(n-t)*h+v(),p+e+(r-e)*h+v(),f+t+2*(n-t)*h+v(),p+e+2*(r-e)*h+v(),n+(b?0:v()),r+(b?0:v())]}):m.push({op:"bcurveTo",data:[f+t+(n-t)*h+y(),p+e+(r-e)*h+y(),f+t+2*(n-t)*h+y(),p+e+2*(r-e)*h+y(),n+(b?0:y()),r+(b?0:y())]}),m}function yI(t,e,n){const r=[];r.push([t[0][0]+Be(e,n),t[0][1]+Be(e,n)]),r.push([t[0][0]+Be(e,n),t[0][1]+Be(e,n)]);for(let i=1;i<t.length;i++)r.push([t[i][0]+Be(e,n),t[i][1]+Be(e,n)]),i===t.length-1&&r.push([t[i][0]+Be(e,n),t[i][1]+Be(e,n)]);return py(r,null,n)}function py(t,e,n){const r=t.length,i=[];if(r>3){const s=[],o=1-n.curveTightness;i.push({op:"move",data:[t[1][0],t[1][1]]});for(let a=1;a+2<r;a++){const l=t[a];s[0]=[l[0],l[1]],s[1]=[l[0]+(o*t[a+1][0]-o*t[a-1][0])/6,l[1]+(o*t[a+1][1]-o*t[a-1][1])/6],s[2]=[t[a+1][0]+(o*t[a][0]-o*t[a+2][0])/6,t[a+1][1]+(o*t[a][1]-o*t[a+2][1])/6],s[3]=[t[a+1][0],t[a+1][1]],i.push({op:"bcurveTo",data:[s[1][0],s[1][1],s[2][0],s[2][1],s[3][0],s[3][1]]})}if(e&&e.length===2){const a=n.maxRandomnessOffset;i.push({op:"lineTo",data:[e[0]+Be(a,n),e[1]+Be(a,n)]})}}else r===3?(i.push({op:"move",data:[t[1][0],t[1][1]]}),i.push({op:"bcurveTo",data:[t[1][0],t[1][1],t[2][0],t[2][1],t[2][0],t[2][1]]})):r===2&&i.push(...na(t[0][0],t[0][1],t[1][0],t[1][1],n));return i}function vI(t,e,n,r,i,s,o,a){const l=a.roughness===0,c=[],u=[];if(l){t=t/4,u.push([e+r*Math.cos(-t),n+i*Math.sin(-t)]);for(let d=0;d<=Math.PI*2;d=d+t){const h=[e+r*Math.cos(d),n+i*Math.sin(d)];c.push(h),u.push(h)}u.push([e+r*Math.cos(0),n+i*Math.sin(0)]),u.push([e+r*Math.cos(t),n+i*Math.sin(t)])}else{const d=Be(.5,a)-Math.PI/2;u.push([Be(s,a)+e+.9*r*Math.cos(d-t),Be(s,a)+n+.9*i*Math.sin(d-t)]);const h=Math.PI*2+d-.01;for(let f=d;f<h;f=f+t){const p=[Be(s,a)+e+r*Math.cos(f),Be(s,a)+n+i*Math.sin(f)];c.push(p),u.push(p)}u.push([Be(s,a)+e+r*Math.cos(d+Math.PI*2+o*.5),Be(s,a)+n+i*Math.sin(d+Math.PI*2+o*.5)]),u.push([Be(s,a)+e+.98*r*Math.cos(d+o),Be(s,a)+n+.98*i*Math.sin(d+o)]),u.push([Be(s,a)+e+.9*r*Math.cos(d+o*.5),Be(s,a)+n+.9*i*Math.sin(d+o*.5)])}return[u,c]}function bI(t,e,n,r,i,s,o,a,l){const c=s+Be(.1,l),u=[];u.push([Be(a,l)+e+.9*r*Math.cos(c-t),Be(a,l)+n+.9*i*Math.sin(c-t)]);for(let d=c;d<=o;d=d+t)u.push([Be(a,l)+e+r*Math.cos(d),Be(a,l)+n+i*Math.sin(d)]);return u.push([e+r*Math.cos(o),n+i*Math.sin(o)]),u.push([e+r*Math.cos(o),n+i*Math.sin(o)]),py(u,null,l)}function NJ(t,e,n,r,i,s,o,a){const l=[],c=[a.maxRandomnessOffset||1,(a.maxRandomnessOffset||1)+.3];let u=[0,0];const d=a.disableMultiStroke?1:2,h=a.preserveVertices;for(let f=0;f<d;f++)f===0?l.push({op:"move",data:[o[0],o[1]]}):l.push({op:"move",data:[o[0]+(h?0:Be(c[0],a)),o[1]+(h?0:Be(c[0],a))]}),u=h?[i,s]:[i+Be(c[f],a),s+Be(c[f],a)],l.push({op:"bcurveTo",data:[t+Be(c[f],a),e+Be(c[f],a),n+Be(c[f],a),r+Be(c[f],a),u[0],u[1]]});return l}function jh(t){return[...t]}function FJ(t,e=0){const n=t.length;if(n<3)throw new Error("A curve must have at least three points.");const r=[];if(n===3)r.push(jh(t[0]),jh(t[1]),jh(t[2]),jh(t[2]));else{const i=[];i.push(t[0],t[0]);for(let a=1;a<t.length;a++)i.push(t[a]),a===t.length-1&&i.push(t[a]);const s=[],o=1-e;r.push(jh(i[0]));for(let a=1;a+2<i.length;a++){const l=i[a];s[0]=[l[0],l[1]],s[1]=[l[0]+(o*i[a+1][0]-o*i[a-1][0])/6,l[1]+(o*i[a+1][1]-o*i[a-1][1])/6],s[2]=[i[a+1][0]+(o*i[a][0]-o*i[a+2][0])/6,i[a+1][1]+(o*i[a][1]-o*i[a+2][1])/6],s[3]=[i[a+1][0],i[a+1][1]],r.push(s[1],s[2],s[3])}}return r}function BJ(t,e){return Math.sqrt(Qg(t,e))}function Qg(t,e){return Math.pow(t[0]-e[0],2)+Math.pow(t[1]-e[1],2)}function UJ(t,e,n){const r=Qg(e,n);if(r===0)return Qg(t,e);let i=((t[0]-e[0])*(n[0]-e[0])+(t[1]-e[1])*(n[1]-e[1]))/r;return i=Math.max(0,Math.min(1,i)),Qg(t,ql(e,n,i))}function ql(t,e,n){return[t[0]+(e[0]-t[0])*n,t[1]+(e[1]-t[1])*n]}function $J(t,e){const n=t[e+0],r=t[e+1],i=t[e+2],s=t[e+3];let o=3*r[0]-2*n[0]-s[0];o*=o;let a=3*r[1]-2*n[1]-s[1];a*=a;let l=3*i[0]-2*s[0]-n[0];l*=l;let c=3*i[1]-2*s[1]-n[1];return c*=c,o<l&&(o=l),a<c&&(a=c),o+a}function gx(t,e,n,r){const i=r||[];if($J(t,e)<n){const s=t[e+0];i.length?BJ(i[i.length-1],s)>1&&i.push(s):i.push(s),i.push(t[e+3])}else{const o=t[e+0],a=t[e+1],l=t[e+2],c=t[e+3],u=ql(o,a,.5),d=ql(a,l,.5),h=ql(l,c,.5),f=ql(u,d,.5),p=ql(d,h,.5),m=ql(f,p,.5);gx([o,u,f,m],0,n,i),gx([m,p,h,c],0,n,i)}return i}function HJ(t,e){return my(t,0,t.length,e)}function my(t,e,n,r,i){const s=i||[],o=t[e],a=t[n-1];let l=0,c=1;for(let u=e+1;u<n-1;++u){const d=UJ(t[u],o,a);d>l&&(l=d,c=u)}return Math.sqrt(l)>r?(my(t,e,c+1,r,s),my(t,c,n,r,s)):(s.length||s.push(o),s.push(a)),s}function SO(t,e=.15,n){const r=[],i=(t.length-1)/3;for(let s=0;s<i;s++){const o=s*3;gx(t,o,e,r)}return n&&n>0?my(r,0,r.length,n):r}function zJ(t,e,n){const r=sS(t),i=_O(bO(r)),s=[];let o=[],a=[0,0],l=[];const c=()=>{l.length>=4&&o.push(...SO(l,e)),l=[]},u=()=>{c(),o.length&&(s.push(o),o=[])};for(const{key:h,data:f}of i)switch(h){case"M":u(),a=[f[0],f[1]],o.push(a);break;case"L":c(),o.push([f[0],f[1]]);break;case"C":if(!l.length){const p=o.length?o[o.length-1]:a;l.push([p[0],p[1]])}l.push([f[0],f[1]]),l.push([f[2],f[3]]),l.push([f[4],f[5]]);break;case"Z":c(),o.push([a[0],a[1]]);break}if(u(),!n)return s;const d=[];for(const h of s){const f=HJ(h,n);f.length&&d.push(f)}return d}const Jr="none";class Vp{constructor(e){this.defaultOptions={maxRandomnessOffset:2,roughness:1,bowing:1,stroke:"#000",strokeWidth:1,curveTightness:0,curveFitting:.95,curveStepCount:9,fillStyle:"hachure",fillWeight:-1,hachureAngle:-41,hachureGap:-1,dashOffset:-1,dashGap:-1,zigzagOffset:-1,seed:0,disableMultiStroke:!1,disableMultiStrokeFill:!1,preserveVertices:!1,fillShapeRoughnessGain:.8},this.config=e||{},this.config.options&&(this.defaultOptions=this._o(this.config.options))}static newSeed(){return xJ()}_o(e){return e?Object.assign({},this.defaultOptions,e):this.defaultOptions}_d(e,n,r){return{shape:e,sets:n||[],options:r||this.defaultOptions}}line(e,n,r,i,s){const o=this._o(s);return this._d("line",[wO(e,n,r,i,o)],o)}rectangle(e,n,r,i,s){const o=this._o(s),a=[],l=kJ(e,n,r,i,o);if(o.fill){const c=[[e,n],[e+r,n],[e+r,n+i],[e,n+i]];o.fillStyle==="solid"?a.push(r_([c],o)):a.push($u([c],o))}return o.stroke!==Jr&&a.push(l),this._d("rectangle",a,o)}ellipse(e,n,r,i,s){const o=this._o(s),a=[],l=xO(r,i,o),c=mx(e,n,o,l);if(o.fill)if(o.fillStyle==="solid"){const u=mx(e,n,o,l).opset;u.type="fillPath",a.push(u)}else a.push($u([c.estimatedPoints],o));return o.stroke!==Jr&&a.push(c.opset),this._d("ellipse",a,o)}circle(e,n,r,i){const s=this.ellipse(e,n,r,r,i);return s.shape="circle",s}linearPath(e,n){const r=this._o(n);return this._d("linearPath",[Jg(e,!1,r)],r)}arc(e,n,r,i,s,o,a=!1,l){const c=this._o(l),u=[],d=pI(e,n,r,i,s,o,a,!0,c);if(a&&c.fill)if(c.fillStyle==="solid"){const h=Object.assign({},c);h.disableMultiStroke=!0;const f=pI(e,n,r,i,s,o,!0,!1,h);f.type="fillPath",u.push(f)}else u.push(PJ(e,n,r,i,s,o,c));return c.stroke!==Jr&&u.push(d),this._d("arc",u,c)}curve(e,n){const r=this._o(n),i=[],s=fI(e,r);if(r.fill&&r.fill!==Jr&&e.length>=3)if(r.fillStyle==="solid"){const o=fI(e,Object.assign(Object.assign({},r),{disableMultiStroke:!0,roughness:r.roughness?r.roughness+r.fillShapeRoughnessGain:0}));i.push({type:"fillPath",ops:this._mergedShape(o.ops)})}else{const o=FJ(e),a=SO(o,10,(1+r.roughness)/2);i.push($u([a],r))}return r.stroke!==Jr&&i.push(s),this._d("curve",i,r)}polygon(e,n){const r=this._o(n),i=[],s=Jg(e,!0,r);return r.fill&&(r.fillStyle==="solid"?i.push(r_([e],r)):i.push($u([e],r))),r.stroke!==Jr&&i.push(s),this._d("polygon",i,r)}path(e,n){const r=this._o(n),i=[];if(!e)return this._d("path",i,r);e=(e||"").replace(/\n/g," ").replace(/(-\s)/g,"-").replace("/(ss)/g"," ");const s=r.fill&&r.fill!=="transparent"&&r.fill!==Jr,o=r.stroke!==Jr,a=!!(r.simplification&&r.simplification<1),l=a?4-4*(r.simplification||1):(1+r.roughness)/2,c=zJ(e,1,l),u=mI(e,r);if(s)if(r.fillStyle==="solid")if(c.length===1){const d=mI(e,Object.assign(Object.assign({},r),{disableMultiStroke:!0,roughness:r.roughness?r.roughness+r.fillShapeRoughnessGain:0}));i.push({type:"fillPath",ops:this._mergedShape(d.ops)})}else i.push(r_(c,r));else i.push($u(c,r));return o&&(a?c.forEach(d=>{i.push(Jg(d,!1,r))}):i.push(u)),this._d("path",i,r)}opsToPath(e,n){let r="";for(const i of e.ops){const s=typeof n=="number"&&n>=0?i.data.map(o=>+o.toFixed(n)):i.data;switch(i.op){case"move":r+=`M${s[0]} ${s[1]} `;break;case"bcurveTo":r+=`C${s[0]} ${s[1]}, ${s[2]} ${s[3]}, ${s[4]} ${s[5]} `;break;case"lineTo":r+=`L${s[0]} ${s[1]} `;break}}return r.trim()}toPaths(e){const n=e.sets||[],r=e.options||this.defaultOptions,i=[];for(const s of n){let o=null;switch(s.type){case"path":o={d:this.opsToPath(s),stroke:r.stroke,strokeWidth:r.strokeWidth,fill:Jr};break;case"fillPath":o={d:this.opsToPath(s),stroke:Jr,strokeWidth:0,fill:r.fill||Jr};break;case"fillSketch":o=this.fillSketch(s,r);break}o&&i.push(o)}return i}fillSketch(e,n){let r=n.fillWeight;return r<0&&(r=n.strokeWidth/2),{d:this.opsToPath(e),stroke:n.fill||Jr,strokeWidth:r,fill:Jr}}_mergedShape(e){return e.filter((n,r)=>r===0?!0:n.op!=="move")}}class GJ{constructor(e,n){this.canvas=e,this.ctx=this.canvas.getContext("2d"),this.gen=new Vp(n)}draw(e){const n=e.sets||[],r=e.options||this.getDefaultOptions(),i=this.ctx,s=e.options.fixedDecimalPlaceDigits;for(const o of n)switch(o.type){case"path":i.save(),i.strokeStyle=r.stroke==="none"?"transparent":r.stroke,i.lineWidth=r.strokeWidth,r.strokeLineDash&&i.setLineDash(r.strokeLineDash),r.strokeLineDashOffset&&(i.lineDashOffset=r.strokeLineDashOffset),this._drawToContext(i,o,s),i.restore();break;case"fillPath":{i.save(),i.fillStyle=r.fill||"";const a=e.shape==="curve"||e.shape==="polygon"||e.shape==="path"?"evenodd":"nonzero";this._drawToContext(i,o,s,a),i.restore();break}case"fillSketch":this.fillSketch(i,o,r);break}}fillSketch(e,n,r){let i=r.fillWeight;i<0&&(i=r.strokeWidth/2),e.save(),r.fillLineDash&&e.setLineDash(r.fillLineDash),r.fillLineDashOffset&&(e.lineDashOffset=r.fillLineDashOffset),e.strokeStyle=r.fill||"",e.lineWidth=i,this._drawToContext(e,n,r.fixedDecimalPlaceDigits),e.restore()}_drawToContext(e,n,r,i="nonzero"){e.beginPath();for(const s of n.ops){const o=typeof r=="number"&&r>=0?s.data.map(a=>+a.toFixed(r)):s.data;switch(s.op){case"move":e.moveTo(o[0],o[1]);break;case"bcurveTo":e.bezierCurveTo(o[0],o[1],o[2],o[3],o[4],o[5]);break;case"lineTo":e.lineTo(o[0],o[1]);break}}n.type==="fillPath"?e.fill(i):e.stroke()}get generator(){return this.gen}getDefaultOptions(){return this.gen.defaultOptions}line(e,n,r,i,s){const o=this.gen.line(e,n,r,i,s);return this.draw(o),o}rectangle(e,n,r,i,s){const o=this.gen.rectangle(e,n,r,i,s);return this.draw(o),o}ellipse(e,n,r,i,s){const o=this.gen.ellipse(e,n,r,i,s);return this.draw(o),o}circle(e,n,r,i){const s=this.gen.circle(e,n,r,i);return this.draw(s),s}linearPath(e,n){const r=this.gen.linearPath(e,n);return this.draw(r),r}polygon(e,n){const r=this.gen.polygon(e,n);return this.draw(r),r}arc(e,n,r,i,s,o,a=!1,l){const c=this.gen.arc(e,n,r,i,s,o,a,l);return this.draw(c),c}curve(e,n){const r=this.gen.curve(e,n);return this.draw(r),r}path(e,n){const r=this.gen.path(e,n);return this.draw(r),r}}const q1="http://www.w3.org/2000/svg";class VJ{constructor(e,n){this.svg=e,this.gen=new Vp(n)}draw(e){const n=e.sets||[],r=e.options||this.getDefaultOptions(),i=this.svg.ownerDocument||window.document,s=i.createElementNS(q1,"g"),o=e.options.fixedDecimalPlaceDigits;for(const a of n){let l=null;switch(a.type){case"path":{l=i.createElementNS(q1,"path"),l.setAttribute("d",this.opsToPath(a,o)),l.setAttribute("stroke",r.stroke),l.setAttribute("stroke-width",r.strokeWidth+""),l.setAttribute("fill","none"),r.strokeLineDash&&l.setAttribute("stroke-dasharray",r.strokeLineDash.join(" ").trim()),r.strokeLineDashOffset&&l.setAttribute("stroke-dashoffset",`${r.strokeLineDashOffset}`);break}case"fillPath":{l=i.createElementNS(q1,"path"),l.setAttribute("d",this.opsToPath(a,o)),l.setAttribute("stroke","none"),l.setAttribute("stroke-width","0"),l.setAttribute("fill",r.fill||""),(e.shape==="curve"||e.shape==="polygon")&&l.setAttribute("fill-rule","evenodd");break}case"fillSketch":{l=this.fillSketch(i,a,r);break}}l&&s.appendChild(l)}return s}fillSketch(e,n,r){let i=r.fillWeight;i<0&&(i=r.strokeWidth/2);const s=e.createElementNS(q1,"path");return s.setAttribute("d",this.opsToPath(n,r.fixedDecimalPlaceDigits)),s.setAttribute("stroke",r.fill||""),s.setAttribute("stroke-width",i+""),s.setAttribute("fill","none"),r.fillLineDash&&s.setAttribute("stroke-dasharray",r.fillLineDash.join(" ").trim()),r.fillLineDashOffset&&s.setAttribute("stroke-dashoffset",`${r.fillLineDashOffset}`),s}get generator(){return this.gen}getDefaultOptions(){return this.gen.defaultOptions}opsToPath(e,n){return this.gen.opsToPath(e,n)}line(e,n,r,i,s){const o=this.gen.line(e,n,r,i,s);return this.draw(o)}rectangle(e,n,r,i,s){const o=this.gen.rectangle(e,n,r,i,s);return this.draw(o)}ellipse(e,n,r,i,s){const o=this.gen.ellipse(e,n,r,i,s);return this.draw(o)}circle(e,n,r,i){const s=this.gen.circle(e,n,r,i);return this.draw(s)}linearPath(e,n){const r=this.gen.linearPath(e,n);return this.draw(r)}polygon(e,n){const r=this.gen.polygon(e,n);return this.draw(r)}arc(e,n,r,i,s,o,a=!1,l){const c=this.gen.arc(e,n,r,i,s,o,a,l);return this.draw(c)}curve(e,n){const r=this.gen.curve(e,n);return this.draw(r)}path(e,n){const r=this.gen.path(e,n);return this.draw(r)}}const Ll={canvas(t,e){return new GJ(t,e)},svg(t,e){return new VJ(t,e)},generator(t){return new Vp(t)},newSeed(){return Vp.newSeed()}};let oS=(t=21)=>crypto.getRandomValues(new Uint8Array(t)).reduce((e,n)=>(n&=63,n<36?e+=n.toString(36):n<62?e+=(n-26).toString(36).toUpperCase():n>62?e+="-":e+="_",e),"");const En=t=>!!t&&t.type==="image"&&!!t.fileId,Wo=t=>!!t&&t.type==="image",ur=t=>!!t&&t.type==="embeddable",Pa=t=>!!t&&t.type==="iframe",os=t=>!!t&&(t.type==="iframe"||t.type==="embeddable"),Se=t=>t!=null&&t.type==="text",Wp=t=>t!=null&&t.type==="frame",sd=t=>t!=null&&t.type==="magicframe",qe=t=>t!=null&&(t.type==="frame"||t.type==="magicframe"),Zr=t=>t!=null&&WJ(t.type),WJ=t=>t==="freedraw",Je=t=>t!=null&&aS(t.type),Ct=t=>t!=null&&t.type==="arrow",aS=t=>t==="arrow"||t==="line",pr=(t,e=!0)=>t!=null&&(!t.locked||e===!0)&&CO(t.type),CO=t=>t==="arrow",jp=(t,e=!0)=>t!=null&&(!t.locked||e===!0)&&(t.type==="rectangle"||t.type==="diamond"||t.type==="ellipse"||t.type==="image"||t.type==="iframe"||t.type==="embeddable"||t.type==="frame"||t.type==="magicframe"||t.type==="text"&&!t.containerId),Lc=(t,e=!0)=>t!=null&&(!t.locked||e===!0)&&(t.type==="rectangle"||t.type==="diamond"||t.type==="ellipse"||Ct(t)),IO=t=>{const e=t==null?void 0:t.type;if(!e)return!1;switch(e){case"text":case"diamond":case"rectangle":case"iframe":case"embeddable":case"ellipse":case"arrow":case"freedraw":case"line":case"frame":case"magicframe":case"image":case"selection":return!0;default:return zd(e,null),!1}},vl=t=>{var e;return Lc(t)&&!!((e=t.boundElements)!=null&&e.some(({type:n})=>n==="text"))},nn=t=>t!==null&&"containerId"in t&&t.containerId!==null&&Se(t),dh=t=>t==="rectangle"||t==="embeddable"||t==="iframe",AO=t=>t==="line"||t==="arrow"||t==="diamond",jJ=(t,e)=>!!((t===jn.ADAPTIVE_RADIUS||t===jn.LEGACY)&&dh(e.type)||t===jn.PROPORTIONAL_RADIUS&&AO(e.type)),XJ=t=>AO(t.type)?{type:jn.PROPORTIONAL_RADIUS}:dh(t.type)?{type:jn.ADAPTIVE_RADIUS}:null;function _I(t,e,n,r=i=>i){return t*r(.5-e*(.5-n))}function YJ(t){return[-t[0],-t[1]]}function Qi(t,e){return[t[0]+e[0],t[1]+e[1]]}function bi(t,e){return[t[0]-e[0],t[1]-e[1]]}function Ki(t,e){return[t[0]*e,t[1]*e]}function ZJ(t,e){return[t[0]/e,t[1]/e]}function Xh(t){return[t[1],-t[0]]}function EI(t,e){return t[0]*e[0]+t[1]*e[1]}function KJ(t,e){return t[0]===e[0]&&t[1]===e[1]}function qJ(t){return Math.hypot(t[0],t[1])}function JJ(t){return t[0]*t[0]+t[1]*t[1]}function wI(t,e){return JJ(bi(t,e))}function kO(t){return ZJ(t,qJ(t))}function QJ(t,e){return Math.hypot(t[1]-e[1],t[0]-e[0])}function Yh(t,e,n){let r=Math.sin(n),i=Math.cos(n),s=t[0]-e[0],o=t[1]-e[1],a=s*i-o*r,l=s*r+o*i;return[a+e[0],l+e[1]]}function yx(t,e,n){return Qi(t,Ki(bi(e,t),n))}function xI(t,e,n){return Qi(t,Ki(e,n))}var{min:wu,PI:eQ}=Math,TI=.275,Zh=eQ+1e-4;function tQ(t,e={}){let{size:n=16,smoothing:r=.5,thinning:i=.5,simulatePressure:s=!0,easing:o=Z=>Z,start:a={},end:l={},last:c=!1}=e,{cap:u=!0,easing:d=Z=>Z*(2-Z)}=a,{cap:h=!0,easing:f=Z=>--Z*Z*Z+1}=l;if(t.length===0||n<=0)return[];let p=t[t.length-1].runningLength,m=a.taper===!1?0:a.taper===!0?Math.max(n,p):a.taper,v=l.taper===!1?0:l.taper===!0?Math.max(n,p):l.taper,y=Math.pow(n*r,2),b=[],_=[],E=t.slice(0,10).reduce((Z,j)=>{let K=j.pressure;if(s){let $=wu(1,j.distance/n),B=wu(1,1-$);K=wu(1,Z+(B-Z)*($*TI))}return(Z+K)/2},t[0].pressure),w=_I(n,i,t[t.length-1].pressure,o),x,T=t[0].vector,C=t[0].point,k=C,L=C,F=k,N=!1;for(let Z=0;Z<t.length;Z++){let{pressure:j}=t[Z],{point:K,vector:$,distance:B,runningLength:G}=t[Z];if(Z<t.length-1&&p-G<3)continue;if(i){if(s){let Le=wu(1,B/n),fe=wu(1,1-Le);j=wu(1,E+(fe-E)*(Le*TI))}w=_I(n,i,j,o)}else w=n/2;x===void 0&&(x=w);let Y=G<m?d(G/m):1,X=p-G<v?f((p-G)/v):1;w=Math.max(.01,w*Math.min(Y,X));let J=(Z<t.length-1?t[Z+1]:t[Z]).vector,ne=Z<t.length-1?EI($,J):1,se=EI($,T)<0&&!N,Ue=ne!==null&&ne<0;if(se||Ue){let Le=Ki(Xh(T),w);for(let fe=1/13,ke=0;ke<=1;ke+=fe)L=Yh(bi(K,Le),K,Zh*ke),b.push(L),F=Yh(Qi(K,Le),K,Zh*-ke),_.push(F);C=L,k=F,Ue&&(N=!0);continue}if(N=!1,Z===t.length-1){let Le=Ki(Xh($),w);b.push(bi(K,Le)),_.push(Qi(K,Le));continue}let De=Ki(Xh(yx(J,$,ne)),w);L=bi(K,De),(Z<=1||wI(C,L)>y)&&(b.push(L),C=L),F=Qi(K,De),(Z<=1||wI(k,F)>y)&&(_.push(F),k=F),E=j,T=$}let R=t[0].point.slice(0,2),H=t.length>1?t[t.length-1].point.slice(0,2):Qi(t[0].point,[1,1]),W=[],q=[];if(t.length===1){if(!(m||v)||c){let Z=xI(R,kO(Xh(bi(R,H))),-(x||w)),j=[];for(let K=1/13,$=K;$<=1;$+=K)j.push(Yh(Z,R,Zh*2*$));return j}}else{if(!(m||v&&t.length===1))if(u)for(let j=1/13,K=j;K<=1;K+=j){let $=Yh(_[0],R,Zh*K);W.push($)}else{let j=bi(b[0],_[0]),K=Ki(j,.5),$=Ki(j,.51);W.push(bi(R,K),bi(R,$),Qi(R,$),Qi(R,K))}let Z=Xh(YJ(t[t.length-1].vector));if(v||m&&t.length===1)q.push(H);else if(h){let j=xI(H,Z,w);for(let K=1/29,$=K;$<1;$+=K)q.push(Yh(j,H,Zh*3*$))}else q.push(Qi(H,Ki(Z,w)),Qi(H,Ki(Z,w*.99)),bi(H,Ki(Z,w*.99)),bi(H,Ki(Z,w)))}return b.concat(q,_.reverse(),W)}function nQ(t,e={}){var n;let{streamline:r=.5,size:i=16,last:s=!1}=e;if(t.length===0)return[];let o=.15+(1-r)*.85,a=Array.isArray(t[0])?t:t.map(({x:f,y:p,pressure:m=.5})=>[f,p,m]);if(a.length===2){let f=a[1];a=a.slice(0,-1);for(let p=1;p<5;p++)a.push(yx(a[0],f,p/4))}a.length===1&&(a=[...a,[...Qi(a[0],[1,1]),...a[0].slice(2)]]);let l=[{point:[a[0][0],a[0][1]],pressure:a[0][2]>=0?a[0][2]:.25,vector:[1,1],distance:0,runningLength:0}],c=!1,u=0,d=l[0],h=a.length-1;for(let f=1;f<a.length;f++){let p=s&&f===h?a[f].slice(0,2):yx(d.point,a[f],o);if(KJ(d.point,p))continue;let m=QJ(p,d.point);if(u+=m,f<h&&!c){if(u<i)continue;c=!0}d={point:p,pressure:a[f][2]>=0?a[f][2]:.5,vector:kO(bi(d.point,p)),distance:m,runningLength:u},l.push(d)}return l[0].vector=((n=l[1])==null?void 0:n.vector)||[0,0],l}function rQ(t,e={}){return tQ(nQ(t,e),e)}const Ar=(t,e)=>[0,0,0,0,e,t,1,0],MO=(t,e)=>[0,0,0,0,e,t,0,0],du=(t=0,e=0)=>{const n=[0,0,0,0,0,0,0,0];if(e<0||e>7)throw new Error(`Expected \`index\` between 0 and 7, got \`${e}\``);return t!==0&&(n[e]=t),n},$v=t=>[t[0],t[1],t[2],t[3],-t[4],-t[5],-t[6],-t[7]],iQ=(t,e)=>lS(e)?[t[0]+e,t[1],t[2],t[3],t[4],t[5],t[6],t[7]]:[t[0]+e[0],t[1]+e[1],t[2]+e[2],t[3]+e[3],t[4]+e[4],t[5]+e[5],t[6]+e[6],t[7]+e[7]],gy=(t,e)=>lS(e)?[t[0]-e,t[1],t[2],t[3],t[4],t[5],t[6],t[7]]:[t[0]-e[0],t[1]-e[1],t[2]-e[2],t[3]-e[3],t[4]-e[4],t[5]-e[5],t[6]-e[6],t[7]-e[7]],Yd=(t,e)=>lS(e)?[t[0]*e,t[1]*e,t[2]*e,t[3]*e,t[4]*e,t[5]*e,t[6]*e,t[7]*e]:[sQ(t,e),e[1]*t[0]+e[0]*t[1]-e[4]*t[2]+e[5]*t[3]+e[2]*t[4]-e[3]*t[5]-e[7]*t[6]-e[6]*t[7],e[2]*t[0]+e[0]*t[2]-e[6]*t[3]+e[3]*t[6],e[3]*t[0]+e[6]*t[2]+e[0]*t[3]-e[2]*t[6],e[4]*t[0]+e[2]*t[1]-e[1]*t[2]+e[7]*t[3]+e[0]*t[4]+e[6]*t[5]-e[5]*t[6]+e[3]*t[7],e[5]*t[0]-e[3]*t[1]+e[7]*t[2]+e[1]*t[3]-e[6]*t[4]+e[0]*t[5]+e[4]*t[6]+e[2]*t[7],e[6]*t[0]+e[3]*t[2]-e[2]*t[3]+e[0]*t[6],e[7]*t[0]+e[6]*t[1]+e[5]*t[2]+e[4]*t[3]+e[3]*t[4]+e[2]*t[5]+e[1]*t[6]+e[0]*t[7]],sQ=(t,e)=>e[0]*t[0]+e[2]*t[2]+e[3]*t[3]-e[6]*t[6],oQ=(t,e)=>[e[0]*t[0],e[1]*t[0]+e[0]*t[1],e[2]*t[0]+e[0]*t[2],e[3]*t[0]+e[0]*t[3],e[4]*t[0]+e[2]*t[1]-e[1]*t[2]+e[0]*t[4],e[5]*t[0]-e[3]*t[1]+e[1]*t[3]+e[0]*t[5],e[6]*t[0]+e[3]*t[2]-e[2]*t[3]+e[0]*t[6],e[7]*t[0]+e[6]*t[1]+e[5]*t[2]+e[4]*t[3]+e[3]*t[4]+e[2]*t[5]+e[1]*t[6]],PO=(t,e)=>[LO(t,e),t[1]*e[7]+t[4]*e[5]-t[5]*e[4]+t[7]*e[1],t[2]*e[7]-t[4]*e[6]+t[6]*e[4]+t[7]*e[2],t[3]*e[7]+t[5]*e[6]-t[6]*e[5]+t[7]*e[3],t[4]*e[7]+t[7]*e[4],t[5]*e[7]+t[7]*e[5],t[6]*e[7]+t[7]*e[6],t[7]*e[7]],LO=(t,e)=>t[0]*e[7]+t[1]*e[6]+t[2]*e[5]+t[3]*e[4]+t[4]*e[3]+t[5]*e[2]+t[6]*e[1]+t[7]*e[0],aQ=(t,e)=>[e[0]*t[0]+e[2]*t[2]+e[3]*t[3]-e[6]*t[6],e[1]*t[0]+e[0]*t[1]-e[4]*t[2]+e[5]*t[3]+e[2]*t[4]-e[3]*t[5]-e[7]*t[6]-e[6]*t[7],e[2]*t[0]+e[0]*t[2]-e[6]*t[3]+e[3]*t[6],e[3]*t[0]+e[6]*t[2]+e[0]*t[3]-e[2]*t[6],e[4]*t[0]+e[7]*t[3]+e[0]*t[4]+e[3]*t[7],e[5]*t[0]+e[7]*t[2]+e[0]*t[5]+e[2]*t[7],e[6]*t[0]+e[0]*t[6],e[7]*t[0]+e[0]*t[7]],RO=t=>Math.sqrt(Math.abs(t[0]*t[0]-t[2]*t[2]-t[3]*t[3]+t[6]*t[6])),lQ=t=>Math.sqrt(Math.abs(t[7]*t[7]-t[5]*t[5]-t[4]*t[4]+t[1]*t[1])),Hv=t=>{const e=RO(t);if(e===0||e===1)return t;const n=t[6]<0?-1:1;return Yd(t,n/e)},cQ=t=>{const e=lQ(t);return e===0||e===1?t:Yd(t,1/e)},lS=t=>typeof t=="number";du(1,1);du(1,2);du(1,3);du(1,4);du(1,5);du(1,6);du(1,7);const Wc=(t,e,n)=>Hv([0,n,t,e,0,0,0,0]),$m=(t,e)=>Hv(PO(e,t)),uQ=(t,e)=>aQ(t,e),dQ=(t,e)=>uQ($m(t,e),e),hQ=t=>Math.sign(t[1]),jc=([t,e])=>[0,0,0,0,e,t,1,0],Xc=t=>[t[5],t[4]],OO=t=>[0,0,0,0,Math.abs(t[4]),Math.abs(t[5]),1,0],fQ=(t,e)=>Hv(oQ(t,e)),SI=(t,e)=>RO(PO(t,e)),ws=(t,e)=>LO(t,e),cS=t=>[0,0,0,0,t[4],t[5],0,0],pQ=(t,e)=>cQ([0,0,0,0,e[4]-t[4],e[5]-t[5],0,0]),uS=(t,e)=>iQ(Yd(t,Math.sin(e/2)),Math.cos(e/2)),mQ=t=>[1,0,0,0,-(.5*t[5]),.5*t[4],0,0],gQ=(t,e)=>{const n=.5*e;return[1,0,0,0,n*t[4],n*t[5],0,0]},yQ=(t,e)=>Yd(e,t),gs=(t,e)=>Hv(Yd(Yd(t,e),$v(t)));function vQ(t,e){return Math.sqrt(e0(t,e))}function e0(t,e){return Math.pow(t[0]-e[0],2)+Math.pow(t[1]-e[1],2)}function bQ(t,e,n){const r=e0(e,n);if(r===0)return e0(t,e);let i=((t[0]-e[0])*(n[0]-e[0])+(t[1]-e[1])*(n[1]-e[1]))/r;return i=Math.max(0,Math.min(1,i)),e0(t,Jl(e,n,i))}function Jl(t,e,n){return[t[0]+(e[0]-t[0])*n,t[1]+(e[1]-t[1])*n]}function _Q(t,e){const n=t[e+0],r=t[e+1],i=t[e+2],s=t[e+3];let o=3*r[0]-2*n[0]-s[0];o*=o;let a=3*r[1]-2*n[1]-s[1];a*=a;let l=3*i[0]-2*s[0]-n[0];l*=l;let c=3*i[1]-2*s[1]-n[1];return c*=c,o<l&&(o=l),a<c&&(a=c),o+a}function vx(t,e,n,r){const i=r||[];if(_Q(t,e)<n){const s=t[e+0];i.length?vQ(i[i.length-1],s)>1&&i.push(s):i.push(s),i.push(t[e+3])}else{const o=t[e+0],a=t[e+1],l=t[e+2],c=t[e+3],u=Jl(o,a,.5),d=Jl(a,l,.5),h=Jl(l,c,.5),f=Jl(u,d,.5),p=Jl(d,h,.5),m=Jl(f,p,.5);vx([o,u,f,m],0,n,i),vx([m,p,h,c],0,n,i)}return i}function EQ(t,e){return yy(t,0,t.length,e)}function yy(t,e,n,r,i){const s=i||[],o=t[e],a=t[n-1];let l=0,c=1;for(let u=e+1;u<n-1;++u){const d=bQ(t[u],o,a);d>l&&(l=d,c=u)}return Math.sqrt(l)>r?(yy(t,e,c+1,r,s),yy(t,c,n,r,s)):(s.length||s.push(o),s.push(a)),s}function wQ(t,e=.15,n){const r=[],i=(t.length-1)/3;for(let s=0;s<i;s++){const o=s*3;vx(t,o,e,r)}return n&&n>0?yy(r,0,r.length,n):r}const CI=(t,e,n,r,i,s,o)=>{t.beginPath(),t.moveTo(e+s,n),t.lineTo(e+r-s,n),t.quadraticCurveTo(e+r,n,e+r,n+s),t.lineTo(e+r,n+i-s),t.quadraticCurveTo(e+r,n+i,e+r-s,n+i),t.lineTo(e+s,n+i),t.quadraticCurveTo(e,n+i,e,n+i-s),t.lineTo(e,n+s),t.quadraticCurveTo(e,n,e+s,n),t.closePath(),t.fill(),o&&(t.strokeStyle=o),t.stroke()};var Uo=(t=>(t.Bold="#cccccc",t.Regular="#e5e5e5",t))(Uo||{});function xQ(t){let e=0;if(t.length===0)return e;for(let n=0;n<t.length;n++){const r=t.charCodeAt(n);e=(e<<5)-e+r}return e}const vy=t=>`hsl(${Math.abs(xQ(t))%37*10}, 100%, 83%)`,TQ=t=>{var n;const e=(n=t==null?void 0:t.trim())==null?void 0:n.codePointAt(0);return(e?String.fromCodePoint(e):"?").toUpperCase()},DO=(t,e,n)=>{const r=n.reduce((i,s)=>(s.groupIds.includes(t)&&(i[s.id]=!0),i),{});return Object.keys(r).length<2?e.selectedGroupIds[t]||e.editingGroupId===t?{selectedElementIds:e.selectedElementIds,selectedGroupIds:{...e.selectedGroupIds,[t]:!1},editingGroupId:null}:e:{editingGroupId:e.editingGroupId,selectedGroupIds:{...e.selectedGroupIds,[t]:!0},selectedElementIds:{...e.selectedElementIds,...r}}},ri=function(){let t=null,e=null,n=null;const r=(s,o,a,l)=>{if(n!==void 0&&o===e&&s===t&&a.editingGroupId===(n==null?void 0:n.editingGroupId))return n;const c={};for(const h of s){let f=h.groupIds;if(a.editingGroupId){const p=f.indexOf(a.editingGroupId);p>-1&&(f=f.slice(0,p))}if(f.length>0){const p=f[f.length-1];c[p]=!0}}const u={},d=o.reduce((h,f)=>{const p=f.groupIds.find(m=>c[m]);return p&&(h[f.id]=!0,Array.isArray(u[p])?u[p].push(f.id):u[p]=[f.id]),h},{});for(const h of Object.keys(u))u[h].length<2&&c[h]&&(c[h]=!1);return e=o,t=s,n={editingGroupId:a.editingGroupId,selectedGroupIds:c,selectedElementIds:gt({...a.selectedElementIds,...d},l)},n},i=(s,o,a,l)=>{const c=l?l.scene.getSelectedElements({selectedElementIds:s.selectedElementIds,elements:o}):Rt(o,s);return c.length?r(c,o,s,a):{selectedGroupIds:{},editingGroupId:null,selectedElementIds:gt(s.selectedElementIds,a)}};return i.clearCache=()=>{e=null,t=null,n=null},i}(),dS=(t,e)=>NO(t,e)!=null,NO=(t,e)=>e.groupIds.filter(n=>n!==t.editingGroupId).find(n=>t.selectedGroupIds[n]),Cd=t=>Object.entries(t.selectedGroupIds).filter(([e,n])=>n).map(([e,n])=>e),FO=(t,e)=>{let n={...e,selectedGroupIds:{}};for(const r of t){let i=r.groupIds;if(e.editingGroupId){const s=i.indexOf(e.editingGroupId);s>-1&&(i=i.slice(0,s))}if(i.length>0){const s=i[i.length-1];n={...n,...DO(s,n,t)}}}return n.selectedGroupIds},SQ=(t,e)=>({...t,editingGroupId:e.groupIds.length?e.groupIds[0]:null,selectedGroupIds:{},selectedElementIds:{[e.id]:!0}}),Xp=(t,e)=>t.groupIds.includes(e),Gn=(t,e)=>t.filter(n=>Xp(n,e)),CQ=(t,e)=>t.groupIds.find(n=>e[n]),IQ=(t,e,n)=>{const r=[...t],i=e?t.indexOf(e):-1,s=i>-1?i:t.length;for(let o=0;o<s;o++)r[o]=n(r[o]);return r},AQ=(t,e,n)=>{const r=[...t],i=n?r.indexOf(n):-1,s=i>-1?i:r.length;return r.splice(s,0,e),r},kQ=(t,e)=>t.filter(n=>!e[n]),zv=t=>{const e=new Map;return t.forEach(n=>{const r=n.groupIds.length===0?n.id:n.groupIds[n.groupIds.length-1],i=e.get(r)||[],s=tt(n);s&&i.push(s),e.set(r,[...i,n])}),Array.from(e.values())};var mc=(t=>(t.ACTIVE="active",t.AWAY="away",t.IDLE="idle",t))(mc||{});let bx=[];const ue=t=>(bx=bx.concat(t),t),BO='<svg viewBox="0 0 24 24" stroke-width="1" width="28" height="28" xmlns="http://www.w3.org/2000/svg">',MQ='<path d="M6.164 11.755a5.314 5.314 0 0 1-4.932-5.298 5.314 5.314 0 0 1 5.311-5.311 5.314 5.314 0 0 1 5.307 5.113l8.773 8.773a3.322 3.322 0 0 1 0 4.696l-.895.895a3.322 3.322 0 0 1-4.696 0l-8.868-8.868Z" style="fill:#fff"/>',UO='<path stroke="#1b1b1f" fill="#fff" d="m7.868 11.113 7.773 7.774a2.359 2.359 0 0 0 1.667.691 2.368 2.368 0 0 0 2.357-2.358c0-.625-.248-1.225-.69-1.667L11.201 7.78 9.558 9.469l-1.69 1.643v.001Zm10.273 3.606-3.333 3.333m-3.25-6.583 2 2m-7-7 3 3M3.664 3.625l1 1M2.529 6.922l1.407-.144m5.735-2.932-1.118.866M4.285 9.823l.758-1.194m1.863-6.207-.13 1.408"/>',PQ=`data:${Oe.svg},${encodeURIComponent(`${BO}${UO}</svg>`)}`,LQ=`data:${Oe.svg},${encodeURIComponent(`${BO}${MQ}${UO}</svg>`)}`,qi=t=>{t&&(t.style.cursor="")},Et=(t,e)=>{t&&(t.style.cursor=e)};let Ps,II;const $O=(t,e)=>{const r=()=>{const i=e===Vn.DARK;Ps=document.createElement("canvas"),Ps.theme=e,Ps.height=20,Ps.width=20;const s=Ps.getContext("2d");s.lineWidth=1,s.beginPath(),s.arc(Ps.width/2,Ps.height/2,5,0,2*Math.PI),s.fillStyle=i?Jt.black:Jt.white,s.fill(),s.strokeStyle=i?Jt.white:Jt.black,s.stroke(),II=Ps.toDataURL(Oe.svg)};(!Ps||Ps.theme!==e)&&r(),Et(t,`url(${II}) ${20/2} ${20/2}, auto`)},zs=(t,e)=>{if(t)if(e.activeTool.type==="selection")qi(t);else if(Gd(e))t.style.cursor=vt.GRAB;else if(pc(e))$O(t,e.theme);else if(e.activeTool.type==="laser"){const n=e.theme===Vn.LIGHT?PQ:LQ;t.style.cursor=`url(${n}), auto`}else["image","custom"].includes(e.activeTool.type)?e.activeTool.type!=="image"&&(t.style.cursor=vt.AUTO):t.style.cursor=vt.CROSSHAIR};let RQ=new yO(Date.now());const Rl=()=>Math.floor(RQ.next()*2**31),Di=()=>oS(),ua=(t,{x:e,y:n,strokeColor:r=en.strokeColor,backgroundColor:i=en.backgroundColor,fillStyle:s=en.fillStyle,strokeWidth:o=en.strokeWidth,strokeStyle:a=en.strokeStyle,roughness:l=en.roughness,opacity:c=en.opacity,width:u=0,height:d=0,angle:h=0,groupIds:f=[],frameId:p=null,roundness:m=null,boundElements:v=null,link:y=null,locked:b=en.locked,..._})=>({id:_.id||Di(),type:t,x:e,y:n,width:u,height:d,angle:h,strokeColor:r,backgroundColor:i,fillStyle:s,strokeWidth:o,strokeStyle:a,roughness:l,opacity:c,groupIds:f,frameId:p,roundness:m,seed:_.seed??Rl(),version:_.version||1,versionNonce:_.versionNonce??0,isDeleted:!1,boundElements:v,updated:lh(),link:y,locked:b}),bl=t=>ua(t.type,t),AI=t=>({...ua("embeddable",t),validated:t.validated}),OQ=t=>({...ua("iframe",t)}),HO=t=>Re({...ua("frame",t),type:"frame",name:(t==null?void 0:t.name)||null},{}),_x=t=>Re({...ua("magicframe",t),type:"magicframe",name:(t==null?void 0:t.name)||null},{}),zO=(t,e)=>({x:t.textAlign==="center"?e.width/2:t.textAlign==="right"?e.width:0,y:t.verticalAlign==="middle"?e.height/2:0}),Ni=t=>{const e=t.fontFamily||ca,n=t.fontSize||_s,r=t.lineHeight||Kc(e),i=im(t.text),s=ia(i,mn({fontFamily:e,fontSize:n}),r),o=t.textAlign||kv,a=t.verticalAlign||j0,l=zO({textAlign:o,verticalAlign:a},s);return Re({...ua("text",t),text:i,fontSize:n,fontFamily:e,textAlign:o,verticalAlign:a,x:t.x-l.x,y:t.y-l.y,width:s.width,height:s.height,baseline:s.baseline,containerId:t.containerId||null,originalText:i,lineHeight:r},{})},DQ=(t,e)=>{const{width:n,height:r,baseline:i}=ia(e,mn(t),t.lineHeight),{textAlign:s,verticalAlign:o}=t;let a,l;if(s==="center"&&o===ai.MIDDLE&&!t.containerId){const c=ia(t.text,mn(t),t.lineHeight),u=zO(t,{width:n-c.width,height:r-c.height});a=t.x-u.x,l=t.y-u.y}else{const[c,u,d,h]=Ve(t),[f,p,m,v]=ep(t,n,r,!1),y=(c-f)/2,b=(u-p)/2,_=(d-m)/2,E=(h-v)/2;[a,l]=LN({s:!0,e:s==="center"||s==="left",w:s==="center"||s==="right"},t.x,t.y,t.angle,y,b,_,E)}return{width:n,height:r,baseline:i,x:Number.isFinite(a)?a:t.x,y:Number.isFinite(l)?l:t.y}},hS=(t,e=t.text)=>{if(t.isDeleted)return;const n=Dn(t);n&&(e=Xm(e,mn(t),mo(n)));const r=DQ(t,e);return{text:e,...r}},NQ=(t,{text:e,isDeleted:n,originalText:r})=>Re(t,{originalText:r,isDeleted:n??t.isDeleted,...hS(t,r)}),FQ=t=>({...ua(t.type,t),points:t.points||[],pressures:[],simulatePressure:t.simulatePressure,lastCommittedPoint:null}),sl=t=>({...ua(t.type,t),points:t.points||[],lastCommittedPoint:null,startBinding:null,endBinding:null,startArrowhead:t.startArrowhead||null,endArrowhead:t.endArrowhead||null}),GO=t=>({...ua("image",t),strokeColor:"transparent",status:t.status??"pending",fileId:t.fileId??null,scale:t.scale??[1,1]}),by=(t,e=0)=>{if(t==null||typeof t!="object")return t;if(Object.prototype.toString.call(t)==="[object Object]"){const r=typeof t.constructor=="function"?Object.create(Object.getPrototypeOf(t)):{};for(const i in t)if(t.hasOwnProperty(i)){if(e===0&&(i==="shape"||i==="canvas"))continue;r[i]=by(t[i],e+1)}return r}if(Array.isArray(t)){let r=t.length;const i=new Array(r);for(;r--;)i[r]=by(t[r],e+1);return i}return t},Hm=t=>by(t),_y=t=>Di(),VO=(t,e,n,r)=>{let i=Hm(n);return i.id=_y(i.id),i.boundElements=null,i.updated=lh(),i.seed=Rl(),i.groupIds=IQ(i.groupIds,t,s=>(e.has(s)||e.set(s,_y()),e.get(s))),r&&(i=Object.assign(i,r)),i},WO=(t,e)=>{const n=[],r=xn(t),i=new Map,s=a=>{if(i.has(a))return i.get(a);if(r.has(a)){const l=_y();return i.set(a,l),l}return null},o=new Map;for(const a of t){const l=by(a);if(l.id=s(a.id),e!=null&&e.randomizeSeed&&(l.seed=Rl(),wh(l)),l.groupIds&&(l.groupIds=l.groupIds.map(c=>(o.has(c)||o.set(c,_y()),o.get(c)))),"containerId"in l&&l.containerId){const c=s(l.containerId);l.containerId=c}if("boundElements"in l&&l.boundElements&&(l.boundElements=l.boundElements.reduce((c,u)=>{const d=s(u.id);return d&&c.push({...u,id:d}),c},[])),"endBinding"in l&&l.endBinding){const c=s(l.endBinding.elementId);l.endBinding=c?{...l.endBinding,elementId:c}:null}if("startBinding"in l&&l.startBinding){const c=s(l.startBinding.elementId);l.startBinding=c?{...l.startBinding,elementId:c}:null}l.frameId&&(l.frameId=s(l.frameId)),n.push(l)}return n},Eo=new Map,BQ=/^(?:http(?:s)?:\/\/)?(?:www\.)?youtu(?:be\.com|\.be)\/(embed\/|watch\?v=|shorts\/|playlist\?list=|embed\/videoseries\?list=)?([a-zA-Z0-9_-]+)(?:\?t=|&t=|\?start=|&start=)?([a-zA-Z0-9_-]+)?[^\s]*$/,UQ=/^(?:http(?:s)?:\/\/)?(?:(?:w){3}.)?(?:player\.)?vimeo\.com\/(?:video\/)?([^?\s]+)(?:\?.*)?$/,$Q=/^https:\/\/(?:www\.)?figma\.com/,HQ=/^https:\/\/gist\.github\.com/,zQ=/^<script[\s\S]*?\ssrc=["'](https:\/\/gist.github.com\/.*?)\.js["']/i,GQ=/(?:http(?:s)?:\/\/)?(?:(?:w){3}.)?twitter.com/,VQ=/^<blockquote[\s\S]*?\shref=["'](https:\/\/twitter.com\/[^"']*)/i,WQ=/^https:\/\/(?:www\.)?val.town\/(v|embed)\/[a-zA-Z_$][0-9a-zA-Z_$]+\.[a-zA-Z_$][0-9a-zA-Z_$]+/,jQ=/^<(?:iframe|blockquote)[\s\S]*?\s(?:src|href)=["']([^"']*)["'][\s\S]*?>$/i,kI=/giphy.com\/(?:clips|embed|gifs)\/[a-zA-Z0-9]*?-?([a-zA-Z0-9]+)(?:[^a-zA-Z0-9]|$)/,Ex=new Set(["youtube.com","youtu.be","vimeo.com","player.vimeo.com","figma.com","link.excalidraw.com","gist.github.com","twitter.com","*.simplepdf.eu","stackblitz.com","val.town","giphy.com","dddice.com"]),od=t=>`<html><body>${t}</body></html>`,ad=t=>{if(!t)return null;if(Eo.has(t))return Eo.get(t);const e=t;let n="generic",r={w:560,h:840};const i=t.match(BQ);if(i!=null&&i[2]){const l=i[3]?`&start=${i[3]}`:"",c=t.includes("shorts");switch(n="video",i[1]){case"embed/":case"watch?v=":case"shorts/":t=`https://www.youtube.com/embed/${i[2]}?enablejsapi=1${l}`;break;case"playlist?list=":case"embed/videoseries?list=":t=`https://www.youtube.com/embed/videoseries?list=${i[2]}&enablejsapi=1${l}`;break;default:t=`https://www.youtube.com/embed/${i[2]}?enablejsapi=1${l}`;break}return r=c?{w:315,h:560}:{w:560,h:315},Eo.set(e,{link:t,intrinsicSize:r,type:n}),{link:t,intrinsicSize:r,type:n}}const s=t.match(UQ);if(s!=null&&s[1]){const l=s==null?void 0:s[1],c=/^\d+$/.test(l)?void 0:I("toast.unrecognizedLinkFormat");return n="video",t=`https://player.vimeo.com/video/${l}?api=1`,r={w:560,h:315},Eo.set(e,{link:t,intrinsicSize:r,type:n}),{link:t,intrinsicSize:r,type:n,warning:c}}if(t.match($Q))return n="generic",t=`https://www.figma.com/embed?embed_host=share&url=${encodeURIComponent(t)}`,r={w:550,h:550},Eo.set(e,{link:t,intrinsicSize:r,type:n}),{link:t,intrinsicSize:r,type:n};const a=t.match(WQ);if(a)return t=a[1]==="embed"?a[0]:a[0].replace("/v","/embed"),Eo.set(e,{link:t,intrinsicSize:r,type:n}),{link:t,intrinsicSize:r,type:n};if(GQ.test(t)){let l;if(/<blockquote/.test(t)){const c=od(t);l={type:"document",srcdoc:()=>c,intrinsicSize:{w:480,h:480}}}else l={type:"document",srcdoc:c=>od(`<blockquote class="twitter-tweet" data-dnt="true" data-theme="${c}"><a href="${t}"></a></blockquote> <script async src="https://platform.twitter.com/widgets.js" charset="utf-8"><\/script>`),intrinsicSize:{w:480,h:480}};return Eo.set(e,l),l}if(HQ.test(t)){let l;if(/<script>/.test(t)){const c=od(t);l={type:"document",srcdoc:()=>c,intrinsicSize:{w:550,h:720}}}else l={type:"document",srcdoc:()=>od(`
          <script src="${t}.js"><\/script>
          <style type="text/css">
            * { margin: 0px; }
            table, .gist { height: 100%; }
            .gist .gist-file { height: calc(100vh - 2px); padding: 0px; display: grid; grid-template-rows: 1fr auto; }
          </style>
        `),intrinsicSize:{w:550,h:720}};return Eo.set(t,l),l}return Eo.set(t,{link:t,intrinsicSize:r,type:n}),{link:t,intrinsicSize:r,type:n}},Yp=t=>{if(os(t))return!0;if(t.type==="text"){const e=Dn(t);if(e&&qe(e))return!0}return!1},fS=t=>{let e;Pa(t)?e="IFrame element":e=!t.link||(t==null?void 0:t.link)===""?"Empty Web-Embed":t.link;const n=Math.max(Math.min(t.width/2,t.width/e.length),t.width/30),r=mr.Helvetica,i=mn({fontSize:n,fontFamily:r});return Ni({x:t.x+t.width/2,y:t.y+t.height/2,strokeColor:t.strokeColor!=="transparent"?t.strokeColor:"black",backgroundColor:"transparent",fontFamily:r,fontSize:n,text:Xm(e,i,t.width-20),textAlign:"center",verticalAlign:ai.MIDDLE,angle:t.angle??0})};ue({name:"setEmbeddableAsActiveTool",trackEvent:{category:"toolbar"},perform:(t,e,n,r)=>{const i=kn(e,{type:"embeddable"});return zs(r.canvas,{...e,activeTool:i}),{elements:t,appState:{...e,activeTool:kn(e,{type:"embeddable"})},commitToHistory:!1}}});const MI=(t,e)=>{try{const{hostname:n}=new URL(t),r=n.replace(/^www\./,""),i=r.replace(/^([^.]+)/,"*");if(e instanceof Set)return Ex.has(r)||Ex.has(i);if(r===e.replace(/^www\./,""))return!0}catch{}return!1},XQ=t=>{const e=t.match(VQ);if(e&&e.length===2)return e[1];const n=t.match(zQ);if(n&&n.length===2)return n[1];if(kI.test(t))return`https://giphy.com/embed/${kI.exec(t)[1]}`;const r=t.match(jQ);return r&&r.length===2?r[1]:t},t0=(t,e)=>{if(!t)return!1;if(e!=null)if(typeof e=="function"){const n=e(t);if(typeof n=="boolean")return n}else{if(typeof e=="boolean")return e;if(e instanceof RegExp)return e.test(t);if(Array.isArray(e)){for(const n of e)if(n instanceof RegExp){if(t.match(n))return!0}else if(MI(t,n))return!0;return!1}}return MI(t,Ex)};class YQ extends Error{constructor(e="Couldn't export canvas.",n="CANVAS_ERROR"){super(),this.name=n,this.message=e}}class Zp extends DOMException{constructor(e="Request Aborted"){super(e,"AbortError")}}class gc extends Error{constructor(n="Image Scene Data Error",r="IMAGE_SCENE_DATA_ERROR"){super(n);O(this,"code");this.name="EncodingError",this.code=r}}const _l=({size:t="1em",circleWidth:e=8,synchronized:n=!1})=>{const i=-(ce.useRef(Date.now()).current%1600);return g("div",{className:"Spinner",children:g("svg",{viewBox:"0 0 100 100",style:{width:t,height:t,"--spinner-delay":n?`${i}ms`:0},children:g("circle",{cx:"50",cy:"50",r:50-e/2,strokeWidth:e,fill:"none",strokeMiterlimit:"10"})})})},st=ce.forwardRef((t,e)=>{const{id:n}=pa(),r=ce.useRef(null);ce.useImperativeHandle(e,()=>r.current);const i=`ToolIcon_size_${t.size}`,[s,o]=A.useState(!1),a=A.useRef(!0),l=async u=>{var h;const d="onClick"in t&&((h=t.onClick)==null?void 0:h.call(t,u));if(d&&"then"in d)try{o(!0),await d}catch(f){if(f instanceof Zp)console.warn(f);else throw f}finally{a.current&&o(!1)}};A.useEffect(()=>(a.current=!0,()=>{a.current=!1}),[]);const c=A.useRef(null);if(t.type==="button"||t.type==="icon"||t.type==="submit"){const u=t.type==="icon"?"button":t.type;return M("button",{className:Ee("ToolIcon_type_button",i,t.className,t.visible&&!t.hidden?"ToolIcon_type_button--show":"ToolIcon_type_button--hide",{ToolIcon:!t.hidden,"ToolIcon--selected":t.selected,"ToolIcon--plain":t.type==="icon"}),style:t.style,"data-testid":t["data-testid"],hidden:t.hidden,title:t.title,"aria-label":t["aria-label"],type:u,onClick:l,ref:r,disabled:s||t.isLoading,children:[(t.icon||t.label)&&M("div",{className:"ToolIcon__icon","aria-hidden":"true",children:[t.icon||t.label,t.keyBindingLabel&&g("span",{className:"ToolIcon__keybinding",children:t.keyBindingLabel}),t.isLoading&&g(_l,{})]}),t.showAriaLabel&&M("div",{className:"ToolIcon__label",children:[t["aria-label"]," ",s&&g(_l,{})]}),t.children]})}return M("label",{className:Ee("ToolIcon",t.className),title:t.title,onPointerDown:u=>{var d;c.current=u.pointerType||null,(d=t.onPointerDown)==null||d.call(t,{pointerType:u.pointerType||null})},onPointerUp:()=>{requestAnimationFrame(()=>{c.current=null})},children:[g("input",{className:`ToolIcon_type_radio ${i}`,type:"radio",name:t.name,"aria-label":t["aria-label"],"aria-keyshortcuts":t["aria-keyshortcuts"],"data-testid":t["data-testid"],id:`${n}-${t.id}`,onChange:()=>{var u;(u=t.onChange)==null||u.call(t,{pointerType:c.current})},checked:t.checked,ref:r}),M("div",{className:"ToolIcon__icon",children:[t.icon,t.keyBindingLabel&&g("span",{className:"ToolIcon__keybinding",children:t.keyBindingLabel})]})]})});st.defaultProps={visible:!0,className:"",size:"medium"};st.displayName="ToolButton";const as=t=>"var(--icon-fill-color)",jO=t=>t===Vn.LIGHT?Jt.white:"#1e1e1e",Q=(t,e=512)=>{const{width:n=512,height:r=n,mirror:i,style:s,...o}=typeof e=="number"?{width:e}:e;return g("svg",{"aria-hidden":"true",focusable:"false",role:"img",viewBox:`0 0 ${n} ${r}`,className:Ee({"rtl-mirror":i}),style:s,...o,children:typeof t=="string"?g("path",{fill:"currentColor",d:t}):t})},je={width:24,height:24,fill:"none",strokeWidth:2,stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round"},Fe={width:20,height:20,fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round"},XO=Q(M("g",{strokeWidth:"1.5",children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("rect",{x:3,y:8,width:18,height:4,rx:1}),g("line",{x1:12,y1:8,x2:12,y2:21}),g("path",{d:"M19 12v7a2 2 0 0 1 -2 2h-10a2 2 0 0 1 -2 -2v-7"}),g("path",{d:"M7.5 8a2.5 2.5 0 0 1 0 -5a4.8 8 0 0 1 4.5 5a4.8 8 0 0 1 4.5 -5a2.5 2.5 0 0 1 0 5"})]}),je),ZQ=Q(M("g",{strokeWidth:"1.5",children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M3 19a9 9 0 0 1 9 0a9 9 0 0 1 9 0"}),g("path",{d:"M3 6a9 9 0 0 1 9 0a9 9 0 0 1 9 0"}),g("line",{x1:"3",y1:"6",x2:"3",y2:"19"}),g("line",{x1:"12",y1:"6",x2:"12",y2:"19"}),g("line",{x1:"21",y1:"6",x2:"21",y2:"19"})]}),je),KQ=Q(M("svg",{strokeWidth:"1.5",children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),g("line",{x1:"5",y1:"12",x2:"19",y2:"12"})]}),je),qQ=Q(M("g",{strokeWidth:"1.5",children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("circle",{cx:"12",cy:"12",r:"1"}),g("circle",{cx:"12",cy:"19",r:"1"}),g("circle",{cx:"12",cy:"5",r:"1"})]}),je),JQ=Q(M("svg",{strokeWidth:"1.5",children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M9 4v6l-2 4v2h10v-2l-2 -4v-6"}),g("line",{x1:"12",y1:"16",x2:"12",y2:"21"}),g("line",{x1:"8",y1:"4",x2:"16",y2:"4"})]}),je),QQ=Q(M("g",{children:[g("path",{d:"M13.542 8.542H6.458a2.5 2.5 0 0 0-2.5 2.5v3.75a2.5 2.5 0 0 0 2.5 2.5h7.084a2.5 2.5 0 0 0 2.5-2.5v-3.75a2.5 2.5 0 0 0-2.5-2.5Z",stroke:"currentColor",strokeWidth:"1.25"}),g("path",{d:"M10 13.958a1.042 1.042 0 1 0 0-2.083 1.042 1.042 0 0 0 0 2.083Z",stroke:"currentColor",strokeWidth:"1.25"}),g("mask",{id:"UnlockedIcon",style:{maskType:"alpha"},maskUnits:"userSpaceOnUse",x:6,y:1,width:9,height:9,children:g("path",{stroke:"none",d:"M6.399 9.561V5.175c0-.93.401-1.823 1.116-2.48a3.981 3.981 0 0 1 2.693-1.028c1.01 0 1.98.37 2.694 1.027.715.658 1.116 1.55 1.116 2.481",fill:"#fff"})}),g("g",{mask:"url(#UnlockedIcon)",children:g("path",{stroke:"none",d:"M5.149 9.561v1.25h2.5v-1.25h-2.5Zm5.06-7.894V.417v1.25Zm2.559 3.508v1.25h2.5v-1.25h-2.5ZM7.648 8.51V5.175h-2.5V8.51h2.5Zm0-3.334c0-.564.243-1.128.713-1.561L6.668 1.775c-.959.883-1.52 2.104-1.52 3.4h2.5Zm.713-1.561a2.732 2.732 0 0 1 1.847-.697v-2.5c-1.31 0-2.585.478-3.54 1.358L8.36 3.614Zm1.847-.697c.71 0 1.374.26 1.847.697l1.694-1.839a5.231 5.231 0 0 0-3.54-1.358v2.5Zm1.847.697c.47.433.713.997.713 1.561h2.5c0-1.296-.56-2.517-1.52-3.4l-1.693 1.839Z",fill:"currentColor"})})]}),Fe),eee=Q(M("g",{strokeWidth:"1.25",children:[g("path",{d:"M13.542 8.542H6.458a2.5 2.5 0 0 0-2.5 2.5v3.75a2.5 2.5 0 0 0 2.5 2.5h7.084a2.5 2.5 0 0 0 2.5-2.5v-3.75a2.5 2.5 0 0 0-2.5-2.5Z"}),g("path",{d:"M10 13.958a1.042 1.042 0 1 0 0-2.083 1.042 1.042 0 0 0 0 2.083Z"}),g("path",{d:"M6.667 8.333V5.417C6.667 3.806 8.159 2.5 10 2.5c1.841 0 3.333 1.306 3.333 2.917v2.916"})]}),Fe),tee=Q(M(ge,{children:[g("path",{d:"M38.5 83.5c-14-2-17.833-10.473-21-22.5C14.333 48.984 12 22 12 12.5",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round"}),g("path",{fillRule:"evenodd",clipRule:"evenodd",d:"m12.005 10.478 7.905 14.423L6 25.75l6.005-15.273Z",fill:"currentColor"}),g("path",{d:"M12.005 10.478c1.92 3.495 3.838 7 7.905 14.423m-7.905-14.423c3.11 5.683 6.23 11.368 7.905 14.423m0 0c-3.68.226-7.35.455-13.91.85m13.91-.85c-5.279.33-10.566.647-13.91.85m0 0c1.936-4.931 3.882-9.86 6.005-15.273M6 25.75c2.069-5.257 4.135-10.505 6.005-15.272",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round"})]}),{width:41,height:94,fill:"none"}),nee=Q(M(ge,{children:[g("path",{d:"M18.026 1.232c-5.268 13.125-5.548 33.555 3.285 42.311 8.823 8.75 33.31 12.304 42.422 13.523",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round"}),g("path",{fillRule:"evenodd",clipRule:"evenodd",d:"m72.181 59.247-13.058-10-2.948 13.62 16.006-3.62Z",fill:"currentColor"}),g("path",{d:"M72.181 59.247c-3.163-2.429-6.337-4.856-13.058-10m13.058 10c-5.145-3.936-10.292-7.882-13.058-10m0 0c-.78 3.603-1.563 7.196-2.948 13.62m2.948-13.62c-1.126 5.168-2.24 10.346-2.948 13.62m0 0c5.168-1.166 10.334-2.343 16.006-3.62m-16.006 3.62c5.51-1.248 11.01-2.495 16.006-3.62",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round"})]}),{width:85,height:71,fill:"none"}),ree=Q(M(ge,{children:[g("path",{d:"M1 77c14-2 31.833-11.973 35-24 3.167-12.016-6-35-9.5-43.5",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round"}),g("path",{fillRule:"evenodd",clipRule:"evenodd",d:"m24.165 1.093-2.132 16.309 13.27-4.258-11.138-12.05Z",fill:"currentColor"}),g("path",{d:"M24.165 1.093c-.522 3.953-1.037 7.916-2.132 16.309m2.131-16.309c-.835 6.424-1.68 12.854-2.13 16.308m0 0c3.51-1.125 7.013-2.243 13.27-4.257m-13.27 4.257c5.038-1.608 10.08-3.232 13.27-4.257m0 0c-3.595-3.892-7.197-7.777-11.14-12.05m11.14 12.05c-3.837-4.148-7.667-8.287-11.14-12.05",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round"})]}),{width:38,height:78,fill:"none"});Q(g("g",{fill:"currentColor",children:g("path",{d:"M39.9 32.889a.326.326 0 0 0-.279-.056c-2.094-3.083-4.774-6-7.343-8.833l-.419-.472a.212.212 0 0 0-.056-.139.586.586 0 0 0-.167-.111l-.084-.083-.056-.056c-.084-.167-.28-.278-.475-.167-.782.39-1.507.973-2.206 1.528-.92.722-1.842 1.445-2.708 2.25a8.405 8.405 0 0 0-.977 1.028c-.14.194-.028.361.14.444-.615.611-1.23 1.223-1.843 1.861a.315.315 0 0 0-.084.223c0 .083.056.166.111.194l1.09.833v.028c1.535 1.528 4.244 3.611 7.12 5.861.418.334.865.667 1.284 1 .195.223.39.473.558.695.084.11.28.139.391.055.056.056.14.111.196.167a.398.398 0 0 0 .167.056.255.255 0 0 0 .224-.111.394.394 0 0 0 .055-.167c.029 0 .028.028.056.028a.318.318 0 0 0 .224-.084l5.082-5.528a.309.309 0 0 0 0-.444Zm-14.63-1.917a.485.485 0 0 0 .111.14c.586.5 1.2 1 1.843 1.555l-2.569-1.945-.251-.166c-.056-.028-.112-.084-.168-.111l-.195-.167.056-.056.055-.055.112-.111c.866-.861 2.346-2.306 3.1-3.028-.81.805-2.43 3.167-2.095 3.944Zm8.767 6.89-2.122-1.612a44.713 44.713 0 0 0-2.625-2.5c1.145.861 2.122 1.611 2.262 1.75 1.117.972 1.06.806 1.815 1.445l.921.666a1.06 1.06 0 0 1-.251.25Zm.558.416-.056-.028c.084-.055.168-.111.252-.194l-.196.222ZM1.089 5.75c.055.361.14.722.195 1.056.335 1.833.67 3.5 1.284 4.75l.252.944c.084.361.223.806.363.917 1.424 1.25 3.602 3.11 5.947 4.889a.295.295 0 0 0 .363 0s0 .027.028.027a.254.254 0 0 0 .196.084.318.318 0 0 0 .223-.084c2.988-3.305 5.221-6.027 6.813-8.305.112-.111.14-.278.14-.417.111-.111.195-.25.307-.333.111-.111.111-.306 0-.39l-.028-.027c0-.055-.028-.139-.084-.167-.698-.666-1.2-1.138-1.731-1.638-.922-.862-1.871-1.75-3.881-3.75l-.028-.028c-.028-.028-.056-.056-.112-.056-.558-.194-1.703-.389-3.127-.639C6.087 2.223 3.21 1.723.614.944c0 0-.168 0-.196.028l-.083.084c-.028.027-.056.055-.224.11h.056-.056c.028.167.028.278.084.473 0 .055.112.5.112.555l.782 3.556Zm15.496 3.278-.335-.334c.084.112.196.195.335.334Zm-3.546 4.666-.056.056c0-.028.028-.056.056-.056Zm-2.038-10c.168.167.866.834 1.033.973-.726-.334-2.54-1.167-3.379-1.445.838.167 1.983.334 2.346.472ZM1.424 2.306c.419.722.754 3.222 1.089 5.666-.196-.778-.335-1.555-.503-2.278-.251-1.277-.503-2.416-.838-3.416.056 0 .14 0 .252.028Zm-.168-.584c-.112 0-.223-.028-.307-.028 0-.027 0-.055-.028-.055.14 0 .223.028.335.083Zm-1.089.222c0-.027 0-.027 0 0ZM39.453 1.333c.028-.11-.558-.61-.363-.639.42-.027.42-.666 0-.666-.558.028-1.144.166-1.675.25-.977.194-1.982.389-2.96.61-2.205.473-4.383.973-6.561 1.557-.67.194-1.424.333-2.066.666-.224.111-.196.333-.084.472-.056.028-.084.028-.14.056-.195.028-.363.056-.558.083-.168.028-.252.167-.224.334 0 .027.028.083.028.11-1.173 1.556-2.485 3.195-3.909 4.945-1.396 1.611-2.876 3.306-4.356 5.056-4.719 5.5-10.052 11.75-15.943 17.25a.268.268 0 0 0 0 .389c.028.027.056.055.084.055-.084.084-.168.14-.252.222-.056.056-.084.111-.084.167a.605.605 0 0 0-.111.139c-.112.111-.112.305.028.389.111.11.307.11.39-.028.029-.028.029-.056.056-.056a.44.44 0 0 1 .615 0c.335.362.67.723.977 1.028l-.698-.583c-.112-.111-.307-.083-.39.028-.113.11-.085.305.027.389l7.427 6.194c.056.056.112.056.196.056s.14-.028.195-.084l.168-.166c.028.027.083.027.111.027.084 0 .14-.027.196-.083 10.052-10.055 18.15-17.639 27.42-24.417.083-.055.111-.166.111-.25.112 0 .196-.083.251-.194 1.704-5.194 2.039-9.806 2.15-12.083v-.028c0-.028.028-.056.028-.083.028-.056.028-.084.028-.084a1.626 1.626 0 0 0-.111-1.028ZM21.472 9.5c.446-.5.893-1.028 1.34-1.5-2.876 3.778-7.65 9.583-14.408 16.5 4.607-5.083 9.242-10.333 13.068-15ZM5.193 35.778h.084-.084Zm3.462 3.194c-.027-.028-.027-.028 0-.028v.028Zm4.16-3.583c.224-.25.448-.472.699-.722 0 0 0 .027.028.027-.252.223-.475.445-.726.695Zm1.146-1.111c.14-.14.279-.334.446-.5l.028-.028c1.648-1.694 3.351-3.389 5.082-5.111l.028-.028c.419-.333.921-.694 1.368-1.028a379.003 379.003 0 0 0-6.952 6.695ZM24.794 6.472c-.921 1.195-1.954 2.778-2.82 4.028-2.736 3.944-11.532 13.583-11.727 13.75a1976.983 1976.983 0 0 1-8.042 7.639l-.167.167c-.14-.167-.14-.417.028-.556C14.49 19.861 22.03 10.167 25.074 5.917c-.084.194-.14.36-.28.555Zm4.83 5.695c-1.116-.64-1.646-1.64-1.34-2.611l.084-.334c.028-.083.084-.194.14-.277.307-.5.754-.917 1.257-1.167.027 0 .055 0 .083-.028-.028-.056-.028-.139-.028-.222.028-.167.14-.278.335-.278.335 0 1.369.306 1.76.639.111.083.223.194.335.305.14.167.363.445.474.667.056.028.112.306.196.445.056.222.111.472.084.694-.028.028 0 .194-.028.194a2.668 2.668 0 0 1-.363 1.028c-.028.028-.028.056-.056.084l-.028.027c-.14.223-.335.417-.53.556-.643.444-1.369.583-2.095.389 0 0-.195-.084-.28-.111Zm8.154-.834a39.098 39.098 0 0 1-.893 3.167c0 .028-.028.083 0 .111-.056 0-.084.028-.14.056-2.206 1.61-4.356 3.305-6.506 5.028 1.843-1.64 3.686-3.306 5.613-4.945.558-.5.949-1.139 1.06-1.861l.28-1.667v-.055c.14-.334.67-.195.586.166Z",fill:"currentColor"})}),{width:40,height:40,fill:"none"});const iee=Q(M("g",{stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M6 6l4.153 11.793a0.365 .365 0 0 0 .331 .207a0.366 .366 0 0 0 .332 -.207l2.184 -4.793l4.787 -1.994a0.355 .355 0 0 0 .213 -.323a0.355 .355 0 0 0 -.213 -.323l-11.787 -4.36z"}),g("path",{d:"M13.5 13.5l4.5 4.5"})]}),{fill:"none",width:22,height:22,strokeWidth:1.25}),see=Q(M("g",{strokeWidth:"1.5",children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("rect",{x:"4",y:"4",width:"16",height:"16",rx:"2"})]}),je),oee=Q(M("g",{strokeWidth:"1.5",children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M10.5 20.4l-6.9 -6.9c-.781 -.781 -.781 -2.219 0 -3l6.9 -6.9c.781 -.781 2.219 -.781 3 0l6.9 6.9c.781 .781 .781 2.219 0 3l-6.9 6.9c-.781 .781 -2.219 .781 -3 0z"})]}),je),aee=Q(M("g",{strokeWidth:"1.5",children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("circle",{cx:"12",cy:"12",r:"9"})]}),je),lee=Q(M("g",{strokeWidth:"1.5",children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("line",{x1:"5",y1:"12",x2:"19",y2:"12"}),g("line",{x1:"15",y1:"16",x2:"19",y2:"12"}),g("line",{x1:"15",y1:"8",x2:"19",y2:"12"})]}),je),cee=Q(g("path",{d:"M4.167 10h11.666",strokeWidth:"1.5"}),Fe),uee=Q(M("g",{strokeWidth:"1.25",children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M20 17v-12c0 -1.121 -.879 -2 -2 -2s-2 .879 -2 2v12l2 2l2 -2z"}),g("path",{d:"M16 7h4"}),g("path",{d:"M18 19h-13a2 2 0 1 1 0 -4h4a2 2 0 1 0 0 -4h-3"})]}),je),pS=Q(M("g",{strokeWidth:"1.25",children:[g("path",{clipRule:"evenodd",d:"m7.643 15.69 7.774-7.773a2.357 2.357 0 1 0-3.334-3.334L4.31 12.357a3.333 3.333 0 0 0-.977 2.357v1.953h1.953c.884 0 1.732-.352 2.357-.977Z"}),g("path",{d:"m11.25 5.417 3.333 3.333"})]}),Fe),dee=Q(M("g",{strokeWidth:"1.5",children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("line",{x1:"4",y1:"20",x2:"7",y2:"20"}),g("line",{x1:"14",y1:"20",x2:"21",y2:"20"}),g("line",{x1:"6.9",y1:"15",x2:"13.8",y2:"15"}),g("line",{x1:"10.2",y1:"6.3",x2:"16",y2:"20"}),g("polyline",{points:"5 20 11 4 13 4 20 20"})]}),je),hee=Q(M("g",{strokeWidth:"1.25",children:[g("path",{d:"M12.5 6.667h.01"}),g("path",{d:"M4.91 2.625h10.18a2.284 2.284 0 0 1 2.285 2.284v10.182a2.284 2.284 0 0 1-2.284 2.284H4.909a2.284 2.284 0 0 1-2.284-2.284V4.909a2.284 2.284 0 0 1 2.284-2.284Z"}),g("path",{d:"m3.333 12.5 3.334-3.333c.773-.745 1.726-.745 2.5 0l4.166 4.166"}),g("path",{d:"m11.667 11.667.833-.834c.774-.744 1.726-.744 2.5 0l1.667 1.667"})]}),Fe),fee=Q(M("g",{strokeWidth:"1.5",children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M19 20h-10.5l-4.21 -4.3a1 1 0 0 1 0 -1.41l10 -10a1 1 0 0 1 1.41 0l5 5a1 1 0 0 1 0 1.41l-9.2 9.3"}),g("path",{d:"M18 13.3l-6.3 -6.3"})]}),je),pee=Q(g("path",{strokeWidth:"1.25",d:"M10 4.167v11.666M4.167 10h11.666"}),Fe),mee=Q(g("path",{d:"M5 10h10",strokeWidth:"1.25"}),Fe),Gv=Q(g("path",{strokeWidth:"1.25",d:"M3.333 5.833h13.334M8.333 9.167v5M11.667 9.167v5M4.167 5.833l.833 10c0 .92.746 1.667 1.667 1.667h6.666c.92 0 1.667-.746 1.667-1.667l.833-10M7.5 5.833v-2.5c0-.46.373-.833.833-.833h3.334c.46 0 .833.373.833.833v2.5"}),Fe),gee=Q(M("g",{strokeWidth:"1.25",children:[g("polyline",{points:"12 16 18 10 12 4"}),g("polyline",{points:"8 4 2 10 8 16"})]}),Fe),yee=Q(M("g",{strokeWidth:"1.25",children:[g("path",{d:"M14.375 6.458H8.958a2.5 2.5 0 0 0-2.5 2.5v5.417a2.5 2.5 0 0 0 2.5 2.5h5.417a2.5 2.5 0 0 0 2.5-2.5V8.958a2.5 2.5 0 0 0-2.5-2.5Z"}),g("path",{clipRule:"evenodd",d:"M11.667 3.125c.517 0 .986.21 1.325.55.34.338.55.807.55 1.325v1.458H8.333c-.485 0-.927.185-1.26.487-.343.312-.57.75-.609 1.24l-.005 5.357H5a1.87 1.87 0 0 1-1.326-.55 1.87 1.87 0 0 1-.549-1.325V5c0-.518.21-.987.55-1.326.338-.34.807-.549 1.325-.549h6.667Z"})]}),Fe),vee=Q(g("path",{clipRule:"evenodd",d:"M10 2.5h.328a6.25 6.25 0 0 0 6.6 10.372A7.5 7.5 0 1 1 10 2.493V2.5Z",stroke:"currentColor"}),Fe),bee=Q(g("g",{stroke:"currentColor",strokeWidth:"1.25",strokeLinecap:"round",strokeLinejoin:"round",children:g("path",{d:"M10 12.5a2.5 2.5 0 1 0 0-5 2.5 2.5 0 0 0 0 5ZM10 4.167V2.5M14.167 5.833l1.166-1.166M15.833 10H17.5M14.167 14.167l1.166 1.166M10 15.833V17.5M5.833 14.167l-1.166 1.166M5 10H3.333M5.833 5.833 4.667 4.667"})}),Fe),YO=Q(M("g",{strokeWidth:"1.5",children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("line",{x1:"4",y1:"6",x2:"20",y2:"6"}),g("line",{x1:"4",y1:"12",x2:"20",y2:"12"}),g("line",{x1:"4",y1:"18",x2:"20",y2:"18"})]}),je),ZO=Q(g("path",{strokeWidth:"1.25",d:"M3.333 14.167v1.666c0 .92.747 1.667 1.667 1.667h10c.92 0 1.667-.746 1.667-1.667v-1.666M5.833 9.167 10 13.333l4.167-4.166M10 3.333v10"}),Fe),mS=Q(M("g",{strokeWidth:"1.5",children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("circle",{cx:"12",cy:"12",r:"9"}),g("line",{x1:"12",y1:"17",x2:"12",y2:"17.01"}),g("path",{d:"M12 13.5a1.5 1.5 0 0 1 1 -1.5a2.6 2.6 0 1 0 -3 -4"})]}),je),i_=Q(g("path",{strokeWidth:"1.25",d:"M9.167 5.833H5.833c-1.254 0-2.5 1.282-2.5 2.5v5.834c0 1.283 1.252 2.5 2.5 2.5h5.834c1.251 0 2.5-1.25 2.5-2.5v-3.334M8.333 11.667l8.334-8.334M12.5 3.333h4.167V7.5"}),Fe),_ee=Q(g("path",{d:"M7.5 15.833c-3.583 1.167-3.583-2.083-5-2.5m10 4.167v-2.917c0-.833.083-1.166-.417-1.666 2.334-.25 4.584-1.167 4.584-5a3.833 3.833 0 0 0-1.084-2.667 3.5 3.5 0 0 0-.083-2.667s-.917-.25-2.917 1.084a10.25 10.25 0 0 0-5.166 0C5.417 2.333 4.5 2.583 4.5 2.583a3.5 3.5 0 0 0-.083 2.667 3.833 3.833 0 0 0-1.084 2.667c0 3.833 2.25 4.75 4.584 5-.5.5-.5 1-.417 1.666V17.5",strokeWidth:"1.25"}),Fe),Eee=Q(M("g",{strokeWidth:"1.25",children:[g("path",{d:"M7.5 10.833a.833.833 0 1 0 0-1.666.833.833 0 0 0 0 1.666ZM12.5 10.833a.833.833 0 1 0 0-1.666.833.833 0 0 0 0 1.666ZM6.25 6.25c2.917-.833 4.583-.833 7.5 0M5.833 13.75c2.917.833 5.417.833 8.334 0"}),g("path",{d:"M12.917 14.167c0 .833 1.25 2.5 1.666 2.5 1.25 0 2.361-1.39 2.917-2.5.556-1.39.417-4.861-1.25-9.584-1.214-.846-2.5-1.116-3.75-1.25l-.833 2.084M7.083 14.167c0 .833-1.13 2.5-1.526 2.5-1.191 0-2.249-1.39-2.778-2.5-.529-1.39-.397-4.861 1.19-9.584 1.157-.846 2.318-1.116 3.531-1.25l.833 2.084"})]}),Fe),wee=Q(M("g",{strokeWidth:"1.25",children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M22 4.01c-1 .49 -1.98 .689 -3 .99c-1.121 -1.265 -2.783 -1.335 -4.38 -.737s-2.643 2.06 -2.62 3.737v1c-3.245 .083 -6.135 -1.395 -8 -4c0 0 -4.182 7.433 4 11c-1.872 1.247 -3.739 2.088 -6 2c3.308 1.803 6.913 2.423 10.034 1.517c3.58 -1.04 6.522 -3.723 7.651 -7.742a13.84 13.84 0 0 0 .497 -3.753c-.002 -.249 1.51 -2.772 1.818 -4.013z"})]}),je),xee=Q(g("polyline",{fill:"none",stroke:"currentColor",points:"20 6 9 17 4 12"}),{width:24,height:24}),KO=Q(M("g",{strokeWidth:"1.25",children:[g("path",{d:"M8.333 11.667a2.917 2.917 0 0 0 4.167 0l3.333-3.334a2.946 2.946 0 1 0-4.166-4.166l-.417.416"}),g("path",{d:"M11.667 8.333a2.917 2.917 0 0 0-4.167 0l-3.333 3.334a2.946 2.946 0 0 0 4.166 4.166l.417-.416"})]}),Fe),Tee=Q("M433.941 129.941l-83.882-83.882A48 48 0 0 0 316.118 32H48C21.49 32 0 53.49 0 80v352c0 26.51 21.49 48 48 48h352c26.51 0 48-21.49 48-48V163.882a48 48 0 0 0-14.059-33.941zM224 416c-35.346 0-64-28.654-64-64 0-35.346 28.654-64 64-64s64 28.654 64 64c0 35.346-28.654 64-64 64zm96-304.52V212c0 6.627-5.373 12-12 12H76c-6.627 0-12-5.373-12-12V108c0-6.627 5.373-12 12-12h228.52c3.183 0 6.235 1.264 8.485 3.515l3.48 3.48A11.996 11.996 0 0 1 320 111.48z",{width:448,height:512}),See=Q("M252 54L203 8a28 27 0 00-20-8H28C12 0 0 12 0 27v195c0 15 12 26 28 26h204c15 0 28-11 28-26V73a28 27 0 00-8-19zM130 213c-21 0-37-16-37-36 0-19 16-35 37-35 20 0 37 16 37 35 0 20-17 36-37 36zm56-169v56c0 4-4 6-7 6H44c-4 0-7-2-7-6V42c0-4 3-7 7-7h133l4 2 3 2a7 7 0 012 5z M296 201l87 95-188 205-78 9c-10 1-19-8-18-20l9-84zm141-14l-41-44a31 31 0 00-46 0l-38 41 87 95 38-42c13-14 13-36 0-50z",{width:448,height:512}),gS=Q(g("path",{d:"m9.257 6.351.183.183H15.819c.34 0 .727.182 1.051.506.323.323.505.708.505 1.05v5.819c0 .316-.183.7-.52 1.035-.337.338-.723.522-1.037.522H4.182c-.352 0-.74-.181-1.058-.5-.318-.318-.499-.705-.499-1.057V5.182c0-.351.181-.736.5-1.054.32-.321.71-.503 1.057-.503H6.53l2.726 2.726Z",strokeWidth:"1.25"}),Fe);Q("M384 112v352c0 26.51-21.49 48-48 48H48c-26.51 0-48-21.49-48-48V112c0-26.51 21.49-48 48-48h80c0-35.29 28.71-64 64-64s64 28.71 64 64h80c26.51 0 48 21.49 48 48zM192 40c-13.255 0-24 10.745-24 24s10.745 24 24 24 24-10.745 24-24-10.745-24-24-24m96 114v-20a6 6 0 0 0-6-6H102a6 6 0 0 0-6 6v20a6 6 0 0 0 6 6h180a6 6 0 0 0 6-6z",{width:384,height:512});const Cee=Q("M204.3 5C104.9 24.4 24.8 104.3 5.2 203.4c-37 187 131.7 326.4 258.8 306.7 41.2-6.4 61.4-54.6 42.5-91.7-23.1-45.4 9.9-98.4 60.9-98.4h79.7c35.8 0 64.8-29.6 64.9-65.3C511.5 97.1 368.1-26.9 204.3 5zM96 320c-17.7 0-32-14.3-32-32s14.3-32 32-32 32 14.3 32 32-14.3 32-32 32zm32-128c-17.7 0-32-14.3-32-32s14.3-32 32-32 32 14.3 32 32-14.3 32-32 32zm128-64c-17.7 0-32-14.3-32-32s14.3-32 32-32 32 14.3 32 32-14.3 32-32 32zm128 64c-17.7 0-32-14.3-32-32s14.3-32 32-32 32 14.3 32 32-14.3 32-32 32z"),Iee=Q(M("g",{strokeWidth:"1.25",children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M15 8h.01"}),g("path",{d:"M12 20h-5a3 3 0 0 1 -3 -3v-10a3 3 0 0 1 3 -3h10a3 3 0 0 1 3 3v5"}),g("path",{d:"M4 15l4 -4c.928 -.893 2.072 -.893 3 0l4 4"}),g("path",{d:"M14 14l1 -1c.617 -.593 1.328 -.793 2.009 -.598"}),g("path",{d:"M19 16v6"}),g("path",{d:"M22 19l-3 3l-3 -3"})]}),je),Aee=Q("M216 0h80c13.3 0 24 10.7 24 24v168h87.7c17.8 0 26.7 21.5 14.1 34.1L269.7 378.3c-7.5 7.5-19.8 7.5-27.3 0L90.1 226.1c-12.6-12.6-3.7-34.1 14.1-34.1H192V24c0-13.3 10.7-24 24-24zm296 376v112c0 13.3-10.7 24-24 24H24c-13.3 0-24-10.7-24-24V376c0-13.3 10.7-24 24-24h146.7l49 49c20.1 20.1 52.5 20.1 72.6 0l49-49H488c13.3 0 24 10.7 24 24zm-124 88c0-11-9-20-20-20s-20 9-20 20 9 20 20 20 20-9 20-20zm64 0c0-11-9-20-20-20s-20 9-20 20 9 20 20 20 20-9 20-20z",{width:512,height:512});Q("M416 208H272V64c0-17.67-14.33-32-32-32h-32c-17.67 0-32 14.33-32 32v144H32c-17.67 0-32 14.33-32 32v32c0 17.67 14.33 32 32 32h144v144c0 17.67 14.33 32 32 32h32c17.67 0 32-14.33 32-32V304h144c17.67 0 32-14.33 32-32v-32c0-17.67-14.33-32-32-32z",{width:448,height:512});Q("M416 208H32c-17.67 0-32 14.33-32 32v32c0 17.67 14.33 32 32 32h384c17.67 0 32-14.33 32-32v-32c0-17.67-14.33-32-32-32z",{width:448,height:512});const kee=Q("M173.898 439.404l-166.4-166.4c-9.997-9.997-9.997-26.206 0-36.204l36.203-36.204c9.997-9.998 26.207-9.998 36.204 0L192 312.69 432.095 72.596c9.997-9.997 26.207-9.997 36.204 0l36.203 36.204c9.997 9.997 9.997 26.206 0 36.204l-294.4 294.401c-9.998 9.997-26.207 9.997-36.204-.001z");Q("M16 132h416c8.837 0 16-7.163 16-16V76c0-8.837-7.163-16-16-16H16C7.163 60 0 67.163 0 76v40c0 8.837 7.163 16 16 16zm0 160h416c8.837 0 16-7.163 16-16v-40c0-8.837-7.163-16-16-16H16c-8.837 0-16 7.163-16 16v40c0 8.837 7.163 16 16 16zm0 160h416c8.837 0 16-7.163 16-16v-40c0-8.837-7.163-16-16-16H16c-8.837 0-16 7.163-16 16v40c0 8.837 7.163 16 16 16z");const Mee=Q(g("path",{d:"M7.5 10.833 4.167 7.5 7.5 4.167M4.167 7.5h9.166a3.333 3.333 0 0 1 0 6.667H12.5",strokeWidth:"1.25"}),Fe),Pee=Q(g("path",{d:"M12.5 10.833 15.833 7.5 12.5 4.167M15.833 7.5H6.667a3.333 3.333 0 1 0 0 6.667H7.5",strokeWidth:"1.25"}),Fe),Lee=Q("M504 256c0 136.997-111.043 248-248 248S8 392.997 8 256C8 119.083 119.043 8 256 8s248 111.083 248 248zM262.655 90c-54.497 0-89.255 22.957-116.549 63.758-3.536 5.286-2.353 12.415 2.715 16.258l34.699 26.31c5.205 3.947 12.621 3.008 16.665-2.122 17.864-22.658 30.113-35.797 57.303-35.797 20.429 0 45.698 13.148 45.698 32.958 0 14.976-12.363 22.667-32.534 33.976C247.128 238.528 216 254.941 216 296v4c0 6.627 5.373 12 12 12h56c6.627 0 12-5.373 12-12v-1.333c0-28.462 83.186-29.647 83.186-106.667 0-58.002-60.165-102-116.531-102zM256 338c-25.365 0-46 20.635-46 46 0 25.364 20.635 46 46 46s46-20.636 46-46c0-25.365-20.635-46-46-46z",{mirror:!0}),Ree=Q(g("path",{d:"M5 12.5a2.5 2.5 0 1 0 0-5 2.5 2.5 0 0 0 0 5ZM15 7.5a2.5 2.5 0 1 0 0-5 2.5 2.5 0 0 0 0 5ZM15 17.5a2.5 2.5 0 1 0 0-5 2.5 2.5 0 0 0 0 5ZM7.25 8.917l5.5-2.834M7.25 11.083l5.5 2.834",strokeWidth:"1.5"}),Fe),Oee=Q("M16 5l-1.42 1.42-1.59-1.59V16h-1.98V4.83L9.42 6.42 8 5l4-4 4 4zm4 5v11c0 1.1-.9 2-2 2H6c-1.11 0-2-.9-2-2V10c0-1.11.89-2 2-2h3v2H6v11h12V10h-3V8h3c1.1 0 2 .89 2 2z",{width:24,height:24}),Dee=Q(M(ge,{children:[g("path",{fill:"currentColor",d:"M40 5.6v6.1l-4.1.7c-8.9 1.4-16.5 6.9-20.6 15C13 32 10.9 43 12.4 43c.4 0 2.4-1.3 4.4-3 5-3.9 12.1-7 18.2-7.7l5-.6v12.8l11.2-11.3L62.5 22 51.2 10.8 40-.5v6.1zm10.2 22.6L44 34.5v-6.8l-6.9.6c-3.9.3-9.8 1.7-13.2 3.1-3.5 1.4-6.5 2.4-6.7 2.2-.9-1 3-7.5 6.4-10.8C28 18.6 34.4 16 40.1 16c3.7 0 3.9-.1 3.9-3.2V9.5l6.2 6.3 6.3 6.2-6.3 6.2z"}),g("path",{stroke:"currentColor",fill:"currentColor",d:"M0 36v20h48v-6.2c0-6 0-6.1-2-4.3-1.1 1-2 2.9-2 4.2V52H4V34c0-17.3-.1-18-2-18s-2 .7-2 20z"})]}),{width:64,height:64});Q(g("path",{stroke:"currentColor",strokeWidth:"40",fill:"currentColor",d:"M148 560a318 318 0 0 0 522 110 316 316 0 0 0 0-450 316 316 0 0 0-450 0c-11 11-21 22-30 34v4h47c25 0 46 21 46 46s-21 45-46 45H90c-13 0-25-6-33-14-9-9-14-20-14-33V156c0-25 20-45 45-45s45 20 45 45v32l1 1a401 401 0 0 1 623 509l212 212a42 42 0 0 1-59 59L698 757A401 401 0 0 1 65 570a42 42 0 0 1 83-10z"}),{width:1024});const Nee=Q(M(ge,{children:[M("g",{clipPath:"url(#a)",stroke:"currentColor",strokeWidth:"1.25",strokeLinecap:"round",strokeLinejoin:"round",children:[g("path",{d:"M13.889 4.167H8.333c-.767 0-1.389.622-1.389 1.389v5.555c0 .767.622 1.389 1.39 1.389h5.555c.767 0 1.389-.622 1.389-1.389V5.556c0-.767-.622-1.39-1.39-1.39Z",fill:"currentColor"}),g("path",{d:"M12.5 12.5v1.389a1.389 1.389 0 0 1-1.389 1.389H5.556a1.389 1.389 0 0 1-1.39-1.39V8.334a1.389 1.389 0 0 1 1.39-1.389h1.388"})]}),g("defs",{children:g("clipPath",{id:"a",children:g("path",{fill:"#fff",d:"M0 0h20v20H0z"})})})]}),Fe),Fee=Q(M(ge,{children:[M("g",{clipPath:"url(#a)",stroke:"currentColor",strokeWidth:"1.25",strokeLinecap:"round",strokeLinejoin:"round",children:[g("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M6.944 12.5H12.5v1.389a1.389 1.389 0 0 1-1.389 1.389H5.556a1.389 1.389 0 0 1-1.39-1.39V8.334a1.389 1.389 0 0 1 1.39-1.389h1.388",fill:"currentColor"}),g("path",{d:"M13.889 4.167H8.333c-.767 0-1.389.621-1.389 1.389v5.555c0 .767.622 1.389 1.39 1.389h5.555c.767 0 1.389-.622 1.389-1.389V5.556c0-.768-.622-1.39-1.39-1.39Z"})]}),g("defs",{children:g("clipPath",{id:"a",children:g("path",{fill:"#fff",d:"M0 0h20v20H0z"})})})]}),Fe),Bee=Q(M(ge,{children:[M("g",{clipPath:"url(#a)",stroke:"currentColor",strokeWidth:"1.25",children:[g("path",{d:"M8.775 6.458h2.45a2.316 2.316 0 0 1 2.317 2.316v2.452a2.316 2.316 0 0 1-2.316 2.316H8.774a2.316 2.316 0 0 1-2.317-2.316V8.774a2.316 2.316 0 0 1 2.317-2.316Z",fill:"currentColor"}),g("path",{d:"M5.441 9.792h2.451a2.316 2.316 0 0 1 2.316 2.316v2.45a2.316 2.316 0 0 1-2.316 2.317h-2.45a2.316 2.316 0 0 1-2.317-2.316v-2.451a2.316 2.316 0 0 1 2.316-2.316ZM12.108 3.125h2.45a2.316 2.316 0 0 1 2.317 2.316v2.451a2.316 2.316 0 0 1-2.316 2.316h-2.451a2.316 2.316 0 0 1-2.316-2.316v-2.45a2.316 2.316 0 0 1 2.316-2.317Z"})]}),g("defs",{children:g("clipPath",{id:"a",children:g("path",{fill:"#fff",d:"M0 0h20v20H0z"})})})]}),Fe),Uee=Q(M(ge,{children:[M("g",{clipPath:"url(#a)",children:[g("path",{d:"M5.441 9.792h2.451a2.316 2.316 0 0 1 2.316 2.316v2.45a2.316 2.316 0 0 1-2.316 2.317h-2.45a2.316 2.316 0 0 1-2.317-2.316v-2.451a2.316 2.316 0 0 1 2.316-2.316Z",stroke:"currentColor",strokeWidth:"1.25"}),g("path",{d:"M5.441 9.792h2.451a2.316 2.316 0 0 1 2.316 2.316v2.45a2.316 2.316 0 0 1-2.316 2.317h-2.45a2.316 2.316 0 0 1-2.317-2.316v-2.451a2.316 2.316 0 0 1 2.316-2.316Z",stroke:"currentColor",strokeWidth:"1.25"}),g("mask",{id:"SendToBackIcon",fill:"#fff",children:g("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M9.167 5.833v2.06a2.941 2.941 0 0 0 2.94 2.94h2.06v.393a2.941 2.941 0 0 1-2.941 2.94h-.393v-2.058a2.941 2.941 0 0 0-2.94-2.941h-2.06v-.393a2.941 2.941 0 0 1 2.942-2.94h.392Z"})}),g("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M9.167 5.833v2.06a2.941 2.941 0 0 0 2.94 2.94h2.06v.393a2.941 2.941 0 0 1-2.941 2.94h-.393v-2.058a2.941 2.941 0 0 0-2.94-2.941h-2.06v-.393a2.941 2.941 0 0 1 2.942-2.94h.392Z",fill:"currentColor"}),g("path",{d:"M9.167 5.833h1.25v-1.25h-1.25v1.25Zm5 5h1.25v-1.25h-1.25v1.25Zm-3.334 3.334h-1.25v1.25h1.25v-1.25Zm-5-5h-1.25v1.25h1.25v-1.25Zm2.084-3.334v2.06h2.5v-2.06h-2.5Zm0 2.06a4.191 4.191 0 0 0 4.19 4.19v-2.5a1.691 1.691 0 0 1-1.69-1.69h-2.5Zm4.19 4.19h2.06v-2.5h-2.06v2.5Zm.81-1.25v.393h2.5v-.393h-2.5Zm0 .393c0 .933-.758 1.69-1.691 1.69v2.5a4.191 4.191 0 0 0 4.19-4.19h-2.5Zm-1.691 1.69h-.393v2.5h.393v-2.5Zm.857 1.25v-2.058h-2.5v2.059h2.5Zm0-2.058a4.191 4.191 0 0 0-4.19-4.191v2.5c.933 0 1.69.757 1.69 1.69h2.5Zm-4.19-4.191h-2.06v2.5h2.06v-2.5Zm-.81 1.25v-.393h-2.5v.393h2.5Zm0-.393c0-.934.758-1.69 1.692-1.69v-2.5a4.191 4.191 0 0 0-4.192 4.19h2.5Zm1.692-1.69h.392v-2.5h-.392v2.5Z",fill:"currentColor",mask:"url(#SendToBackIcon)"}),g("path",{d:"M12.108 3.125h2.45a2.316 2.316 0 0 1 2.317 2.316v2.451a2.316 2.316 0 0 1-2.316 2.316h-2.451a2.316 2.316 0 0 1-2.316-2.316v-2.45a2.316 2.316 0 0 1 2.316-2.317Z",stroke:"currentColor",strokeWidth:"1.25"})]}),g("defs",{children:g("clipPath",{id:"a",children:g("path",{fill:"#fff",d:"M0 0h20v20H0z"})})})]}),Fe),$ee=Q(M(ge,{children:[M("g",{clipPath:"url(#a)",stroke:"currentColor",strokeWidth:"1.25",children:[g("path",{d:"M3.333 3.333h13.334",strokeLinecap:"round",strokeLinejoin:"round"}),g("path",{d:"M13.542 6.458h-.417c-.92 0-1.667.747-1.667 1.667v7.083c0 .92.746 1.667 1.667 1.667h.417c.92 0 1.666-.746 1.666-1.667V8.125c0-.92-.746-1.667-1.666-1.667ZM6.875 6.458h-.417c-.92 0-1.666.747-1.666 1.667v3.75c0 .92.746 1.667 1.666 1.667h.417c.92 0 1.667-.746 1.667-1.667v-3.75c0-.92-.747-1.667-1.667-1.667Z"})]}),g("defs",{children:g("clipPath",{id:"a",children:g("path",{fill:"#fff",d:"M0 0h20v20H0z"})})})]}),Fe),Hee=Q(M(ge,{children:[M("g",{clipPath:"url(#a)",stroke:"currentColor",strokeWidth:"1.25",children:[g("path",{d:"M3.333 16.667h13.334",strokeLinecap:"round",strokeLinejoin:"round"}),g("path",{d:"M6.875 3.125h-.417c-.92 0-1.666.746-1.666 1.667v7.083c0 .92.746 1.667 1.666 1.667h.417c.92 0 1.667-.746 1.667-1.667V4.792c0-.92-.747-1.667-1.667-1.667ZM13.542 5.817h-.417c-.92 0-1.667.747-1.667 1.667v4.391c0 .92.746 1.667 1.667 1.667h.417c.92 0 1.666-.746 1.666-1.667V7.484c0-.92-.746-1.667-1.666-1.667Z"})]}),g("defs",{children:g("clipPath",{id:"a",children:g("path",{fill:"#fff",d:"M0 0h20v20H0z"})})})]}),Fe),zee=Q(M(ge,{children:[M("g",{clipPath:"url(#a)",stroke:"currentColor",strokeWidth:"1.25",children:[g("path",{d:"M3.333 3.333v13.334",strokeLinecap:"round",strokeLinejoin:"round"}),g("path",{d:"M15.208 4.792H8.125c-.92 0-1.667.746-1.667 1.666v.417c0 .92.747 1.667 1.667 1.667h7.083c.92 0 1.667-.747 1.667-1.667v-.417c0-.92-.746-1.666-1.667-1.666ZM12.516 11.458H8.125c-.92 0-1.667.746-1.667 1.667v.417c0 .92.747 1.666 1.667 1.666h4.391c.92 0 1.667-.746 1.667-1.666v-.417c0-.92-.746-1.667-1.667-1.667Z"})]}),g("defs",{children:g("clipPath",{id:"a",children:g("path",{fill:"#fff",d:"M0 0h20v20H0z"})})})]}),Fe),Gee=Q(M(ge,{children:[M("g",{clipPath:"url(#a)",stroke:"currentColor",strokeWidth:"1.25",children:[g("path",{d:"M16.667 3.333v13.334",strokeLinecap:"round",strokeLinejoin:"round"}),g("path",{d:"M11.875 4.792H4.792c-.92 0-1.667.746-1.667 1.666v.417c0 .92.746 1.667 1.667 1.667h7.083c.92 0 1.667-.747 1.667-1.667v-.417c0-.92-.746-1.666-1.667-1.666ZM11.683 11.458H7.292c-.92 0-1.667.746-1.667 1.667v.417c0 .92.746 1.666 1.667 1.666h4.39c.921 0 1.667-.746 1.667-1.666v-.417c0-.92-.746-1.667-1.666-1.667Z"})]}),g("defs",{children:g("clipPath",{id:"a",children:g("path",{fill:"#fff",d:"M0 0h20v20H0z"})})})]}),Fe),Vee=Q(M(ge,{children:[M("g",{clipPath:"url(#a)",stroke:"currentColor",strokeWidth:"1.25",children:[g("path",{d:"M16.667 3.333v13.334M3.333 3.333v13.334",strokeLinecap:"round",strokeLinejoin:"round"}),g("path",{d:"M14.375 10.208v-.416c0-.92-.746-1.667-1.667-1.667H7.292c-.92 0-1.667.746-1.667 1.667v.416c0 .92.746 1.667 1.667 1.667h5.416c.92 0 1.667-.746 1.667-1.667Z"})]}),g("defs",{children:g("clipPath",{id:"a",children:g("path",{fill:"#fff",d:"M0 0h20v20H0z"})})})]}),Fe),Wee=Q(M(ge,{children:[M("g",{clipPath:"url(#a)",stroke:"currentColor",strokeWidth:"1.25",children:[g("path",{d:"M3.333 3.333h13.334M3.333 16.667h13.334",strokeLinecap:"round",strokeLinejoin:"round"}),g("path",{d:"M10.208 5.625h-.416c-.92 0-1.667.746-1.667 1.667v5.416c0 .92.746 1.667 1.667 1.667h.416c.92 0 1.667-.746 1.667-1.667V7.292c0-.92-.746-1.667-1.667-1.667Z"})]}),g("defs",{children:g("clipPath",{id:"a",children:g("path",{fill:"#fff",d:"M0 0h20v20H0z"})})})]}),Fe),jee=Q(M("g",{stroke:"currentColor",strokeWidth:"1.25",children:[g("path",{d:"M1.667 10h2.916",strokeLinecap:"round",strokeLinejoin:"round"}),g("path",{d:"M8.333 10h3.334",strokeLinejoin:"round"}),g("path",{d:"M15.417 10h2.916",strokeLinecap:"round",strokeLinejoin:"round"}),g("path",{d:"M6.875 4.792h-.417c-.92 0-1.666.746-1.666 1.666v7.084c0 .92.746 1.666 1.666 1.666h.417c.92 0 1.667-.746 1.667-1.666V6.458c0-.92-.747-1.666-1.667-1.666ZM13.542 6.458h-.417c-.92 0-1.667.747-1.667 1.667v3.75c0 .92.746 1.667 1.667 1.667h.417c.92 0 1.666-.746 1.666-1.667v-3.75c0-.92-.746-1.667-1.666-1.667Z"})]}),Fe),Xee=Q(M("g",{stroke:"currentColor",strokeWidth:"1.25",children:[g("path",{d:"M10 18.333v-2.916",strokeLinecap:"round",strokeLinejoin:"round"}),g("path",{d:"M10 11.667V8.333",strokeLinejoin:"round"}),g("path",{d:"M10 4.583V1.667",strokeLinecap:"round",strokeLinejoin:"round"}),g("path",{d:"M4.792 13.125v.417c0 .92.746 1.666 1.666 1.666h7.084c.92 0 1.666-.746 1.666-1.666v-.417c0-.92-.746-1.667-1.666-1.667H6.458c-.92 0-1.666.746-1.666 1.667ZM6.458 6.458v.417c0 .92.747 1.667 1.667 1.667h3.75c.92 0 1.667-.747 1.667-1.667v-.417c0-.92-.746-1.666-1.667-1.666h-3.75c-.92 0-1.667.746-1.667 1.666Z"})]}),Fe),yS=Q(M("g",{strokeWidth:"1.5",children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("circle",{cx:"9",cy:"7",r:"4"}),g("path",{d:"M3 21v-2a4 4 0 0 1 4 -4h4a4 4 0 0 1 4 4v2"}),g("path",{d:"M16 3.13a4 4 0 0 1 0 7.75"}),g("path",{d:"M21 21v-2a4 4 0 0 0 -3 -3.85"})]}),je);Q("M256 8C119 8 8 119 8 256s111 248 248 248 248-111 248-248S393 8 256 8zm115.7 272l-176 101c-15.8 8.8-35.7-2.5-35.7-21V152c0-18.4 19.8-29.8 35.7-21l176 107c16.4 9.2 16.4 32.9 0 42z");Q("M256 8C119 8 8 119 8 256s111 248 248 248 248-111 248-248S393 8 256 8zm96 328c0 8.8-7.2 16-16 16H176c-8.8 0-16-7.2-16-16V176c0-8.8 7.2-16 16-16h160c8.8 0 16 7.2 16 16v160z");const hh=Q(M(ge,{children:[g("g",{clipPath:"url(#a)",stroke:"currentColor",strokeWidth:"1.25",strokeLinecap:"round",strokeLinejoin:"round",children:g("path",{d:"M15 5 5 15M5 5l10 10"})}),g("defs",{children:g("clipPath",{id:"a",children:g("path",{fill:"#fff",d:"M0 0h20v20H0z"})})})]}),Fe),Yee=Q("M34.52 239.03L228.87 44.69c9.37-9.37 24.57-9.37 33.94 0l22.67 22.67c9.36 9.36 9.37 24.52.04 33.9L131.49 256l154.02 154.75c9.34 9.38 9.32 24.54-.04 33.9l-22.67 22.67c-9.37 9.37-24.57 9.37-33.94 0L34.52 272.97c-9.37-9.37-9.37-24.57 0-33.94z",{width:320,height:512,style:{marginLeft:"-0.2rem"},mirror:!0});Q("M464 0c26.51 0 48 21.49 48 48v288c0 26.51-21.49 48-48 48H176c-26.51 0-48-21.49-48-48V48c0-26.51 21.49-48 48-48h288M176 416c-44.112 0-80-35.888-80-80V128H48c-26.51 0-48 21.49-48 48v288c0 26.51 21.49 48 48 48h288c26.51 0 48-21.49 48-48v-48H176z",{mirror:!0});const Zee=Q("M11.553 22.894a.998.998 0 00.894 0s3.037-1.516 5.465-4.097C19.616 16.987 21 14.663 21 12V5a1 1 0 00-.649-.936l-8-3a.998.998 0 00-.702 0l-8 3A1 1 0 003 5v7c0 2.663 1.384 4.987 3.088 6.797 2.428 2.581 5.465 4.097 5.465 4.097zm-1.303-8.481l6.644-6.644a.856.856 0 111.212 1.212l-7.25 7.25a.856.856 0 01-1.212 0l-3.75-3.75a.856.856 0 111.212-1.212l3.144 3.144z",{width:24});Q("M369.9 97.9L286 14C277 5 264.8-.1 252.1-.1H48C21.5 0 0 21.5 0 48v416c0 26.5 21.5 48 48 48h288c26.5 0 48-21.5 48-48V131.9c0-12.7-5.1-25-14.1-34zM332.1 128H256V51.9l76.1 76.1zM48 464V48h160v104c0 13.3 10.7 24 24 24h104v288H48zm32-48h224V288l-23.5-23.5c-4.7-4.7-12.3-4.7-17 0L176 352l-39.5-39.5c-4.7-4.7-12.3-4.7-17 0L80 352v64zm48-240c-26.5 0-48 21.5-48 48s21.5 48 48 48 48-21.5 48-48-21.5-48-48-48z",{width:384,height:512});const Kee=ce.memo(({theme:t})=>Q(M(ge,{children:[g("path",{d:"M25 26H111V111H25",fill:as()}),g("path",{d:"M25 111C25 80.2068 25 49.4135 25 26M25 26C48.6174 26 72.2348 26 111 26H25ZM25 26C53.3671 26 81.7343 26 111 26H25ZM111 26C111 52.303 111 78.606 111 111V26ZM111 26C111 51.2947 111 76.5893 111 111V26ZM111 111C87.0792 111 63.1585 111 25 111H111ZM111 111C87.4646 111 63.9293 111 25 111H111ZM25 111C25 81.1514 25 51.3028 25 26V111Z",stroke:as(),strokeWidth:"2"}),g("path",{d:"M100 100H160V160H100",fill:as()}),g("path",{d:"M100 160C100 144.106 100 128.211 100 100M100 100C117.706 100 135.412 100 160 100H100ZM100 100C114.214 100 128.428 100 160 100H100ZM160 100C160 120.184 160 140.369 160 160V100ZM160 100C160 113.219 160 126.437 160 160V100ZM160 160C145.534 160 131.068 160 100 160H160ZM160 160C143.467 160 126.934 160 100 160H160ZM100 160C100 143.661 100 127.321 100 100V160Z",stroke:as(),strokeWidth:"2"}),M("g",{fill:jO(t),stroke:as(),strokeWidth:"6",children:[g("rect",{x:"2.5",y:"2.5",width:"30",height:"30"}),g("rect",{x:"2.5",y:"149.5",width:"30",height:"30"}),g("rect",{x:"147.5",y:"149.5",width:"30",height:"30"}),g("rect",{x:"147.5",y:"2.5",width:"30",height:"30"})]})]}),{width:182,height:182,mirror:!0})),qee=ce.memo(({theme:t})=>Q(M(ge,{children:[g("path",{d:"M25 26H111V111H25",fill:as()}),g("path",{d:"M25 111C25 80.2068 25 49.4135 25 26M25 26C48.6174 26 72.2348 26 111 26H25ZM25 26C53.3671 26 81.7343 26 111 26H25ZM111 26C111 52.303 111 78.606 111 111V26ZM111 26C111 51.2947 111 76.5893 111 111V26ZM111 111C87.0792 111 63.1585 111 25 111H111ZM111 111C87.4646 111 63.9293 111 25 111H111ZM25 111C25 81.1514 25 51.3028 25 26V111Z",stroke:as(),strokeWidth:"2"}),g("path",{d:"M100 100H160V160H100",fill:as()}),g("path",{d:"M100 160C100 144.106 100 128.211 100 100M100 100C117.706 100 135.412 100 160 100H100ZM100 100C114.214 100 128.428 100 160 100H100ZM160 100C160 120.184 160 140.369 160 160V100ZM160 100C160 113.219 160 126.437 160 160V100ZM160 160C145.534 160 131.068 160 100 160H160ZM160 160C143.467 160 126.934 160 100 160H160ZM100 160C100 143.661 100 127.321 100 100V160Z",stroke:as(),strokeWidth:"2"}),M("g",{fill:jO(t),stroke:as(),strokeWidth:"6",children:[g("rect",{x:"2.5",y:"2.5",width:"30",height:"30"}),g("rect",{x:"78.5",y:"149.5",width:"30",height:"30"}),g("rect",{x:"147.5",y:"149.5",width:"30",height:"30"}),g("rect",{x:"147.5",y:"78.5",width:"30",height:"30"}),g("rect",{x:"105.5",y:"2.5",width:"30",height:"30"}),g("rect",{x:"2.5",y:"102.5",width:"30",height:"30"})]})]}),{width:182,height:182,mirror:!0})),Jee=Q(g("g",{strokeWidth:1.25,children:g("path",{d:"M5.879 2.625h8.242a3.27 3.27 0 0 1 3.254 3.254v8.242a3.27 3.27 0 0 1-3.254 3.254H5.88a3.27 3.27 0 0 1-3.254-3.254V5.88A3.27 3.27 0 0 1 5.88 2.626l-.001-.001ZM4.518 16.118l7.608-12.83m.198 13.934 5.051-9.897M2.778 9.675l9.348-6.387m-7.608 12.83 12.857-8.793"})}),Fe),Qee=Q(M(ge,{children:[g("path",{d:"M5.879 2.625h8.242a3.254 3.254 0 0 1 3.254 3.254v8.242a3.254 3.254 0 0 1-3.254 3.254H5.88a3.254 3.254 0 0 1-3.254-3.254V5.88a3.254 3.254 0 0 1 3.254-3.254Z",stroke:"currentColor",strokeWidth:"1.25"}),g("mask",{id:"FillHachureIcon",style:{maskType:"alpha"},maskUnits:"userSpaceOnUse",x:2,y:2,width:16,height:16,children:g("path",{d:"M5.879 2.625h8.242a3.254 3.254 0 0 1 3.254 3.254v8.242a3.254 3.254 0 0 1-3.254 3.254H5.88a3.254 3.254 0 0 1-3.254-3.254V5.88a3.254 3.254 0 0 1 3.254-3.254Z",fill:"currentColor",stroke:"currentColor",strokeWidth:"1.25"})}),g("g",{mask:"url(#FillHachureIcon)",children:g("path",{d:"M2.258 15.156 15.156 2.258M7.324 20.222 20.222 7.325m-20.444 5.35L12.675-.222m-8.157 18.34L17.416 5.22",stroke:"currentColor",strokeWidth:"1.25",strokeLinecap:"round",strokeLinejoin:"round"})})]}),Fe),ete=Q(M(ge,{children:[M("g",{clipPath:"url(#a)",children:[g("path",{d:"M5.879 2.625h8.242a3.254 3.254 0 0 1 3.254 3.254v8.242a3.254 3.254 0 0 1-3.254 3.254H5.88a3.254 3.254 0 0 1-3.254-3.254V5.88a3.254 3.254 0 0 1 3.254-3.254Z",stroke:"currentColor",strokeWidth:"1.25"}),g("mask",{id:"FillCrossHatchIcon",style:{maskType:"alpha"},maskUnits:"userSpaceOnUse",x:-1,y:-1,width:22,height:22,children:g("path",{d:"M2.426 15.044 15.044 2.426M7.383 20 20 7.383M0 12.617 12.617 0m-7.98 17.941L17.256 5.324m-2.211 12.25L2.426 4.956M20 12.617 7.383 0m5.234 20L0 7.383m17.941 7.98L5.324 2.745",stroke:"currentColor",strokeWidth:"1.25",strokeLinecap:"round",strokeLinejoin:"round"})}),g("g",{mask:"url(#FillCrossHatchIcon)",children:g("path",{d:"M14.121 2H5.88A3.879 3.879 0 0 0 2 5.879v8.242A3.879 3.879 0 0 0 5.879 18h8.242A3.879 3.879 0 0 0 18 14.121V5.88A3.879 3.879 0 0 0 14.121 2Z",fill:"currentColor"})})]}),g("defs",{children:g("clipPath",{id:"a",children:g("path",{fill:"#fff",d:"M0 0h20v20H0z"})})})]}),Fe),tte=Q(M(ge,{children:[g("g",{clipPath:"url(#a)",children:g("path",{d:"M4.91 2.625h10.18a2.284 2.284 0 0 1 2.285 2.284v10.182a2.284 2.284 0 0 1-2.284 2.284H4.909a2.284 2.284 0 0 1-2.284-2.284V4.909a2.284 2.284 0 0 1 2.284-2.284Z",stroke:"currentColor",strokeWidth:"1.25"})}),g("defs",{children:g("clipPath",{id:"a",children:g("path",{fill:"#fff",d:"M0 0h20v20H0z"})})})]}),{...Fe,fill:"currentColor"}),qO=Q(g(ge,{children:g("path",{d:"M4.167 10h11.666",stroke:"currentColor",strokeWidth:"1.25",strokeLinecap:"round",strokeLinejoin:"round"})}),Fe),nte=Q(g("path",{d:"M5 10h10",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round"}),Fe),rte=Q(g("path",{d:"M5 10h10",stroke:"currentColor",strokeWidth:"3.75",strokeLinecap:"round",strokeLinejoin:"round"}),Fe);ce.memo(({theme:t})=>Q(g("path",{d:"M6 10H34",stroke:as(),strokeWidth:2,fill:"none",strokeLinecap:"round"}),{width:40,height:20}));const ite=Q(M("g",{strokeWidth:"2",children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M5 12h2"}),g("path",{d:"M17 12h2"}),g("path",{d:"M11 12h2"})]}),je),ste=Q(M("g",{strokeWidth:"2",children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M4 12v.01"}),g("path",{d:"M8 12v.01"}),g("path",{d:"M12 12v.01"}),g("path",{d:"M16 12v.01"}),g("path",{d:"M20 12v.01"})]}),je),ote=Q(g("path",{d:"M2.5 12.038c1.655-.885 5.9-3.292 8.568-4.354 2.668-1.063.101 2.821 1.32 3.104 1.218.283 5.112-1.814 5.112-1.814",strokeWidth:"1.25"}),Fe),ate=Q(g("path",{d:"M2.5 12.563c1.655-.886 5.9-3.293 8.568-4.355 2.668-1.062.101 2.822 1.32 3.105 1.218.283 5.112-1.814 5.112-1.814m-13.469 2.23c2.963-1.586 6.13-5.62 7.468-4.998 1.338.623-1.153 4.11-.132 5.595 1.02 1.487 6.133-1.43 6.133-1.43",strokeWidth:"1.25"}),Fe),lte=Q(g("path",{d:"M2.5 11.936c1.737-.879 8.627-5.346 10.42-5.268 1.795.078-.418 5.138.345 5.736.763.598 3.53-1.789 4.235-2.147M2.929 9.788c1.164-.519 5.47-3.28 6.987-3.114 1.519.165 1 3.827 2.121 4.109 1.122.281 3.839-2.016 4.606-2.42",strokeWidth:"1.25"}),Fe),cte=Q(M("svg",{strokeWidth:"1.5",children:[g("path",{d:"M3.33334 9.99998V6.66665C3.33334 6.04326 3.33403 4.9332 3.33539 3.33646C4.95233 3.33436 6.06276 3.33331 6.66668 3.33331H10"}),g("path",{d:"M13.3333 3.33331V3.34331"}),g("path",{d:"M16.6667 3.33331V3.34331"}),g("path",{d:"M16.6667 6.66669V6.67669"}),g("path",{d:"M16.6667 10V10.01"}),g("path",{d:"M3.33334 13.3333V13.3433"}),g("path",{d:"M16.6667 13.3333V13.3433"}),g("path",{d:"M3.33334 16.6667V16.6767"}),g("path",{d:"M6.66666 16.6667V16.6767"}),g("path",{d:"M10 16.6667V16.6767"}),g("path",{d:"M13.3333 16.6667V16.6767"}),g("path",{d:"M16.6667 16.6667V16.6767"})]}),Fe),ute=Q(M("g",{strokeWidth:"1.5",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M4 12v-4a4 4 0 0 1 4 -4h4"}),g("line",{x1:"16",y1:"4",x2:"16",y2:"4.01"}),g("line",{x1:"20",y1:"4",x2:"20",y2:"4.01"}),g("line",{x1:"20",y1:"8",x2:"20",y2:"8.01"}),g("line",{x1:"20",y1:"12",x2:"20",y2:"12.01"}),g("line",{x1:"4",y1:"16",x2:"4",y2:"16.01"}),g("line",{x1:"20",y1:"16",x2:"20",y2:"16.01"}),g("line",{x1:"4",y1:"20",x2:"4",y2:"20.01"}),g("line",{x1:"8",y1:"20",x2:"8",y2:"20.01"}),g("line",{x1:"12",y1:"20",x2:"12",y2:"20.01"}),g("line",{x1:"16",y1:"20",x2:"16",y2:"20.01"}),g("line",{x1:"20",y1:"20",x2:"20",y2:"20.01"})]}),je),dte=Q(g("path",{d:"M6 10H34",stroke:"currentColor",strokeWidth:2,fill:"none"}),{width:40,height:20}),hte=ce.memo(({flip:t=!1})=>Q(M("g",{transform:t?"translate(40, 0) scale(-1, 1)":"",stroke:"currentColor",strokeWidth:2,fill:"none",children:[g("path",{d:"M34 10H6M34 10L27 5M34 10L27 15"}),g("path",{d:"M27.5 5L34.5 10L27.5 15"})]}),{width:40,height:20})),PI=ce.memo(({flip:t=!1})=>Q(M("g",{stroke:"currentColor",fill:"currentColor",transform:t?"translate(40, 0) scale(-1, 1)":"",children:[g("path",{d:"M32 10L6 10",strokeWidth:2}),g("circle",{r:"4",transform:"matrix(-1 0 0 1 30 10)"})]}),{width:40,height:20})),fte=ce.memo(({flip:t=!1})=>Q(M("g",{stroke:"currentColor",fill:"none",transform:t?"translate(40, 0) scale(-1, 1)":"",strokeWidth:2,children:[g("path",{d:"M26 10L6 10"}),g("circle",{r:"4",transform:"matrix(-1 0 0 1 30 10)"})]}),{width:40,height:20})),pte=ce.memo(({flip:t=!1})=>Q(g("g",{transform:t?"translate(40, 0) scale(-1, 1)":"",children:g("path",{d:"M34 10H5.99996M34 10L34 5M34 10L34 15",stroke:"currentColor",strokeWidth:2,fill:"none"})}),{width:40,height:20})),mte=ce.memo(({flip:t=!1})=>Q(M("g",{stroke:"currentColor",fill:"currentColor",transform:t?"translate(40, 0) scale(-1, 1)":"",children:[g("path",{d:"M32 10L6 10",strokeWidth:2}),g("path",{d:"M27.5 5.5L34.5 10L27.5 14.5L27.5 5.5"})]}),{width:40,height:20})),gte=ce.memo(({flip:t=!1})=>Q(M("g",{stroke:"currentColor",fill:"none",transform:t?"translate(40, 0) scale(-1, 1)":"",strokeWidth:2,strokeLinejoin:"round",children:[g("path",{d:"M6,9.5H27"}),g("path",{d:"M27,5L34,10L27,14Z",fill:"none"})]}),{width:40,height:20})),yte=ce.memo(({flip:t=!1})=>Q(M("g",{stroke:"currentColor",fill:"currentColor",transform:t?"translate(40, 0) scale(-1, 1)":"",strokeLinejoin:"round",strokeWidth:2,children:[g("path",{d:"M6,9.5H20"}),g("path",{d:"M27,5L34,10L27,14L20,9.5Z"})]}),{width:40,height:20})),vte=ce.memo(({flip:t=!1})=>Q(M("g",{stroke:"currentColor",fill:"none",transform:t?"translate(40, 0) scale(-1, 1)":"",strokeLinejoin:"round",strokeWidth:2,children:[g("path",{d:"M6,9.5H20"}),g("path",{d:"M27,5L34,10L27,14L20,9.5Z"})]}),{width:40,height:20})),bte=Q(M(ge,{children:[g("g",{clipPath:"url(#a)",children:g("path",{d:"M14.167 6.667a3.333 3.333 0 0 0-3.334-3.334H9.167a3.333 3.333 0 0 0 0 6.667h1.666a3.333 3.333 0 0 1 0 6.667H9.167a3.333 3.333 0 0 1-3.334-3.334",stroke:"currentColor",strokeWidth:"1.25",strokeLinecap:"round",strokeLinejoin:"round"})}),g("defs",{children:g("clipPath",{id:"a",children:g("path",{fill:"#fff",d:"M0 0h20v20H0z"})})})]}),Fe),_te=Q(M(ge,{children:[g("g",{clipPath:"url(#a)",children:g("path",{d:"M5 16.667V3.333L10 15l5-11.667v13.334",stroke:"currentColor",strokeWidth:"1.25",strokeLinecap:"round",strokeLinejoin:"round"})}),g("defs",{children:g("clipPath",{id:"a",children:g("path",{fill:"#fff",d:"M0 0h20v20H0z"})})})]}),Fe),Ete=Q(M(ge,{children:[g("g",{clipPath:"url(#a)",children:g("path",{d:"M5.833 3.333v13.334h8.334",stroke:"currentColor",strokeWidth:"1.25",strokeLinecap:"round",strokeLinejoin:"round"})}),g("defs",{children:g("clipPath",{id:"a",children:g("path",{fill:"#fff",d:"M0 0h20v20H0z"})})})]}),Fe),wte=Q(g(ge,{children:g("path",{d:"m1.667 3.333 6.666 13.334M8.333 3.333 1.667 16.667M11.667 3.333v13.334h6.666",stroke:"currentColor",strokeWidth:"1.25",strokeLinecap:"round",strokeLinejoin:"round"})}),Fe),xte=Q(g(ge,{children:g("g",{stroke:"currentColor",strokeWidth:"1.25",strokeLinecap:"round",strokeLinejoin:"round",children:g("path",{d:"M5.833 16.667v-10a3.333 3.333 0 0 1 3.334-3.334h1.666a3.333 3.333 0 0 1 3.334 3.334v10M5.833 10.833h8.334"})})}),Fe),Tte=Q(M(ge,{children:[g("g",{clipPath:"url(#a)",stroke:"currentColor",strokeWidth:"1.25",strokeLinecap:"round",strokeLinejoin:"round",children:g("path",{d:"M5.833 6.667 2.5 10l3.333 3.333M14.167 6.667 17.5 10l-3.333 3.333M11.667 3.333 8.333 16.667"})}),g("defs",{children:g("clipPath",{id:"a",children:g("path",{fill:"#fff",d:"M0 0h20v20H0z"})})})]}),Fe),Ste=Q(M("g",{stroke:"currentColor",fill:"none",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("line",{x1:"4",y1:"8",x2:"20",y2:"8"}),g("line",{x1:"4",y1:"12",x2:"12",y2:"12"}),g("line",{x1:"4",y1:"16",x2:"16",y2:"16"})]}),je),Cte=Q(M("g",{stroke:"currentColor",fill:"none",strokeLinecap:"round",strokeLinejoin:"round",children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("line",{x1:"4",y1:"8",x2:"20",y2:"8"}),g("line",{x1:"8",y1:"12",x2:"16",y2:"12"}),g("line",{x1:"6",y1:"16",x2:"18",y2:"16"})]}),je),Ite=Q(M("g",{stroke:"currentColor",fill:"none",strokeLinecap:"round",strokeLinejoin:"round",children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("line",{x1:"4",y1:"8",x2:"20",y2:"8"}),g("line",{x1:"10",y1:"12",x2:"20",y2:"12"}),g("line",{x1:"8",y1:"16",x2:"20",y2:"16"})]}),je),Ate=ce.memo(({theme:t})=>Q(M("g",{strokeWidth:"1.5",stroke:"currentColor",fill:"none",strokeLinecap:"round",strokeLinejoin:"round",children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("line",{x1:"4",y1:"4",x2:"20",y2:"4"}),g("rect",{x:"9",y:"8",width:"6",height:"12",rx:"2"})]}),je)),kte=ce.memo(({theme:t})=>Q(M("g",{strokeWidth:"2",stroke:"currentColor",fill:"none",strokeLinecap:"round",strokeLinejoin:"round",children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("line",{x1:"4",y1:"20",x2:"20",y2:"20"}),g("rect",{x:"9",y:"4",width:"6",height:"12",rx:"2"})]}),je)),Mte=ce.memo(({theme:t})=>Q(M("g",{strokeWidth:"1.5",stroke:"currentColor",fill:"none",strokeLinecap:"round",strokeLinejoin:"round",children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("line",{x1:"4",y1:"12",x2:"9",y2:"12"}),g("line",{x1:"15",y1:"12",x2:"20",y2:"12"}),g("rect",{x:"9",y:"6",width:"6",height:"12",rx:"2"})]}),je)),Pte=Q(g("path",{d:"M537.6 226.6c4.1-10.7 6.4-22.4 6.4-34.6 0-53-43-96-96-96-19.7 0-38.1 6-53.3 16.2C367 64.2 315.3 32 256 32c-88.4 0-160 71.6-160 160 0 2.7.1 5.4.2 8.1C40.2 219.8 0 273.2 0 336c0 79.5 64.5 144 144 144h368c70.7 0 128-57.3 128-128 0-61.9-44-113.6-102.4-125.4zM393.4 288H328v112c0 8.8-7.2 16-16 16h-48c-8.8 0-16-7.2-16-16V288h-65.4c-14.3 0-21.4-17.2-11.3-27.3l105.4-105.4c6.2-6.2 16.4-6.2 22.6 0l105.4 105.4c10.1 10.1 2.9 27.3-11.3 27.3z",fill:"currentColor"}),{width:640,height:512});Q(g("path",{d:"M480 416C497.7 416 512 430.3 512 448C512 465.7 497.7 480 480 480H150.6C133.7 480 117.4 473.3 105.4 461.3L25.37 381.3C.3786 356.3 .3786 315.7 25.37 290.7L258.7 57.37C283.7 32.38 324.3 32.38 349.3 57.37L486.6 194.7C511.6 219.7 511.6 260.3 486.6 285.3L355.9 416H480zM265.4 416L332.7 348.7L195.3 211.3L70.63 336L150.6 416L265.4 416z"}));const Lte=Q(M("g",{strokeWidth:1.25,children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M8 13v-7.5a1.5 1.5 0 0 1 3 0v6.5"}),g("path",{d:"M11 5.5v-2a1.5 1.5 0 1 1 3 0v8.5"}),g("path",{d:"M14 5.5a1.5 1.5 0 0 1 3 0v6.5"}),g("path",{d:"M17 7.5a1.5 1.5 0 0 1 3 0v8.5a6 6 0 0 1 -6 6h-2h.208a6 6 0 0 1 -5.012 -2.7a69.74 69.74 0 0 1 -.196 -.3c-.312 -.479 -1.407 -2.388 -3.286 -5.728a1.5 1.5 0 0 1 .536 -2.022a1.867 1.867 0 0 1 2.28 .28l1.47 1.47"})]}),je),LI=Q(M(ge,{children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M4 17v2a2 2 0 0 0 2 2h12a2 2 0 0 0 2 -2v-2"}),g("path",{d:"M7 11l5 5l5 -5"}),g("path",{d:"M12 4l0 12"})]}),je),Vv=Q(M(ge,{children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M8 8m0 2a2 2 0 0 1 2 -2h8a2 2 0 0 1 2 2v8a2 2 0 0 1 -2 2h-8a2 2 0 0 1 -2 -2z"}),g("path",{d:"M16 8v-2a2 2 0 0 0 -2 -2h-8a2 2 0 0 0 -2 2v8a2 2 0 0 0 2 2h2"})]}),je),Rte=Q(M(ge,{children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M12 12m-9 0a9 9 0 1 0 18 0a9 9 0 1 0 -18 0"}),g("path",{d:"M12 17l0 .01"}),g("path",{d:"M12 13.5a1.5 1.5 0 0 1 1 -1.5a2.6 2.6 0 1 0 -3 -4"})]}),je),Ote=Q(M(ge,{children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M7 4v16l13 -8z"})]}),je),Dte=Q(M(ge,{children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M17 4h-10a3 3 0 0 0 -3 3v10a3 3 0 0 0 3 3h10a3 3 0 0 0 3 -3v-10a3 3 0 0 0 -3 -3z",strokeWidth:"0",fill:"currentColor"})]}),je),JO=Q(M(ge,{children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M5 12l5 5l10 -10"})]}),je),Nte=Q(M(ge,{children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M10.24 3.957l-8.422 14.06a1.989 1.989 0 0 0 1.7 2.983h16.845a1.989 1.989 0 0 0 1.7 -2.983l-8.423 -14.06a1.989 1.989 0 0 0 -3.4 0z"}),g("path",{d:"M12 9v4"}),g("path",{d:"M12 17h.01"})]}),je),Fte=Q(M("g",{strokeWidth:1.25,children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M11 7l6 6"}),g("path",{d:"M4 16l11.7 -11.7a1 1 0 0 1 1.4 0l2.6 2.6a1 1 0 0 1 0 1.4l-11.7 11.7h-4v-4z"})]}),je),Bte=Q(M("g",{strokeWidth:1.5,children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M12 3l-4 7h8z"}),g("path",{d:"M17 17m-3 0a3 3 0 1 0 6 0a3 3 0 1 0 -6 0"}),g("path",{d:"M4 14m0 1a1 1 0 0 1 1 -1h4a1 1 0 0 1 1 1v4a1 1 0 0 1 -1 1h-4a1 1 0 0 1 -1 -1z"})]}),je),Ute=Q(M("g",{strokeWidth:1.5,children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M4 7l16 0"}),g("path",{d:"M4 17l16 0"}),g("path",{d:"M7 4l0 16"}),g("path",{d:"M17 4l0 16"})]}),je),$te=Q(g("path",{fill:"currentColor",d:"M407.48,111.18C335.587,108.103 269.573,152.338 245.08,220C220.587,152.338 154.573,108.103 82.68,111.18C80.285,168.229 107.577,222.632 154.74,254.82C178.908,271.419 193.35,298.951 193.27,328.27L193.27,379.13L296.9,379.13L296.9,328.27C296.816,298.953 311.255,271.42 335.42,254.82C382.596,222.644 409.892,168.233 407.48,111.18Z"})),n0=Q(M("g",{strokeWidth:"1.25",children:[g("path",{d:"M4.16602 10H15.8327"}),g("path",{d:"M12.5 13.3333L15.8333 10"}),g("path",{d:"M12.5 6.66666L15.8333 9.99999"})]}),Fe),QO=Q(M("g",{fill:"none",stroke:"currentColor",strokeWidth:"1.25",strokeLinecap:"round",strokeLinejoin:"round",transform:"rotate(90 10 10)",children:[g("path",{clipRule:"evenodd",d:"m9.644 13.69 7.774-7.773a2.357 2.357 0 0 0-3.334-3.334l-7.773 7.774L8 12l1.643 1.69Z"}),g("path",{d:"m13.25 3.417 3.333 3.333M10 10l2-2M5 15l3-3M2.156 17.894l1-1M5.453 19.029l-.144-1.407M2.377 11.887l.866 1.118M8.354 17.273l-1.194-.758M.953 14.652l1.408.13"})]}),20),vS=Q(M("g",{stroke:"currentColor",fill:"none",children:[g("path",{stroke:"none",d:"M0 0h24v24H0z"}),g("path",{d:"M6 21l15 -15l-3 -3l-15 15l3 3"}),g("path",{d:"M15 6l3 3"}),g("path",{d:"M9 3a2 2 0 0 0 2 2a2 2 0 0 0 -2 2a2 2 0 0 0 -2 -2a2 2 0 0 0 2 -2"}),g("path",{d:"M19 13a2 2 0 0 0 2 2a2 2 0 0 0 -2 2a2 2 0 0 0 -2 -2a2 2 0 0 0 2 -2"})]}),je),wx=Q(M("g",{stroke:"currentColor",fill:"none",children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M11.217 19.384a3.501 3.501 0 0 0 6.783 -1.217v-5.167l-6 -3.35"}),g("path",{d:"M5.214 15.014a3.501 3.501 0 0 0 4.446 5.266l4.34 -2.534v-6.946"}),g("path",{d:"M6 7.63c-1.391 -.236 -2.787 .395 -3.534 1.689a3.474 3.474 0 0 0 1.271 4.745l4.263 2.514l6 -3.348"}),g("path",{d:"M12.783 4.616a3.501 3.501 0 0 0 -6.783 1.217v5.067l6 3.45"}),g("path",{d:"M18.786 8.986a3.501 3.501 0 0 0 -4.446 -5.266l-4.34 2.534v6.946"}),g("path",{d:"M18 16.302c1.391 .236 2.787 -.395 3.534 -1.689a3.474 3.474 0 0 0 -1.271 -4.745l-4.308 -2.514l-5.955 3.42"})]}),je),Hte=Q(M("g",{stroke:"currentColor",fill:"none",children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M4 8v-2a2 2 0 0 1 2 -2h2"}),g("path",{d:"M4 16v2a2 2 0 0 0 2 2h2"}),g("path",{d:"M16 4h2a2 2 0 0 1 2 2v2"}),g("path",{d:"M16 20h2a2 2 0 0 0 2 -2v-2"})]}),je),eD=Q(M("g",{stroke:"currentColor",fill:"none",children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M10 12a2 2 0 1 0 4 0a2 2 0 0 0 -4 0"}),g("path",{d:"M21 12c-2.4 4 -5.4 6 -9 6c-3.6 0 -6.6 -2 -9 -6c2.4 -4 5.4 -6 9 -6c3.6 0 6.6 2 9 6"})]}),je),zte=Q(M("g",{stroke:"currentColor",fill:"none",children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M10.585 10.587a2 2 0 0 0 2.829 2.828"}),g("path",{d:"M16.681 16.673a8.717 8.717 0 0 1 -4.681 1.327c-3.6 0 -6.6 -2 -9 -6c1.272 -2.12 2.712 -3.678 4.32 -4.674m2.86 -1.146a9.055 9.055 0 0 1 1.82 -.18c3.6 0 6.6 2 9 6c-.666 1.11 -1.379 2.067 -2.138 2.87"}),g("path",{d:"M3 3l18 18"})]}),je),Gte=Q(M("g",{stroke:"currentColor",fill:"none",children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M15.5 13a3.5 3.5 0 0 0 -3.5 3.5v1a3.5 3.5 0 0 0 7 0v-1.8"}),g("path",{d:"M8.5 13a3.5 3.5 0 0 1 3.5 3.5v1a3.5 3.5 0 0 1 -7 0v-1.8"}),g("path",{d:"M17.5 16a3.5 3.5 0 0 0 0 -7h-.5"}),g("path",{d:"M19 9.3v-2.8a3.5 3.5 0 0 0 -7 0"}),g("path",{d:"M6.5 16a3.5 3.5 0 0 1 0 -7h.5"}),g("path",{d:"M5 9.3v-2.8a3.5 3.5 0 0 1 7 0v10"})]}),je),Vte=Q(M("g",{strokeWidth:1.5,children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M10 10m-7 0a7 7 0 1 0 14 0a7 7 0 1 0 -14 0"}),g("path",{d:"M21 21l-6 -6"})]}),je),ht={EQUAL:"Equal",MINUS:"Minus",NUM_ADD:"NumpadAdd",NUM_SUBTRACT:"NumpadSubtract",NUM_ZERO:"Numpad0",BRACKET_RIGHT:"BracketRight",BRACKET_LEFT:"BracketLeft",ONE:"Digit1",TWO:"Digit2",THREE:"Digit3",NINE:"Digit9",QUOTE:"Quote",ZERO:"Digit0",SLASH:"Slash",C:"KeyC",D:"KeyD",H:"KeyH",V:"KeyV",Z:"KeyZ",R:"KeyR",S:"KeyS"},z={ARROW_DOWN:"ArrowDown",ARROW_LEFT:"ArrowLeft",ARROW_RIGHT:"ArrowRight",ARROW_UP:"ArrowUp",PAGE_UP:"PageUp",PAGE_DOWN:"PageDown",BACKSPACE:"Backspace",ALT:"Alt",CTRL_OR_CMD:uo?"metaKey":"ctrlKey",DELETE:"Delete",ENTER:"Enter",ESCAPE:"Escape",QUESTION_MARK:"?",SPACE:" ",TAB:"Tab",CHEVRON_LEFT:"<",CHEVRON_RIGHT:">",PERIOD:".",COMMA:",",SUBTRACT:"-",A:"a",C:"c",D:"d",E:"e",F:"f",G:"g",H:"h",I:"i",L:"l",O:"o",P:"p",Q:"q",R:"r",S:"s",T:"t",V:"v",X:"x",Y:"y",Z:"z",K:"k",W:"w",0:"0",1:"1",2:"2",3:"3",4:"4",5:"5",6:"6",7:"7",8:"8",9:"9"},r0=t=>t===z.ARROW_LEFT||t===z.ARROW_RIGHT||t===z.ARROW_DOWN||t===z.ARROW_UP,s_=t=>t.altKey,Kh=t=>t.shiftKey,Yf=t=>t.shiftKey,Zf=()=>{const t=document.querySelector(".excalidraw-tooltip");if(t)return t;const e=document.createElement("div");return document.body.appendChild(e),e.classList.add("excalidraw-tooltip"),e},tD=(t,e,n="bottom")=>{const r=t.getBoundingClientRect(),i=window.innerWidth,s=window.innerHeight,o=5;let a=e.left+e.width/2-r.width/2;a<0?a=o:a+r.width>=i&&(a=i-r.width-o);let l;n==="bottom"?(l=e.top+e.height+o,l+r.height>=s&&(l=e.top-r.height-o)):(l=e.top-r.height-o,l<0&&(l=e.top+e.height+o)),Object.assign(t.style,{top:`${l}px`,left:`${a}px`})},Wte=(t,e,n,r)=>{e.classList.add("excalidraw-tooltip--visible"),e.style.minWidth=r?"50ch":"10ch",e.style.maxWidth=r?"50ch":"15ch",e.textContent=n;const i=t.getBoundingClientRect();tD(e,i)},El=({children:t,label:e,long:n=!1,style:r,disabled:i})=>(A.useEffect(()=>()=>Zf().classList.remove("excalidraw-tooltip--visible"),[]),i?null:g("div",{className:"excalidraw-tooltip-wrapper",onPointerEnter:s=>Wte(s.currentTarget,Zf(),e,n),onPointerLeave:()=>Zf().classList.remove("excalidraw-tooltip--visible"),style:r,children:t}));var bS={};Object.defineProperty(bS,"__esModule",{value:!0});var nD=bS.sanitizeUrl=void 0,jte=/^([^\w]*)(javascript|data|vbscript)/im,Xte=/&#(\w+)(^\w|;)?/g,Yte=/&(newline|tab);/gi,Zte=/[\u0000-\u001F\u007F-\u009F\u2000-\u200D\uFEFF]/gim,Kte=/^.+(:|&colon;)/gim,qte=[".","/"];function Jte(t){return qte.indexOf(t[0])>-1}function Qte(t){return t.replace(Xte,function(e,n){return String.fromCharCode(n)})}function ene(t){var e=Qte(t||"").replace(Yte,"").replace(Zte,"").trim();if(!e)return"about:blank";if(Jte(e))return e;var n=e.match(Kte);if(!n)return e;var r=n[0];return jte.test(r)?"about:blank":e}nD=bS.sanitizeUrl=ene;const ao=t=>(t=t.trim(),t&&nD(t)),rD=t=>!!(t!=null&&t.includes(location.origin)||t!=null&&t.startsWith("/")),iD=t=>{if(t=ao(t),t.startsWith("/"))return`${location.origin}${t}`;try{new URL(t)}catch{return"about:blank"}return t},ar=class ar{};O(ar,"rg",new Vp),O(ar,"cache",new WeakMap),O(ar,"get",e=>ar.cache.get(e)),O(ar,"set",(e,n)=>ar.cache.set(e,n)),O(ar,"delete",e=>ar.cache.delete(e)),O(ar,"destroy",()=>{ar.cache=new WeakMap}),O(ar,"generateElementShape",(e,n)=>{const r=n!=null&&n.isExporting?void 0:ar.get(e);if(r!==void 0)return r;zx.delete(e);const i=Foe(e,ar.rg,n||{isExporting:!1,canvasBackgroundColor:Ge.white,webGLEnabled:!1});return ar.cache.set(e,i),i});let mt=ar;const _S=320,sD=85,xx=5,tne=42,nne=500,rne='<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="#1971c2" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-external-link"><path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path><polyline points="15 3 21 3 21 9"></polyline><line x1="10" y1="14" x2="21" y2="3"></line></svg>',ES=document.createElement("img");ES.src=`data:${Oe.svg}, ${encodeURIComponent(rne)}`;let Tx=!1;const J1=new Map,ine=({element:t,setAppState:e,onLinkOpen:n,setToast:r})=>{const i=G4(),s=M2(),o=t.link||"",[a,l]=A.useState(o),c=A.useRef(null),u=i.showHyperlinkPopup==="editor",d=A.useCallback(()=>{var y;if(!c.current)return;const v=ao(c.current.value)||null;if(!t.link&&v&&at("hyperlink","create"),ur(t)){if(((y=i.activeEmbeddable)==null?void 0:y.element)===t&&e({activeEmbeddable:null}),!v){ae(t,{validated:!1,link:null});return}if(!t0(v,s.validateEmbeddable))v&&r({message:I("toast.unableToEmbed"),closable:!0}),t.link&&J1.set(t.id,t.link),ae(t,{validated:!1,link:v}),mt.delete(t);else{const{width:b,height:_}=t,E=ad(v);E!=null&&E.warning&&r({message:E.warning,closable:!0});const w=E?E.intrinsicSize.w/E.intrinsicSize.h:1,x=J1.get(t.id)!==t.link;ae(t,{...x?{width:(E==null?void 0:E.type)==="video"?b>_?b:_*w:b,height:(E==null?void 0:E.type)==="video"&&b>_?b/w:_}:{},validated:!0,link:v}),mt.delete(t),J1.has(t.id)&&J1.delete(t.id)}}else ae(t,{link:v})},[t,r,s.validateEmbeddable,i.activeEmbeddable,e]);A.useLayoutEffect(()=>()=>{d()},[d]),A.useEffect(()=>{let v=null;const y=b=>{if(u)return;v&&clearTimeout(v),cne(t,i,[b.clientX,b.clientY])&&(v=window.setTimeout(()=>{e({showHyperlinkPopup:!1})},nne))};return window.addEventListener(ee.POINTER_MOVE,y,!1),()=>{window.removeEventListener(ee.POINTER_MOVE,y,!1),v&&clearTimeout(v)}},[i,t,u,e]);const h=A.useCallback(()=>{at("hyperlink","delete"),ae(t,{link:null}),u&&(c.current.value=""),e({showHyperlinkPopup:!1})},[e,t,u]),f=()=>{at("hyperlink","edit","popup-ui"),e({showHyperlinkPopup:"editor"})},{x:p,y:m}=oD(t,i);return i.contextMenu||i.draggingElement||i.resizingElement||i.isRotating||i.openMenu||i.viewModeEnabled?null:M("div",{className:"excalidraw-hyperlinkContainer",style:{top:`${m}px`,left:`${p}px`,width:_S,padding:xx},onClick:()=>{!t.link&&!u&&e({showHyperlinkPopup:"editor"})},children:[u?g("input",{className:Ee("excalidraw-hyperlinkContainer-input"),placeholder:"Type or paste your link here",ref:c,value:a,onChange:v=>l(v.target.value),autoFocus:!0,onKeyDown:v=>{v.stopPropagation(),v[z.CTRL_OR_CMD]&&v.key===z.K&&v.preventDefault(),(v.key===z.ENTER||v.key===z.ESCAPE)&&(d(),e({showHyperlinkPopup:"info"}))}}):t.link?g("a",{href:ao(t.link||""),className:"excalidraw-hyperlinkContainer-link",target:rD(t.link)?"_self":"_blank",onClick:v=>{if(t.link&&n){const y=fR(ee.EXCALIDRAW_LINK,v.nativeEvent);n({...t,link:ao(t.link)},y),y.defaultPrevented&&v.preventDefault()}},rel:"noopener noreferrer",children:t.link}):g("div",{className:"excalidraw-hyperlinkContainer-link",children:I("labels.link.empty")}),M("div",{className:"excalidraw-hyperlinkContainer__buttons",children:[!u&&g(st,{type:"button",title:I("buttons.edit"),"aria-label":I("buttons.edit"),label:I("buttons.edit"),onClick:f,className:"excalidraw-hyperlinkContainer--edit",icon:pS}),o&&!ur(t)&&g(st,{type:"button",title:I("buttons.remove"),"aria-label":I("buttons.remove"),label:I("buttons.remove"),onClick:h,className:"excalidraw-hyperlinkContainer--remove",icon:Gv})]})]})},oD=(t,e)=>{const[n,r]=Ve(t),{x:i,y:s}=li({sceneX:n+t.width/2,sceneY:r},e),o=i-e.offsetLeft-_S/2,a=s-e.offsetTop-sD;return{x:o,y:a}},sne=ue({name:"hyperlink",perform:(t,e)=>e.showHyperlinkPopup==="editor"?!1:{elements:t,appState:{...e,showHyperlinkPopup:"editor",openMenu:null},commitToHistory:!0},trackEvent:{category:"hyperlink",action:"click"},keyTest:t=>t[z.CTRL_OR_CMD]&&t.key===z.K,contextItemLabel:(t,e)=>RI(t,e),predicate:(t,e)=>Rt(t,e).length===1,PanelComponent:({elements:t,appState:e,updateData:n})=>{const r=Rt(t,e);return g(st,{type:"button",icon:KO,"aria-label":I(RI(t,e)),title:`${ur(t[0])?I("labels.link.labelEmbed"):I("labels.link.label")} - ${re("CtrlOrCmd+K")}`,onClick:()=>n(null),selected:r.length===1&&!!r[0].link})}}),RI=(t,e)=>{const n=Rt(t,e);return n[0].link?ur(n[0])?"labels.link.editEmbed":"labels.link.edit":ur(n[0])?"labels.link.createEmbed":"labels.link.create"},Wv=([t,e,n,r],i,s)=>{const o=Aoe,a=o/s.zoom.value,l=o/s.zoom.value,c=o/s.zoom.value,u=(t+n)/2,d=(e+r)/2,h=(o-8)/(2*s.zoom.value),f=4/s.zoom.value,p=n+f-h,m=e-f-c+h,[v,y]=et(p+a/2,m+l/2,u,d,i);return[v-a/2,y-l/2,a,l]},aD=(t,e,[n,r])=>{const i=4/e.zoom.value,[s,o,a,l]=Ve(t),[c,u,d,h]=Wv([s,o,a,l],t.angle,e);return n>c-i&&n<c+i+d&&r>u-i&&r<u+h+i},o_=(t,e,[n,r],i)=>{if(!t.link||e.selectedElementIds[t.id])return!1;const s=4/e.zoom.value;return!i&&e.viewModeEnabled&&Xv(t,[n,r],s,null)?!0:aD(t,e,[n,r])};let Kf=null;const one=(t,e)=>{Kf&&clearTimeout(Kf),Kf=window.setTimeout(()=>ane(t,e),DV)},ane=(t,e)=>{if(!t.link)return;const n=Zf();n.classList.add("excalidraw-tooltip--visible"),n.style.maxWidth="20rem",n.textContent=t.link;const[r,i,s,o]=Ve(t),[a,l,c,u]=Wv([r,i,s,o],t.angle,e),d=li({sceneX:a,sceneY:l},e);tD(n,{left:d.x,top:d.y,width:c,height:u},"top"),at("hyperlink","tooltip","link-icon"),Tx=!0},lne=()=>{Kf&&clearTimeout(Kf),Tx&&(Tx=!1,Zf().classList.remove("excalidraw-tooltip--visible"))},cne=(t,e,[n,r])=>{const{x:i,y:s}=Ft({clientX:n,clientY:r},e),o=15/e.zoom.value;if(Xv(t,[i,s],o,null))return!1;const[a,l,c]=Ve(t);if(i>=a&&i<=c&&s>=l-sD&&s<=l)return!1;const{x:u,y:d}=oD(t,e);return!(n>=u-o&&n<=u+_S+xx*2+o&&r>=d-o&&r<=d+o+xx*2+tne)},une="#ff6b6b",dne="#ff0000",OI=1,DI=2,hne=(t,e)=>{if(!e.snapLines.length)return;const n=e.theme==="light"||e.zenModeEnabled?une:dne,r=(e.zenModeEnabled?OI*1.5:OI)/e.zoom.value;t.save(),t.translate(e.scrollX,e.scrollY);for(const i of e.snapLines)i.type==="pointer"?(t.lineWidth=r,t.strokeStyle=n,pne(i,t,e)):i.type==="gap"?(t.lineWidth=r,t.strokeStyle=n,mne(i.points[0],i.points[1],i.direction,e,t)):i.type==="points"&&(t.lineWidth=r,t.strokeStyle=n,fne(i,t,e));t.restore()},fne=(t,e,n)=>{if(!n.zenModeEnabled){const r=t.points[0],i=t.points[t.points.length-1];vi(r,i,e)}for(const r of t.points)lD(r,n,e)},pne=(t,e,n)=>{lD(t.points[0],n,e),n.zenModeEnabled||vi(t.points[0],t.points[1],e)},lD=([t,e],n,r)=>{r.save();const i=(n.zenModeEnabled?DI*1.5:DI)/n.zoom.value;r.beginPath(),r.moveTo(t-i,e-i),r.lineTo(t+i,e+i),r.moveTo(t+i,e-i),r.lineTo(t-i,e+i),r.stroke(),r.restore()},vi=(t,e,n)=>{n.beginPath(),n.lineTo(...t),n.lineTo(...e),n.stroke()},mne=(t,e,n,r,i)=>{const s=8/r.zoom.value,o=s/2,a=s/4;if(n==="horizontal"){const l=[(t[0]+e[0])/2,t[1]];r.zenModeEnabled||vi([t[0],t[1]-s],[t[0],t[1]+s],i),vi([l[0]-a,l[1]-o],[l[0]-a,l[1]+o],i),vi([l[0]+a,l[1]-o],[l[0]+a,l[1]+o],i),r.zenModeEnabled||(vi([e[0],e[1]-s],[e[0],e[1]+s],i),vi(t,e,i))}else{const l=[t[0],(t[1]+e[1])/2];r.zenModeEnabled||vi([t[0]-s,t[1]],[t[0]+s,t[1]],i),vi([l[0]-o,l[1]-a],[l[0]+o,l[1]-a],i),vi([l[0]-o,l[1]+a],[l[0]+o,l[1]+a],i),r.zenModeEnabled||(vi([e[0]-s,e[1]],[e[0]+s,e[1]],i),vi(t,e,i))}};(()=>{var r,i,s;(r=Path2D.prototype).roundRect??(r.roundRect=t),globalThis.CanvasRenderingContext2D&&((i=globalThis.CanvasRenderingContext2D.prototype).roundRect??(i.roundRect=t)),globalThis.OffscreenCanvasRenderingContext2D&&((s=globalThis.OffscreenCanvasRenderingContext2D.prototype).roundRect??(s.roundRect=t));function t(o,a,l,c,u){if(![o,a,l,c].every(x=>Number.isFinite(x)))return;u=b(u);let d,h,f,p;if(u.length===4)d=E(u[0]),h=E(u[1]),f=E(u[2]),p=E(u[3]);else if(u.length===3)d=E(u[0]),h=E(u[1]),p=E(u[1]),f=E(u[2]);else if(u.length===2)d=E(u[0]),f=E(u[0]),h=E(u[1]),p=E(u[1]);else if(u.length===1)d=E(u[0]),h=E(u[0]),f=E(u[0]),p=E(u[0]);else throw new RangeError(`${e(this)} ${u.length} is not a valid size for radii sequence.`);const m=[d,h,f,p],v=m.find(({x,y:T})=>x<0||T<0);if((v==null?void 0:v.x)<0?v.x:v==null||v.y,m.some(({x,y:T})=>!Number.isFinite(x)||!Number.isFinite(T)))return;if(v)throw new RangeError(`${e(this)} Radius value ${v} is negative.`);w(m),l<0&&c<0?(this.moveTo(o-d.x,a),this.ellipse(o+l+h.x,a-h.y,h.x,h.y,0,-Math.PI*1.5,-Math.PI),this.ellipse(o+l+f.x,a+c+f.y,f.x,f.y,0,-Math.PI,-Math.PI/2),this.ellipse(o-p.x,a+c+p.y,p.x,p.y,0,-Math.PI/2,0),this.ellipse(o-d.x,a-d.y,d.x,d.y,0,0,-Math.PI/2)):l<0?(this.moveTo(o-d.x,a),this.ellipse(o+l+h.x,a+h.y,h.x,h.y,0,-Math.PI/2,-Math.PI,1),this.ellipse(o+l+f.x,a+c-f.y,f.x,f.y,0,-Math.PI,-Math.PI*1.5,1),this.ellipse(o-p.x,a+c-p.y,p.x,p.y,0,Math.PI/2,0,1),this.ellipse(o-d.x,a+d.y,d.x,d.y,0,0,-Math.PI/2,1)):c<0?(this.moveTo(o+d.x,a),this.ellipse(o+l-h.x,a-h.y,h.x,h.y,0,Math.PI/2,0,1),this.ellipse(o+l-f.x,a+c+f.y,f.x,f.y,0,0,-Math.PI/2,1),this.ellipse(o+p.x,a+c+p.y,p.x,p.y,0,-Math.PI/2,-Math.PI,1),this.ellipse(o+d.x,a-d.y,d.x,d.y,0,-Math.PI,-Math.PI*1.5,1)):(this.moveTo(o+d.x,a),this.ellipse(o+l-h.x,a+h.y,h.x,h.y,0,-Math.PI/2,0),this.ellipse(o+l-f.x,a+c-f.y,f.x,f.y,0,0,Math.PI/2),this.ellipse(o+p.x,a+c-p.y,p.x,p.y,0,Math.PI/2,Math.PI),this.ellipse(o+d.x,a+d.y,d.x,d.y,0,Math.PI,Math.PI*1.5)),this.closePath(),this.moveTo(o,a);function y(x){const{x:T,y:C,z:k,w:L}=x;return{x:T,y:C,z:k,w:L}}function b(x){const T=typeof x;return T==="undefined"||x===null?[0]:T==="function"?[NaN]:T==="object"?typeof x[Symbol.iterator]=="function"?[...x].map(C=>{const k=typeof C;return k==="undefined"||C===null?0:k==="function"?NaN:k==="object"?y(C):_(C)}):[y(x)]:[_(x)]}function _(x){return+x}function E(x){const T=_(x);return Number.isFinite(T)?{x:T,y:T}:Object(x)===x?{x:_(x.x??0),y:_(x.y??0)}:{x:NaN,y:NaN}}function w(x){const[T,C,k,L]=x,F=[Math.abs(l)/(T.x+C.x),Math.abs(c)/(C.y+k.y),Math.abs(l)/(k.x+L.x),Math.abs(c)/(T.y+L.y)],N=Math.min(...F);if(N<=1)for(const R of x)R.x*=N,R.y*=N}}function e(o){return`Failed to execute 'roundRect' on '${n(o)}':`}function n(o){return Object(o)===o&&o instanceof Path2D?"Path2D":o instanceof(globalThis==null?void 0:globalThis.CanvasRenderingContext2D)?"CanvasRenderingContext2D":o instanceof(globalThis==null?void 0:globalThis.OffscreenCanvasRenderingContext2D)?"OffscreenCanvasRenderingContext2D":(o==null?void 0:o.constructor.name)||o}})();const Kp=2,zm=(t,e,n,r,i,s,o,a,l=!1,c=0)=>{t.save(),t.translate(s,o),t.rotate(a),l&&t.fillRect(e-s,n-o,r,i),c&&t.roundRect?(t.beginPath(),t.roundRect(e-s,n-o,r,i,c),t.stroke(),t.closePath()):t.strokeRect(e-s,n-o,r,i),t.restore()},gne=(t,e,n,r,i,s)=>{t.save(),t.translate(r,i),t.rotate(s),t.beginPath(),t.moveTo(0,n/2),t.lineTo(e/2,0),t.lineTo(0,-n/2),t.lineTo(-e/2,0),t.closePath(),t.stroke(),t.restore()},yne=(t,e,n,r,i,s)=>{t.beginPath(),t.ellipse(r,i,e/2,n/2,s,0,Math.PI*2),t.stroke()},jv=(t,e,n,r,i=!0)=>{t.beginPath(),t.arc(e,n,r,0,Math.PI*2),t.fill(),i&&t.stroke()},vne=(t,e,n,r,i,s,o)=>{const l=-Math.round(i.value/e)*e+n%e,c=-Math.round(i.value/e)*e+r%e,u=Math.min(1/i.value,1),d=1/i.value,h=[u*3,d+(u+d)];t.save(),t.lineWidth=u;for(let f=l;f<l+s+e*2;f+=e){const p=Math.round(f-n)%(5*e)===0;t.beginPath(),t.setLineDash(p?[]:h),t.strokeStyle=p?Uo.Bold:Uo.Regular,t.moveTo(f,c-e),t.lineTo(f,c+o+e*2),t.stroke()}for(let f=c;f<c+o+e*2;f+=e){const p=Math.round(f-r)%(5*e)===0;t.beginPath(),t.setLineDash(p?[]:h),t.strokeStyle=p?Uo.Bold:Uo.Regular,t.moveTo(l-e,f),t.lineTo(l+s+e*2,f),t.stroke()}t.restore()},Q1=(t,e,n,r,i,s=!1)=>{t.strokeStyle="#5e5ad8",t.setLineDash([]),t.fillStyle="rgba(255, 255, 255, 0.9)",i?t.fillStyle="rgba(134, 131, 226, 0.9)":s&&(t.fillStyle="rgba(177, 151, 252, 0.7)"),jv(t,n[0],n[1],r/e.zoom.value,!s)},a_=(t,e,n)=>{if(!e.selectedLinearElement)return;t.save(),t.translate(e.scrollX,e.scrollY),t.lineWidth=1/e.zoom.value;const r=Ae.getPointsGlobalCoordinates(n),{POINT_HANDLE_SIZE:i}=Ae,s=e.editingLinearElement?i:i/2;r.forEach((a,l)=>{var u,d;const c=!!((d=(u=e.editingLinearElement)==null?void 0:u.selectedPointsIndices)!=null&&d.includes(l));Q1(t,e,a,s,c)}),Ae.getEditorMidPoints(n,e).filter(a=>a!==null).forEach(a=>{var l;(l=e==null?void 0:e.selectedLinearElement)!=null&&l.segmentMidPointHoveredCoords&&Ae.arePointsEqual(a,e.selectedLinearElement.segmentMidPointHoveredCoords)?e.editingLinearElement?(Q1(t,e,a,s,!1),Sx(a,t,e)):(Sx(a,t,e),Q1(t,e,a,s,!1)):(e.editingLinearElement||r.length===2)&&Q1(t,e,a,i/2,!1,!0)}),t.restore()},Sx=(t,e,n)=>{e.fillStyle="rgba(105, 101, 219, 0.4)",jv(e,t[0],t[1],Ae.POINT_HANDLE_SIZE/n.zoom.value,!1)},bne=(t,e)=>{var o,a;const{elementId:n,hoverPointIndex:r}=e.selectedLinearElement;if((a=(o=e.editingLinearElement)==null?void 0:o.selectedPointsIndices)!=null&&a.includes(r))return;const i=Ae.getElement(n);if(!i)return;const s=Ae.getPointAtIndexGlobalCoordinates(i,r);t.save(),t.translate(e.scrollX,e.scrollY),Sx(s,t,e),t.restore()},NI=(t,e,n,r)=>{e.translate(t.x+r.scrollX,t.y+r.scrollY),e.beginPath(),e.roundRect?e.roundRect(0,0,t.width,t.height,Pt.radius/r.zoom.value):e.rect(0,0,t.width,t.height),e.clip(),e.translate(-(t.x+r.scrollX),-(t.y+r.scrollY))},wS=(t,e)=>[t.width/e,t.height/e],cD=({canvas:t,scale:e,normalizedWidth:n,normalizedHeight:r,theme:i,isExporting:s,viewBackgroundColor:o})=>{const a=t.getContext("2d");return a.setTransform(1,0,0,1,0,0),a.scale(e,e),s&&i==="dark"&&(a.filter=PT),typeof o=="string"?((o==="transparent"||o.length===5||o.length===9||/(hsla|rgba)\(/.test(o))&&a.clearRect(0,0,n,r),a.save(),a.fillStyle=o,a.fillRect(0,0,n,r),a.restore()):a.clearRect(0,0,n,r),a},uD=({canvas:t,elements:e,visibleElements:n,selectedElements:r,scale:i,appState:s,renderConfig:o})=>{var f,p;if(t===null)return{atLeastOneVisibleElement:!1,elements:e};const[a,l]=wS(t,i),c=cD({canvas:t,scale:i,normalizedWidth:a,normalizedHeight:l});c.save(),c.scale(s.zoom.value,s.zoom.value);let u;if(n.forEach(m=>{var v;((v=s.editingLinearElement)==null?void 0:v.elementId)===m.id&&m&&(u=m)}),u&&a_(c,s,u),s.selectionElement)try{Moe(s.selectionElement,c,s)}catch(m){console.error(m)}s.isBindingEnabled&&s.suggestedBindings.filter(m=>m!=null).forEach(m=>{wne(c,s,m)}),s.frameToHighlight&&Tne(c,s,s.frameToHighlight),s.elementsToHighlight&&Sne(c,s,s.elementsToHighlight);const d=r.some(m=>qe(m));if(r.length===1&&((f=s.editingLinearElement)==null?void 0:f.elementId)===r[0].id&&a_(c,s,r[0]),s.selectedLinearElement&&s.selectedLinearElement.hoverPointIndex>=0&&bne(c,s),!s.multiElement&&!s.editingLinearElement){const m=TS(r,s);r.length===1&&Je(r[0])&&((p=s.selectedLinearElement)==null?void 0:p.elementId)===r[0].id&&!r[0].locked&&a_(c,s,r[0]);const y=o.selectionColor||Jt.black;if(m){const b=r.reduce((w,x)=>(w[x.id]=!0,w),{}),_=e.reduce((w,x)=>{var C;const T=[];if(b[x.id]&&!dS(s,x)&&T.push(y),o.remoteSelectedElementIds[x.id]&&T.push(...o.remoteSelectedElementIds[x.id].map(k=>vy(k))),T.length){const[k,L,F,N,R,H]=Ve(x,!0);w.push({angle:x.angle,elementX1:k,elementY1:L,elementX2:F,elementY2:N,selectionColors:T,dashed:!!o.remoteSelectedElementIds[x.id],cx:R,cy:H,activeEmbeddable:((C=s.activeEmbeddable)==null?void 0:C.element)===x&&s.activeEmbeddable.state==="active"})}return w},[]),E=w=>{const x=Gn(e,w),[T,C,k,L]=Ut(x);_.push({angle:0,elementX1:T,elementX2:k,elementY1:C,elementY2:L,selectionColors:[Jt.black],dashed:!0,cx:T+(k-T)/2,cy:C+(L-C)/2,activeEmbeddable:!1})};for(const w of Cd(s))E(w);s.editingGroupId&&E(s.editingGroupId),_.forEach(w=>mD(c,s,w))}if(c.save(),c.translate(s.scrollX,s.scrollY),r.length===1){c.fillStyle=Jt.white;const b=yD(r[0],s.zoom,"mouse");!s.viewModeEnabled&&m&&FI(c,o,s,b,r[0].angle)}else if(r.length>1&&!s.isRotating){const b=Kp*2/s.zoom.value;c.fillStyle=Jt.white;const[_,E,w,x]=Ut(r),T=c.getLineDash();c.setLineDash([2/s.zoom.value]);const C=c.lineWidth;c.lineWidth=1/s.zoom.value,c.strokeStyle=y,zm(c,_-b,E-b,w-_+b*2,x-E+b*2,(_+w)/2,(E+x)/2,0),c.lineWidth=C,c.setLineDash(T);const k=xS([_,E,w,x,(_+w)/2,(E+x)/2],0,s.zoom,"mouse",d?kne:gD);r.some(L=>!L.locked)&&FI(c,o,s,k,0)}c.restore()}hne(c,s),c.restore();for(const m in o.remotePointerViewportCoords){let{x:v,y}=o.remotePointerViewportCoords[m];v-=s.offsetLeft,y-=s.offsetTop;const b=11,_=14,E=v<0||v>a-b||y<0||y>l-_;v=Math.max(v,0),v=Math.min(v,a-b),y=Math.max(y,0),y=Math.min(y,l-_);const w=vy(m);c.save(),c.strokeStyle=w,c.fillStyle=w;const x=o.remotePointerUserStates[m],T=E||x===mc.IDLE||x===mc.AWAY;T&&(c.globalAlpha=.3),o.remotePointerButton&&o.remotePointerButton[m]==="down"&&(c.beginPath(),c.arc(v,y,15,0,2*Math.PI,!1),c.lineWidth=3,c.strokeStyle="#ffffff88",c.stroke(),c.closePath(),c.beginPath(),c.arc(v,y,15,0,2*Math.PI,!1),c.lineWidth=1,c.strokeStyle=w,c.stroke(),c.closePath()),c.fillStyle=Jt.white,c.strokeStyle=Jt.white,c.lineWidth=6,c.lineJoin="round",c.beginPath(),c.moveTo(v,y),c.lineTo(v+0,y+14),c.lineTo(v+4,y+9),c.lineTo(v+11,y+8),c.closePath(),c.stroke(),c.fill(),c.fillStyle=w,c.strokeStyle=w,c.lineWidth=2,c.lineJoin="round",c.beginPath(),T?(c.moveTo(v-1,y-1),c.lineTo(v-1,y+15),c.lineTo(v+5,y+10),c.lineTo(v+12,y+9),c.closePath(),c.fill()):(c.moveTo(v,y),c.lineTo(v+0,y+14),c.lineTo(v+4,y+9),c.lineTo(v+11,y+8),c.closePath(),c.fill(),c.stroke());const C=o.remotePointerUsernames[m]||"";if(!E&&C){c.font="600 12px sans-serif";const k=v+b/2,L=y+_+2,F=5,N=3,R=c.measureText(C),H=R.actualBoundingBoxDescent+R.actualBoundingBoxAscent,W=Math.max(H,12),q=k-1,Z=L-1,j=R.width+2+F*2+2,K=W+2+N*2+2;c.roundRect?(c.beginPath(),c.roundRect(q,Z,j,K,8),c.fillStyle=w,c.fill(),c.strokeStyle=Jt.white,c.stroke()):CI(c,q,Z,j,K,8,Jt.white),c.fillStyle=Jt.black,c.fillText(C,k+F+1,L+N+R.actualBoundingBoxAscent+Math.floor((W-H)/2)+2)}c.restore(),c.closePath()}let h;return o.renderScrollbars&&(h=$de(e,a,l,s),c.save(),c.fillStyle=Ude,c.strokeStyle="rgba(255,255,255,0.8)",[h.horizontal,h.vertical].forEach(m=>{m&&CI(c,m.x,m.y,m.width,m.height,Ya/2)}),c.restore()),{scrollBars:h,atLeastOneVisibleElement:n.length>0,elements:e}},dD=({canvas:t,rc:e,elements:n,visibleElements:r,scale:i,appState:s,renderConfig:o})=>{if(t===null)return;const{renderGrid:a=!0,isExporting:l}=o,[c,u]=wS(t,i),d=new Set;r.forEach(f=>{f.groupIds.length>0&&s.frameToHighlight&&s.selectedElementIds[f.id]&&(qd(f,s.frameToHighlight)||f.groupIds.find(p=>d.has(p)))&&f.groupIds.forEach(p=>d.add(p))});const h=cD({canvas:t,scale:i,normalizedWidth:c,normalizedHeight:u,theme:s.theme,isExporting:l,viewBackgroundColor:s.viewBackgroundColor});h.scale(s.zoom.value,s.zoom.value),a&&s.gridSize&&vne(h,s.gridSize,s.scrollX,s.scrollY,s.zoom,c/s.zoom.value,u/s.zoom.value),r.filter(f=>!Yp(f)).forEach(f=>{var p;try{if((f.frameId||((p=s.frameToHighlight)==null?void 0:p.id))&&s.frameRendering.enabled&&s.frameRendering.clip){h.save();const v=fm(f,s);v&&iu(f,n,s)&&NI(v,h,o,s),sg(f,e,h,o,s),h.restore()}else sg(f,e,h,o,s);l||BI(f,h,s)}catch(m){console.error(m)}}),r.filter(f=>Yp(f)).forEach(f=>{var p;try{const m=()=>{if(sg(f,e,h,o,s),os(f)&&(l||ur(f)&&!f.validated)&&f.width&&f.height){const y=fS(f);sg(y,e,h,o,s)}l||BI(f,h,s)};if((f.frameId||((p=s.frameToHighlight)==null?void 0:p.id))&&s.frameRendering.enabled&&s.frameRendering.clip){h.save();const y=fm(f,s);y&&iu(f,n,s)&&NI(y,h,o,s),m(),h.restore()}else m()}catch(m){console.error(m)}})},hD=Mm(t=>{var n;const e=uD(t);(n=t.callback)==null||n.call(t,e)},{trailing:!0}),_ne=(t,e)=>{if(e){hD(t);return}const n=uD(t);return t.callback(n),n},fD=Mm(t=>{dD(t)},{trailing:!0}),pD=(t,e)=>{if(e){fD(t);return}dD(t)},Ene=()=>{hD.cancel(),fD.cancel()},FI=(t,e,n,r,i)=>{Object.keys(r).forEach(s=>{const o=r[s];if(o!==void 0){const[a,l,c,u]=o;t.save(),t.lineWidth=1/n.zoom.value,e.selectionColor&&(t.strokeStyle=e.selectionColor),s==="rotation"?jv(t,a+c/2,l+u/2,c/2):t.roundRect?(t.beginPath(),t.roundRect(a,l,c,u,2/n.zoom.value),t.fill(),t.stroke()):zm(t,a,l,c,u,a+c/2,l+u/2,i,!0),t.restore()}})},mD=(t,e,n,r=Kp*2)=>{const{angle:i,elementX1:s,elementY1:o,elementX2:a,elementY2:l,selectionColors:c,cx:u,cy:d,dashed:h,activeEmbeddable:f}=n,p=a-s,m=l-o,v=r/e.zoom.value,y=8/e.zoom.value,b=4/e.zoom.value;t.save(),t.translate(e.scrollX,e.scrollY),t.lineWidth=(f?4:1)/e.zoom.value;const _=c.length;for(let E=0;E<_;++E)t.strokeStyle=c[E],h&&t.setLineDash([y,b+(y+b)*(_-1)]),t.lineDashOffset=(y+b)*E,zm(t,s-v,o-v,p+v*2,m+v*2,u,d,i);t.restore()},wne=(t,e,n)=>{const r=Array.isArray(n)?Cne:xne;t.save(),t.translate(e.scrollX,e.scrollY),r(t,n),t.restore()},xne=(t,e)=>{const[n,r,i,s]=Ve(e),o=i-n,a=s-r,l=Yv(e,o,a),c=4;t.strokeStyle="rgba(0,0,0,.05)",t.lineWidth=l-c;const u=c/2+l/2;switch(e.type){case"rectangle":case"text":case"image":case"iframe":case"embeddable":case"frame":case"magicframe":zm(t,n-u,r-u,o+u*2,a+u*2,n+o/2,r+a/2,e.angle);break;case"diamond":const d=Math.hypot(o,a),h=u*d/a,f=u*d/o;gne(t,o+h*2,a+f*2,n+o/2,r+a/2,e.angle);break;case"ellipse":yne(t,o+u*2,a+u*2,n+o/2,r+a/2,e.angle);break}},Tne=(t,e,n)=>{const[r,i,s,o]=Ve(n),a=s-r,l=o-i;t.strokeStyle="rgb(0,118,255)",t.lineWidth=Pt.strokeWidth/e.zoom.value,t.save(),t.translate(e.scrollX,e.scrollY),zm(t,r,i,a,l,r+a/2,i+l/2,n.angle,!1,Pt.radius/e.zoom.value),t.restore()},Sne=(t,e,n)=>{const r=n.filter(a=>a.groupIds.length===0),i=n.filter(a=>a.groupIds.length>0),s=a=>{const[l,c,u,d]=Ut(a);return{angle:0,elementX1:l,elementX2:u,elementY1:c,elementY2:d,selectionColors:["rgb(0,118,255)"],dashed:!1,cx:l+(u-l)/2,cy:c+(d-c)/2,activeEmbeddable:!1}},o=a=>{const l=Gn(n,a);return s(l)};Object.entries(FO(i,e)).filter(([a,l])=>l).map(([a,l])=>a).map(a=>o(a)).concat(r.map(a=>s([a]))).forEach(a=>mD(t,e,a))},Cne=(t,e)=>{const[n,r,i]=e,s=Yv(i,i.width,i.height);t.strokeStyle="rgba(0,0,0,0)",t.fillStyle="rgba(0,0,0,.05)",(r==="both"?[0,-1]:r==="start"?[0]:[-1]).forEach(a=>{const[l,c]=Ae.getPointAtIndexGlobalCoordinates(n,a);jv(t,l,c,s)})};let wo;const BI=(t,e,n)=>{if(t.link&&!n.selectedElementIds[t.id]){const[r,i,s,o]=Ve(t),[a,l,c,u]=Wv([r,i,s,o],t.angle,n),d=a+c/2,h=l+u/2;if(e.save(),e.translate(n.scrollX+d,n.scrollY+h),e.rotate(t.angle),!wo||wo.zoom!==n.zoom.value){wo=document.createElement("canvas"),wo.zoom=n.zoom.value,wo.width=c*window.devicePixelRatio*n.zoom.value,wo.height=u*window.devicePixelRatio*n.zoom.value;const f=wo.getContext("2d");f.scale(window.devicePixelRatio*n.zoom.value,window.devicePixelRatio*n.zoom.value),f.fillStyle="#fff",f.fillRect(0,0,c,u),f.drawImage(ES,0,0,c,u),f.restore(),e.drawImage(wo,a-d,l-h,c,u)}else e.drawImage(wo,a-d,l-h,c,u);e.restore()}},Ine=(t,e,n,r,i)=>{n&&(t.filter(s=>!Yp(s)).forEach(s=>{if(!s.isDeleted)try{Gx(s,e,n,r,s.x+i.offsetX,s.y+i.offsetY,i)}catch(o){console.error(o)}}),t.filter(s=>os(s)).forEach(s=>{if(!s.isDeleted)try{Gx(s,e,n,r,s.x+i.offsetX,s.y+i.offsetY,i)}catch(o){console.error(o)}}))},UI={mouse:8,pen:16,touch:28},Ane=16,gD={e:!0,s:!0,n:!0,w:!0},kne={e:!0,s:!0,n:!0,w:!0,rotation:!0},Mne={e:!0,s:!0,n:!0,w:!0},$I={e:!0,s:!0,n:!0,w:!0,nw:!0,se:!0},l_={e:!0,s:!0,n:!0,w:!0},xo=(t,e,n,r,i,s,o)=>{const[a,l]=et(t+n/2,e+r/2,i,s,o);return[a-n/2,l-r/2,n,r]},xS=([t,e,n,r,i,s],o,a,l,c={},u=4)=>{const d=UI[l],h=d/a.value,f=d/a.value,p=d/a.value,m=d/a.value,v=n-t,y=r-e,b=u/a.value,_=(d-Kp*2)/(2*a.value),E={nw:c.nw?void 0:xo(t-b-p+_,e-b-m+_,h,f,i,s,o),ne:c.ne?void 0:xo(n+b-_,e-b-m+_,h,f,i,s,o),sw:c.sw?void 0:xo(t-b-p+_,r+b-_,h,f,i,s,o),se:c.se?void 0:xo(n+b-_,r+b-_,h,f,i,s,o),rotation:c.rotation?void 0:xo(t+v/2-h/2,e-b-m+_-Ane/a.value,h,f,i,s,o)},w=5*UI.mouse/a.value;return Math.abs(v)>w&&(c.n||(E.n=xo(t+v/2-h/2,e-b-m+_,h,f,i,s,o)),c.s||(E.s=xo(t+v/2-h/2,r+b-_,h,f,i,s,o))),Math.abs(y)>w&&(c.w||(E.w=xo(t-b-p+_,e+y/2-f/2,h,f,i,s,o)),c.e||(E.e=xo(n+b-_,e+y/2-f/2,h,f,i,s,o))),E},yD=(t,e,n="mouse")=>{if(t.locked)return{};let r={};if(t.type==="freedraw"||Je(t)){if(t.points.length===2){const[,s]=t.points;s[0]===0||s[1]===0?r=l_:s[0]>0&&s[1]<0?r=$I:s[0]>0&&s[1]>0?r=l_:s[0]<0&&s[1]>0?r=$I:s[0]<0&&s[1]<0&&(r=l_)}}else Se(t)?r=Mne:qe(t)&&(r={rotation:!0});const i=Je(t)?Kp+8:Kp;return xS(Ve(t,!0),t.angle,e,n,r,i)},TS=(t,e)=>{if(e.editingLinearElement)return!1;if(t.length>1)return!0;const n=t[0];return Je(n)?n.points.length>2:!0},Pne=t=>{if(t.type==="arrow")return!1;if(t.type==="freedraw")return!0;const e=!to(t.backgroundColor)||vl(t)||os(t);return t.type==="line"?e&&sa(t.points):e||Wo(t)},Ey=(t,e,n,r,i)=>{const s=10/e.zoom.value,o=[r,i];if(Lne(e,t)&&TS([t],e))return Xv(t,o,s,n);const a=tt(t);return a&&Ey(a,e,n,r,i)?!0:qp(t,e,n,o)},c_=(t,e,n,r,i)=>{const s=10/e.zoom.value,o=tt(t);return o&&Ey(o,e,n,r,i)?!1:!qp(t,e,n,[r,i])&&Xv(t,[r,i],s,n)},qp=(t,e,n,r)=>{const i=10/e.zoom.value,s=Se(t)?Rne:Pne(t)?qf:One;return SS({element:t,point:r,threshold:i,check:s,frameNameBoundsCache:n})},Lne=(t,e)=>t.selectedElementIds[e.id],Xv=(t,[e,n],r,i)=>{if(qe(t))return SS({element:t,point:[e,n],threshold:r,check:qf,frameNameBoundsCache:i});const[s,o,a,l]=Ve(t),c=(s+a)/2,u=(o+l)/2,[d,h]=et(e,n,c,u,-t.angle);return d>s-r&&d<a+r&&h>o-r&&h<l+r},vD=(t,{x:e,y:n})=>{const r=Yv(t,t.width,t.height);return SS({element:t,point:[e,n],threshold:r,check:Dne,frameNameBoundsCache:null})},Yv=(t,e,n)=>{const i=(t.type==="diamond"?1/Math.sqrt(2):1)*Math.min(e,n);return Math.max(16,Math.min(.25*i,32))},SS=t=>{var e;switch(t.element.type){case"rectangle":case"iframe":case"embeddable":case"image":case"text":case"diamond":case"ellipse":const n=Cx(t.element,t.point);return t.check(n,t.threshold);case"freedraw":return t.check(bD(t.element,t.point),t.threshold)?$ne(t.element,t.point,t.threshold):!1;case"arrow":case"line":return Hne(t);case"selection":return console.warn("This should not happen, we need to investigate why it does."),!1;case"frame":case"magicframe":{if(t.check(Cx(t.element,t.point),t.threshold))return!0;const r=(e=t.frameNameBoundsCache)==null?void 0:e.get(t.element);return r?t.check(Nne(r,t.point),t.threshold):!1}}},Cx=(t,e)=>{switch(t.type){case"rectangle":case"image":case"text":case"iframe":case"embeddable":case"frame":case"magicframe":return bD(t,e);case"diamond":return Fne(t,e);case"ellipse":return Bne(t,e)}},Rne=(t,e)=>t<0,qf=(t,e)=>t<e,One=(t,e)=>Math.abs(t)<e,Dne=(t,e)=>0<=t&&t<e,bD=(t,e)=>{const[,n,r,i]=Zv(t,e);return Math.max(ws(n,Wc(0,1,-i)),ws(n,Wc(1,0,-r)))},Nne=(t,e)=>{const[,n,r,i]=zne(e,t);return Math.max(ws(n,Wc(0,1,-i)),ws(n,Wc(1,0,-r)))},Fne=(t,e)=>{const[,n,r,i]=Zv(t,e),s=Wc(i,r,-i*r);return ws(n,s)},Bne=(t,e)=>{const[n,r]=Une(t,e);return-hQ(r)*ws(n,r)},Une=(t,e)=>{const[,n,r,i]=Zv(t,e),[s,o]=Xc(n);let a=.707,l=.707;const c=r,u=i;[0,1,2,3].forEach(f=>{const p=c*a,m=u*l,v=(c*c-u*u)*a**3/c,y=(u*u-c*c)*l**3/u,b=p-v,_=m-y,E=s-v,w=o-y,x=Math.hypot(_,b),T=Math.hypot(w,E);a=Math.min(1,Math.max(0,(E*x/T+v)/c)),l=Math.min(1,Math.max(0,(w*x/T+y)/u));const C=Math.hypot(l,a);a/=C,l/=C});const d=Ar(c*a,u*l),h=dQ(n,d);return[n,h]},$ne=(t,e,n)=>{let r,i;if(t.angle===0)r=e[0]-t.x,i=e[1]-t.y;else{const[c,u,d,h]=Ve(t),f=Wt(e,[c+(d-c)/2,u+(h-u)/2],-t.angle);r=f[0]-t.x,i=f[1]-t.y}let[s,o]=t.points,a;if(vn(s[0],s[1],r,i)<n||vn(o[0],o[1],r,i)<n)return!0;for(let c=0;c<t.points.length;c++){const u=[o[0]-s[0],o[1]-s[1]],d=Math.hypot(u[1],u[0]),h=[u[0]/d,u[1]/d],f=[r-s[0],i-s[1]],p=(f[0]*h[0]+f[1]*h[1])/Math.hypot(h[1],h[0]);a=[s[0]+h[0]*p,s[1]+h[1]*p];const m=vn(a[0],a[1],s[0],s[1]),v=vn(a[0],a[1],o[0],o[1]);if(a=v<m&&m>d?o:m<v&&v>d?s:a,Math.hypot(i-a[1],r-a[0])<n)return!0;s=o,o=t.points[c+1]}const l=mt.get(t);return l&&l.sets.length?t.fillStyle==="solid"?IS(l,r,i,"round"):ED(l,r,i,n):!1},Hne=t=>{const{element:e,threshold:n}=t;if(!mt.get(e))return!1;const[r,i,s,o]=Zv(t.element,t.point),a=Wc(0,1,-o),l=Wc(1,0,-s);if(!qf(ws(i,a),n)||!qf(ws(i,l),n))return!1;const[c,u]=Xc(r),d=mt.get(e);return d?t.check===qf&&d.some(f=>IS(f,c,u,e.roundness?"round":"sharp"))?!0:d.some(h=>ED(h,c,u,n)):!1},Zv=(t,e)=>{const n=jc(e),[r,i,s,o]=Ve(t),a=Kv(r,i,s,o),l=uS(a,t.angle),c=gs(l,n),u=gy(c,cS(a)),d=OO(u),h=MO(t.x,t.y),f=gy(c,h),p=(s-r)/2,m=(o-i)/2;return[f,d,p,m]},zne=(t,e)=>{const n=jc(t),[r,i,s,o]=Boe(e),a=Kv(r,i,s,o),l=uS(a,e.angle),c=gs(l,n),u=gy(c,cS(a)),d=OO(u),h=MO(e.x,e.y),f=gy(c,h),p=(s-r)/2,m=(o-i)/2;return[f,d,p,m]},CS=t=>{const[e,n,r,i]=Ve(t),s=Kv(e,n,r,i),o=uS(s,t.angle),a=$v(mQ(cS(s)));return yQ(o,a)},Kv=(t,e,n,r)=>Ar((t+n)/2,(e+r)/2),Gne=(t,e,n)=>{const r=CS(t),i=gs(r,jc(e)),s=gs(r,jc(n)),o=$m(i,s),a=t.height/t.width,l=t.width/2,c=t.height/2,u=o[2],d=o[3],h=o[1],f=Math.abs(d),p=Math.abs(u);let m;switch(t.type){case"rectangle":case"image":case"text":case"iframe":case"embeddable":case"frame":case"magicframe":m=h/(l*(p+a*f));break;case"diamond":m=f<p?h/(p*l):h/(f*c);break;case"ellipse":m=h/(l*Math.sqrt(u**2+a**2*d**2));break}return m||0},Vne=(t,e,n)=>{if(e===0){const[a,l,c,u]=Ve(t),d=Kv(a,l,c,u);return Xc(d)}const r=CS(t),i=gs(r,jc(n)),s=$v(r);let o;switch(t.type){case"rectangle":case"image":case"text":case"diamond":case"iframe":case"embeddable":case"frame":case"magicframe":o=Jne(t,e,i);break;case"ellipse":o=qne(t,e,i);break}return Xc(gs(s,o))},Wne=(t,e,n,r=0)=>{const i=CS(t),s=gs(i,jc(e)),o=gs(i,jc(n)),a=$m(s,o),l=$v(i);return jne(t,a,s,r).map(u=>Xc(gs(l,u)))},jne=(t,e,n,r=0)=>{let i;switch(t.type){case"rectangle":case"image":case"text":case"diamond":case"iframe":case"embeddable":case"frame":case"magicframe":const o=_D(t);i=o.flatMap((a,l)=>{const c=[a,o[(l+1)%4]];return Xne(e,Yne(c,r))}).concat(o.flatMap(a=>Kne(a,r,e)));break;case"ellipse":i=Zne(t,r,e);break}if(i.length<2)return[];const s=i.sort((o,a)=>SI(o,n)-SI(a,n));return[s[0],s[s.length-1]]},_D=(t,e=1)=>{const n=e*t.width/2,r=e*t.height/2;switch(t.type){case"rectangle":case"image":case"text":case"iframe":case"embeddable":case"frame":case"magicframe":return[Ar(n,r),Ar(n,-r),Ar(-n,-r),Ar(-n,r)];case"diamond":return[Ar(0,r),Ar(n,0),Ar(0,-r),Ar(-n,0)]}},Xne=(t,e)=>{const[n,r]=e,i=ws(n,t),s=ws(r,t);return i*s>=0?[]:[fQ(t,$m(n,r))]},Yne=(t,e)=>{const[n,r]=t,i=gQ(pQ(n,r),e);return[gs(i,n),gs(i,r)]},Zne=(t,e,n)=>{const r=t.width/2+e,i=t.height/2+e,s=n[2],o=n[3],a=n[1],l=r*r*s*s+i*i*o*o,c=l-a*a;if(l===0||c<=0)return[];const u=Math.sqrt(c),d=-r*r*s*a,h=-i*i*o*a;return[Ar((d+r*i*o*u)/l,(h-r*i*s*u)/l),Ar((d-r*i*o*u)/l,(h+r*i*s*u)/l)]},Kne=(t,e,n)=>{if(e===0)return ws(n,t)===0?[t]:[];const r=n[2],i=n[3],s=n[1],[o,a]=Xc(t),l=e,c=r*r+i*i,u=l*l*c-(r*o+i*a+s)**2;if(c===0||u<=0)return[];const d=Math.sqrt(u),h=o*i*i-a*r*i-r*s,f=a*r*r-o*r*i-i*s;return[Ar((h+i*d)/c,(f-r*d)/c),Ar((h-i*d)/c,(f+r*d)/c)]},qne=(t,e,n)=>{const r=Math.abs(e),i=t.width*r/2,s=t.height*r/2,o=Math.sign(e),[a,l]=Xc(n),c=l===0?1e-4:l,u=a**2*s**2+c**2*i**2,d=(-a*s**2+o*c*Math.sqrt(Math.max(0,u-i**2*s**2)))/u;let h=(-d*a-1)/c;h===0&&(h=(Object.is(h,-0)?-1:1)*.01);const f=-(i**2*d)/(h**2*s**2+d**2*i**2);return Ar(f,(-d*f-1)/h)},Jne=(t,e,n)=>{const r=Math.abs(e),i=Math.sign(e),s=_D(t,r);let o=0,a=null;return s.forEach(l=>{const c=i*$m(n,l)[1];c>o&&(o=c,a=l)}),a},Qne=(t,e,n,r,[i,s],o)=>{const a=(c,u)=>Math.pow(1-c,3)*r[u]+3*c*Math.pow(1-c,2)*n[u]+3*Math.pow(c,2)*(1-c)*e[u]+t[u]*Math.pow(c,3);let l=0;for(;l<=1;){const c=a(l,0),u=a(l,1);if(Math.sqrt(Math.pow(c-i,2)+Math.pow(u-s,2))<o)return!0;l+=.01}return!1},IS=(t,e,n,r)=>{const i=Ol(t),s=[];let o=!1;for(const a of i)a.op==="move"?(o=!o,o&&s.push([a.data[0],a.data[1]])):a.op==="bcurveTo"?o&&(s.push([a.data[0],a.data[1]]),s.push([a.data[2],a.data[3]]),s.push([a.data[4],a.data[5]])):a.op==="lineTo"&&o&&s.push([a.data[0],a.data[1]]);if(s.length>=4){if(r==="sharp")return DA(s,e,n);const a=wQ(s,10,5);return DA(a,e,n)}return!1},ED=(t,e,n,r)=>{const i=Ol(t);let s=[0,0];return i.some(({op:o,data:a},l)=>{if(o==="move")s=a;else if(o==="bcurveTo"){const c=[a[0],a[1]],u=[a[2],a[3]],d=[a[4],a[5]],h=s;return s=d,Qne(h,c,u,d,[e,n],r)}else{if(o==="lineTo")return IS(t,e,n,"sharp");o==="qcurveTo"&&console.warn("qcurveTo is not implemented yet")}return!1})},ere=t=>!t[z.CTRL_OR_CMD],yc=t=>t.isBindingEnabled,wD=(t,e)=>{const n=[];return e.forEach(r=>{const i=t.getNonDeletedElement(r);i!=null&&n.push(i)}),n},fh=(t,e,n)=>{const r=new Set,i=new Set;HI(t,e,n,"start",r,i),HI(t,n,e,"end",r,i);const s=Array.from(i).filter(o=>!r.has(o));wD(bt.getScene(t),s).forEach(o=>{var a;ae(o,{boundElements:(a=o.boundElements)==null?void 0:a.filter(l=>l.type!=="arrow"||l.id!==t.id)})})},HI=(t,e,n,r,i,s)=>{if(e!=="keep")if(e!=null)(n==null||(n==="keep"?!AS(t,e,r):r==="start"||n.id!==e.id))&&(Jp(t,e,r),i.add(e.id));else{const o=nre(t,r);o!=null&&s.add(o)}},Ix=t=>{t.forEach(e=>{pr(e)?fh(e,wy(e,"start"),wy(e,"end")):jp(e)&&tre(e)})},tre=t=>{SD(t).forEach(([e,n])=>fh(e,n==="end"?"keep":t,n==="start"?"keep":t))},Ax=(t,e,n,r)=>{e.startBoundElement!=null&&Jp(t,e.startBoundElement,"start");const i=Ga(r,n);i!=null&&!AS(t,i,"end")&&Jp(t,i,"end")},Jp=(t,e,n)=>{ae(t,{[n==="start"?"startBinding":"endBinding"]:{elementId:e.id,...rre(t,e,n)}}),xn(e.boundElements||[]).has(t.id)||ae(e,{boundElements:(e.boundElements||[]).concat({id:t.id,type:"arrow"})})},AS=(t,e,n)=>{const r=t[n==="start"?"endBinding":"startBinding"];return xD(t,r==null?void 0:r.elementId,e)},xD=(t,e,n)=>e===n.id&&t.points.length<3,kx=t=>{t.forEach(e=>{pr(e)&&fh(e,null,null)})},nre=(t,e)=>{const n=e==="start"?"startBinding":"endBinding",r=t[n];return r==null?null:(ae(t,{[n]:null}),r.elementId)},Ga=(t,e)=>Gse(e.getNonDeletedElements(),r=>jp(r,!1)&&vD(r,t)),rre=(t,e,n)=>{const r=n==="start"?-1:1,i=r===-1?0:t.points.length-1,s=i-r,o=Ae.getPointAtIndexGlobalCoordinates(t,i),a=Ae.getPointAtIndexGlobalCoordinates(t,s);return{focus:Gne(e,a,o),gap:Math.max(1,Cx(e,o))}},wl=(t,e)=>{const n=(t.boundElements??[]).filter(o=>o.type==="arrow");if(n.length===0)return;const{newSize:r,simultaneouslyUpdated:i}=e??{},s=sre(i);wD(bt.getScene(t),n.map(o=>o.id)).forEach(o=>{if(!Je(o))return;const a=t;if(!ire(o,a))return;const l=GI(a,o.startBinding,r),c=GI(a,o.endBinding,r);if(s.has(o.id)){ae(o,{startBinding:l,endBinding:c});return}zI(o,"start",l,t),zI(o,"end",c,t),tt(o)&&l2(o,!1)})},ire=(t,e)=>{var n,r;return((n=t.startBinding)==null?void 0:n.elementId)===e.id||((r=t.endBinding)==null?void 0:r.elementId)===e.id},sre=t=>new Set((t||[]).map(e=>e.id)),zI=(t,e,n,r)=>{if(n==null||n.elementId!==r.id&&t.points.length>2)return;const i=bt.getScene(t).getElement(n.elementId);if(i==null)return;const s=e==="start"?-1:1,o=s===-1?0:t.points.length-1,a=o-s,l=Ae.getPointAtIndexGlobalCoordinates(t,a),c=Vne(i,n.focus,l);let u;if(n.gap===0)u=c;else{const d=Wne(i,l,c,n.gap);d.length===0?u=c:u=d[0]}Ae.movePoints(t,[{index:o,point:Ae.pointFromAbsoluteCoords(t,u)}],{[e==="start"?"startBinding":"endBinding"]:n})},GI=(t,e,n)=>{if(e==null||n==null)return e;const{gap:r,focus:i,elementId:s}=e,{width:o,height:a}=n,{width:l,height:c}=t,u=Math.max(1,Math.min(Yv(t,o,a),r*(o<a?o/l:a/c)));return{elementId:s,gap:u,focus:i}},ore=t=>{const e=new Set(t.map(({id:n})=>n));return t.flatMap(n=>pr(n,!1)?are(n).filter(r=>!e.has(r.id)):jp(n,!1)?SD(n).filter(r=>!e.has(r[0].id)):[])},are=t=>[wy(t,"start"),wy(t,"end")].filter(e=>e!=null),wy=(t,e)=>Ga(TD(t,e),bt.getScene(t)),TD=(t,e)=>{const n=e==="start"?0:-1;return $a(Ae.getPointAtIndexGlobalCoordinates(t,n))},SD=t=>bt.getScene(t).getNonDeletedElements().map(e=>{if(!pr(e,!1))return null;const n=VI(e,"start",t),r=VI(e,"end",t);return!n&&!r?null:[e,n&&r?"both":n?"start":"end",t]}).filter(e=>e!=null),VI=(t,e,n)=>t[e==="start"?"startBinding":"endBinding"]==null&&!AS(t,n,e)&&vD(n,TD(t,e)),CD=(t,e,n,r)=>{const i=new Set,s=new Set,o=r==="duplicatesServeAsOld";e.forEach(a=>{const{boundElements:l}=a;if(l!=null&&l.length>0&&(l.forEach(c=>{o&&!n.has(c.id)&&i.add(c.id)}),s.add(n.get(a.id))),pr(a)){if(a.startBinding!=null){const{elementId:c}=a.startBinding;o&&!n.has(c)&&s.add(c)}if(a.endBinding!=null){const{elementId:c}=a.endBinding;o&&!n.has(c)&&s.add(c)}(a.startBinding!=null||a.endBinding!=null)&&i.add(n.get(a.id))}}),t.filter(({id:a})=>i.has(a)).forEach(a=>{const{startBinding:l,endBinding:c}=a;ae(a,{startBinding:WI(l,n),endBinding:WI(c,n)})}),t.filter(({id:a})=>s.has(a)).forEach(a=>{const{boundElements:l}=a;l!=null&&l.length>0&&ae(a,{boundElements:l.map(c=>n.has(c.id)?{id:n.get(c.id),type:c.type}:c)})})},WI=(t,e)=>{if(t==null)return null;const{elementId:n,focus:r,gap:i}=t;return{focus:r,gap:i,elementId:e.get(n)??n}},kS=(t,e)=>{const n=new Set(e.map(i=>i.id)),r=new Set;e.forEach(i=>{var s;jp(i)?(s=i.boundElements)==null||s.forEach(o=>{n.has(o.id)||r.add(o.id)}):pr(i)&&(i.startBinding&&r.add(i.startBinding.elementId),i.endBinding&&r.add(i.endBinding.elementId))}),t.filter(({id:i})=>r.has(i)).forEach(i=>{jp(i)?ae(i,{boundElements:lre(i.boundElements,n)}):pr(i)&&ae(i,{startBinding:jI(i.startBinding,n),endBinding:jI(i.endBinding,n)})})},jI=(t,e)=>t==null||e.has(t.elementId)?null:t,lre=(t,e)=>t?t.filter(n=>!e.has(n.id)):null,To={version:null,points:[],zoom:null},xe=class xe{constructor(e,n){O(this,"elementId");O(this,"selectedPointsIndices");O(this,"pointerDownState");O(this,"isDragging");O(this,"lastUncommittedPoint");O(this,"pointerOffset");O(this,"startBindingElement");O(this,"endBindingElement");O(this,"hoverPointIndex");O(this,"segmentMidPointHoveredCoords");this.elementId=e.id,bt.mapElementToScene(this.elementId,n),xe.normalizePoints(e),this.selectedPointsIndices=null,this.lastUncommittedPoint=null,this.isDragging=!1,this.pointerOffset={x:0,y:0},this.startBindingElement="keep",this.endBindingElement="keep",this.pointerDownState={prevSelectedPointsIndices:null,lastClickedPoint:-1,origin:null,segmentMidpoint:{value:null,index:null,added:!1}},this.hoverPointIndex=-1,this.segmentMidPointHoveredCoords=null}static getElement(e){var r;const n=(r=bt.getScene(e))==null?void 0:r.getNonDeletedElement(e);return n||null}static handleBoxSelection(e,n,r){var p;if(!n.editingLinearElement||((p=n.draggingElement)==null?void 0:p.type)!=="selection")return!1;const{editingLinearElement:i}=n,{selectedPointsIndices:s,elementId:o}=i,a=xe.getElement(o);if(!a)return!1;const[l,c,u,d]=Ve(n.draggingElement),f=xe.getPointsGlobalCoordinates(a).reduce((m,v,y)=>((v[0]>=l&&v[0]<=u&&v[1]>=c&&v[1]<=d||e.shiftKey&&(s!=null&&s.includes(y)))&&m.push(y),m),[]);r({editingLinearElement:{...i,selectedPointsIndices:f.length?f:null}})}static handlePointDragging(e,n,r,i,s,o){if(!o)return!1;const{selectedPointsIndices:a,elementId:l}=o,c=xe.getElement(l);if(!c)return!1;const u=c.points[o.pointerDownState.lastClickedPoint];if(a&&u){if(Yf(e)&&a.length===1&&c.points.length>1){const h=a[0],f=c.points[h===0?1:h-1],[p,m]=xe._getShiftLockedDelta(c,f,[r,i],e[z.CTRL_OR_CMD]?null:n.gridSize);xe.movePoints(c,[{index:h,point:[p+f[0],m+f[1]],isDragging:h===o.pointerDownState.lastClickedPoint}])}else{const h=xe.createPointAt(c,r-o.pointerOffset.x,i-o.pointerOffset.y,e[z.CTRL_OR_CMD]?null:n.gridSize),f=h[0]-u[0],p=h[1]-u[1];xe.movePoints(c,a.map(m=>{const v=m===o.pointerDownState.lastClickedPoint?xe.createPointAt(c,r-o.pointerOffset.x,i-o.pointerOffset.y,e[z.CTRL_OR_CMD]?null:n.gridSize):[c.points[m][0]+f,c.points[m][1]+p];return{index:m,point:v,isDragging:m===o.pointerDownState.lastClickedPoint}}))}if(tt(c)&&l2(c,!1),pr(c,!1)){const h=[];a[0]===0&&h.push($a(xe.getPointGlobalCoordinates(c,c.points[0])));const p=a[a.length-1];p===c.points.length-1&&h.push($a(xe.getPointGlobalCoordinates(c,c.points[p]))),h.length&&s(c,h)}return!0}return!1}static handlePointerUp(e,n,r){var u;const{elementId:i,selectedPointsIndices:s,isDragging:o,pointerDownState:a}=n,l=xe.getElement(i);if(!l)return n;const c={};if(o&&s){for(const d of s)if(d===0||d===l.points.length-1){sa(l.points,r.zoom.value)&&xe.movePoints(l,[{index:d,point:d===0?l.points[l.points.length-1]:l.points[0]}]);const h=yc(r)?Ga($a(xe.getPointAtIndexGlobalCoordinates(l,d)),bt.getScene(l)):null;c[d===0?"startBindingElement":"endBindingElement"]=h}}return{...n,...c,selectedPointsIndices:o||e.shiftKey?!o&&e.shiftKey&&((u=a.prevSelectedPointsIndices)!=null&&u.includes(a.lastClickedPoint))?s&&s.filter(d=>d!==a.lastClickedPoint):s:s!=null&&s.includes(a.lastClickedPoint)?[a.lastClickedPoint]:s,isDragging:!1,pointerOffset:{x:0,y:0}}}static isSegmentTooShort(e,n,r,i){let s=vn(n[0],n[1],r[0],r[1]);return e.points.length>2&&e.roundness&&(s=Joe(e,r)),s*i.value<xe.POINT_HANDLE_SIZE*4}static getSegmentMidPoint(e,n,r,i){let s=Vx(n,r);if(e.points.length>2&&e.roundness){const o=RN(e,e.points[i]);if(o){const a=Qoe(e,e.points[i],.5),[l,c]=ON(o[0],o[1],o[2],o[3],a);s=xe.getPointGlobalCoordinates(e,[l,c])}}return s}static getSegmentMidPointIndex(e,n,r){const i=xe.getElement(e.elementId);if(!i)return-1;const s=xe.getEditorMidPoints(i,n);let o=0;for(;o<s.length;){if(xe.arePointsEqual(r,s[o]))return o+1;o++}return-1}static handlePointerDown(e,n,r,i,s){var E;const o={didAddPoint:!1,hitElement:null,linearElementEditor:null};if(!s)return o;const{elementId:a}=s,l=xe.getElement(a);if(!l)return o;const c=xe.getSegmentMidpointHitCoords(s,i,n);let u=null;if(c&&(u=xe.getSegmentMidPointIndex(s,n,c)),e.altKey&&n.editingLinearElement)return s.lastUncommittedPoint==null&&(ae(l,{points:[...l.points,xe.createPointAt(l,i.x,i.y,e[z.CTRL_OR_CMD]?null:n.gridSize)]}),o.didAddPoint=!0),r.resumeRecording(),o.linearElementEditor={...s,pointerDownState:{prevSelectedPointsIndices:s.selectedPointsIndices,lastClickedPoint:-1,origin:{x:i.x,y:i.y},segmentMidpoint:{value:c,index:u,added:!1}},selectedPointsIndices:[l.points.length-1],lastUncommittedPoint:null,endBindingElement:Ga(i,bt.getScene(l))},o.didAddPoint=!0,o;const d=xe.getPointIndexUnderCursor(l,n.zoom,i.x,i.y);if(d>=0||c)o.hitElement=l;else{const{startBindingElement:w,endBindingElement:x}=s;yc(n)&&pr(l)&&fh(l,w,x)}const[h,f,p,m]=Ve(l),v=(h+p)/2,y=(f+m)/2,b=d>-1&&et(l.x+l.points[d][0],l.y+l.points[d][1],v,y,l.angle),_=d>-1||e.shiftKey?e.shiftKey||(E=s.selectedPointsIndices)!=null&&E.includes(d)?cre([...s.selectedPointsIndices||[],d]):[d]:null;return o.linearElementEditor={...s,pointerDownState:{prevSelectedPointsIndices:s.selectedPointsIndices,lastClickedPoint:d,origin:{x:i.x,y:i.y},segmentMidpoint:{value:c,index:u,added:!1}},selectedPointsIndices:_,pointerOffset:b?{x:i.x-b[0],y:i.y-b[1]}:{x:0,y:0}},o}static arePointsEqual(e,n){return!e&&!n?!0:!e||!n?!1:NN(e,n)}static handlePointerMove(e,n,r,i){if(!i.editingLinearElement)return null;const{elementId:s,lastUncommittedPoint:o}=i.editingLinearElement,a=xe.getElement(s);if(!a)return i.editingLinearElement;const{points:l}=a,c=l[l.length-1];if(!e.altKey)return c===o&&xe.deletePoints(a,[l.length-1]),{...i.editingLinearElement,lastUncommittedPoint:null};let u;if(Yf(e)&&l.length>=2){const d=l[l.length-2],[h,f]=xe._getShiftLockedDelta(a,d,[n,r],e[z.CTRL_OR_CMD]?null:i.gridSize);u=[h+d[0],f+d[1]]}else u=xe.createPointAt(a,n-i.editingLinearElement.pointerOffset.x,r-i.editingLinearElement.pointerOffset.y,e[z.CTRL_OR_CMD]?null:i.gridSize);return c===o?xe.movePoints(a,[{index:a.points.length-1,point:u}]):xe.addPoints(a,i,[{point:u}]),{...i.editingLinearElement,lastUncommittedPoint:a.points[a.points.length-1]}}static getPointGlobalCoordinates(e,n){const[r,i,s,o]=Ve(e),a=(r+s)/2,l=(i+o)/2;let{x:c,y:u}=e;return[c,u]=et(c+n[0],u+n[1],a,l,e.angle),[c,u]}static getPointsGlobalCoordinates(e){const[n,r,i,s]=Ve(e),o=(n+i)/2,a=(r+s)/2;return e.points.map(l=>{let{x:c,y:u}=e;return[c,u]=et(c+l[0],u+l[1],o,a,e.angle),[c,u]})}static getPointAtIndexGlobalCoordinates(e,n){const r=n<0?e.points.length+n:n,[i,s,o,a]=Ve(e),l=(i+o)/2,c=(s+a)/2,u=e.points[r],{x:d,y:h}=e;return u?et(d+u[0],h+u[1],l,c,e.angle):et(d,h,l,c,e.angle)}static pointFromAbsoluteCoords(e,n){const[r,i,s,o]=Ve(e),a=(r+s)/2,l=(i+o)/2,[c,u]=et(n[0],n[1],a,l,-e.angle);return[c-e.x,u-e.y]}static getPointIndexUnderCursor(e,n,r,i){const s=xe.getPointsGlobalCoordinates(e);let o=s.length;for(;--o>-1;){const a=s[o];if(vn(r,i,a[0],a[1])*n.value<xe.POINT_HANDLE_SIZE+1)return o}return-1}static createPointAt(e,n,r,i){const s=Kn(n,r,i),[o,a,l,c]=Ve(e),u=(o+l)/2,d=(a+c)/2,[h,f]=et(s[0],s[1],u,d,-e.angle);return[h-e.x,f-e.y]}static getNormalizedPoints(e){const{points:n}=e,r=n[0][0],i=n[0][1];return{points:n.map((s,o)=>[s[0]-r,s[1]-i]),x:e.x+r,y:e.y+i}}static normalizePoints(e){ae(e,xe.getNormalizedPoints(e))}static duplicateSelectedPoints(e){if(!e.editingLinearElement)return!1;const{selectedPointsIndices:n,elementId:r}=e.editingLinearElement,i=xe.getElement(r);if(!i||n===null)return!1;const{points:s}=i,o=[];let a=!1,l=-1;const c=s.reduce((u,d,h)=>{if(++l,u.push(d),n.includes(h)){const p=s[h+1];p||(a=!0),u.push(p?[(d[0]+p[0])/2,(d[1]+p[1])/2]:[d[0],d[1]]),o.push(l+1),++l}return u},[]);if(ae(i,{points:c}),a){const u=i.points[i.points.length-1];xe.movePoints(i,[{index:i.points.length-1,point:[u[0]+30,u[1]+30]}])}return{appState:{...e,editingLinearElement:{...e.editingLinearElement,selectedPointsIndices:o}}}}static deletePoints(e,n){let r=0,i=0;if(n.includes(0)){const a=e.points.find((l,c)=>!n.includes(c));a&&(r=a[0],i=a[1])}const o=e.points.reduce((a,l,c)=>(n.includes(c)||a.push(a.length?[l[0]-r,l[1]-i]:[0,0]),a),[]);xe._updatePoints(e,o,r,i)}static addPoints(e,n,r){const o=[...e.points,...r.map(a=>a.point)];xe._updatePoints(e,o,0,0)}static movePoints(e,n,r){const{points:i}=e;let s=0,o=0;const a=n.find(({index:c})=>c===0);a&&(s=a.point[0]+i[a.index][0],o=a.point[1]+i[a.index][1]);const l=i.map((c,u)=>{const d=n.find(h=>h.index===u);if(d){if(a)return c;const h=d.point[0]-i[d.index][0],f=d.point[1]-i[d.index][1];return[c[0]+h,c[1]+f]}return s||o?[c[0]-s,c[1]-o]:c});xe._updatePoints(e,l,s,o,r)}static shouldAddMidpoint(e,n,r){if(!xe.getElement(e.elementId))return!1;const{segmentMidpoint:s}=e.pointerDownState;if(s.added||s.value===null||s.index===null||e.pointerDownState.origin===null)return!1;const o=e.pointerDownState.origin,a=vn(o.x,o.y,n.x,n.y);return!(!r.editingLinearElement&&a<Gl/r.zoom.value)}static addMidpoint(e,n,r,i){const s=xe.getElement(e.elementId);if(!s)return;const{segmentMidpoint:o}=e.pointerDownState,a={pointerDownState:e.pointerDownState,selectedPointsIndices:e.selectedPointsIndices},l=xe.createPointAt(s,n.x,n.y,i?r.gridSize:null),c=[...s.points.slice(0,o.index),l,...s.points.slice(o.index)];return ae(s,{points:c}),a.pointerDownState={...e.pointerDownState,segmentMidpoint:{...e.pointerDownState.segmentMidpoint,added:!0},lastClickedPoint:o.index},a.selectedPointsIndices=[o.index],a}static _updatePoints(e,n,r,i,s){const o=Ry(e,n),a=Ry(e,e.points),l=(o[0]+o[2])/2,c=(o[1]+o[3])/2,u=(a[0]+a[2])/2,d=(a[1]+a[3])/2,h=u-l,f=d-c,p=et(r,i,h,f,e.angle);ae(e,{...s,points:n,x:e.x+p[0],y:e.y+p[1]})}static _getShiftLockedDelta(e,n,r,i){const s=xe.getPointGlobalCoordinates(e,n),[o,a]=Kn(r[0],r[1],i),{width:l,height:c}=l3(s[0],s[1],o,a);return Wt([l,c],[0,0],-e.angle)}};O(xe,"POINT_HANDLE_SIZE",10),O(xe,"getEditorMidPoints",(e,n)=>{const r=tt(e);return!n.editingLinearElement&&e.points.length>2&&!r?[]:(To.version===e.version&&To.zoom===n.zoom.value||xe.updateEditorMidPointsCache(e,n),To.points)}),O(xe,"updateEditorMidPointsCache",(e,n)=>{const r=xe.getPointsGlobalCoordinates(e);let i=0;const s=[];for(;i<r.length-1;){if(xe.isSegmentTooShort(e,e.points[i],e.points[i+1],n.zoom)){s.push(null),i++;continue}const o=xe.getSegmentMidPoint(e,r[i],r[i+1],i+1);s.push(o),i++}To.points=s,To.version=e.version,To.zoom=n.zoom.value}),O(xe,"getSegmentMidpointHitCoords",(e,n,r)=>{const{elementId:i}=e,s=xe.getElement(i);if(!s||xe.getPointIndexUnderCursor(s,r.zoom,n.x,n.y)>=0||xe.getPointsGlobalCoordinates(s).length>=3&&!r.editingLinearElement)return null;const l=xe.POINT_HANDLE_SIZE/r.zoom.value,c=e.segmentMidPointHoveredCoords;if(c&&vn(c[0],c[1],n.x,n.y)<=l)return c;let u=0;const d=xe.getEditorMidPoints(s,r);for(;u<d.length;){if(d[u]!==null&&vn(d[u][0],d[u][1],n.x,n.y)<=l)return d[u];u++}return null}),O(xe,"getBoundTextElementPosition",(e,n)=>{const r=xe.getPointsGlobalCoordinates(e);r.length<2&&ae(n,{isDeleted:!0});let i=0,s=0;if(e.points.length%2===1){const o=Math.floor(e.points.length/2),a=xe.getPointGlobalCoordinates(e,e.points[o]);i=a[0]-n.width/2,s=a[1]-n.height/2}else{const o=e.points.length/2-1;let a=To.points[o];e.points.length===2&&(a=Vx(r[0],r[1])),(!a||To.version!==e.version)&&(a=xe.getSegmentMidPoint(e,r[o],r[o+1],o+1)),i=a[0]-n.width/2,s=a[1]-n.height/2}return{x:i,y:s}}),O(xe,"getMinMaxXYWithBoundText",(e,n,r)=>{let[i,s,o,a]=n;const l=(i+o)/2,c=(s+a)/2,{x:u,y:d}=xe.getBoundTextElementPosition(e,r),h=u+r.width,f=d+r.height,p=Wt([i,s],[l,c],e.angle),m=Wt([o,s],[l,c],e.angle),v=Wt([u,d],[l,c],-e.angle),y=Wt([h,d],[l,c],-e.angle),b=Wt([u,f],[l,c],-e.angle),_=Wt([h,f],[l,c],-e.angle);return p[0]<m[0]&&p[1]>=m[1]?(i=Math.min(i,b[0]),o=Math.max(o,Math.max(y[0],_[0])),s=Math.min(s,v[1]),a=Math.max(a,_[1])):p[0]>=m[0]&&p[1]>m[1]?(i=Math.min(i,_[0]),o=Math.max(o,Math.max(v[0],y[0])),s=Math.min(s,b[1]),a=Math.max(a,y[1])):p[0]>=m[0]?(i=Math.min(i,y[0]),o=Math.max(o,b[0]),s=Math.min(s,_[1]),a=Math.max(a,v[1])):p[1]<=m[1]&&(i=Math.min(i,Math.min(y[0],v[0])),o=Math.max(o,_[0]),s=Math.min(s,y[1]),a=Math.max(a,b[1])),[i,s,o,a,l,c]}),O(xe,"getElementAbsoluteCoords",(e,n=!1)=>{let r,i,s,o,a;if(e.points.length<2||!mt.get(e)){const{minX:d,minY:h,maxX:f,maxY:p}=e.points.reduce((m,[v,y])=>(m.minY=Math.min(m.minY,y),m.minX=Math.min(m.minX,v),m.maxX=Math.max(m.maxX,v),m.maxY=Math.max(m.maxY,y),m),{minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0});i=d+e.x,s=h+e.y,o=f+e.x,a=p+e.y}else{const d=mt.generateElementShape(e,null),h=Ol(d[0]),[f,p,m,v]=h2(h);i=f+e.x,s=p+e.y,o=m+e.x,a=v+e.y}const l=(i+o)/2,c=(s+a)/2;if(r=[i,s,o,a,l,c],!n)return r;const u=tt(e);return u&&(r=xe.getMinMaxXYWithBoundText(e,[i,s,o,a],u)),r});let Ae=xe;const cre=t=>{let e=[...new Set(t.filter(n=>n!==null&&n!==-1))];return e=e.sort((n,r)=>n-r),e.length?e:null},da=t=>g("div",{className:"buttonList buttonListIcon",children:t.options.map(e=>t.type==="button"?g("button",{onClick:n=>t.onClick(e.value,n),className:Ee({active:e.active??t.value===e.value}),"data-testid":e.testId,title:e.text,children:e.icon},e.text):M("label",{className:Ee({active:t.value===e.value}),title:e.text,children:[g("input",{type:"radio",name:t.group,onChange:()=>t.onChange(e.value),checked:t.value===e.value,"data-testid":e.testId}),e.icon]},e.text))}),ure=({onChange:t,type:e,activeColor:n,topPicks:r})=>{let i;return e==="elementStroke"&&(i=c7),e==="elementBackground"&&(i=u7),e==="canvasBackground"&&(i=d7),r&&(i=r),i?g("div",{className:"color-picker__top-picks",children:i.map(s=>g("button",{className:Ee("color-picker__button",{active:s===n,"is-transparent":s==="transparent"||!s}),style:{"--swatch-color":s},type:"button",title:s,onClick:()=>t(s),"data-testid":`color-top-pick-${s}`,children:g("div",{className:"color-picker__button-outline"})},s))}):(console.error("Invalid type for TopPicks"),null)},qv=({palette:t,color:e})=>{for(const[n,r]of Object.entries(t))if(Array.isArray(r)){const i=r.indexOf(e);if(i>-1)return{colorName:n,shade:i}}else if(r===e)return{colorName:n,shade:null};return null},Mx=[["q","w","e","r","t"],["a","s","d","f","g"],["z","x","c","v","b"]].flat(),ID=({color:t,palette:e})=>!Object.values(e).flat().includes(t),dre=(t,e,n)=>{const r={elementBackground:"backgroundColor",elementStroke:"strokeColor"},i=t.filter(o=>{if(o.isDeleted)return!1;const a=o[r[e]];return ID({color:a,palette:n})}),s=new Map;return i.forEach(o=>{const a=o[r[e]];s.has(a)?s.set(a,s.get(a)+1):s.set(a,1)}),[...s.entries()].sort((o,a)=>a[1]-o[1]).map(o=>o[0]).slice(0,gV)},ph=Yn(null),XI=(t,e,n)=>(t*299+e*587+n*114)/1e3>=160?"black":"white",hre=(t,e)=>{if(e){const s=new Option().style;if(s.color=t,s.color){const o=s.color.replace(/^(rgb|rgba)\(/,"").replace(/\)$/,"").replace(/\s/g,"").split(","),a=parseInt(o[0]),l=parseInt(o[1]),c=parseInt(o[2]);return XI(a,l,c)}}if(t==="transparent")return"black";const n=parseInt(t.substring(1,3),16),r=parseInt(t.substring(3,5),16),i=parseInt(t.substring(5,7),16);return XI(n,r,i)},MS=({color:t,keyLabel:e,isCustomColor:n=!1,isShade:r=!1})=>M("div",{className:"color-picker__button__hotkey-label",style:{color:hre(t,n)},children:[r&&"⇧",e]}),fre=({hex:t,onChange:e,palette:n})=>{const r=qv({color:t||"transparent",palette:n}),[i,s]=Ht(ph),o=A.useRef(null);if(A.useEffect(()=>{o.current&&i==="shades"&&o.current.focus()},[r,i]),r){const{colorName:a,shade:l}=r,c=n[a];if(Array.isArray(c))return g("div",{className:"color-picker-content--default shades",children:c.map((u,d)=>M("button",{ref:d===l&&i==="shades"?o:void 0,tabIndex:-1,type:"button",className:Ee("color-picker__button color-picker__button--large",{active:d===l}),"aria-label":"Shade",title:`${a} - ${d+1}`,style:u?{"--swatch-color":u}:void 0,onClick:()=>{e(u),s("shades")},children:[g("div",{className:"color-picker__button-outline"}),g(MS,{color:u,keyLabel:d+1,isShade:!0})]},d))})}return M("div",{className:"color-picker-content--default",style:{position:"relative"},tabIndex:-1,children:[g("button",{type:"button",tabIndex:-1,className:"color-picker__button color-picker__button--large color-picker__button--no-focus-visible"}),g("div",{tabIndex:-1,style:{position:"absolute",top:0,left:0,right:0,bottom:0,display:"flex",alignItems:"center",justifyContent:"center",textAlign:"center",fontSize:"0.75rem"},children:I("colorPicker.noShades")})]})},pre=({palette:t,color:e,onChange:n,label:r,activeShade:i})=>{const s=qv({color:e||"transparent",palette:t}),[o,a]=Ht(ph),l=A.useRef(null);return A.useEffect(()=>{l.current&&o==="baseColors"&&l.current.focus()},[s==null?void 0:s.colorName,o]),g("div",{className:"color-picker-content--default",children:Object.entries(t).map(([c,u],d)=>{const h=(Array.isArray(u)?u[i]:u)||"transparent",f=Mx[d],p=I(`colors.${c.replace(/\d+/,"")}`,null,"");return M("button",{ref:(s==null?void 0:s.colorName)===c?l:void 0,tabIndex:-1,type:"button",className:Ee("color-picker__button color-picker__button--large",{active:(s==null?void 0:s.colorName)===c,"is-transparent":h==="transparent"||!h}),onClick:()=>{n(h),a("baseColors")},title:`${p}${h.startsWith("#")?` ${h}`:""} — ${f}`,"aria-label":`${p} — ${f}`,style:h?{"--swatch-color":h}:void 0,"data-testid":`color-${c}`,children:[g("div",{className:"color-picker__button-outline"}),g(MS,{color:h,keyLabel:f})]},c)})})},mre=({colors:t,color:e,onChange:n,label:r})=>{const[i,s]=Ht(ph),o=A.useRef(null);return A.useEffect(()=>{o.current&&o.current.focus()},[e,i]),g("div",{className:"color-picker-content--default",children:t.map((a,l)=>M("button",{ref:e===a?o:void 0,tabIndex:-1,type:"button",className:Ee("color-picker__button color-picker__button--large",{active:e===a,"is-transparent":a==="transparent"||!a}),onClick:()=>{n(a),s("custom")},title:a,"aria-label":r,style:{"--swatch-color":a},children:[g("div",{className:"color-picker__button-outline"}),g(MS,{color:a,keyLabel:l+1,isCustomColor:!0})]},l))})},u_=(t,e,n)=>{const r=Math.ceil(n/Lu);switch(e=e??-1,t){case"ArrowLeft":{const i=e-1;return i<0?n-1:i}case"ArrowRight":return(e+1)%n;case"ArrowDown":{const i=e+Lu;return i>=n?e%Lu:i}case"ArrowUp":{const i=e-Lu,s=i<0?Lu*r+i:i;return s>=n?void 0:s}}},gre=({e:t,colorObj:e,onChange:n,palette:r,customColors:i,setActiveColorPickerSection:s,activeShade:o})=>{if((e==null?void 0:e.shade)!=null&&["Digit1","Digit2","Digit3","Digit4","Digit5"].includes(t.code)&&t.shiftKey){const a=Number(t.code.slice(-1))-1;return n(r[e.colorName][a]),s("shades"),!0}if(["1","2","3","4","5"].includes(t.key)&&i[Number(t.key)-1])return n(i[Number(t.key)-1]),s("custom"),!0;if(Mx.includes(t.key)){const a=Mx.indexOf(t.key),l=Object.keys(r)[a],c=r[l],u=Array.isArray(c)?c[o]:c;return n(u),s("baseColors"),!0}return!1},yre=({event:t,activeColorPickerSection:e,palette:n,color:r,onChange:i,customColors:s,setActiveColorPickerSection:o,updateData:a,activeShade:l,onEyeDropperToggle:c,onEscape:u})=>{if(t[z.CTRL_OR_CMD])return!1;if(t.key===z.ESCAPE)return u(t),!0;if(t.key===z.ALT)return c(!0),!0;if(t.key===z.I)return c(),!0;const d=qv({color:r,palette:n});if(t.key===z.TAB){const h={custom:!!s.length,baseColors:!0,shades:(d==null?void 0:d.shade)!=null,hex:!0},f=Object.entries(h).reduce((b,[_,E])=>(E&&b.push(_),b),[]),p=f.indexOf(e),m=t.shiftKey?-1:1,v=p+m>f.length-1?0:p+m<0?f.length-1:p+m,y=f[v];return y&&o(y),y==="custom"?i(s[0]):y==="baseColors"&&(Object.entries(n).find(([_,E])=>Array.isArray(E)?E.includes(r):E===r?_:null)||i(Ge.black)),t.preventDefault(),t.stopPropagation(),!0}if(gre({e:t,colorObj:d,onChange:i,palette:n,customColors:s,setActiveColorPickerSection:o,activeShade:l}))return!0;if(e==="shades"&&d){const{shade:h}=d,f=u_(t.key,h,Lu);if(f!==void 0)return i(n[d.colorName][f]),!0}if(e==="baseColors"&&d){const{colorName:h}=d,f=Object.keys(n),p=f.indexOf(h),m=u_(t.key,p,f.length);if(m!==void 0){const v=f[m],y=n[v];return i(Array.isArray(y)?y[l]:y),!0}}if(e==="custom"){const h=s.indexOf(r),f=u_(t.key,h,s.length);if(f!==void 0){const p=s[f];return i(p),!0}}return!1},i0=({children:t})=>g("div",{className:"color-picker__heading",children:t}),vre=({color:t,onChange:e,label:n,type:r,elements:i,palette:s,updateData:o,children:a,onEyeDropperToggle:l,onEscape:c})=>{const[u]=ce.useState(()=>r==="canvasBackground"?[]:dre(i,r,s)),[d,h]=Ht(ph),f=qv({color:t,palette:s});A.useEffect(()=>{if(!d){const y=ID({color:t,palette:s}),b=y&&!u.includes(t);h(b?"hex":y?"custom":(f==null?void 0:f.shade)!=null?"shades":"baseColors")}},[d,t,s,h,f,u]);const[p,m]=A.useState((f==null?void 0:f.shade)??(r==="elementBackground"?vf:yf));A.useEffect(()=>{(f==null?void 0:f.shade)!=null&&m(f.shade);const y=b=>{b.key===z.ALT&&l(!1)};return document.addEventListener(ee.KEYUP,y,{capture:!0}),()=>{document.removeEventListener(ee.KEYUP,y,{capture:!0})}},[f,l]);const v=ce.useRef(null);return g("div",{role:"dialog","aria-modal":"true","aria-label":I("labels.colorPicker"),children:M("div",{ref:v,onKeyDown:y=>{yre({event:y,activeColorPickerSection:d,palette:s,color:t,onChange:e,onEyeDropperToggle:l,customColors:u,setActiveColorPickerSection:h,updateData:o,activeShade:p,onEscape:c})&&(y.preventDefault(),y.stopPropagation())},className:"color-picker-content",tabIndex:-1,children:[!!u.length&&M("div",{children:[g(i0,{children:I("colorPicker.mostUsedCustomColors")}),g(mre,{colors:u,color:t,label:I("colorPicker.mostUsedCustomColors"),onChange:e})]}),M("div",{children:[g(i0,{children:I("colorPicker.colors")}),g(pre,{color:t,label:n,palette:s,onChange:e,activeShade:p})]}),M("div",{children:[g(i0,{children:I("colorPicker.shades")}),g(fre,{hex:t,onChange:e,palette:s})]}),a]})})};function It(){return It=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},It.apply(this,arguments)}function gr(t,e,{checkForDefaultPrevented:n=!0}={}){return function(i){if(t==null||t(i),n===!1||!i.defaultPrevented)return e==null?void 0:e(i)}}function bre(t,e){typeof t=="function"?t(e):t!=null&&(t.current=e)}function AD(...t){return e=>t.forEach(n=>bre(n,e))}function fo(...t){return A.useCallback(AD(...t),t)}function Gm(t,e=[]){let n=[];function r(s,o){const a=A.createContext(o),l=n.length;n=[...n,o];function c(d){const{scope:h,children:f,...p}=d,m=(h==null?void 0:h[t][l])||a,v=A.useMemo(()=>p,Object.values(p));return A.createElement(m.Provider,{value:v},f)}function u(d,h){const f=(h==null?void 0:h[t][l])||a,p=A.useContext(f);if(p)return p;if(o!==void 0)return o;throw new Error(`\`${d}\` must be used within \`${s}\``)}return c.displayName=s+"Provider",[c,u]}const i=()=>{const s=n.map(o=>A.createContext(o));return function(a){const l=(a==null?void 0:a[t])||s;return A.useMemo(()=>({[`__scope${t}`]:{...a,[t]:l}}),[a,l])}};return i.scopeName=t,[r,_re(i,...e)]}function _re(...t){const e=t[0];if(t.length===1)return e;const n=()=>{const r=t.map(i=>({useScope:i(),scopeName:i.scopeName}));return function(s){const o=r.reduce((a,{useScope:l,scopeName:c})=>{const d=l(s)[`__scope${c}`];return{...a,...d}},{});return A.useMemo(()=>({[`__scope${e.scopeName}`]:o}),[o])}};return n.scopeName=e.scopeName,n}const Qp=A.forwardRef((t,e)=>{const{children:n,...r}=t,i=A.Children.toArray(n),s=i.find(wre);if(s){const o=s.props.children,a=i.map(l=>l===s?A.Children.count(o)>1?A.Children.only(null):A.isValidElement(o)?o.props.children:null:l);return A.createElement(Px,It({},r,{ref:e}),A.isValidElement(o)?A.cloneElement(o,void 0,a):null)}return A.createElement(Px,It({},r,{ref:e}),n)});Qp.displayName="Slot";const Px=A.forwardRef((t,e)=>{const{children:n,...r}=t;return A.isValidElement(n)?A.cloneElement(n,{...xre(r,n.props),ref:AD(e,n.ref)}):A.Children.count(n)>1?A.Children.only(null):null});Px.displayName="SlotClone";const Ere=({children:t})=>A.createElement(A.Fragment,null,t);function wre(t){return A.isValidElement(t)&&t.type===Ere}function xre(t,e){const n={...e};for(const r in e){const i=t[r],s=e[r];/^on[A-Z]/.test(r)?i&&s?n[r]=(...a)=>{s(...a),i(...a)}:i&&(n[r]=i):r==="style"?n[r]={...i,...s}:r==="className"&&(n[r]=[i,s].filter(Boolean).join(" "))}return{...t,...n}}const Tre=["a","button","div","h2","h3","img","label","li","nav","ol","p","span","svg","ul"],Kr=Tre.reduce((t,e)=>{const n=A.forwardRef((r,i)=>{const{asChild:s,...o}=r,a=s?Qp:e;return A.useEffect(()=>{window[Symbol.for("radix-ui")]=!0},[]),A.createElement(a,It({},o,{ref:i}))});return n.displayName=`Primitive.${e}`,{...t,[e]:n}},{});function Sre(t,e){t&&hi.flushSync(()=>t.dispatchEvent(e))}function ra(t){const e=A.useRef(t);return A.useEffect(()=>{e.current=t}),A.useMemo(()=>(...n)=>{var r;return(r=e.current)===null||r===void 0?void 0:r.call(e,...n)},[])}function Cre(t,e=globalThis==null?void 0:globalThis.document){const n=ra(t);A.useEffect(()=>{const r=i=>{i.key==="Escape"&&n(i)};return e.addEventListener("keydown",r),()=>e.removeEventListener("keydown",r)},[n,e])}const Lx="dismissableLayer.update",Ire="dismissableLayer.pointerDownOutside",Are="dismissableLayer.focusOutside";let YI;const kre=A.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),Mre=A.forwardRef((t,e)=>{var n;const{disableOutsidePointerEvents:r=!1,onEscapeKeyDown:i,onPointerDownOutside:s,onFocusOutside:o,onInteractOutside:a,onDismiss:l,...c}=t,u=A.useContext(kre),[d,h]=A.useState(null),f=(n=d==null?void 0:d.ownerDocument)!==null&&n!==void 0?n:globalThis==null?void 0:globalThis.document,[,p]=A.useState({}),m=fo(e,C=>h(C)),v=Array.from(u.layers),[y]=[...u.layersWithOutsidePointerEventsDisabled].slice(-1),b=v.indexOf(y),_=d?v.indexOf(d):-1,E=u.layersWithOutsidePointerEventsDisabled.size>0,w=_>=b,x=Pre(C=>{const k=C.target,L=[...u.branches].some(F=>F.contains(k));!w||L||(s==null||s(C),a==null||a(C),C.defaultPrevented||l==null||l())},f),T=Lre(C=>{const k=C.target;[...u.branches].some(F=>F.contains(k))||(o==null||o(C),a==null||a(C),C.defaultPrevented||l==null||l())},f);return Cre(C=>{_===u.layers.size-1&&(i==null||i(C),!C.defaultPrevented&&l&&(C.preventDefault(),l()))},f),A.useEffect(()=>{if(d)return r&&(u.layersWithOutsidePointerEventsDisabled.size===0&&(YI=f.body.style.pointerEvents,f.body.style.pointerEvents="none"),u.layersWithOutsidePointerEventsDisabled.add(d)),u.layers.add(d),ZI(),()=>{r&&u.layersWithOutsidePointerEventsDisabled.size===1&&(f.body.style.pointerEvents=YI)}},[d,f,r,u]),A.useEffect(()=>()=>{d&&(u.layers.delete(d),u.layersWithOutsidePointerEventsDisabled.delete(d),ZI())},[d,u]),A.useEffect(()=>{const C=()=>p({});return document.addEventListener(Lx,C),()=>document.removeEventListener(Lx,C)},[]),A.createElement(Kr.div,It({},c,{ref:m,style:{pointerEvents:E?w?"auto":"none":void 0,...t.style},onFocusCapture:gr(t.onFocusCapture,T.onFocusCapture),onBlurCapture:gr(t.onBlurCapture,T.onBlurCapture),onPointerDownCapture:gr(t.onPointerDownCapture,x.onPointerDownCapture)}))});function Pre(t,e=globalThis==null?void 0:globalThis.document){const n=ra(t),r=A.useRef(!1),i=A.useRef(()=>{});return A.useEffect(()=>{const s=a=>{if(a.target&&!r.current){let l=function(){kD(Ire,n,c,{discrete:!0})};const c={originalEvent:a};a.pointerType==="touch"?(e.removeEventListener("click",i.current),i.current=l,e.addEventListener("click",i.current,{once:!0})):l()}r.current=!1},o=window.setTimeout(()=>{e.addEventListener("pointerdown",s)},0);return()=>{window.clearTimeout(o),e.removeEventListener("pointerdown",s),e.removeEventListener("click",i.current)}},[e,n]),{onPointerDownCapture:()=>r.current=!0}}function Lre(t,e=globalThis==null?void 0:globalThis.document){const n=ra(t),r=A.useRef(!1);return A.useEffect(()=>{const i=s=>{s.target&&!r.current&&kD(Are,n,{originalEvent:s},{discrete:!1})};return e.addEventListener("focusin",i),()=>e.removeEventListener("focusin",i)},[e,n]),{onFocusCapture:()=>r.current=!0,onBlurCapture:()=>r.current=!1}}function ZI(){const t=new CustomEvent(Lx);document.dispatchEvent(t)}function kD(t,e,n,{discrete:r}){const i=n.originalEvent.target,s=new CustomEvent(t,{bubbles:!1,cancelable:!0,detail:n});e&&i.addEventListener(t,e,{once:!0}),r?Sre(i,s):i.dispatchEvent(s)}let d_=0;function Rre(){A.useEffect(()=>{var t,e;const n=document.querySelectorAll("[data-radix-focus-guard]");return document.body.insertAdjacentElement("afterbegin",(t=n[0])!==null&&t!==void 0?t:KI()),document.body.insertAdjacentElement("beforeend",(e=n[1])!==null&&e!==void 0?e:KI()),d_++,()=>{d_===1&&document.querySelectorAll("[data-radix-focus-guard]").forEach(r=>r.remove()),d_--}},[])}function KI(){const t=document.createElement("span");return t.setAttribute("data-radix-focus-guard",""),t.tabIndex=0,t.style.cssText="outline: none; opacity: 0; position: fixed; pointer-events: none",t}const h_="focusScope.autoFocusOnMount",f_="focusScope.autoFocusOnUnmount",qI={bubbles:!1,cancelable:!0},Ore=A.forwardRef((t,e)=>{const{loop:n=!1,trapped:r=!1,onMountAutoFocus:i,onUnmountAutoFocus:s,...o}=t,[a,l]=A.useState(null),c=ra(i),u=ra(s),d=A.useRef(null),h=fo(e,m=>l(m)),f=A.useRef({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}}).current;A.useEffect(()=>{if(r){let m=function(y){if(f.paused||!a)return;const b=y.target;a.contains(b)?d.current=b:Ql(d.current,{select:!0})},v=function(y){f.paused||!a||a.contains(y.relatedTarget)||Ql(d.current,{select:!0})};return document.addEventListener("focusin",m),document.addEventListener("focusout",v),()=>{document.removeEventListener("focusin",m),document.removeEventListener("focusout",v)}}},[r,a,f.paused]),A.useEffect(()=>{if(a){QI.add(f);const m=document.activeElement;if(!a.contains(m)){const y=new CustomEvent(h_,qI);a.addEventListener(h_,c),a.dispatchEvent(y),y.defaultPrevented||(Dre($re(MD(a)),{select:!0}),document.activeElement===m&&Ql(a))}return()=>{a.removeEventListener(h_,c),setTimeout(()=>{const y=new CustomEvent(f_,qI);a.addEventListener(f_,u),a.dispatchEvent(y),y.defaultPrevented||Ql(m??document.body,{select:!0}),a.removeEventListener(f_,u),QI.remove(f)},0)}}},[a,c,u,f]);const p=A.useCallback(m=>{if(!n&&!r||f.paused)return;const v=m.key==="Tab"&&!m.altKey&&!m.ctrlKey&&!m.metaKey,y=document.activeElement;if(v&&y){const b=m.currentTarget,[_,E]=Nre(b);_&&E?!m.shiftKey&&y===E?(m.preventDefault(),n&&Ql(_,{select:!0})):m.shiftKey&&y===_&&(m.preventDefault(),n&&Ql(E,{select:!0})):y===b&&m.preventDefault()}},[n,r,f.paused]);return A.createElement(Kr.div,It({tabIndex:-1},o,{ref:h,onKeyDown:p}))});function Dre(t,{select:e=!1}={}){const n=document.activeElement;for(const r of t)if(Ql(r,{select:e}),document.activeElement!==n)return}function Nre(t){const e=MD(t),n=JI(e,t),r=JI(e.reverse(),t);return[n,r]}function MD(t){const e=[],n=document.createTreeWalker(t,NodeFilter.SHOW_ELEMENT,{acceptNode:r=>{const i=r.tagName==="INPUT"&&r.type==="hidden";return r.disabled||r.hidden||i?NodeFilter.FILTER_SKIP:r.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;n.nextNode();)e.push(n.currentNode);return e}function JI(t,e){for(const n of t)if(!Fre(n,{upTo:e}))return n}function Fre(t,{upTo:e}){if(getComputedStyle(t).visibility==="hidden")return!0;for(;t;){if(e!==void 0&&t===e)return!1;if(getComputedStyle(t).display==="none")return!0;t=t.parentElement}return!1}function Bre(t){return t instanceof HTMLInputElement&&"select"in t}function Ql(t,{select:e=!1}={}){if(t&&t.focus){const n=document.activeElement;t.focus({preventScroll:!0}),t!==n&&Bre(t)&&e&&t.select()}}const QI=Ure();function Ure(){let t=[];return{add(e){const n=t[0];e!==n&&(n==null||n.pause()),t=eA(t,e),t.unshift(e)},remove(e){var n;t=eA(t,e),(n=t[0])===null||n===void 0||n.resume()}}}function eA(t,e){const n=[...t],r=n.indexOf(e);return r!==-1&&n.splice(r,1),n}function $re(t){return t.filter(e=>e.tagName!=="A")}const Va=globalThis!=null&&globalThis.document?A.useLayoutEffect:()=>{},Hre=xH.useId||(()=>{});let zre=0;function PS(t){const[e,n]=A.useState(Hre());return Va(()=>{t||n(r=>r??String(zre++))},[t]),t||(e?`radix-${e}`:"")}function hu(t){return t.split("-")[0]}function Vm(t){return t.split("-")[1]}function mh(t){return["top","bottom"].includes(hu(t))?"x":"y"}function LS(t){return t==="y"?"height":"width"}function tA(t,e,n){let{reference:r,floating:i}=t;const s=r.x+r.width/2-i.width/2,o=r.y+r.height/2-i.height/2,a=mh(e),l=LS(a),c=r[l]/2-i[l]/2,u=a==="x";let d;switch(hu(e)){case"top":d={x:s,y:r.y-i.height};break;case"bottom":d={x:s,y:r.y+r.height};break;case"right":d={x:r.x+r.width,y:o};break;case"left":d={x:r.x-i.width,y:o};break;default:d={x:r.x,y:r.y}}switch(Vm(e)){case"start":d[a]-=c*(n&&u?-1:1);break;case"end":d[a]+=c*(n&&u?-1:1)}return d}const Gre=async(t,e,n)=>{const{placement:r="bottom",strategy:i="absolute",middleware:s=[],platform:o}=n,a=await(o.isRTL==null?void 0:o.isRTL(e));let l=await o.getElementRects({reference:t,floating:e,strategy:i}),{x:c,y:u}=tA(l,r,a),d=r,h={},f=0;for(let p=0;p<s.length;p++){const{name:m,fn:v}=s[p],{x:y,y:b,data:_,reset:E}=await v({x:c,y:u,initialPlacement:r,placement:d,strategy:i,middlewareData:h,rects:l,platform:o,elements:{reference:t,floating:e}});c=y??c,u=b??u,h={...h,[m]:{...h[m],..._}},E&&f<=50&&(f++,typeof E=="object"&&(E.placement&&(d=E.placement),E.rects&&(l=E.rects===!0?await o.getElementRects({reference:t,floating:e,strategy:i}):E.rects),{x:c,y:u}=tA(l,d,a)),p=-1)}return{x:c,y:u,placement:d,strategy:i,middlewareData:h}};function PD(t){return typeof t!="number"?function(e){return{top:0,right:0,bottom:0,left:0,...e}}(t):{top:t,right:t,bottom:t,left:t}}function xy(t){return{...t,top:t.y,left:t.x,right:t.x+t.width,bottom:t.y+t.height}}async function em(t,e){var n;e===void 0&&(e={});const{x:r,y:i,platform:s,rects:o,elements:a,strategy:l}=t,{boundary:c="clippingAncestors",rootBoundary:u="viewport",elementContext:d="floating",altBoundary:h=!1,padding:f=0}=e,p=PD(f),m=a[h?d==="floating"?"reference":"floating":d],v=xy(await s.getClippingRect({element:(n=await(s.isElement==null?void 0:s.isElement(m)))==null||n?m:m.contextElement||await(s.getDocumentElement==null?void 0:s.getDocumentElement(a.floating)),boundary:c,rootBoundary:u,strategy:l})),y=xy(s.convertOffsetParentRelativeRectToViewportRelativeRect?await s.convertOffsetParentRelativeRectToViewportRelativeRect({rect:d==="floating"?{...o.floating,x:r,y:i}:o.reference,offsetParent:await(s.getOffsetParent==null?void 0:s.getOffsetParent(a.floating)),strategy:l}):o[d]);return{top:v.top-y.top+p.top,bottom:y.bottom-v.bottom+p.bottom,left:v.left-y.left+p.left,right:y.right-v.right+p.right}}const Vre=Math.min,ec=Math.max;function Rx(t,e,n){return ec(t,Vre(e,n))}const nA=t=>({name:"arrow",options:t,async fn(e){const{element:n,padding:r=0}=t??{},{x:i,y:s,placement:o,rects:a,platform:l}=e;if(n==null)return{};const c=PD(r),u={x:i,y:s},d=mh(o),h=Vm(o),f=LS(d),p=await l.getDimensions(n),m=d==="y"?"top":"left",v=d==="y"?"bottom":"right",y=a.reference[f]+a.reference[d]-u[d]-a.floating[f],b=u[d]-a.reference[d],_=await(l.getOffsetParent==null?void 0:l.getOffsetParent(n));let E=_?d==="y"?_.clientHeight||0:_.clientWidth||0:0;E===0&&(E=a.floating[f]);const w=y/2-b/2,x=c[m],T=E-p[f]-c[v],C=E/2-p[f]/2+w,k=Rx(x,C,T),L=(h==="start"?c[m]:c[v])>0&&C!==k&&a.reference[f]<=a.floating[f];return{[d]:u[d]-(L?C<x?x-C:T-C:0),data:{[d]:k,centerOffset:C-k}}}}),Wre={left:"right",right:"left",bottom:"top",top:"bottom"};function Ty(t){return t.replace(/left|right|bottom|top/g,e=>Wre[e])}function jre(t,e,n){n===void 0&&(n=!1);const r=Vm(t),i=mh(t),s=LS(i);let o=i==="x"?r===(n?"end":"start")?"right":"left":r==="start"?"bottom":"top";return e.reference[s]>e.floating[s]&&(o=Ty(o)),{main:o,cross:Ty(o)}}const Xre={start:"end",end:"start"};function rA(t){return t.replace(/start|end/g,e=>Xre[e])}const LD=["top","right","bottom","left"];LD.reduce((t,e)=>t.concat(e,e+"-start",e+"-end"),[]);const Yre=function(t){return t===void 0&&(t={}),{name:"flip",options:t,async fn(e){var n;const{placement:r,middlewareData:i,rects:s,initialPlacement:o,platform:a,elements:l}=e,{mainAxis:c=!0,crossAxis:u=!0,fallbackPlacements:d,fallbackStrategy:h="bestFit",flipAlignment:f=!0,...p}=t,m=hu(r),v=d||(m===o||!f?[Ty(o)]:function(C){const k=Ty(C);return[rA(C),k,rA(k)]}(o)),y=[o,...v],b=await em(e,p),_=[];let E=((n=i.flip)==null?void 0:n.overflows)||[];if(c&&_.push(b[m]),u){const{main:C,cross:k}=jre(r,s,await(a.isRTL==null?void 0:a.isRTL(l.floating)));_.push(b[C],b[k])}if(E=[...E,{placement:r,overflows:_}],!_.every(C=>C<=0)){var w,x;const C=((w=(x=i.flip)==null?void 0:x.index)!=null?w:0)+1,k=y[C];if(k)return{data:{index:C,overflows:E},reset:{placement:k}};let L="bottom";switch(h){case"bestFit":{var T;const F=(T=E.map(N=>[N,N.overflows.filter(R=>R>0).reduce((R,H)=>R+H,0)]).sort((N,R)=>N[1]-R[1])[0])==null?void 0:T[0].placement;F&&(L=F);break}case"initialPlacement":L=o}if(r!==L)return{reset:{placement:L}}}return{}}}};function iA(t,e){return{top:t.top-e.height,right:t.right-e.width,bottom:t.bottom-e.height,left:t.left-e.width}}function sA(t){return LD.some(e=>t[e]>=0)}const Zre=function(t){let{strategy:e="referenceHidden",...n}=t===void 0?{}:t;return{name:"hide",async fn(r){const{rects:i}=r;switch(e){case"referenceHidden":{const s=iA(await em(r,{...n,elementContext:"reference"}),i.reference);return{data:{referenceHiddenOffsets:s,referenceHidden:sA(s)}}}case"escaped":{const s=iA(await em(r,{...n,altBoundary:!0}),i.floating);return{data:{escapedOffsets:s,escaped:sA(s)}}}default:return{}}}}},Kre=function(t){return t===void 0&&(t=0),{name:"offset",options:t,async fn(e){const{x:n,y:r}=e,i=await async function(s,o){const{placement:a,platform:l,elements:c}=s,u=await(l.isRTL==null?void 0:l.isRTL(c.floating)),d=hu(a),h=Vm(a),f=mh(a)==="x",p=["left","top"].includes(d)?-1:1,m=u&&f?-1:1,v=typeof o=="function"?o(s):o;let{mainAxis:y,crossAxis:b,alignmentAxis:_}=typeof v=="number"?{mainAxis:v,crossAxis:0,alignmentAxis:null}:{mainAxis:0,crossAxis:0,alignmentAxis:null,...v};return h&&typeof _=="number"&&(b=h==="end"?-1*_:_),f?{x:b*m,y:y*p}:{x:y*p,y:b*m}}(e,t);return{x:n+i.x,y:r+i.y,data:i}}}};function RD(t){return t==="x"?"y":"x"}const qre=function(t){return t===void 0&&(t={}),{name:"shift",options:t,async fn(e){const{x:n,y:r,placement:i}=e,{mainAxis:s=!0,crossAxis:o=!1,limiter:a={fn:v=>{let{x:y,y:b}=v;return{x:y,y:b}}},...l}=t,c={x:n,y:r},u=await em(e,l),d=mh(hu(i)),h=RD(d);let f=c[d],p=c[h];if(s){const v=d==="y"?"bottom":"right";f=Rx(f+u[d==="y"?"top":"left"],f,f-u[v])}if(o){const v=h==="y"?"bottom":"right";p=Rx(p+u[h==="y"?"top":"left"],p,p-u[v])}const m=a.fn({...e,[d]:f,[h]:p});return{...m,data:{x:m.x-n,y:m.y-r}}}}},Jre=function(t){return t===void 0&&(t={}),{options:t,fn(e){const{x:n,y:r,placement:i,rects:s,middlewareData:o}=e,{offset:a=0,mainAxis:l=!0,crossAxis:c=!0}=t,u={x:n,y:r},d=mh(i),h=RD(d);let f=u[d],p=u[h];const m=typeof a=="function"?a({...s,placement:i}):a,v=typeof m=="number"?{mainAxis:m,crossAxis:0}:{mainAxis:0,crossAxis:0,...m};if(l){const w=d==="y"?"height":"width",x=s.reference[d]-s.floating[w]+v.mainAxis,T=s.reference[d]+s.reference[w]-v.mainAxis;f<x?f=x:f>T&&(f=T)}if(c){var y,b,_,E;const w=d==="y"?"width":"height",x=["top","left"].includes(hu(i)),T=s.reference[h]-s.floating[w]+(x&&(y=(b=o.offset)==null?void 0:b[h])!=null?y:0)+(x?0:v.crossAxis),C=s.reference[h]+s.reference[w]+(x?0:(_=(E=o.offset)==null?void 0:E[h])!=null?_:0)-(x?v.crossAxis:0);p<T?p=T:p>C&&(p=C)}return{[d]:f,[h]:p}}}},Qre=function(t){return t===void 0&&(t={}),{name:"size",options:t,async fn(e){const{placement:n,rects:r,platform:i,elements:s}=e,{apply:o,...a}=t,l=await em(e,a),c=hu(n),u=Vm(n);let d,h;c==="top"||c==="bottom"?(d=c,h=u===(await(i.isRTL==null?void 0:i.isRTL(s.floating))?"start":"end")?"left":"right"):(h=c,d=u==="end"?"top":"bottom");const f=ec(l.left,0),p=ec(l.right,0),m=ec(l.top,0),v=ec(l.bottom,0),y={availableHeight:r.floating.height-(["left","right"].includes(n)?2*(m!==0||v!==0?m+v:ec(l.top,l.bottom)):l[d]),availableWidth:r.floating.width-(["top","bottom"].includes(n)?2*(f!==0||p!==0?f+p:ec(l.left,l.right)):l[h])},b=await i.getDimensions(s.floating);o==null||o({...e,...y});const _=await i.getDimensions(s.floating);return b.width!==_.width||b.height!==_.height?{reset:{rects:!0}}:{}}}};function OD(t){return t&&t.document&&t.location&&t.alert&&t.setInterval}function ha(t){if(t==null)return window;if(!OD(t)){const e=t.ownerDocument;return e&&e.defaultView||window}return t}function Wm(t){return ha(t).getComputedStyle(t)}function jo(t){return OD(t)?"":t?(t.nodeName||"").toLowerCase():""}function DD(){const t=navigator.userAgentData;return t!=null&&t.brands?t.brands.map(e=>e.brand+"/"+e.version).join(" "):navigator.userAgent}function po(t){return t instanceof ha(t).HTMLElement}function xl(t){return t instanceof ha(t).Element}function RS(t){return typeof ShadowRoot>"u"?!1:t instanceof ha(t).ShadowRoot||t instanceof ShadowRoot}function Jv(t){const{overflow:e,overflowX:n,overflowY:r}=Wm(t);return/auto|scroll|overlay|hidden/.test(e+r+n)}function eie(t){return["table","td","th"].includes(jo(t))}function oA(t){const e=/firefox/i.test(DD()),n=Wm(t);return n.transform!=="none"||n.perspective!=="none"||n.contain==="paint"||["transform","perspective"].includes(n.willChange)||e&&n.willChange==="filter"||e&&!!n.filter&&n.filter!=="none"}function ND(){return!/^((?!chrome|android).)*safari/i.test(DD())}const aA=Math.min,Jf=Math.max,Sy=Math.round;function Xo(t,e,n){var r,i,s,o;e===void 0&&(e=!1),n===void 0&&(n=!1);const a=t.getBoundingClientRect();let l=1,c=1;e&&po(t)&&(l=t.offsetWidth>0&&Sy(a.width)/t.offsetWidth||1,c=t.offsetHeight>0&&Sy(a.height)/t.offsetHeight||1);const u=xl(t)?ha(t):window,d=!ND()&&n,h=(a.left+(d&&(r=(i=u.visualViewport)==null?void 0:i.offsetLeft)!=null?r:0))/l,f=(a.top+(d&&(s=(o=u.visualViewport)==null?void 0:o.offsetTop)!=null?s:0))/c,p=a.width/l,m=a.height/c;return{width:p,height:m,top:f,right:h+p,bottom:f+m,left:h,x:h,y:f}}function ol(t){return(e=t,(e instanceof ha(e).Node?t.ownerDocument:t.document)||window.document).documentElement;var e}function Qv(t){return xl(t)?{scrollLeft:t.scrollLeft,scrollTop:t.scrollTop}:{scrollLeft:t.pageXOffset,scrollTop:t.pageYOffset}}function FD(t){return Xo(ol(t)).left+Qv(t).scrollLeft}function tie(t,e,n){const r=po(e),i=ol(e),s=Xo(t,r&&function(l){const c=Xo(l);return Sy(c.width)!==l.offsetWidth||Sy(c.height)!==l.offsetHeight}(e),n==="fixed");let o={scrollLeft:0,scrollTop:0};const a={x:0,y:0};if(r||!r&&n!=="fixed")if((jo(e)!=="body"||Jv(i))&&(o=Qv(e)),po(e)){const l=Xo(e,!0);a.x=l.x+e.clientLeft,a.y=l.y+e.clientTop}else i&&(a.x=FD(i));return{x:s.left+o.scrollLeft-a.x,y:s.top+o.scrollTop-a.y,width:s.width,height:s.height}}function BD(t){return jo(t)==="html"?t:t.assignedSlot||t.parentNode||(RS(t)?t.host:null)||ol(t)}function lA(t){return po(t)&&getComputedStyle(t).position!=="fixed"?t.offsetParent:null}function Ox(t){const e=ha(t);let n=lA(t);for(;n&&eie(n)&&getComputedStyle(n).position==="static";)n=lA(n);return n&&(jo(n)==="html"||jo(n)==="body"&&getComputedStyle(n).position==="static"&&!oA(n))?e:n||function(r){let i=BD(r);for(RS(i)&&(i=i.host);po(i)&&!["html","body"].includes(jo(i));){if(oA(i))return i;i=i.parentNode}return null}(t)||e}function cA(t){if(po(t))return{width:t.offsetWidth,height:t.offsetHeight};const e=Xo(t);return{width:e.width,height:e.height}}function UD(t){const e=BD(t);return["html","body","#document"].includes(jo(e))?t.ownerDocument.body:po(e)&&Jv(e)?e:UD(e)}function Cy(t,e){var n;e===void 0&&(e=[]);const r=UD(t),i=r===((n=t.ownerDocument)==null?void 0:n.body),s=ha(r),o=i?[s].concat(s.visualViewport||[],Jv(r)?r:[]):r,a=e.concat(o);return i?a:a.concat(Cy(o))}function uA(t,e,n){return e==="viewport"?xy(function(r,i){const s=ha(r),o=ol(r),a=s.visualViewport;let l=o.clientWidth,c=o.clientHeight,u=0,d=0;if(a){l=a.width,c=a.height;const h=ND();(h||!h&&i==="fixed")&&(u=a.offsetLeft,d=a.offsetTop)}return{width:l,height:c,x:u,y:d}}(t,n)):xl(e)?function(r,i){const s=Xo(r,!1,i==="fixed"),o=s.top+r.clientTop,a=s.left+r.clientLeft;return{top:o,left:a,x:a,y:o,right:a+r.clientWidth,bottom:o+r.clientHeight,width:r.clientWidth,height:r.clientHeight}}(e,n):xy(function(r){var i;const s=ol(r),o=Qv(r),a=(i=r.ownerDocument)==null?void 0:i.body,l=Jf(s.scrollWidth,s.clientWidth,a?a.scrollWidth:0,a?a.clientWidth:0),c=Jf(s.scrollHeight,s.clientHeight,a?a.scrollHeight:0,a?a.clientHeight:0);let u=-o.scrollLeft+FD(r);const d=-o.scrollTop;return Wm(a||s).direction==="rtl"&&(u+=Jf(s.clientWidth,a?a.clientWidth:0)-l),{width:l,height:c,x:u,y:d}}(ol(t)))}function nie(t){const e=Cy(t),n=["absolute","fixed"].includes(Wm(t).position)&&po(t)?Ox(t):t;return xl(n)?e.filter(r=>xl(r)&&function(i,s){const o=s.getRootNode==null?void 0:s.getRootNode();if(i.contains(s))return!0;if(o&&RS(o)){let a=s;do{if(a&&i===a)return!0;a=a.parentNode||a.host}while(a)}return!1}(r,n)&&jo(r)!=="body"):[]}const rie={getClippingRect:function(t){let{element:e,boundary:n,rootBoundary:r,strategy:i}=t;const s=[...n==="clippingAncestors"?nie(e):[].concat(n),r],o=s[0],a=s.reduce((l,c)=>{const u=uA(e,c,i);return l.top=Jf(u.top,l.top),l.right=aA(u.right,l.right),l.bottom=aA(u.bottom,l.bottom),l.left=Jf(u.left,l.left),l},uA(e,o,i));return{width:a.right-a.left,height:a.bottom-a.top,x:a.left,y:a.top}},convertOffsetParentRelativeRectToViewportRelativeRect:function(t){let{rect:e,offsetParent:n,strategy:r}=t;const i=po(n),s=ol(n);if(n===s)return e;let o={scrollLeft:0,scrollTop:0};const a={x:0,y:0};if((i||!i&&r!=="fixed")&&((jo(n)!=="body"||Jv(s))&&(o=Qv(n)),po(n))){const l=Xo(n,!0);a.x=l.x+n.clientLeft,a.y=l.y+n.clientTop}return{...e,x:e.x-o.scrollLeft+a.x,y:e.y-o.scrollTop+a.y}},isElement:xl,getDimensions:cA,getOffsetParent:Ox,getDocumentElement:ol,getElementRects:t=>{let{reference:e,floating:n,strategy:r}=t;return{reference:tie(e,Ox(n),r),floating:{...cA(n),x:0,y:0}}},getClientRects:t=>Array.from(t.getClientRects()),isRTL:t=>Wm(t).direction==="rtl"};function iie(t,e,n,r){r===void 0&&(r={});const{ancestorScroll:i=!0,ancestorResize:s=!0,elementResize:o=!0,animationFrame:a=!1}=r,l=i&&!a,c=s&&!a,u=l||c?[...xl(t)?Cy(t):[],...Cy(e)]:[];u.forEach(p=>{l&&p.addEventListener("scroll",n,{passive:!0}),c&&p.addEventListener("resize",n)});let d,h=null;if(o){let p=!0;h=new ResizeObserver(()=>{p||n(),p=!1}),xl(t)&&!a&&h.observe(t),h.observe(e)}let f=a?Xo(t):null;return a&&function p(){const m=Xo(t);!f||m.x===f.x&&m.y===f.y&&m.width===f.width&&m.height===f.height||n(),f=m,d=requestAnimationFrame(p)}(),n(),()=>{var p;u.forEach(m=>{l&&m.removeEventListener("scroll",n),c&&m.removeEventListener("resize",n)}),(p=h)==null||p.disconnect(),h=null,a&&cancelAnimationFrame(d)}}const sie=(t,e,n)=>Gre(t,e,{platform:rie,...n});var Dx=typeof document<"u"?A.useLayoutEffect:A.useEffect;function Nx(t,e){if(t===e)return!0;if(typeof t!=typeof e)return!1;if(typeof t=="function"&&t.toString()===e.toString())return!0;let n,r,i;if(t&&e&&typeof t=="object"){if(Array.isArray(t)){if(n=t.length,n!=e.length)return!1;for(r=n;r--!==0;)if(!Nx(t[r],e[r]))return!1;return!0}if(i=Object.keys(t),n=i.length,n!==Object.keys(e).length)return!1;for(r=n;r--!==0;)if(!Object.prototype.hasOwnProperty.call(e,i[r]))return!1;for(r=n;r--!==0;){const s=i[r];if(!(s==="_owner"&&t.$$typeof)&&!Nx(t[s],e[s]))return!1}return!0}return t!==t&&e!==e}function oie(t){const e=A.useRef(t);return Dx(()=>{e.current=t}),e}function aie(t){let{middleware:e,placement:n="bottom",strategy:r="absolute",whileElementsMounted:i}=t===void 0?{}:t;const s=A.useRef(null),o=A.useRef(null),a=oie(i),l=A.useRef(null),[c,u]=A.useState({x:null,y:null,strategy:r,placement:n,middlewareData:{}}),[d,h]=A.useState(e);Nx(d==null?void 0:d.map(_=>{let{options:E}=_;return E}),e==null?void 0:e.map(_=>{let{options:E}=_;return E}))||h(e);const f=A.useCallback(()=>{!s.current||!o.current||sie(s.current,o.current,{middleware:d,placement:n,strategy:r}).then(_=>{p.current&&hi.flushSync(()=>{u(_)})})},[d,n,r]);Dx(()=>{p.current&&f()},[f]);const p=A.useRef(!1);Dx(()=>(p.current=!0,()=>{p.current=!1}),[]);const m=A.useCallback(()=>{if(typeof l.current=="function"&&(l.current(),l.current=null),s.current&&o.current)if(a.current){const _=a.current(s.current,o.current,f);l.current=_}else f()},[f,a]),v=A.useCallback(_=>{s.current=_,m()},[m]),y=A.useCallback(_=>{o.current=_,m()},[m]),b=A.useMemo(()=>({reference:s,floating:o}),[]);return A.useMemo(()=>({...c,update:f,refs:b,reference:v,floating:y}),[c,f,b,v,y])}const lie=t=>{const{element:e,padding:n}=t;function r(i){return Object.prototype.hasOwnProperty.call(i,"current")}return{name:"arrow",options:t,fn(i){return r(e)?e.current!=null?nA({element:e.current,padding:n}).fn(i):{}:e?nA({element:e,padding:n}).fn(i):{}}}},cie=A.forwardRef((t,e)=>{const{children:n,width:r=10,height:i=5,...s}=t;return A.createElement(Kr.svg,It({},s,{ref:e,width:r,height:i,viewBox:"0 0 30 10",preserveAspectRatio:"none"}),t.asChild?n:A.createElement("polygon",{points:"0,0 30,0 15,10"}))}),uie=cie;function die(t){const[e,n]=A.useState(void 0);return Va(()=>{if(t){n({width:t.offsetWidth,height:t.offsetHeight});const r=new ResizeObserver(i=>{if(!Array.isArray(i)||!i.length)return;const s=i[0];let o,a;if("borderBoxSize"in s){const l=s.borderBoxSize,c=Array.isArray(l)?l[0]:l;o=c.inlineSize,a=c.blockSize}else o=t.offsetWidth,a=t.offsetHeight;n({width:o,height:a})});return r.observe(t,{box:"border-box"}),()=>r.unobserve(t)}else n(void 0)},[t]),e}const $D="Popper",[OS,HD]=Gm($D),[hie,zD]=OS($D),fie=t=>{const{__scopePopper:e,children:n}=t,[r,i]=A.useState(null);return A.createElement(hie,{scope:e,anchor:r,onAnchorChange:i},n)},pie="PopperAnchor",mie=A.forwardRef((t,e)=>{const{__scopePopper:n,virtualRef:r,...i}=t,s=zD(pie,n),o=A.useRef(null),a=fo(e,o);return A.useEffect(()=>{s.onAnchorChange((r==null?void 0:r.current)||o.current)}),r?null:A.createElement(Kr.div,It({},i,{ref:a}))}),Iy="PopperContent",[gie,yie]=OS(Iy),[vie,bie]=OS(Iy,{hasParent:!1,positionUpdateFns:new Set}),_ie=A.forwardRef((t,e)=>{var n,r,i,s,o,a,l,c;const{__scopePopper:u,side:d="bottom",sideOffset:h=0,align:f="center",alignOffset:p=0,arrowPadding:m=0,collisionBoundary:v=[],collisionPadding:y=0,sticky:b="partial",hideWhenDetached:_=!1,avoidCollisions:E=!0,onPlaced:w,...x}=t,T=zD(Iy,u),[C,k]=A.useState(null),L=fo(e,vo=>k(vo)),[F,N]=A.useState(null),R=die(F),H=(n=R==null?void 0:R.width)!==null&&n!==void 0?n:0,W=(r=R==null?void 0:R.height)!==null&&r!==void 0?r:0,q=d+(f!=="center"?"-"+f:""),Z=typeof y=="number"?y:{top:0,right:0,bottom:0,left:0,...y},j=Array.isArray(v)?v:[v],K=j.length>0,$={padding:Z,boundary:j.filter(Sie),altBoundary:K},{reference:B,floating:G,strategy:Y,x:X,y:J,placement:ne,middlewareData:se,update:Ue}=aie({strategy:"fixed",placement:q,whileElementsMounted:iie,middleware:[Cie(),Kre({mainAxis:h+W,alignmentAxis:p}),E?qre({mainAxis:!0,crossAxis:!1,limiter:b==="partial"?Jre():void 0,...$}):void 0,F?lie({element:F,padding:m}):void 0,E?Yre({...$}):void 0,Qre({...$,apply:({elements:vo,availableWidth:r1,availableHeight:N2})=>{vo.floating.style.setProperty("--radix-popper-available-width",`${r1}px`),vo.floating.style.setProperty("--radix-popper-available-height",`${N2}px`)}}),Iie({arrowWidth:H,arrowHeight:W}),_?Zre({strategy:"referenceHidden"}):void 0].filter(Tie)});Va(()=>{B(T.anchor)},[B,T.anchor]);const De=X!==null&&J!==null,[Le,fe]=GD(ne),ke=ra(w);Va(()=>{De&&(ke==null||ke())},[De,ke]);const Xe=(i=se.arrow)===null||i===void 0?void 0:i.x,_t=(s=se.arrow)===null||s===void 0?void 0:s.y,Sn=((o=se.arrow)===null||o===void 0?void 0:o.centerOffset)!==0,[Ot,We]=A.useState();Va(()=>{C&&We(window.getComputedStyle(C).zIndex)},[C]);const{hasParent:ir,positionUpdateFns:Cn}=bie(Iy,u),Dl=!ir;A.useLayoutEffect(()=>{if(!Dl)return Cn.add(Ue),()=>{Cn.delete(Ue)}},[Dl,Cn,Ue]),Va(()=>{Dl&&De&&Array.from(Cn).reverse().forEach(vo=>requestAnimationFrame(vo))},[Dl,De,Cn]);const n1={"data-side":Le,"data-align":fe,...x,ref:L,style:{...x.style,animation:De?void 0:"none",opacity:(a=se.hide)!==null&&a!==void 0&&a.referenceHidden?0:void 0}};return A.createElement("div",{ref:G,"data-radix-popper-content-wrapper":"",style:{position:Y,left:0,top:0,transform:De?`translate3d(${Math.round(X)}px, ${Math.round(J)}px, 0)`:"translate3d(0, -200%, 0)",minWidth:"max-content",zIndex:Ot,"--radix-popper-transform-origin":[(l=se.transformOrigin)===null||l===void 0?void 0:l.x,(c=se.transformOrigin)===null||c===void 0?void 0:c.y].join(" ")},dir:t.dir},A.createElement(gie,{scope:u,placedSide:Le,onArrowChange:N,arrowX:Xe,arrowY:_t,shouldHideArrow:Sn},Dl?A.createElement(vie,{scope:u,hasParent:!0,positionUpdateFns:Cn},A.createElement(Kr.div,n1)):A.createElement(Kr.div,n1)))}),Eie="PopperArrow",wie={top:"bottom",right:"left",bottom:"top",left:"right"},xie=A.forwardRef(function(e,n){const{__scopePopper:r,...i}=e,s=yie(Eie,r),o=wie[s.placedSide];return A.createElement("span",{ref:s.onArrowChange,style:{position:"absolute",left:s.arrowX,top:s.arrowY,[o]:0,transformOrigin:{top:"",right:"0 0",bottom:"center 0",left:"100% 0"}[s.placedSide],transform:{top:"translateY(100%)",right:"translateY(50%) rotate(90deg) translateX(-50%)",bottom:"rotate(180deg)",left:"translateY(50%) rotate(-90deg) translateX(50%)"}[s.placedSide],visibility:s.shouldHideArrow?"hidden":void 0}},A.createElement(uie,It({},i,{ref:n,style:{...i.style,display:"block"}})))});function Tie(t){return t!==void 0}function Sie(t){return t!==null}const Cie=()=>({name:"anchorCssProperties",fn(t){const{rects:e,elements:n}=t,{width:r,height:i}=e.reference;return n.floating.style.setProperty("--radix-popper-anchor-width",`${r}px`),n.floating.style.setProperty("--radix-popper-anchor-height",`${i}px`),{}}}),Iie=t=>({name:"transformOrigin",options:t,fn(e){var n,r,i,s,o;const{placement:a,rects:l,middlewareData:c}=e,d=((n=c.arrow)===null||n===void 0?void 0:n.centerOffset)!==0,h=d?0:t.arrowWidth,f=d?0:t.arrowHeight,[p,m]=GD(a),v={start:"0%",center:"50%",end:"100%"}[m],y=((r=(i=c.arrow)===null||i===void 0?void 0:i.x)!==null&&r!==void 0?r:0)+h/2,b=((s=(o=c.arrow)===null||o===void 0?void 0:o.y)!==null&&s!==void 0?s:0)+f/2;let _="",E="";return p==="bottom"?(_=d?v:`${y}px`,E=`${-f}px`):p==="top"?(_=d?v:`${y}px`,E=`${l.floating.height+f}px`):p==="right"?(_=`${-f}px`,E=d?v:`${b}px`):p==="left"&&(_=`${l.floating.width+f}px`,E=d?v:`${b}px`),{data:{x:_,y:E}}}});function GD(t){const[e,n="center"]=t.split("-");return[e,n]}const Aie=fie,kie=mie,Mie=_ie,Pie=xie,Lie=A.forwardRef((t,e)=>{var n;const{container:r=globalThis==null||(n=globalThis.document)===null||n===void 0?void 0:n.body,...i}=t;return r?RG.createPortal(A.createElement(Kr.div,It({},i,{ref:e})),r):null});function Rie(t,e){return A.useReducer((n,r)=>{const i=e[n][r];return i??n},t)}const e2=t=>{const{present:e,children:n}=t,r=Oie(e),i=typeof n=="function"?n({present:r.isPresent}):A.Children.only(n),s=fo(r.ref,i.ref);return typeof n=="function"||r.isPresent?A.cloneElement(i,{ref:s}):null};e2.displayName="Presence";function Oie(t){const[e,n]=A.useState(),r=A.useRef({}),i=A.useRef(t),s=A.useRef("none"),o=t?"mounted":"unmounted",[a,l]=Rie(o,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return A.useEffect(()=>{const c=eg(r.current);s.current=a==="mounted"?c:"none"},[a]),Va(()=>{const c=r.current,u=i.current;if(u!==t){const h=s.current,f=eg(c);t?l("MOUNT"):f==="none"||(c==null?void 0:c.display)==="none"?l("UNMOUNT"):l(u&&h!==f?"ANIMATION_OUT":"UNMOUNT"),i.current=t}},[t,l]),Va(()=>{if(e){const c=d=>{const f=eg(r.current).includes(d.animationName);d.target===e&&f&&hi.flushSync(()=>l("ANIMATION_END"))},u=d=>{d.target===e&&(s.current=eg(r.current))};return e.addEventListener("animationstart",u),e.addEventListener("animationcancel",c),e.addEventListener("animationend",c),()=>{e.removeEventListener("animationstart",u),e.removeEventListener("animationcancel",c),e.removeEventListener("animationend",c)}}else l("ANIMATION_END")},[e,l]),{isPresent:["mounted","unmountSuspended"].includes(a),ref:A.useCallback(c=>{c&&(r.current=getComputedStyle(c)),n(c)},[])}}function eg(t){return(t==null?void 0:t.animationName)||"none"}function DS({prop:t,defaultProp:e,onChange:n=()=>{}}){const[r,i]=Die({defaultProp:e,onChange:n}),s=t!==void 0,o=s?t:r,a=ra(n),l=A.useCallback(c=>{if(s){const d=typeof c=="function"?c(t):c;d!==t&&a(d)}else i(c)},[s,t,i,a]);return[o,l]}function Die({defaultProp:t,onChange:e}){const n=A.useState(t),[r]=n,i=A.useRef(r),s=ra(e);return A.useEffect(()=>{i.current!==r&&(s(r),i.current=r)},[r,i,s]),n}var Nie=function(t){if(typeof document>"u")return null;var e=Array.isArray(t)?t[0]:t;return e.ownerDocument.body},xu=new WeakMap,tg=new WeakMap,ng={},p_=0,VD=function(t){return t&&(t.host||VD(t.parentNode))},Fie=function(t,e){return e.map(function(n){if(t.contains(n))return n;var r=VD(n);return r&&t.contains(r)?r:(console.error("aria-hidden",n,"in not contained inside",t,". Doing nothing"),null)}).filter(function(n){return!!n})},Bie=function(t,e,n,r){var i=Fie(e,Array.isArray(t)?t:[t]);ng[n]||(ng[n]=new WeakMap);var s=ng[n],o=[],a=new Set,l=new Set(i),c=function(d){!d||a.has(d)||(a.add(d),c(d.parentNode))};i.forEach(c);var u=function(d){!d||l.has(d)||Array.prototype.forEach.call(d.children,function(h){if(a.has(h))u(h);else{var f=h.getAttribute(r),p=f!==null&&f!=="false",m=(xu.get(h)||0)+1,v=(s.get(h)||0)+1;xu.set(h,m),s.set(h,v),o.push(h),m===1&&p&&tg.set(h,!0),v===1&&h.setAttribute(n,"true"),p||h.setAttribute(r,"true")}})};return u(e),a.clear(),p_++,function(){o.forEach(function(d){var h=xu.get(d)-1,f=s.get(d)-1;xu.set(d,h),s.set(d,f),h||(tg.has(d)||d.removeAttribute(r),tg.delete(d)),f||d.removeAttribute(n)}),p_--,p_||(xu=new WeakMap,xu=new WeakMap,tg=new WeakMap,ng={})}},Uie=function(t,e,n){n===void 0&&(n="data-aria-hidden");var r=Array.from(Array.isArray(t)?t:[t]),i=e||Nie(t);return i?(r.push.apply(r,Array.from(i.querySelectorAll("[aria-live]"))),Bie(r,i,n,"aria-hidden")):function(){return null}},Fx=function(t,e){return Fx=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(n[i]=r[i])},Fx(t,e)};function Cye(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");Fx(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}var La=function(){return La=Object.assign||function(e){for(var n,r=1,i=arguments.length;r<i;r++){n=arguments[r];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e},La.apply(this,arguments)};function $ie(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]]);return n}function Iye(t,e,n,r){function i(s){return s instanceof n?s:new n(function(o){o(s)})}return new(n||(n=Promise))(function(s,o){function a(u){try{c(r.next(u))}catch(d){o(d)}}function l(u){try{c(r.throw(u))}catch(d){o(d)}}function c(u){u.done?s(u.value):i(u.value).then(a,l)}c((r=r.apply(t,e||[])).next())})}function Aye(t,e){var n={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},r,i,s,o;return o={next:a(0),throw:a(1),return:a(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function a(c){return function(u){return l([c,u])}}function l(c){if(r)throw new TypeError("Generator is already executing.");for(;o&&(o=0,c[0]&&(n=0)),n;)try{if(r=1,i&&(s=c[0]&2?i.return:c[0]?i.throw||((s=i.return)&&s.call(i),0):i.next)&&!(s=s.call(i,c[1])).done)return s;switch(i=0,s&&(c=[c[0]&2,s.value]),c[0]){case 0:case 1:s=c;break;case 4:return n.label++,{value:c[1],done:!1};case 5:n.label++,i=c[1],c=[0];continue;case 7:c=n.ops.pop(),n.trys.pop();continue;default:if(s=n.trys,!(s=s.length>0&&s[s.length-1])&&(c[0]===6||c[0]===2)){n=0;continue}if(c[0]===3&&(!s||c[1]>s[0]&&c[1]<s[3])){n.label=c[1];break}if(c[0]===6&&n.label<s[1]){n.label=s[1],s=c;break}if(s&&n.label<s[2]){n.label=s[2],n.ops.push(c);break}s[2]&&n.ops.pop(),n.trys.pop();continue}c=e.call(t,n)}catch(u){c=[6,u],i=0}finally{r=s=0}if(c[0]&5)throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}}function kye(t){var e=typeof Symbol=="function"&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function Mye(t,e){var n=typeof Symbol=="function"&&t[Symbol.iterator];if(!n)return t;var r=n.call(t),i,s=[],o;try{for(;(e===void 0||e-- >0)&&!(i=r.next()).done;)s.push(i.value)}catch(a){o={error:a}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(o)throw o.error}}return s}function Hie(t,e,n){if(n||arguments.length===2)for(var r=0,i=e.length,s;r<i;r++)(s||!(r in e))&&(s||(s=Array.prototype.slice.call(e,0,r)),s[r]=e[r]);return t.concat(s||Array.prototype.slice.call(e))}var s0="right-scroll-bar-position",o0="width-before-scroll-bar",zie="with-scroll-bars-hidden",Gie="--removed-body-scroll-bar-size";function Vie(t,e){return typeof t=="function"?t(e):t&&(t.current=e),t}function Wie(t,e){var n=A.useState(function(){return{value:t,callback:e,facade:{get current(){return n.value},set current(r){var i=n.value;i!==r&&(n.value=r,n.callback(r,i))}}}})[0];return n.callback=e,n.facade}function jie(t,e){return Wie(e||null,function(n){return t.forEach(function(r){return Vie(r,n)})})}var Ay=function(){return Ay=Object.assign||function(e){for(var n,r=1,i=arguments.length;r<i;r++){n=arguments[r];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e},Ay.apply(this,arguments)};function Xie(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]]);return n}function Yie(t){return t}function Zie(t,e){e===void 0&&(e=Yie);var n=[],r=!1,i={read:function(){if(r)throw new Error("Sidecar: could not `read` from an `assigned` medium. `read` could be used only with `useMedium`.");return n.length?n[n.length-1]:t},useMedium:function(s){var o=e(s,r);return n.push(o),function(){n=n.filter(function(a){return a!==o})}},assignSyncMedium:function(s){for(r=!0;n.length;){var o=n;n=[],o.forEach(s)}n={push:function(a){return s(a)},filter:function(){return n}}},assignMedium:function(s){r=!0;var o=[];if(n.length){var a=n;n=[],a.forEach(s),o=n}var l=function(){var u=o;o=[],u.forEach(s)},c=function(){return Promise.resolve().then(l)};c(),n={push:function(u){o.push(u),c()},filter:function(u){return o=o.filter(u),n}}}};return i}function Kie(t){t===void 0&&(t={});var e=Zie(null);return e.options=Ay({async:!0,ssr:!1},t),e}var WD=function(t){var e=t.sideCar,n=Xie(t,["sideCar"]);if(!e)throw new Error("Sidecar: please provide `sideCar` property to import the right car");var r=e.read();if(!r)throw new Error("Sidecar medium not found");return A.createElement(r,Ay({},n))};WD.isSideCarExport=!0;function qie(t,e){return t.useMedium(e),WD}var jD=Kie(),m_=function(){},t2=A.forwardRef(function(t,e){var n=A.useRef(null),r=A.useState({onScrollCapture:m_,onWheelCapture:m_,onTouchMoveCapture:m_}),i=r[0],s=r[1],o=t.forwardProps,a=t.children,l=t.className,c=t.removeScrollBar,u=t.enabled,d=t.shards,h=t.sideCar,f=t.noIsolation,p=t.inert,m=t.allowPinchZoom,v=t.as,y=v===void 0?"div":v,b=$ie(t,["forwardProps","children","className","removeScrollBar","enabled","shards","sideCar","noIsolation","inert","allowPinchZoom","as"]),_=h,E=jie([n,e]),w=La(La({},b),i);return A.createElement(A.Fragment,null,u&&A.createElement(_,{sideCar:jD,removeScrollBar:c,shards:d,noIsolation:f,inert:p,setCallbacks:s,allowPinchZoom:!!m,lockRef:n}),o?A.cloneElement(A.Children.only(a),La(La({},w),{ref:E})):A.createElement(y,La({},w,{className:l,ref:E}),a))});t2.defaultProps={enabled:!0,removeScrollBar:!0,inert:!1};t2.classNames={fullWidth:o0,zeroRight:s0};var dA,Jie=function(){if(dA)return dA;if(typeof __webpack_nonce__<"u")return __webpack_nonce__};function Qie(){if(!document)return null;var t=document.createElement("style");t.type="text/css";var e=Jie();return e&&t.setAttribute("nonce",e),t}function ese(t,e){t.styleSheet?t.styleSheet.cssText=e:t.appendChild(document.createTextNode(e))}function tse(t){var e=document.head||document.getElementsByTagName("head")[0];e.appendChild(t)}var nse=function(){var t=0,e=null;return{add:function(n){t==0&&(e=Qie())&&(ese(e,n),tse(e)),t++},remove:function(){t--,!t&&e&&(e.parentNode&&e.parentNode.removeChild(e),e=null)}}},rse=function(){var t=nse();return function(e,n){A.useEffect(function(){return t.add(e),function(){t.remove()}},[e&&n])}},XD=function(){var t=rse(),e=function(n){var r=n.styles,i=n.dynamic;return t(r,i),null};return e},ise={left:0,top:0,right:0,gap:0},g_=function(t){return parseInt(t||"",10)||0},sse=function(t){var e=window.getComputedStyle(document.body),n=e[t==="padding"?"paddingLeft":"marginLeft"],r=e[t==="padding"?"paddingTop":"marginTop"],i=e[t==="padding"?"paddingRight":"marginRight"];return[g_(n),g_(r),g_(i)]},ose=function(t){if(t===void 0&&(t="margin"),typeof window>"u")return ise;var e=sse(t),n=document.documentElement.clientWidth,r=window.innerWidth;return{left:e[0],top:e[1],right:e[2],gap:Math.max(0,r-n+e[2]-e[0])}},ase=XD(),lse=function(t,e,n,r){var i=t.left,s=t.top,o=t.right,a=t.gap;return n===void 0&&(n="margin"),`
  .`.concat(zie,` {
   overflow: hidden `).concat(r,`;
   padding-right: `).concat(a,"px ").concat(r,`;
  }
  body {
    overflow: hidden `).concat(r,`;
    overscroll-behavior: contain;
    `).concat([e&&"position: relative ".concat(r,";"),n==="margin"&&`
    padding-left: `.concat(i,`px;
    padding-top: `).concat(s,`px;
    padding-right: `).concat(o,`px;
    margin-left:0;
    margin-top:0;
    margin-right: `).concat(a,"px ").concat(r,`;
    `),n==="padding"&&"padding-right: ".concat(a,"px ").concat(r,";")].filter(Boolean).join(""),`
  }
  
  .`).concat(s0,` {
    right: `).concat(a,"px ").concat(r,`;
  }
  
  .`).concat(o0,` {
    margin-right: `).concat(a,"px ").concat(r,`;
  }
  
  .`).concat(s0," .").concat(s0,` {
    right: 0 `).concat(r,`;
  }
  
  .`).concat(o0," .").concat(o0,` {
    margin-right: 0 `).concat(r,`;
  }
  
  body {
    `).concat(Gie,": ").concat(a,`px;
  }
`)},cse=function(t){var e=t.noRelative,n=t.noImportant,r=t.gapMode,i=r===void 0?"margin":r,s=A.useMemo(function(){return ose(i)},[i]);return A.createElement(ase,{styles:lse(s,!e,i,n?"":"!important")})},Bx=!1;if(typeof window<"u")try{var rg=Object.defineProperty({},"passive",{get:function(){return Bx=!0,!0}});window.addEventListener("test",rg,rg),window.removeEventListener("test",rg,rg)}catch{Bx=!1}var Tu=Bx?{passive:!1}:!1,use=function(t){return t.tagName==="TEXTAREA"},YD=function(t,e){var n=window.getComputedStyle(t);return n[e]!=="hidden"&&!(n.overflowY===n.overflowX&&!use(t)&&n[e]==="visible")},dse=function(t){return YD(t,"overflowY")},hse=function(t){return YD(t,"overflowX")},hA=function(t,e){var n=e;do{typeof ShadowRoot<"u"&&n instanceof ShadowRoot&&(n=n.host);var r=ZD(t,n);if(r){var i=KD(t,n),s=i[1],o=i[2];if(s>o)return!0}n=n.parentNode}while(n&&n!==document.body);return!1},fse=function(t){var e=t.scrollTop,n=t.scrollHeight,r=t.clientHeight;return[e,n,r]},pse=function(t){var e=t.scrollLeft,n=t.scrollWidth,r=t.clientWidth;return[e,n,r]},ZD=function(t,e){return t==="v"?dse(e):hse(e)},KD=function(t,e){return t==="v"?fse(e):pse(e)},mse=function(t,e){return t==="h"&&e==="rtl"?-1:1},gse=function(t,e,n,r,i){var s=mse(t,window.getComputedStyle(e).direction),o=s*r,a=n.target,l=e.contains(a),c=!1,u=o>0,d=0,h=0;do{var f=KD(t,a),p=f[0],m=f[1],v=f[2],y=m-v-s*p;(p||y)&&ZD(t,a)&&(d+=y,h+=p),a=a.parentNode}while(!l&&a!==document.body||l&&(e.contains(a)||e===a));return(u&&(i&&d===0||!i&&o>d)||!u&&(i&&h===0||!i&&-o>h))&&(c=!0),c},ig=function(t){return"changedTouches"in t?[t.changedTouches[0].clientX,t.changedTouches[0].clientY]:[0,0]},fA=function(t){return[t.deltaX,t.deltaY]},pA=function(t){return t&&"current"in t?t.current:t},yse=function(t,e){return t[0]===e[0]&&t[1]===e[1]},vse=function(t){return`
  .block-interactivity-`.concat(t,` {pointer-events: none;}
  .allow-interactivity-`).concat(t,` {pointer-events: all;}
`)},bse=0,Su=[];function _se(t){var e=A.useRef([]),n=A.useRef([0,0]),r=A.useRef(),i=A.useState(bse++)[0],s=A.useState(function(){return XD()})[0],o=A.useRef(t);A.useEffect(function(){o.current=t},[t]),A.useEffect(function(){if(t.inert){document.body.classList.add("block-interactivity-".concat(i));var m=Hie([t.lockRef.current],(t.shards||[]).map(pA),!0).filter(Boolean);return m.forEach(function(v){return v.classList.add("allow-interactivity-".concat(i))}),function(){document.body.classList.remove("block-interactivity-".concat(i)),m.forEach(function(v){return v.classList.remove("allow-interactivity-".concat(i))})}}},[t.inert,t.lockRef.current,t.shards]);var a=A.useCallback(function(m,v){if("touches"in m&&m.touches.length===2)return!o.current.allowPinchZoom;var y=ig(m),b=n.current,_="deltaX"in m?m.deltaX:b[0]-y[0],E="deltaY"in m?m.deltaY:b[1]-y[1],w,x=m.target,T=Math.abs(_)>Math.abs(E)?"h":"v";if("touches"in m&&T==="h"&&x.type==="range")return!1;var C=hA(T,x);if(!C)return!0;if(C?w=T:(w=T==="v"?"h":"v",C=hA(T,x)),!C)return!1;if(!r.current&&"changedTouches"in m&&(_||E)&&(r.current=w),!w)return!0;var k=r.current||w;return gse(k,v,m,k==="h"?_:E,!0)},[]),l=A.useCallback(function(m){var v=m;if(!(!Su.length||Su[Su.length-1]!==s)){var y="deltaY"in v?fA(v):ig(v),b=e.current.filter(function(w){return w.name===v.type&&w.target===v.target&&yse(w.delta,y)})[0];if(b&&b.should){v.cancelable&&v.preventDefault();return}if(!b){var _=(o.current.shards||[]).map(pA).filter(Boolean).filter(function(w){return w.contains(v.target)}),E=_.length>0?a(v,_[0]):!o.current.noIsolation;E&&v.cancelable&&v.preventDefault()}}},[]),c=A.useCallback(function(m,v,y,b){var _={name:m,delta:v,target:y,should:b};e.current.push(_),setTimeout(function(){e.current=e.current.filter(function(E){return E!==_})},1)},[]),u=A.useCallback(function(m){n.current=ig(m),r.current=void 0},[]),d=A.useCallback(function(m){c(m.type,fA(m),m.target,a(m,t.lockRef.current))},[]),h=A.useCallback(function(m){c(m.type,ig(m),m.target,a(m,t.lockRef.current))},[]);A.useEffect(function(){return Su.push(s),t.setCallbacks({onScrollCapture:d,onWheelCapture:d,onTouchMoveCapture:h}),document.addEventListener("wheel",l,Tu),document.addEventListener("touchmove",l,Tu),document.addEventListener("touchstart",u,Tu),function(){Su=Su.filter(function(m){return m!==s}),document.removeEventListener("wheel",l,Tu),document.removeEventListener("touchmove",l,Tu),document.removeEventListener("touchstart",u,Tu)}},[]);var f=t.removeScrollBar,p=t.inert;return A.createElement(A.Fragment,null,p?A.createElement(s,{styles:vse(i)}):null,f?A.createElement(cse,{gapMode:"margin"}):null)}const Ese=qie(jD,_se);var qD=A.forwardRef(function(t,e){return A.createElement(t2,La({},t,{ref:e,sideCar:Ese}))});qD.classNames=t2.classNames;const wse=qD,JD="Popover",[QD,Pye]=Gm(JD,[HD]),n2=HD(),[xse,gh]=QD(JD),Tse=t=>{const{__scopePopover:e,children:n,open:r,defaultOpen:i,onOpenChange:s,modal:o=!1}=t,a=n2(e),l=A.useRef(null),[c,u]=A.useState(!1),[d=!1,h]=DS({prop:r,defaultProp:i,onChange:s});return A.createElement(Aie,a,A.createElement(xse,{scope:e,contentId:PS(),triggerRef:l,open:d,onOpenChange:h,onOpenToggle:A.useCallback(()=>h(f=>!f),[h]),hasCustomAnchor:c,onCustomAnchorAdd:A.useCallback(()=>u(!0),[]),onCustomAnchorRemove:A.useCallback(()=>u(!1),[]),modal:o},n))},Sse="PopoverTrigger",Cse=A.forwardRef((t,e)=>{const{__scopePopover:n,...r}=t,i=gh(Sse,n),s=n2(n),o=fo(e,i.triggerRef),a=A.createElement(Kr.button,It({type:"button","aria-haspopup":"dialog","aria-expanded":i.open,"aria-controls":i.contentId,"data-state":nN(i.open)},r,{ref:o,onClick:gr(t.onClick,i.onOpenToggle)}));return i.hasCustomAnchor?a:A.createElement(kie,It({asChild:!0},s),a)}),eN="PopoverPortal",[Ise,Ase]=QD(eN,{forceMount:void 0}),kse=t=>{const{__scopePopover:e,forceMount:n,children:r,container:i}=t,s=gh(eN,e);return A.createElement(Ise,{scope:e,forceMount:n},A.createElement(e2,{present:n||s.open},A.createElement(Lie,{asChild:!0,container:i},r)))},tm="PopoverContent",Mse=A.forwardRef((t,e)=>{const n=Ase(tm,t.__scopePopover),{forceMount:r=n.forceMount,...i}=t,s=gh(tm,t.__scopePopover);return A.createElement(e2,{present:r||s.open},s.modal?A.createElement(Pse,It({},i,{ref:e})):A.createElement(Lse,It({},i,{ref:e})))}),Pse=A.forwardRef((t,e)=>{const n=gh(tm,t.__scopePopover),r=A.useRef(null),i=fo(e,r),s=A.useRef(!1);return A.useEffect(()=>{const o=r.current;if(o)return Uie(o)},[]),A.createElement(wse,{as:Qp,allowPinchZoom:!0},A.createElement(tN,It({},t,{ref:i,trapFocus:n.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:gr(t.onCloseAutoFocus,o=>{var a;o.preventDefault(),s.current||(a=n.triggerRef.current)===null||a===void 0||a.focus()}),onPointerDownOutside:gr(t.onPointerDownOutside,o=>{const a=o.detail.originalEvent,l=a.button===0&&a.ctrlKey===!0,c=a.button===2||l;s.current=c},{checkForDefaultPrevented:!1}),onFocusOutside:gr(t.onFocusOutside,o=>o.preventDefault(),{checkForDefaultPrevented:!1})})))}),Lse=A.forwardRef((t,e)=>{const n=gh(tm,t.__scopePopover),r=A.useRef(!1);return A.createElement(tN,It({},t,{ref:e,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:i=>{var s;if((s=t.onCloseAutoFocus)===null||s===void 0||s.call(t,i),!i.defaultPrevented){var o;r.current||(o=n.triggerRef.current)===null||o===void 0||o.focus(),i.preventDefault()}r.current=!1},onInteractOutside:i=>{var s,o;(s=t.onInteractOutside)===null||s===void 0||s.call(t,i),i.defaultPrevented||(r.current=!0);const a=i.target;((o=n.triggerRef.current)===null||o===void 0?void 0:o.contains(a))&&i.preventDefault()}}))}),tN=A.forwardRef((t,e)=>{const{__scopePopover:n,trapFocus:r,onOpenAutoFocus:i,onCloseAutoFocus:s,disableOutsidePointerEvents:o,onEscapeKeyDown:a,onPointerDownOutside:l,onFocusOutside:c,onInteractOutside:u,...d}=t,h=gh(tm,n),f=n2(n);return Rre(),A.createElement(Ore,{asChild:!0,loop:!0,trapped:r,onMountAutoFocus:i,onUnmountAutoFocus:s},A.createElement(Mre,{asChild:!0,disableOutsidePointerEvents:o,onInteractOutside:u,onEscapeKeyDown:a,onPointerDownOutside:l,onFocusOutside:c,onDismiss:()=>h.onOpenChange(!1)},A.createElement(Mie,It({"data-state":nN(h.open),role:"dialog",id:h.contentId},f,d,{ref:e,style:{...d.style,"--radix-popover-content-transform-origin":"var(--radix-popper-transform-origin)"}}))))}),Rse=A.forwardRef((t,e)=>{const{__scopePopover:n,...r}=t,i=n2(n);return A.createElement(Pie,It({},i,r,{ref:e}))});function nN(t){return t?"open":"closed"}const r2=Tse,i2=Cse,Ose=kse,s2=Mse,Dse=Rse,rN=ce.createContext(null),br=()=>ce.useContext(rN),iN=t=>{const[e,n]=A.useState(null),r=_r(),{theme:i}=br(),{container:s}=pa();return A.useLayoutEffect(()=>{var o;e&&(e.className="",e.classList.add("excalidraw",...((o=t==null?void 0:t.className)==null?void 0:o.split(/\s+/))||[]),e.classList.toggle("excalidraw--mobile",r.editor.isMobile),e.classList.toggle("theme--dark",i==="dark"))},[e,i,r.editor.isMobile,t==null?void 0:t.className]),A.useLayoutEffect(()=>{const o=t!=null&&t.parentSelector?s==null?void 0:s.querySelector(t.parentSelector):document.body;if(!o)return;const a=document.createElement("div");return o.appendChild(a),n(a),()=>{o.removeChild(a)}},[s,t==null?void 0:t.parentSelector]),e};function NS(t,e,n){A.useEffect(()=>{function r(i){const s=i;if(!t.current)return;const o=n==null?void 0:n(s,t.current);if(o===!0)return;if(o===!1)return e(s);t.current.contains(s.target)||!document.documentElement.contains(s.target)||s.target.closest("[data-radix-portal]")||s.target===document.documentElement&&document.body.style.pointerEvents==="none"||s.target.closest("[data-prevent-outside-click]")||e(s)}return document.addEventListener(ee.POINTER_DOWN,r),document.addEventListener(ee.TOUCH_START,r),()=>{document.removeEventListener(ee.POINTER_DOWN,r),document.removeEventListener(ee.TOUCH_START,r)}},[t,e,n])}const Nse=t=>{const e=A.useRef(t);return Object.assign(e.current,t),e.current},o2=Yn(null),Fse=({onCancel:t,onChange:e,onSelect:n,colorPickerType:r})=>{const i=iN({className:"excalidraw-eye-dropper-backdrop",parentSelector:".excalidraw-eye-dropper-container"}),s=br(),o=P2(),a=Sh(),l=Rt(o,s),c=Nse({app:a,onCancel:t,onChange:e,onSelect:n,selectedElements:l}),{container:u}=pa();A.useEffect(()=>{const h=d.current;if(!h||!a.canvas||!i)return;let f=!1;const p=a.canvas.getContext("2d"),m=({clientX:x,clientY:T})=>{const C=p.getImageData((x-s.offsetLeft)*window.devicePixelRatio,(T-s.offsetTop)*window.devicePixelRatio,1,1).data;return EV(C[0],C[1],C[2])},v=({clientX:x,clientY:T,altKey:C})=>{h.style.top=`${T+20}px`,h.style.left=`${x+20}px`;const k=m({clientX:x,clientY:T});f&&c.onChange(r,k,c.selectedElements,{altKey:C}),h.style.background=k},y=()=>{c.onCancel()},b=(x,T)=>{c.onSelect(x,T)},_=x=>{f=!0,x.stopImmediatePropagation()},E=x=>{f=!1,u==null||u.focus(),x.stopImmediatePropagation(),x.preventDefault(),b(m(x),x)},w=x=>{x.key===z.ESCAPE&&(x.preventDefault(),x.stopImmediatePropagation(),y())};return i.tabIndex=-1,i.focus(),v({clientX:c.app.lastViewportPosition.x,clientY:c.app.lastViewportPosition.y,altKey:!1}),i.addEventListener(ee.KEYDOWN,w),i.addEventListener(ee.POINTER_DOWN,_),i.addEventListener(ee.POINTER_UP,E),window.addEventListener("pointermove",v,{passive:!0}),window.addEventListener(ee.BLUR,y),()=>{f=!1,i.removeEventListener(ee.KEYDOWN,w),i.removeEventListener(ee.POINTER_DOWN,_),i.removeEventListener(ee.POINTER_UP,E),window.removeEventListener("pointermove",v),window.removeEventListener(ee.BLUR,y)}},[c,a.canvas,i,r,u,s.offsetLeft,s.offsetTop]);const d=A.useRef(null);return NS(d,()=>{t()},h=>!!h.target.closest(".excalidraw-eye-dropper-trigger, .excalidraw-eye-dropper-backdrop")),i?hi.createPortal(g("div",{ref:d,className:"excalidraw-eye-dropper-preview"}),i):null},Bse=({color:t,onChange:e,label:n,colorPickerType:r})=>{const i=_r(),[s,o]=A.useState(t),[a,l]=Ht(ph);A.useEffect(()=>{o(t)},[t]);const c=A.useCallback(p=>{const m=p.toLowerCase(),v=Use(m);v&&e(v),o(m)},[e]),u=A.useRef(null),d=A.useRef(null);A.useEffect(()=>{u.current&&u.current.focus()},[a]);const[h,f]=Ht(o2,rr);return A.useEffect(()=>()=>{f(null)},[f]),M("div",{className:"color-picker__input-label",children:[g("div",{className:"color-picker__input-hash",children:"#"}),g("input",{ref:a==="hex"?u:void 0,style:{border:0,padding:0},spellCheck:!1,className:"color-picker-input","aria-label":n,onChange:p=>{c(p.target.value)},value:(s||"").replace(/^#/,""),onBlur:()=>{o(t)},tabIndex:-1,onFocus:()=>l("hex"),onKeyDown:p=>{var m;p.key!==z.TAB&&(p.key===z.ESCAPE&&((m=d.current)==null||m.focus()),p.stopPropagation())}}),!i.editor.isMobile&&M(ge,{children:[g("div",{style:{width:"1px",height:"1.25rem",backgroundColor:"var(--default-border-color)"}}),g("div",{ref:d,className:Ee("excalidraw-eye-dropper-trigger",{selected:h}),onClick:()=>f(p=>p?null:{keepOpenOnAlt:!1,onSelect:m=>e(m),colorPickerType:r}),title:`${I("labels.eyeDropper")} — ${z.I.toLocaleUpperCase()} or ${re("Alt")} `,children:Fte})]})]})},mA=t=>{const e=new Option().style;return e.color=t,!!e.color},Use=t=>to(t)?t:mA(`#${t}`)?`#${t}`:mA(t)?t:null,$se=({type:t,color:e,onChange:n,label:r,elements:i,palette:s=Ge,updateData:o})=>{const[,a]=Ht(ph),[l,c]=Ht(o2,rr),{container:u}=pa(),d=_r(),h=M("div",{children:[g(i0,{children:I("colorPicker.hexCode")}),g(Bse,{color:e,label:r,onChange:m=>{n(m)},colorPickerType:t})]}),f=A.useRef(null),p=()=>{var m,v;(v=(m=f.current)==null?void 0:m.querySelector(".color-picker-content"))==null||v.focus()};return g(Ose,{container:u,children:M(s2,{ref:f,className:"focus-visible-none","data-prevent-outside-click":!0,onFocusOutside:m=>{p(),m.preventDefault()},onPointerDownOutside:m=>{l&&m.preventDefault()},onCloseAutoFocus:m=>{m.stopPropagation(),m.preventDefault(),u&&!cW(document.activeElement)&&u.focus(),o({openPopup:null}),a(null)},side:d.editor.isMobile&&!d.viewport.isLandscape?"bottom":"right",align:d.editor.isMobile&&!d.viewport.isLandscape?"center":"start",alignOffset:-16,sideOffset:20,style:{zIndex:"var(--zIndex-layerUI)",backgroundColor:"var(--popup-bg-color)",maxWidth:"208px",maxHeight:window.innerHeight,padding:"12px",borderRadius:"8px",boxSizing:"border-box",overflowY:"auto",boxShadow:"0px 7px 14px rgba(0, 0, 0, 0.05), 0px 0px 3.12708px rgba(0, 0, 0, 0.0798), 0px 0px 0.931014px rgba(0, 0, 0, 0.1702)"},children:[s?g(vre,{palette:s,color:e,onChange:m=>{n(m)},onEyeDropperToggle:m=>{c(v=>m?(v=v||{keepOpenOnAlt:!0,onSelect:n,colorPickerType:t},v.keepOpenOnAlt=!0,v):m===!1||v?null:{keepOpenOnAlt:!1,onSelect:n,colorPickerType:t})},onEscape:m=>{l?c(null):rc(m.target)?p():o({openPopup:null})},label:r,type:t,elements:i,updateData:o,children:h}):h,g(Dse,{width:20,height:10,style:{fill:"var(--popup-bg-color)",filter:"drop-shadow(rgba(0, 0, 0, 0.05) 0px 3px 2px)"}})]})})},Hse=({label:t,color:e,type:n})=>g(i2,{type:"button",className:Ee("color-picker__button active-color",{"is-transparent":e==="transparent"||!e}),"aria-label":t,style:e?{"--swatch-color":e}:void 0,title:I(n==="elementStroke"?"labels.showStroke":"labels.showBackground"),children:g("div",{className:"color-picker__button-outline"})}),FS=({type:t,color:e,onChange:n,label:r,elements:i,palette:s=Ge,topPicks:o,updateData:a,appState:l})=>g("div",{children:M("div",{role:"dialog","aria-modal":"true",className:"color-picker-container",children:[g(ure,{activeColor:e,onChange:n,type:t,topPicks:o}),g("div",{style:{width:1,height:"100%",backgroundColor:"var(--default-border-color)",margin:"0 auto"}}),M(r2,{open:l.openPopup===t,onOpenChange:c=>{a({openPopup:c?t:null})},children:[g(Hse,{color:e,label:r,type:t}),l.openPopup===t&&g($se,{type:t,color:e,onChange:n,label:r,elements:i,palette:s,updateData:a})]})]})}),sN=({children:t,left:e,top:n,onCloseRequest:r,fitInViewport:i=!1,offsetLeft:s=0,offsetTop:o=0,viewportWidth:a=window.innerWidth,viewportHeight:l=window.innerHeight})=>{const c=A.useRef(null);A.useEffect(()=>{const d=c.current;if(!d)return;d.contains(document.activeElement)||d.focus();const h=f=>{var p,m,v;if(f.key===z.TAB){const y=gw(d),{activeElement:b}=document,_=y.findIndex(E=>E===b);b===d?(f.shiftKey?(p=y[y.length-1])==null||p.focus():y[0].focus(),f.preventDefault(),f.stopImmediatePropagation()):_===0&&f.shiftKey?((m=y[y.length-1])==null||m.focus(),f.preventDefault(),f.stopImmediatePropagation()):_===y.length-1&&!f.shiftKey&&((v=y[0])==null||v.focus(),f.preventDefault(),f.stopImmediatePropagation())}};return d.addEventListener("keydown",h),()=>d.removeEventListener("keydown",h)},[]);const u=A.useRef(null);return A.useLayoutEffect(()=>{var d,h;if(i&&c.current&&n!=null&&e!=null){const f=c.current,{width:p,height:m}=f.getBoundingClientRect();if(((d=u.current)==null?void 0:d.top)===n&&((h=u.current)==null?void 0:h.left)===e)return;u.current={top:n,left:e},p>=a?(f.style.width=`${a}px`,f.style.left="0px",f.style.overflowX="scroll"):e+p-s>a?f.style.left=`${a-p-10}px`:f.style.left=`${e}px`,m>=l?(f.style.height=`${l-20}px`,f.style.top="10px",f.style.overflowY="scroll"):n+m-o>l?f.style.top=`${l-m}px`:f.style.top=`${n}px`}},[n,e,i,a,l,s,o]),A.useEffect(()=>{if(r){const d=h=>{var f;(f=c.current)!=null&&f.contains(h.target)||hi.unstable_batchedUpdates(()=>r(h))};return document.addEventListener("pointerdown",d,!1),()=>document.removeEventListener("pointerdown",d,!1)}},[r]),g("div",{className:"popover",ref:c,tabIndex:-1,children:t})};function zse({options:t,value:e,label:n,onChange:r,onClose:i}){const s=ce.useRef(),o=ce.useRef(),a=ce.useRef(null);return ce.useEffect(()=>{o.current?o.current.focus():a.current&&a.current.focus()},[]),g("div",{className:"picker",role:"dialog","aria-modal":"true","aria-label":n,onKeyDown:c=>{const u=t.find(d=>d.keyBinding===c.key.toLowerCase());if(!(c.metaKey||c.altKey||c.ctrlKey)&&u){const d=t.indexOf(u);a.current.children[d].focus(),c.preventDefault()}else if(c.key===z.TAB)setTimeout(()=>{const d=o.current,h=document.activeElement;d!==h&&i()},0);else if(r0(c.key)){const{activeElement:d}=document,h=km().rtl,f=Array.prototype.indexOf.call(a.current.children,d);if(f!==-1){const p=t.length;let m=f;switch(c.key){case(h?z.ARROW_LEFT:z.ARROW_RIGHT):case z.ARROW_DOWN:{m=(f+1)%p;break}case(h?z.ARROW_RIGHT:z.ARROW_LEFT):case z.ARROW_UP:{m=(p+f-1)%p;break}}a.current.children[m].focus()}c.preventDefault()}else(c.key===z.ESCAPE||c.key===z.ENTER)&&(c.preventDefault(),i());c.nativeEvent.stopImmediatePropagation(),c.stopPropagation()},children:g("div",{className:"picker-content",ref:a,children:t.map((c,u)=>M("button",{className:Ee("picker-option",{active:e===c.value}),onClick:d=>{d.currentTarget.focus(),r(c.value)},title:`${c.text} ${c.keyBinding&&`— ${c.keyBinding.toUpperCase()}`}`,"aria-label":c.text||"none","aria-keyshortcuts":c.keyBinding||void 0,ref:d=>{d&&u===0&&(s.current=d),d&&c.value===e&&(o.current=d)},onFocus:()=>{r(c.value)},children:[c.icon,c.keyBinding&&g("span",{className:"picker-keybinding",children:c.keyBinding})]},c.text))})})}function gA({value:t,label:e,options:n,onChange:r,group:i=""}){var c;const[s,o]=ce.useState(!1),a=ce.useRef(null),l=km().rtl;return M("div",{children:[g("button",{name:i,className:s?"active":"","aria-label":e,onClick:()=>o(!s),ref:a,children:(c=n.find(u=>u.value===t))==null?void 0:c.icon}),g(ce.Suspense,{fallback:"",children:s?M(ge,{children:[g(sN,{onCloseRequest:u=>u.target!==a.current&&o(!1),...l?{right:5.5}:{left:-5.5},children:g(zse,{options:n.filter(u=>u.showInPicker!==!1),value:t,label:e,onChange:r,onClose:()=>{var u;o(!1),(u=a.current)==null||u.focus()}})}),g("div",{className:"picker-triangle"})]}):null})]})}const ld=t=>t==="rectangle"||t==="iframe"||t==="embeddable"||t==="ellipse"||t==="diamond"||t==="line"||t==="freedraw",Ux=t=>t!=="image"&&t!=="frame"&&t!=="magicframe",yA=t=>t==="rectangle"||t==="iframe"||t==="embeddable"||t==="ellipse"||t==="diamond"||t==="freedraw"||t==="arrow"||t==="line",vA=t=>t==="rectangle"||t==="iframe"||t==="embeddable"||t==="ellipse"||t==="diamond"||t==="arrow"||t==="line",$x=t=>t==="rectangle"||t==="iframe"||t==="embeddable"||t==="arrow"||t==="line"||t==="diamond",ky=t=>t==="arrow",Gse=(t,e)=>{let n=null;for(let r=t.length-1;r>=0;--r){const i=t[r];if(!i.isDeleted&&e(i)){n=i;break}}return n},Vse=(t,e)=>{const n=[];return t.filter(i=>!i.isDeleted&&e(i)?Pa(i)?(n.push(i),!1):!0:!1).concat(n)},oN=.1,gi=(t,e,n,r=!1)=>{const i=xn(Rt(t,e,{includeBoundTextElement:r}));return t.map(s=>{var o;return i.get(s.id)||s.id===((o=e.editingElement)==null?void 0:o.id)?n(s):s})},qr=function(t,e,n,r,i){const s=e.editingElement,o=yt(t);let a=null;return s&&(a=n(s)),a||(wn(o,e)?a=sue(r===!0?o:o.filter(c=>r(c)),e,n)??(typeof i=="function"?i(!0):i):a=typeof i=="function"?i(!1):i),a},Wse=(t,e)=>nn(e)?e:ae(e,{x:t.textAlign==="left"?t.x:t.x+(t.width-e.width)/(t.textAlign==="center"?2:1),y:t.y+(t.height-e.height)/2},!1),BS=(t,e,n,r)=>{const i=new Set;return{elements:gi(t,e,s=>{if(Se(s)){const o=n(s);i.add(o);let a=Re(s,{fontSize:o});return go(a,Dn(s)),a=Wse(s,a),a}return s},!0),appState:{...e,currentItemFontSize:i.size===1?[...i][0]:r??e.currentItemFontSize},commitToHistory:!0}};ue({name:"changeStrokeColor",trackEvent:!1,perform:(t,e,n)=>({...n.currentItemStrokeColor&&{elements:gi(t,e,r=>Ux(r.type)?Re(r,{strokeColor:n.currentItemStrokeColor}):r,!0)},appState:{...e,...n},commitToHistory:!!n.currentItemStrokeColor}),PanelComponent:({elements:t,appState:e,updateData:n,appProps:r})=>M(ge,{children:[g("h3",{"aria-hidden":"true",children:I("labels.stroke")}),g(FS,{topPicks:c7,palette:vV,type:"elementStroke",label:I("labels.stroke"),color:qr(t,e,i=>i.strokeColor,!0,e.currentItemStrokeColor),onChange:i=>n({currentItemStrokeColor:i}),elements:t,appState:e,updateData:n})]})});ue({name:"changeBackgroundColor",trackEvent:!1,perform:(t,e,n)=>({...n.currentItemBackgroundColor&&{elements:gi(t,e,r=>Re(r,{backgroundColor:n.currentItemBackgroundColor}))},appState:{...e,...n},commitToHistory:!!n.currentItemBackgroundColor}),PanelComponent:({elements:t,appState:e,updateData:n,appProps:r})=>M(ge,{children:[g("h3",{"aria-hidden":"true",children:I("labels.background")}),g(FS,{topPicks:u7,palette:bV,type:"elementBackground",label:I("labels.background"),color:qr(t,e,i=>i.backgroundColor,!0,e.currentItemBackgroundColor),onChange:i=>n({currentItemBackgroundColor:i}),elements:t,appState:e,updateData:n})]})});ue({name:"changeFillStyle",trackEvent:!1,perform:(t,e,n,r)=>(at("element","changeFillStyle",`${n} (${r.device.editor.isMobile?"mobile":"desktop"})`),{elements:gi(t,e,i=>Re(i,{fillStyle:n})),appState:{...e,currentItemFillStyle:n},commitToHistory:!0}),PanelComponent:({elements:t,appState:e,updateData:n})=>{const r=Rt(t,e),i=r.length>0&&r.every(s=>s.fillStyle==="zigzag");return M("fieldset",{children:[g("legend",{children:I("labels.fill")}),g(da,{type:"button",options:[{value:"hachure",text:`${I(i?"labels.zigzag":"labels.hachure")} (${re("Alt-Click")})`,icon:i?Jee:Qee,active:i?!0:void 0,testId:"fill-hachure"},{value:"cross-hatch",text:I("labels.crossHatch"),icon:ete,testId:"fill-cross-hatch"},{value:"solid",text:I("labels.solid"),icon:tte,testId:"fill-solid"}],value:qr(t,e,s=>s.fillStyle,s=>s.hasOwnProperty("fillStyle"),s=>s?null:e.currentItemFillStyle),onClick:(s,o)=>{const a=o.altKey&&s==="hachure"&&r.every(l=>l.fillStyle==="hachure")?"zigzag":s;n(a)}})]})}});ue({name:"changeStrokeWidth",trackEvent:!1,perform:(t,e,n)=>({elements:gi(t,e,r=>Re(r,{strokeWidth:n})),appState:{...e,currentItemStrokeWidth:n},commitToHistory:!0}),PanelComponent:({elements:t,appState:e,updateData:n})=>M("fieldset",{children:[g("legend",{children:I("labels.strokeWidth")}),g(da,{group:"stroke-width",options:[{value:pb.thin,text:I("labels.thin"),icon:qO,testId:"strokeWidth-thin"},{value:pb.bold,text:I("labels.bold"),icon:nte,testId:"strokeWidth-bold"},{value:pb.extraBold,text:I("labels.extraBold"),icon:rte,testId:"strokeWidth-extraBold"}],value:qr(t,e,r=>r.strokeWidth,r=>r.hasOwnProperty("strokeWidth"),r=>r?null:e.currentItemStrokeWidth),onChange:r=>n(r)})]})});ue({name:"changeSloppiness",trackEvent:!1,perform:(t,e,n)=>({elements:gi(t,e,r=>Re(r,{seed:Rl(),roughness:n})),appState:{...e,currentItemRoughness:n},commitToHistory:!0}),PanelComponent:({elements:t,appState:e,updateData:n})=>M("fieldset",{children:[g("legend",{children:I("labels.sloppiness")}),g(da,{group:"sloppiness",options:[{value:0,text:I("labels.architect"),icon:ote},{value:1,text:I("labels.artist"),icon:ate},{value:2,text:I("labels.cartoonist"),icon:lte}],value:qr(t,e,r=>r.roughness,r=>r.hasOwnProperty("roughness"),r=>r?null:e.currentItemRoughness),onChange:r=>n(r)})]})});ue({name:"changeStrokeStyle",trackEvent:!1,perform:(t,e,n)=>({elements:gi(t,e,r=>Re(r,{strokeStyle:n})),appState:{...e,currentItemStrokeStyle:n},commitToHistory:!0}),PanelComponent:({elements:t,appState:e,updateData:n})=>M("fieldset",{children:[g("legend",{children:I("labels.strokeStyle")}),g(da,{group:"strokeStyle",options:[{value:"solid",text:I("labels.strokeStyle_solid"),icon:qO},{value:"dashed",text:I("labels.strokeStyle_dashed"),icon:ite},{value:"dotted",text:I("labels.strokeStyle_dotted"),icon:ste}],value:qr(t,e,r=>r.strokeStyle,r=>r.hasOwnProperty("strokeStyle"),r=>r?null:e.currentItemStrokeStyle),onChange:r=>n(r)})]})});ue({name:"changeOpacity",trackEvent:!1,perform:(t,e,n)=>({elements:gi(t,e,r=>Re(r,{opacity:n}),!0),appState:{...e,currentItemOpacity:n},commitToHistory:!0}),PanelComponent:({elements:t,appState:e,updateData:n})=>M("label",{className:"control-label",children:[I("labels.opacity"),g("input",{type:"range",min:"0",max:"100",step:"10",onChange:r=>n(+r.target.value),value:qr(t,e,r=>r.opacity,!0,e.currentItemOpacity)??void 0})]})});ue({name:"changeFontSize",trackEvent:!1,perform:(t,e,n)=>BS(t,e,()=>n,n),PanelComponent:({elements:t,appState:e,updateData:n})=>M("fieldset",{children:[g("legend",{children:I("labels.fontSize")}),g(da,{group:"font-size",options:[{value:16,text:I("labels.small"),icon:bte,testId:"fontSize-small"},{value:20,text:I("labels.medium"),icon:_te,testId:"fontSize-medium"},{value:28,text:I("labels.large"),icon:Ete,testId:"fontSize-large"},{value:36,text:I("labels.veryLarge"),icon:wte,testId:"fontSize-veryLarge"}],value:qr(t,e,r=>{if(Se(r))return r.fontSize;const i=tt(r);return i?i.fontSize:null},r=>Se(r)||tt(r)!==null,r=>r?null:e.currentItemFontSize||_s),onChange:r=>n(r)})]})});const bA=ue({name:"decreaseFontSize",trackEvent:!1,perform:(t,e,n)=>BS(t,e,r=>Math.round(1/(1+oN)*r.fontSize)),keyTest:t=>t[z.CTRL_OR_CMD]&&t.shiftKey&&(t.key===z.CHEVRON_LEFT||t.key===z.COMMA)}),_A=ue({name:"increaseFontSize",trackEvent:!1,perform:(t,e,n)=>BS(t,e,r=>Math.round(r.fontSize*(1+oN))),keyTest:t=>t[z.CTRL_OR_CMD]&&t.shiftKey&&(t.key===z.CHEVRON_RIGHT||t.key===z.PERIOD)});ue({name:"changeFontFamily",trackEvent:!1,perform:(t,e,n)=>({elements:gi(t,e,r=>{if(Se(r)){const i=Re(r,{fontFamily:n,lineHeight:Kc(n)});return go(i,Dn(r)),i}return r},!0),appState:{...e,currentItemFontFamily:n},commitToHistory:!0}),PanelComponent:({elements:t,appState:e,updateData:n})=>{const r=[{value:mr.Virgil,text:I("labels.handDrawn"),icon:pS,testId:"font-family-virgil"},{value:mr.Helvetica,text:I("labels.normal"),icon:xte,testId:"font-family-normal"},{value:mr.Cascadia,text:I("labels.code"),icon:Tte,testId:"font-family-code"}];return M("fieldset",{children:[g("legend",{children:I("labels.fontFamily")}),g(da,{group:"font-family",options:r,value:qr(t,e,i=>{if(Se(i))return i.fontFamily;const s=tt(i);return s?s.fontFamily:null},i=>Se(i)||tt(i)!==null,i=>i?null:e.currentItemFontFamily||ca),onChange:i=>n(i)})]})}});ue({name:"changeTextAlign",trackEvent:!1,perform:(t,e,n)=>({elements:gi(t,e,r=>{if(Se(r)){const i=Re(r,{textAlign:n});return go(i,Dn(r)),i}return r},!0),appState:{...e,currentItemTextAlign:n},commitToHistory:!0}),PanelComponent:({elements:t,appState:e,updateData:n})=>M("fieldset",{children:[g("legend",{children:I("labels.textAlign")}),g(da,{group:"text-align",options:[{value:"left",text:I("labels.left"),icon:Ste,testId:"align-left"},{value:"center",text:I("labels.center"),icon:Cte,testId:"align-horizontal-center"},{value:"right",text:I("labels.right"),icon:Ite,testId:"align-right"}],value:qr(t,e,r=>{if(Se(r))return r.textAlign;const i=tt(r);return i?i.textAlign:null},r=>Se(r)||tt(r)!==null,r=>r?null:e.currentItemTextAlign),onChange:r=>n(r)})]})});ue({name:"changeVerticalAlign",trackEvent:{category:"element"},perform:(t,e,n)=>({elements:gi(t,e,r=>{if(Se(r)){const i=Re(r,{verticalAlign:n});return go(i,Dn(r)),i}return r},!0),appState:{...e},commitToHistory:!0}),PanelComponent:({elements:t,appState:e,updateData:n})=>g("fieldset",{children:g(da,{group:"text-align",options:[{value:ai.TOP,text:I("labels.alignTop"),icon:g(Ate,{theme:e.theme}),testId:"align-top"},{value:ai.MIDDLE,text:I("labels.centerVertically"),icon:g(Mte,{theme:e.theme}),testId:"align-middle"},{value:ai.BOTTOM,text:I("labels.alignBottom"),icon:g(kte,{theme:e.theme}),testId:"align-bottom"}],value:qr(t,e,r=>{if(Se(r)&&r.containerId)return r.verticalAlign;const i=tt(r);return i?i.verticalAlign:null},r=>Se(r)||tt(r)!==null,r=>r?null:ai.MIDDLE),onChange:r=>n(r)})})});ue({name:"changeRoundness",trackEvent:!1,perform:(t,e,n)=>({elements:gi(t,e,r=>Re(r,{roundness:n==="round"?{type:dh(r.type)?jn.ADAPTIVE_RADIUS:jn.PROPORTIONAL_RADIUS}:null})),appState:{...e,currentItemRoundness:n},commitToHistory:!0}),PanelComponent:({elements:t,appState:e,updateData:n})=>{const i=d4(yt(t),e).some(s=>{var o;return((o=s.roundness)==null?void 0:o.type)===jn.LEGACY});return M("fieldset",{children:[g("legend",{children:I("labels.edges")}),g(da,{group:"edges",options:[{value:"sharp",text:I("labels.sharp"),icon:cte},{value:"round",text:I("labels.round"),icon:ute}],value:qr(t,e,s=>i?null:s.roundness?"round":"sharp",s=>s.hasOwnProperty("roundness"),s=>s?null:e.currentItemRoundness),onChange:s=>n(s)})]})}});const EA=t=>[{value:null,text:I("labels.arrowhead_none"),keyBinding:"q",icon:dte},{value:"arrow",text:I("labels.arrowhead_arrow"),keyBinding:"w",icon:g(hte,{flip:t})},{value:"bar",text:I("labels.arrowhead_bar"),keyBinding:"e",icon:g(pte,{flip:t})},{value:"dot",text:I("labels.arrowhead_circle"),keyBinding:null,icon:g(PI,{flip:t}),showInPicker:!1},{value:"circle",text:I("labels.arrowhead_circle"),keyBinding:"r",icon:g(PI,{flip:t}),showInPicker:!1},{value:"circle_outline",text:I("labels.arrowhead_circle_outline"),keyBinding:null,icon:g(fte,{flip:t}),showInPicker:!1},{value:"triangle",text:I("labels.arrowhead_triangle"),icon:g(mte,{flip:t}),keyBinding:"t"},{value:"triangle_outline",text:I("labels.arrowhead_triangle_outline"),icon:g(gte,{flip:t}),keyBinding:null,showInPicker:!1},{value:"diamond",text:I("labels.arrowhead_diamond"),icon:g(yte,{flip:t}),keyBinding:null,showInPicker:!1},{value:"diamond_outline",text:I("labels.arrowhead_diamond_outline"),icon:g(vte,{flip:t}),keyBinding:null,showInPicker:!1}];ue({name:"changeArrowhead",trackEvent:!1,perform:(t,e,n)=>({elements:gi(t,e,r=>{if(Je(r)){const{position:i,type:s}=n;if(i==="start")return Re(r,{startArrowhead:s});if(i==="end")return Re(r,{endArrowhead:s})}return r}),appState:{...e,[n.position==="start"?"currentItemStartArrowhead":"currentItemEndArrowhead"]:n.type},commitToHistory:!0}),PanelComponent:({elements:t,appState:e,updateData:n})=>{const r=km().rtl;return M("fieldset",{children:[g("legend",{children:I("labels.arrowheads")}),M("div",{className:"iconSelectList buttonList",children:[g(gA,{label:"arrowhead_start",options:EA(!r),value:qr(t,e,i=>Je(i)&&ky(i.type)?i.startArrowhead:e.currentItemStartArrowhead,!0,e.currentItemStartArrowhead),onChange:i=>n({position:"start",type:i})}),g(gA,{label:"arrowhead_end",group:"arrowheads",options:EA(!!r),value:qr(t,e,i=>Je(i)&&ky(i.type)?i.endArrowhead:e.currentItemEndArrowhead,!0,e.currentItemEndArrowhead),onChange:i=>n({position:"end",type:i})})]})]})}});const jse=(t,e)=>{const[n,r,i,s]=e,{x:o,y:a}=li({sceneX:n,sceneY:r},t),{x:l,y:c}=li({sceneX:i,sceneY:s},t);return l-o>t.width||c-a>t.height},aN=({scenePoint:t,viewportDimensions:e,zoom:n})=>({scrollX:e.width/2/n.value-t.x,scrollY:e.height/2/n.value-t.y}),nm=(t,e)=>{if(t=Fde(t),!t.length)return{scrollX:0,scrollY:0};let[n,r,i,s]=Ut(t);jse(e,[n,r,i,s])&&([n,r,i,s]=Yoe(t,Ft({clientX:e.scrollX,clientY:e.scrollY},e)));const o=(n+i)/2,a=(r+s)/2;return aN({scenePoint:{x:o,y:a},viewportDimensions:{width:e.width,height:e.height},zoom:e.zoom})},vc=t=>Math.max(y7,Math.min(t,30)),bc=({viewportX:t,viewportY:e,nextZoom:n},r)=>{const i=t-r.offsetLeft,s=e-r.offsetTop,o=r.zoom.value,a=r.scrollX+(i-i/o),l=r.scrollY+(s-s/o),c=-(i-i/n),u=-(s-s/n);return{scrollX:a+c,scrollY:l+u,zoom:{value:n}}};ue({name:"changeViewBackgroundColor",trackEvent:!1,predicate:(t,e,n,r)=>!!r.props.UIOptions.canvasActions.changeViewBackgroundColor&&!e.viewModeEnabled,perform:(t,e,n)=>({appState:{...e,...n},commitToHistory:!!n.viewBackgroundColor}),PanelComponent:({elements:t,appState:e,updateData:n,appProps:r})=>g(FS,{palette:null,topPicks:d7,label:I("labels.canvasBackground"),type:"canvasBackground",color:e.viewBackgroundColor,onChange:i=>n({viewBackgroundColor:i}),"data-testid":"canvas-background-picker",elements:t,appState:e,updateData:n})});const lN=ue({name:"clearCanvas",trackEvent:{category:"canvas"},predicate:(t,e,n,r)=>!!r.props.UIOptions.canvasActions.clearCanvas&&!e.viewModeEnabled,perform:(t,e,n,r)=>(r.imageCache.clear(),{elements:t.map(i=>Re(i,{isDeleted:!0})),appState:{...Es(),files:{},theme:e.theme,penMode:e.penMode,penDetected:e.penDetected,exportBackground:e.exportBackground,exportEmbedScene:e.exportEmbedScene,gridSize:e.gridSize,showStats:e.showStats,pasteDialog:e.pasteDialog,activeTool:e.activeTool.type==="image"?{...e.activeTool,type:"selection"}:e.activeTool},commitToHistory:!0})}),wA=ue({name:"zoomIn",viewMode:!0,trackEvent:{category:"canvas"},perform:(t,e,n,r)=>({appState:{...e,...bc({viewportX:e.width/2+e.offsetLeft,viewportY:e.height/2+e.offsetTop,nextZoom:vc(e.zoom.value+Op)},e),userToFollow:null},commitToHistory:!1}),PanelComponent:({updateData:t})=>g(st,{type:"button",className:"zoom-in-button zoom-button",icon:pee,title:`${I("buttons.zoomIn")} — ${re("CtrlOrCmd++")}`,"aria-label":I("buttons.zoomIn"),onClick:()=>{t(null)}}),keyTest:t=>(t.code===ht.EQUAL||t.code===ht.NUM_ADD)&&(t[z.CTRL_OR_CMD]||t.shiftKey)}),xA=ue({name:"zoomOut",viewMode:!0,trackEvent:{category:"canvas"},perform:(t,e,n,r)=>({appState:{...e,...bc({viewportX:e.width/2+e.offsetLeft,viewportY:e.height/2+e.offsetTop,nextZoom:vc(e.zoom.value-Op)},e),userToFollow:null},commitToHistory:!1}),PanelComponent:({updateData:t})=>g(st,{type:"button",className:"zoom-out-button zoom-button",icon:mee,title:`${I("buttons.zoomOut")} — ${re("CtrlOrCmd+-")}`,"aria-label":I("buttons.zoomOut"),onClick:()=>{t(null)}}),keyTest:t=>(t.code===ht.MINUS||t.code===ht.NUM_SUBTRACT)&&(t[z.CTRL_OR_CMD]||t.shiftKey)});ue({name:"resetZoom",viewMode:!0,trackEvent:{category:"canvas"},perform:(t,e,n,r)=>({appState:{...e,...bc({viewportX:e.width/2+e.offsetLeft,viewportY:e.height/2+e.offsetTop,nextZoom:vc(1)},e),userToFollow:null},commitToHistory:!1}),PanelComponent:({updateData:t,appState:e})=>g(El,{label:I("buttons.resetZoom"),style:{height:"100%"},children:M(st,{type:"button",className:"reset-zoom-button zoom-button",title:I("buttons.resetZoom"),"aria-label":I("buttons.resetZoom"),onClick:()=>{t(null)},children:[(e.zoom.value*100).toFixed(0),"%"]})}),keyTest:t=>(t.code===ht.ZERO||t.code===ht.NUM_ZERO)&&(t[z.CTRL_OR_CMD]||t.shiftKey)});const Xse=(t,e)=>{const[n,r,i,s]=t,o=i-n,a=e.width/o,l=s-r,c=e.height/l,u=Math.min(a,c),d=Math.floor(u/Op)*Op;return Math.min(Math.max(d,y7),1)},cN=({bounds:t,appState:e,fitToViewport:n=!1,viewportZoomFactor:r=.7})=>{const[i,s,o,a]=t,l=(i+o)/2,c=(s+a)/2;let u,d,h;if(n){const f=o-i,p=a-s;u=Math.min(e.width/f,e.height/p)*Math.min(1,Math.max(r,.1)),u=Math.min(Math.max(u,.1),30);let m=e.width;if(e.openSidebar){const v=document.querySelector(".sidebar"),y=(v==null?void 0:v.offsetWidth)??0;m=document.documentElement.getAttribute("dir")==="rtl"?e.width+y:e.width-y}d=m/2*(1/u)-l,h=e.height/2*(1/u)-c}else{u=Xse(t,{width:e.width,height:e.height});const f=aN({scenePoint:{x:l,y:c},viewportDimensions:{width:e.width,height:e.height},zoom:{value:u}});d=f.scrollX,h=f.scrollY}return{appState:{...e,scrollX:d,scrollY:h,zoom:{value:u}},commitToHistory:!1}},a2=({targetElements:t,appState:e,fitToViewport:n,viewportZoomFactor:r})=>{const i=Ut(yt(t));return cN({bounds:i,appState:e,fitToViewport:n,viewportZoomFactor:r})};ue({name:"zoomToFitSelectionInViewport",trackEvent:{category:"canvas"},perform:(t,e,n,r)=>{const i=r.scene.getSelectedElements(e);return a2({targetElements:i.length?i:t,appState:{...e,userToFollow:null},fitToViewport:!1})},keyTest:t=>t.code===ht.TWO&&t.shiftKey&&!t.altKey&&!t[z.CTRL_OR_CMD]});ue({name:"zoomToFitSelection",trackEvent:{category:"canvas"},perform:(t,e,n,r)=>{const i=r.scene.getSelectedElements(e);return a2({targetElements:i.length?i:t,appState:{...e,userToFollow:null},fitToViewport:!0})},keyTest:t=>t.code===ht.THREE&&t.shiftKey&&!t.altKey&&!t[z.CTRL_OR_CMD]});ue({name:"zoomToFit",viewMode:!0,trackEvent:{category:"canvas"},perform:(t,e)=>a2({targetElements:t,appState:{...e,userToFollow:null},fitToViewport:!1}),keyTest:t=>t.code===ht.ONE&&t.shiftKey&&!t.altKey&&!t[z.CTRL_OR_CMD]});const TA=ue({name:"toggleTheme",viewMode:!0,trackEvent:{category:"canvas"},perform:(t,e,n)=>({appState:{...e,theme:n||(e.theme===Vn.LIGHT?Vn.DARK:Vn.LIGHT)},commitToHistory:!1}),keyTest:t=>t.altKey&&t.shiftKey&&t.code===ht.D,predicate:(t,e,n,r)=>!!r.props.UIOptions.canvasActions.toggleTheme});ue({name:"toggleEraserTool",trackEvent:{category:"toolbar"},perform:(t,e)=>{let n;return pc(e)?n=kn(e,{...e.activeTool.lastActiveTool||{type:"selection"},lastActiveToolBeforeEraser:null}):n=kn(e,{type:"eraser",lastActiveToolBeforeEraser:e.activeTool}),{appState:{...e,selectedElementIds:{},selectedGroupIds:{},activeEmbeddable:null,activeTool:n},commitToHistory:!0}},keyTest:t=>t.key===z.E});const Yse=ue({name:"toggleHandTool",trackEvent:{category:"toolbar"},perform:(t,e,n,r)=>{let i;return Gd(e)?i=kn(e,{...e.activeTool.lastActiveTool||{type:"selection"},lastActiveToolBeforeEraser:null}):(i=kn(e,{type:"hand",lastActiveToolBeforeEraser:e.activeTool}),Et(r.interactiveCanvas,vt.GRAB)),{appState:{...e,selectedElementIds:{},selectedGroupIds:{},activeEmbeddable:null,activeTool:i},commitToHistory:!0}},keyTest:t=>!t.altKey&&!t[z.CTRL_OR_CMD]&&t.key===z.H}),is=32,Tt=12,al=256,uN=50,oc="NOT_SPREADSHEET",rm="VALID_SPREADSHEET",If=t=>{const e=/^([-+]?)[$€£¥₩]?([-+]?)([\d.,]+)[%]?$/.exec(t);return e?parseFloat(`${(e[1]||e[2])+e[3]}`.replace(/,/g,"")):null},y_=(t,e)=>t.slice(1).every(n=>If(n[e])!==null),SA=t=>{const e=t[0].length;if(e>2)return{type:oc,reason:"More than 2 columns"};if(e===1){if(!y_(t,0))return{type:oc,reason:"Value is not numeric"};const l=If(t[0][0])===null,c=(l?t.slice(1):t).map(u=>If(u[0]));return c.length<2?{type:oc,reason:"Less than two rows"}:{type:rm,spreadsheet:{title:l?t[0][0]:null,labels:null,values:c}}}const n=y_(t,0),r=y_(t,1);if(!n&&!r)return{type:oc,reason:"Value is not numeric"};const[i,s]=r?[0,1]:[1,0],o=If(t[0][s])===null,a=o?t.slice(1):t;return a.length<2?{type:oc,reason:"Less than 2 rows"}:{type:rm,spreadsheet:{title:o?t[0][s]:null,labels:a.map(l=>l[i]),values:a.map(l=>If(l[s]))}}},Zse=t=>{const e=[];for(let n=0;n<t[0].length;n++){const r=[];for(let i=0;i<t.length;i++)r.push(t[i][n]);e.push(r)}return e},Kse=t=>{let e=t.trim().split(`
`).map(s=>s.trim().split("	"));if(e.length&&e[0].length!==2&&(e=t.trim().split(`
`).map(s=>s.trim().split(","))),e.length===0)return{type:oc,reason:"No values"};const n=e[0].length;if(!e.every(s=>s.length===n))return{type:oc,reason:"All rows don't have same number of columns"};const i=SA(e);if(i.type!==rm){const s=SA(Zse(e));if(s.type===rm)return s}return i},My=_V(yV),Mi={fillStyle:"hachure",fontFamily:ca,fontSize:_s,opacity:100,roughness:1,strokeColor:Ge.black,roundness:null,strokeStyle:"solid",strokeWidth:1,verticalAlign:ai.MIDDLE,locked:!1},dN=t=>{const e=(is+Tt)*t.values.length+Tt,n=al+Tt*2;return{chartWidth:e,chartHeight:n}},qse=(t,e,n,r,i)=>{var s;return((s=t.labels)==null?void 0:s.map((o,a)=>Ni({groupIds:[r],backgroundColor:i,...Mi,text:o.length>8?`${o.slice(0,5)}...`:o,x:e+a*(is+Tt)+Tt*2,y:n+Tt/2,width:is,angle:5.87,fontSize:16,textAlign:"center",verticalAlign:"top"})))||[]},Jse=(t,e,n,r,i)=>{const s=Ni({groupIds:[r],backgroundColor:i,...Mi,x:e-Tt,y:n-Tt,text:"0",textAlign:"right"}),o=Ni({groupIds:[r],backgroundColor:i,...Mi,x:e-Tt,y:n-al-s.height/2,text:Math.max(...t.values).toLocaleString(),textAlign:"right"});return[s,o]},Qse=(t,e,n,r,i)=>{const{chartWidth:s,chartHeight:o}=dN(t),a=sl({backgroundColor:i,groupIds:[r],...Mi,type:"line",x:e,y:n,startArrowhead:null,endArrowhead:null,width:s,points:[[0,0],[s,0]]}),l=sl({backgroundColor:i,groupIds:[r],...Mi,type:"line",x:e,y:n,startArrowhead:null,endArrowhead:null,height:o,points:[[0,0],[0,-o]]}),c=sl({backgroundColor:i,groupIds:[r],...Mi,type:"line",x:e,y:n-al-Tt,startArrowhead:null,endArrowhead:null,strokeStyle:"dotted",width:s,opacity:uN,points:[[0,0],[s,0]]});return[a,l,c]},hN=(t,e,n,r,i,s)=>{const{chartWidth:o,chartHeight:a}=dN(t),l=t.title?Ni({backgroundColor:i,groupIds:[r],...Mi,text:t.title,x:e+o/2,y:n-al-Tt*2-_s,roundness:null,textAlign:"center"}):null,c=s?bl({backgroundColor:i,groupIds:[r],...Mi,type:"rectangle",x:e,y:n-a,width:o,height:a,strokeColor:Ge.black,fillStyle:"solid",opacity:6}):null;return[...c?[c]:[],...l?[l]:[],...qse(t,e,n,r,i),...Jse(t,e,n,r,i),...Qse(t,e,n,r,i)]},eoe=(t,e,n)=>{const r=Math.max(...t.values),i=Di(),s=My[Math.floor(Math.random()*My.length)];return[...t.values.map((a,l)=>{const c=a/r*al;return bl({backgroundColor:s,groupIds:[i],...Mi,type:"rectangle",x:e+l*(is+Tt)+Tt,y:n-c-Tt,width:is,height:c})}),...hN(t,e,n,i,s,!1)]},toe=(t,e,n)=>{const r=Math.max(...t.values),i=Di(),s=My[Math.floor(Math.random()*My.length)];let o=0;const a=[];for(const m of t.values){const v=o*(is+Tt),y=-(m/r)*al;a.push([v,y]),o++}const l=Math.max(...a.map(m=>m[0])),c=Math.max(...a.map(m=>m[1])),u=Math.min(...a.map(m=>m[0])),d=Math.min(...a.map(m=>m[1])),h=sl({backgroundColor:s,groupIds:[i],...Mi,type:"line",x:e+Tt+is/2,y:n-Tt,startArrowhead:null,endArrowhead:null,height:c-d,width:l-u,strokeWidth:2,points:a}),f=t.values.map((m,v)=>{const y=v*(is+Tt)+Tt/2,b=-(m/r)*al+Tt/2;return bl({backgroundColor:s,groupIds:[i],...Mi,fillStyle:"solid",strokeWidth:2,type:"ellipse",x:e+y+is/2,y:n+b-Tt*2,width:Tt,height:Tt})}),p=t.values.map((m,v)=>{const y=v*(is+Tt)+Tt/2,b=m/r*al+Tt/2+Tt;return sl({backgroundColor:s,groupIds:[i],...Mi,type:"line",x:e+y+is/2+Tt/2,y:n-b,startArrowhead:null,endArrowhead:null,height:b,strokeStyle:"dotted",opacity:uN,points:[[0,0],[0,b]]})});return[...hN(t,e,n,i,s,!1),h,...p,...f]},noe=(t,e,n,r)=>t==="line"?toe(e,n,r):eoe(e,n,r),US="clipboard"in navigator&&"writeText"in navigator.clipboard,$S="clipboard"in navigator&&"write"in navigator.clipboard&&"ClipboardItem"in window&&"toBlob"in HTMLCanvasElement.prototype,roe=t=>!!([ki.excalidraw,ki.excalidrawClipboard,ki.excalidrawClipboardWithAPI].includes(t==null?void 0:t.type)&&Array.isArray(t.elements)),ioe=({types:t,files:e})=>{var r,i,s,o;!t&&!e&&console.warn("createPasteEvent: no types or files provided");const n=new ClipboardEvent("paste",{clipboardData:new DataTransfer});if(t)for(const[a,l]of Object.entries(t))try{if((r=n.clipboardData)==null||r.setData(a,l),((i=n.clipboardData)==null?void 0:i.getData(a))!==l)throw new Error(`Failed to set "${a}" as clipboardData item`)}catch(c){throw new Error(c.message)}if(e){let a=-1;for(const l of e){a++;try{if((s=n.clipboardData)==null||s.items.add(l),((o=n.clipboardData)==null?void 0:o.files[a])!==l)throw new Error(`Failed to set file "${l.name}" as clipboardData item`)}catch(c){throw new Error(c.message)}}}return n},soe=({elements:t,files:e})=>{const n=new Set(t.filter(o=>qe(o)));let r=!1;const i=t.reduce((o,a)=>(En(a)&&(r=!0,e&&e[a.fileId]&&(o[a.fileId]=e[a.fileId])),o),{});r&&!e&&console.warn("copyToClipboard: attempting to file element(s) without providing associated `files` object.");const s={type:ki.excalidrawClipboard,elements:t.map(o=>{if(Bi(o)&&!n.has(Bi(o))){const a=Hm(o);return ae(a,{frameId:null}),a}return o}),files:e?i:void 0};return JSON.stringify(s)},ooe=async(t,e,n)=>{await fu(soe({elements:t,files:e}),n)},aoe=t=>{const e=Kse(t);return e.type===rm?{spreadsheet:e.spreadsheet}:null};function fN(t){var n;let e=[];for(const r of t.childNodes)if(r.nodeType===3){const i=(n=r.textContent)==null?void 0:n.trim();i&&e.push({type:"text",value:i})}else if(r instanceof HTMLImageElement){const i=r.getAttribute("src");i&&i.startsWith("http")&&e.push({type:"imageUrl",value:i})}else e=e.concat(fN(r));return e}const loe=t=>{var n;const e=(n=t.clipboardData)==null?void 0:n.getData("text/html");if(!e)return null;try{const r=new DOMParser().parseFromString(e,"text/html"),i=fN(r.body);if(i.length)return{type:"mixedContent",value:i}}catch(r){console.error(`error in parseHTMLFromPaste: ${r.message}`)}return null},coe=async()=>{var n,r,i,s;const t={};try{if((n=navigator.clipboard)!=null&&n.readText)return{"text/plain":await((r=navigator.clipboard)==null?void 0:r.readText())}}catch(o){if((i=navigator.clipboard)!=null&&i.read)console.warn(`navigator.clipboard.readText() failed (${o.message}). Failling back to navigator.clipboard.read()`);else throw o}let e;try{e=await((s=navigator.clipboard)==null?void 0:s.read())}catch(o){if(o.name==="DataError")return console.warn(`navigator.clipboard.read() error, clipboard is probably empty: ${o.message}`),t;throw o}for(const o of e)for(const a of o.types)if(yw(AV,a))try{t[a]=await(await o.getType(a)).text()}catch(l){console.warn(`Cannot retrieve ${a} from clipboardItem: ${l.message}`)}return Object.keys(t).length===0&&console.warn("No clipboard data found from clipboard.read()."),t},uoe=async(t,e=!1)=>{var n,r;try{const i=!e&&t&&loe(t);return i?i.value.every(o=>o.type==="text")?{type:"text",value:((n=t.clipboardData)==null?void 0:n.getData("text/plain"))||i.value.map(o=>o.value).join(`
`).trim()}:i:{type:"text",value:(((r=t.clipboardData)==null?void 0:r.getData("text/plain"))||"").trim()}}catch{return{type:"text",value:""}}},pN=async(t,e=!1)=>{const n=await uoe(t,e);if(n.type==="mixedContent")return{mixedContent:n.value};try{const r=!e&&aoe(n.value);if(r)return r}catch(r){console.error(r)}try{const r=JSON.parse(n.value),i=r.type===ki.excalidrawClipboardWithAPI;if(roe(r))return{elements:r.elements,files:r.files,text:e?JSON.stringify(r.elements,null,2):void 0,programmaticAPI:i}}catch{}return{text:n.value}},doe=async t=>{try{await navigator.clipboard.write([new window.ClipboardItem({[Oe.png]:t})])}catch(e){if(pR(t))await navigator.clipboard.write([new window.ClipboardItem({[Oe.png]:await t})]);else throw e}},fu=async(t,e)=>{var n,r;if(US)try{await navigator.clipboard.writeText(t||"");return}catch(i){console.error(i)}try{if(e){if((n=e.clipboardData)==null||n.setData("text/plain",t||""),((r=e.clipboardData)==null?void 0:r.getData("text/plain"))!==t)throw new Error("Failed to setData on clipboardEvent");return}}catch(i){console.error(i)}if(!hoe(t))throw new Error(I("errors.copyToSystemClipboardFailed"))},hoe=t=>{t||(t=" ");const e=document.documentElement.getAttribute("dir")==="rtl",n=document.createElement("textarea");n.style.border="0",n.style.padding="0",n.style.margin="0",n.style.position="absolute",n.style[e?"right":"left"]="-9999px";const r=window.pageYOffset||document.documentElement.scrollTop;n.style.top=`${r}px`,n.style.fontSize="12pt",n.setAttribute("readonly",""),n.value=t,document.body.appendChild(n);let i=!1;try{n.select(),n.setSelectionRange(0,n.value.length),i=document.execCommand("copy")}catch(s){console.error(s)}return n.remove(),i},foe=(t,e,n,r,i,s)=>{const{zoom:o}=r,a=180*n/Math.PI;let l=t*(o.value-1)/2,c=e*(o.value-1)/2;return t>i&&o.value!==1&&(l=i*(o.value-1)/2),e>s&&o.value!==1&&(c=s*(o.value-1)/2),`translate(${l}px, ${c}px) scale(${o.value}) rotate(${a}deg)`},Zd={},Py=(t,e)=>{const n=Zd[t]||(Zd[t]={height:e});return n.height=e,n},mN=t=>{Zd[t]&&delete Zd[t]},poe=t=>{var e;return((e=Zd[t])==null?void 0:e.height)??null},moe=({id:t,onChange:e,onSubmit:n,getViewportCoords:r,element:i,canvas:s,excalidrawContainer:o,app:a})=>{const l=(N,R)=>{if(!R.style.fontFamily||!R.style.fontSize)return!1;const H=R.style.fontFamily.replace(/"/g,"");return BT({fontFamily:N.fontFamily})!==H||`${N.fontSize}px`!==R.style.fontSize},c=()=>{var q;const N=a.state,R=(q=bt.getScene(i))==null?void 0:q.getElement(t);if(!R)return;const{textAlign:H,verticalAlign:W}=R;if(R&&Se(R)){let Z=R.x,j=R.y;const K=Dn(R);let $=R.width,B=R.height,G=R.width;const Y=R.height;if(K&&R.containerId){if(Ct(K)){const Xe=Ae.getBoundTextElementPosition(K,R);Z=Xe.x,j=Xe.y}const fe=l(R,u);let ke;if(fe?ke=Py(K.id,K.height):(ke=Zd[K.id],ke||(ke=Py(K.id,K.height))),$=mo(K),B=yh(K,R),!Ct(K)&&Y>B){const Xe=Zc(Y,K.type);ae(K,{height:Xe});return}else if(!Ct(K)&&K.height>ke.height&&Y<B){const Xe=Zc(Y,K.type);ae(K,{height:Xe})}else{const{y:Xe}=c2(K,R);j=Xe}}const[X,J]=r(Z,j),ne=u.selectionStart,se=u.selectionEnd,Ue=u.value.length;if(ne===se&&se!==Ue){const fe=Ue-se;u.selectionStart=u.value.length-fe,u.selectionEnd=u.value.length-fe}K?G+=.5:($=(N.width-8-X)/N.zoom.value,G=Math.min(G,$));let De=R.lineHeight;p7&&(De=vN({...R,fontSize:Math.round(R.fontSize)}));const Le=(N.height-J)/N.zoom.value;Object.assign(u.style,{font:mn(R),lineHeight:De,width:`${G}px`,height:`${Y}px`,left:`${X}px`,top:`${J}px`,transform:foe(G,Y,voe(R),N,$,Le),textAlign:H,verticalAlign:W,color:R.strokeColor,opacity:R.opacity/100,filter:"var(--theme-filter)",maxHeight:`${Le}px`}),u.scrollTop=0,ae(R,{x:Z,y:j})}},u=document.createElement("textarea");u.dir="auto",u.tabIndex=0,u.dataset.type="wysiwyg",u.wrap="off",u.classList.add("excalidraw-wysiwyg");let d="pre",h="normal";nn(i)&&(d="pre-wrap",h="break-word"),Object.assign(u.style,{position:"absolute",display:"inline-block",minHeight:"1em",backfaceVisibility:"hidden",margin:0,padding:0,border:0,outline:0,resize:"none",background:"transparent",overflow:"hidden",zIndex:"var(--zIndex-wysiwyg)",wordBreak:h,whiteSpace:d,overflowWrap:"break-word",boxSizing:"content-box"}),u.value=i.originalText,c(),e&&(u.onpaste=async N=>{const R=await pN(N,!0);if(!R.text)return;const H=im(R.text);if(!H)return;const W=Dn(i),q=mn({fontSize:a.state.currentItemFontSize,fontFamily:a.state.currentItemFontFamily});if(W){const Z=Xm(`${u.value}${H}`,q,mo(W)),j=u2(Z,q);u.style.width=`${j}px`}},u.oninput=()=>{e(im(u.value))}),u.onkeydown=N=>{if(!N.shiftKey&&wA.keyTest(N))N.preventDefault(),a.actionManager.executeAction(wA),c();else if(!N.shiftKey&&xA.keyTest(N))N.preventDefault(),a.actionManager.executeAction(xA),c();else if(bA.keyTest(N))a.actionManager.executeAction(bA);else if(_A.keyTest(N))a.actionManager.executeAction(_A);else if(N.key===z.ESCAPE)N.preventDefault(),E=!0,w();else if(N.key===z.ENTER&&N[z.CTRL_OR_CMD]){if(N.preventDefault(),N.isComposing||N.keyCode===229)return;E=!0,w()}else if(N.key===z.TAB||N[z.CTRL_OR_CMD]&&(N.code===ht.BRACKET_LEFT||N.code===ht.BRACKET_RIGHT)){if(N.preventDefault(),N.isComposing)return;N.shiftKey||N.code===ht.BRACKET_LEFT?y():v(),u.dispatchEvent(new Event("input"))}};const f=4,p=" ".repeat(f),m=new RegExp(`^ {1,${f}}`),v=()=>{const{selectionStart:N,selectionEnd:R}=u,H=b();let W=u.value;H.forEach(q=>{const Z=W.slice(0,q),j=W.slice(q);W=`${Z}${p}${j}`}),u.value=W,u.selectionStart=N+f,u.selectionEnd=R+f*H.length},y=()=>{const{selectionStart:N,selectionEnd:R}=u,H=b(),W=[];let q=u.value;H.forEach(Z=>{const j=q.slice(Z,Z+f).match(m);if(j){const K=q.slice(0,Z),$=q.slice(Z+j[0].length);q=`${K}${$}`,W.push(Z)}}),u.value=q,W.length&&(N>W[W.length-1]?u.selectionStart=Math.max(N-f,W[W.length-1]):u.selectionStart=N,u.selectionEnd=Math.max(u.selectionStart,R-f*W.length))},b=()=>{let{selectionStart:N,selectionEnd:R,value:H}=u;const W=H.slice(0,N).match(/[^\n]*$/)[0].length;return N=N-W,H.slice(N,R).split(`
`).reduce((Z,j,K,$)=>Z.concat(K?Z[K-1]+$[K-1].length+1:N),[]).reverse()},_=N=>{N.preventDefault(),N.stopPropagation()};let E=!1;const w=()=>{var W,q;x();const N=(W=bt.getScene(i))==null?void 0:W.getElement(i.id);if(!N)return;let R=u.value;const H=Dn(N);if(H){if(R=N.text,u.value.trim()){const Z=Yc(H);!Z||Z!==i.id?ae(H,{boundElements:(H.boundElements||[]).concat({type:"text",id:i.id})}):Ct(H)&&wh(H)}else ae(H,{boundElements:(q=H.boundElements)==null?void 0:q.filter(Z=>!Se(Z))});go(N,H)}n({text:R,viaKeyboard:E,originalText:u.value})},x=()=>{L||(L=!0,u.onblur=null,u.oninput=null,u.onkeydown=null,F&&F.disconnect(),window.removeEventListener("resize",c),window.removeEventListener("wheel",_,!0),window.removeEventListener("pointerdown",C),window.removeEventListener("pointerup",T),window.removeEventListener("blur",w),window.removeEventListener("beforeunload",w),k(),u.remove())},T=N=>{window.removeEventListener("pointerup",T);const R=N==null?void 0:N.target,H=R instanceof HTMLElement&&R.classList.contains("active-color");setTimeout(()=>{if(u.onblur=w,H){const W=(Z,j)=>{Z.find($=>{var B;return $.removedNodes.length>0&&((B=$.removedNodes[0].dataset)==null?void 0:B.radixPopperContentWrapper)!==void 0})&&(setTimeout(()=>{u.focus()}),j.disconnect())};new MutationObserver(W).observe(document.querySelector(".excalidraw-container"),{childList:!0})}H||u.focus()})},C=N=>{const R=N.target instanceof HTMLElement&&N.target.classList.contains("active-color");((N.target instanceof HTMLElement||N.target instanceof SVGElement)&&N.target.closest(`.${m7.SHAPE_ACTIONS_MENU}`)&&!rc(N.target)||R)&&(u.onblur=null,window.addEventListener("pointerup",T),window.addEventListener("blur",w))},k=bt.getScene(i).addCallback(()=>{var R;c(),!!((R=document.activeElement)!=null&&R.closest(".color-picker-content"))||u.focus()});let L=!1;u.select(),T();let F=null;s&&"ResizeObserver"in window?(F=new window.ResizeObserver(()=>{c()}),F.observe(s)):window.addEventListener("resize",c),window.addEventListener("pointerdown",C),window.addEventListener("wheel",_,{passive:!1,capture:!0}),window.addEventListener("beforeunload",w),o==null||o.querySelector(".excalidraw-textEditorContainer").appendChild(u)},im=t=>t.replace(/\t/g,"        ").replace(/\r?\n|\r/g,`
`),HS=t=>im(t).split(`
`),go=(t,e)=>{let n;const r={x:t.x,y:t.y,text:t.text,width:t.width,height:t.height,baseline:t.baseline};r.text=t.text,e&&(n=mo(e,t),r.text=Xm(t.originalText,mn(t),n));const i=ia(r.text,mn(t),t.lineHeight);if(r.width=i.width,r.height=i.height,r.baseline=i.baseline,e){const s=yh(e,t),o=mo(e);if(!Ct(e)&&i.height>s){const u=Zc(i.height,e.type);ae(e,{height:u}),Py(e.id,u)}if(i.width>o){const u=Zc(i.width,e.type);ae(e,{width:u})}const a={...t,...r},{x:l,y:c}=c2(e,a);r.x=l,r.y=c}ae(t,r)},gN=(t,e,n)=>{const r=xn(t);e.forEach(i=>{const s=n.get(i.id),o=Yc(i);if(o){const a=n.get(o);if(a){const l=r.get(s);l&&ae(l,{boundElements:(i.boundElements||[]).filter(u=>u.id!==a&&u.id!==o).concat({type:"text",id:a})});const c=r.get(a);c&&Se(c)&&ae(c,{containerId:l?s:null})}}})},l2=(t,e,n=!1)=>{const r=Yc(t);if(!r)return;mN(t.id);let i=bt.getScene(t).getElement(r);if(i&&i.text){if(!t)return;i=bt.getScene(t).getElement(r);let s=i.text,o=i.height,a=i.width;const l=mo(t),c=yh(t,i);let u=t.height,d=i.baseline;if(n||e!=="n"&&e!=="s"){s&&(s=Xm(i.originalText,mn(i),l));const h=ia(s,mn(i),i.lineHeight);o=h.height,a=h.width,d=h.baseline}if(o>c){u=Zc(o,t.type);const h=u-t.height,f=!Ct(t)&&(e==="ne"||e==="nw"||e==="n")?t.y-h:t.y;ae(t,{height:u,y:f})}ae(i,{text:s,width:a,height:o,baseline:d}),Ct(t)||ae(i,c2(t,i))}},c2=(t,e)=>{if(Ct(t))return Ae.getBoundTextElementPosition(t,e);const n=xN(t),r=yh(t,e),i=mo(t);let s,o;return e.verticalAlign===ai.TOP?o=n.y:e.verticalAlign===ai.BOTTOM?o=n.y+(r-e.height):o=n.y+(r/2-e.height/2),e.textAlign===Dp.LEFT?s=n.x:e.textAlign===Dp.RIGHT?s=n.x+(i-e.width):s=n.x+(i/2-e.width/2),{x:s,y:o}},ia=(t,e,n)=>{t=t.split(`
`).map(a=>a||" ").join(`
`);const r=parseFloat(e),i=Hx(t,r,n),s=u2(t,e),o=yN(t,e,n);return{width:s,height:i,baseline:o}},yN=(t,e,n,r)=>{const i=document.createElement("div");i.style.position="absolute",i.style.whiteSpace="pre",i.style.font=e,i.style.minHeight="1em",r&&(i.style.overflow="hidden",i.style.wordBreak="break-word",i.style.whiteSpace="pre-wrap"),i.style.lineHeight=String(n),i.innerText=t,document.body.appendChild(i);const s=document.createElement("span");s.style.display="inline-block",s.style.overflow="hidden",s.style.width="1px",s.style.height="1px",i.appendChild(s);let o=s.offsetTop+s.offsetHeight;const a=i.offsetHeight;if(p7){const l=Hx(t,parseFloat(e),n),c=parseFloat(e),u=Hx(t,Math.round(c),n);l>a&&(o+=l-u),a>l&&(o-=u-l)}return document.body.removeChild(i),o},vN=t=>{const e=HS(t.text).length;return t.height/e/t.fontSize},jm=(t,e)=>t*e,bN=(t,e)=>jm(t,e)+Ln*2;let v_;const Qf=(t,e)=>{v_||(v_=document.createElement("canvas"));const n=v_.getContext("2d");return n.font=e,n.measureText(t).width},u2=(t,e)=>{const n=HS(t);let r=0;return n.forEach(i=>{r=Math.max(r,Qf(i,e))}),r},Hx=(t,e,n)=>{const r=HS(t).length;return jm(e,n)*r},goe=t=>{const e=t.split("-");return e.length>1&&e.forEach((n,r)=>{r!==e.length-1&&(e[r]=n+="-")}),e.join(" ").split(" ")},Xm=(t,e,n)=>{if(!Number.isFinite(n)||n<0)return t;const r=[],i=t.split(`
`),s=Qf(" ",e);let o="",a=0;const l=u=>{u.trim()&&r.push(u)},c=()=>{o="",a=0};return i.forEach(u=>{if(u2(u,e)<=n){r.push(u);return}const h=goe(u);c();let f=0;for(;f<h.length;){const p=Qf(h[f],e);if(p===n)l(h[f]),f++;else if(p>n){for(l(o),c();h[f].length>0;){const m=String.fromCodePoint(h[f].codePointAt(0)),v=_N.calculate(m,e);a+=v,h[f]=h[f].slice(m.length),a>=n?(l(o),o=m,a=v):o+=m}a+s>=n?(l(o),c()):o.endsWith("-")||(o+=" ",a+=s),f++}else for(;a<n&&f<h.length;){const m=h[f];if(a=Qf(o+m,e),a>n){l(o),c();break}f++;const v=!m.endsWith("-");if(o+=m,v&&(o+=" "),a+s>=n){v?r.push(o.slice(0,-1)):r.push(o),c();break}}}o.slice(-1)===" "&&(o=o.slice(0,-1),l(o))}),r.join(`
`)},_N=(()=>{const t={};return{calculate:(r,i)=>{const s=r.charCodeAt(0);if(t[i]||(t[i]=[]),!t[i][s]){const o=Qf(r,i);t[i][s]=o}return t[i][s]},getCache:r=>t[r]}})(),EN="ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789".toLocaleUpperCase(),wN=(t,e)=>{const n=yoe(t);return n===0?ia(EN.split("").join(`
`),t,e).width+Ln*2:n+Ln*2},yoe=t=>{const e=_N.getCache(t);if(!e)return 0;const n=e.filter(r=>r!==void 0);return Math.max(...n)},Yc=t=>{var e,n,r;return(e=t==null?void 0:t.boundElements)!=null&&e.length&&((r=(n=t==null?void 0:t.boundElements)==null?void 0:n.filter(i=>i.type==="text")[0])==null?void 0:r.id)||null},tt=t=>{var n;if(!t)return null;const e=Yc(t);return e&&((n=bt.getScene(t))==null?void 0:n.getElement(e))||null},Dn=t=>{var e;return t&&t.containerId&&((e=bt.getScene(t))==null?void 0:e.getElement(t.containerId))||null},b_=(t,e)=>{if(!Ct(t))return{x:t.x+t.width/2,y:t.y+t.height/2};const n=Ae.getPointsGlobalCoordinates(t);if(n.length%2===1){const s=Math.floor(t.points.length/2),o=Ae.getPointGlobalCoordinates(t,t.points[s]);return{x:o[0],y:o[1]}}const r=t.points.length/2-1;let i=Ae.getEditorMidPoints(t,e)[r];return i||(i=Ae.getSegmentMidPoint(t,n[r],n[r+1],r+1)),{x:i[0],y:i[1]}},xN=t=>{let e=Ln,n=Ln;return t.type==="ellipse"&&(e+=t.width/2*(1-Math.sqrt(2)/2),n+=t.height/2*(1-Math.sqrt(2)/2)),t.type==="diamond"&&(e+=t.width/4,n+=t.height/4),{x:t.x+e,y:t.y+n}},voe=t=>{const e=Dn(t);return!e||Ct(e)?t.angle:e.angle},boe=t=>t.some(e=>{if(nn(e)){const r=Dn(e);return!(Se(e)&&Ct(r))}return!1}),_oe=t=>t.some(e=>{if(nn(e)){const r=Dn(e);return!(Se(e)&&Ct(r))}return Se(e)}),CA=(t,e,n,r)=>{const i=Rt(t,e);if(i.length===1)return Lc(i[0],!1)?i[0]:null;let s=null;for(let o=t.length-1;o>=0;--o){if(t[o].isDeleted)continue;const[a,l,c,u]=Ve(t[o]);if(Ct(t[o])&&qp(t[o],e,null,[n,r])){s=t[o];break}else if(a<n&&n<c&&l<r&&r<u){s=t[o];break}}return Lc(s,!1)?s:null},Eoe=new Set(["rectangle","ellipse","diamond","arrow"]),woe=t=>Eoe.has(t.type),Zc=(t,e)=>{t=Math.ceil(t);const n=Ln*2;return e==="ellipse"?Math.round((t+n)/Math.sqrt(2)*2):e==="arrow"?t+n*8:e==="diamond"?2*(t+n):t+n},mo=(t,e=tt(t))=>{const{width:n}=t;if(Ct(t)){const r=((e==null?void 0:e.fontSize)??_s)*GV;return Math.max(zV*n,r)}return t.type==="ellipse"?Math.round(n/2*Math.sqrt(2))-Ln*2:t.type==="diamond"?Math.round(n/2)-Ln*2:n-Ln*2},yh=(t,e)=>{const{height:n}=t;return Ct(t)?n-Ln*8*2<=0?e.height:n:t.type==="ellipse"?Math.round(n/2*Math.sqrt(2))-Ln*2:t.type==="diamond"?Math.round(n/2)-Ln*2:n-Ln*2},xoe=()=>u2(EN,mn({fontSize:_s,fontFamily:ca}))>0,__={[mr.Virgil]:1.25,[mr.Helvetica]:1.15,[mr.Cascadia]:1.2},Kc=t=>t in __?__[t]:__[ca];var Toe={VITE_APP_BACKEND_V2_GET_URL:"https://json.excalidraw.com/api/v2/",VITE_APP_BACKEND_V2_POST_URL:"https://json.excalidraw.com/api/v2/post/",VITE_APP_LIBRARY_URL:"https://libraries.excalidraw.com",VITE_APP_LIBRARY_BACKEND:"https://us-central1-excalidraw-room-persistence.cloudfunctions.net/libraries",VITE_APP_PORTAL_URL:"https://portal.excalidraw.com",VITE_APP_PLUS_LP:"https://plus.excalidraw.com",VITE_APP_PLUS_APP:"https://app.excalidraw.com",VITE_APP_AI_BACKEND:"https://oss-ai.excalidraw.com",VITE_APP_WS_SERVER_URL:"",VITE_APP_FIREBASE_CONFIG:'{"apiKey":"AIzaSyAd15pYlMci_xIp9ko6wkEsDzAAA0Dn0RU","authDomain":"excalidraw-room-persistence.firebaseapp.com","databaseURL":"https://excalidraw-room-persistence.firebaseio.com","projectId":"excalidraw-room-persistence","storageBucket":"excalidraw-room-persistence.appspot.com","messagingSenderId":"654800341332","appId":"1:654800341332:web:4a692de832b55bd57ce0c1"}',VITE_APP_DISABLE_TRACKING:"",VITE_APP_GIT_SHA:"",BASE_URL:"/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const TN="invert(100%) hue-rotate(180deg) saturate(1.25)",Soe=Es(),SN=(t,e)=>En(t)&&!e.imageCache.has(t.fileId),CN=(t,e,n)=>{var r;return n.theme==="dark"&&En(t)&&!SN(t,e)&&((r=e.imageCache.get(t.fileId))==null?void 0:r.mimeType)!==Oe.svg},d2=t=>t.type==="freedraw"?t.strokeWidth*12:20,Coe=(t,e)=>{const i=d2(t),[s,o,a,l]=Ve(t),c=Je(t)||Zr(t)?fr(s,a):t.width,u=Je(t)||Zr(t)?fr(o,l):t.height;let d=c*window.devicePixelRatio+i*2,h=u*window.devicePixelRatio+i*2,f=e.value;return(d*f>32767||h*f>32767)&&(f=Math.min(32767/d,32767/h)),d*h*f*f>16777216&&(f=Math.sqrt(16777216/(d*h))),d=Math.floor(d*f),h=Math.floor(h*f),{width:d,height:h,scale:f}},Ioe=(t,e,n,r)=>{var f,p;const i=document.createElement("canvas"),s=i.getContext("2d"),o=d2(t),{width:a,height:l,scale:c}=Coe(t,e);i.width=a,i.height=l;let u=0,d=0;if(Je(t)||Zr(t)){const[m,v]=Ve(t);u=t.x>m?fr(t.x,m)*window.devicePixelRatio*c:0,d=t.y>v?fr(t.y,v)*window.devicePixelRatio*c:0,s.translate(u,d)}s.save(),s.translate(o*c,o*c),s.scale(window.devicePixelRatio*c,window.devicePixelRatio*c);const h=Ll.canvas(i);return CN(t,n,r)&&(s.filter=TN),a0(t,h,s,n,r),s.restore(),{element:t,canvas:i,theme:r.theme,scale:c,zoomValue:e.value,canvasOffsetX:u,canvasOffsetY:d,boundTextElementVersion:((f=tt(t))==null?void 0:f.version)||null,containingFrameOpacity:((p=Bi(t))==null?void 0:p.opacity)||100}},Aoe=14,zS=document.createElement("img");zS.src=`data:${Oe.svg},${encodeURIComponent('<svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="image" class="svg-inline--fa fa-image fa-w-16" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="#888" d="M464 448H48c-26.51 0-48-21.49-48-48V112c0-26.51 21.49-48 48-48h416c26.51 0 48 21.49 48 48v288c0 26.51-21.49 48-48 48zM112 120c-30.928 0-56 25.072-56 56s25.072 56 56 56 56-25.072 56-56-25.072-56-56-56zM64 384h384V272l-87.515-87.515c-4.686-4.686-12.284-4.686-16.971 0L208 320l-55.515-55.515c-4.686-4.686-12.284-4.686-16.971 0L64 336v48z"></path></svg>')}`;const GS=document.createElement("img");GS.src=`data:${Oe.svg},${encodeURIComponent('<svg viewBox="0 0 668 668" xmlns="http://www.w3.org/2000/svg" xml:space="preserve" style="fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2"><path d="M464 448H48c-26.51 0-48-21.49-48-48V112c0-26.51 21.49-48 48-48h416c26.51 0 48 21.49 48 48v288c0 26.51-21.49 48-48 48ZM112 120c-30.928 0-56 25.072-56 56s25.072 56 56 56 56-25.072 56-56-25.072-56-56-56ZM64 384h384V272l-87.515-87.515c-4.686-4.686-12.284-4.686-16.971 0L208 320l-55.515-55.515c-4.686-4.686-12.284-4.686-16.971 0L64 336v48Z" style="fill:#888;fill-rule:nonzero" transform="matrix(.81709 0 0 .81709 124.825 145.825)"/><path d="M256 8C119.034 8 8 119.033 8 256c0 136.967 111.034 248 248 248s248-111.034 248-248S392.967 8 256 8Zm130.108 117.892c65.448 65.448 70 165.481 20.677 235.637L150.47 105.216c70.204-49.356 170.226-44.735 235.638 20.676ZM125.892 386.108c-65.448-65.448-70-165.481-20.677-235.637L361.53 406.784c-70.203 49.356-170.226 44.736-235.638-20.676Z" style="fill:#888;fill-rule:nonzero" transform="matrix(.30366 0 0 .30366 506.822 60.065)"/></svg>')}`;const koe=(t,e,n)=>{e.fillStyle="#E7E7E7",e.fillRect(0,0,t.width,t.height);const r=Math.min(t.width,t.height),i=Math.min(r,Math.min(r*.4,100));e.drawImage(t.status==="error"?GS:zS,t.width/2-i/2,t.height/2-i/2,i,i)},a0=(t,e,n,r,i)=>{var s,o;switch(n.globalAlpha=(((s=Bi(t))==null?void 0:s.opacity)??100)*t.opacity/1e4,t.type){case"rectangle":case"iframe":case"embeddable":case"diamond":case"ellipse":{n.lineJoin="round",n.lineCap="round",e.draw(mt.get(t));break}case"arrow":case"line":{n.lineJoin="round",n.lineCap="round",mt.get(t).forEach(a=>{e.draw(a)});break}case"freedraw":{n.save(),n.fillStyle=t.strokeColor;const a=Loe(t),l=mt.get(t);l&&e.draw(l),n.fillStyle=t.strokeColor,n.fill(a),n.restore();break}case"image":{const a=En(t)?(o=r.imageCache.get(t.fileId))==null?void 0:o.image:void 0;a!=null&&!(a instanceof Promise)?n.drawImage(a,0,0,t.width,t.height):koe(t,n,i.zoom.value);break}default:if(Se(t)){const a=sR(t.text),l=a&&!n.canvas.isConnected;l&&document.body.appendChild(n.canvas),n.canvas.setAttribute("dir",a?"rtl":"ltr"),n.save(),n.font=mn(t),n.fillStyle=t.strokeColor,n.textAlign=t.textAlign;const c=t.text.replace(/\r\n?/g,`
`).split(`
`),u=t.textAlign==="center"?t.width/2:t.textAlign==="right"?t.width:0,d=jm(t.fontSize,t.lineHeight),h=t.height-t.baseline;for(let f=0;f<c.length;f++)n.fillText(c[f],u,(f+1)*d-h);n.restore(),l&&n.canvas.remove()}else throw new Error(`Unimplemented type ${t.type}`)}n.globalAlpha=1},zx=new WeakMap,IA=(t,e,n)=>{var l,c;const r=e?n.zoom:Soe.zoom,i=zx.get(t),s=i&&i.zoomValue!==r.value&&!(n!=null&&n.shouldCacheIgnoreZoom),o=((l=tt(t))==null?void 0:l.version)||null,a=((c=Bi(t))==null?void 0:c.opacity)||100;if(!i||s||i.theme!==n.theme||i.boundTextElementVersion!==o||i.containingFrameOpacity!==a){const u=Ioe(t,r,e,n);return zx.set(t,u),u}return i},AA=(t,e,n,r)=>{const i=t.element,s=d2(i),o=t.scale;let[a,l,c,u]=Ve(i);Zr(i)&&(a=Math.floor(a),c=Math.ceil(c),l=Math.floor(l),u=Math.ceil(u));const d=((a+c)/2+r.scrollX)*window.devicePixelRatio,h=((l+u)/2+r.scrollY)*window.devicePixelRatio;e.save(),e.scale(1/window.devicePixelRatio,1/window.devicePixelRatio);const f=tt(i);if(Ct(i)&&f){const p=document.createElement("canvas"),m=p.getContext("2d"),v=Math.max(fr(a,c),fr(l,u));p.width=v*window.devicePixelRatio*o+s*t.scale*10,p.height=v*window.devicePixelRatio*o+s*t.scale*10;const y=(p.width-t.canvas.width)/2,b=(p.height-t.canvas.height)/2;m.translate(p.width/2,p.height/2),m.rotate(i.angle),m.drawImage(t.canvas,-t.canvas.width/2,-t.canvas.height/2,t.canvas.width,t.canvas.height);const[,,,,_,E]=Ve(f);m.rotate(-i.angle);const w=p.width/2-(_-a)*window.devicePixelRatio*o-y-s*o,x=p.height/2-(E-l)*window.devicePixelRatio*o-b-s*o;m.translate(-w,-x),m.clearRect(-(f.width/2+Ln)*window.devicePixelRatio*o,-(f.height/2+Ln)*window.devicePixelRatio*o,(f.width+Ln*2)*window.devicePixelRatio*o,(f.height+Ln*2)*window.devicePixelRatio*o),e.translate(d,h),e.drawImage(p,-(c-a)/2*window.devicePixelRatio-y/o-s,-(u-l)/2*window.devicePixelRatio-b/o-s,p.width/o,p.height/o)}else if(e.translate(d,h),e.rotate(i.angle),"scale"in t.element&&!SN(i,n)&&e.scale(t.element.scale[0],t.element.scale[1]),e.translate(-d,-h),e.drawImage(t.canvas,(a+r.scrollX)*window.devicePixelRatio-s*t.scale/t.scale,(l+r.scrollY)*window.devicePixelRatio-s*t.scale/t.scale,t.canvas.width/t.scale,t.canvas.height/t.scale),Toe.VITE_APP_DEBUG_ENABLE_TEXT_CONTAINER_BOUNDING_BOX==="true"&&vl(i)){const p=tt(i),m=xN(i);e.strokeStyle="#c92a2a",e.lineWidth=3,e.strokeRect((m.x+r.scrollX)*window.devicePixelRatio,(m.y+r.scrollY)*window.devicePixelRatio,mo(i)*window.devicePixelRatio,yh(i,p)*window.devicePixelRatio)}e.restore()},Moe=(t,e,n)=>{e.save(),e.translate(t.x+n.scrollX,t.y+n.scrollY),e.fillStyle="rgba(0, 0, 200, 0.04)";const r=.5/n.zoom.value;e.fillRect(r,r,t.width,t.height),e.lineWidth=1/n.zoom.value,e.strokeStyle=" rgb(105, 101, 219)",e.strokeRect(r,r,t.width,t.height),e.restore()},sg=(t,e,n,r,i)=>{switch(t.type){case"magicframe":case"frame":{i.frameRendering.enabled&&i.frameRendering.outline&&(n.save(),n.translate(t.x+i.scrollX,t.y+i.scrollY),n.fillStyle="rgba(0, 0, 200, 0.04)",n.lineWidth=Pt.strokeWidth/i.zoom.value,n.strokeStyle=Pt.strokeColor,sd(t)&&(n.strokeStyle=i.theme==="light"?"#7affd7":"#1d8264"),n.roundRect?(n.beginPath(),n.roundRect(0,0,t.width,t.height,Pt.radius/i.zoom.value),n.stroke(),n.closePath()):n.strokeRect(0,0,t.width,t.height),n.restore());break}case"freedraw":{if(mt.generateElementShape(t,null),r.isExporting){const[s,o,a,l]=Ve(t),c=(s+a)/2+i.scrollX,u=(o+l)/2+i.scrollY,d=(a-s)/2-(t.x-s),h=(l-o)/2-(t.y-o);n.save(),n.translate(c,u),n.rotate(t.angle),n.translate(-d,-h),a0(t,e,n,r,i),n.restore()}else{const s=IA(t,r,i);AA(s,n,r,i)}break}case"rectangle":case"diamond":case"ellipse":case"line":case"arrow":case"image":case"text":case"iframe":case"embeddable":{if(mt.generateElementShape(t,r),r.isExporting){const[s,o,a,l]=Ve(t),c=(s+a)/2+i.scrollX,u=(o+l)/2+i.scrollY;let d=(a-s)/2-(t.x-s),h=(l-o)/2-(t.y-o);if(Se(t)){const p=Dn(t);if(Ct(p)){const m=Ae.getBoundTextElementPosition(p,t);d=(a-s)/2-(m.x-s),h=(l-o)/2-(m.y-o)}}n.save(),n.translate(c,u),CN(t,r,i)&&(n.filter="none");const f=tt(t);if(Ct(t)&&f){const p=document.createElement("canvas"),m=p.getContext("2d"),v=Math.max(fr(s,a),fr(o,l)),y=d2(t);p.width=v*i.exportScale+y*10*i.exportScale,p.height=v*i.exportScale+y*10*i.exportScale,m.translate(p.width/2,p.height/2),m.scale(i.exportScale,i.exportScale),d=t.width/2-(t.x-s),h=t.height/2-(t.y-o),m.rotate(t.angle);const b=Ll.canvas(p);m.translate(-d,-h),a0(t,b,m,r,i),m.translate(d,h),m.rotate(-t.angle);const[,,,,_,E]=Ve(f),w=(s+a)/2-_,x=(o+l)/2-E;m.translate(-w,-x),m.clearRect(-f.width/2,-f.height/2,f.width,f.height),n.scale(1/i.exportScale,1/i.exportScale),n.drawImage(p,-p.width/2,-p.height/2,p.width,p.height)}else n.rotate(t.angle),t.type==="image"&&n.scale(t.scale[0],t.scale[1]),n.translate(-d,-h),a0(t,e,n,r,i);n.restore()}else{const s=IA(t,r,i),o=n.imageSmoothingEnabled;!(i!=null&&i.shouldCacheIgnoreZoom)&&(!t.angle||eae(t.angle))&&(n.imageSmoothingEnabled=!1),AA(s,n,r,i),n.imageSmoothingEnabled=o}break}default:throw new Error(`Unimplemented type ${t.type}`)}},qh=(t,e,n)=>{if(typeof n>"u")return t.draw(e);const r={sets:e.sets,shape:e.shape,options:{...e.options,fixedDecimalPlaceDigits:n}};return t.draw(r)},Jh=(t,e,n,r)=>{if(!r.enabled||!r.clip)return null;const i=Bi(t);if(i){const s=e.ownerDocument.createElementNS(Kt,"g");return s.setAttributeNS(Kt,"clip-path",`url(#${i.id})`),n.forEach(o=>s.appendChild(o)),s}return null},Gx=(t,e,n,r,i,s,o)=>{var b;const a={x:i,y:s},[l,c,u,d]=Ve(t);let h=(u-l)/2-(t.x-l),f=(d-c)/2-(t.y-c);if(Se(t)){const _=Dn(t);if(Ct(_)){const[E,w,x,T]=Ve(_),C=Ae.getBoundTextElementPosition(_,t);h=(x-E)/2-(C.x-E),f=(T-w)/2-(C.y-w),i=i+C.x-t.x,s=s+C.y-t.y}}const p=180*t.angle/Math.PI;let m=n;if(t.link){const _=n.ownerDocument.createElementNS(Kt,"a");_.setAttribute("href",ao(t.link)),m.appendChild(_),m=_}const v=(_,E)=>{m.appendChild(_)},y=(((b=Bi(t))==null?void 0:b.opacity)??100)*t.opacity/1e4;switch(t.type){case"selection":throw new Error("Selection rendering is not supported for SVG");case"rectangle":case"diamond":case"ellipse":{const _=mt.generateElementShape(t,null),E=qh(e,_,Bh);y!==1&&(E.setAttribute("stroke-opacity",`${y}`),E.setAttribute("fill-opacity",`${y}`)),E.setAttribute("stroke-linecap","round"),E.setAttribute("transform",`translate(${i||0} ${s||0}) rotate(${p} ${h} ${f})`);const w=Jh(t,m,[E],o.frameRendering);v(w||E);break}case"iframe":case"embeddable":{const _=mt.generateElementShape(t,o),E=qh(e,_,Bh),w=t.opacity/100;w!==1&&(E.setAttribute("stroke-opacity",`${w}`),E.setAttribute("fill-opacity",`${w}`)),E.setAttribute("stroke-linecap","round"),E.setAttribute("transform",`translate(${i||0} ${s||0}) rotate(${p} ${h} ${f})`),v(E);const x=fS(t);Gx(x,e,m,r,x.x+a.x-t.x,x.y+a.y-t.y,o);const T=qh(e,_,Bh);for(T.setAttribute("stroke-linecap","round"),T.setAttribute("transform",`translate(${i||0} ${s||0}) rotate(${p} ${h} ${f})`);T.firstChild;)T.removeChild(T.firstChild);const C=tp(Math.min(t.width,t.height),t),k=ad(iD(t.link||""));if(o.renderEmbeddables===!1||(k==null?void 0:k.type)==="document"){const L=n.ownerDocument.createElementNS(Kt,"a");L.setAttribute("href",ao(t.link||"")),L.setAttribute("target","_blank"),L.setAttribute("rel","noopener noreferrer"),L.style.borderRadius=`${C}px`,T.appendChild(L)}else{const L=n.ownerDocument.createElementNS(Kt,"foreignObject");L.style.width=`${t.width}px`,L.style.height=`${t.height}px`,L.style.border="none";const F=L.ownerDocument.createElementNS(Kt,"div");F.setAttribute("xmlns","http://www.w3.org/1999/xhtml"),F.style.width="100%",F.style.height="100%";const N=F.ownerDocument.createElement("iframe");N.src=(k==null?void 0:k.link)??"",N.style.width="100%",N.style.height="100%",N.style.border="none",N.style.borderRadius=`${C}px`,N.style.top="0",N.style.left="0",N.allowFullscreen=!0,F.appendChild(N),L.appendChild(F),T.appendChild(L)}v(T);break}case"line":case"arrow":{const _=tt(t),E=n.ownerDocument.createElementNS(Kt,"mask");if(_){E.setAttribute("id",`mask-${t.id}`);const C=n.ownerDocument.createElementNS(Kt,"rect");i=i||0,s=s||0,C.setAttribute("x","0"),C.setAttribute("y","0"),C.setAttribute("fill","#fff"),C.setAttribute("width",`${t.width+100+i}`),C.setAttribute("height",`${t.height+100+s}`),E.appendChild(C);const k=n.ownerDocument.createElementNS(Kt,"rect"),L=Ae.getBoundTextElementPosition(t,_),F=i+L.x-t.x,N=s+L.y-t.y;k.setAttribute("x",F.toString()),k.setAttribute("y",N.toString()),k.setAttribute("fill","#000"),k.setAttribute("width",`${_.width}`),k.setAttribute("height",`${_.height}`),k.setAttribute("opacity","1"),E.appendChild(k)}const w=n.ownerDocument.createElementNS(Kt,"g");_&&w.setAttribute("mask",`url(#mask-${t.id})`),w.setAttribute("stroke-linecap","round"),mt.generateElementShape(t,o).forEach(C=>{const k=qh(e,C,Bh);y!==1&&(k.setAttribute("stroke-opacity",`${y}`),k.setAttribute("fill-opacity",`${y}`)),k.setAttribute("transform",`translate(${i||0} ${s||0}) rotate(${p} ${h} ${f})`),t.type==="line"&&sa(t.points)&&t.backgroundColor!=="transparent"&&k.setAttribute("fill-rule","evenodd"),w.appendChild(k)});const T=Jh(t,m,[w,E],o.frameRendering);T?(v(T),m.appendChild(T)):(v(w),m.append(E));break}case"freedraw":{const _=mt.generateElementShape(t,o),E=_?qh(e,_,Bh):n.ownerDocument.createElementNS(Kt,"g");y!==1&&(E.setAttribute("stroke-opacity",`${y}`),E.setAttribute("fill-opacity",`${y}`)),E.setAttribute("transform",`translate(${i||0} ${s||0}) rotate(${p} ${h} ${f})`),E.setAttribute("stroke","none");const w=n.ownerDocument.createElementNS(Kt,"path");w.setAttribute("fill",t.strokeColor),w.setAttribute("d",kN(t)),E.appendChild(w);const x=Jh(t,m,[E],o.frameRendering);v(x||E);break}case"image":{const _=Math.round(t.width),E=Math.round(t.height),w=En(t)&&r[t.fileId];if(w){const x=`image-${w.id}`;let T=n.querySelector(`#${x}`);if(!T){T=n.ownerDocument.createElementNS(Kt,"symbol"),T.id=x;const F=n.ownerDocument.createElementNS(Kt,"image");F.setAttribute("width","100%"),F.setAttribute("height","100%"),F.setAttribute("href",w.dataURL),T.appendChild(F),m.prepend(T)}const C=n.ownerDocument.createElementNS(Kt,"use");if(C.setAttribute("href",`#${x}`),o.exportWithDarkMode&&w.mimeType!==Oe.svg&&C.setAttribute("filter",TN),C.setAttribute("width",`${_}`),C.setAttribute("height",`${E}`),C.setAttribute("opacity",`${y}`),t.scale[0]!==1||t.scale[1]!==1){const F=t.scale[0]!==1?-_:0,N=t.scale[1]!==1?-E:0;C.setAttribute("transform",`scale(${t.scale[0]}, ${t.scale[1]}) translate(${F} ${N})`)}const k=n.ownerDocument.createElementNS(Kt,"g");k.appendChild(C),k.setAttribute("transform",`translate(${i||0} ${s||0}) rotate(${p} ${h} ${f})`);const L=Jh(t,m,[k],o.frameRendering);v(L||k)}break}case"frame":case"magicframe":{if(o.frameRendering.enabled&&o.frameRendering.outline){const _=document.createElementNS(Kt,"rect");_.setAttribute("transform",`translate(${i||0} ${s||0}) rotate(${p} ${h} ${f})`),_.setAttribute("width",`${t.width}px`),_.setAttribute("height",`${t.height}px`),_.setAttribute("rx",Pt.radius.toString()),_.setAttribute("ry",Pt.radius.toString()),_.setAttribute("fill","none"),_.setAttribute("stroke",Pt.strokeColor),_.setAttribute("stroke-width",Pt.strokeWidth.toString()),v(_)}break}default:if(Se(t)){const _=n.ownerDocument.createElementNS(Kt,"g");y!==1&&(_.setAttribute("stroke-opacity",`${y}`),_.setAttribute("fill-opacity",`${y}`)),_.setAttribute("transform",`translate(${i||0} ${s||0}) rotate(${p} ${h} ${f})`);const E=t.text.replace(/\r\n?/g,`
`).split(`
`),w=jm(t.fontSize,t.lineHeight),x=t.textAlign==="center"?t.width/2:t.textAlign==="right"?t.width:0,T=sR(t.text)?"rtl":"ltr",C=t.textAlign==="center"?"middle":t.textAlign==="right"||T==="rtl"?"end":"start";for(let L=0;L<E.length;L++){const F=n.ownerDocument.createElementNS(Kt,"text");F.textContent=E[L],F.setAttribute("x",`${x}`),F.setAttribute("y",`${L*w}`),F.setAttribute("font-family",BT(t)),F.setAttribute("font-size",`${t.fontSize}px`),F.setAttribute("fill",t.strokeColor),F.setAttribute("text-anchor",C),F.setAttribute("style","white-space: pre;"),F.setAttribute("direction",T),F.setAttribute("dominant-baseline","text-before-edge"),_.appendChild(F)}const k=Jh(t,m,[_],o.frameRendering);v(k||_)}else throw new Error(`Unimplemented type ${t.type}`)}},IN=new WeakMap([]),AN=new WeakMap([]);function Poe(t,e=!1){const n=kN(t);if(e)AN.set(t,n);else{const r=new Path2D(n);IN.set(t,r)}}function Loe(t){return IN.get(t)}function kN(t){const e=t.simulatePressure?t.points:t.points.length?t.points.map(([r,i],s)=>[r,i,t.pressures[s]]):[[0,0,.5]],n={simulatePressure:t.simulatePressure,size:t.strokeWidth*4.25,thinning:.6,smoothing:.5,streamline:.5,easing:r=>Math.sin(r*Math.PI/2),last:!!t.lastCommittedPoint};return Ooe(rQ(e,n))}function kA(t,e){return[(t[0]+e[0])/2,(t[1]+e[1])/2]}const Roe=/(\s?[A-Z]?,?-?[0-9]*\.[0-9]{0,2})(([0-9]|e|-)*)/g;function Ooe(t){if(!t.length)return"";const e=t.length-1;return t.reduce((n,r,i,s)=>(i===e?n.push(r,kA(r,s[0]),"L",s[0],"Z"):n.push(r,kA(r,s[i+1])),n),["M",t[0],"Q"]).join(" ").replace(Roe,"$1")}const Doe=t=>[8,8+t],MN=t=>[1.5,6+t];function Noe(t){const e=t.roughness,n=Math.max(t.width,t.height),r=Math.min(t.width,t.height);return r>=20&&n>=50||r>=15&&t.roundness&&$x(t.type)||Je(t)&&n>=50?e:Math.min(e/(n<10?3:2),2.5)}const _i=(t,e=!1)=>{const n={seed:t.seed,strokeLineDash:t.strokeStyle==="dashed"?Doe(t.strokeWidth):t.strokeStyle==="dotted"?MN(t.strokeWidth):void 0,disableMultiStroke:t.strokeStyle!=="solid",strokeWidth:t.strokeStyle!=="solid"?t.strokeWidth+.5:t.strokeWidth,fillWeight:t.strokeWidth/2,hachureGap:t.strokeWidth*4,roughness:Noe(t),stroke:t.strokeColor,preserveVertices:e||t.roughness<b7.cartoonist};switch(t.type){case"rectangle":case"iframe":case"embeddable":case"diamond":case"ellipse":return n.fillStyle=t.fillStyle,n.fill=to(t.backgroundColor)?void 0:t.backgroundColor,t.type==="ellipse"&&(n.curveFitting=1),n;case"line":case"freedraw":return sa(t.points)&&(n.fillStyle=t.fillStyle,n.fill=t.backgroundColor==="transparent"?void 0:t.backgroundColor),n;case"arrow":return n;default:throw new Error(`Unimplemented type ${t.type}`)}},MA=(t,e)=>os(t)&&(e||ur(t)&&!t.validated)&&to(t.backgroundColor)&&to(t.strokeColor)?{...t,roughness:0,backgroundColor:"#d3d3d3",fillStyle:"solid"}:Pa(t)?{...t,strokeColor:to(t.strokeColor)?"#000000":t.strokeColor,backgroundColor:to(t.backgroundColor)?"#f4f4f6":t.backgroundColor}:t,PA=(t,e,n,r,i,s,o)=>{const a=Voe(t,e,n,r);if(a===null)return[];switch(r){case"dot":case"circle":case"circle_outline":{const[l,c,u]=a;return delete s.strokeLineDash,[i.circle(l,c,u,{...s,fill:r==="circle_outline"?o:t.strokeColor,fillStyle:"solid",stroke:t.strokeColor,roughness:Math.min(.5,s.roughness||0)})]}case"triangle":case"triangle_outline":{const[l,c,u,d,h,f]=a;return delete s.strokeLineDash,[i.polygon([[l,c],[u,d],[h,f],[l,c]],{...s,fill:r==="triangle_outline"?o:t.strokeColor,fillStyle:"solid",roughness:Math.min(1,s.roughness||0)})]}case"diamond":case"diamond_outline":{const[l,c,u,d,h,f,p,m]=a;return delete s.strokeLineDash,[i.polygon([[l,c],[u,d],[h,f],[p,m],[l,c]],{...s,fill:r==="diamond_outline"?o:t.strokeColor,fillStyle:"solid",roughness:Math.min(1,s.roughness||0)})]}case"bar":case"arrow":default:{const[l,c,u,d,h,f]=a;if(t.strokeStyle==="dotted"){const p=MN(t.strokeWidth-1);s.strokeLineDash=[p[0],p[1]-1]}else delete s.strokeLineDash;return s.roughness=Math.min(1,s.roughness||0),[i.line(u,d,l,c,s),i.line(h,f,l,c,s)]}}},Foe=(t,e,{isExporting:n,canvasBackgroundColor:r,webGLEnabled:i})=>{switch(t.type){case"rectangle":case"iframe":case"embeddable":{let s;if(t.roundness){const o=t.width,a=t.height,l=tp(Math.min(o,a),t);s=e.path(`M ${l} 0 L ${o-l} 0 Q ${o} 0, ${o} ${l} L ${o} ${a-l} Q ${o} ${a}, ${o-l} ${a} L ${l} ${a} Q 0 ${a}, 0 ${a-l} L 0 ${l} Q 0 0, ${l} 0`,_i(MA(t,n),!0))}else s=e.rectangle(0,0,t.width,t.height,_i(MA(t,n),!1));return s}case"diamond":{let s;const[o,a,l,c,u,d,h,f]=Uoe(t);if(t.roundness){const p=tp(Math.abs(o-h),t),m=tp(Math.abs(c-a),t);s=e.path(`M ${o+p} ${a+m} L ${l-p} ${c-m}
            C ${l} ${c}, ${l} ${c}, ${l-p} ${c+m}
            L ${u+p} ${d-m}
            C ${u} ${d}, ${u} ${d}, ${u-p} ${d-m}
            L ${h+p} ${f+m}
            C ${h} ${f}, ${h} ${f}, ${h+p} ${f-m}
            L ${o-p} ${a+m}
            C ${o} ${a}, ${o} ${a}, ${o+p} ${a+m}`,_i(t,!0))}else s=e.polygon([[o,a],[l,c],[u,d],[h,f]],_i(t));return s}case"ellipse":return e.ellipse(t.width/2,t.height/2,t.width,t.height,_i(t));case"line":case"arrow":{let s;const o=_i(t),a=t.points.length?t.points:[[0,0]];if(t.roundness?s=[e.curve(a,o)]:o.fill?s=[e.polygon(a,o)]:s=[e.linearPath(a,o)],t.type==="arrow"){const{startArrowhead:l=null,endArrowhead:c="arrow"}=t;if(l!==null){const u=PA(t,s,"start",l,e,o,r);s.push(...u)}if(c!==null){const u=PA(t,s,"end",c,e,o,r);s.push(...u)}}return s}case"freedraw":{let s;if(Poe(t,i),sa(t.points)){const o=EQ(t.points,.75);s=e.curve(o,{..._i(t),stroke:"none"})}else s=null;return s}case"frame":case"magicframe":case"text":case"image":return null;default:return zd(t,`generateElementShape(): Unimplemented type ${t==null?void 0:t.type}`),null}},PN=t=>{const e=t.map(r=>r[0]),n=t.map(r=>r[1]);return{width:Math.max(...e)-Math.min(...e),height:Math.max(...n)-Math.min(...n)}},Kd=(t,e,n,r)=>{const i=n.map(f=>f[t]),s=Math.max(...i),o=Math.min(...i),a=s-o,l=a===0?1:e/a;let c=1/0;const u=n.map(f=>{const p=f[t]*l,m=[...f];return m[t]=p,p<c&&(c=p),m});if(!r||u.length===2)return u;const d=o-c;return u.map(f=>f.map((p,m)=>m===t?p+d:p))},js=class js{static getBounds(e){const n=js.boundsCache.get(e);if(n!=null&&n.version&&n.version===e.version&&!nn(e))return n.bounds;const r=js.calculateBounds(e);return bt.getScene(e)&&js.boundsCache.set(e,{version:e.version,bounds:r}),r}static getBoundsWithZeroRotation(e){const n=js.boundsWithZeroRotationCache.get(e);if(n!=null&&n.version&&n.version===e.version&&!nn(e))return n.bounds;const r=js.calculateBounds(e,!0);return bt.getScene(e)&&js.boundsWithZeroRotationCache.set(e,{version:e.version,bounds:r}),r}static calculateBounds(e,n=!1){let r;const[i,s,o,a,l,c]=Ve(e);if(Zr(e)){const[u,d,h,f]=VS(e.points.map(([p,m])=>et(p,m,l-e.x,c-e.y,n?0:e.angle)));return[u+e.x,d+e.y,h+e.x,f+e.y]}else if(Je(e))r=joe(n?{...e,angle:0}:e,l,c);else if(e.type==="diamond"){const[u,d]=et(l,s,l,c,n?0:e.angle),[h,f]=et(l,a,l,c,n?0:e.angle),[p,m]=et(i,c,l,c,n?0:e.angle),[v,y]=et(o,c,l,c,n?0:e.angle),b=Math.min(u,h,p,v),_=Math.min(d,f,m,y),E=Math.max(u,h,p,v),w=Math.max(d,f,m,y);r=[b,_,E,w]}else if(e.type==="ellipse"){const u=(o-i)/2,d=(a-s)/2,h=Math.cos(n?0:e.angle),f=Math.sin(n?0:e.angle),p=Math.hypot(u*h,d*f),m=Math.hypot(d*h,u*f);r=[l-p,c-m,l+p,c+m]}else{const[u,d]=et(i,s,l,c,n?0:e.angle),[h,f]=et(i,a,l,c,n?0:e.angle),[p,m]=et(o,a,l,c,n?0:e.angle),[v,y]=et(o,s,l,c,n?0:e.angle),b=Math.min(u,h,p,v),_=Math.min(d,f,m,y),E=Math.max(u,h,p,v),w=Math.max(d,f,m,y);r=[b,_,E,w]}return r}};O(js,"boundsCache",new WeakMap),O(js,"boundsWithZeroRotationCache",new WeakMap);let Ly=js;const Ve=(t,e=!1)=>{if(Zr(t))return Hoe(t);if(Je(t))return Ae.getElementAbsoluteCoords(t,e);if(Se(t)){const n=Dn(t);if(Ct(n)){const r=Ae.getBoundTextElementPosition(n,t);return[r.x,r.y,r.x+t.width,r.y+t.height,r.x+t.width/2,r.y+t.height/2]}}return[t.x,t.y,t.x+t.width,t.y+t.height,t.x+t.width/2,t.y+t.height/2]},LA=t=>{const[e,n,r,i,s,o]=Ve(t),a=[s,o];if(Je(t)||Zr(t)){const v=[];let y=0;for(;y<t.points.length-1;)v.push([Wt([t.points[y][0]+t.x,t.points[y][1]+t.y],a,t.angle),Wt([t.points[y+1][0]+t.x,t.points[y+1][1]+t.y],a,t.angle)]),y++;return v}const[l,c,u,d,h,f,p,m]=[[e,n],[r,n],[e,i],[r,i],[s,n],[s,i],[e,o],[r,o]].map(v=>Wt(v,a,t.angle));return t.type==="diamond"?[[h,p],[h,m],[f,p],[f,m]]:t.type==="ellipse"?[[h,p],[h,m],[f,p],[f,m],[h,p],[h,m],[f,p],[f,m]]:[[l,c],[u,d],[l,u],[c,d],[l,m],[u,m],[c,p],[d,p]]},Boe=t=>[t.x,t.y,t.x+t.width,t.y+t.height,t.x+t.width/2,t.y+t.height/2],Uoe=t=>{const e=Math.floor(t.width/2)+1,n=0,r=t.width,i=Math.floor(t.height/2)+1,s=e,o=t.height;return[e,n,r,i,s,o,0,i]},Ol=t=>{for(const e of t.sets)if(e.type==="path")return e.ops;return t.sets[0].ops},RA=(t,e,n,r,i)=>{const s=1-t;return Math.pow(s,3)*e+3*Math.pow(s,2)*t*n+3*s*Math.pow(t,2)*r+Math.pow(t,3)*i},OA=(t,e,n,r)=>{const i=e-t,s=n-e,o=r-n,a=3*i-6*s+3*o,l=6*s-6*i,c=3*i,u=l*l-4*a*c;if(!(u>=0))return!1;let h=null,f=null,p=1/0,m=1/0;return a===0?p=m=-c/l:(p=(-l+Math.sqrt(u))/(2*a),m=(-l-Math.sqrt(u))/(2*a)),p>=0&&p<=1&&(h=RA(p,t,e,n,r)),m>=0&&m<=1&&(f=RA(m,t,e,n,r)),[h,f]},$oe=(t,e,n,r)=>{const i=OA(t[0],e[0],n[0],r[0]),s=OA(t[1],e[1],n[1],r[1]);let o=Math.min(t[0],r[0]),a=Math.max(t[0],r[0]);if(i){const u=i.filter(d=>d!==null);o=Math.min(o,...u),a=Math.max(a,...u)}let l=Math.min(t[1],r[1]),c=Math.max(t[1],r[1]);if(s){const u=s.filter(d=>d!==null);l=Math.min(l,...u),c=Math.max(c,...u)}return[o,l,a,c]},h2=(t,e)=>{let n=[0,0];const{minX:r,minY:i,maxX:s,maxY:o}=t.reduce((a,{op:l,data:c})=>{if(l==="move")n=c;else if(l==="bcurveTo"){const u=[c[0],c[1]],d=[c[2],c[3]],h=[c[4],c[5]],f=e?e(...u):u,p=e?e(...d):d,m=e?e(...h):h,v=e?e(...n):n;n=h;const[y,b,_,E]=$oe(v,f,p,m);a.minX=Math.min(a.minX,y),a.minY=Math.min(a.minY,b),a.maxX=Math.max(a.maxX,_),a.maxY=Math.max(a.maxY,E)}return a},{minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0});return[r,i,s,o]},VS=t=>{let e=1/0,n=1/0,r=-1/0,i=-1/0;for(const[s,o]of t)e=Math.min(e,s),n=Math.min(n,o),r=Math.max(r,s),i=Math.max(i,o);return[e,n,r,i]},Hoe=t=>{const[e,n,r,i]=VS(t.points),s=e+t.x,o=n+t.y,a=r+t.x,l=i+t.y;return[s,o,a,l,(s+a)/2,(o+l)/2]},zoe=t=>{switch(t){case"arrow":return 25;case"diamond":case"diamond_outline":return 12;default:return 15}},Goe=t=>{switch(t){case"bar":return 90;case"arrow":return 20;default:return 25}},Voe=(t,e,n,r)=>{const i=Ol(e[0]);if(i.length<1)return null;const s=n==="start"?1:i.length-1,o=i[s].data,a=[o[4],o[5]],l=[o[2],o[3]],c=[o[0],o[1]],u=i[s-1];let d=[0,0];u.op==="move"?d=u.data:u.op==="bcurveTo"&&(d=[u.data[4],u.data[5]]);const h=(W,q)=>Math.pow(1-W,3)*a[q]+3*W*Math.pow(1-W,2)*l[q]+3*Math.pow(W,2)*(1-W)*c[q]+d[q]*Math.pow(W,3),[f,p]=n==="start"?d:a,[m,v]=[h(.3,0),h(.3,1)],y=Math.hypot(f-m,p-v),b=(f-m)/y,_=(p-v)/y,E=zoe(r);let w=0;{const[W,q]=n==="end"?t.points[t.points.length-1]:t.points[0],[Z,j]=t.points.length>1?n==="end"?t.points[t.points.length-2]:t.points[1]:[0,0];w=Math.hypot(W-Z,q-j)}const T=Math.min(E,w*(r==="diamond"||r==="diamond_outline"?.25:.5)),C=f-b*T,k=p-_*T;if(r==="dot"||r==="circle"||r==="circle_outline"){const W=Math.hypot(k-p,C-f)+t.strokeWidth-2;return[f,p,W]}const L=Goe(r),[F,N]=et(C,k,f,p,-L*Math.PI/180),[R,H]=et(C,k,f,p,L*Math.PI/180);if(r==="diamond"||r==="diamond_outline"){let W,q;if(n==="start"){const[Z,j]=t.points.length>1?t.points[1]:[0,0];[W,q]=et(f+T*2,p,f,p,Math.atan2(j-p,Z-f))}else{const[Z,j]=t.points.length>1?t.points[t.points.length-2]:[0,0];[W,q]=et(f-T*2,p,f,p,Math.atan2(p-j,f-Z))}return[f,p,F,N,W,q,R,H]}return[f,p,F,N,R,H]},Woe=t=>{const e=Ll.generator(),n=_i(t),r=t.roundness?"curve":n.fill?"polygon":"linearPath";return e[r](t.points,n)},joe=(t,e,n)=>{var u;if(t.points.length<2){const[d,h]=t.points[0],[f,p]=et(t.x+d,t.y+h,e,n,t.angle);let m=[f,p,f,p];const v=tt(t);if(v){const y=Ae.getMinMaxXYWithBoundText(t,[f,p,f,p],v);m=[y[0],y[1],y[2],y[3]]}return m}const i=((u=mt.get(t))==null?void 0:u[0])??Woe(t),s=Ol(i),a=h2(s,(d,h)=>et(t.x+d,t.y+h,e,n,t.angle));let l=[a[0],a[1],a[2],a[3]];const c=tt(t);if(c){const d=Ae.getMinMaxXYWithBoundText(t,l,c);l=[d[0],d[1],d[2],d[3]]}return l},Xoe=t=>Ly.getBoundsWithZeroRotation(t),qc=t=>Ly.getBounds(t),Ut=t=>{if(!t.length)return[0,0,0,0];let e=1/0,n=-1/0,r=1/0,i=-1/0;return t.forEach(s=>{const[o,a,l,c]=qc(s);e=Math.min(e,o),r=Math.min(r,a),n=Math.max(n,l),i=Math.max(i,c)}),[e,r,n,i]},WS=(t,e)=>{const[n,r,i,s]=Ut(t);return[n+e.x,r+e.y,i+e.x,s+e.y]},ep=(t,e,n,r)=>{if(!(Je(t)||Zr(t)))return[t.x,t.y,t.x+e,t.y+n];const i=Kd(0,e,Kd(1,n,t.points,r),r);let s;if(Zr(t))s=VS(i);else{const u=Ll.generator(),d=t.roundness?u.curve(i,_i(t)):u.linearPath(i,_i(t)),h=Ol(d);s=h2(h)}const[o,a,l,c]=s;return[o+t.x,a+t.y,l+t.x,c+t.y]},Ry=(t,e)=>{const n=Ll.generator(),r=t.roundness==null?n.linearPath(e,_i(t)):n.curve(e,_i(t)),i=Ol(r),[s,o,a,l]=h2(i);return[s+t.x,o+t.y,a+t.x,l+t.y]},Yoe=(t,e)=>{if(!t.length)return[0,0,0,0];let n=1/0,r=t[0];return t.forEach(i=>{const[s,o,a,l]=qc(i),c=vn((s+a)/2,(o+l)/2,e.x,e.y);c<n&&(n=c,r=i)}),qc(r)},Yo=t=>{const[e,n,r,i]=Ut(t);return{minX:e,minY:n,maxX:r,maxY:i,width:r-e,height:i-n,midX:(e+r)/2,midY:(n+i)/2}},Zoe=({scrollX:t,scrollY:e,width:n,height:r,zoom:i})=>[-t,-e,-t+n/i.value,-e+r/i.value],et=(t,e,n,r,i)=>[(t-n)*Math.cos(i)-(e-r)*Math.sin(i)+n,(t-n)*Math.sin(i)+(e-r)*Math.cos(i)+r],Wt=(t,e,n)=>et(t[0],t[1],e[0],e[1],n),LN=(t,e,n,r,i,s,o,a)=>{const l=Math.cos(r),c=Math.sin(r);return t.e&&t.w?e+=i+o:t.e?(e+=i*(1+l),n+=i*c,e+=o*(1-l),n+=o*-c):t.w&&(e+=i*(1-l),n+=i*-c,e+=o*(1+l),n+=o*c),t.n&&t.s?n+=s+a:t.n?(e+=s*c,n+=s*(1-l),e+=a*-c,n+=a*(1+l)):t.s&&(e+=s*-c,n+=s*(1+l),e+=a*c,n+=a*(1-l)),[e,n]},vn=(t,e,n,r)=>{const i=n-t,s=r-e;return Math.hypot(i,s)},Vx=(t,e)=>[(t[0]+e[0])/2,(t[1]+e[1])/2],sa=(t,e=1)=>{if(t.length>=3){const[n,r]=[t[0],t[t.length-1]];return vn(n[0],n[1],r[0],r[1])<=Fg/e}return!1},DA=(t,e,n)=>{const r=t.length;if(r<3)return!1;const i=[Number.MAX_SAFE_INTEGER,n],s=[e,n];let o=0;for(let a=0;a<r;a++){const l=t[a],c=t[(a+1)%r];if(Koe(l,c,s,i)){if(Af(l,s,c)===0)return cd(l,s,c);o++}}return o%2===1},cd=(t,e,n)=>e[0]<=Math.max(t[0],n[0])&&e[0]>=Math.min(t[0],n[0])&&e[1]<=Math.max(t[1],n[1])&&e[1]>=Math.min(t[1],n[1]),Af=(t,e,n)=>{const r=(e[1]-t[1])*(n[0]-e[0])-(e[0]-t[0])*(n[1]-e[1]);return r===0?0:r>0?1:2},Koe=(t,e,n,r)=>{const i=Af(t,e,n),s=Af(t,e,r),o=Af(n,r,t),a=Af(n,r,e);return!!(i!==s&&o!==a||i===0&&cd(t,n,e)||s===0&&cd(t,r,e)||o===0&&cd(n,t,r)||a===0&&cd(n,e,r))},Kn=(t,e,n)=>n?[Math.round(t/n)*n,Math.round(e/n)*n]:[t,e],tp=(t,e)=>{var n,r,i,s;if(((n=e.roundness)==null?void 0:n.type)===jn.PROPORTIONAL_RADIUS||((r=e.roundness)==null?void 0:r.type)===jn.LEGACY)return t*fb;if(((i=e.roundness)==null?void 0:i.type)===jn.ADAPTIVE_RADIUS){const o=((s=e.roundness)==null?void 0:s.value)??WV,a=o/fb;return t<=a?t*fb:o}return 0},RN=(t,e)=>{const n=mt.generateElementShape(t,null);if(!n)return null;const r=Ol(n[0]);let i=[0,0],s=0,o=1/0,a=null;for(;s<r.length;){const{op:l,data:c}=r[s];if(l==="move"&&(i=c),l==="bcurveTo"){const u=i,d=[c[0],c[1]],h=[c[2],c[3]],f=[c[4],c[5]],p=vn(f[0],f[1],e[0],e[1]);p<o&&(o=p,a=[u,d,h,f]),i=f}s++}return a},ON=(t,e,n,r,i)=>{const s=(l,c)=>Math.pow(1-l,3)*r[c]+3*l*Math.pow(1-l,2)*n[c]+3*Math.pow(l,2)*(1-l)*e[c]+t[c]*Math.pow(l,3),o=s(i,0),a=s(i,1);return[o,a]},qoe=(t,e)=>{const n=RN(t,e);if(!n)return[];const r=[];let i=1;for(;i>0;){const s=ON(n[0],n[1],n[2],n[3],i);r.push([s[0],s[1]]),i-=.05}return r.length&&NN(r.at(-1),e)&&r.push([e[0],e[1]]),r},DN=(t,e)=>{const n=[];n[0]=0;const r=qoe(t,e);let i=0,s=0;for(;i<r.length-1;){const o=vn(r[i][0],r[i][1],r[i+1][0],r[i+1][1]);s+=o,n.push(s),i++}return n},Joe=(t,e)=>DN(t,e).at(-1),Qoe=(t,e,n)=>{const r=DN(t,e),i=r.length-1,s=r.at(-1),o=n*s;let a=0,l=i,c=0;for(;a<l;)c=Math.floor(a+(l-a)/2),r[c]<o?a=c+1:l=c;return r[c]>o&&c--,r[c]===o?c/i:1-(c+(o-r[c])/(r[c+1]-r[c]))/i},NN=(t,e)=>t[0]===e[0]&&t[1]===e[1],eae=t=>Math.round(t/Math.PI*1e4)%5e3===0,Oy=([t,e],[n,r])=>t<=n?e>=n:t>=n?r>=t:!1,Dy=(t,e)=>{const n=Math.max(t[0],e[0]),r=Math.min(t[1],e[1]);return n<=r?[n,r]:null},og=(t,e,n)=>t>=e&&t<=n,ag=t=>t+.5<<0,pu=(()=>{if(typeof self>"u")return!1;if("top"in self&&self!==top)try{}catch{return!1}else if("showOpenFilePicker"in self)return"showOpenFilePicker";return!1})(),tae=pe(pu?()=>import("./file-open-002ab408-YYr_q30i.js"):()=>import("./file-open-7c801643-DzelrtLq.js"),__vite__mapDeps([]));async function nae(...t){return(await tae).default(...t)}pe(pu?()=>import("./directory-open-4ed118d0-LU9zN15H.js"):()=>import("./directory-open-01563666-cQgJ4y3t.js"),__vite__mapDeps([]));const rae=pe(pu?()=>import("./file-save-745eba88-h9NxcJsg.js"):()=>import("./file-save-3189631c-fOa8IYo3.js"),__vite__mapDeps([]));async function iae(...t){return(await rae).default(...t)}const NA=500,jS=t=>{var r,i;const e=(r=t.extensions)==null?void 0:r.reduce((s,o)=>(s.push(Oe[o]),s),[]),n=(i=t.extensions)==null?void 0:i.reduce((s,o)=>o==="jpg"?s.concat(".jpg",".jpeg"):s.concat(`.${o}`),[]);return nae({description:t.description,extensions:n,mimeTypes:e,multiple:t.multiple??!1,legacySetup:(s,o,a)=>{const l=$c(o,NA),c=()=>{u(),document.addEventListener(ee.KEYUP,l),document.addEventListener(ee.POINTER_UP,l),l()},u=()=>{var h;if((h=a.files)!=null&&h.length){const f=t.multiple?[...a.files]:a.files[0];s(f)}};requestAnimationFrame(()=>{window.addEventListener(ee.FOCUS,c)});const d=window.setInterval(()=>{u()},NA);return h=>{clearInterval(d),l.cancel(),window.removeEventListener(ee.FOCUS,c),document.removeEventListener(ee.KEYUP,l),document.removeEventListener(ee.POINTER_UP,l),h&&(console.warn("Opening the file was canceled (legacy-fs)."),h(new Zp))}}})},Ny=(t,e)=>iae(t,{fileName:`${e.name}.${e.extension}`,description:e.description,extensions:[`.${e.extension}`]},e.fileHandle),sae={selection:!0,text:!0,rectangle:!0,diamond:!0,ellipse:!0,line:!0,image:!0,arrow:!0,freedraw:!0,eraser:!1,custom:!0,frame:!0,embeddable:!0,hand:!0,laser:!1,magicframe:!1},oae=t=>Object.keys(mr).includes(t)?mr[t]:ca,FA=t=>t?{...t,focus:t.focus||0}:null,Bl=(t,e)=>{const n={type:e.type||t.type,version:t.version||1,versionNonce:t.versionNonce??0,isDeleted:t.isDeleted??!1,id:t.id||Di(),fillStyle:t.fillStyle||en.fillStyle,strokeWidth:t.strokeWidth||en.strokeWidth,strokeStyle:t.strokeStyle??en.strokeStyle,roughness:t.roughness??en.roughness,opacity:t.opacity==null?en.opacity:t.opacity,angle:t.angle||0,x:e.x??t.x??0,y:e.y??t.y??0,strokeColor:t.strokeColor||en.strokeColor,backgroundColor:t.backgroundColor||en.backgroundColor,width:t.width||0,height:t.height||0,seed:t.seed??1,groupIds:t.groupIds??[],frameId:t.frameId??null,roundness:t.roundness?t.roundness:t.strokeSharpness==="round"?{type:dh(t.type)?jn.LEGACY:jn.PROPORTIONAL_RADIUS}:null,boundElements:t.boundElementIds?t.boundElementIds.map(r=>({type:"arrow",id:r})):t.boundElements??[],updated:t.updated??lh(),link:t.link?ao(t.link):null,locked:t.locked??!1};return("customData"in t||"customData"in e)&&(n.customData="customData"in e?e.customData:t.customData),Ua in t&&(n[Ua]=t[Ua]),{...n,...xB(n),...e}},aae=(t,e=!1)=>{switch(t.type){case"text":let n=t.fontSize,r=t.fontFamily;if("font"in t){const[a,l]=t.font.split(" ");n=parseFloat(a),r=oae(l)}const i=typeof t.text=="string"&&t.text||"",s=t.lineHeight||(t.height?vN(t):Kc(t.fontFamily)),o=yN(t.text,mn(t),s);return t=Bl(t,{fontSize:n,fontFamily:r,text:i,textAlign:t.textAlign||kv,verticalAlign:t.verticalAlign||j0,containerId:t.containerId??null,originalText:t.originalText||i,lineHeight:s,baseline:o}),!i&&!t.isDeleted&&(t={...t,originalText:i,isDeleted:!0},t=wh(t)),e&&(t={...t,...hS(t)}),t;case"freedraw":return Bl(t,{points:t.points,lastCommittedPoint:null,simulatePressure:t.simulatePressure,pressures:t.pressures});case"image":return Bl(t,{status:t.status||"pending",fileId:t.fileId,scale:t.scale||[1,1]});case"line":case"draw":case"arrow":{const{startArrowhead:a=null,endArrowhead:l=t.type==="arrow"?"arrow":null}=t;let c=t.x,u=t.y,d=!Array.isArray(t.points)||t.points.length<2?[[0,0],[t.width,t.height]]:t.points;return(d[0][0]!==0||d[0][1]!==0)&&({points:d,x:c,y:u}=Ae.getNormalizedPoints(t)),Bl(t,{type:t.type==="draw"?"line":t.type,startBinding:FA(t.startBinding),endBinding:FA(t.endBinding),lastCommittedPoint:null,startArrowhead:a,endArrowhead:l,points:d,x:c,y:u})}case"ellipse":case"rectangle":case"diamond":case"iframe":return Bl(t,{});case"embeddable":return Bl(t,{validated:null});case"magicframe":case"frame":return Bl(t,{name:t.name??null})}return null},lae=(t,e)=>{if(t.boundElements){const n=t.boundElements.slice(),r=new Set;t.boundElements=n.reduce((i,s)=>{const o=e.get(s.id);if(o&&!r.has(s.id)){if(r.add(s.id),o.isDeleted)return i;i.push(s),Se(o)&&!o.containerId&&(o.containerId=t.id)}return i},[])}},cae=(t,e)=>{const n=t.containerId?e.get(t.containerId):null;if(!n){t.containerId=null;return}if(!t.isDeleted&&n.boundElements&&!n.boundElements.find(r=>r.id===t.id)){const r=(n.boundElements||(n.boundElements=[])).slice();r.push({type:"text",id:t.id}),n.boundElements=r}},uae=(t,e)=>{t.frameId&&(e.get(t.frameId)||(t.frameId=null))},Ym=(t,e,n)=>{const r=new Set,i=e?xn(e):null,s=(t||[]).reduce((a,l)=>{if(l.type!=="selection"&&!su(l)){let c=aae(l,n==null?void 0:n.refreshDimensions);if(c){const u=i==null?void 0:i.get(l.id);u&&u.version>c.version&&(c=wh(c,u.version)),r.has(c.id)&&(c={...c,id:Di()}),r.add(c.id),a.push(c)}}return a},[]);if(!(n!=null&&n.repairBindings))return s;const o=xn(s);for(const a of s)a.frameId&&uae(a,o),Se(a)&&a.containerId?cae(a,o):a.boundElements&&lae(a,o);return s},dae=(t,e,n)=>{const r=e[t];return r!==void 0?r:n[t]},BA={isSidebarDocked:(t,e)=>["defaultSidebarDockedPreference",t.isSidebarDocked??dae("defaultSidebarDockedPreference",t,e)]},FN=(t,e)=>{var i;t=t||{};const n=Es(),r={};for(const s of Object.keys(BA))if(s in t){const[o,a]=BA[s](t,n);r[o]=a}for(const[s,o]of Object.entries(n)){const a=t[s],l=e?e[s]:void 0;r[s]=a!==void 0?a:l!==void 0?l:o}return{...r,cursorButton:(e==null?void 0:e.cursorButton)||"up",penDetected:(e==null?void 0:e.penDetected)??(t.penMode?t.penDetected??!1:!1),activeTool:{...kn(n,r.activeTool.type&&sae[r.activeTool.type]?r.activeTool:{type:"selection"}),lastActiveTool:null,locked:r.activeTool.locked??!1},zoom:typeof t.zoom=="number"?{value:t.zoom}:(i=t.zoom)!=null&&i.value?t.zoom:n.zoom,openSidebar:typeof t.openSidebar=="string"?{name:bd.name}:r.openSidebar}},Jc=(t,e,n,r)=>({elements:Ym(t==null?void 0:t.elements,n,r),appState:FN(t==null?void 0:t.appState,e||null),files:(t==null?void 0:t.files)||{}}),UA=t=>{const e=Ym(yt(t.elements),null);return e.length?{...t,elements:e}:null},BN=(t=[],e)=>{const n=[];for(const r of t)if(Array.isArray(r)){const i=UA({status:e,elements:r,id:Di(),created:Date.now()});i&&n.push(i)}else{const i=r,s=UA({...i,id:i.id||Di(),status:i.status||e,created:i.created||Date.now()});s&&n.push(s)}return n},UN=async t=>{let e;if(t.type===Oe.png)try{return await(await pe(()=>Promise.resolve().then(()=>$y),void 0)).decodePngMetadata(t)}catch(n){throw n.message==="INVALID"?new gc(I("alerts.imageDoesNotContainScene"),"IMAGE_NOT_CONTAINS_SCENE_DATA"):new gc(I("alerts.cannotRestoreFromImage"))}else if("text"in Blob?e=await t.text():e=await new Promise(n=>{const r=new FileReader;r.readAsText(t,"utf8"),r.onloadend=()=>{r.readyState===FileReader.DONE&&n(r.result)}}),t.type===Oe.svg)try{return await(await pe(()=>Promise.resolve().then(()=>$y),void 0)).decodeSvgMetadata({svg:e})}catch(n){throw n.message==="INVALID"?new gc(I("alerts.imageDoesNotContainScene"),"IMAGE_NOT_CONTAINS_SCENE_DATA"):new gc(I("alerts.cannotRestoreFromImage"))}return e},$N=t=>{var e;return t&&((e=t.name.match(/\.(json|excalidraw|png|svg)$/))==null?void 0:e[1])||null},hae=t=>t==="png"||t==="svg",XS=t=>{const e=$N(t);return e==="png"||e==="svg"},Rc=t=>{const{type:e}=t||{};return!!e&&Object.values(kT).includes(e)},HN=async(t,e,n,r)=>{const i=await UN(t);let s;try{try{s=JSON.parse(i)}catch(o){throw Rc(t)?new gc(I("alerts.imageDoesNotContainScene"),"IMAGE_NOT_CONTAINS_SCENE_DATA"):o}if(Eae(s))return{type:Oe.excalidraw,data:Jc({elements:SB(s.elements||[]),appState:{theme:e==null?void 0:e.theme,fileHandle:r||t.handle||null,...gR(s.appState||{}),...e?nm(s.elements||[],e):{}},files:s.files},e,n,{repairBindings:!0,refreshDimensions:!1})};if(VN(s))return{type:Oe.excalidrawlib,data:s};throw new Error(I("alerts.couldNotLoadInvalidFile"))}catch(o){throw o instanceof gc?o:new Error(I("alerts.couldNotLoadInvalidFile"))}},YS=async(t,e,n,r)=>{const i=await HN(t,e,n,r);if(i.type!==Oe.excalidraw)throw new Error(I("alerts.couldNotLoadInvalidFile"));return i.data},zN=(t,e="unpublished")=>{const n=JSON.parse(t);if(!VN(n))throw new Error("Invalid library");const r=n.libraryItems||n.library;return BN(r,e)},fae=async(t,e="unpublished")=>zN(await UN(t),e),sm=async t=>new Promise(async(e,n)=>{try{pR(t)&&(t=await t),t.toBlob(r=>{if(!r)return n(new YQ(I("canvasError.canvasTooBig"),"CANVAS_POSSIBLY_TOO_BIG"));e(r)})}catch(r){n(r)}}),pae=async t=>{try{const e=await window.crypto.subtle.digest("SHA-1",await Wa(t));return dR(new Uint8Array(e))}catch(e){return console.error(e),oS(40)}},E_=async t=>new Promise((e,n)=>{const r=new FileReader;r.onload=()=>{const i=r.result;e(i)},r.onerror=i=>n(i),r.readAsDataURL(t)}),mae=(t,e="")=>{const n=t.indexOf(","),r=atob(t.slice(n+1)),i=t.slice(0,n).split(":")[1].split(";")[0],s=new ArrayBuffer(r.length),o=new Uint8Array(s);for(let a=0;a<r.length;a++)o[a]=r.charCodeAt(a);return new File([s],e,{type:i})},Wx=async(t,e)=>{if(t.type===Oe.svg)return t;const[n,r]=await Promise.all([pe(()=>import("./pica-FQTv14zf.js").then(s=>s.p),__vite__mapDeps([0,1])).then(s=>s.default),pe(()=>import("./image-blob-reduce.esm-1KtB9oda.js"),__vite__mapDeps([])).then(s=>s.default)]),i=r({pica:n({features:["js","wasm"]})});if(e.outputType){const{outputType:s}=e;i._create_blob=function(o){return this.pica.toBlob(o.out_canvas,s,.8).then(a=>(o.out_blob=a,o))}}if(!Rc(t))throw new Error(I("errors.unsupportedFileType"));return new File([await i.toBlob(t,{max:e.maxWidthOrHeight})],t.name,{type:e.outputType||t.type})},$A=(t,e="")=>new File([new TextEncoder().encode(t)],e,{type:Oe.svg}),gae=async(t,e="")=>{let n;try{n=await fetch(t)}catch{throw new Error(I("errors.failedToFetchImage"))}if(!n.ok)throw new Error(I("errors.failedToFetchImage"));const r=await n.blob();if(r.type&&Rc(r)){const i=e||r.name||"";return new File([r],i,{type:r.type})}throw new Error(I("errors.unsupportedFileType"))},yae=async t=>{const e=t.dataTransfer.files.item(0),n=await vae(t);return{file:e?await ZS(e):null,fileHandle:n}},vae=async t=>{if(pu)try{return await t.dataTransfer.items[0].getAsFileSystemHandle()||null}catch(e){return console.warn(e.name,e.message),null}return null},HA=t=>{let e=null;const n=`${[...new Uint8Array(t).slice(0,8)].join(" ")} `,r={png:"137 80 78 71 13 10 26 10 ",jpg:"255 216 255 ",gif:"71 73 70 56 57 97 "};return n===r.png?e=Oe.png:n.startsWith(r.jpg)?e=Oe.jpg:n.startsWith(r.gif)&&(e=Oe.gif),e},lg=(t,e,n)=>new File([t],n||"",{type:e}),ZS=async t=>{var e,n;if(t.type){if(Rc(t)){const r=await Wa(t),i=HA(r);i&&i!==t.type&&(t=lg(r,i,t.name))}}else if((e=t==null?void 0:t.name)!=null&&e.endsWith(".excalidrawlib"))t=lg(await Wa(t),Oe.excalidrawlib,t.name);else if((n=t==null?void 0:t.name)!=null&&n.endsWith(".excalidraw"))t=lg(await Wa(t),Oe.excalidraw,t.name);else{const r=await Wa(t),i=HA(r);i&&(t=lg(r,i,t.name))}return t},Wa=t=>"arrayBuffer"in t?t.arrayBuffer():new Promise((e,n)=>{const r=new FileReader;r.onload=i=>{var s;if(!((s=i.target)!=null&&s.result))return n(new Error("Couldn't convert blob to ArrayBuffer"));e(i.target.result)},r.readAsArrayBuffer(t)}),bae=(t,e)=>{const n={};for(const r of t)!r.isDeleted&&"fileId"in r&&r.fileId&&e[r.fileId]&&(n[r.fileId]=e[r.fileId]);return n},vh=(t,e,n,r)=>{const i={type:ki.excalidraw,version:Mv.excalidraw,source:MT,elements:r==="local"?SB(t):Bde(t),appState:r==="local"?gR(e):EW(e),files:r==="local"?bae(t,n):void 0};return JSON.stringify(i,null,2)},GN=async(t,e,n)=>{const r=vh(t,e,n,"local"),i=new Blob([r],{type:Oe.excalidraw});return{fileHandle:await Ny(i,{name:e.name,extension:"excalidraw",description:"Excalidraw file",fileHandle:XS(e.fileHandle)?null:e.fileHandle})}},_ae=async(t,e)=>{const n=await jS({description:"Excalidraw files"});return YS(await ZS(n),t,e,n.handle)},Eae=t=>(t==null?void 0:t.type)===ki.excalidraw&&(!t.elements||Array.isArray(t.elements)&&(!t.appState||typeof t.appState=="object")),VN=t=>typeof t=="object"&&t&&t.type===ki.excalidrawLibrary&&(t.version===1||t.version===2),WN=t=>{const e={type:ki.excalidrawLibrary,version:Mv.excalidrawLibrary,source:MT,libraryItems:t};return JSON.stringify(e,null,2)},wae=async t=>{const e=WN(t);await Ny(new Blob([e],{type:Oe.excalidrawlib}),{name:"library",extension:"excalidrawlib",description:"Excalidraw library file"})},jN=t=>new Promise((e,n)=>{const r=new Image;r.onload=()=>{e(r)},r.onerror=i=>{n(i)},r.src=t}),XN=async({fileIds:t,files:e,imageCache:n})=>{const r=new Map,i=new Map;return await Promise.all(t.reduce((s,o)=>{const a=e[o];return a&&!r.has(o)?(r.set(o,!0),s.concat((async()=>{try{if(a.mimeType===Oe.binary)throw new Error("Only images can be added to ImageCache");const l=jN(a.dataURL),c={image:l,mimeType:a.mimeType};n.set(o,c);const u=await l;n.set(o,{...c,image:u})}catch{i.set(o,!0)}})())):s},[])),{imageCache:n,updatedFiles:r,erroredFiles:i}},YN=t=>t.filter(e=>En(e)),xae=t=>(t==null?void 0:t.nodeName.toLowerCase())==="svg",Tae=async t=>{const e=new DOMParser().parseFromString(t,Oe.svg),n=e.querySelector("svg");if(e.querySelector("parsererror")||!xae(n))throw new Error(I("errors.invalidSVGString"));if(n.hasAttribute("xmlns")||n.setAttribute("xmlns",Kt),!n.hasAttribute("width")||!n.hasAttribute("height")){const i=n.getAttribute("viewBox");let s=n.getAttribute("width")||"50",o=n.getAttribute("height")||"50";if(i){const a=i.match(/\d+ +\d+ +(\d+) +(\d+)/);a&&([,s,o]=a)}n.setAttribute("width",s),n.setAttribute("height",o)}return n.outerHTML};var w_={VITE_APP_BACKEND_V2_GET_URL:"https://json.excalidraw.com/api/v2/",VITE_APP_BACKEND_V2_POST_URL:"https://json.excalidraw.com/api/v2/post/",VITE_APP_LIBRARY_URL:"https://libraries.excalidraw.com",VITE_APP_LIBRARY_BACKEND:"https://us-central1-excalidraw-room-persistence.cloudfunctions.net/libraries",VITE_APP_PORTAL_URL:"https://portal.excalidraw.com",VITE_APP_PLUS_LP:"https://plus.excalidraw.com",VITE_APP_PLUS_APP:"https://app.excalidraw.com",VITE_APP_AI_BACKEND:"https://oss-ai.excalidraw.com",VITE_APP_WS_SERVER_URL:"",VITE_APP_FIREBASE_CONFIG:'{"apiKey":"AIzaSyAd15pYlMci_xIp9ko6wkEsDzAAA0Dn0RU","authDomain":"excalidraw-room-persistence.firebaseapp.com","databaseURL":"https://excalidraw-room-persistence.firebaseio.com","projectId":"excalidraw-room-persistence","storageBucket":"excalidraw-room-persistence.appspot.com","messagingSenderId":"654800341332","appId":"1:654800341332:web:4a692de832b55bd57ce0c1"}',VITE_APP_DISABLE_TRACKING:"",VITE_APP_GIT_SHA:"",BASE_URL:"/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const Sae="<!-- svg-source:excalidraw -->",ZN=t=>{const e=new bt;return e.replaceAllElements(Hc(t),!1),e},Cae=(t,e)=>{if(t.width<=e)return t;const r=document.createElement("canvas").getContext("2d");r.font=mn({fontFamily:t.fontFamily,fontSize:t.fontSize});let i=t.text;if(r.measureText(i).width>e)for(let o=i.length;o>0;o--){const a=`${i.slice(0,o)}...`;if(r.measureText(a).width<=e){i=a;break}}return Re(t,{text:i,width:e})},Iae=(t,e)=>{const n=[];let r=0,i=0;for(const s of t){if(qe(s)){Wp(s)?r++:i++;let o=Ni({x:s.x,y:s.y-Pt.nameOffsetY,fontFamily:mr.Assistant,fontSize:Pt.nameFontSize,lineHeight:Pt.nameLineHeight,strokeColor:e.exportWithDarkMode?Pt.nameColorDarkTheme:Pt.nameColorLightTheme,text:dB(s,Wp(s)?r:i)});o.y-=o.height,o=Cae(o,s.width),n.push(o)}n.push(s)}return n},KN=(t,e)=>(e=e||Es().frameRendering,{enabled:t?!0:e.enabled,outline:t?!1:e.outline,name:t?!1:e.name,clip:t?!0:e.clip}),qN=({elements:t,exportingFrame:e,frameRendering:n,exportWithDarkMode:r})=>{let i;return e?i=a4({elements:t,bounds:e,type:"overlap"}):n.enabled&&n.name?i=Iae(t,{exportWithDarkMode:r}):i=t,i},JN=async(t,e,n,{exportBackground:r,exportPadding:i=oh,viewBackgroundColor:s,exportingFrame:o},a=(l,c)=>{const u=document.createElement("canvas");return u.width=l*e.exportScale,u.height=c*e.exportScale,{canvas:u,scale:e.exportScale}})=>{const l=ZN(t);t=l.getNonDeletedElements();const c=KN(o??null,e.frameRendering??null),u=qN({elements:t,exportingFrame:o,exportWithDarkMode:e.exportWithDarkMode,frameRendering:c});o&&(i=0);const[d,h,f,p]=qS(o?[o]:lB(u),i),{canvas:m,scale:v=1}=a(f,p),y=Es(),{imageCache:b}=await XN({imageCache:new Map,fileIds:YN(u).map(_=>_.fileId),files:n});return pD({canvas:m,rc:Ll.canvas(m),elements:u,visibleElements:u,scale:v,appState:{...e,frameRendering:c,viewBackgroundColor:r?s:null,scrollX:-d+i,scrollY:-h+i,zoom:y.zoom,shouldCacheIgnoreZoom:!1,theme:e.exportWithDarkMode?"dark":"light"},renderConfig:{canvasBackgroundColor:s,imageCache:b,renderGrid:!1,isExporting:!0,webGLEnabled:!1}}),l.destroy(),m},KS=async(t,e,n,r)=>{const i=ZN(t);t=i.getNonDeletedElements();const s=KN((r==null?void 0:r.exportingFrame)??null,e.frameRendering??null);let{exportPadding:o=oh,exportWithDarkMode:a=!1,viewBackgroundColor:l,exportScale:c=1,exportEmbedScene:u}=e;const{exportingFrame:d=null}=r||{},h=qN({elements:t,exportingFrame:d,exportWithDarkMode:a,frameRendering:s});d&&(o=0);let f="";if(u)try{f=await(await pe(()=>Promise.resolve().then(()=>$y),void 0)).encodeSvgMetadata({text:vh(t,e,n||{},"local")})}catch(k){console.error(k)}const[p,m,v,y]=qS(d?[d]:lB(h),o),b=document.createElementNS(Kt,"svg");b.setAttribute("version","1.1"),b.setAttribute("xmlns",Kt),b.setAttribute("viewBox",`0 0 ${v} ${y}`),b.setAttribute("width",`${v*c}`),b.setAttribute("height",`${y*c}`),a&&b.setAttribute("filter",PT);let _="https://excalidraw.com/";w_.VITE_IS_EXCALIDRAW_NPM_PACKAGE&&(_=window.EXCALIDRAW_ASSET_PATH||`https://unpkg.com/${w_.VITE_PKG_NAME}@${w_.PKG_VERSION}`,_!=null&&_.startsWith("/")&&(_=_.replace("/",`${window.location.origin}/`)),_=`${_}/dist/excalidraw-assets/`);const E=-p+o,w=-m+o,x=l4(t);let T="";for(const k of x){const[L,F,N,R]=Ve(k),H=(N-L)/2-(k.x-L),W=(R-F)/2-(k.y-F);T+=`<clipPath id=${k.id}>
            <rect transform="translate(${k.x+E} ${k.y+w}) rotate(${k.angle} ${H} ${W})"
          width="${k.width}"
          height="${k.height}"
          >
          </rect>
        </clipPath>`}if(b.innerHTML=`
  ${Sae}
  ${f}
  <defs>
    <style class="style-fonts">
      @font-face {
        font-family: "Virgil";
        src: url("${_}Virgil.woff2");
      }
      @font-face {
        font-family: "Cascadia";
        src: url("${_}Cascadia.woff2");
      }
      @font-face {
        font-family: "Assistant";
        src: url("${_}Assistant-Regular.woff2");
      }
    </style>
    ${T}
  </defs>
  `,e.exportBackground&&l){const k=b.ownerDocument.createElementNS(Kt,"rect");k.setAttribute("x","0"),k.setAttribute("y","0"),k.setAttribute("width",`${v}`),k.setAttribute("height",`${y}`),k.setAttribute("fill",l),b.appendChild(k)}const C=Ll.svg(b);return Ine(h,C,b,n||{},{offsetX:E,offsetY:w,isExporting:!0,exportWithDarkMode:a,renderEmbeddables:(r==null?void 0:r.renderEmbeddables)??!1,frameRendering:s,canvasBackgroundColor:l,webGLEnabled:!1}),i.destroy(),b},qS=(t,e)=>{const[n,r,i,s]=Ut(t),o=fr(n,i)+e*2,a=fr(r,s)+e*2;return[n,r,o,a]},Aae=(t,e,n)=>{const[,,r,i]=qS(t,e).map(s=>Math.trunc(s*n));return[r,i]};var JS={};(function(t){(function(e){e(typeof DO_NOT_EXPORT_CRC>"u"?t:{})})(function(e){e.version="0.3.0";function n(){for(var c=0,u=new Array(256),d=0;d!=256;++d)c=d,c=c&1?-306674912^c>>>1:c>>>1,c=c&1?-306674912^c>>>1:c>>>1,c=c&1?-306674912^c>>>1:c>>>1,c=c&1?-306674912^c>>>1:c>>>1,c=c&1?-306674912^c>>>1:c>>>1,c=c&1?-306674912^c>>>1:c>>>1,c=c&1?-306674912^c>>>1:c>>>1,c=c&1?-306674912^c>>>1:c>>>1,u[d]=c;return typeof Int32Array<"u"?new Int32Array(u):u}var r=n(),i=typeof Buffer<"u";function s(c){if(c.length>32768&&i)return a(new Buffer(c));for(var u=-1,d=c.length-1,h=0;h<d;)u=r[(u^c.charCodeAt(h++))&255]^u>>>8,u=r[(u^c.charCodeAt(h++))&255]^u>>>8;return h===d&&(u=u>>>8^r[(u^c.charCodeAt(h))&255]),u^-1}function o(c){if(c.length>1e4)return a(c);for(var u=-1,d=0,h=c.length-3;d<h;)u=u>>>8^r[(u^c[d++])&255],u=u>>>8^r[(u^c[d++])&255],u=u>>>8^r[(u^c[d++])&255],u=u>>>8^r[(u^c[d++])&255];for(;d<h+3;)u=u>>>8^r[(u^c[d++])&255];return u^-1}function a(c){for(var u=-1,d=0,h=c.length-7;d<h;)u=u>>>8^r[(u^c[d++])&255],u=u>>>8^r[(u^c[d++])&255],u=u>>>8^r[(u^c[d++])&255],u=u>>>8^r[(u^c[d++])&255],u=u>>>8^r[(u^c[d++])&255],u=u>>>8^r[(u^c[d++])&255],u=u>>>8^r[(u^c[d++])&255],u=u>>>8^r[(u^c[d++])&255];for(;d<h+7;)u=u>>>8^r[(u^c[d++])&255];return u^-1}function l(c){for(var u=-1,d=0,h=c.length,f,p;d<h;)f=c.charCodeAt(d++),f<128?u=u>>>8^r[(u^f)&255]:f<2048?(u=u>>>8^r[(u^(192|f>>6&31))&255],u=u>>>8^r[(u^(128|f&63))&255]):f>=55296&&f<57344?(f=(f&1023)+64,p=c.charCodeAt(d++)&1023,u=u>>>8^r[(u^(240|f>>8&7))&255],u=u>>>8^r[(u^(128|f>>2&63))&255],u=u>>>8^r[(u^(128|p>>6&15|f&3))&255],u=u>>>8^r[(u^(128|p&63))&255]):(u=u>>>8^r[(u^(224|f>>12&15))&255],u=u>>>8^r[(u^(128|f>>6&63))&255],u=u>>>8^r[(u^(128|f&63))&255]);return u^-1}e.table=r,e.bstr=s,e.buf=o,e.str=l})})(JS);var kae=JS,Mae=Rae,Gs=new Uint8Array(4),Pae=new Int32Array(Gs.buffer),Lae=new Uint32Array(Gs.buffer);function Rae(t){if(t[0]!==137)throw new Error("Invalid .png file header");if(t[1]!==80)throw new Error("Invalid .png file header");if(t[2]!==78)throw new Error("Invalid .png file header");if(t[3]!==71)throw new Error("Invalid .png file header");if(t[4]!==13)throw new Error("Invalid .png file header: possibly caused by DOS-Unix line ending conversion?");if(t[5]!==10)throw new Error("Invalid .png file header: possibly caused by DOS-Unix line ending conversion?");if(t[6]!==26)throw new Error("Invalid .png file header");if(t[7]!==10)throw new Error("Invalid .png file header: possibly caused by DOS-Unix line ending conversion?");for(var e=!1,n=[],r=8;r<t.length;){Gs[3]=t[r++],Gs[2]=t[r++],Gs[1]=t[r++],Gs[0]=t[r++];var i=Lae[0]+4,s=new Uint8Array(i);s[0]=t[r++],s[1]=t[r++],s[2]=t[r++],s[3]=t[r++];var o=String.fromCharCode(s[0])+String.fromCharCode(s[1])+String.fromCharCode(s[2])+String.fromCharCode(s[3]);if(!n.length&&o!=="IHDR")throw new Error("IHDR header missing");if(o==="IEND"){e=!0,n.push({name:o,data:new Uint8Array(0)});break}for(var a=4;a<i;a++)s[a]=t[r++];Gs[3]=t[r++],Gs[2]=t[r++],Gs[1]=t[r++],Gs[0]=t[r++];var l=Pae[0],c=kae.buf(s);if(c!==l)throw new Error("CRC values for "+o+" header do not match, PNG file is likely corrupted");var u=new Uint8Array(s.buffer.slice(4));n.push({name:o,data:u})}if(!e)throw new Error(".png file ended prematurely: no IEND header was found");return n}const QN=aa(Mae);var f2={},Oae=Dae;function Dae(t,e){if(t=String(t),e=String(e),!/^[\x00-\xFF]+$/.test(t)||!/^[\x00-\xFF]+$/.test(e))throw new Error("Only Latin-1 characters are permitted in PNG tEXt chunks. You might want to consider base64 encoding and/or zEXt compression");if(t.length>=80)throw new Error('Keyword "'+t+'" is longer than the 79-character limit imposed by the PNG specification');for(var n=t.length+e.length+1,r=new Uint8Array(n),i=0,s,o=0;o<t.length;o++){if(!(s=t.charCodeAt(o)))throw new Error("0x00 character is not permitted in tEXt keywords");r[i++]=s}r[i++]=0;for(var a=0;a<e.length;a++){if(!(s=e.charCodeAt(a)))throw new Error("0x00 character is not permitted in tEXt content");r[i++]=s}return{name:"tEXt",data:r}}var Nae=Fae;function Fae(t){t.data&&t.name&&(t=t.data);for(var e=!0,n="",r="",i=0;i<t.length;i++){var s=t[i];if(e)s?r+=String.fromCharCode(s):e=!1;else if(s)n+=String.fromCharCode(s);else throw new Error("Invalid NULL character found. 0x00 character is not permitted in tEXt content")}return{keyword:r,text:n}}f2.encode=Oae;f2.decode=Nae;var Bae=function(t,e,n){var r=[],i=t.length;if(i===0)return r;var s=e<0?Math.max(0,e+i):e||0;for(n!==void 0&&(i=n<0?n+i:n);i-- >s;)r[i-s]=t[i];return r},Uae=Bae,$ae=JS,Hae=Vae,Vs=new Uint8Array(4),zae=new Int32Array(Vs.buffer),Gae=new Uint32Array(Vs.buffer);function Vae(t){var e=8,n=e,r;for(r=0;r<t.length;r++)e+=t[r].data.length,e+=12;var i=new Uint8Array(e);for(i[0]=137,i[1]=80,i[2]=78,i[3]=71,i[4]=13,i[5]=10,i[6]=26,i[7]=10,r=0;r<t.length;r++){var s=t[r],o=s.name,a=s.data,l=a.length,c=[o.charCodeAt(0),o.charCodeAt(1),o.charCodeAt(2),o.charCodeAt(3)];Gae[0]=l,i[n++]=Vs[3],i[n++]=Vs[2],i[n++]=Vs[1],i[n++]=Vs[0],i[n++]=c[0],i[n++]=c[1],i[n++]=c[2],i[n++]=c[3];for(var u=0;u<l;)i[n++]=a[u++];var d=c.concat(Uae(a)),h=$ae.buf(d);zae[0]=h,i[n++]=Vs[3],i[n++]=Vs[2],i[n++]=Vs[1],i[n++]=Vs[0]}return i}const Wae=aa(Hae);var fa={};(function(t){var e=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Int32Array<"u";function n(s,o){return Object.prototype.hasOwnProperty.call(s,o)}t.assign=function(s){for(var o=Array.prototype.slice.call(arguments,1);o.length;){var a=o.shift();if(a){if(typeof a!="object")throw new TypeError(a+"must be non-object");for(var l in a)n(a,l)&&(s[l]=a[l])}}return s},t.shrinkBuf=function(s,o){return s.length===o?s:s.subarray?s.subarray(0,o):(s.length=o,s)};var r={arraySet:function(s,o,a,l,c){if(o.subarray&&s.subarray){s.set(o.subarray(a,a+l),c);return}for(var u=0;u<l;u++)s[c+u]=o[a+u]},flattenChunks:function(s){var o,a,l,c,u,d;for(l=0,o=0,a=s.length;o<a;o++)l+=s[o].length;for(d=new Uint8Array(l),c=0,o=0,a=s.length;o<a;o++)u=s[o],d.set(u,c),c+=u.length;return d}},i={arraySet:function(s,o,a,l,c){for(var u=0;u<l;u++)s[c+u]=o[a+u]},flattenChunks:function(s){return[].concat.apply([],s)}};t.setTyped=function(s){s?(t.Buf8=Uint8Array,t.Buf16=Uint16Array,t.Buf32=Int32Array,t.assign(t,r)):(t.Buf8=Array,t.Buf16=Array,t.Buf32=Array,t.assign(t,i))},t.setTyped(e)})(fa);var Zm={},yo={},bh={},jae=fa,Xae=4,zA=0,GA=1,Yae=2;function _h(t){for(var e=t.length;--e>=0;)t[e]=0}var Zae=0,eF=1,Kae=2,qae=3,Jae=258,QS=29,Km=256,om=Km+1+QS,Id=30,e4=19,tF=2*om+1,_c=15,x_=16,Qae=7,t4=256,nF=16,rF=17,iF=18,jx=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],l0=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],ele=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],sF=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],tle=512,Ro=new Array((om+2)*2);_h(Ro);var np=new Array(Id*2);_h(np);var am=new Array(tle);_h(am);var lm=new Array(Jae-qae+1);_h(lm);var n4=new Array(QS);_h(n4);var Fy=new Array(Id);_h(Fy);function T_(t,e,n,r,i){this.static_tree=t,this.extra_bits=e,this.extra_base=n,this.elems=r,this.max_length=i,this.has_stree=t&&t.length}var oF,aF,lF;function S_(t,e){this.dyn_tree=t,this.max_code=0,this.stat_desc=e}function cF(t){return t<256?am[t]:am[256+(t>>>7)]}function cm(t,e){t.pending_buf[t.pending++]=e&255,t.pending_buf[t.pending++]=e>>>8&255}function Gr(t,e,n){t.bi_valid>x_-n?(t.bi_buf|=e<<t.bi_valid&65535,cm(t,t.bi_buf),t.bi_buf=e>>x_-t.bi_valid,t.bi_valid+=n-x_):(t.bi_buf|=e<<t.bi_valid&65535,t.bi_valid+=n)}function Qs(t,e,n){Gr(t,n[e*2],n[e*2+1])}function uF(t,e){var n=0;do n|=t&1,t>>>=1,n<<=1;while(--e>0);return n>>>1}function nle(t){t.bi_valid===16?(cm(t,t.bi_buf),t.bi_buf=0,t.bi_valid=0):t.bi_valid>=8&&(t.pending_buf[t.pending++]=t.bi_buf&255,t.bi_buf>>=8,t.bi_valid-=8)}function rle(t,e){var n=e.dyn_tree,r=e.max_code,i=e.stat_desc.static_tree,s=e.stat_desc.has_stree,o=e.stat_desc.extra_bits,a=e.stat_desc.extra_base,l=e.stat_desc.max_length,c,u,d,h,f,p,m=0;for(h=0;h<=_c;h++)t.bl_count[h]=0;for(n[t.heap[t.heap_max]*2+1]=0,c=t.heap_max+1;c<tF;c++)u=t.heap[c],h=n[n[u*2+1]*2+1]+1,h>l&&(h=l,m++),n[u*2+1]=h,!(u>r)&&(t.bl_count[h]++,f=0,u>=a&&(f=o[u-a]),p=n[u*2],t.opt_len+=p*(h+f),s&&(t.static_len+=p*(i[u*2+1]+f)));if(m!==0){do{for(h=l-1;t.bl_count[h]===0;)h--;t.bl_count[h]--,t.bl_count[h+1]+=2,t.bl_count[l]--,m-=2}while(m>0);for(h=l;h!==0;h--)for(u=t.bl_count[h];u!==0;)d=t.heap[--c],!(d>r)&&(n[d*2+1]!==h&&(t.opt_len+=(h-n[d*2+1])*n[d*2],n[d*2+1]=h),u--)}}function dF(t,e,n){var r=new Array(_c+1),i=0,s,o;for(s=1;s<=_c;s++)r[s]=i=i+n[s-1]<<1;for(o=0;o<=e;o++){var a=t[o*2+1];a!==0&&(t[o*2]=uF(r[a]++,a))}}function ile(){var t,e,n,r,i,s=new Array(_c+1);for(n=0,r=0;r<QS-1;r++)for(n4[r]=n,t=0;t<1<<jx[r];t++)lm[n++]=r;for(lm[n-1]=r,i=0,r=0;r<16;r++)for(Fy[r]=i,t=0;t<1<<l0[r];t++)am[i++]=r;for(i>>=7;r<Id;r++)for(Fy[r]=i<<7,t=0;t<1<<l0[r]-7;t++)am[256+i++]=r;for(e=0;e<=_c;e++)s[e]=0;for(t=0;t<=143;)Ro[t*2+1]=8,t++,s[8]++;for(;t<=255;)Ro[t*2+1]=9,t++,s[9]++;for(;t<=279;)Ro[t*2+1]=7,t++,s[7]++;for(;t<=287;)Ro[t*2+1]=8,t++,s[8]++;for(dF(Ro,om+1,s),t=0;t<Id;t++)np[t*2+1]=5,np[t*2]=uF(t,5);oF=new T_(Ro,jx,Km+1,om,_c),aF=new T_(np,l0,0,Id,_c),lF=new T_(new Array(0),ele,0,e4,Qae)}function hF(t){var e;for(e=0;e<om;e++)t.dyn_ltree[e*2]=0;for(e=0;e<Id;e++)t.dyn_dtree[e*2]=0;for(e=0;e<e4;e++)t.bl_tree[e*2]=0;t.dyn_ltree[t4*2]=1,t.opt_len=t.static_len=0,t.last_lit=t.matches=0}function fF(t){t.bi_valid>8?cm(t,t.bi_buf):t.bi_valid>0&&(t.pending_buf[t.pending++]=t.bi_buf),t.bi_buf=0,t.bi_valid=0}function sle(t,e,n,r){fF(t),r&&(cm(t,n),cm(t,~n)),jae.arraySet(t.pending_buf,t.window,e,n,t.pending),t.pending+=n}function VA(t,e,n,r){var i=e*2,s=n*2;return t[i]<t[s]||t[i]===t[s]&&r[e]<=r[n]}function C_(t,e,n){for(var r=t.heap[n],i=n<<1;i<=t.heap_len&&(i<t.heap_len&&VA(e,t.heap[i+1],t.heap[i],t.depth)&&i++,!VA(e,r,t.heap[i],t.depth));)t.heap[n]=t.heap[i],n=i,i<<=1;t.heap[n]=r}function WA(t,e,n){var r,i,s=0,o,a;if(t.last_lit!==0)do r=t.pending_buf[t.d_buf+s*2]<<8|t.pending_buf[t.d_buf+s*2+1],i=t.pending_buf[t.l_buf+s],s++,r===0?Qs(t,i,e):(o=lm[i],Qs(t,o+Km+1,e),a=jx[o],a!==0&&(i-=n4[o],Gr(t,i,a)),r--,o=cF(r),Qs(t,o,n),a=l0[o],a!==0&&(r-=Fy[o],Gr(t,r,a)));while(s<t.last_lit);Qs(t,t4,e)}function Xx(t,e){var n=e.dyn_tree,r=e.stat_desc.static_tree,i=e.stat_desc.has_stree,s=e.stat_desc.elems,o,a,l=-1,c;for(t.heap_len=0,t.heap_max=tF,o=0;o<s;o++)n[o*2]!==0?(t.heap[++t.heap_len]=l=o,t.depth[o]=0):n[o*2+1]=0;for(;t.heap_len<2;)c=t.heap[++t.heap_len]=l<2?++l:0,n[c*2]=1,t.depth[c]=0,t.opt_len--,i&&(t.static_len-=r[c*2+1]);for(e.max_code=l,o=t.heap_len>>1;o>=1;o--)C_(t,n,o);c=s;do o=t.heap[1],t.heap[1]=t.heap[t.heap_len--],C_(t,n,1),a=t.heap[1],t.heap[--t.heap_max]=o,t.heap[--t.heap_max]=a,n[c*2]=n[o*2]+n[a*2],t.depth[c]=(t.depth[o]>=t.depth[a]?t.depth[o]:t.depth[a])+1,n[o*2+1]=n[a*2+1]=c,t.heap[1]=c++,C_(t,n,1);while(t.heap_len>=2);t.heap[--t.heap_max]=t.heap[1],rle(t,e),dF(n,l,t.bl_count)}function jA(t,e,n){var r,i=-1,s,o=e[0*2+1],a=0,l=7,c=4;for(o===0&&(l=138,c=3),e[(n+1)*2+1]=65535,r=0;r<=n;r++)s=o,o=e[(r+1)*2+1],!(++a<l&&s===o)&&(a<c?t.bl_tree[s*2]+=a:s!==0?(s!==i&&t.bl_tree[s*2]++,t.bl_tree[nF*2]++):a<=10?t.bl_tree[rF*2]++:t.bl_tree[iF*2]++,a=0,i=s,o===0?(l=138,c=3):s===o?(l=6,c=3):(l=7,c=4))}function XA(t,e,n){var r,i=-1,s,o=e[0*2+1],a=0,l=7,c=4;for(o===0&&(l=138,c=3),r=0;r<=n;r++)if(s=o,o=e[(r+1)*2+1],!(++a<l&&s===o)){if(a<c)do Qs(t,s,t.bl_tree);while(--a!==0);else s!==0?(s!==i&&(Qs(t,s,t.bl_tree),a--),Qs(t,nF,t.bl_tree),Gr(t,a-3,2)):a<=10?(Qs(t,rF,t.bl_tree),Gr(t,a-3,3)):(Qs(t,iF,t.bl_tree),Gr(t,a-11,7));a=0,i=s,o===0?(l=138,c=3):s===o?(l=6,c=3):(l=7,c=4)}}function ole(t){var e;for(jA(t,t.dyn_ltree,t.l_desc.max_code),jA(t,t.dyn_dtree,t.d_desc.max_code),Xx(t,t.bl_desc),e=e4-1;e>=3&&t.bl_tree[sF[e]*2+1]===0;e--);return t.opt_len+=3*(e+1)+5+5+4,e}function ale(t,e,n,r){var i;for(Gr(t,e-257,5),Gr(t,n-1,5),Gr(t,r-4,4),i=0;i<r;i++)Gr(t,t.bl_tree[sF[i]*2+1],3);XA(t,t.dyn_ltree,e-1),XA(t,t.dyn_dtree,n-1)}function lle(t){var e=4093624447,n;for(n=0;n<=31;n++,e>>>=1)if(e&1&&t.dyn_ltree[n*2]!==0)return zA;if(t.dyn_ltree[9*2]!==0||t.dyn_ltree[10*2]!==0||t.dyn_ltree[13*2]!==0)return GA;for(n=32;n<Km;n++)if(t.dyn_ltree[n*2]!==0)return GA;return zA}var YA=!1;function cle(t){YA||(ile(),YA=!0),t.l_desc=new S_(t.dyn_ltree,oF),t.d_desc=new S_(t.dyn_dtree,aF),t.bl_desc=new S_(t.bl_tree,lF),t.bi_buf=0,t.bi_valid=0,hF(t)}function pF(t,e,n,r){Gr(t,(Zae<<1)+(r?1:0),3),sle(t,e,n,!0)}function ule(t){Gr(t,eF<<1,3),Qs(t,t4,Ro),nle(t)}function dle(t,e,n,r){var i,s,o=0;t.level>0?(t.strm.data_type===Yae&&(t.strm.data_type=lle(t)),Xx(t,t.l_desc),Xx(t,t.d_desc),o=ole(t),i=t.opt_len+3+7>>>3,s=t.static_len+3+7>>>3,s<=i&&(i=s)):i=s=n+5,n+4<=i&&e!==-1?pF(t,e,n,r):t.strategy===Xae||s===i?(Gr(t,(eF<<1)+(r?1:0),3),WA(t,Ro,np)):(Gr(t,(Kae<<1)+(r?1:0),3),ale(t,t.l_desc.max_code+1,t.d_desc.max_code+1,o+1),WA(t,t.dyn_ltree,t.dyn_dtree)),hF(t),r&&fF(t)}function hle(t,e,n){return t.pending_buf[t.d_buf+t.last_lit*2]=e>>>8&255,t.pending_buf[t.d_buf+t.last_lit*2+1]=e&255,t.pending_buf[t.l_buf+t.last_lit]=n&255,t.last_lit++,e===0?t.dyn_ltree[n*2]++:(t.matches++,e--,t.dyn_ltree[(lm[n]+Km+1)*2]++,t.dyn_dtree[cF(e)*2]++),t.last_lit===t.lit_bufsize-1}bh._tr_init=cle;bh._tr_stored_block=pF;bh._tr_flush_block=dle;bh._tr_tally=hle;bh._tr_align=ule;function fle(t,e,n,r){for(var i=t&65535|0,s=t>>>16&65535|0,o=0;n!==0;){o=n>2e3?2e3:n,n-=o;do i=i+e[r++]|0,s=s+i|0;while(--o);i%=65521,s%=65521}return i|s<<16|0}var mF=fle;function ple(){for(var t,e=[],n=0;n<256;n++){t=n;for(var r=0;r<8;r++)t=t&1?3988292384^t>>>1:t>>>1;e[n]=t}return e}var mle=ple();function gle(t,e,n,r){var i=mle,s=r+n;t^=-1;for(var o=r;o<s;o++)t=t>>>8^i[(t^e[o])&255];return t^-1}var gF=gle,r4={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},Mr=fa,Pi=bh,yF=mF,wa=gF,yle=r4,mu=0,vle=1,ble=3,ll=4,ZA=5,eo=0,KA=1,Li=-2,_le=-3,I_=-5,Ele=-1,wle=1,cg=2,xle=3,Tle=4,Sle=0,Cle=2,p2=8,Ile=9,Ale=15,kle=8,Mle=29,Ple=256,Yx=Ple+1+Mle,Lle=30,Rle=19,Ole=2*Yx+1,Dle=15,lt=3,ja=258,ys=ja+lt+1,Nle=32,m2=42,Zx=69,c0=73,u0=91,d0=103,Ec=113,kf=666,Mn=1,qm=2,Qc=3,Eh=4,Fle=3;function Xa(t,e){return t.msg=yle[e],e}function qA(t){return(t<<1)-(t>4?9:0)}function Ra(t){for(var e=t.length;--e>=0;)t[e]=0}function xa(t){var e=t.state,n=e.pending;n>t.avail_out&&(n=t.avail_out),n!==0&&(Mr.arraySet(t.output,e.pending_buf,e.pending_out,n,t.next_out),t.next_out+=n,e.pending_out+=n,t.total_out+=n,t.avail_out-=n,e.pending-=n,e.pending===0&&(e.pending_out=0))}function er(t,e){Pi._tr_flush_block(t,t.block_start>=0?t.block_start:-1,t.strstart-t.block_start,e),t.block_start=t.strstart,xa(t.strm)}function ft(t,e){t.pending_buf[t.pending++]=e}function Qh(t,e){t.pending_buf[t.pending++]=e>>>8&255,t.pending_buf[t.pending++]=e&255}function Ble(t,e,n,r){var i=t.avail_in;return i>r&&(i=r),i===0?0:(t.avail_in-=i,Mr.arraySet(e,t.input,t.next_in,i,n),t.state.wrap===1?t.adler=yF(t.adler,e,i,n):t.state.wrap===2&&(t.adler=wa(t.adler,e,i,n)),t.next_in+=i,t.total_in+=i,i)}function vF(t,e){var n=t.max_chain_length,r=t.strstart,i,s,o=t.prev_length,a=t.nice_match,l=t.strstart>t.w_size-ys?t.strstart-(t.w_size-ys):0,c=t.window,u=t.w_mask,d=t.prev,h=t.strstart+ja,f=c[r+o-1],p=c[r+o];t.prev_length>=t.good_match&&(n>>=2),a>t.lookahead&&(a=t.lookahead);do if(i=e,!(c[i+o]!==p||c[i+o-1]!==f||c[i]!==c[r]||c[++i]!==c[r+1])){r+=2,i++;do;while(c[++r]===c[++i]&&c[++r]===c[++i]&&c[++r]===c[++i]&&c[++r]===c[++i]&&c[++r]===c[++i]&&c[++r]===c[++i]&&c[++r]===c[++i]&&c[++r]===c[++i]&&r<h);if(s=ja-(h-r),r=h-ja,s>o){if(t.match_start=e,o=s,s>=a)break;f=c[r+o-1],p=c[r+o]}}while((e=d[e&u])>l&&--n!==0);return o<=t.lookahead?o:t.lookahead}function eu(t){var e=t.w_size,n,r,i,s,o;do{if(s=t.window_size-t.lookahead-t.strstart,t.strstart>=e+(e-ys)){Mr.arraySet(t.window,t.window,e,e,0),t.match_start-=e,t.strstart-=e,t.block_start-=e,r=t.hash_size,n=r;do i=t.head[--n],t.head[n]=i>=e?i-e:0;while(--r);r=e,n=r;do i=t.prev[--n],t.prev[n]=i>=e?i-e:0;while(--r);s+=e}if(t.strm.avail_in===0)break;if(r=Ble(t.strm,t.window,t.strstart+t.lookahead,s),t.lookahead+=r,t.lookahead+t.insert>=lt)for(o=t.strstart-t.insert,t.ins_h=t.window[o],t.ins_h=(t.ins_h<<t.hash_shift^t.window[o+1])&t.hash_mask;t.insert&&(t.ins_h=(t.ins_h<<t.hash_shift^t.window[o+lt-1])&t.hash_mask,t.prev[o&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=o,o++,t.insert--,!(t.lookahead+t.insert<lt)););}while(t.lookahead<ys&&t.strm.avail_in!==0)}function Ule(t,e){var n=65535;for(n>t.pending_buf_size-5&&(n=t.pending_buf_size-5);;){if(t.lookahead<=1){if(eu(t),t.lookahead===0&&e===mu)return Mn;if(t.lookahead===0)break}t.strstart+=t.lookahead,t.lookahead=0;var r=t.block_start+n;if((t.strstart===0||t.strstart>=r)&&(t.lookahead=t.strstart-r,t.strstart=r,er(t,!1),t.strm.avail_out===0)||t.strstart-t.block_start>=t.w_size-ys&&(er(t,!1),t.strm.avail_out===0))return Mn}return t.insert=0,e===ll?(er(t,!0),t.strm.avail_out===0?Qc:Eh):(t.strstart>t.block_start&&(er(t,!1),t.strm.avail_out===0),Mn)}function A_(t,e){for(var n,r;;){if(t.lookahead<ys){if(eu(t),t.lookahead<ys&&e===mu)return Mn;if(t.lookahead===0)break}if(n=0,t.lookahead>=lt&&(t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+lt-1])&t.hash_mask,n=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart),n!==0&&t.strstart-n<=t.w_size-ys&&(t.match_length=vF(t,n)),t.match_length>=lt)if(r=Pi._tr_tally(t,t.strstart-t.match_start,t.match_length-lt),t.lookahead-=t.match_length,t.match_length<=t.max_lazy_match&&t.lookahead>=lt){t.match_length--;do t.strstart++,t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+lt-1])&t.hash_mask,n=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart;while(--t.match_length!==0);t.strstart++}else t.strstart+=t.match_length,t.match_length=0,t.ins_h=t.window[t.strstart],t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+1])&t.hash_mask;else r=Pi._tr_tally(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++;if(r&&(er(t,!1),t.strm.avail_out===0))return Mn}return t.insert=t.strstart<lt-1?t.strstart:lt-1,e===ll?(er(t,!0),t.strm.avail_out===0?Qc:Eh):t.last_lit&&(er(t,!1),t.strm.avail_out===0)?Mn:qm}function Cu(t,e){for(var n,r,i;;){if(t.lookahead<ys){if(eu(t),t.lookahead<ys&&e===mu)return Mn;if(t.lookahead===0)break}if(n=0,t.lookahead>=lt&&(t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+lt-1])&t.hash_mask,n=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart),t.prev_length=t.match_length,t.prev_match=t.match_start,t.match_length=lt-1,n!==0&&t.prev_length<t.max_lazy_match&&t.strstart-n<=t.w_size-ys&&(t.match_length=vF(t,n),t.match_length<=5&&(t.strategy===wle||t.match_length===lt&&t.strstart-t.match_start>4096)&&(t.match_length=lt-1)),t.prev_length>=lt&&t.match_length<=t.prev_length){i=t.strstart+t.lookahead-lt,r=Pi._tr_tally(t,t.strstart-1-t.prev_match,t.prev_length-lt),t.lookahead-=t.prev_length-1,t.prev_length-=2;do++t.strstart<=i&&(t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+lt-1])&t.hash_mask,n=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart);while(--t.prev_length!==0);if(t.match_available=0,t.match_length=lt-1,t.strstart++,r&&(er(t,!1),t.strm.avail_out===0))return Mn}else if(t.match_available){if(r=Pi._tr_tally(t,0,t.window[t.strstart-1]),r&&er(t,!1),t.strstart++,t.lookahead--,t.strm.avail_out===0)return Mn}else t.match_available=1,t.strstart++,t.lookahead--}return t.match_available&&(r=Pi._tr_tally(t,0,t.window[t.strstart-1]),t.match_available=0),t.insert=t.strstart<lt-1?t.strstart:lt-1,e===ll?(er(t,!0),t.strm.avail_out===0?Qc:Eh):t.last_lit&&(er(t,!1),t.strm.avail_out===0)?Mn:qm}function $le(t,e){for(var n,r,i,s,o=t.window;;){if(t.lookahead<=ja){if(eu(t),t.lookahead<=ja&&e===mu)return Mn;if(t.lookahead===0)break}if(t.match_length=0,t.lookahead>=lt&&t.strstart>0&&(i=t.strstart-1,r=o[i],r===o[++i]&&r===o[++i]&&r===o[++i])){s=t.strstart+ja;do;while(r===o[++i]&&r===o[++i]&&r===o[++i]&&r===o[++i]&&r===o[++i]&&r===o[++i]&&r===o[++i]&&r===o[++i]&&i<s);t.match_length=ja-(s-i),t.match_length>t.lookahead&&(t.match_length=t.lookahead)}if(t.match_length>=lt?(n=Pi._tr_tally(t,1,t.match_length-lt),t.lookahead-=t.match_length,t.strstart+=t.match_length,t.match_length=0):(n=Pi._tr_tally(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++),n&&(er(t,!1),t.strm.avail_out===0))return Mn}return t.insert=0,e===ll?(er(t,!0),t.strm.avail_out===0?Qc:Eh):t.last_lit&&(er(t,!1),t.strm.avail_out===0)?Mn:qm}function Hle(t,e){for(var n;;){if(t.lookahead===0&&(eu(t),t.lookahead===0)){if(e===mu)return Mn;break}if(t.match_length=0,n=Pi._tr_tally(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++,n&&(er(t,!1),t.strm.avail_out===0))return Mn}return t.insert=0,e===ll?(er(t,!0),t.strm.avail_out===0?Qc:Eh):t.last_lit&&(er(t,!1),t.strm.avail_out===0)?Mn:qm}function Ls(t,e,n,r,i){this.good_length=t,this.max_lazy=e,this.nice_length=n,this.max_chain=r,this.func=i}var ud;ud=[new Ls(0,0,0,0,Ule),new Ls(4,4,8,4,A_),new Ls(4,5,16,8,A_),new Ls(4,6,32,32,A_),new Ls(4,4,16,16,Cu),new Ls(8,16,32,32,Cu),new Ls(8,16,128,128,Cu),new Ls(8,32,128,256,Cu),new Ls(32,128,258,1024,Cu),new Ls(32,258,258,4096,Cu)];function zle(t){t.window_size=2*t.w_size,Ra(t.head),t.max_lazy_match=ud[t.level].max_lazy,t.good_match=ud[t.level].good_length,t.nice_match=ud[t.level].nice_length,t.max_chain_length=ud[t.level].max_chain,t.strstart=0,t.block_start=0,t.lookahead=0,t.insert=0,t.match_length=t.prev_length=lt-1,t.match_available=0,t.ins_h=0}function Gle(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=p2,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new Mr.Buf16(Ole*2),this.dyn_dtree=new Mr.Buf16((2*Lle+1)*2),this.bl_tree=new Mr.Buf16((2*Rle+1)*2),Ra(this.dyn_ltree),Ra(this.dyn_dtree),Ra(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new Mr.Buf16(Dle+1),this.heap=new Mr.Buf16(2*Yx+1),Ra(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new Mr.Buf16(2*Yx+1),Ra(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function bF(t){var e;return!t||!t.state?Xa(t,Li):(t.total_in=t.total_out=0,t.data_type=Cle,e=t.state,e.pending=0,e.pending_out=0,e.wrap<0&&(e.wrap=-e.wrap),e.status=e.wrap?m2:Ec,t.adler=e.wrap===2?0:1,e.last_flush=mu,Pi._tr_init(e),eo)}function _F(t){var e=bF(t);return e===eo&&zle(t.state),e}function Vle(t,e){return!t||!t.state||t.state.wrap!==2?Li:(t.state.gzhead=e,eo)}function EF(t,e,n,r,i,s){if(!t)return Li;var o=1;if(e===Ele&&(e=6),r<0?(o=0,r=-r):r>15&&(o=2,r-=16),i<1||i>Ile||n!==p2||r<8||r>15||e<0||e>9||s<0||s>Tle)return Xa(t,Li);r===8&&(r=9);var a=new Gle;return t.state=a,a.strm=t,a.wrap=o,a.gzhead=null,a.w_bits=r,a.w_size=1<<a.w_bits,a.w_mask=a.w_size-1,a.hash_bits=i+7,a.hash_size=1<<a.hash_bits,a.hash_mask=a.hash_size-1,a.hash_shift=~~((a.hash_bits+lt-1)/lt),a.window=new Mr.Buf8(a.w_size*2),a.head=new Mr.Buf16(a.hash_size),a.prev=new Mr.Buf16(a.w_size),a.lit_bufsize=1<<i+6,a.pending_buf_size=a.lit_bufsize*4,a.pending_buf=new Mr.Buf8(a.pending_buf_size),a.d_buf=1*a.lit_bufsize,a.l_buf=3*a.lit_bufsize,a.level=e,a.strategy=s,a.method=n,_F(t)}function Wle(t,e){return EF(t,e,p2,Ale,kle,Sle)}function jle(t,e){var n,r,i,s;if(!t||!t.state||e>ZA||e<0)return t?Xa(t,Li):Li;if(r=t.state,!t.output||!t.input&&t.avail_in!==0||r.status===kf&&e!==ll)return Xa(t,t.avail_out===0?I_:Li);if(r.strm=t,n=r.last_flush,r.last_flush=e,r.status===m2)if(r.wrap===2)t.adler=0,ft(r,31),ft(r,139),ft(r,8),r.gzhead?(ft(r,(r.gzhead.text?1:0)+(r.gzhead.hcrc?2:0)+(r.gzhead.extra?4:0)+(r.gzhead.name?8:0)+(r.gzhead.comment?16:0)),ft(r,r.gzhead.time&255),ft(r,r.gzhead.time>>8&255),ft(r,r.gzhead.time>>16&255),ft(r,r.gzhead.time>>24&255),ft(r,r.level===9?2:r.strategy>=cg||r.level<2?4:0),ft(r,r.gzhead.os&255),r.gzhead.extra&&r.gzhead.extra.length&&(ft(r,r.gzhead.extra.length&255),ft(r,r.gzhead.extra.length>>8&255)),r.gzhead.hcrc&&(t.adler=wa(t.adler,r.pending_buf,r.pending,0)),r.gzindex=0,r.status=Zx):(ft(r,0),ft(r,0),ft(r,0),ft(r,0),ft(r,0),ft(r,r.level===9?2:r.strategy>=cg||r.level<2?4:0),ft(r,Fle),r.status=Ec);else{var o=p2+(r.w_bits-8<<4)<<8,a=-1;r.strategy>=cg||r.level<2?a=0:r.level<6?a=1:r.level===6?a=2:a=3,o|=a<<6,r.strstart!==0&&(o|=Nle),o+=31-o%31,r.status=Ec,Qh(r,o),r.strstart!==0&&(Qh(r,t.adler>>>16),Qh(r,t.adler&65535)),t.adler=1}if(r.status===Zx)if(r.gzhead.extra){for(i=r.pending;r.gzindex<(r.gzhead.extra.length&65535)&&!(r.pending===r.pending_buf_size&&(r.gzhead.hcrc&&r.pending>i&&(t.adler=wa(t.adler,r.pending_buf,r.pending-i,i)),xa(t),i=r.pending,r.pending===r.pending_buf_size));)ft(r,r.gzhead.extra[r.gzindex]&255),r.gzindex++;r.gzhead.hcrc&&r.pending>i&&(t.adler=wa(t.adler,r.pending_buf,r.pending-i,i)),r.gzindex===r.gzhead.extra.length&&(r.gzindex=0,r.status=c0)}else r.status=c0;if(r.status===c0)if(r.gzhead.name){i=r.pending;do{if(r.pending===r.pending_buf_size&&(r.gzhead.hcrc&&r.pending>i&&(t.adler=wa(t.adler,r.pending_buf,r.pending-i,i)),xa(t),i=r.pending,r.pending===r.pending_buf_size)){s=1;break}r.gzindex<r.gzhead.name.length?s=r.gzhead.name.charCodeAt(r.gzindex++)&255:s=0,ft(r,s)}while(s!==0);r.gzhead.hcrc&&r.pending>i&&(t.adler=wa(t.adler,r.pending_buf,r.pending-i,i)),s===0&&(r.gzindex=0,r.status=u0)}else r.status=u0;if(r.status===u0)if(r.gzhead.comment){i=r.pending;do{if(r.pending===r.pending_buf_size&&(r.gzhead.hcrc&&r.pending>i&&(t.adler=wa(t.adler,r.pending_buf,r.pending-i,i)),xa(t),i=r.pending,r.pending===r.pending_buf_size)){s=1;break}r.gzindex<r.gzhead.comment.length?s=r.gzhead.comment.charCodeAt(r.gzindex++)&255:s=0,ft(r,s)}while(s!==0);r.gzhead.hcrc&&r.pending>i&&(t.adler=wa(t.adler,r.pending_buf,r.pending-i,i)),s===0&&(r.status=d0)}else r.status=d0;if(r.status===d0&&(r.gzhead.hcrc?(r.pending+2>r.pending_buf_size&&xa(t),r.pending+2<=r.pending_buf_size&&(ft(r,t.adler&255),ft(r,t.adler>>8&255),t.adler=0,r.status=Ec)):r.status=Ec),r.pending!==0){if(xa(t),t.avail_out===0)return r.last_flush=-1,eo}else if(t.avail_in===0&&qA(e)<=qA(n)&&e!==ll)return Xa(t,I_);if(r.status===kf&&t.avail_in!==0)return Xa(t,I_);if(t.avail_in!==0||r.lookahead!==0||e!==mu&&r.status!==kf){var l=r.strategy===cg?Hle(r,e):r.strategy===xle?$le(r,e):ud[r.level].func(r,e);if((l===Qc||l===Eh)&&(r.status=kf),l===Mn||l===Qc)return t.avail_out===0&&(r.last_flush=-1),eo;if(l===qm&&(e===vle?Pi._tr_align(r):e!==ZA&&(Pi._tr_stored_block(r,0,0,!1),e===ble&&(Ra(r.head),r.lookahead===0&&(r.strstart=0,r.block_start=0,r.insert=0))),xa(t),t.avail_out===0))return r.last_flush=-1,eo}return e!==ll?eo:r.wrap<=0?KA:(r.wrap===2?(ft(r,t.adler&255),ft(r,t.adler>>8&255),ft(r,t.adler>>16&255),ft(r,t.adler>>24&255),ft(r,t.total_in&255),ft(r,t.total_in>>8&255),ft(r,t.total_in>>16&255),ft(r,t.total_in>>24&255)):(Qh(r,t.adler>>>16),Qh(r,t.adler&65535)),xa(t),r.wrap>0&&(r.wrap=-r.wrap),r.pending!==0?eo:KA)}function Xle(t){var e;return!t||!t.state?Li:(e=t.state.status,e!==m2&&e!==Zx&&e!==c0&&e!==u0&&e!==d0&&e!==Ec&&e!==kf?Xa(t,Li):(t.state=null,e===Ec?Xa(t,_le):eo))}function Yle(t,e){var n=e.length,r,i,s,o,a,l,c,u;if(!t||!t.state||(r=t.state,o=r.wrap,o===2||o===1&&r.status!==m2||r.lookahead))return Li;for(o===1&&(t.adler=yF(t.adler,e,n,0)),r.wrap=0,n>=r.w_size&&(o===0&&(Ra(r.head),r.strstart=0,r.block_start=0,r.insert=0),u=new Mr.Buf8(r.w_size),Mr.arraySet(u,e,n-r.w_size,r.w_size,0),e=u,n=r.w_size),a=t.avail_in,l=t.next_in,c=t.input,t.avail_in=n,t.next_in=0,t.input=e,eu(r);r.lookahead>=lt;){i=r.strstart,s=r.lookahead-(lt-1);do r.ins_h=(r.ins_h<<r.hash_shift^r.window[i+lt-1])&r.hash_mask,r.prev[i&r.w_mask]=r.head[r.ins_h],r.head[r.ins_h]=i,i++;while(--s);r.strstart=i,r.lookahead=lt-1,eu(r)}return r.strstart+=r.lookahead,r.block_start=r.strstart,r.insert=r.lookahead,r.lookahead=0,r.match_length=r.prev_length=lt-1,r.match_available=0,t.next_in=l,t.input=c,t.avail_in=a,r.wrap=o,eo}yo.deflateInit=Wle;yo.deflateInit2=EF;yo.deflateReset=_F;yo.deflateResetKeep=bF;yo.deflateSetHeader=Vle;yo.deflate=jle;yo.deflateEnd=Xle;yo.deflateSetDictionary=Yle;yo.deflateInfo="pako deflate (from Nodeca project)";var gu={},g2=fa,wF=!0,xF=!0;try{String.fromCharCode.apply(null,[0])}catch{wF=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{xF=!1}var um=new g2.Buf8(256);for(var ya=0;ya<256;ya++)um[ya]=ya>=252?6:ya>=248?5:ya>=240?4:ya>=224?3:ya>=192?2:1;um[254]=um[254]=1;gu.string2buf=function(t){var e,n,r,i,s,o=t.length,a=0;for(i=0;i<o;i++)n=t.charCodeAt(i),(n&64512)===55296&&i+1<o&&(r=t.charCodeAt(i+1),(r&64512)===56320&&(n=65536+(n-55296<<10)+(r-56320),i++)),a+=n<128?1:n<2048?2:n<65536?3:4;for(e=new g2.Buf8(a),s=0,i=0;s<a;i++)n=t.charCodeAt(i),(n&64512)===55296&&i+1<o&&(r=t.charCodeAt(i+1),(r&64512)===56320&&(n=65536+(n-55296<<10)+(r-56320),i++)),n<128?e[s++]=n:n<2048?(e[s++]=192|n>>>6,e[s++]=128|n&63):n<65536?(e[s++]=224|n>>>12,e[s++]=128|n>>>6&63,e[s++]=128|n&63):(e[s++]=240|n>>>18,e[s++]=128|n>>>12&63,e[s++]=128|n>>>6&63,e[s++]=128|n&63);return e};function TF(t,e){if(e<65534&&(t.subarray&&xF||!t.subarray&&wF))return String.fromCharCode.apply(null,g2.shrinkBuf(t,e));for(var n="",r=0;r<e;r++)n+=String.fromCharCode(t[r]);return n}gu.buf2binstring=function(t){return TF(t,t.length)};gu.binstring2buf=function(t){for(var e=new g2.Buf8(t.length),n=0,r=e.length;n<r;n++)e[n]=t.charCodeAt(n);return e};gu.buf2string=function(t,e){var n,r,i,s,o=e||t.length,a=new Array(o*2);for(r=0,n=0;n<o;){if(i=t[n++],i<128){a[r++]=i;continue}if(s=um[i],s>4){a[r++]=65533,n+=s-1;continue}for(i&=s===2?31:s===3?15:7;s>1&&n<o;)i=i<<6|t[n++]&63,s--;if(s>1){a[r++]=65533;continue}i<65536?a[r++]=i:(i-=65536,a[r++]=55296|i>>10&1023,a[r++]=56320|i&1023)}return TF(a,r)};gu.utf8border=function(t,e){var n;for(e=e||t.length,e>t.length&&(e=t.length),n=e-1;n>=0&&(t[n]&192)===128;)n--;return n<0||n===0?e:n+um[t[n]]>e?n:e};function Zle(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}var SF=Zle,rp=yo,ip=fa,Kx=gu,qx=r4,Kle=SF,CF=Object.prototype.toString,qle=0,k_=4,Ad=0,JA=1,QA=2,Jle=-1,Qle=0,ece=8;function tu(t){if(!(this instanceof tu))return new tu(t);this.options=ip.assign({level:Jle,method:ece,chunkSize:16384,windowBits:15,memLevel:8,strategy:Qle,to:""},t||{});var e=this.options;e.raw&&e.windowBits>0?e.windowBits=-e.windowBits:e.gzip&&e.windowBits>0&&e.windowBits<16&&(e.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new Kle,this.strm.avail_out=0;var n=rp.deflateInit2(this.strm,e.level,e.method,e.windowBits,e.memLevel,e.strategy);if(n!==Ad)throw new Error(qx[n]);if(e.header&&rp.deflateSetHeader(this.strm,e.header),e.dictionary){var r;if(typeof e.dictionary=="string"?r=Kx.string2buf(e.dictionary):CF.call(e.dictionary)==="[object ArrayBuffer]"?r=new Uint8Array(e.dictionary):r=e.dictionary,n=rp.deflateSetDictionary(this.strm,r),n!==Ad)throw new Error(qx[n]);this._dict_set=!0}}tu.prototype.push=function(t,e){var n=this.strm,r=this.options.chunkSize,i,s;if(this.ended)return!1;s=e===~~e?e:e===!0?k_:qle,typeof t=="string"?n.input=Kx.string2buf(t):CF.call(t)==="[object ArrayBuffer]"?n.input=new Uint8Array(t):n.input=t,n.next_in=0,n.avail_in=n.input.length;do{if(n.avail_out===0&&(n.output=new ip.Buf8(r),n.next_out=0,n.avail_out=r),i=rp.deflate(n,s),i!==JA&&i!==Ad)return this.onEnd(i),this.ended=!0,!1;(n.avail_out===0||n.avail_in===0&&(s===k_||s===QA))&&(this.options.to==="string"?this.onData(Kx.buf2binstring(ip.shrinkBuf(n.output,n.next_out))):this.onData(ip.shrinkBuf(n.output,n.next_out)))}while((n.avail_in>0||n.avail_out===0)&&i!==JA);return s===k_?(i=rp.deflateEnd(this.strm),this.onEnd(i),this.ended=!0,i===Ad):(s===QA&&(this.onEnd(Ad),n.avail_out=0),!0)};tu.prototype.onData=function(t){this.chunks.push(t)};tu.prototype.onEnd=function(t){t===Ad&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=ip.flattenChunks(this.chunks)),this.chunks=[],this.err=t,this.msg=this.strm.msg};function i4(t,e){var n=new tu(e);if(n.push(t,!0),n.err)throw n.msg||qx[n.err];return n.result}function tce(t,e){return e=e||{},e.raw=!0,i4(t,e)}function nce(t,e){return e=e||{},e.gzip=!0,i4(t,e)}Zm.Deflate=tu;Zm.deflate=i4;Zm.deflateRaw=tce;Zm.gzip=nce;var Jm={},Cs={},ug=30,rce=12,ice=function(e,n){var r,i,s,o,a,l,c,u,d,h,f,p,m,v,y,b,_,E,w,x,T,C,k,L,F;r=e.state,i=e.next_in,L=e.input,s=i+(e.avail_in-5),o=e.next_out,F=e.output,a=o-(n-e.avail_out),l=o+(e.avail_out-257),c=r.dmax,u=r.wsize,d=r.whave,h=r.wnext,f=r.window,p=r.hold,m=r.bits,v=r.lencode,y=r.distcode,b=(1<<r.lenbits)-1,_=(1<<r.distbits)-1;e:do{m<15&&(p+=L[i++]<<m,m+=8,p+=L[i++]<<m,m+=8),E=v[p&b];t:for(;;){if(w=E>>>24,p>>>=w,m-=w,w=E>>>16&255,w===0)F[o++]=E&65535;else if(w&16){x=E&65535,w&=15,w&&(m<w&&(p+=L[i++]<<m,m+=8),x+=p&(1<<w)-1,p>>>=w,m-=w),m<15&&(p+=L[i++]<<m,m+=8,p+=L[i++]<<m,m+=8),E=y[p&_];n:for(;;){if(w=E>>>24,p>>>=w,m-=w,w=E>>>16&255,w&16){if(T=E&65535,w&=15,m<w&&(p+=L[i++]<<m,m+=8,m<w&&(p+=L[i++]<<m,m+=8)),T+=p&(1<<w)-1,T>c){e.msg="invalid distance too far back",r.mode=ug;break e}if(p>>>=w,m-=w,w=o-a,T>w){if(w=T-w,w>d&&r.sane){e.msg="invalid distance too far back",r.mode=ug;break e}if(C=0,k=f,h===0){if(C+=u-w,w<x){x-=w;do F[o++]=f[C++];while(--w);C=o-T,k=F}}else if(h<w){if(C+=u+h-w,w-=h,w<x){x-=w;do F[o++]=f[C++];while(--w);if(C=0,h<x){w=h,x-=w;do F[o++]=f[C++];while(--w);C=o-T,k=F}}}else if(C+=h-w,w<x){x-=w;do F[o++]=f[C++];while(--w);C=o-T,k=F}for(;x>2;)F[o++]=k[C++],F[o++]=k[C++],F[o++]=k[C++],x-=3;x&&(F[o++]=k[C++],x>1&&(F[o++]=k[C++]))}else{C=o-T;do F[o++]=F[C++],F[o++]=F[C++],F[o++]=F[C++],x-=3;while(x>2);x&&(F[o++]=F[C++],x>1&&(F[o++]=F[C++]))}}else if(w&64){e.msg="invalid distance code",r.mode=ug;break e}else{E=y[(E&65535)+(p&(1<<w)-1)];continue n}break}}else if(w&64)if(w&32){r.mode=rce;break e}else{e.msg="invalid literal/length code",r.mode=ug;break e}else{E=v[(E&65535)+(p&(1<<w)-1)];continue t}break}}while(i<s&&o<l);x=m>>3,i-=x,m-=x<<3,p&=(1<<m)-1,e.next_in=i,e.next_out=o,e.avail_in=i<s?5+(s-i):5-(i-s),e.avail_out=o<l?257+(l-o):257-(o-l),r.hold=p,r.bits=m},ek=fa,Iu=15,tk=852,nk=592,rk=0,M_=1,ik=2,sce=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],oce=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],ace=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],lce=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64],cce=function(e,n,r,i,s,o,a,l){var c=l.bits,u=0,d=0,h=0,f=0,p=0,m=0,v=0,y=0,b=0,_=0,E,w,x,T,C,k=null,L=0,F,N=new ek.Buf16(Iu+1),R=new ek.Buf16(Iu+1),H=null,W=0,q,Z,j;for(u=0;u<=Iu;u++)N[u]=0;for(d=0;d<i;d++)N[n[r+d]]++;for(p=c,f=Iu;f>=1&&N[f]===0;f--);if(p>f&&(p=f),f===0)return s[o++]=1<<24|64<<16|0,s[o++]=1<<24|64<<16|0,l.bits=1,0;for(h=1;h<f&&N[h]===0;h++);for(p<h&&(p=h),y=1,u=1;u<=Iu;u++)if(y<<=1,y-=N[u],y<0)return-1;if(y>0&&(e===rk||f!==1))return-1;for(R[1]=0,u=1;u<Iu;u++)R[u+1]=R[u]+N[u];for(d=0;d<i;d++)n[r+d]!==0&&(a[R[n[r+d]]++]=d);if(e===rk?(k=H=a,F=19):e===M_?(k=sce,L-=257,H=oce,W-=257,F=256):(k=ace,H=lce,F=-1),_=0,d=0,u=h,C=o,m=p,v=0,x=-1,b=1<<p,T=b-1,e===M_&&b>tk||e===ik&&b>nk)return 1;for(;;){q=u-v,a[d]<F?(Z=0,j=a[d]):a[d]>F?(Z=H[W+a[d]],j=k[L+a[d]]):(Z=96,j=0),E=1<<u-v,w=1<<m,h=w;do w-=E,s[C+(_>>v)+w]=q<<24|Z<<16|j|0;while(w!==0);for(E=1<<u-1;_&E;)E>>=1;if(E!==0?(_&=E-1,_+=E):_=0,d++,--N[u]===0){if(u===f)break;u=n[r+a[d]]}if(u>p&&(_&T)!==x){for(v===0&&(v=p),C+=h,m=u-v,y=1<<m;m+v<f&&(y-=N[m+v],!(y<=0));)m++,y<<=1;if(b+=1<<m,e===M_&&b>tk||e===ik&&b>nk)return 1;x=_&T,s[x]=p<<24|m<<16|C-o|0}}return _!==0&&(s[C+_]=u-v<<24|64<<16|0),l.bits=p,0},ui=fa,Jx=mF,Rs=gF,uce=ice,sp=cce,dce=0,IF=1,AF=2,sk=4,hce=5,dg=6,nu=0,fce=1,pce=2,Fi=-2,kF=-3,MF=-4,mce=-5,ok=8,PF=1,ak=2,lk=3,ck=4,uk=5,dk=6,hk=7,fk=8,pk=9,mk=10,By=11,So=12,P_=13,gk=14,L_=15,yk=16,vk=17,bk=18,_k=19,hg=20,fg=21,Ek=22,wk=23,xk=24,Tk=25,Sk=26,R_=27,Ck=28,Ik=29,zt=30,LF=31,gce=32,yce=852,vce=592,bce=15,_ce=bce;function Ak(t){return(t>>>24&255)+(t>>>8&65280)+((t&65280)<<8)+((t&255)<<24)}function Ece(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new ui.Buf16(320),this.work=new ui.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function RF(t){var e;return!t||!t.state?Fi:(e=t.state,t.total_in=t.total_out=e.total=0,t.msg="",e.wrap&&(t.adler=e.wrap&1),e.mode=PF,e.last=0,e.havedict=0,e.dmax=32768,e.head=null,e.hold=0,e.bits=0,e.lencode=e.lendyn=new ui.Buf32(yce),e.distcode=e.distdyn=new ui.Buf32(vce),e.sane=1,e.back=-1,nu)}function OF(t){var e;return!t||!t.state?Fi:(e=t.state,e.wsize=0,e.whave=0,e.wnext=0,RF(t))}function DF(t,e){var n,r;return!t||!t.state||(r=t.state,e<0?(n=0,e=-e):(n=(e>>4)+1,e<48&&(e&=15)),e&&(e<8||e>15))?Fi:(r.window!==null&&r.wbits!==e&&(r.window=null),r.wrap=n,r.wbits=e,OF(t))}function NF(t,e){var n,r;return t?(r=new Ece,t.state=r,r.window=null,n=DF(t,e),n!==nu&&(t.state=null),n):Fi}function wce(t){return NF(t,_ce)}var kk=!0,O_,D_;function xce(t){if(kk){var e;for(O_=new ui.Buf32(512),D_=new ui.Buf32(32),e=0;e<144;)t.lens[e++]=8;for(;e<256;)t.lens[e++]=9;for(;e<280;)t.lens[e++]=7;for(;e<288;)t.lens[e++]=8;for(sp(IF,t.lens,0,288,O_,0,t.work,{bits:9}),e=0;e<32;)t.lens[e++]=5;sp(AF,t.lens,0,32,D_,0,t.work,{bits:5}),kk=!1}t.lencode=O_,t.lenbits=9,t.distcode=D_,t.distbits=5}function FF(t,e,n,r){var i,s=t.state;return s.window===null&&(s.wsize=1<<s.wbits,s.wnext=0,s.whave=0,s.window=new ui.Buf8(s.wsize)),r>=s.wsize?(ui.arraySet(s.window,e,n-s.wsize,s.wsize,0),s.wnext=0,s.whave=s.wsize):(i=s.wsize-s.wnext,i>r&&(i=r),ui.arraySet(s.window,e,n-r,i,s.wnext),r-=i,r?(ui.arraySet(s.window,e,n-r,r,0),s.wnext=r,s.whave=s.wsize):(s.wnext+=i,s.wnext===s.wsize&&(s.wnext=0),s.whave<s.wsize&&(s.whave+=i))),0}function Tce(t,e){var n,r,i,s,o,a,l,c,u,d,h,f,p,m,v=0,y,b,_,E,w,x,T,C,k=new ui.Buf8(4),L,F,N=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!t||!t.state||!t.output||!t.input&&t.avail_in!==0)return Fi;n=t.state,n.mode===So&&(n.mode=P_),o=t.next_out,i=t.output,l=t.avail_out,s=t.next_in,r=t.input,a=t.avail_in,c=n.hold,u=n.bits,d=a,h=l,C=nu;e:for(;;)switch(n.mode){case PF:if(n.wrap===0){n.mode=P_;break}for(;u<16;){if(a===0)break e;a--,c+=r[s++]<<u,u+=8}if(n.wrap&2&&c===35615){n.check=0,k[0]=c&255,k[1]=c>>>8&255,n.check=Rs(n.check,k,2,0),c=0,u=0,n.mode=ak;break}if(n.flags=0,n.head&&(n.head.done=!1),!(n.wrap&1)||(((c&255)<<8)+(c>>8))%31){t.msg="incorrect header check",n.mode=zt;break}if((c&15)!==ok){t.msg="unknown compression method",n.mode=zt;break}if(c>>>=4,u-=4,T=(c&15)+8,n.wbits===0)n.wbits=T;else if(T>n.wbits){t.msg="invalid window size",n.mode=zt;break}n.dmax=1<<T,t.adler=n.check=1,n.mode=c&512?mk:So,c=0,u=0;break;case ak:for(;u<16;){if(a===0)break e;a--,c+=r[s++]<<u,u+=8}if(n.flags=c,(n.flags&255)!==ok){t.msg="unknown compression method",n.mode=zt;break}if(n.flags&57344){t.msg="unknown header flags set",n.mode=zt;break}n.head&&(n.head.text=c>>8&1),n.flags&512&&(k[0]=c&255,k[1]=c>>>8&255,n.check=Rs(n.check,k,2,0)),c=0,u=0,n.mode=lk;case lk:for(;u<32;){if(a===0)break e;a--,c+=r[s++]<<u,u+=8}n.head&&(n.head.time=c),n.flags&512&&(k[0]=c&255,k[1]=c>>>8&255,k[2]=c>>>16&255,k[3]=c>>>24&255,n.check=Rs(n.check,k,4,0)),c=0,u=0,n.mode=ck;case ck:for(;u<16;){if(a===0)break e;a--,c+=r[s++]<<u,u+=8}n.head&&(n.head.xflags=c&255,n.head.os=c>>8),n.flags&512&&(k[0]=c&255,k[1]=c>>>8&255,n.check=Rs(n.check,k,2,0)),c=0,u=0,n.mode=uk;case uk:if(n.flags&1024){for(;u<16;){if(a===0)break e;a--,c+=r[s++]<<u,u+=8}n.length=c,n.head&&(n.head.extra_len=c),n.flags&512&&(k[0]=c&255,k[1]=c>>>8&255,n.check=Rs(n.check,k,2,0)),c=0,u=0}else n.head&&(n.head.extra=null);n.mode=dk;case dk:if(n.flags&1024&&(f=n.length,f>a&&(f=a),f&&(n.head&&(T=n.head.extra_len-n.length,n.head.extra||(n.head.extra=new Array(n.head.extra_len)),ui.arraySet(n.head.extra,r,s,f,T)),n.flags&512&&(n.check=Rs(n.check,r,f,s)),a-=f,s+=f,n.length-=f),n.length))break e;n.length=0,n.mode=hk;case hk:if(n.flags&2048){if(a===0)break e;f=0;do T=r[s+f++],n.head&&T&&n.length<65536&&(n.head.name+=String.fromCharCode(T));while(T&&f<a);if(n.flags&512&&(n.check=Rs(n.check,r,f,s)),a-=f,s+=f,T)break e}else n.head&&(n.head.name=null);n.length=0,n.mode=fk;case fk:if(n.flags&4096){if(a===0)break e;f=0;do T=r[s+f++],n.head&&T&&n.length<65536&&(n.head.comment+=String.fromCharCode(T));while(T&&f<a);if(n.flags&512&&(n.check=Rs(n.check,r,f,s)),a-=f,s+=f,T)break e}else n.head&&(n.head.comment=null);n.mode=pk;case pk:if(n.flags&512){for(;u<16;){if(a===0)break e;a--,c+=r[s++]<<u,u+=8}if(c!==(n.check&65535)){t.msg="header crc mismatch",n.mode=zt;break}c=0,u=0}n.head&&(n.head.hcrc=n.flags>>9&1,n.head.done=!0),t.adler=n.check=0,n.mode=So;break;case mk:for(;u<32;){if(a===0)break e;a--,c+=r[s++]<<u,u+=8}t.adler=n.check=Ak(c),c=0,u=0,n.mode=By;case By:if(n.havedict===0)return t.next_out=o,t.avail_out=l,t.next_in=s,t.avail_in=a,n.hold=c,n.bits=u,pce;t.adler=n.check=1,n.mode=So;case So:if(e===hce||e===dg)break e;case P_:if(n.last){c>>>=u&7,u-=u&7,n.mode=R_;break}for(;u<3;){if(a===0)break e;a--,c+=r[s++]<<u,u+=8}switch(n.last=c&1,c>>>=1,u-=1,c&3){case 0:n.mode=gk;break;case 1:if(xce(n),n.mode=hg,e===dg){c>>>=2,u-=2;break e}break;case 2:n.mode=vk;break;case 3:t.msg="invalid block type",n.mode=zt}c>>>=2,u-=2;break;case gk:for(c>>>=u&7,u-=u&7;u<32;){if(a===0)break e;a--,c+=r[s++]<<u,u+=8}if((c&65535)!==(c>>>16^65535)){t.msg="invalid stored block lengths",n.mode=zt;break}if(n.length=c&65535,c=0,u=0,n.mode=L_,e===dg)break e;case L_:n.mode=yk;case yk:if(f=n.length,f){if(f>a&&(f=a),f>l&&(f=l),f===0)break e;ui.arraySet(i,r,s,f,o),a-=f,s+=f,l-=f,o+=f,n.length-=f;break}n.mode=So;break;case vk:for(;u<14;){if(a===0)break e;a--,c+=r[s++]<<u,u+=8}if(n.nlen=(c&31)+257,c>>>=5,u-=5,n.ndist=(c&31)+1,c>>>=5,u-=5,n.ncode=(c&15)+4,c>>>=4,u-=4,n.nlen>286||n.ndist>30){t.msg="too many length or distance symbols",n.mode=zt;break}n.have=0,n.mode=bk;case bk:for(;n.have<n.ncode;){for(;u<3;){if(a===0)break e;a--,c+=r[s++]<<u,u+=8}n.lens[N[n.have++]]=c&7,c>>>=3,u-=3}for(;n.have<19;)n.lens[N[n.have++]]=0;if(n.lencode=n.lendyn,n.lenbits=7,L={bits:n.lenbits},C=sp(dce,n.lens,0,19,n.lencode,0,n.work,L),n.lenbits=L.bits,C){t.msg="invalid code lengths set",n.mode=zt;break}n.have=0,n.mode=_k;case _k:for(;n.have<n.nlen+n.ndist;){for(;v=n.lencode[c&(1<<n.lenbits)-1],y=v>>>24,b=v>>>16&255,_=v&65535,!(y<=u);){if(a===0)break e;a--,c+=r[s++]<<u,u+=8}if(_<16)c>>>=y,u-=y,n.lens[n.have++]=_;else{if(_===16){for(F=y+2;u<F;){if(a===0)break e;a--,c+=r[s++]<<u,u+=8}if(c>>>=y,u-=y,n.have===0){t.msg="invalid bit length repeat",n.mode=zt;break}T=n.lens[n.have-1],f=3+(c&3),c>>>=2,u-=2}else if(_===17){for(F=y+3;u<F;){if(a===0)break e;a--,c+=r[s++]<<u,u+=8}c>>>=y,u-=y,T=0,f=3+(c&7),c>>>=3,u-=3}else{for(F=y+7;u<F;){if(a===0)break e;a--,c+=r[s++]<<u,u+=8}c>>>=y,u-=y,T=0,f=11+(c&127),c>>>=7,u-=7}if(n.have+f>n.nlen+n.ndist){t.msg="invalid bit length repeat",n.mode=zt;break}for(;f--;)n.lens[n.have++]=T}}if(n.mode===zt)break;if(n.lens[256]===0){t.msg="invalid code -- missing end-of-block",n.mode=zt;break}if(n.lenbits=9,L={bits:n.lenbits},C=sp(IF,n.lens,0,n.nlen,n.lencode,0,n.work,L),n.lenbits=L.bits,C){t.msg="invalid literal/lengths set",n.mode=zt;break}if(n.distbits=6,n.distcode=n.distdyn,L={bits:n.distbits},C=sp(AF,n.lens,n.nlen,n.ndist,n.distcode,0,n.work,L),n.distbits=L.bits,C){t.msg="invalid distances set",n.mode=zt;break}if(n.mode=hg,e===dg)break e;case hg:n.mode=fg;case fg:if(a>=6&&l>=258){t.next_out=o,t.avail_out=l,t.next_in=s,t.avail_in=a,n.hold=c,n.bits=u,uce(t,h),o=t.next_out,i=t.output,l=t.avail_out,s=t.next_in,r=t.input,a=t.avail_in,c=n.hold,u=n.bits,n.mode===So&&(n.back=-1);break}for(n.back=0;v=n.lencode[c&(1<<n.lenbits)-1],y=v>>>24,b=v>>>16&255,_=v&65535,!(y<=u);){if(a===0)break e;a--,c+=r[s++]<<u,u+=8}if(b&&!(b&240)){for(E=y,w=b,x=_;v=n.lencode[x+((c&(1<<E+w)-1)>>E)],y=v>>>24,b=v>>>16&255,_=v&65535,!(E+y<=u);){if(a===0)break e;a--,c+=r[s++]<<u,u+=8}c>>>=E,u-=E,n.back+=E}if(c>>>=y,u-=y,n.back+=y,n.length=_,b===0){n.mode=Sk;break}if(b&32){n.back=-1,n.mode=So;break}if(b&64){t.msg="invalid literal/length code",n.mode=zt;break}n.extra=b&15,n.mode=Ek;case Ek:if(n.extra){for(F=n.extra;u<F;){if(a===0)break e;a--,c+=r[s++]<<u,u+=8}n.length+=c&(1<<n.extra)-1,c>>>=n.extra,u-=n.extra,n.back+=n.extra}n.was=n.length,n.mode=wk;case wk:for(;v=n.distcode[c&(1<<n.distbits)-1],y=v>>>24,b=v>>>16&255,_=v&65535,!(y<=u);){if(a===0)break e;a--,c+=r[s++]<<u,u+=8}if(!(b&240)){for(E=y,w=b,x=_;v=n.distcode[x+((c&(1<<E+w)-1)>>E)],y=v>>>24,b=v>>>16&255,_=v&65535,!(E+y<=u);){if(a===0)break e;a--,c+=r[s++]<<u,u+=8}c>>>=E,u-=E,n.back+=E}if(c>>>=y,u-=y,n.back+=y,b&64){t.msg="invalid distance code",n.mode=zt;break}n.offset=_,n.extra=b&15,n.mode=xk;case xk:if(n.extra){for(F=n.extra;u<F;){if(a===0)break e;a--,c+=r[s++]<<u,u+=8}n.offset+=c&(1<<n.extra)-1,c>>>=n.extra,u-=n.extra,n.back+=n.extra}if(n.offset>n.dmax){t.msg="invalid distance too far back",n.mode=zt;break}n.mode=Tk;case Tk:if(l===0)break e;if(f=h-l,n.offset>f){if(f=n.offset-f,f>n.whave&&n.sane){t.msg="invalid distance too far back",n.mode=zt;break}f>n.wnext?(f-=n.wnext,p=n.wsize-f):p=n.wnext-f,f>n.length&&(f=n.length),m=n.window}else m=i,p=o-n.offset,f=n.length;f>l&&(f=l),l-=f,n.length-=f;do i[o++]=m[p++];while(--f);n.length===0&&(n.mode=fg);break;case Sk:if(l===0)break e;i[o++]=n.length,l--,n.mode=fg;break;case R_:if(n.wrap){for(;u<32;){if(a===0)break e;a--,c|=r[s++]<<u,u+=8}if(h-=l,t.total_out+=h,n.total+=h,h&&(t.adler=n.check=n.flags?Rs(n.check,i,h,o-h):Jx(n.check,i,h,o-h)),h=l,(n.flags?c:Ak(c))!==n.check){t.msg="incorrect data check",n.mode=zt;break}c=0,u=0}n.mode=Ck;case Ck:if(n.wrap&&n.flags){for(;u<32;){if(a===0)break e;a--,c+=r[s++]<<u,u+=8}if(c!==(n.total&4294967295)){t.msg="incorrect length check",n.mode=zt;break}c=0,u=0}n.mode=Ik;case Ik:C=fce;break e;case zt:C=kF;break e;case LF:return MF;case gce:default:return Fi}return t.next_out=o,t.avail_out=l,t.next_in=s,t.avail_in=a,n.hold=c,n.bits=u,(n.wsize||h!==t.avail_out&&n.mode<zt&&(n.mode<R_||e!==sk))&&FF(t,t.output,t.next_out,h-t.avail_out),d-=t.avail_in,h-=t.avail_out,t.total_in+=d,t.total_out+=h,n.total+=h,n.wrap&&h&&(t.adler=n.check=n.flags?Rs(n.check,i,h,t.next_out-h):Jx(n.check,i,h,t.next_out-h)),t.data_type=n.bits+(n.last?64:0)+(n.mode===So?128:0)+(n.mode===hg||n.mode===L_?256:0),(d===0&&h===0||e===sk)&&C===nu&&(C=mce),C}function Sce(t){if(!t||!t.state)return Fi;var e=t.state;return e.window&&(e.window=null),t.state=null,nu}function Cce(t,e){var n;return!t||!t.state||(n=t.state,!(n.wrap&2))?Fi:(n.head=e,e.done=!1,nu)}function Ice(t,e){var n=e.length,r,i,s;return!t||!t.state||(r=t.state,r.wrap!==0&&r.mode!==By)?Fi:r.mode===By&&(i=1,i=Jx(i,e,n,0),i!==r.check)?kF:(s=FF(t,e,n,n),s?(r.mode=LF,MF):(r.havedict=1,nu))}Cs.inflateReset=OF;Cs.inflateReset2=DF;Cs.inflateResetKeep=RF;Cs.inflateInit=wce;Cs.inflateInit2=NF;Cs.inflate=Tce;Cs.inflateEnd=Sce;Cs.inflateGetHeader=Cce;Cs.inflateSetDictionary=Ice;Cs.inflateInfo="pako inflate (from Nodeca project)";var BF={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8};function Ace(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}var kce=Ace,kd=Cs,op=fa,h0=gu,cn=BF,Qx=r4,Mce=SF,Pce=kce,UF=Object.prototype.toString;function ru(t){if(!(this instanceof ru))return new ru(t);this.options=op.assign({chunkSize:16384,windowBits:0,to:""},t||{});var e=this.options;e.raw&&e.windowBits>=0&&e.windowBits<16&&(e.windowBits=-e.windowBits,e.windowBits===0&&(e.windowBits=-15)),e.windowBits>=0&&e.windowBits<16&&!(t&&t.windowBits)&&(e.windowBits+=32),e.windowBits>15&&e.windowBits<48&&(e.windowBits&15||(e.windowBits|=15)),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new Mce,this.strm.avail_out=0;var n=kd.inflateInit2(this.strm,e.windowBits);if(n!==cn.Z_OK)throw new Error(Qx[n]);if(this.header=new Pce,kd.inflateGetHeader(this.strm,this.header),e.dictionary&&(typeof e.dictionary=="string"?e.dictionary=h0.string2buf(e.dictionary):UF.call(e.dictionary)==="[object ArrayBuffer]"&&(e.dictionary=new Uint8Array(e.dictionary)),e.raw&&(n=kd.inflateSetDictionary(this.strm,e.dictionary),n!==cn.Z_OK)))throw new Error(Qx[n])}ru.prototype.push=function(t,e){var n=this.strm,r=this.options.chunkSize,i=this.options.dictionary,s,o,a,l,c,u=!1;if(this.ended)return!1;o=e===~~e?e:e===!0?cn.Z_FINISH:cn.Z_NO_FLUSH,typeof t=="string"?n.input=h0.binstring2buf(t):UF.call(t)==="[object ArrayBuffer]"?n.input=new Uint8Array(t):n.input=t,n.next_in=0,n.avail_in=n.input.length;do{if(n.avail_out===0&&(n.output=new op.Buf8(r),n.next_out=0,n.avail_out=r),s=kd.inflate(n,cn.Z_NO_FLUSH),s===cn.Z_NEED_DICT&&i&&(s=kd.inflateSetDictionary(this.strm,i)),s===cn.Z_BUF_ERROR&&u===!0&&(s=cn.Z_OK,u=!1),s!==cn.Z_STREAM_END&&s!==cn.Z_OK)return this.onEnd(s),this.ended=!0,!1;n.next_out&&(n.avail_out===0||s===cn.Z_STREAM_END||n.avail_in===0&&(o===cn.Z_FINISH||o===cn.Z_SYNC_FLUSH))&&(this.options.to==="string"?(a=h0.utf8border(n.output,n.next_out),l=n.next_out-a,c=h0.buf2string(n.output,a),n.next_out=l,n.avail_out=r-l,l&&op.arraySet(n.output,n.output,a,l,0),this.onData(c)):this.onData(op.shrinkBuf(n.output,n.next_out))),n.avail_in===0&&n.avail_out===0&&(u=!0)}while((n.avail_in>0||n.avail_out===0)&&s!==cn.Z_STREAM_END);return s===cn.Z_STREAM_END&&(o=cn.Z_FINISH),o===cn.Z_FINISH?(s=kd.inflateEnd(this.strm),this.onEnd(s),this.ended=!0,s===cn.Z_OK):(o===cn.Z_SYNC_FLUSH&&(this.onEnd(cn.Z_OK),n.avail_out=0),!0)};ru.prototype.onData=function(t){this.chunks.push(t)};ru.prototype.onEnd=function(t){t===cn.Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=op.flattenChunks(this.chunks)),this.chunks=[],this.err=t,this.msg=this.strm.msg};function s4(t,e){var n=new ru(e);if(n.push(t,!0),n.err)throw n.msg||Qx[n.err];return n.result}function Lce(t,e){return e=e||{},e.raw=!0,s4(t,e)}Jm.Inflate=ru;Jm.inflate=s4;Jm.inflateRaw=Lce;Jm.ungzip=s4;var Rce=fa.assign,Oce=Zm,Dce=Jm,Nce=BF,$F={};Rce($F,Oce,Dce,Nce);var y2=$F;const f0=12,Fce=()=>{const t=new Uint8Array(f0);return window.crypto.getRandomValues(t)},o4=async t=>{const e=await window.crypto.subtle.generateKey({name:"AES-GCM",length:v7},!0,["encrypt","decrypt"]);return t==="cryptoKey"?e:(await window.crypto.subtle.exportKey("jwk",e)).k},HF=(t,e)=>window.crypto.subtle.importKey("jwk",{alg:"A128GCM",ext:!0,k:t,key_ops:["encrypt","decrypt"],kty:"oct"},{name:"AES-GCM",length:v7},!1,[e]),v2=async(t,e)=>{const n=typeof t=="string"?await HF(t,"encrypt"):t,r=Fce(),i=typeof e=="string"?new TextEncoder().encode(e):e instanceof Uint8Array?e:e instanceof Blob?await Wa(e):e;return{encryptedBuffer:await window.crypto.subtle.encrypt({name:"AES-GCM",iv:r},n,i),iv:r}},dm=async(t,e,n)=>{const r=await HF(n,"decrypt");return window.crypto.subtle.decrypt({name:"AES-GCM",iv:t},r,e)},e3=t=>new Promise((e,n)=>{const r=typeof t=="string"?new Blob([new TextEncoder().encode(t)]):new Blob([t instanceof Uint8Array?t:new Uint8Array(t)]),i=new FileReader;i.onload=s=>{if(!s.target||typeof s.target.result!="string")return n(new Error("couldn't convert to byte string"));e(s.target.result)},i.readAsBinaryString(r)}),zF=t=>{const e=new ArrayBuffer(t.length),n=new Uint8Array(e);for(let r=0,i=t.length;r<i;r++)n[r]=t.charCodeAt(r);return e},GF=t=>new TextDecoder("utf-8").decode(zF(t)),Bce=async(t,e=!1)=>e?window.btoa(t):window.btoa(await e3(t)),Uce=async(t,e=!1)=>e?window.atob(t):GF(window.atob(t)),VF=async({text:t,compress:e})=>{let n;if(e!==!1)try{n=await e3(y2.deflate(t))}catch(r){console.error("encode: cannot deflate",r)}return{version:"1",encoding:"bstring",compressed:!!n,encoded:n||await e3(t)}},WF=async t=>{let e;switch(t.encoding){case"bstring":e=t.compressed?t.encoded:await GF(t.encoded);break;default:throw new Error(`decode: unknown encoding "${t.encoding}"`)}return t.compressed?y2.inflate(new Uint8Array(zF(e)),{to:"string"}):e},jF=1,p0=4,Md=4,N_={1:8,2:16,4:32};function Uy(t,e,n,r){if(r!=null){if(r>Math.pow(2,N_[e])-1)throw new Error(`attempting to set value higher than the allocated bytes (value: ${r}, bytes: ${e})`);const s=`setUint${N_[e]}`;return new DataView(t.buffer)[s](n,r),t}const i=`getUint${N_[e]}`;return new DataView(t.buffer)[i](n)}const Mk=(...t)=>{const e=new Uint8Array(p0+Md*t.length+t.reduce((r,i)=>r+i.byteLength,0));let n=0;Uy(e,p0,n,jF),n+=p0;for(const r of t)Uy(e,Md,n,r.byteLength),n+=Md,e.set(r,n),n+=r.byteLength;return e},Pk=t=>{const e=[];let n=0;const r=Uy(t,Md,n);if(r>jF)throw new Error(`invalid version ${r}`);for(n+=p0;;){const i=Uy(t,Md,n);if(n+=Md,e.push(t.slice(n,n+i)),n+=i,n>=t.byteLength)break}return e},$ce=async(t,e)=>{const{encryptedBuffer:n,iv:r}=await v2(e,y2.deflate(t));return{iv:r,buffer:new Uint8Array(n)}},XF=async(t,e)=>{const n={version:2,compression:"pako@1",encryption:"AES-GCM"},r=new TextEncoder().encode(JSON.stringify(n)),i=new TextEncoder().encode(JSON.stringify(e.metadata||null)),{iv:s,buffer:o}=await $ce(Mk(i,t),e.encryptionKey);return Mk(r,s,o)},Hce=async(t,e,n,r)=>(e=new Uint8Array(await dm(t,e,n)),r?y2.inflate(e):e),YF=async(t,e)=>{const[n,r,i]=Pk(t),s=JSON.parse(new TextDecoder().decode(n));try{const[o,a]=Pk(await Hce(r,i,e.decryptionKey,!!s.compression));return{metadata:JSON.parse(new TextDecoder().decode(o)),data:a}}catch(o){throw console.error("Error during decompressing and decrypting the file.",s),o}},ZF=async t=>{const n=QN(new Uint8Array(await Wa(t))).find(r=>r.name==="tEXt");return n?f2.decode(n.data):null},KF=async({blob:t,metadata:e})=>{const n=QN(new Uint8Array(await Wa(t))),r=f2.encode(Oe.excalidraw,JSON.stringify(await VF({text:e,compress:!0})));return n.splice(-1,0,r),new Blob([Wae(n)],{type:Oe.png})},zce=async t=>{const e=await ZF(t);if((e==null?void 0:e.keyword)===Oe.excalidraw)try{const n=JSON.parse(e.text);if(!("encoded"in n)){if("type"in n&&n.type===ki.excalidraw)return e.text;throw new Error("FAILED")}return await WF(n)}catch(n){throw console.error(n),new Error("FAILED")}throw new Error("INVALID")},Gce=async({text:t})=>{const e=await Bce(JSON.stringify(await VF({text:t})),!0);let n="";return n+=`<!-- payload-type:${Oe.excalidraw} -->`,n+="<!-- payload-version:2 -->",n+="<!-- payload-start -->",n+=e,n+="<!-- payload-end -->",n},Vce=async({svg:t})=>{if(t.includes(`payload-type:${Oe.excalidraw}`)){const e=t.match(/<!-- payload-start -->\s*(.+?)\s*<!-- payload-end -->/);if(!e)throw new Error("INVALID");const n=t.match(/<!-- payload-version:(\d+) -->/),i=((n==null?void 0:n[1])||"1")!=="1";try{const s=await Uce(e[1],i),o=JSON.parse(s);if(!("encoded"in o)){if("type"in o&&o.type===ki.excalidraw)return s;throw new Error("FAILED")}return await WF(o)}catch(s){throw console.error(s),new Error("FAILED")}}throw new Error("INVALID")},$y=Object.freeze(Object.defineProperty({__proto__:null,decodePngMetadata:zce,decodeSvgMetadata:Vce,encodePngMetadata:KF,encodeSvgMetadata:Gce,getTEXtChunk:ZF},Symbol.toStringTag,{value:"Module"}));function Lk(t){return[Math.min(t[0][0],t[1][0]),Math.min(t[0][1],t[1][1]),Math.max(t[0][0],t[1][0]),Math.max(t[0][1],t[1][1])]}function qF(t,e){return t[0]*e[1]-e[0]*t[1]}function Wce(t,e){return t[0]<=e[2]&&t[2]>=e[0]&&t[1]<=e[3]&&t[3]>=e[1]}function Hy(t,e){return[t[0]-e[0],t[1]-e[1]]}const jce=1e-6;function Rk(t,e){const n=Hy(t[1],t[0]),r=Hy(e,t[0]),i=qF(n,r);return Math.abs(i)<jce}function F_(t,e){const n=Hy(t[1],t[0]),r=Hy(e,t[0]);return qF(n,r)<0}function Ok(t,e){return Rk(t,e[0])||Rk(t,e[1])||(F_(t,e[0])?!F_(t,e[1]):F_(t,e[1]))}function Xce(t,e){return Wce(Lk(t),Lk(e))&&Ok(t,e)&&Ok(e,t)}const Yce=t=>t.type==="diamond"?[[t.width/2,0],[t.width,t.height/2],[t.width/2,t.height],[0,t.height/2]]:[[0,0],[0+t.width,0],[0+t.width,t.height],[0,t.height]],Zce=t=>Je(t)||Zr(t)?t.points:Yce(t),Dk=t=>{const e=t.reduce((n,[r,i])=>(n.minY=Math.min(n.minY,i),n.minX=Math.min(n.minX,r),n.maxX=Math.max(n.maxX,r),n.maxY=Math.max(n.maxY,i),n),{minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0,cx:0,cy:0});return e.cx=(e.maxX+e.minX)/2,e.cy=(e.maxY+e.minY)/2,e},JF=t=>{const e=Zce(t),{cx:n,cy:r}=Dk(e),i=[n,r],s=e.map(u=>Wt([u[0],u[1]],i,t.angle)),{minX:o,minY:a,maxX:l,maxY:c}=Dk(s);return[o+t.x,a+t.y,l+t.x,c+t.y]},Nk=(t,e,n=!1)=>{const r=JF(t),i=e[0]<=r[0]&&e[2]>=r[2]&&e[1]<=r[1]&&e[3]>=r[3];return n?i?!0:r[0]<=e[0]&&r[2]>=e[2]&&r[1]<=e[1]&&r[3]>=e[3]:i},Kce=(t,e)=>{const n=JF(t);return(og(n[0],e[0],e[2])||og(e[0],n[0],n[2]))&&(og(n[1],e[1],e[3])||og(e[1],n[1],n[3]))},a4=({elements:t,bounds:e,type:n,errorMargin:r=0})=>{var o;IO(e)&&(e=qc(e));const i=[e[0]-r,e[1]-r,e[2]+r,e[3]+r],s=new Set;for(const a of t){if(s.has(a.id))continue;if(n==="overlap"?Kce(a,i):n==="inside"?Nk(a,i):Nk(a,i,!0)){if(s.add(a.id),a.boundElements)for(const c of a.boundElements)s.add(c.id);Se(a)&&a.containerId&&s.add(a.containerId),Ct(a)&&(a.startBinding&&s.add(a.startBinding.elementId),a.endBinding&&s.add((o=a.endBinding)==null?void 0:o.elementId))}}return t.filter(a=>s.has(a.id))},QF=Yn(new Map),Fk=async t=>await nB({elements:t,appState:{exportBackground:!1,viewBackgroundColor:Ge.white},files:null,renderEmbeddables:!1}),qce=(t,e,n)=>{const[r,i]=A.useState();return A.useEffect(()=>{if(e)if(t){const s=n.get(t);s?i(s):(async()=>{var a;const o=await Fk(e);(a=o.querySelector(".style-fonts"))==null||a.remove(),o&&(n.set(t,o),i(o))})()}else(async()=>{const s=await Fk(e);i(s)})()},[t,e,n,i]),r},eB=()=>{const[t]=Ht(QF,rr);return{clearLibraryCache:()=>t.clear(),deleteItemsFromLibraryCache:r=>{r.forEach(i=>t.delete(i))},svgCache:t}},hm=Yn({status:"loaded",isInitialized:!0,libraryItems:[]}),B_=t=>Hc(t),Jce=(t,e)=>!t.find(n=>n.elements.length!==e.elements.length?!1:n.elements.every((r,i)=>r.id===e.elements[i].id&&r.versionNonce===e.elements[i].versionNonce)),Qce=(t,e)=>{const n=[];for(const r of e)Jce(t,r)&&n.push(r);return[...n,...t]};class eue{constructor(e){O(this,"lastLibraryItems",[]);O(this,"isInitialized",!1);O(this,"app");O(this,"updateQueue",[]);O(this,"getLastUpdateTask",()=>this.updateQueue[this.updateQueue.length-1]);O(this,"notifyListeners",()=>{var e,n;if(this.updateQueue.length>0)zo.set(hm,{status:"loading",libraryItems:this.lastLibraryItems,isInitialized:this.isInitialized});else{this.isInitialized=!0,zo.set(hm,{status:"loaded",libraryItems:this.lastLibraryItems,isInitialized:this.isInitialized});try{(n=(e=this.app.props).onLibraryChange)==null||n.call(e,B_(this.lastLibraryItems))}catch(r){console.error(r)}}});O(this,"destroy",()=>{this.isInitialized=!1,this.updateQueue=[],this.lastLibraryItems=[],zo.set(QF,new Map)});O(this,"resetLibrary",()=>this.setLibrary([]));O(this,"getLatestLibrary",()=>new Promise(async e=>{try{const n=await(this.getLastUpdateTask()||this.lastLibraryItems);this.updateQueue.length>0?e(this.getLatestLibrary()):e(B_(n))}catch{return e(this.lastLibraryItems)}}));O(this,"updateLibrary",async({libraryItems:e,prompt:n=!1,merge:r=!1,openLibraryMenu:i=!1,defaultStatus:s="unpublished"})=>(i&&this.app.setState({openSidebar:{name:bd.name,tab:RT}}),this.setLibrary(()=>new Promise(async(o,a)=>{try{const l=await(typeof e=="function"&&!(e instanceof Blob)?e(this.lastLibraryItems):e);let c;l instanceof Blob?c=await fae(l,s):c=BN(l,s),!n||window.confirm(I("alerts.confirmAddLibrary",{numShapes:c.length}))?(n&&this.app.focusContainer(),o(r?Qce(this.lastLibraryItems,c):c)):a(new Zp)}catch(l){a(l)}}))));O(this,"setLibrary",e=>{const n=new Promise(async(r,i)=>{try{await this.getLastUpdateTask(),typeof e=="function"&&(e=e(this.lastLibraryItems)),this.lastLibraryItems=B_(await e),r(this.lastLibraryItems)}catch(s){i(s)}}).catch(r=>{if(r.name==="AbortError")return console.warn("Library update aborted by user"),this.lastLibraryItems;throw r}).finally(()=>{this.updateQueue=this.updateQueue.filter(r=>r!==n),this.notifyListeners()});return this.updateQueue.push(n),this.notifyListeners(),n});this.app=e}}const tB=t=>{const n=Math.ceil(Math.sqrt(t.length)),r=[],i=f=>t.slice(f*n,f*n+n).reduce((m,v)=>{const{height:y}=Yo(v.elements);return Math.max(m,y)},0),s=f=>{let p=0,m=0,v=0;for(const y of t){if(p%n===0&&(m=0),m===f){const{width:b}=Yo(y.elements);v=Math.max(v,b)}p++,m++}return v};let o=0,a=0,l=0,c=0,u=0,d=0,h=0;for(const f of t){u&&u%n===0&&(a+=l+50,o=0,d=0,h++),d===0&&(l=i(h)),c=s(d);const{minX:p,minY:m,width:v,height:y}=Yo(f.elements),b=(c-v)/2,_=(l-y)/2;r.push(...f.elements.map(E=>({...E,x:E.x+o+b-p,y:E.y+a+_-m}))),o+=c+50,u++,d++}return r},t3=()=>{const t=new URLSearchParams(window.location.hash.slice(1)).get(hw.addLibrary)||new URLSearchParams(window.location.search).get(dw.addLibrary),e=t?new URLSearchParams(window.location.hash.slice(1)).get("token"):null;return t?{libraryUrl:t,idToken:e}:null},tue=({excalidrawAPI:t,getInitialLibraryItems:e})=>{const n=A.useRef(e);A.useEffect(()=>{if(!t)return;const r=async({libraryUrl:o,idToken:a})=>{const l=new Promise(async(u,d)=>{try{const f=await(await fetch(decodeURIComponent(o))).blob();u(f)}catch(h){d(h)}}),c=a!==t.id;await(c&&document.hidden?new Promise(u=>{window.addEventListener("focus",()=>u(),{once:!0})}):null);try{await t.updateLibrary({libraryItems:l,prompt:c,merge:!0,defaultStatus:"published",openLibraryMenu:!0})}catch(u){throw u}finally{if(window.location.hash.includes(hw.addLibrary)){const u=new URLSearchParams(window.location.hash.slice(1));u.delete(hw.addLibrary),window.history.replaceState({},Ho,`#${u.toString()}`)}else if(window.location.search.includes(dw.addLibrary)){const u=new URLSearchParams(window.location.search);u.delete(dw.addLibrary),window.history.replaceState({},Ho,`?${u.toString()}`)}}},i=o=>{o.preventDefault();const a=t3();a&&(o.stopImmediatePropagation(),window.history.replaceState({},"",o.oldURL),r(a))};n.current&&t.updateLibrary({libraryItems:n.current()});const s=t3();return s&&r(s),window.addEventListener(ee.HASHCHANGE,i),()=>{window.removeEventListener(ee.HASHCHANGE,i)}},[t])},b2=({elements:t,appState:e,files:n,maxWidthOrHeight:r,getDimensions:i,exportPadding:s,exportingFrame:o})=>{const{elements:a,appState:l}=Jc({elements:t,appState:e},null,null),{exportBackground:c,viewBackgroundColor:u}=l;return JN(a,{...l,offsetTop:0,offsetLeft:0,width:0,height:0},n||{},{exportBackground:c,exportPadding:s,viewBackgroundColor:u,exportingFrame:o},(d,h)=>{const f=document.createElement("canvas");if(r){typeof i=="function"&&console.warn("`getDimensions()` is ignored when `maxWidthOrHeight` is supplied.");const m=Math.max(d,h),v=r<m?r/m:(e==null?void 0:e.exportScale)??1;return f.width=d*v,f.height=h*v,{canvas:f,scale:v}}const p=(i==null?void 0:i(d,h))||{width:d,height:h};return f.width=p.width,f.height=p.height,{canvas:f,scale:p.scale??1}})},nue=async t=>{var i;let{mimeType:e=Oe.png,quality:n}=t;e===Oe.png&&typeof n=="number"&&console.warn(`"quality" will be ignored for "${Oe.png}" mimeType`),e==="image/jpg"&&(e=Oe.jpg),e===Oe.jpg&&!((i=t.appState)!=null&&i.exportBackground)&&(console.warn(`Defaulting "exportBackground" to "true" for "${Oe.jpg}" mimeType`),t={...t,appState:{...t.appState,exportBackground:!0}});const r=await b2(t);return n=n||(/image\/jpe?g/.test(e)?.92:.8),new Promise((s,o)=>{r.toBlob(async a=>{var l;if(!a)return o(new Error("couldn't export to blob"));a&&e===Oe.png&&((l=t.appState)!=null&&l.exportEmbedScene)&&(a=await KF({blob:a,metadata:vh(t.elements,t.appState,t.files||{},"local")})),s(a)},e,n)})},nB=async({elements:t,appState:e=Es(),files:n={},exportPadding:r,renderEmbeddables:i,exportingFrame:s})=>{const{elements:o,appState:a}=Jc({elements:t,appState:e},null,null),l={...a,exportPadding:r};return KS(o,l,n,{exportingFrame:s,renderEmbeddables:i})},rB=(t,e,n)=>{const r=xn(t);for(const i of e)if(i.frameId){const s=n.get(i.id),o=n.get(i.frameId);if(s){const a=r.get(s);a&&ae(a,{frameId:o??i.frameId},!1)}}};function iB(t,e){const n=LA(e),r=LA(t);return n.some(s=>r.some(o=>Xce(s,o)))}const sB=(t,e)=>c4(u4(t,e,!1)).filter(n=>!qe(n)&&!n.frameId||n.frameId===e.id),oB=(t,e,n)=>u4(t,e).some(r=>r.id===n.id),aB=(t,e)=>{const[n,r,i,s]=Ve(e),[o,a,l,c]=Ut(t);return n<=o&&r<=a&&i>=l&&s>=c},qd=(t,e)=>aB([t],e)||iB(t,e)||oB([e],t,e),Bk=(t,e)=>{const[n,r,i,s]=Ve(e);return cd([n,r],[t.x,t.y],[i,s])},rue=t=>{const e=new Map;for(const n of t){const r=qe(n)?n.id:n.frameId;r&&!e.has(r)&&e.set(r,oa(t,r))}return e},oa=(t,e)=>t.filter(n=>n.frameId===e),l4=t=>t.filter(e=>qe(e)),lB=t=>{const e=xn(l4(t));return t.filter(n=>e.has(n.id)||!n.frameId||!e.has(n.frameId))},m0=(t,e,n)=>{const r=oa(t,e.id),i=new Set(r),s=new Set([...sB(t,e),...r.filter(d=>oB(t,d,e))]),o=r.filter(d=>!s.has(d)),a=new Set(Array.from(s).flatMap(d=>d.groupIds));for(const d of o)if(!iB(d,e))d.groupIds.length===0&&i.delete(d);else if(d.groupIds.length>0)for(const h of d.groupIds)a.add(h);for(const d of o)if(d.groupIds.length>0){let h=!0;for(const f of d.groupIds)a.has(f)&&(h=!1);h&&i.delete(d)}const l=Array.from(s).filter(d=>d.groupIds.length===0);for(const d of l)i.add(d);const c=Array.from(s).filter(d=>d.groupIds.length>0),u=FO(c,n);for(const[d,h]of Object.entries(u))if(h){const f=Gn(t,d);if(aB(f,e))for(const p of f)i.add(p)}return[...i].filter(d=>!(Se(d)&&d.containerId))},iue=(t,e)=>c4(t,sB(t,e)),Bi=(t,e)=>{var n;return t.frameId?e?e.get(t.frameId)||null:((n=bt.getScene(t))==null?void 0:n.getElement(t.frameId))||null:null},n3=(t,e,n)=>{const{currTargetFrameChildrenMap:r}=t.reduce((o,a,l)=>(a.frameId===n.id&&o.currTargetFrameChildrenMap.set(a.id,!0),o),{currTargetFrameChildrenMap:new Map}),i=new Set(e.map(o=>o.id)),s=[];for(const o of c4(t,e)){r.has(o.id)||s.push(o);const a=tt(o);a&&!i.has(a.id)&&!r.has(a.id)&&s.push(a)}for(const o of s)ae(o,{frameId:n.id},!1);return t.slice()},_2=(t,e,n)=>{const r=new Map,i=new Map;for(const s of e)if(s.frameId){r.set(s.id,s);const o=i.get(s.frameId)||[];o.push(s);const a=tt(s);a&&(r.set(a.id,a),o.push(a)),i.set(s.frameId,o)}for(const[,s]of r)ae(s,{frameId:null},!1);return t.slice()},cB=(t,e,n)=>{const r=oa(t,e.id);return _2(t,r)},uB=(t,e,n,r)=>n3(cB(t,n),e,n),Jd=(t,e,n)=>{const r=n.scene.getSelectedElements({selectedElementIds:e.selectedElementIds,elements:t}),i=new Set(r);if(e.editingGroupId)for(const o of r)o.groupIds.length===0?i.add(o):o.groupIds.flatMap(a=>Gn(t,a)).forEach(a=>i.add(a));const s=new Set;return i.forEach(o=>{o.frameId&&!qe(o)&&!iu(o,t,e)&&s.add(o)}),s.size>0?_2(t,[...s]):t},c4=(t,e)=>{const n=new Set;for(const i of e||t){const s=i.groupIds[i.groupIds.length-1];s&&n.add(s)}const r=new Set;for(const i of n)Gn(t,i).some(s=>qe(s))&&r.add(i);return(e||t).filter(i=>!r.has(i.groupIds[i.groupIds.length-1]))},fm=(t,e)=>{const n=Se(t)&&Dn(t)||t;return e.selectedElementIds[n.id]&&e.selectedElementsAreBeingDragged?e.frameToHighlight:Bi(n)},iu=(t,e,n)=>{const r=fm(t,n),i=Se(t)&&Dn(t)||t;if(r){if(!n.selectedElementIds[t.id]||!n.selectedElementsAreBeingDragged)return!0;if(i.groupIds.length===0)return qd(i,r);const s=new Set(i.groupIds.flatMap(o=>Gn(e,o)));if(n.editingGroupId&&n.selectedElementsAreBeingDragged){const o=new Set(Rt(e,n));if(n.frameToHighlight!==null)return!0;o.forEach(l=>{s.delete(l)})}for(const o of s)if(qe(o))return!1;for(const o of s)if(qd(o,r))return!0}return!1},dB=(t,e)=>{var r;const n=(r=t.name)==null?void 0:r.trim();return n||(Wp(t)?`Frame ${e}`:`AI Frame ${e}`)},E2=t=>{const e=new Set;return t.forEach(n=>{qe(n)&&e.add(n.id)}),t.filter(n=>!(n.frameId&&e.has(n.frameId)))},u4=(t,e,n=!0)=>{const[r,i,s,o]=Ve(e);let a=t.filter(l=>{let[c,u,d,h]=qc(l);const f=Bi(l);if(f){const[p,m,v,y]=qc(f);c=Math.max(p,c),u=Math.max(m,u),d=Math.min(v,d),h=Math.min(y,h)}return l.locked===!1&&l.type!=="selection"&&!nn(l)&&r<=c&&i<=u&&s>=d&&o>=h});return a=n?E2(a):a,a=a.filter(l=>{const c=Bi(l);return c?qd(l,c):!0}),a},hB=(t,e,n)=>{const r=new Set(e.map(i=>i.id));return t.filter(i=>{const s=Zy(i,n.width,n.height,n);return!r.has(i.id)&&s})},wn=function(){let t=null,e=null,n=null;const r=(i,s)=>(n!=null&&i===t&&s.selectedElementIds===e||(n=i.some(o=>s.selectedElementIds[o.id]),t=i,e=s.selectedElementIds),n);return r.clearCache=()=>{t=null,e=null,n=null},r}(),sue=(t,e,n)=>{const r=Array.from(new Set(Rt(t,e).map(i=>n(i))));return r.length===1?r[0]:null},Rt=(t,e,n)=>{const r=t.filter(i=>e.selectedElementIds[i.id]||n!=null&&n.includeBoundTextElement&&nn(i)&&e.selectedElementIds[i==null?void 0:i.containerId]?i:null);if(n!=null&&n.includeElementsInFrames){const i=[];return r.forEach(s=>{qe(s)&&oa(t,s.id).forEach(o=>i.push(o)),i.push(s)}),i}return r},d4=(t,e)=>e.editingElement?[e.editingElement]:Rt(t,e,{includeBoundTextElement:!0}),gt=(t,e)=>Pr(e.selectedElementIds,t)?e.selectedElementIds:t,oue=t=>{const e=["includeBoundTextElement","includeElementsInFrames"];let n="";for(const r of e)n+=`${r}:${t[r]?"1":"0"}`;return n},Uk=t=>typeof t=="string",cc=class cc{constructor(){O(this,"callbacks",new Set);O(this,"nonDeletedElements",[]);O(this,"elements",[]);O(this,"nonDeletedFramesLikes",[]);O(this,"frames",[]);O(this,"elementsMap",new Map);O(this,"selectedElementsCache",{selectedElementIds:null,elements:null,cache:new Map});O(this,"versionNonce");O(this,"addNewElement",e=>{e.frameId?this.insertElementAtIndex(e,this.getElementIndex(e.frameId)):this.replaceAllElements([...this.elements,e])})}static mapElementToScene(e,n,r=!0){if(Uk(e)){if(!r)return;this.sceneMapById.set(e,n)}else this.sceneMapByElement.set(e,n),r||this.sceneMapById.set(e.id,n)}static getScene(e){return Uk(e)?this.sceneMapById.get(e)||null:this.sceneMapByElement.get(e)||null}getElementsIncludingDeleted(){return this.elements}getNonDeletedElements(){return this.nonDeletedElements}getFramesIncludingDeleted(){return this.frames}getSelectedElements(e){const n=oue(e),r=(e==null?void 0:e.elements)||this.nonDeletedElements;if(this.selectedElementsCache.elements===r&&this.selectedElementsCache.selectedElementIds===e.selectedElementIds){const s=this.selectedElementsCache.cache.get(n);if(s)return s}else(e==null?void 0:e.elements)==null&&this.selectedElementsCache.cache.clear();const i=Rt(r,{selectedElementIds:e.selectedElementIds},e);return(e==null?void 0:e.elements)==null&&(this.selectedElementsCache.selectedElementIds=e.selectedElementIds,this.selectedElementsCache.elements=this.nonDeletedElements,this.selectedElementsCache.cache.set(n,i)),i}getNonDeletedFramesLikes(){return this.nonDeletedFramesLikes}getElement(e){return this.elementsMap.get(e)||null}getVersionNonce(){return this.versionNonce}getNonDeletedElement(e){const n=this.getElement(e);return n&&u3(n)?n:null}mapElements(e){let n=!1;const r=this.elements.map(i=>{const s=e(i);return s!==i&&(n=!0),s});return n&&this.replaceAllElements(r),n}replaceAllElements(e,n=!0){this.elements=e;const r=[];this.elementsMap.clear(),e.forEach(i=>{qe(i)&&r.push(i),this.elementsMap.set(i.id,i),cc.mapElementToScene(i,this)}),this.nonDeletedElements=yt(this.elements),this.frames=r,this.nonDeletedFramesLikes=yt(this.frames),this.informMutation()}informMutation(){this.versionNonce=Rl();for(const e of Array.from(this.callbacks))e()}addCallback(e){if(this.callbacks.has(e))throw new Error;return this.callbacks.add(e),()=>{if(!this.callbacks.has(e))throw new Error;this.callbacks.delete(e)}}destroy(){this.nonDeletedElements=[],this.elements=[],this.nonDeletedFramesLikes=[],this.frames=[],this.elementsMap.clear(),this.selectedElementsCache.selectedElementIds=null,this.selectedElementsCache.elements=null,this.selectedElementsCache.cache.clear(),cc.sceneMapById.forEach((e,n)=>{e===this&&cc.sceneMapById.delete(n)}),this.callbacks.clear()}insertElementAtIndex(e,n){if(!Number.isFinite(n)||n<0)throw new Error("insertElementAtIndex can only be called with index >= 0");const r=[...this.elements.slice(0,n),e,...this.elements.slice(n)];this.replaceAllElements(r)}insertElementsAtIndex(e,n){if(!Number.isFinite(n)||n<0)throw new Error("insertElementAtIndex can only be called with index >= 0");const r=[...this.elements.slice(0,n),...e,...this.elements.slice(n)];this.replaceAllElements(r)}getElementIndex(e){return this.elements.findIndex(n=>n.id===e)}};O(cc,"sceneMapByElement",new WeakMap),O(cc,"sceneMapById",new Map);let r3=cc;const bt=r3;function zy(t){"@babel/helpers - typeof";return zy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},zy(t)}var aue=/^\s+/,lue=/\s+$/;function Pe(t,e){if(t=t||"",e=e||{},t instanceof Pe)return t;if(!(this instanceof Pe))return new Pe(t,e);var n=cue(t);this._originalInput=t,this._r=n.r,this._g=n.g,this._b=n.b,this._a=n.a,this._roundA=Math.round(100*this._a)/100,this._format=e.format||n.format,this._gradientType=e.gradientType,this._r<1&&(this._r=Math.round(this._r)),this._g<1&&(this._g=Math.round(this._g)),this._b<1&&(this._b=Math.round(this._b)),this._ok=n.ok}Pe.prototype={isDark:function(){return this.getBrightness()<128},isLight:function(){return!this.isDark()},isValid:function(){return this._ok},getOriginalInput:function(){return this._originalInput},getFormat:function(){return this._format},getAlpha:function(){return this._a},getBrightness:function(){var e=this.toRgb();return(e.r*299+e.g*587+e.b*114)/1e3},getLuminance:function(){var e=this.toRgb(),n,r,i,s,o,a;return n=e.r/255,r=e.g/255,i=e.b/255,n<=.03928?s=n/12.92:s=Math.pow((n+.055)/1.055,2.4),r<=.03928?o=r/12.92:o=Math.pow((r+.055)/1.055,2.4),i<=.03928?a=i/12.92:a=Math.pow((i+.055)/1.055,2.4),.2126*s+.7152*o+.0722*a},setAlpha:function(e){return this._a=fB(e),this._roundA=Math.round(100*this._a)/100,this},toHsv:function(){var e=Hk(this._r,this._g,this._b);return{h:e.h*360,s:e.s,v:e.v,a:this._a}},toHsvString:function(){var e=Hk(this._r,this._g,this._b),n=Math.round(e.h*360),r=Math.round(e.s*100),i=Math.round(e.v*100);return this._a==1?"hsv("+n+", "+r+"%, "+i+"%)":"hsva("+n+", "+r+"%, "+i+"%, "+this._roundA+")"},toHsl:function(){var e=$k(this._r,this._g,this._b);return{h:e.h*360,s:e.s,l:e.l,a:this._a}},toHslString:function(){var e=$k(this._r,this._g,this._b),n=Math.round(e.h*360),r=Math.round(e.s*100),i=Math.round(e.l*100);return this._a==1?"hsl("+n+", "+r+"%, "+i+"%)":"hsla("+n+", "+r+"%, "+i+"%, "+this._roundA+")"},toHex:function(e){return zk(this._r,this._g,this._b,e)},toHexString:function(e){return"#"+this.toHex(e)},toHex8:function(e){return fue(this._r,this._g,this._b,this._a,e)},toHex8String:function(e){return"#"+this.toHex8(e)},toRgb:function(){return{r:Math.round(this._r),g:Math.round(this._g),b:Math.round(this._b),a:this._a}},toRgbString:function(){return this._a==1?"rgb("+Math.round(this._r)+", "+Math.round(this._g)+", "+Math.round(this._b)+")":"rgba("+Math.round(this._r)+", "+Math.round(this._g)+", "+Math.round(this._b)+", "+this._roundA+")"},toPercentageRgb:function(){return{r:Math.round(Gt(this._r,255)*100)+"%",g:Math.round(Gt(this._g,255)*100)+"%",b:Math.round(Gt(this._b,255)*100)+"%",a:this._a}},toPercentageRgbString:function(){return this._a==1?"rgb("+Math.round(Gt(this._r,255)*100)+"%, "+Math.round(Gt(this._g,255)*100)+"%, "+Math.round(Gt(this._b,255)*100)+"%)":"rgba("+Math.round(Gt(this._r,255)*100)+"%, "+Math.round(Gt(this._g,255)*100)+"%, "+Math.round(Gt(this._b,255)*100)+"%, "+this._roundA+")"},toName:function(){return this._a===0?"transparent":this._a<1?!1:Sue[zk(this._r,this._g,this._b,!0)]||!1},toFilter:function(e){var n="#"+Gk(this._r,this._g,this._b,this._a),r=n,i=this._gradientType?"GradientType = 1, ":"";if(e){var s=Pe(e);r="#"+Gk(s._r,s._g,s._b,s._a)}return"progid:DXImageTransform.Microsoft.gradient("+i+"startColorstr="+n+",endColorstr="+r+")"},toString:function(e){var n=!!e;e=e||this._format;var r=!1,i=this._a<1&&this._a>=0,s=!n&&i&&(e==="hex"||e==="hex6"||e==="hex3"||e==="hex4"||e==="hex8"||e==="name");return s?e==="name"&&this._a===0?this.toName():this.toRgbString():(e==="rgb"&&(r=this.toRgbString()),e==="prgb"&&(r=this.toPercentageRgbString()),(e==="hex"||e==="hex6")&&(r=this.toHexString()),e==="hex3"&&(r=this.toHexString(!0)),e==="hex4"&&(r=this.toHex8String(!0)),e==="hex8"&&(r=this.toHex8String()),e==="name"&&(r=this.toName()),e==="hsl"&&(r=this.toHslString()),e==="hsv"&&(r=this.toHsvString()),r||this.toHexString())},clone:function(){return Pe(this.toString())},_applyModification:function(e,n){var r=e.apply(null,[this].concat([].slice.call(n)));return this._r=r._r,this._g=r._g,this._b=r._b,this.setAlpha(r._a),this},lighten:function(){return this._applyModification(yue,arguments)},brighten:function(){return this._applyModification(vue,arguments)},darken:function(){return this._applyModification(bue,arguments)},desaturate:function(){return this._applyModification(pue,arguments)},saturate:function(){return this._applyModification(mue,arguments)},greyscale:function(){return this._applyModification(gue,arguments)},spin:function(){return this._applyModification(_ue,arguments)},_applyCombination:function(e,n){return e.apply(null,[this].concat([].slice.call(n)))},analogous:function(){return this._applyCombination(xue,arguments)},complement:function(){return this._applyCombination(Eue,arguments)},monochromatic:function(){return this._applyCombination(Tue,arguments)},splitcomplement:function(){return this._applyCombination(wue,arguments)},triad:function(){return this._applyCombination(Vk,[3])},tetrad:function(){return this._applyCombination(Vk,[4])}};Pe.fromRatio=function(t,e){if(zy(t)=="object"){var n={};for(var r in t)t.hasOwnProperty(r)&&(r==="a"?n[r]=t[r]:n[r]=Mf(t[r]));t=n}return Pe(t,e)};function cue(t){var e={r:0,g:0,b:0},n=1,r=null,i=null,s=null,o=!1,a=!1;return typeof t=="string"&&(t=kue(t)),zy(t)=="object"&&(Co(t.r)&&Co(t.g)&&Co(t.b)?(e=uue(t.r,t.g,t.b),o=!0,a=String(t.r).substr(-1)==="%"?"prgb":"rgb"):Co(t.h)&&Co(t.s)&&Co(t.v)?(r=Mf(t.s),i=Mf(t.v),e=hue(t.h,r,i),o=!0,a="hsv"):Co(t.h)&&Co(t.s)&&Co(t.l)&&(r=Mf(t.s),s=Mf(t.l),e=due(t.h,r,s),o=!0,a="hsl"),t.hasOwnProperty("a")&&(n=t.a)),n=fB(n),{ok:o,format:t.format||a,r:Math.min(255,Math.max(e.r,0)),g:Math.min(255,Math.max(e.g,0)),b:Math.min(255,Math.max(e.b,0)),a:n}}function uue(t,e,n){return{r:Gt(t,255)*255,g:Gt(e,255)*255,b:Gt(n,255)*255}}function $k(t,e,n){t=Gt(t,255),e=Gt(e,255),n=Gt(n,255);var r=Math.max(t,e,n),i=Math.min(t,e,n),s,o,a=(r+i)/2;if(r==i)s=o=0;else{var l=r-i;switch(o=a>.5?l/(2-r-i):l/(r+i),r){case t:s=(e-n)/l+(e<n?6:0);break;case e:s=(n-t)/l+2;break;case n:s=(t-e)/l+4;break}s/=6}return{h:s,s:o,l:a}}function due(t,e,n){var r,i,s;t=Gt(t,360),e=Gt(e,100),n=Gt(n,100);function o(c,u,d){return d<0&&(d+=1),d>1&&(d-=1),d<1/6?c+(u-c)*6*d:d<1/2?u:d<2/3?c+(u-c)*(2/3-d)*6:c}if(e===0)r=i=s=n;else{var a=n<.5?n*(1+e):n+e-n*e,l=2*n-a;r=o(l,a,t+1/3),i=o(l,a,t),s=o(l,a,t-1/3)}return{r:r*255,g:i*255,b:s*255}}function Hk(t,e,n){t=Gt(t,255),e=Gt(e,255),n=Gt(n,255);var r=Math.max(t,e,n),i=Math.min(t,e,n),s,o,a=r,l=r-i;if(o=r===0?0:l/r,r==i)s=0;else{switch(r){case t:s=(e-n)/l+(e<n?6:0);break;case e:s=(n-t)/l+2;break;case n:s=(t-e)/l+4;break}s/=6}return{h:s,s:o,v:a}}function hue(t,e,n){t=Gt(t,360)*6,e=Gt(e,100),n=Gt(n,100);var r=Math.floor(t),i=t-r,s=n*(1-e),o=n*(1-i*e),a=n*(1-(1-i)*e),l=r%6,c=[n,o,s,s,a,n][l],u=[a,n,n,o,s,s][l],d=[s,s,a,n,n,o][l];return{r:c*255,g:u*255,b:d*255}}function zk(t,e,n,r){var i=[cs(Math.round(t).toString(16)),cs(Math.round(e).toString(16)),cs(Math.round(n).toString(16))];return r&&i[0].charAt(0)==i[0].charAt(1)&&i[1].charAt(0)==i[1].charAt(1)&&i[2].charAt(0)==i[2].charAt(1)?i[0].charAt(0)+i[1].charAt(0)+i[2].charAt(0):i.join("")}function fue(t,e,n,r,i){var s=[cs(Math.round(t).toString(16)),cs(Math.round(e).toString(16)),cs(Math.round(n).toString(16)),cs(pB(r))];return i&&s[0].charAt(0)==s[0].charAt(1)&&s[1].charAt(0)==s[1].charAt(1)&&s[2].charAt(0)==s[2].charAt(1)&&s[3].charAt(0)==s[3].charAt(1)?s[0].charAt(0)+s[1].charAt(0)+s[2].charAt(0)+s[3].charAt(0):s.join("")}function Gk(t,e,n,r){var i=[cs(pB(r)),cs(Math.round(t).toString(16)),cs(Math.round(e).toString(16)),cs(Math.round(n).toString(16))];return i.join("")}Pe.equals=function(t,e){return!t||!e?!1:Pe(t).toRgbString()==Pe(e).toRgbString()};Pe.random=function(){return Pe.fromRatio({r:Math.random(),g:Math.random(),b:Math.random()})};function pue(t,e){e=e===0?0:e||10;var n=Pe(t).toHsl();return n.s-=e/100,n.s=w2(n.s),Pe(n)}function mue(t,e){e=e===0?0:e||10;var n=Pe(t).toHsl();return n.s+=e/100,n.s=w2(n.s),Pe(n)}function gue(t){return Pe(t).desaturate(100)}function yue(t,e){e=e===0?0:e||10;var n=Pe(t).toHsl();return n.l+=e/100,n.l=w2(n.l),Pe(n)}function vue(t,e){e=e===0?0:e||10;var n=Pe(t).toRgb();return n.r=Math.max(0,Math.min(255,n.r-Math.round(255*-(e/100)))),n.g=Math.max(0,Math.min(255,n.g-Math.round(255*-(e/100)))),n.b=Math.max(0,Math.min(255,n.b-Math.round(255*-(e/100)))),Pe(n)}function bue(t,e){e=e===0?0:e||10;var n=Pe(t).toHsl();return n.l-=e/100,n.l=w2(n.l),Pe(n)}function _ue(t,e){var n=Pe(t).toHsl(),r=(n.h+e)%360;return n.h=r<0?360+r:r,Pe(n)}function Eue(t){var e=Pe(t).toHsl();return e.h=(e.h+180)%360,Pe(e)}function Vk(t,e){if(isNaN(e)||e<=0)throw new Error("Argument to polyad must be a positive number");for(var n=Pe(t).toHsl(),r=[Pe(t)],i=360/e,s=1;s<e;s++)r.push(Pe({h:(n.h+s*i)%360,s:n.s,l:n.l}));return r}function wue(t){var e=Pe(t).toHsl(),n=e.h;return[Pe(t),Pe({h:(n+72)%360,s:e.s,l:e.l}),Pe({h:(n+216)%360,s:e.s,l:e.l})]}function xue(t,e,n){e=e||6,n=n||30;var r=Pe(t).toHsl(),i=360/n,s=[Pe(t)];for(r.h=(r.h-(i*e>>1)+720)%360;--e;)r.h=(r.h+i)%360,s.push(Pe(r));return s}function Tue(t,e){e=e||6;for(var n=Pe(t).toHsv(),r=n.h,i=n.s,s=n.v,o=[],a=1/e;e--;)o.push(Pe({h:r,s:i,v:s})),s=(s+a)%1;return o}Pe.mix=function(t,e,n){n=n===0?0:n||50;var r=Pe(t).toRgb(),i=Pe(e).toRgb(),s=n/100,o={r:(i.r-r.r)*s+r.r,g:(i.g-r.g)*s+r.g,b:(i.b-r.b)*s+r.b,a:(i.a-r.a)*s+r.a};return Pe(o)};Pe.readability=function(t,e){var n=Pe(t),r=Pe(e);return(Math.max(n.getLuminance(),r.getLuminance())+.05)/(Math.min(n.getLuminance(),r.getLuminance())+.05)};Pe.isReadable=function(t,e,n){var r=Pe.readability(t,e),i,s;switch(s=!1,i=Mue(n),i.level+i.size){case"AAsmall":case"AAAlarge":s=r>=4.5;break;case"AAlarge":s=r>=3;break;case"AAAsmall":s=r>=7;break}return s};Pe.mostReadable=function(t,e,n){var r=null,i=0,s,o,a,l;n=n||{},o=n.includeFallbackColors,a=n.level,l=n.size;for(var c=0;c<e.length;c++)s=Pe.readability(t,e[c]),s>i&&(i=s,r=Pe(e[c]));return Pe.isReadable(t,r,{level:a,size:l})||!o?r:(n.includeFallbackColors=!1,Pe.mostReadable(t,["#fff","#000"],n))};var i3=Pe.names={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"0ff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000",blanchedalmond:"ffebcd",blue:"00f",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",burntsienna:"ea7e5d",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"0ff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkgrey:"a9a9a9",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkslategrey:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dimgrey:"696969",dodgerblue:"1e90ff",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"f0f",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",grey:"808080",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgray:"d3d3d3",lightgreen:"90ee90",lightgrey:"d3d3d3",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslategray:"789",lightslategrey:"789",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"0f0",limegreen:"32cd32",linen:"faf0e6",magenta:"f0f",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370db",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"db7093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",rebeccapurple:"663399",red:"f00",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",slategrey:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",wheat:"f5deb3",white:"fff",whitesmoke:"f5f5f5",yellow:"ff0",yellowgreen:"9acd32"},Sue=Pe.hexNames=Cue(i3);function Cue(t){var e={};for(var n in t)t.hasOwnProperty(n)&&(e[t[n]]=n);return e}function fB(t){return t=parseFloat(t),(isNaN(t)||t<0||t>1)&&(t=1),t}function Gt(t,e){Iue(t)&&(t="100%");var n=Aue(t);return t=Math.min(e,Math.max(0,parseFloat(t))),n&&(t=parseInt(t*e,10)/100),Math.abs(t-e)<1e-6?1:t%e/parseFloat(e)}function w2(t){return Math.min(1,Math.max(0,t))}function ei(t){return parseInt(t,16)}function Iue(t){return typeof t=="string"&&t.indexOf(".")!=-1&&parseFloat(t)===1}function Aue(t){return typeof t=="string"&&t.indexOf("%")!=-1}function cs(t){return t.length==1?"0"+t:""+t}function Mf(t){return t<=1&&(t=t*100+"%"),t}function pB(t){return Math.round(parseFloat(t)*255).toString(16)}function Wk(t){return ei(t)/255}var Zi=function(){var t="[-\\+]?\\d+%?",e="[-\\+]?\\d*\\.\\d+%?",n="(?:"+e+")|(?:"+t+")",r="[\\s|\\(]+("+n+")[,|\\s]+("+n+")[,|\\s]+("+n+")\\s*\\)?",i="[\\s|\\(]+("+n+")[,|\\s]+("+n+")[,|\\s]+("+n+")[,|\\s]+("+n+")\\s*\\)?";return{CSS_UNIT:new RegExp(n),rgb:new RegExp("rgb"+r),rgba:new RegExp("rgba"+i),hsl:new RegExp("hsl"+r),hsla:new RegExp("hsla"+i),hsv:new RegExp("hsv"+r),hsva:new RegExp("hsva"+i),hex3:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex6:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,hex4:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex8:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/}}();function Co(t){return!!Zi.CSS_UNIT.exec(t)}function kue(t){t=t.replace(aue,"").replace(lue,"").toLowerCase();var e=!1;if(i3[t])t=i3[t],e=!0;else if(t=="transparent")return{r:0,g:0,b:0,a:0,format:"name"};var n;return(n=Zi.rgb.exec(t))?{r:n[1],g:n[2],b:n[3]}:(n=Zi.rgba.exec(t))?{r:n[1],g:n[2],b:n[3],a:n[4]}:(n=Zi.hsl.exec(t))?{h:n[1],s:n[2],l:n[3]}:(n=Zi.hsla.exec(t))?{h:n[1],s:n[2],l:n[3],a:n[4]}:(n=Zi.hsv.exec(t))?{h:n[1],s:n[2],v:n[3]}:(n=Zi.hsva.exec(t))?{h:n[1],s:n[2],v:n[3],a:n[4]}:(n=Zi.hex8.exec(t))?{r:ei(n[1]),g:ei(n[2]),b:ei(n[3]),a:Wk(n[4]),format:e?"name":"hex8"}:(n=Zi.hex6.exec(t))?{r:ei(n[1]),g:ei(n[2]),b:ei(n[3]),format:e?"name":"hex"}:(n=Zi.hex4.exec(t))?{r:ei(n[1]+""+n[1]),g:ei(n[2]+""+n[2]),b:ei(n[3]+""+n[3]),a:Wk(n[4]+""+n[4]),format:e?"name":"hex8"}:(n=Zi.hex3.exec(t))?{r:ei(n[1]+""+n[1]),g:ei(n[2]+""+n[2]),b:ei(n[3]+""+n[3]),format:e?"name":"hex"}:!1}function Mue(t){var e,n;return t=t||{level:"AA",size:"small"},e=(t.level||"AA").toUpperCase(),n=(t.size||"small").toLowerCase(),e!=="AA"&&e!=="AAA"&&(e="AA"),n!=="small"&&n!=="large"&&(n="small"),{level:e,size:n}}function jk(t){if(typeof t=="string")return t;let e=t.toString(16);for(;e.length<6;)e=`0${e}`;return`#${e}`}const Xk=new Me,Yk=new Me;class Zk{static createLinearGradient(e,n,r){const{x0:i,y0:s,x1:o,y1:a,colorStops:l}=r,c=document.createElement("canvas");c.width=n.width,c.height=n.height;const u=c.getContext("2d"),d=u.createLinearGradient(i,s,o,a);l.forEach(v=>{d.addColorStop(v.offset,jk(v.color))}),u.fillStyle=d,u.fillRect(0,0,n.width,n.height);const h=e.renderTexture.current,f=Xk.copyFrom(e.renderTexture.sourceFrame),p=Yk.copyFrom(e.renderTexture.destinationFrame),m=new On(he.from(c));return e.batch.flush(),e.renderTexture.bind(n),m.render(e),e.batch.flush(),e.renderTexture.bind(h,f,p),n}static createRadialGradient(e,n,r){const{x0:i,y0:s,r0:o,x1:a,y1:l,r1:c,colorStops:u}=r,d=document.createElement("canvas");d.width=n.width,d.height=n.height;const h=d.getContext("2d"),f=h.createRadialGradient(i,s,o,a,l,c);u.forEach(b=>{f.addColorStop(b.offset,jk(b.color))}),h.fillStyle=f,h.fillRect(0,0,n.width,n.height);const p=e.renderTexture.current,m=Xk.copyFrom(e.renderTexture.sourceFrame),v=Yk.copyFrom(e.renderTexture.destinationFrame),y=new On(he.from(d));return e.batch.flush(),e.renderTexture.bind(n),y.render(e),e.batch.flush(),e.renderTexture.bind(p,m,v),n}}var mB={exports:{}};(function(t){var e;function n(S,P){return S.b===P.b&&S.a===P.a}function r(S,P){return S.b<P.b||S.b===P.b&&S.a<=P.a}function i(S,P,D){var U=P.b-S.b,V=D.b-P.b;return 0<U+V?U<V?P.a-S.a+U/(U+V)*(S.a-D.a):P.a-D.a+V/(U+V)*(D.a-S.a):0}function s(S,P,D){var U=P.b-S.b,V=D.b-P.b;return 0<U+V?(P.a-D.a)*U+(P.a-S.a)*V:0}function o(S,P){return S.a<P.a||S.a===P.a&&S.b<=P.b}function a(S,P,D){var U=P.a-S.a,V=D.a-P.a;return 0<U+V?U<V?P.b-S.b+U/(U+V)*(S.b-D.b):P.b-D.b+V/(U+V)*(D.b-S.b):0}function l(S,P,D){var U=P.a-S.a,V=D.a-P.a;return 0<U+V?(P.b-D.b)*U+(P.b-S.b)*V:0}function c(S){return r(S.b.a,S.a)}function u(S){return r(S.a,S.b.a)}function d(S,P,D,U){return S=0>S?0:S,D=0>D?0:D,S<=D?D===0?(P+U)/2:P+S/(S+D)*(U-P):U+D/(S+D)*(P-U)}function h(S){var P=y(S.b);return _(P,S.c),_(P.b,S.c),E(P,S.a),P}function f(S,P){var D=!1,U=!1;S!==P&&(P.a!==S.a&&(U=!0,x(P.a,S.a)),P.d!==S.d&&(D=!0,T(P.d,S.d)),b(P,S),U||(_(P,S.a),S.a.c=S),D||(E(P,S.d),S.d.a=S))}function p(S){var P=S.b,D=!1;S.d!==S.b.d&&(D=!0,T(S.d,S.b.d)),S.c===S?x(S.a,null):(S.b.d.a=We(S),S.a.c=S.c,b(S,We(S)),D||E(S,S.d)),P.c===P?(x(P.a,null),T(P.d,null)):(S.d.a=We(P),P.a.c=P.c,b(P,We(P))),w(S)}function m(S){var P=y(S),D=P.b;return b(P,S.e),P.a=S.b.a,_(D,P.a),P.d=D.d=S.d,P=P.b,b(S.b,We(S.b)),b(S.b,P),S.b.a=P.a,P.b.a.c=P.b,P.b.d=S.b.d,P.f=S.f,P.b.f=S.b.f,P}function v(S,P){var D=!1,U=y(S),V=U.b;return P.d!==S.d&&(D=!0,T(P.d,S.d)),b(U,S.e),b(V,P),U.a=S.b.a,V.a=P.a,U.d=V.d=S.d,S.d.a=V,D||E(U,S.d),U}function y(S){var P=new Ot,D=new Ot,U=S.b.h;return D.h=U,U.b.h=P,P.h=S,S.b.h=D,P.b=D,P.c=P,P.e=D,D.b=P,D.c=D,D.e=P}function b(S,P){var D=S.c,U=P.c;D.b.e=P,U.b.e=S,S.c=U,P.c=D}function _(S,P){var D=P.f,U=new Cn(P,D);D.e=U,P.f=U,D=U.c=S;do D.a=U,D=D.c;while(D!==S)}function E(S,P){var D=P.d,U=new Sn(P,D);D.b=U,P.d=U,U.a=S,U.c=P.c,D=S;do D.d=U,D=D.e;while(D!==S)}function w(S){var P=S.h;S=S.b.h,P.b.h=S,S.b.h=P}function x(S,P){var D=S.c,U=D;do U.a=P,U=U.c;while(U!==D);D=S.f,U=S.e,U.f=D,D.e=U}function T(S,P){var D=S.a,U=D;do U.d=P,U=U.e;while(U!==D);D=S.d,U=S.b,U.d=D,D.b=U}function C(S){var P=0;return Math.abs(S[1])>Math.abs(S[0])&&(P=1),Math.abs(S[2])>Math.abs(S[P])&&(P=2),P}var k=4*1e150;function L(S,P){S.f+=P.f,S.b.f+=P.b.f}function F(S,P,D){return S=S.a,P=P.a,D=D.a,P.b.a===S?D.b.a===S?r(P.a,D.a)?0>=s(D.b.a,P.a,D.a):0<=s(P.b.a,D.a,P.a):0>=s(D.b.a,S,D.a):D.b.a===S?0<=s(P.b.a,S,P.a):(P=i(P.b.a,S,P.a),S=i(D.b.a,S,D.a),P>=S)}function N(S){S.a.i=null;var P=S.e;P.a.c=P.c,P.c.a=P.a,S.e=null}function R(S,P){p(S.a),S.c=!1,S.a=P,P.i=S}function H(S){var P=S.a.a;do S=Hi(S);while(S.a.a===P);return S.c&&(P=v(Fn(S).a.b,S.a.e),R(S,P),S=Hi(S)),S}function W(S,P,D){var U=new B2;return U.a=D,U.e=De(S.f,P.e,U),D.i=U}function q(S,P){switch(S.s){case 100130:return(P&1)!==0;case 100131:return P!==0;case 100132:return 0<P;case 100133:return 0>P;case 100134:return 2<=P||-2>=P}return!1}function Z(S){var P=S.a,D=P.d;D.c=S.d,D.a=P,N(S)}function j(S,P,D){for(S=P,P=P.a;S!==D;){S.c=!1;var U=Fn(S),V=U.a;if(V.a!==P.a){if(!U.c){Z(S);break}V=v(P.c.b,V.b),R(U,V)}P.c!==V&&(f(We(V),V),f(P,V)),Z(S),P=U.a,S=U}return P}function K(S,P,D,U,V,te){var ie=!0;do W(S,P,D.b),D=D.c;while(D!==U);for(V===null&&(V=Fn(P).a.b.c);U=Fn(P),D=U.a.b,D.a===V.a;)D.c!==V&&(f(We(D),D),f(We(V),D)),U.f=P.f-D.f,U.d=q(S,U.f),P.b=!0,!ie&&Y(S,P)&&(L(D,V),N(P),p(V)),ie=!1,P=U,V=D;P.b=!0,te&&J(S,P)}function $(S,P,D,U,V){var te=[P.g[0],P.g[1],P.g[2]];P.d=null,P.d=S.o&&S.o(te,D,U,S.c)||null,P.d===null&&(V?S.n||(_t(S,100156),S.n=!0):P.d=D[0])}function B(S,P,D){var U=[null,null,null,null];U[0]=P.a.d,U[1]=D.a.d,$(S,P.a,U,[.5,.5,0,0],!1),f(P,D)}function G(S,P,D,U,V){var te=Math.abs(P.b-S.b)+Math.abs(P.a-S.a),ie=Math.abs(D.b-S.b)+Math.abs(D.a-S.a),ye=V+1;U[V]=.5*ie/(te+ie),U[ye]=.5*te/(te+ie),S.g[0]+=U[V]*P.g[0]+U[ye]*D.g[0],S.g[1]+=U[V]*P.g[1]+U[ye]*D.g[1],S.g[2]+=U[V]*P.g[2]+U[ye]*D.g[2]}function Y(S,P){var D=Fn(P),U=P.a,V=D.a;if(r(U.a,V.a)){if(0<s(V.b.a,U.a,V.a))return!1;if(!n(U.a,V.a))m(V.b),f(U,We(V)),P.b=D.b=!0;else if(U.a!==V.a){var D=S.e,te=U.a.h;if(0<=te){var D=D.b,ie=D.d,ye=D.e,$e=D.c,Ye=$e[te];ie[Ye]=ie[D.a],$e[ie[Ye]]=Ye,Ye<=--D.a&&(1>=Ye||r(ye[ie[Ye>>1]],ye[ie[Ye]])?i1(D,Ye):c6(D,Ye)),ye[te]=null,$e[te]=D.b,D.b=te}else for(D.c[-(te+1)]=null;0<D.a&&D.c[D.d[D.a-1]]===null;)--D.a;B(S,We(V),U)}}else{if(0>s(U.b.a,V.a,U.a))return!1;Hi(P).b=P.b=!0,m(U.b),f(We(V),U)}return!0}function X(S,P){var D=Fn(P),U=P.a,V=D.a,te=U.a,ie=V.a,ye=U.b.a,$e=V.b.a,Ye=new Cn;if(s(ye,S.a,te),s($e,S.a,ie),te===ie||Math.min(te.a,ye.a)>Math.max(ie.a,$e.a))return!1;if(r(te,ie)){if(0<s($e,te,ie))return!1}else if(0>s(ye,ie,te))return!1;var on=ye,kt=te,Mt=$e,Bn=ie,nt,gn;if(r(on,kt)||(nt=on,on=kt,kt=nt),r(Mt,Bn)||(nt=Mt,Mt=Bn,Bn=nt),r(on,Mt)||(nt=on,on=Mt,Mt=nt,nt=kt,kt=Bn,Bn=nt),r(Mt,kt)?r(kt,Bn)?(nt=i(on,Mt,kt),gn=i(Mt,kt,Bn),0>nt+gn&&(nt=-nt,gn=-gn),Ye.b=d(nt,Mt.b,gn,kt.b)):(nt=s(on,Mt,kt),gn=-s(on,Bn,kt),0>nt+gn&&(nt=-nt,gn=-gn),Ye.b=d(nt,Mt.b,gn,Bn.b)):Ye.b=(Mt.b+kt.b)/2,o(on,kt)||(nt=on,on=kt,kt=nt),o(Mt,Bn)||(nt=Mt,Mt=Bn,Bn=nt),o(on,Mt)||(nt=on,on=Mt,Mt=nt,nt=kt,kt=Bn,Bn=nt),o(Mt,kt)?o(kt,Bn)?(nt=a(on,Mt,kt),gn=a(Mt,kt,Bn),0>nt+gn&&(nt=-nt,gn=-gn),Ye.a=d(nt,Mt.a,gn,kt.a)):(nt=l(on,Mt,kt),gn=-l(on,Bn,kt),0>nt+gn&&(nt=-nt,gn=-gn),Ye.a=d(nt,Mt.a,gn,Bn.a)):Ye.a=(Mt.a+kt.a)/2,r(Ye,S.a)&&(Ye.b=S.a.b,Ye.a=S.a.a),on=r(te,ie)?te:ie,r(on,Ye)&&(Ye.b=on.b,Ye.a=on.a),n(Ye,te)||n(Ye,ie))return Y(S,P),!1;if(!n(ye,S.a)&&0<=s(ye,S.a,Ye)||!n($e,S.a)&&0>=s($e,S.a,Ye)){if($e===S.a)return m(U.b),f(V.b,U),P=H(P),U=Fn(P).a,j(S,Fn(P),D),K(S,P,We(U),U,U,!0),!0;if(ye===S.a){m(V.b),f(U.e,We(V)),te=D=P,ie=te.a.b.a;do te=Hi(te);while(te.a.b.a===ie);return P=te,te=Fn(P).a.b.c,D.a=We(V),V=j(S,D,null),K(S,P,V.c,U.b.c,te,!0),!0}return 0<=s(ye,S.a,Ye)&&(Hi(P).b=P.b=!0,m(U.b),U.a.b=S.a.b,U.a.a=S.a.a),0>=s($e,S.a,Ye)&&(P.b=D.b=!0,m(V.b),V.a.b=S.a.b,V.a.a=S.a.a),!1}return m(U.b),m(V.b),f(We(V),U),U.a.b=Ye.b,U.a.a=Ye.a,U.a.h=vo(S.e,U.a),U=U.a,V=[0,0,0,0],Ye=[te.d,ye.d,ie.d,$e.d],U.g[0]=U.g[1]=U.g[2]=0,G(U,te,ye,V,0),G(U,ie,$e,V,2),$(S,U,Ye,V,!0),Hi(P).b=P.b=D.b=!0,!1}function J(S,P){for(var D=Fn(P);;){for(;D.b;)P=D,D=Fn(D);if(!P.b&&(D=P,P=Hi(P),P===null||!P.b))break;P.b=!1;var U=P.a,V=D.a,te;if(te=U.b.a!==V.b.a)e:{te=P;var ie=Fn(te),ye=te.a,$e=ie.a,Ye=void 0;if(r(ye.b.a,$e.b.a)){if(0>s(ye.b.a,$e.b.a,ye.a)){te=!1;break e}Hi(te).b=te.b=!0,Ye=m(ye),f($e.b,Ye),Ye.d.c=te.d}else{if(0<s($e.b.a,ye.b.a,$e.a)){te=!1;break e}te.b=ie.b=!0,Ye=m($e),f(ye.e,$e.b),Ye.b.d.c=te.d}te=!0}if(te&&(D.c?(N(D),p(V),D=Fn(P),V=D.a):P.c&&(N(P),p(U),P=Hi(D),U=P.a)),U.a!==V.a){if(U.b.a===V.b.a||P.c||D.c||U.b.a!==S.a&&V.b.a!==S.a)Y(S,P);else if(X(S,P))break}U.a===V.a&&U.b.a===V.b.a&&(L(V,U),N(P),p(U),P=Hi(D))}}function ne(S,P){S.a=P;for(var D=P.c;D.i===null;)if(D=D.c,D===P.c){var D=S,U=P,ie=new B2;ie.a=U.c.b;var V=D.f,ye=V.a;do ye=ye.a;while(ye.b!==null&&!V.c(V.b,ie,ye.b));var V=ye.b,te=Fn(V),ie=V.a,ye=te.a;if(s(ie.b.a,U,ie.a)===0)ie=V.a,n(ie.a,U)||n(ie.b.a,U)||(m(ie.b),V.c&&(p(ie.c),V.c=!1),f(U.c,ie),ne(D,U));else{var $e=r(ye.b.a,ie.b.a)?V:te,te=void 0;V.d||$e.c?($e===V?te=v(U.c.b,ie.e):te=v(ye.b.c.b,U.c).b,$e.c?R($e,te):(ie=D,V=W(D,V,te),V.f=Hi(V).f+V.a.f,V.d=q(ie,V.f)),ne(D,U)):K(D,V,U.c,U.c,null,!0)}return}if(D=H(D.i),ie=Fn(D),V=ie.a,ie=j(S,ie,null),ie.c===V){var V=ie,ie=V.c,ye=Fn(D),te=D.a,$e=ye.a,Ye=!1;te.b.a!==$e.b.a&&X(S,D),n(te.a,S.a)&&(f(We(ie),te),D=H(D),ie=Fn(D).a,j(S,Fn(D),ye),Ye=!0),n($e.a,S.a)&&(f(V,We($e)),V=j(S,ye,null),Ye=!0),Ye?K(S,D,V.c,ie,ie,!0):(r($e.a,te.a)?U=We($e):U=te,U=v(V.c.b,U),K(S,D,U,U.c,U.c,!1),U.b.i.c=!0,J(S,D))}else K(S,D,ie.c,V,V,!0)}function se(S,P){var D=new B2,U=h(S.b);U.a.b=k,U.a.a=P,U.b.a.b=-k,U.b.a.a=P,S.a=U.b.a,D.a=U,D.f=0,D.d=!1,D.c=!1,D.h=!0,D.b=!1,U=S.f,U=De(U,U.a,D),D.e=U}function Ue(S){this.a=new Le,this.b=S,this.c=F}function De(S,P,D){do P=P.c;while(P.b!==null&&!S.c(S.b,P.b,D));return S=new Le(D,P.a,P),P.a.c=S,P.a=S}function Le(S,P,D){this.b=S||null,this.a=P||this,this.c=D||this}function fe(){this.d=ke,this.p=this.b=this.q=null,this.j=[0,0,0],this.s=100130,this.n=!1,this.o=this.a=this.e=this.f=null,this.m=!1,this.c=this.r=this.i=this.k=this.l=this.h=null}var ke=0;e=fe.prototype,e.x=function(){Xe(this,ke)},e.B=function(S,P){switch(S){case 100142:return;case 100140:switch(P){case 100130:case 100131:case 100132:case 100133:case 100134:this.s=P;return}break;case 100141:this.m=!!P;return;default:_t(this,100900);return}_t(this,100901)},e.y=function(S){switch(S){case 100142:return 0;case 100140:return this.s;case 100141:return this.m;default:_t(this,100900)}return!1},e.A=function(S,P,D){this.j[0]=S,this.j[1]=P,this.j[2]=D},e.z=function(S,P){var D=P||null;switch(S){case 100100:case 100106:this.h=D;break;case 100104:case 100110:this.l=D;break;case 100101:case 100107:this.k=D;break;case 100102:case 100108:this.i=D;break;case 100103:case 100109:this.p=D;break;case 100105:case 100111:this.o=D;break;case 100112:this.r=D;break;default:_t(this,100900)}},e.C=function(S,P){var D=!1,U=[0,0,0];Xe(this,2);for(var V=0;3>V;++V){var te=S[V];-1e150>te&&(te=-1e150,D=!0),1e150<te&&(te=1e150,D=!0),U[V]=te}D&&_t(this,100155),D=this.q,D===null?(D=h(this.b),f(D,D.b)):(m(D),D=D.e),D.a.d=P,D.a.g[0]=U[0],D.a.g[1]=U[1],D.a.g[2]=U[2],D.f=1,D.b.f=-1,this.q=D},e.u=function(S){Xe(this,ke),this.d=1,this.b=new ir,this.c=S},e.t=function(){Xe(this,1),this.d=2,this.q=null},e.v=function(){Xe(this,2),this.d=1},e.w=function(){Xe(this,1),this.d=ke;var S=this.j[0],P=this.j[1],D=this.j[2],U=!1,V=[S,P,D];if(S===0&&P===0&&D===0){for(var P=[-2*1e150,-2*1e150,-2*1e150],te=[2*1e150,2*1e150,2*1e150],D=[],ie=[],U=this.b.c,S=U.e;S!==U;S=S.e)for(var ye=0;3>ye;++ye){var $e=S.g[ye];$e<te[ye]&&(te[ye]=$e,ie[ye]=S),$e>P[ye]&&(P[ye]=$e,D[ye]=S)}if(S=0,P[1]-te[1]>P[0]-te[0]&&(S=1),P[2]-te[2]>P[S]-te[S]&&(S=2),te[S]>=P[S])V[0]=0,V[1]=0,V[2]=1;else{for(P=0,te=ie[S],D=D[S],ie=[0,0,0],te=[te.g[0]-D.g[0],te.g[1]-D.g[1],te.g[2]-D.g[2]],ye=[0,0,0],S=U.e;S!==U;S=S.e)ye[0]=S.g[0]-D.g[0],ye[1]=S.g[1]-D.g[1],ye[2]=S.g[2]-D.g[2],ie[0]=te[1]*ye[2]-te[2]*ye[1],ie[1]=te[2]*ye[0]-te[0]*ye[2],ie[2]=te[0]*ye[1]-te[1]*ye[0],$e=ie[0]*ie[0]+ie[1]*ie[1]+ie[2]*ie[2],$e>P&&(P=$e,V[0]=ie[0],V[1]=ie[1],V[2]=ie[2]);0>=P&&(V[0]=V[1]=V[2]=0,V[C(te)]=1)}U=!0}for(ie=C(V),S=this.b.c,P=(ie+1)%3,D=(ie+2)%3,ie=0<V[ie]?1:-1,V=S.e;V!==S;V=V.e)V.b=V.g[P],V.a=ie*V.g[D];if(U){for(V=0,U=this.b.a,S=U.b;S!==U;S=S.b)if(P=S.a,!(0>=P.f))do V+=(P.a.b-P.b.a.b)*(P.a.a+P.b.a.a),P=P.e;while(P!==S.a);if(0>V)for(V=this.b.c,U=V.e;U!==V;U=U.e)U.a=-U.a}for(this.n=!1,V=this.b.b,S=V.h;S!==V;S=U)U=S.h,P=S.e,n(S.a,S.b.a)&&S.e.e!==S&&(B(this,P,S),p(S),S=P,P=S.e),P.e===S&&(P!==S&&((P===U||P===U.b)&&(U=U.h),p(P)),(S===U||S===U.b)&&(U=U.h),p(S));for(this.e=V=new Dl,U=this.b.c,S=U.e;S!==U;S=S.e)S.h=vo(V,S);for(n1(V),this.f=new Ue(this),se(this,-k),se(this,k);(V=r1(this.e))!==null;){for(;;){e:if(S=this.e,S.a===0)U=F2(S.b);else if(U=S.c[S.d[S.a-1]],S.b.a!==0&&(S=F2(S.b),r(S,U))){U=S;break e}if(U===null||!n(U,V))break;U=r1(this.e),B(this,V.c,U.c)}ne(this,V)}for(this.a=this.f.a.a.b.a.a,V=0;(U=this.f.a.a.b)!==null;)U.h||++V,N(U);for(this.f=null,V=this.e,V.b=null,V.d=null,this.e=V.c=null,V=this.b,S=V.a.b;S!==V.a;S=U)U=S.b,S=S.a,S.e.e===S&&(L(S.c,S),p(S));if(!this.n){if(V=this.b,this.m)for(S=V.b.h;S!==V.b;S=U)U=S.h,S.b.d.c!==S.d.c?S.f=S.d.c?1:-1:p(S);else for(S=V.a.b;S!==V.a;S=U)if(U=S.b,S.c){for(S=S.a;r(S.b.a,S.a);S=S.c.b);for(;r(S.a,S.b.a);S=S.e);for(P=S.c.b,D=void 0;S.e!==P;)if(r(S.b.a,P.a)){for(;P.e!==S&&(c(P.e)||0>=s(P.a,P.b.a,P.e.b.a));)D=v(P.e,P),P=D.b;P=P.c.b}else{for(;P.e!==S&&(u(S.c.b)||0<=s(S.b.a,S.a,S.c.b.a));)D=v(S,S.c.b),S=D.b;S=S.e}for(;P.e.e!==S;)D=v(P.e,P),P=D.b}if(this.h||this.i||this.k||this.l)if(this.m){for(V=this.b,U=V.a.b;U!==V.a;U=U.b)if(U.c){this.h&&this.h(2,this.c),S=U.a;do this.k&&this.k(S.a.d,this.c),S=S.e;while(S!==U.a);this.i&&this.i(this.c)}}else{for(V=this.b,U=!!this.l,S=!1,P=-1,D=V.a.d;D!==V.a;D=D.d)if(D.c){S||(this.h&&this.h(4,this.c),S=!0),ie=D.a;do U&&(te=ie.b.d.c?0:1,P!==te&&(P=te,this.l&&this.l(!!P,this.c))),this.k&&this.k(ie.a.d,this.c),ie=ie.e;while(ie!==D.a)}S&&this.i&&this.i(this.c)}if(this.r){for(V=this.b,S=V.a.b;S!==V.a;S=U)if(U=S.b,!S.c){P=S.a,D=P.e,ie=void 0;do ie=D,D=ie.e,ie.d=null,ie.b.d===null&&(ie.c===ie?x(ie.a,null):(ie.a.c=ie.c,b(ie,We(ie))),te=ie.b,te.c===te?x(te.a,null):(te.a.c=te.c,b(te,We(te))),w(ie));while(ie!==P);P=S.d,S=S.b,S.d=P,P.b=S}this.r(this.b),this.c=this.b=null;return}}this.b=this.c=null};function Xe(S,P){if(S.d!==P)for(;S.d!==P;)if(S.d<P)switch(S.d){case ke:_t(S,100151),S.u(null);break;case 1:_t(S,100152),S.t()}else switch(S.d){case 2:_t(S,100154),S.v();break;case 1:_t(S,100153),S.w()}}function _t(S,P){S.p&&S.p(P,S.c)}function Sn(S,P){this.b=S||this,this.d=P||this,this.a=null,this.c=!1}function Ot(){this.h=this,this.i=this.d=this.a=this.e=this.c=this.b=null,this.f=0}function We(S){return S.b.e}function ir(){this.c=new Cn,this.a=new Sn,this.b=new Ot,this.d=new Ot,this.b.b=this.d,this.d.b=this.b}function Cn(S,P){this.e=S||this,this.f=P||this,this.d=this.c=null,this.g=[0,0,0],this.h=this.a=this.b=0}function Dl(){this.c=[],this.d=null,this.a=0,this.e=!1,this.b=new N2}function n1(S){S.d=[];for(var P=0;P<S.a;P++)S.d[P]=P;S.d.sort(function(D){return function(U,V){return r(D[U],D[V])?1:-1}}(S.c)),S.e=!0,rH(S.b)}function vo(S,P){if(S.e){var D=S.b,U=++D.a;2*U>D.f&&(D.f*=2,D.c=a6(D.c,D.f+1));var V;return D.b===0?V=U:(V=D.b,D.b=D.c[D.b]),D.e[V]=P,D.c[V]=U,D.d[U]=V,D.h&&c6(D,U),V}return D=S.a++,S.c[D]=P,-(D+1)}function r1(S){if(S.a===0)return l6(S.b);var P=S.c[S.d[S.a-1]];if(S.b.a!==0&&r(F2(S.b),P))return l6(S.b);do--S.a;while(0<S.a&&S.c[S.d[S.a-1]]===null);return P}function N2(){this.d=a6([0],33),this.e=[null,null],this.c=[0,0],this.a=0,this.f=32,this.b=0,this.h=!1,this.d[1]=1}function a6(S,P){for(var D=Array(P),U=0;U<S.length;U++)D[U]=S[U];for(;U<P;U++)D[U]=0;return D}function rH(S){for(var P=S.a;1<=P;--P)i1(S,P);S.h=!0}function F2(S){return S.e[S.d[1]]}function l6(S){var P=S.d,D=S.e,U=S.c,V=P[1],te=D[V];return 0<S.a&&(P[1]=P[S.a],U[P[1]]=1,D[V]=null,U[V]=S.b,S.b=V,0<--S.a&&i1(S,1)),te}function i1(S,P){for(var D=S.d,U=S.e,V=S.c,te=P,ie=D[te];;){var ye=te<<1;ye<S.a&&r(U[D[ye+1]],U[D[ye]])&&(ye+=1);var $e=D[ye];if(ye>S.a||r(U[ie],U[$e])){D[te]=ie,V[ie]=te;break}D[te]=$e,V[$e]=te,te=ye}}function c6(S,P){for(var D=S.d,U=S.e,V=S.c,te=P,ie=D[te];;){var ye=te>>1,$e=D[ye];if(ye===0||r(U[$e],U[ie])){D[te]=ie,V[ie]=te;break}D[te]=$e,V[$e]=te,te=ye}}function B2(){this.e=this.a=null,this.f=0,this.c=this.b=this.h=this.d=!1}function Fn(S){return S.e.c.b}function Hi(S){return S.e.a.b}E0.libtess={GluTesselator:fe,windingRule:{GLU_TESS_WINDING_ODD:100130,GLU_TESS_WINDING_NONZERO:100131,GLU_TESS_WINDING_POSITIVE:100132,GLU_TESS_WINDING_NEGATIVE:100133,GLU_TESS_WINDING_ABS_GEQ_TWO:100134},primitiveType:{GL_LINE_LOOP:2,GL_TRIANGLES:4,GL_TRIANGLE_STRIP:5,GL_TRIANGLE_FAN:6},errorType:{GLU_TESS_MISSING_BEGIN_POLYGON:100151,GLU_TESS_MISSING_END_POLYGON:100153,GLU_TESS_MISSING_BEGIN_CONTOUR:100152,GLU_TESS_MISSING_END_CONTOUR:100154,GLU_TESS_COORD_TOO_LARGE:100155,GLU_TESS_NEED_COMBINE_CALLBACK:100156},gluEnum:{GLU_TESS_MESH:100112,GLU_TESS_TOLERANCE:100142,GLU_TESS_WINDING_RULE:100140,GLU_TESS_BOUNDARY_ONLY:100141,GLU_INVALID_ENUM:100900,GLU_INVALID_VALUE:100901,GLU_TESS_BEGIN:100100,GLU_TESS_VERTEX:100101,GLU_TESS_END:100102,GLU_TESS_ERROR:100103,GLU_TESS_EDGE_FLAG:100104,GLU_TESS_COMBINE:100105,GLU_TESS_BEGIN_DATA:100106,GLU_TESS_VERTEX_DATA:100107,GLU_TESS_END_DATA:100108,GLU_TESS_ERROR_DATA:100109,GLU_TESS_EDGE_FLAG_DATA:100110,GLU_TESS_COMBINE_DATA:100111}},fe.prototype.gluDeleteTess=fe.prototype.x,fe.prototype.gluTessProperty=fe.prototype.B,fe.prototype.gluGetTessProperty=fe.prototype.y,fe.prototype.gluTessNormal=fe.prototype.A,fe.prototype.gluTessCallback=fe.prototype.z,fe.prototype.gluTessVertex=fe.prototype.C,fe.prototype.gluTessBeginPolygon=fe.prototype.u,fe.prototype.gluTessBeginContour=fe.prototype.t,fe.prototype.gluTessEndContour=fe.prototype.v,fe.prototype.gluTessEndPolygon=fe.prototype.w,t.exports=E0.libtess})(mB);var Os=mB.exports,gB={exports:{}};/*!
 * d-path-parser - v1.0.0
 * by Massimo Artizzu (MaxArt2501)
 *
 * https://github.com/MaxArt2501/d-path-parser
 *
 * Licensed under the MIT License
 * See LICENSE for details
 */(function(t,e){(function(n,r){t.exports=r()})(E0,function(){return function(r){for(var i={command:/\s*([achlmqstvz])/gi,number:/\s*([+-]?\d*\.?\d+(?:e[+-]?\d+)?)/gi,comma:/\s*(?:(,)|\s)/g,flag:/\s*([01])/g},s={number:function(m){return+f("number",m)},"coordinate pair":function(m){var v=f("number",m);if(v===null&&!m)return null;f("comma");var y=f("number",!0);return{x:+v,y:+y}},"arc definition":function(m){var v=s["coordinate pair"](m);if(!v&&!m)return null;f("comma");var y=+f("number",!0);f("comma",!0);var b=!!+f("flag",!0);f("comma");var _=!!+f("flag",!0);f("comma");var E=s["coordinate pair"](!0);return{radii:v,rotation:y,large:b,clockwise:_,end:E}}},o=0,a=[];o<r.length;){var l=f("command"),c=l.toUpperCase(),u=l!==c,d;switch(c){case"M":d=p("coordinate pair").map(function(m,v){return v===1&&(l=u?"l":"L"),h({end:m})});break;case"L":case"T":d=p("coordinate pair").map(function(m){return h({end:m})});break;case"C":if(d=p("coordinate pair"),d.length%3)throw Error("Expected coordinate pair triplet at position "+o);d=d.reduce(function(m,v,y){var b=y%3;if(!b)m.push(h({cp1:v}));else{var _=m[m.length-1];_[b===1?"cp2":"end"]=v}return m},[]);break;case"Q":case"S":if(d=p("coordinate pair"),d.length&1)throw Error("Expected coordinate pair couple at position "+o);d=d.reduce(function(m,v,y){var b=y&1;if(!b)m.push(h({cp:v}));else{var _=m[m.length-1];_.end=v}return m},[]);break;case"H":case"V":d=p("number").map(function(m){return h({value:m})});break;case"A":d=p("arc definition").map(h);break;case"Z":d=[{code:"Z"}];break}a.push.apply(a,d)}return a;function h(m){return m.code=l,m.relative=u,m}function f(m,v){i[m].lastIndex=o;var y=i[m].exec(r);if(!y||y.index!==o){if(!v)return null;throw Error("Expected "+m+" at position "+o)}return o=i[m].lastIndex,y[1]}function p(m){for(var v=[],y,b=!0;y=s[m](b);)v.push(y),b=!!f("comma");return v}}})})(gB);var Pue=gB.exports;const Lue=aa(Pue);var ni;(function(t){t[t.HORIZONTAL=0]="HORIZONTAL";const n=1;t[t.VERTICAL=n]="VERTICAL"})(ni||(ni={}));class At{static makeArea(e,n,r){return e|n<<15|r<<30}static getOpenOffset(e){return e&32767}static getCloseOffset(e){return e>>15&32767}static getOrientation(e){return e>>30&1}static setOpenOffset(e,n){return At.makeArea(n,At.getCloseOffset(e),At.getOrientation(e))}static setCloseOffset(e,n){return At.makeArea(At.getOpenOffset(n),n,At.getOrientation(e))}}var Ws;(function(t){t[t.HOR=0]="HOR";const n=1;t[t.VERT=n]="VERT";const r=2;t[t.NONE=r]="NONE"})(Ws||(Ws={}));const Kk=new Me;class yB{constructor(e,n){this._width=e,this._height=n,this._root=[null,At.makeArea(0,this._height,ni.HORIZONTAL),!1]}allocate(e,n,r){const i=this.findArea(e,n);if(!i)return null;r||(r=new Me),this.getFrame(i,r);const s=new Me(r.x,r.y,e,n),o=this.split(i,r,s);return r.copyFrom(s),r.__mem_area=o,r}free(e){const n=e.__mem_area;n[2]=!1,this.merge(n)}get width(){return this._width}get height(){return this._height}getAreaField(e){return e[1]}getFrame(e,n){n||(n=new Me);const r=this.getAreaField(e),i=this.getParent(e),s=At.getOrientation(r),o=At.getOpenOffset(r),a=At.getCloseOffset(r),l=i?At.getOpenOffset(i[1]):0,c=i?At.getCloseOffset(i[1]):this._width;return s?(n.x=o,n.y=l,n.width=a-n.x,n.height=c-l):(n.x=l,n.y=o,n.width=c-n.x,n.height=a-n.y),n}getParent(e){return e[0]}hasChildren(e){return Array.isArray(e[2])&&e[2].length!==0}getChildren(e){if(!Array.isArray(e[2]))throw new Error("Children don't exist");return e[2]}addChild(e,...n){e[2]=Array.isArray(e[2])?e[2]:[],e[2].push(...n)}findArea(e,n){return this.findAreaRecursive(this._root,e,n)}findAreaRecursive(e,n,r){const i=this.getFrame(e,Kk);if(i.width<n||i.height<r)return null;if(!this.hasChildren(e)){const l=i.width-n,c=i.height-r;return l<0||c<0||e[2]?null:e}const s=this.getChildren(e);let o=null,a=1/0;for(let l=0,c=s.length;l<c;l++){const u=this.findAreaRecursive(s[l],n,r);if(!u)continue;const d=this.getFrame(u,Kk),h=d.width-n,f=d.height-r;if(h<0||f<0)continue;if(!h&&!f)return u;const p=Math.min(h,f);a>p&&(o=u,a=p)}return o}splitOrientation(e,n){if(n.width===e.width&&n.height===e.height)return Ws.NONE;if(n.width===e.width)return Ws.VERT;if(n.height===e.height)return Ws.HOR;const r=Math.abs((e.width-n.width)*e.height-n.width*(e.height-n.height)),i=Math.abs(e.width*(e.height-n.height)-(e.width-n.width)*n.height);return r>i?Ws.HOR:Ws.VERT}split(e,n,r,i=this.getParent(e)?this.splitOrientation(n,r):Ws.HOR){if(e[2]===!0)throw new Error("Cannot deallocate");return i===Ws.NONE?(e[2]=!0,e):this[i===Ws.HOR?"splitPrimaryHorizontal":"splitPrimaryVertical"](e,n,r)}splitPrimaryHorizontal(e,n,r){const i=this.getAreaField(e),s=At.getOrientation(i),o=this.getParent(e);if(this.hasChildren(e))throw new Error("Can't split non-leaf node");const a=[e,At.makeArea(n.left,n.x+r.width,ni.VERTICAL),[]],l=[e,At.makeArea(n.x+r.width,n.right,ni.VERTICAL),!1];if(s===ni.HORIZONTAL)this.addChild(e,a,l);else{const c=this.getChildren(o).indexOf(e);a[0]=o,l[0]=o,this.getChildren(o).splice(c,1,a,l)}if(r.height!==n.height){const c=[a,At.makeArea(n.top,n.y+r.height,ni.HORIZONTAL),!0],u=[a,At.makeArea(n.y+r.height,n.bottom,ni.HORIZONTAL),!1];return this.addChild(a,c,u),c}else a[2]=!0;return a}splitPrimaryVertical(e,n,r){const i=this.getAreaField(e),s=At.getOrientation(i),o=this.getParent(e);if(this.hasChildren(e))throw new Error("Can't split non-leaf node");const a=[e,At.makeArea(n.top,n.y+r.height,ni.HORIZONTAL),[]],l=[e,At.makeArea(n.y+r.height,n.bottom,ni.HORIZONTAL),!1];if(s===ni.VERTICAL)this.addChild(e,a,l);else{const c=this.getChildren(o).indexOf(e);a[0]=o,l[0]=o,this.getChildren(o).splice(c,1,a,l)}if(r.width!==n.height){const c=[a,At.makeArea(n.left,n.x+r.width,ni.VERTICAL),!0],u=[a,At.makeArea(n.x+r.width,n.right,ni.VERTICAL),!1];return this.addChild(a,c,u),c}else a[2]=!0;return a}merge(e){if(this.hasChildren(e))throw new Error("Cannot merge a non-leaf node");const n=this.getParent(e);if(!n)return;const r=this.getChildren(n),i=r.indexOf(e),s=r[i-1],o=r[i+1];o&&o[2]===!1&&(e[1]=At.setCloseOffset(e[1],At.getCloseOffset(o[1])),r.splice(i+1,1)),s&&s[2]===!1&&(e[1]=At.setOpenOffset(e[1],At.getOpenOffset(s[1])),r.splice(i-1,1)),r.length===1&&(n[2]=!1,this.merge(n))}printState(e){this.hasChildren(e)?this.getChildren(e).forEach(n=>this.printState(n)):console.log({...this.getFrame(e)},e[2])}}const U_=new Me;class Rue{constructor(e=2048,n=2048){this.slabWidth=e,this.slabHeight=n,this.textureSlabs=[]}get maxWidth(){return this.slabWidth-2*this.calculatePadding(this.slabWidth,this.slabHeight)}get maxHeight(){return this.slabHeight-2*this.calculatePadding(this.slabWidth,this.slabHeight)}allocate(e,n,r=this.calculatePadding(e,n)){if(e+2*r>this.slabWidth||n+2*r>this.slabHeight)return null;const i=this.textureSlabs;for(let o=0,a=i.length;o<a;o++){const l=i[o],c=this.issueTexture(l,e,n,r);if(c)return c}const s=this.createSlab();return this.textureSlabs.unshift(s),this.issueTexture(s,e,n,r)}free(e){const n=e.baseTexture,r=this.textureSlabs.find(s=>s.slab===n);if(!r)throw new Error("The texture cannot be freed because its base-texture is not pooled by this allocator. This is either a bug in TextureAllocator or you tried to free a texture that was never allocated by one.");const i=r.managedTextures.find(s=>s.texture===e);if(!i)throw new Error("The texture cannot be freed because it was not found in the managed list of issued textures on its slab. This may be because you duplicated this texture or a bug in TextureAllocator");r.managedArea.free(i.area),r.managedTextures.splice(r.managedTextures.indexOf(i),1)}calculatePadding(e,n){const r=Math.max(e,n);return r<64?2:r<128?4:r<1024?8:16}createSlab(){return{managedArea:new yB(this.slabWidth,this.slabHeight),managedTextures:[],slab:new ze(null,{width:this.slabWidth,height:this.slabHeight})}}createTexture(e,n){return new he(e,n)}issueTexture(e,n,r,i=0){const s=e.managedArea.allocate(n+2*i,r+2*i);if(!s)return null;U_.copyFrom(s),U_.pad(-i);const o=e.slab,a=this.createTexture(o,U_.clone());return e.managedTextures.push({area:s,texture:a}),a}}class Oue extends Rue{createSlab(){const e=document.createElement("canvas");return e.width=this.slabWidth,e.height=this.slabHeight,{managedArea:new yB(this.slabWidth,this.slabHeight),managedTextures:[],slab:new ze(e,{width:this.slabWidth,height:this.slabHeight})}}}const Ul=new Me;class Due{constructor(e={}){this._recursive=typeof e.recursive=="boolean"?e.recursive:!0,this._toggle=e.toggle||"visible",this._targetList=new Set}add(e){return this._targetList.add(e),this}addAll(e){for(let n=0,r=e.length;n<r;n++)this._targetList.add(e[n]);return this}remove(e){return this._targetList.delete(e),this}removeAll(e){for(let n=0,r=e.length;n<r;n++)this._targetList.delete(e[n]);return this}clear(){return this._targetList.clear(),this}cull(e,n=!1){return n||this.uncull(),this._targetList.forEach(r=>{n||r.getBounds(!1,Ul),this._recursive?this.cullRecursive(e,r,n):(n&&r._bounds.getRectangle(e),r[this._toggle]=Ul.right>e.left&&Ul.left<e.right&&Ul.bottom>e.top&&Ul.top<e.bottom)}),this}uncull(){return this._targetList.forEach(e=>{this._recursive?this.uncullRecursive(e):e[this._toggle]=!1}),this}cullRecursive(e,n,r){const i=r?n._bounds.getRectangle(Ul):n.getBounds(!0,Ul);if(n[this._toggle]=i.right>e.left&&i.left<e.right&&i.bottom>e.top&&i.top<e.bottom,!(i.left>=e.left&&i.top>=e.top&&i.right<=e.right&&i.bottom<=e.bottom)&&n[this._toggle]&&n.children&&n.children.length){const o=n.children;for(let a=0,l=o.length;a<l;a++)this.cullRecursive(e,o[a])}}uncullRecursive(e){if(e[this._toggle]=!0,e.children&&e.children.length){const n=e.children;for(let r=0,i=n.length;r<i;r++)this.uncullRecursive(n[r])}}}/*!
 * @pixi-essentials/svg - v2.0.1
 * Compiled Sun, 05 Mar 2023 04:38:14 UTC
 *
 * @pixi-essentials/svg is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 * 
 * Copyright 2019-2020, Shukant K. Pal <shukantpal@outlook.com>, All Rights Reserved
 */const qk=new Map;async function Jk(t){const e=new URL(t,document.baseURI),n=e.host+e.pathname;let r=qk.get(n);return r||(r=await fetch(e.toString()).then(i=>i.text()).then(i=>new DOMParser().parseFromString(i,"image/svg+xml").documentElement),qk.set(n,r)),r}class Qk{constructor(e,n){this.parent=e,this.provider=n}get dirtyId(){return this.parent.dirtyId+this.provider.dirtyId}get fill(){return this.provider.fill!==null?this.provider.fill:this.parent.fill}get opacity(){return typeof this.provider.opacity=="number"?this.provider.opacity:this.parent.opacity}get stroke(){return this.provider.stroke!==null?this.provider.stroke:this.parent.stroke}get strokeDashArray(){return Array.isArray(this.provider.strokeDashArray)?this.provider.strokeDashArray:this.parent.strokeDashArray}get strokeDashOffset(){return typeof this.provider.strokeDashOffset=="number"?this.provider.strokeDashOffset:this.parent.strokeDashOffset}get strokeLineCap(){return typeof this.provider.strokeLineCap=="string"?this.provider.strokeLineCap:this.parent.strokeLineCap}get strokeLineJoin(){return typeof this.provider.strokeLineJoin=="string"?this.provider.strokeLineJoin:this.parent.strokeLineJoin}get strokeMiterLimit(){return typeof this.provider.strokeMiterLimit=="number"?this.provider.strokeMiterLimit:this.parent.strokeMiterLimit}get strokeWidth(){return typeof this.provider.strokeWidth=="number"?this.provider.strokeWidth:this.parent.strokeWidth}}function Nue(t){let e,n=t[0],r=1;for(;r<t.length;){const i=t[r],s=t[r+1];if(r+=2,(i==="optionalAccess"||i==="optionalCall")&&n==null)return;i==="access"||i==="optionalAccess"?(e=n,n=s(n)):(i==="call"||i==="optionalCall")&&(n=s((...o)=>n.call(e,...o)),e=void 0)}return n}class Pd{__init(){this.dirtyId=0}constructor(e){Pd.prototype.__init.call(this),this.element=e;const n=e.getAttribute("fill"),r=e.getAttribute("opacity"),i=e.getAttribute("stroke"),s=e.getAttribute("stroke-dasharray"),o=e.getAttribute("stroke-dashoffset"),a=e.getAttribute("stroke-linecap"),l=e.getAttribute("stroke-linejoin"),c=e.getAttribute("stroke-miterlimit"),u=e.getAttribute("stroke-width");this.fill=n!==null?n==="none"?"none":Pd.parseColor(n):null,this.opacity=r&&parseFloat(r),this.stroke=i&&Pd.parseColor(e.getAttribute("stroke")),this.strokeDashArray=s&&Nue([s,"optionalAccess",d=>d.split,"call",d=>d(/[, ]+/g),"access",d=>d.map,"call",d=>d(h=>parseFloat(h.trim()))]),this.strokeDashOffset=o&&parseFloat(o),this.strokeLineCap=a,this.strokeLineJoin=l,this.strokeMiterLimit=c&&parseFloat(c),this.strokeWidth=u&&parseFloat(u)}static parseColor(e){if(!e)return 0;if(e==="none"||e.startsWith("url"))return e;if(e[0]==="#")return e=e.substr(1),e.length===3&&(e=e.replace(/([a-f0-9])/ig,"$1$1")),parseInt(e,16);const{r:n,g:r,b:i}=Pe(e).toRgb();return(n<<16)+(r<<8)+i}}function e8(t){t.x1.baseVal.convertToSpecifiedUnits(SVGLength.SVG_LENGTHTYPE_PERCENTAGE),t.y1.baseVal.convertToSpecifiedUnits(SVGLength.SVG_LENGTHTYPE_PERCENTAGE),t.x2.baseVal.convertToSpecifiedUnits(SVGLength.SVG_LENGTHTYPE_PERCENTAGE),t.y2.baseVal.convertToSpecifiedUnits(SVGLength.SVG_LENGTHTYPE_PERCENTAGE)}class Fue{constructor(e,n){this.paintServer=e,this.paintTexture=n,this.paintContexts={},this.dirtyId=0}resolvePaint(e){const n=this.paintContexts[e.CONTEXT_UID],r=this.dirtyId;(n===void 0||n<r)&&(this.updatePaint(e),this.paintContexts[e.CONTEXT_UID]=r)}resolvePaintDimensions(e){const n=Math.ceil(e.width),r=Math.ceil(e.height),i=n/r,s=this.paintServer,o=this.paintTexture;if(s instanceof SVGLinearGradientElement){e8(s);const a=s.children,l=s.x1.baseVal.valueInSpecifiedUnits,c=s.y1.baseVal.valueInSpecifiedUnits,u=s.x2.baseVal.valueInSpecifiedUnits,d=s.y2.baseVal.valueInSpecifiedUnits,h=Math.atan2(d-c,u-l),f=a.length===1?2:64;let p=Math.max(1,f*Math.cos(h)),m=Math.max(1,f*Math.sin(h));if(p<n&&m<r){Math.abs(h)>.01&&Math.abs(h)%(Math.PI/2)>.01&&(p/m>i?m=p/i:p=i*m),o.resize(p,m,!0);return}}o.resize(n,r,!0)}updatePaint(e){this.paintServer instanceof SVGLinearGradientElement?this.linearGradient(e):this.paintServer instanceof SVGRadialGradientElement&&this.radialGradient(e)}linearGradient(e){const n=this.paintServer,r=this.paintTexture;return e8(n),Zk.createLinearGradient(e,r,{x0:n.x1.baseVal.valueInSpecifiedUnits*r.width/100,y0:n.y1.baseVal.valueInSpecifiedUnits*r.height/100,x1:n.x2.baseVal.valueInSpecifiedUnits*r.width/100,y1:n.y2.baseVal.valueInSpecifiedUnits*r.height/100,colorStops:this.createColorStops(n.children)})}radialGradient(e){const n=this.paintServer,r=this.paintTexture;return n.fx.baseVal.convertToSpecifiedUnits(SVGLength.SVG_LENGTHTYPE_NUMBER),n.fy.baseVal.convertToSpecifiedUnits(SVGLength.SVG_LENGTHTYPE_NUMBER),n.cx.baseVal.convertToSpecifiedUnits(SVGLength.SVG_LENGTHTYPE_NUMBER),n.cy.baseVal.convertToSpecifiedUnits(SVGLength.SVG_LENGTHTYPE_NUMBER),Zk.createRadialGradient(e,r,{x0:n.fx.baseVal.valueInSpecifiedUnits*r.width/100,y0:n.fy.baseVal.valueInSpecifiedUnits*r.height/100,r0:n.fr.baseVal.valueInSpecifiedUnits*r.width/100,x1:n.cx.baseVal.valueInSpecifiedUnits*r.width/100,y1:n.cy.baseVal.valueInSpecifiedUnits*r.height/100,r1:n.r.baseVal.valueInSpecifiedUnits*r.width/100,colorStops:this.createColorStops(n.children)})}createColorStops(e){const n=[];for(let r=0,i=e.length;r<i;r++){const s=e.item(r);n.push({offset:s.offset.baseVal,color:Pd.parseColor(s.getAttribute("stop-color"))})}return n}}const Gy=100;var Ld;(function(t){const e="nonzero";t.NONZERO=e;const n="evenodd";t.EVENODD=n})(Ld||(Ld={}));class Vy{__init(){this.bounds=new gl}constructor(){Vy.prototype.__init.call(this),this.contours=[],this.fillRule=Ld.NONZERO,this.type=Gy,this.dirty=!0}get points(){return this.contours.length||this.contours.push([]),this.contours[this.contours.length-1]}contains(e,n){this.dirty&&(this.calculateBounds(),this.dirty=!1);const r=this.bounds;return e<r.minX||n<r.minY||e>r.maxX||n>r.maxY?!1:this.fillRule===Ld.EVENODD?this.hitEvenOdd(e,n):this.fillRule===Ld.NONZERO?this.hitNonZero(e,n):!1}clone(){const e=this.contours.map(r=>[...r]),n=new Vy;return n.contours=e,n.fillRule=this.fillRule,n}closeContour(){this.points.length!==0&&this.contours.push([])}invalidate(){this.dirty=!0}toString(){return"[@pixi-essentials/svg:Path Don't expect points to be printed :P]"}calculateBounds(){const e=this.bounds;let n=1/0,r=1/0,i=-1/0,s=-1/0;for(const o of this.contours)for(let a=0,l=o.length;a<l;){const c=o[a++],u=o[a++];n=c<n?c:n,r=u<r?u:r,i=c>i?c:i,s=u>s?u:s}e.minX=n,e.minY=r,e.maxX=i,e.maxY=s}hitEvenOdd(e,n){let r=0;for(const i of this.contours)for(let s=0,o=i.length;s<o;){const a=i[s++],l=i[s++],c=i[s%i.length],u=i[(s+1)%i.length];if(l<n&&u>n||l>n&&u<n){const d=(n-l)/(u-l),h=a+d*(c-a);e<h&&++r}}return!!(r%2)}hitNonZero(e,n){let r=0;for(const i of this.contours)for(let s=0,o=i.length;s<o;){const a=i[s++],l=i[s++],c=i[s%i.length],u=i[(s+1)%i.length];l<=n?u>n&&t8(e,n,a,l,c,u)>0&&++r:u<=n&&t8(e,n,a,l,c,u)<0&&--r}return r!==0}}function t8(t,e,n,r,i,s){return(i-n)*(e-r)-(t-n)*(s-r)}function Bue(t,e){return Math.sqrt((t.x-e.x)**2+(t.y-e.y)**2)}function n8(t,e,n,r,i,s,o,a){const l=t-n*i,c=e-r*i,u=t+n*s,d=e+r*s;let h,f;o?(h=r,f=-n):(h=-r,f=n);const p=l+h,m=c+f,v=u+h,y=d+f;return a.push(p,m),a.push(v,y),2}function pg(t,e,n,r,i,s,o,a){const l=n-t,c=r-e;let u=Math.atan2(l,c),d=Math.atan2(i-t,s-e);a&&u<d?u+=Math.PI*2:!a&&u>d&&(d+=Math.PI*2);let h=u;const f=d-u,p=Math.abs(f),m=Math.sqrt(l*l+c*c),v=(15*p*Math.sqrt(m)/Math.PI>>0)+1,y=f/v;if(h+=y,a){o.push(t,e),o.push(n,r);for(let b=1,_=h;b<v;b++,_+=y)o.push(t,e),o.push(t+Math.sin(_)*m,e+Math.cos(_)*m);o.push(t,e),o.push(i,s)}else{o.push(n,r),o.push(t,e);for(let b=1,_=h;b<v;b++,_+=y)o.push(t+Math.sin(_)*m,e+Math.cos(_)*m),o.push(t,e);o.push(i,s),o.push(t,e)}return v*2}function r8(t,e,n){const r=n.points,i=t.length/2;let s=t.length;const o=r.length/2,a=e.width/2,l=a*a,c=e.miterLimit*e.miterLimit;let u=t[0],d=t[1],h=t[2],f=t[3],p=0,m=0,v=-(d-f),y=u-h,b=0,_=0,E=Math.sqrt(v*v+y*y);v/=E,y/=E,v*=a,y*=a;const w=e.alignment,x=(1-w)*2,T=w*2;e.cap===_n.ROUND?s+=pg(u-v*(x-T)*.5,d-y*(x-T)*.5,u-v*x,d-y*x,u+v*T,d+y*T,r,!0)+2:e.cap===_n.SQUARE&&(s+=n8(u,d,v,y,x,T,!0,r)),r.push(u-v*x,d-y*x),r.push(u+v*T,d+y*T);for(let L=1;L<i-1;++L){u=t[(L-1)*2],d=t[(L-1)*2+1],h=t[L*2],f=t[L*2+1],p=t[(L+1)*2],m=t[(L+1)*2+1],v=-(d-f),y=u-h,E=Math.sqrt(v*v+y*y),v/=E,y/=E,v*=a,y*=a,b=-(f-m),_=h-p,E=Math.sqrt(b*b+_*_),b/=E,_/=E,b*=a,_*=a;const F=h-u,N=d-f,R=h-p,H=m-f,W=N*R-H*F,q=W<0;if(Math.abs(W)<.1){r.push(h-v*x,f-y*x),r.push(h+v*T,f+y*T);continue}const Z=(-v+u)*(-y+f)-(-v+h)*(-y+d),j=(-b+p)*(-_+f)-(-b+h)*(-_+m),K=(F*j-R*Z)/W,$=(H*Z-N*j)/W,B=(K-h)*(K-h)+($-f)*($-f),G=h+(K-h)*x,Y=f+($-f)*x,X=h-(K-h)*T,J=f-($-f)*T;e.join===Vt.BEVEL||B/l>c?(q?(r.push(G,Y),r.push(h+v*T,f+y*T),r.push(G,Y),r.push(h+b*T,f+_*T)):(r.push(h-v*x,f-y*x),r.push(X,J),r.push(h-b*x,f-_*x),r.push(X,J)),s+=2):e.join===Vt.ROUND?q?(r.push(G,Y),r.push(h+v*T,f+y*T),s+=pg(h,f,h+v*T,f+y*T,h+b*T,f+_*T,r,!0)+4,r.push(G,Y),r.push(h+b*T,f+_*T)):(r.push(h-v*x,f-y*x),r.push(X,J),s+=pg(h,f,h-v*x,f-y*x,h-b*x,f-_*x,r,!1)+4,r.push(h-b*x,f-_*x),r.push(X,J)):(r.push(G,Y),r.push(X,J))}u=t[(i-2)*2],d=t[(i-2)*2+1],h=t[(i-1)*2],f=t[(i-1)*2+1],v=-(d-f),y=u-h,E=Math.sqrt(v*v+y*y),v/=E,y/=E,v*=a,y*=a,r.push(h-v*x,f-y*x),r.push(h+v*T,f+y*T),e.cap===_n.ROUND?s+=pg(h-v*(x-T)*.5,f-y*(x-T)*.5,h-v*x,f-y*x,h+v*T,f+y*T,r,!1)+2:e.cap===_n.SQUARE&&(s+=n8(h,f,v,y,x,T,!1,r));const C=n.indices,k=Gp.epsilon*Gp.epsilon;for(let L=o;L<s+o-2;++L)u=r[L*2],d=r[L*2+1],h=r[(L+1)*2],f=r[(L+1)*2+1],p=r[(L+2)*2],m=r[(L+2)*2+1],!(Math.abs(u*(f-m)+h*(m-d)+p*(d-f))<k)&&C.push(L,L+1,L+2)}function $_(t){return t%2===0}function Uue(t,e){return(t+1)%e.length}function i8(t,e){const n=t.shape;let r=t.points||n.points.slice();const i=e.closePointEps;if(r.length===0)return;const s=new Ke(r[0],r[1]),o=new Ke(r[r.length-2],r[r.length-1]),a=n.type!==ut.POLY||n.closeStroke,l=Math.abs(s.x-o.x)<i&&Math.abs(s.y-o.y)<i;if(a){r=r.slice(),l&&(r.pop(),r.pop(),o.set(r[r.length-2],r[r.length-1]));const b=(s.x+o.x)*.5,_=(o.y+s.y)*.5;r.unshift(b,_),r.push(b,_)}const c=t.lineStyle;let u=c.dashOffset||0;const d=c.dashArray||[10,5],h=r.length/2-1,f=new Ke,p=new Ke,m=[],v=new Ke;let y=0;m.push(r[0],r[1]);for(let b=0;b<h;b++){f.set(r[b*2],r[b*2+1]),p.set(r[b*2+2],r[b*2+3]);const _=Bue(f,p),E=Math.atan2(p.y-f.y,p.x-f.x),w=Math.sin(E),x=Math.cos(E);let T=_;for(v.copyFrom(f);T>=d[y]-u;){const C=d[y]-u;v.x+=x*C,v.y+=w*C,m.push(v.x,v.y),$_(y)&&(r8(m,c,e),m.length=0),T-=C,y=Uue(y,d),u=0}T>0&&($_(y)&&m.push(p.x,p.y),u+=T)}$_(y)&&r8(m,c,e)}const $ue=new gl;var ko;(function(t){t[t.POLY=0]="POLY";const n=1;t[t.RECT=n]="RECT";const r=2;t[t.CIRC=r]="CIRC";const i=3;t[t.ELIP=i]="ELIP";const s=4;t[t.RREC=s]="RREC"})(ko||(ko={}));class Hue extends q9{processLine(e){if(e.shape.type===Gy){this.processPathLine(e);return}e.lineStyle.dashArray?i8(e,this):super.processLine(e)}processPathLine(e){const n=e.shape,r=e.lineStyle;n.contours.forEach(i=>{if(i.find(s=>isNaN(s))!==void 0){console.error("Contour has NaN, oops!");return}r.dashArray?i8({points:i,holes:[],shape:{points:i,type:ko.POLY},lineStyle:r},this):super.processLine({closeStroke:!0,points:i.slice(),holes:[],shape:{points:i,type:ko.POLY},lineStyle:r})})}calculateBounds(){const e=this._bounds,n=$ue;let r=Ze.IDENTITY;this._bounds.clear(),n.clear();for(let i=0;i<this.graphicsData.length;i++){const s=this.graphicsData[i],o=s.shape,a=s.type,l=s.lineStyle,c=s.matrix||Ze.IDENTITY;let u=0;if(l&&l.visible){const d=l.alignment;u=l.width,a===ko.POLY?u=u*(.5+Math.abs(.5-d)):u=u*Math.max(0,d)}if(r!==c&&(n.isEmpty()||(e.addBoundsMatrix(n,r),n.clear()),r=c),a===ko.RECT||a===ko.RREC){const d=o;n.addFramePad(d.x,d.y,d.x+d.width,d.y+d.height,u,u)}else if(a===ko.CIRC){const d=o;n.addFramePad(d.x,d.y,d.x,d.y,d.radius+u,d.radius+u)}else if(a===ko.ELIP){const d=o;n.addFramePad(d.x,d.y,d.x,d.y,d.width+u,d.height+u)}else if(a===Gy)o.contours.forEach(h=>{e.addVerticesMatrix(Ze.IDENTITY,new Float32Array(h),0,h.length)});else{const d=o;e.addVerticesMatrix(r,d.points,0,d.points.length,u,u)}}n.isEmpty()||e.addBoundsMatrix(n,r),e.pad(this.boundsPadding,this.boundsPadding)}}class Wy extends eO{constructor(...e){super(...e),Wy.prototype.__init.call(this),Wy.prototype.__init2.call(this)}__init(){this.dashArray=null}__init2(){this.dashOffset=0}clone(){const e=super.clone();return e.dashArray=this.dashArray?[...this.dashArray]:null,e.dashOffset=this.dashOffset,e}reset(){super.reset(),this.dashArray=null,this.dashOffset=0}}const zue={calculateArcLength(t,e,n,r,i=.05){const s=Math.sign(r),o=Math.abs(r),a=t*t,c=e*e-a;let u=0;for(let d=n+i*.5,h=0;h<o;d+=s*i,h+=i){const f=Math.cos(d),p=f*f,m=Math.sqrt(a+c*p);u+=i*m}return u}},H_=new Ze,Gue=Gp._segmentsCount.bind(Gp);class ap extends uu{constructor(e){super(),this.context=e,this._geometry=new Hue,this._geometry.refCount++,this._lineStyle=new Wy,this.paintServers=[]}lineTextureStyle(e){e=Object.assign({width:0,texture:he.WHITE,color:e&&e.texture?16777215:0,alpha:1,matrix:null,alignment:.5,native:!1,cap:_n.BUTT,join:Vt.MITER,miterLimit:10,dashArray:null,dashOffset:0},e),this.currentPath&&this.startPoly();const n=e.width>0&&e.alpha>0;return n?(e.matrix&&(e.matrix=e.matrix.clone(),e.matrix.invert()),Object.assign(this._lineStyle,{visible:n},e)):this._lineStyle.reset(),this}ellipticArc(e,n,r,i,s,o,a=0,l=!1){const c=o-s,u=Gp.adaptive?Gue(zue.calculateArcLength(r,i,s,o-s))*4:20,d=(l?-1:1)*Math.abs(c)/(u-1);H_.identity().translate(-e,-n).rotate(a).translate(e,n);for(let h=0;h<u;h++){const f=s+h*d,p=e+r*Math.cos(f),m=n+i*Math.sin(f),{x:v,y}=a!==0?H_.apply({x:p,y:m}):{x:p,y:m};if(h===0){this._initCurve(v,y);continue}this.currentPath.points.push(v,y)}return this}ellipticArcTo(e,n,r,i,s=0,o=!1,a=!1){if(r===0||i===0)return this.lineTo(e,n);const l=this.currentPath.points,c=l[l.length-2],u=l[l.length-1],d=(c+e)/2,h=(u+n)/2,f=H_.identity().translate(-d,-h).rotate(-s),{x:p,y:m}=f.apply({x:c,y:u}),v=Math.pow(p/r,2)+Math.pow(m/i,2);v>1&&(r=Math.sqrt(v)*r,i=Math.sqrt(v)*i);const y=r*r,b=i*i,E=(o===a?1:-1)*Math.sqrt(Math.abs(y*b-y*m*m-b*p*p)/(y*m*m+b*p*p)),w=E*(r*m/i),x=-E*(i*p/r),{x:T,y:C}=f.applyInverse({x:w,y:x}),k=(p-w)/r,L=(m-x)/i,F=Math.sqrt(k**2+L**2),N=(L>=0?1:-1)*Math.acos(k/F),R=(-p-w)/r,H=(-m-x)/i,W=Math.sqrt(R**2+H**2);let q=(H>=0?1:-1)*Math.acos(R/W);return q>N&&o?q-=Math.PI*2:N>q&&!o&&(q+=Math.PI*2),this.ellipticArc(T,C,r,i,N,q,s,o),this}embedCircle(e){e.cx.baseVal.convertToSpecifiedUnits(SVGLength.SVG_LENGTHTYPE_PX),e.cy.baseVal.convertToSpecifiedUnits(SVGLength.SVG_LENGTHTYPE_PX),e.r.baseVal.convertToSpecifiedUnits(SVGLength.SVG_LENGTHTYPE_PX);const n=e.cx.baseVal.valueInSpecifiedUnits,r=e.cy.baseVal.valueInSpecifiedUnits,i=e.r.baseVal.valueInSpecifiedUnits;this.drawCircle(n,r,i)}embedEllipse(e){e.cx.baseVal.convertToSpecifiedUnits(SVGLength.SVG_LENGTHTYPE_PX),e.cy.baseVal.convertToSpecifiedUnits(SVGLength.SVG_LENGTHTYPE_PX),e.rx.baseVal.convertToSpecifiedUnits(SVGLength.SVG_LENGTHTYPE_PX),e.ry.baseVal.convertToSpecifiedUnits(SVGLength.SVG_LENGTHTYPE_PX);const n=e.cx.baseVal.valueInSpecifiedUnits,r=e.cy.baseVal.valueInSpecifiedUnits,i=e.rx.baseVal.valueInSpecifiedUnits,s=e.ry.baseVal.valueInSpecifiedUnits;this.ellipticArc(n,r,i,s,0,2*Math.PI)}embedLine(e){e.x1.baseVal.convertToSpecifiedUnits(SVGLength.SVG_LENGTHTYPE_PX),e.y1.baseVal.convertToSpecifiedUnits(SVGLength.SVG_LENGTHTYPE_PX),e.x2.baseVal.convertToSpecifiedUnits(SVGLength.SVG_LENGTHTYPE_PX),e.y2.baseVal.convertToSpecifiedUnits(SVGLength.SVG_LENGTHTYPE_PX);const n=e.x1.baseVal.valueInSpecifiedUnits,r=e.y1.baseVal.valueInSpecifiedUnits,i=e.x2.baseVal.valueInSpecifiedUnits,s=e.y2.baseVal.valueInSpecifiedUnits;this.moveTo(n,r),this.lineTo(i,s)}embedRect(e){e.x.baseVal.convertToSpecifiedUnits(SVGLength.SVG_LENGTHTYPE_PX),e.y.baseVal.convertToSpecifiedUnits(SVGLength.SVG_LENGTHTYPE_PX),e.width.baseVal.convertToSpecifiedUnits(SVGLength.SVG_LENGTHTYPE_PX),e.height.baseVal.convertToSpecifiedUnits(SVGLength.SVG_LENGTHTYPE_PX),e.rx.baseVal.convertToSpecifiedUnits(SVGLength.SVG_LENGTHTYPE_PX),e.ry.baseVal.convertToSpecifiedUnits(SVGLength.SVG_LENGTHTYPE_PX);const n=e.x.baseVal.valueInSpecifiedUnits,r=e.y.baseVal.valueInSpecifiedUnits,i=e.width.baseVal.valueInSpecifiedUnits,s=e.height.baseVal.valueInSpecifiedUnits,o=e.rx.baseVal.valueInSpecifiedUnits,a=e.ry.baseVal.valueInSpecifiedUnits||o;o===0||a===0?this.drawRect(n,r,i,s):(this.moveTo(n,r+a),this.ellipticArcTo(n+o,r,o,a,0,!1,!1),this.lineTo(n+i-o,r),this.ellipticArcTo(n+i,r+a,o,a,0,!1,!1),this.lineTo(n+i,r+s-a),this.ellipticArcTo(n+i-o,r+s,o,a,0,!1,!1),this.lineTo(n+o,r+s),this.ellipticArcTo(n,r+s-a,o,a,0,!1,!1),this.closePath())}embedPolygon(e){const n=e.getAttribute("points").split(/[ ,]/g).map(r=>parseInt(r,10));this.moveTo(n[0],n[1]);for(let r=2;r<n.length;r+=2)this.lineTo(n[r],n[r+1]);this.closePath()}embedPolyline(e){const n=e.getAttribute("points").split(/[ ,]/g).map(r=>parseInt(r,10));this.moveTo(n[0],n[1]);for(let r=2;r<n.length;r+=2)this.lineTo(n[r],n[r+1])}render(e){const n=this.paintServers;for(let r=0,i=n.length;r<i;r++)n[r].resolvePaint(e);super.render(e)}}function Vue(t){let e,n=t[0],r=1;for(;r<t.length;){const i=t[r],s=t[r+1];if(r+=2,(i==="optionalAccess"||i==="optionalCall")&&n==null)return;i==="access"||i==="optionalAccess"?(e=n,n=s(n)):(i==="call"||i==="optionalCall")&&(n=s((...o)=>n.call(e,...o)),e=void 0)}return n}const Wue=new Ze;class jue extends ap{embedImage(e){e.x.baseVal.convertToSpecifiedUnits(SVGLength.SVG_LENGTHTYPE_PX),e.y.baseVal.convertToSpecifiedUnits(SVGLength.SVG_LENGTHTYPE_PX),e.width.baseVal.convertToSpecifiedUnits(SVGLength.SVG_LENGTHTYPE_PX),e.height.baseVal.convertToSpecifiedUnits(SVGLength.SVG_LENGTHTYPE_PX);const n=e.x.baseVal.valueInSpecifiedUnits,r=e.y.baseVal.valueInSpecifiedUnits,i=e.width.baseVal.valueInSpecifiedUnits,s=e.height.baseVal.valueInSpecifiedUnits,o=Number.parseFloat(e.getAttribute("opacity")||"1"),a=e instanceof SVGGraphicsElement?e.transform.baseVal.consolidate():null,l=a?a.matrix:Wue.identity(),{a:c,b:u,c:d,d:h}=l,f=Math.min(1,Math.sqrt(c*c+u*u)),p=Math.min(1,Math.sqrt(d*d+h*h)),m=Math.ceil(i*f),v=Math.ceil(s*p);this.initTexture(m,v);const y=Vue([globalThis,"optionalAccess",w=>w.location,"access",w=>w.href]),b=e.getAttribute("href")||e.getAttribute("xlink:href"),_=new URL(b).origin;let E=e;_&&_!==y&&(E=document.createElement("img"),E.crossOrigin="anonymous",E.src=b),E.onload=()=>{this.drawTexture(E)},this.beginTextureFill({texture:this._texture,alpha:o,matrix:new Ze().scale(1/f,1/p)}),this.drawRect(n,r,i,s),this.endFill()}initTexture(e,n){this._texture&&(this._texture.width<=this.context.atlas.maxWidth&&this._texture.height<=this.context.atlas.maxHeight?this.context.atlas.free(this._texture):this._texture.destroy()),this._texture=null,this._texture=this.context.atlas.allocate(e,n),this._texture?(this._canvas=this._texture.baseTexture.resource.source,this._context=this._canvas.getContext("2d")):(this._canvas=document.createElement("canvas"),this._canvas.width=e,this._canvas.height=n,this._context=this._canvas.getContext("2d"),this._texture=he.from(this._canvas))}drawTexture(e){const n=this._texture.frame;this._context.clearRect(n.x,n.y,n.width,n.height),this._context.drawImage(e,n.x,n.y,n.width,n.height),this._texture.update()}}const Xue={build(){},triangulate(t,e){try{let n=function(p,m){m[m.length]=p[0],m[m.length]=p[1]},r=function(p){p!==Os.primitiveType.GL_TRIANGLES&&console.warn(`expected TRIANGLES but got type: ${p}`)},i=function(p){console.error("error callback"),console.error(`error number: ${p}`)},s=function(p,m,v){return[p[0],p[1],p[2]]},o=function(p){};const a=t.shape,l=a.contours.filter(p=>p.length>0).filter(p=>p.find(m=>isNaN(m))===void 0),c=new Os.GluTesselator,u=[];c.gluTessProperty(Os.gluEnum.GLU_TESS_WINDING_RULE,a.fillRule===Ld.EVENODD?Os.windingRule.GLU_TESS_WINDING_ODD:Os.windingRule.GLU_TESS_WINDING_NONZERO),c.gluTessCallback(Os.gluEnum.GLU_TESS_VERTEX_DATA,n),c.gluTessCallback(Os.gluEnum.GLU_TESS_BEGIN,r),c.gluTessCallback(Os.gluEnum.GLU_TESS_ERROR,i),c.gluTessCallback(Os.gluEnum.GLU_TESS_COMBINE,s),c.gluTessCallback(Os.gluEnum.GLU_TESS_EDGE_FLAG,o),c.gluTessNormal(0,0,1),c.gluTessBeginPolygon(u);for(let p=0;p<l.length;p++){const m=l[p];c.gluTessBeginContour();for(let v=0;v<m.length;){const y=m[v++],b=m[v++],_=[y,b,0];c.gluTessVertex(_,_)}c.gluTessEndContour()}c.gluTessEndPolygon();const d=e.points,h=e.indices,f=d.length/2;for(let p=0;p<u.length;)d.push(u[p++],u[p++]);for(let p=0;p<u.length/2;p++)h.push(p+f)}catch(n){console.error(n)}}};function s8(t){let e,n=t[0],r=1;for(;r<t.length;){const i=t[r],s=t[r+1];if(r+=2,(i==="optionalAccess"||i==="optionalCall")&&n==null)return;i==="access"||i==="optionalAccess"?(e=n,n=s(n)):(i==="call"||i==="optionalCall")&&(n=s((...o)=>n.call(e,...o)),e=void 0)}return n}nO.FILL_COMMANDS[Gy]=Xue;class jy extends ap{constructor(...e){super(...e),jy.prototype.__init.call(this),jy.prototype.__init2.call(this)}startPath(){this.currentPath2?this.currentPath2.points.length>0&&this.currentPath2.closeContour():this.currentPath2=new Vy}finishPath(){this.currentPath2&&this.currentPath2.closeContour()}get currentPath(){return this.currentPath2}set currentPath(e){if(e)throw new Error("currentPath cannot be set")}closePath(){return this.currentPath2.points.push(this.currentPath2.points[0],this.currentPath2.points[1]),this.finishPath(),this}checkPath(){if(this.currentPath2.points.find(e=>isNaN(e))!==void 0)throw new Error("NaN is bad")}__init(){this.startPoly=this.startPath}__init2(){this.finishPoly=this.finishPath}embedPath(e){const n=e.getAttribute("d"),r=Lue(n.trim());let i=0,s=0;for(let o=0,a=r.length;o<a;o++){const l=r[o-1],c=r[o];if(isNaN(i)||isNaN(s))throw new Error("Data corruption");switch(c.code){case"m":{this.moveTo(i+=c.end.x,s+=c.end.y);break}case"M":{this.moveTo(i=c.end.x,s=c.end.y);break}case"H":{this.lineTo(i=c.value,s);break}case"h":{this.lineTo(i+=c.value,s);break}case"V":{this.lineTo(i,s=c.value);break}case"v":{this.lineTo(i,s+=c.value);break}case"z":case"Z":{i=s8([this,"access",u=>u.currentPath2,"optionalAccess",u=>u.points,"access",u=>u[0]])||0,s=s8([this,"access",u=>u.currentPath2,"optionalAccess",u=>u.points,"access",u=>u[1]])||0,this.closePath();break}case"L":{this.lineTo(i=c.end.x,s=c.end.y);break}case"l":{this.lineTo(i+=c.end.x,s+=c.end.y);break}case"C":{this.bezierCurveTo(c.cp1.x,c.cp1.y,c.cp2.x,c.cp2.y,i=c.end.x,s=c.end.y);break}case"c":{const u=i,d=s;this.bezierCurveTo(u+c.cp1.x,d+c.cp1.y,u+c.cp2.x,d+c.cp2.y,i+=c.end.x,s+=c.end.y);break}case"s":case"S":{const u={x:i,y:s},d=r[o-1]?r[o-1].code:null;if(o>0&&(d==="s"||d==="S"||d==="c"||d==="C")){const f=r[o-1],p={...f.cp2||f.cp};r[o-1].relative&&(p.x+=i-f.end.x,p.y+=s-f.end.y),u.x=2*i-p.x,u.y=2*s-p.y}const h={x:c.cp.x,y:c.cp.y};c.relative?(h.x+=i,h.y+=s,i+=c.end.x,s+=c.end.y):(i=c.end.x,s=c.end.y),this.bezierCurveTo(u.x,u.y,h.x,h.y,i,s);break}case"q":{const u=i,d=s;this.quadraticCurveTo(u+c.cp.x,d+c.cp.y,i+=c.end.x,s+=c.end.y);break}case"Q":{this.quadraticCurveTo(c.cp.x,c.cp.y,i=c.end.x,s=c.end.y);break}case"A":this.ellipticArcTo(i=c.end.x,s=c.end.y,c.radii.x,c.radii.y,(c.rotation||0)*Math.PI/180,!c.clockwise,c.large);break;case"a":this.ellipticArcTo(i+=c.end.x,s+=c.end.y,c.radii.x,c.radii.y,(c.rotation||0)*Math.PI/180,!c.clockwise,c.large);break;case"t":case"T":{let u,d;if(l&&l.cp){let h=l.cp.x,f=l.cp.y;if(l.relative){const p=i-l.end.x,m=s-l.end.y;h+=p,f+=m}u=2*i-h,d=2*s-f}else u=i,d=s;c.code==="t"?this.quadraticCurveTo(u,d,i+=c.end.x,s+=c.end.y):this.quadraticCurveTo(u,d,i=c.end.x,s=c.end.y);break}default:{console.warn("[PIXI.SVG] Draw command not supported:",c.code,c);break}}}return this.currentPath2&&(this.currentPath2.fillRule=e.getAttribute("fill-rule")||this.currentPath2.fillRule,this.drawShape(this.currentPath2),this.currentPath2=null),this}}const vB=new ay;vB.matrix=[.33,.33,.33,0,0,0,0,0,0,0,0,0,0,0,0,.33,.33,.33,0,0];const Yue=new Me,Zue=new Me;class Kue extends On{render(e){}}class que extends On{constructor(e){super(e),this.dirtyId=0,this.updateId=-1}render(e){if(this.dirtyId!==this.updateId){this.texture.baseTexture.setSize(this.texture.width,this.texture.height,e.resolution),e.batch.flush();const n=e.renderTexture.current,r=Yue.copyFrom(e.renderTexture.sourceFrame),i=Zue.copyFrom(e.renderTexture.destinationFrame),s=this.getLocalBounds(null),o=this.children;e.renderTexture.bind(this.texture,s),e.renderTexture.clear(),e.filter.push({filterArea:s,getBounds:()=>s},[vB]);for(let a=0,l=o.length;a<l;a++){const c=o[a];c.enableTempParent(),c.updateTransform(),o[a].render(e),c.disableTempParent(this)}e.batch.flush(),e.filter.pop(),e.renderTexture.bind(n,r,i),this.updateId=this.dirtyId,this.getBounds()}}createMask(e){return new Kue(this.texture)}}const lp="nodetransformdirty",o8="transformdirty";class Jue extends On{constructor(){super(he.EMPTY),this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d"),this.texture=he.from(this.canvas),this.contentList=new Map,this.dirtyId=0,this.updateId=0}async clear(){this.contentList.clear(),this.dirtyId++,this.position.set(0,0)}async put(e,n,r,i,s){this.contentList.set(e,{position:n,content:r,style:i,matrix:s});const o=rs.measureText(r,new Ci(i),!1,this.canvas);return this.dirtyId++,{x:n.x+o.width,y:n.y}}updateText(){let e=0,n=0;this.contentList.forEach(({position:s,content:o,style:a})=>{const l=rs.measureText(o,new Ci(a),!1,this.canvas);e=Math.max(e,s.x+l.width),n=Math.max(n,s.y+l.height+l.fontProperties.descent)});const r=window.devicePixelRatio||1;this.canvas.width=e*r,this.canvas.height=n*r,this.texture.baseTexture.setRealSize(e,n,r),this.texture.update(),this.context.clearRect(0,0,e*r,n*r),this.context.setTransform(1,0,0,1,0,0),this.context.scale(r,r);let i=0;for(const[s,{position:o,content:a,style:l}]of this.contentList){const c=rs.measureText(a,new Ci(l),!1,this.canvas),u=new Ci(l);this.context.fillStyle=typeof u.fill=="string"?u.fill:"black",this.context.font=u.toFontString(),this.context.fillText(a,o.x,o.y+c.height),i===0&&(this.y-=c.height),i++}this.updateId=this.dirtyId,this.emit(lp)}render(e){this.updateId!==this.dirtyId&&(this.updateText(),this.updateTransform()),super.render(e)}}function Que(t,e=16){return t?t.includes("em")?parseFloat(t)*e:parseFloat(t):0}class x2 extends Xn{static __initStatic(){this.defaultEngine=Jue}constructor(){super(),this.currentTextPosition={x:0,y:0},this.engine=new x2.defaultEngine,this.addChild(this.engine),this.engine.on(lp,()=>{this.emit(lp)})}async embedText(e,n={}){const r=this.engine;e instanceof SVGTextElement&&(await r.clear(),this.currentTextPosition.x=e.x.baseVal.length>0?e.x.baseVal.getItem(0).value:0,this.currentTextPosition.y=e.y.baseVal.length>0?e.y.baseVal.getItem(0).value:0);const i=e.getAttribute("fill"),s=e.getAttribute("font-family"),o=parseFloat(e.getAttribute("font-size")),a=e.getAttribute("font-weight"),l=Que(e.getAttribute("letter-spacing"),o);n.fill=i||n.fill||"black",n.fontFamily=s||!n.fontFamily?`${s||"serif"}, serif`:n.fontFamily,n.fontSize=isNaN(o)?n.fontSize:o,n.fontWeight=a||n.fontWeight||"normal",n.letterSpacing=isNaN(l)?n.letterSpacing||0:l,n.wordWrap=!0,n.wordWrapWidth=400;const c=e.childNodes;for(let u=0,d=c.length;u<d;u++){const h=c.item(u);let f,p;h instanceof globalThis.Text?(f=h.data,p=n,this.currentTextPosition=await r.put(h,{x:this.currentTextPosition.x,y:this.currentTextPosition.y},f,p),this.emit(lp)):h instanceof SVGTSpanElement&&(h.x.baseVal.length>0&&(this.currentTextPosition.x=h.x.baseVal.getItem(0).value),h.y.baseVal.length>0&&(this.currentTextPosition.y=h.y.baseVal.getItem(0).value),await this.embedText(h,{...n}))}}}x2.__initStatic();class h4 extends Xn{constructor(...e){super(...e),h4.prototype.__init.call(this)}__init(){this.isRefExternal=!1}embedUse(e){e.x.baseVal.convertToSpecifiedUnits(SVGLength.SVG_LENGTHTYPE_PX),e.y.baseVal.convertToSpecifiedUnits(SVGLength.SVG_LENGTHTYPE_PX),e.width.baseVal.convertToSpecifiedUnits(SVGLength.SVG_LENGTHTYPE_PX),e.height.baseVal.convertToSpecifiedUnits(SVGLength.SVG_LENGTHTYPE_PX);const n=e.x.baseVal.valueInSpecifiedUnits,r=e.y.baseVal.valueInSpecifiedUnits;this.position.set(n,r)}get ref(){return this._ref}set ref(e){if(this._ref){if(this._ref===e)return;this.removeChild(this._ref)}this._ref=e,this.addChild(this._ref)}}const a8=new Ze,ede=new Me;class dd extends Zt{__init(){this.sortDirty=!1}constructor(e,n){super(),dd.prototype.__init.call(this),dd.prototype.__init2.call(this),this.content=e,this.initContext(n),this._width=e.viewBox.baseVal.width,this._height=e.viewBox.baseVal.height,this._cull=new Due({recursive:!0,toggle:"renderable"}),this._elementToPaint=new Map,this._elementToMask=new Map,this._transformDirty=!0,this.renderServers=new Xn,(!n||!n.disableRootPopulation)&&this.populateScene()}initContext(e){e=e||{},e.atlas=e.atlas||new Oue(2048,2048),e.disableHrefSVGLoading=typeof e.disableHrefSVGLoading>"u"?!1:e.disableHrefSVGLoading,this._context=e}calculateBounds(){this._bounds.clear(),this._bounds.addFrameMatrix(this.worldTransform,0,0,this.content.viewBox.baseVal.width,this.content.viewBox.baseVal.height)}removeChild(){}destroy(){this.root.destroy(!0),super.destroy()}render(e){!this.visible||!this.renderable||(this.renderServers.render(e),this._cull.cull(e.renderTexture.sourceFrame,!0),this.root.render(e),this._cull.uncull())}updateTransform(){super.updateTransform(),this.root.alpha=this.worldAlpha;const e=this.worldTransform,n=this.root.transform.worldTransform;n.a===e.a&&n.b===e.b&&n.c===e.c&&n.d===e.d&&n.tx===e.tx&&n.ty===e.ty&&n._worldID!==0&&!this._transformDirty||(this.root.enableTempParent(),this.root.transform.setFromMatrix(this.worldTransform),this.root.updateTransform(),this.root.disableTempParent(null),this.root.calculateBounds(),this._transformDirty=!1)}createNode(e){let n=null;switch(e.nodeName.toLowerCase()){case"circle":case"ellipse":case"g":case"line":case"polyline":case"polygon":case"rect":n=new ap(this._context);break;case"image":n=new jue(this._context);break;case"mask":case"svg":n=new Xn;break;case"path":n=new jy(this._context);break;case"text":n=new x2;break;case"use":n=new h4;break;default:n=null;break}return n}createPaint(e){return e instanceof SVGElement?new Pd(e):null}createPaintServer(e){const n=ta.create({width:128,height:128});return new Fue(e,n)}createMask(e){e instanceof SVGElement&&(e=this.populateSceneRecursive(e,{basePaint:this.queryInheritedPaint(e)}));const n=e.getLocalBounds();e.getBounds();const r=ta.create({width:n.width,height:n.height}),i=new que(r);return i.addChild(e),i}queryMask(e){let n=this._elementToMask.get(e);return n||(n=this.createMask(e),this._elementToMask.set(e,n)),n}queryPaint(e){let n=this._elementToPaint.get(e);return n||(n=this.createPaint(e),this._elementToPaint.set(e,n)),n}queryInheritedPaint(e){const n=this.queryPaint(e),r=e.parentElement&&this.queryPaint(e.parentElement);return r?new Qk(r,n):n}parseReference(e){if(e.startsWith("url")){let n=e.slice(4,-1);return n.startsWith("'")&&n.endsWith("'")&&(n=n.slice(1,-1)),n}return e}embedIntoNode(e,n,r={}){const{basePaint:i}=r,s=i?new Qk(i,this.queryPaint(n)):this.queryPaint(n),{fill:o,opacity:a,stroke:l,strokeDashArray:c,strokeDashOffset:u,strokeLineCap:d,strokeLineJoin:h,strokeMiterLimit:f,strokeWidth:p}=s,m=n instanceof SVGGraphicsElement?n.transform.baseVal.consolidate():null,v=m?m.matrix:a8.identity();if(e instanceof ap){if(o==="none")e.beginFill(0,0);else if(typeof o=="number")e.beginFill(o,a===null?1:a);else if(!o)e.beginFill(0);else{const _=this.parseReference(o),E=this.content.querySelector(_);if(E&&E instanceof SVGGradientElement){const w=this.createPaintServer(E),x=w.paintTexture;e.paintServers.push(w),e.beginTextureFill({texture:x,alpha:a===null?1:a,matrix:new Ze})}}let b;if(typeof l=="string"&&l.startsWith("url")){const _=this.parseReference(l),E=this.content.querySelector(_);if(E&&E instanceof SVGGradientElement){const w=this.createPaintServer(E),x=w.paintTexture;e.paintServers.push(w),b=x}}e.lineTextureStyle({color:l===null?0:typeof l=="number"?l:16777215,cap:d===null?_n.SQUARE:d,dashArray:c,dashOffset:u===null?u:0,join:h===null?Vt.MITER:h,matrix:new Ze,miterLimit:f===null?150:f,texture:b||he.WHITE,width:p===null?typeof l=="number"?1:0:p})}switch(n.nodeName.toLowerCase()){case"circle":e.embedCircle(n);break;case"ellipse":e.embedEllipse(n);break;case"image":e.embedImage(n);break;case"line":e.embedLine(n);break;case"path":e.embedPath(n);break;case"polyline":e.embedPolyline(n);break;case"polygon":e.embedPolygon(n);break;case"rect":e.embedRect(n);break;case"text":e.embedText(n);break;case"use":{const b=n,_=b.getAttribute("href")||b.getAttribute("xlink:href"),E=this.queryPaint(b);if(e.embedUse(b),_.startsWith("#")){const w=this.content.querySelector(_),x=this.populateSceneRecursive(w,{basePaint:E});e.ref=x,x.transform.setFromMatrix(Ze.IDENTITY)}else this._context.disableHrefSVGLoading||(e.isRefExternal=!0,Jk(_).then(w=>[new dd(w,{...this._context,disableRootPopulation:!0}),w.querySelector("#"+_.split("#")[1])]).then(([w,x])=>{x||console.error(`SVGScene failed to resolve ${_} and SVGUseNode is empty!`);const T=w.populateSceneRecursive(x,{basePaint:E});e.ref=T,T.transform.setFromMatrix(Ze.IDENTITY),this._transformDirty=!0,w.on(o8,()=>{this._transformDirty=!0})}))}}e.transform.setFromMatrix(a8.set(v.a,v.b,v.c,v.d,v instanceof Ze?v.tx:v.e,v instanceof Ze?v.ty:v.f)),n instanceof SVGMaskElement&&this._elementToMask.set(n,this.createMask(e));const y=n.getAttribute("mask");if(y){const b=this.content.querySelector(this.parseReference(y));if(b){const _=this.queryMask(b),E=_.createMask(e);this.renderServers.addChild(_),e.mask=E,e.addChild(E)}}return{paint:s}}populateSceneRecursive(e,n){const r=this.createNode(e);if(!r)return null;r.on(lp,this.onNodeTransformDirty);let i;(e instanceof SVGGraphicsElement||e instanceof SVGMaskElement)&&(i=this.embedIntoNode(r,e,n).paint);for(let s=0,o=e.children.length;s<o;s++){const a=this.populateSceneRecursive(e.children[s],{basePaint:i});a&&r.addChild(a)}if(r instanceof ap){const s=r.getLocalBounds(ede),o=r.paintServers,{x:a,y:l,width:c,height:u}=s;r.paintServers.forEach(f=>{f.resolvePaintDimensions(s)});const d=r.geometry,h=d.graphicsData;h&&(h.forEach(f=>{const p=f.fillStyle,m=f.lineStyle;if(p.texture&&o.find(v=>v.paintTexture===p.texture)){const v=p.texture.width,y=p.texture.height;f.fillStyle.matrix.invert().scale(c/v,u/y).invert()}if(p.matrix&&p.matrix.invert().translate(a,l).invert(),m.texture&&o.find(v=>v.paintTexture===m.texture)){const v=m.texture.width,y=m.texture.height;f.lineStyle.matrix.invert().scale(c/v,u/y).invert()}m.matrix&&m.matrix.invert().translate(a,l).invert()}),d.updateBatches())}return e instanceof SVGMaskElement?null:r}populateScene(){this.root&&this._cull.remove(this.root);const e=this.populateSceneRecursive(this.content);this.root=e,this._cull.add(this.root)}__init2(){this.onNodeTransformDirty=()=>{this._transformDirty=!0,this.emit(o8,this)}}get width(){return this._width}set width(e){this._width=e,this.scale.x=this._width/this.content.viewBox.baseVal.width}get height(){return this._height}set height(e){this._height=e,this.scale.y=this._height/this.content.viewBox.baseVal.height}static async from(e,n){return new dd(await Jk(e),n)}}function bB(t,e,n=.001){return this===e||Math.abs(t.a-e.a)<n&&Math.abs(t.b-e.b)<n&&Math.abs(t.c-e.c)<n&&Math.abs(t.d-e.d)<n&&Math.abs(t.tx-e.tx)<n&&Math.abs(t.ty-e.ty)<n}class tde{constructor(){this.textureIds=[],this.matrices=[],this.lines=[],this.count=0}clear(){for(let e=0;e<this.count;e++)this.textureIds[e]=null,this.matrices[e]=null;this.count=0}add(e,n,r,i,s,o){const{textureIds:a,matrices:l,lines:c,count:u}=this;e=e*4+s;for(let d=0;d<u;d++)if(c[d*2]===r&&c[d*2+1]===i&&a[d]===e&&bB(l[d],n))return d;return u>=o.maxStyles?-1:(a[u]=e,l[u]=n,c[u*2]=r,c[u*2+1]=i,this.count++,u)}}class l8{constructor(){this.texArray=new ny,this.styleArray=new tde,this.shader=null,this.blend=Ne.NORMAL,this.start=0,this.size=0,this.TICK=0,this.settings=null,this.data=null}clear(){this.texArray.clear(),this.styleArray.clear(),this.settings=null,this.data=null,this.shader=null}begin(e,n){this.TICK=++ze._globalBatch,this.settings=e,this.shader=n,this.start=0,this.size=0,this.data=null,n&&n.settings&&(this.settings=n.settings)}check(e){return this.size===0?(this.shader=e,!0):this.shader===e}add(e,n,r,i,s){const{texArray:o,TICK:a,styleArray:l,settings:c}=this,{baseTexture:u}=e;if(u._batchEnabled!==a&&o.count===c.maxTextures)return-1;const d=u._batchEnabled!==a?o.count:u._batchLocation,h=l.add(d,n||Ze.IDENTITY,r,i,s,c);return h>=0&&u._batchEnabled!==a&&(u._batchEnabled=a,u._batchLocation=o.count,o.elements[o.count++]=u),h}}class nde{constructor(){this.reset()}begin(e,n,r){this.reset(),this.style=e,this.start=n,this.attribStart=r,this.jointEnd=0}end(e,n){this.attribSize=n-this.attribStart,this.size=e-this.start}reset(){this.style=null,this.size=0,this.start=0,this.attribStart=0,this.attribSize=0,this.styleId=-1,this.rgba=0,this.jointEnd=0}}class T2{constructor(){this.reset()}toJSON(){return this.copyTo({})}clone(){return this.copyTo(new T2)}copyTo(e){return e.color=this.color,e.alpha=this.alpha,e.texture=this.texture,e.matrix=this.matrix,e.shader=this.shader,e.visible=this.visible,e.smooth=this.smooth,e.matrixTex=null,e}packLineScale(){return 0}reset(){this.color=16777215,this.alpha=1,this.texture=he.WHITE,this.matrix=null,this.shader=null,this.visible=!1,this.smooth=!1,this.matrixTex=null}destroy(){this.texture=null,this.matrix=null,this.matrixTex=null}getTextureMatrix(){const e=this.texture;return this.matrix?e.frame.width===e.baseTexture.width&&e.frame.height===e.baseTexture.height?this.matrix:(this.matrixTex?this.matrixTex.copyFrom(this.matrix):this.matrixTex=this.matrix.clone(),this.matrixTex.translate(Number(e.frame.x),Number(e.frame.y)),this.matrixTex):null}}var wc=(t=>(t.NONE="none",t.NORMAL="normal",t.HORIZONTAL="horizontal",t.VERTICAL="vertical",t))(wc||{});class f4 extends T2{clone(){return this.copyTo(new f4)}copyTo(e){return e.color=this.color,e.alpha=this.alpha,e.texture=this.texture,e.matrix=this.matrix,e.shader=this.shader,e.visible=this.visible,e.width=this.width,e.alignment=this.alignment,e.cap=this.cap,e.join=this.join,e.miterLimit=this.miterLimit,e.scaleMode=this.scaleMode,e}packLineScale(){switch(this.scaleMode){case"normal":return 1;case"horizontal":return 2;case"vertical":return 3;default:return 0}}reset(){super.reset(),this.smooth=!0,this.color=0,this.width=0,this.alignment=.5,this.cap=_n.BUTT,this.join=Vt.MITER,this.miterLimit=10,this.scaleMode="normal"}}class rde{constructor(){this.verts=[],this.joints=[],this.vertexSize=0,this.indexSize=0,this.closePointEps=1e-4}clear(){this.verts.length=0,this.joints.length=0,this.vertexSize=0,this.indexSize=0}destroy(){this.verts.length=0,this.joints.length=0}}var de=(t=>(t[t.NONE=0]="NONE",t[t.FILL=1]="FILL",t[t.JOINT_BEVEL=4]="JOINT_BEVEL",t[t.JOINT_MITER=8]="JOINT_MITER",t[t.JOINT_ROUND=12]="JOINT_ROUND",t[t.JOINT_CAP_BUTT=16]="JOINT_CAP_BUTT",t[t.JOINT_CAP_SQUARE=18]="JOINT_CAP_SQUARE",t[t.JOINT_CAP_ROUND=20]="JOINT_CAP_ROUND",t[t.FILL_EXPAND=24]="FILL_EXPAND",t[t.CAP_BUTT=32]="CAP_BUTT",t[t.CAP_SQUARE=64]="CAP_SQUARE",t[t.CAP_ROUND=96]="CAP_ROUND",t[t.CAP_BUTT2=128]="CAP_BUTT2",t))(de||{});const Hu=class{constructor(){this.strideFloats=12,this.bufferPos=0,this.indexPos=0}updateBufferSize(t,e,n,r){const{joints:i}=r;let s=!1,o=0,a=0;for(let l=t;l<t+e;l++){const c=i[l]&-32,u=i[l]&31;if(u===de.FILL){s=!0,o++;continue}if(u>=de.FILL_EXPAND){o+=3,a+=3;continue}const d=Hu.vertsByJoint[u]+Hu.vertsByJoint[c];d>=4&&(o+=d,a+=6+3*Math.max(d-6,0))}s&&(a+=n),r.vertexSize+=o,r.indexSize+=a}beginPack(t,e,n,r,i=0,s=0){this.buildData=t,this.bufFloat=e,this.bufUint=n,this.indices=r,this.bufferPos=i,this.indexPos=s}endPack(){this.buildData=null,this.bufFloat=null,this.bufUint=null,this.indices=null}packInterleavedGeometry(t,e,n,r,i){const{bufFloat:s,bufUint:o,indices:a,buildData:l,strideFloats:c}=this,{joints:u,verts:d}=l;let h=this.bufferPos,f=this.indexPos,p=this.bufferPos/this.strideFloats,m,v,y,b,_,E,w,x,T=!1,C=0;for(let k=t;k<t+e;k++){const L=u[k],F=u[k]&-32,N=u[k]&31;if(N===de.FILL){T=!0,m=d[k*2],v=d[k*2+1],s[h]=m,s[h+1]=v,s[h+2]=m,s[h+3]=v,s[h+4]=m,s[h+5]=v,s[h+6]=m,s[h+7]=v,s[h+8]=C,s[h+9]=16*N,s[h+10]=r,o[h+11]=i,h+=c;continue}if(N>=de.FILL_EXPAND){_=d[k*2],E=d[k*2+1],m=d[k*2+2],v=d[k*2+3],y=d[k*2+4],b=d[k*2+5];const W=k+3;for(let q=0;q<3;q++)s[h]=_,s[h+1]=E,s[h+2]=m,s[h+3]=v,s[h+4]=y,s[h+5]=b,s[h+6]=d[(W+q)*2],s[h+7]=d[(W+q)*2+1],s[h+8]=C,s[h+9]=16*L+q,s[h+10]=r,o[h+11]=i,h+=c;a[f]=p,a[f+1]=p+1,a[f+2]=p+2,f+=3,p+=3;continue}const R=Hu.vertsByJoint[N]+Hu.vertsByJoint[F];if(R===0)continue;m=d[k*2],v=d[k*2+1],y=d[k*2+2],b=d[k*2+3],_=d[k*2-2],E=d[k*2-1];const H=Math.sqrt((y-m)*(y-m)+(b-v)*(b-v));Hu.vertsByJoint[N]===0&&(C-=H),(N&-3)!==de.JOINT_CAP_BUTT?(w=d[k*2+4],x=d[k*2+5]):(w=m,x=v);for(let W=0;W<R;W++)s[h]=_,s[h+1]=E,s[h+2]=m,s[h+3]=v,s[h+4]=y,s[h+5]=b,s[h+6]=w,s[h+7]=x,s[h+8]=C,s[h+9]=16*L+W,s[h+10]=r,o[h+11]=i,h+=c;C+=H,a[f]=p,a[f+1]=p+1,a[f+2]=p+2,a[f+3]=p,a[f+4]=p+2,a[f+5]=p+3,f+=6;for(let W=5;W+1<R;W++)a[f]=p+4,a[f+1]=p+W,a[f+2]=p+W+1,f+=3;p+=R}if(T){for(let k=0;k<n.length;k++)a[f+k]=n[k]+p;f+=n.length}this.bufferPos=h,this.indexPos=f}};let p4=Hu;p4.vertsByJoint=[];const ln=p4.vertsByJoint;for(let t=0;t<256;t++)ln.push(0);ln[de.FILL]=1;for(let t=0;t<8;t++)ln[de.FILL_EXPAND+t]=3;ln[de.JOINT_BEVEL]=9;ln[de.JOINT_BEVEL+1]=9;ln[de.JOINT_BEVEL+2]=9;ln[de.JOINT_BEVEL+3]=9;ln[de.JOINT_ROUND]=9;ln[de.JOINT_ROUND+1]=9;ln[de.JOINT_ROUND+2]=9;ln[de.JOINT_ROUND+3]=9;ln[de.JOINT_MITER]=9;ln[de.JOINT_MITER+1]=9;ln[de.JOINT_MITER+2]=4;ln[de.JOINT_MITER+3]=4;ln[de.JOINT_CAP_BUTT]=4;ln[de.JOINT_CAP_BUTT+1]=4;ln[de.JOINT_CAP_SQUARE]=4;ln[de.JOINT_CAP_SQUARE+1]=4;ln[de.JOINT_CAP_ROUND]=9;ln[de.JOINT_CAP_ROUND+1]=9;ln[de.CAP_ROUND]=4;class Xy{constructor(e,n=null,r=null,i=null){this.shape=e,this.lineStyle=r,this.fillStyle=n,this.matrix=i,this.type=e.type,this.points=[],this.holes=[],this.triangles=[],this.closeStroke=!1,this.clearBuild()}clearPath(){this.points.length=0,this.closeStroke=!0}clearBuild(){this.triangles.length=0,this.fillStart=0,this.fillLen=0,this.strokeStart=0,this.strokeLen=0,this.fillAA=!1}clone(){return new Xy(this.shape,this.fillStyle,this.lineStyle,this.matrix)}capType(){let e;switch(this.lineStyle.cap){case _n.SQUARE:e=de.CAP_SQUARE;break;case _n.ROUND:e=de.CAP_ROUND;break;default:e=de.CAP_BUTT;break}return e}goodJointType(){let e;switch(this.lineStyle.join){case Vt.BEVEL:e=de.JOINT_BEVEL;break;case Vt.ROUND:e=de.JOINT_ROUND;break;default:e=de.JOINT_MITER+3;break}return e}jointType(){let e;switch(this.lineStyle.join){case Vt.BEVEL:e=de.JOINT_BEVEL;break;case Vt.ROUND:e=de.JOINT_ROUND;break;default:e=de.JOINT_MITER;break}return e}destroy(){this.shape=null,this.holes.length=0,this.holes=null,this.points.length=0,this.points=null,this.lineStyle=null,this.fillStyle=null,this.triangles=null}}class s3{path(e,n){const r=e.points;let i,s,o,a,l,c;if(e.type===ut.CIRC){const v=e.shape;i=v.x,s=v.y,l=c=v.radius,o=a=0}else if(e.type===ut.ELIP){const v=e.shape;i=v.x,s=v.y,l=v.width,c=v.height,o=a=0}else{const v=e.shape,y=v.width/2,b=v.height/2;i=v.x+y,s=v.y+b,l=c=Math.max(0,Math.min(v.radius,Math.min(y,b))),o=y-l,a=b-c}if(!(l>=0&&c>=0&&o>=0&&a>=0)){r.length=0;return}const u=Math.ceil(2.3*Math.sqrt(l+c)),d=u*8+(o?4:0)+(a?4:0);if(r.length=d,d===0)return;if(u===0){r.length=8,r[0]=r[6]=i+o,r[1]=r[3]=s+a,r[2]=r[4]=i-o,r[5]=r[7]=s-a;return}let h=0,f=u*4+(o?2:0)+2,p=f,m=d;{const v=o+l,y=a,b=i+v,_=i-v,E=s+y;if(r[h++]=b,r[h++]=E,r[--f]=E,r[--f]=_,a){const w=s-y;r[p++]=_,r[p++]=w,r[--m]=w,r[--m]=b}}for(let v=1;v<u;v++){const y=Math.PI/2*(v/u),b=o+Math.cos(y)*l,_=a+Math.sin(y)*c,E=i+b,w=i-b,x=s+_,T=s-_;r[h++]=E,r[h++]=x,r[--f]=x,r[--f]=w,r[p++]=w,r[p++]=T,r[--m]=T,r[--m]=E}{const v=o,y=a+c,b=i+v,_=i-v,E=s+y,w=s-y;r[h++]=b,r[h++]=E,r[--m]=w,r[--m]=b,o&&(r[h++]=_,r[h++]=E,r[--m]=w,r[--m]=_)}}fill(e,n){const{verts:r,joints:i}=n,{points:s,triangles:o}=e;if(s.length===0)return;let a,l;if(e.type!==ut.RREC){const x=e.shape;a=x.x,l=x.y}else{const x=e.shape;a=x.x+x.width/2,l=x.y+x.height/2}const c=e.matrix,u=c?c.a*a+c.c*l+c.tx:a,d=c?c.b*a+c.d*l+c.ty:l;let h=1;const f=0;if(!e.fillAA){r.push(u,d),i.push(de.FILL),r.push(s[0],s[1]),i.push(de.FILL);for(let x=2;x<s.length;x+=2)r.push(s[x],s[x+1]),i.push(de.FILL),o.push(h++,f,h);o.push(f+1,f,h);return}const p=s.length;let m=s[p-2],v=s[p-1],y=v-s[p-3],b=s[p-4]-m;const _=Math.sqrt(y*y+b*b);y/=_,b/=_;let E,w;for(let x=0;x<p;x+=2){const T=s[x],C=s[x+1];let k=C-v,L=m-T;const F=Math.sqrt(k*k+L*L);k/=F,L/=F;let N=y+k,R=b+L;const H=k*N+L*R;N/=H,R/=H,x>0?(r.push(N),r.push(R)):(E=N,w=R),r.push(u),r.push(d),r.push(m),r.push(v),r.push(T),r.push(C),r.push(0),r.push(0),r.push(N),r.push(R),i.push(de.FILL_EXPAND+2),i.push(de.NONE),i.push(de.NONE),i.push(de.NONE),i.push(de.NONE),i.push(de.NONE),m=T,v=C,y=k,b=L}r.push(E),r.push(w)}line(e,n){const{verts:r,joints:i}=n,{points:s}=e,o=s.length===8?e.goodJointType():de.JOINT_MITER+3,a=s.length;if(a!==0){r.push(s[a-2],s[a-1]),i.push(de.NONE);for(let l=0;l<a;l+=2)r.push(s[l],s[l+1]),i.push(o);r.push(s[0],s[1]),i.push(de.NONE),r.push(s[2],s[3]),i.push(de.NONE)}}}const ide=[];function c8(t,e=!1){const n=t.length;if(n<6)return;let r=0;for(let i=0,s=t[n-2],o=t[n-1];i<n;i+=2){const a=t[i],l=t[i+1];r+=(a-s)*(l+o),s=a,o=l}if(!e&&r>0||e&&r<=0){const i=n/2;for(let s=i+i%2;s<n;s+=2){const o=n-s-2,a=n-s-1,l=s,c=s+1;[t[o],t[l]]=[t[l],t[o]],[t[a],t[c]]=[t[c],t[a]]}}}class _B{path(e,n){const r=e.shape,i=e.points=r.points.slice(),s=n.closePointEps,o=s*s;if(i.length===0)return;const a=new Ke(i[0],i[1]),l=new Ke(i[i.length-2],i[i.length-1]),c=e.closeStroke=r.closeStroke;let u=i.length,d=2;for(let h=2;h<u;h+=2){const f=i[h-2],p=i[h-1],m=i[h],v=i[h+1];let y=!0;Math.abs(f-m)<s&&Math.abs(p-v)<s&&(y=!1),y&&(i[d]=i[h],i[d+1]=i[h+1],d+=2)}i.length=u=d,d=2;for(let h=2;h+2<u;h+=2){let f=i[h-2],p=i[h-1];const m=i[h],v=i[h+1];let y=i[h+2],b=i[h+3];f-=m,p-=v,y-=m,b-=v;let _=!0;Math.abs(y*p-b*f)<o&&f*y+p*b<-o&&(_=!1),_&&(i[d]=i[h],i[d+1]=i[h+1],d+=2)}i[d]=i[u-2],i[d+1]=i[u-1],d+=2,i.length=u=d,!(u<=2)&&c&&Math.abs(a.x-l.x)<s&&Math.abs(a.y-l.y)<s&&(i.pop(),i.pop())}line(e,n){const{closeStroke:r,points:i}=e,s=i.length;if(s<=2)return;const{verts:o,joints:a}=n,l=e.jointType(),c=e.capType();let u=0,d,h;r?(d=i[s-2],h=i[s-1],a.push(de.NONE)):(d=i[2],h=i[3],c===de.CAP_ROUND?(o.push(i[0],i[1]),a.push(de.NONE),a.push(de.CAP_ROUND),u=0):(u=c,a.push(de.NONE))),o.push(d,h);for(let f=0;f<s;f+=2){const p=i[f],m=i[f+1];let v=l;f+2>=s?r||(v=de.NONE):f+4>=s&&(r||(c===de.CAP_ROUND&&(v=de.JOINT_CAP_ROUND),c===de.CAP_BUTT&&(v=de.JOINT_CAP_BUTT),c===de.CAP_SQUARE&&(v=de.JOINT_CAP_SQUARE))),v+=u,u=0,o.push(p,m),a.push(v),d=p,h=m}r?(o.push(i[0],i[1]),a.push(de.NONE),o.push(i[2],i[3]),a.push(de.NONE)):(o.push(i[s-4],i[s-3]),a.push(de.NONE))}fill(e,n){let r=e.points;const i=e.holes,s=n.closePointEps,{verts:o,joints:a}=n;if(r.length<6)return;const l=[];let c=r.length;c8(r,!1);for(let f=0;f<i.length;f++){const p=i[f];c8(p.points,!0),l.push(r.length/2),r=r.concat(p.points)}const u=ide;u.length<r.length&&(u.length=r.length);let d=0;for(let f=0;f<=l.length;f++){let p=c/2;f>0&&(f<l.length?p=l[f]:p=r.length>>1),u[d*2]=p-1,u[(p-1)*2+1]=d;for(let m=d;m+1<p;m++)u[m*2+1]=m+1,u[m*2+2]=m;d=p}if(e.triangles=TR(r,l,2),!e.triangles)return;if(!e.fillAA){for(let f=0;f<r.length;f+=2)o.push(r[f],r[f+1]),a.push(de.FILL);return}const{triangles:h}=e;c=r.length;for(let f=0;f<h.length;f+=3){let p=0;for(let m=0;m<3;m++){const v=h[f+m],y=h[f+(m+1)%3];(u[v*2]===y||u[v*2+1]===y)&&(p|=1<<m)}a.push(de.FILL_EXPAND+p),a.push(de.NONE),a.push(de.NONE),a.push(de.NONE),a.push(de.NONE),a.push(de.NONE)}for(let f=0;f<c/2;f++){const p=u[f*2],m=u[f*2+1];let v=r[m*2+1]-r[f*2+1],y=-(r[m*2]-r[f*2]),b=r[f*2+1]-r[p*2+1],_=-(r[f*2]-r[p*2]);const E=Math.sqrt(v*v+y*y);v/=E,y/=E;const w=Math.sqrt(b*b+_*_);b/=w,_/=w;let x=v+b,T=y+_;const C=x*v+T*y;Math.abs(C)<s?(x=v,T=y):(x/=C,T/=C),u[f*2]=x,u[f*2+1]=T}for(let f=0;f<h.length;f+=3){const p=h[f],m=h[f+1],v=h[f+2],y=r[v*2+1]-r[m*2+1],b=-(r[v*2]-r[m*2]),_=r[m*2+1]-r[p*2+1],E=-(r[m*2]-r[p*2]);let w=1;y*E-_*b>0&&(w=2);for(let x=0;x<3;x++){const T=h[f+x*w%3];o.push(r[T*2],r[T*2+1])}for(let x=0;x<3;x++){const T=h[f+x*w%3];o.push(u[T*2],u[T*2+1])}}}}class sde{constructor(){this._polyBuilder=new _B}path(e,n){const r=e.shape,i=r.x,s=r.y,o=r.width,a=r.height,l=e.points;l.length=0,l.push(i,s,i+o,s,i+o,s+a,i,s+a)}line(e,n){const{verts:r,joints:i}=n,{points:s}=e,o=e.goodJointType(),a=s.length;r.push(s[a-2],s[a-1]),i.push(de.NONE);for(let l=0;l<a;l+=2)r.push(s[l],s[l+1]),i.push(o);r.push(s[0],s[1]),i.push(de.NONE),r.push(s[2],s[3]),i.push(de.NONE)}fill(e,n){const{verts:r,joints:i}=n,{points:s,triangles:o}=e;if(o.length=0,!e.fillAA){r.push(s[0],s[1],s[2],s[3],s[4],s[5],s[6],s[7]),i.push(de.FILL,de.FILL,de.FILL,de.FILL),o.push(0,1,2,0,2,3);return}this._polyBuilder.fill(e,n)}}class ode{constructor(){this._circleBuilder=new s3}path(e,n){this._circleBuilder.path(e,n)}line(e,n){this._circleBuilder.line(e,n)}fill(e,n){this._circleBuilder.fill(e,n)}}const mg={[ut.POLY]:new _B,[ut.CIRC]:new s3,[ut.ELIP]:new s3,[ut.RECT]:new sde,[ut.RREC]:new ode},u8=[],gg=[],Au=new Ke,ade=new gl;class EB extends ea{constructor(){super(),this.indicesUint16=null,this.initAttributes(!1),this.buildData=new rde,this.graphicsData=[],this.dirty=0,this.batchDirty=-1,this.cacheDirty=-1,this.clearDirty=0,this.drawCalls=[],this.batches=[],this.shapeBuildIndex=0,this.shapeBatchIndex=0,this._bounds=new gl,this.boundsDirty=-1,this.boundsPadding=0,this.batchable=!1,this.indicesUint16=null,this.packer=null,this.packSize=0,this.pack32index=null}get points(){return this.buildData.verts}get closePointEps(){return this.buildData.closePointEps}initAttributes(e){this._buffer=new hn(null,e,!1),this._bufferFloats=new Float32Array,this._bufferUint=new Uint32Array,this._indexBuffer=new hn(null,e,!0),this.addAttribute("aPrev",this._buffer,2,!1,Te.FLOAT).addAttribute("aPoint1",this._buffer,2,!1,Te.FLOAT).addAttribute("aPoint2",this._buffer,2,!1,Te.FLOAT).addAttribute("aNext",this._buffer,2,!1,Te.FLOAT).addAttribute("aTravel",this._buffer,1,!1,Te.FLOAT).addAttribute("aVertexJoint",this._buffer,1,!1,Te.FLOAT).addAttribute("aStyleId",this._buffer,1,!1,Te.FLOAT).addAttribute("aColor",this._buffer,4,!0,Te.UNSIGNED_BYTE).addIndex(this._indexBuffer),this.strideFloats=12}checkInstancing(e,n){this.packer||(this.packer=new p4,this.pack32index=n)}get bounds(){return this.boundsDirty!==this.dirty&&(this.boundsDirty=this.dirty,this.calculateBounds()),this._bounds}invalidate(){this.boundsDirty=-1,this.dirty++,this.batchDirty++,this.shapeBuildIndex=0,this.shapeBatchIndex=0,this.packSize=0,this.buildData.clear();for(let e=0;e<this.drawCalls.length;e++)this.drawCalls[e].clear(),gg.push(this.drawCalls[e]);this.drawCalls.length=0;for(let e=0;e<this.batches.length;e++){const n=this.batches[e];n.reset(),u8.push(n)}this.batches.length=0}clear(){return this.graphicsData.length>0&&(this.invalidate(),this.clearDirty++,this.graphicsData.length=0),this}drawShape(e,n=null,r=null,i=null){const s=new Xy(e,n,r,i);return this.graphicsData.push(s),this.dirty++,this}drawHole(e,n=null){if(!this.graphicsData.length)return null;const r=new Xy(e,null,null,n),i=this.graphicsData[this.graphicsData.length-1];return r.lineStyle=i.lineStyle,i.holes.push(r),this.dirty++,this}destroy(){super.destroy();for(let e=0;e<this.graphicsData.length;++e)this.graphicsData[e].destroy();this.buildData.destroy(),this.buildData=null,this.indexBuffer.destroy(),this.indexBuffer=null,this.graphicsData.length=0,this.graphicsData=null,this.drawCalls.length=0,this.drawCalls=null,this.batches.length=0,this.batches=null,this._bounds=null}containsPoint(e){const n=this.graphicsData;for(let r=0;r<n.length;++r){const i=n[r];if(i.fillStyle.visible&&i.shape&&(i.matrix?i.matrix.applyInverse(e,Au):Au.copyFrom(e),i.shape.contains(Au.x,Au.y))){let s=!1;if(i.holes){for(let o=0;o<i.holes.length;o++)if(i.holes[o].shape.contains(Au.x,Au.y)){s=!0;break}}if(!s)return!0}}return!1}updatePoints(){}updateBufferSize(){this._buffer.update(new Float32Array)}updateBuild(){const{graphicsData:e,buildData:n}=this,r=e.length;for(let i=this.shapeBuildIndex;i<r;i++){const s=e[i];s.strokeStart=0,s.strokeLen=0,s.fillStart=0,s.fillLen=0;const{fillStyle:o,lineStyle:a,holes:l}=s;if(!o.visible&&!a.visible)continue;const c=mg[s.type];if(s.clearPath(),c.path(s,n),s.matrix&&this.transformPoints(s.points,s.matrix),s.clearBuild(),!(s.points.length<=2)&&((o.visible||a.visible)&&this.processHoles(l),o.visible&&(s.fillAA=s.fillStyle.smooth&&s.fillStyle.texture===he.WHITE&&l.length===0&&!(s.closeStroke&&s.lineStyle.visible&&!s.lineStyle.shader&&s.lineStyle.alpha>=.99&&s.lineStyle.width*Math.min(s.lineStyle.alignment,1-s.lineStyle.alignment)>=.495),s.fillStart=n.joints.length,l.length?mg[ut.POLY].fill(s,n):c.fill(s,n),s.fillLen=n.joints.length-s.fillStart),a.visible)){s.strokeStart=n.joints.length,c.line(s,n);for(let u=0;u<l.length;u++){const d=l[u];mg[d.type].line(d,n)}s.strokeLen=n.joints.length-s.strokeStart}}this.shapeBuildIndex=r}updateBatches(e){if(!this.graphicsData.length){this.batchable=!0;return}if(this.updateBuild(),!this.validateBatching())return;const{buildData:n,graphicsData:r}=this,i=r.length;this.cacheDirty=this.dirty;let s=null,o=null;this.batches.length>0&&(s=this.batches[this.batches.length-1],o=s.style);for(let a=this.shapeBatchIndex;a<i;a++){const l=r[a],c=l.fillStyle,u=l.lineStyle;if(l.matrix&&this.transformPoints(l.points,l.matrix),!(!c.visible&&!u.visible))for(let d=0;d<2;d++){const h=d===0?c:u;if(!h.visible)continue;const f=h.texture.baseTexture,p=n.vertexSize,m=n.indexSize;f.wrapMode=Go.REPEAT,d===0?this.packer.updateBufferSize(l.fillStart,l.fillLen,l.triangles.length,n):this.packer.updateBufferSize(l.strokeStart,l.strokeLen,l.triangles.length,n),n.vertexSize!==p&&(s&&!this._compareStyles(o,h)&&(s.end(m,p),s=null),s||(s=u8.pop()||new nde,s.begin(h,m,p),this.batches.push(s),o=h),d===0?s.jointEnd=l.fillStart+l.fillLen:s.jointEnd=l.strokeStart+l.strokeLen)}}if(this.shapeBatchIndex=i,s&&s.end(n.indexSize,n.vertexSize),this.batches.length===0){this.batchable=!0;return}this.batchable=this.isBatchable(),this.batchable?this.packBatches():(this.buildDrawCalls(e),this.updatePack())}updatePack(){const{vertexSize:e,indexSize:n}=this.buildData;if(this.packSize===e)return;const{strideFloats:r,packer:i,buildData:s,batches:o}=this,a=this._buffer,l=this._indexBuffer,c=e*r;if(a.data.length!==c){const d=new ArrayBuffer(c*4);this._bufferFloats=new Float32Array(d),this._bufferUint=new Uint32Array(d),a.data=this._bufferFloats}l.data.length!==n&&(e>65535&&this.pack32index?l.data=new Uint32Array(n):l.data=new Uint16Array(n)),i.beginPack(s,this._bufferFloats,this._bufferUint,l.data);let u=0;for(let d=0;d<this.graphicsData.length;d++){const h=this.graphicsData[d];if(h.fillLen){for(;o[u].jointEnd<=h.fillStart;)u++;i.packInterleavedGeometry(h.fillStart,h.fillLen,h.triangles,o[u].styleId,o[u].rgba)}if(h.strokeLen){for(;o[u].jointEnd<=h.strokeStart;)u++;i.packInterleavedGeometry(h.strokeStart,h.strokeLen,h.triangles,o[u].styleId,o[u].rgba)}}a.update(),l.update(),this.packSize=e}_compareStyles(e,n){if(!e||!n||e.texture.baseTexture!==n.texture.baseTexture||e.color+e.alpha!==n.color+n.alpha||e.shader!==n.shader||e.width!==n.width||e.scaleMode!==n.scaleMode||e.alignment!==n.alignment)return!1;const r=e.matrix||Ze.IDENTITY,i=n.matrix||Ze.IDENTITY;return bB(r,i)}validateBatching(){if(this.dirty===this.cacheDirty||!this.graphicsData.length)return!1;for(let e=0,n=this.graphicsData.length;e<n;e++){const r=this.graphicsData[e],i=r.fillStyle,s=r.lineStyle;if(i&&!i.texture.baseTexture.valid||s&&!s.texture.baseTexture.valid)return!1}return!0}packBatches(){this.batchDirty++;const e=this.batches;for(let n=0,r=e.length;n<r;n++){const i=e[n];for(let s=0;s<i.size;s++){const o=i.start+s;this.indicesUint16[o]=this.indicesUint16[o]-i.attribStart}}}isBatchable(){return!1}buildDrawCalls(e){for(let i=0;i<this.drawCalls.length;i++)this.drawCalls[i].clear(),gg.push(this.drawCalls[i]);this.drawCalls.length=0;let n=gg.pop()||new l8;n.begin(e,null);let r=0;this.drawCalls.push(n);for(let i=0;i<this.batches.length;i++){const s=this.batches[i],o=s.style;if(s.attribSize===0)continue;let a=-1;const l=o.getTextureMatrix();n.check(o.shader)&&(a=n.add(o.texture,l,o.width,o.alignment||0,o.packLineScale())),a<0&&(n=gg.pop()||new l8,this.drawCalls.push(n),n.begin(e,o.shader),n.start=r,a=n.add(o.texture,l,o.width,o.alignment||0,o.packLineScale())),n.size+=s.size,r+=s.size;const{color:c,alpha:u}=o,d=pt.shared.setValue(c).toLittleEndianNumber();s.rgba=pt.shared.setValue(d).toPremultiplied(u),s.styleId=a}}processHoles(e){for(let n=0;n<e.length;n++){const r=e[n],i=mg[r.type];r.clearPath(),i.path(r,this.buildData),r.matrix&&this.transformPoints(r.points,r.matrix)}}calculateBounds(){const e=this._bounds,n=ade;let r=Ze.IDENTITY;this._bounds.clear(),n.clear();for(let i=0;i<this.graphicsData.length;i++){const s=this.graphicsData[i],o=s.shape,a=s.type,l=s.lineStyle,c=s.matrix||Ze.IDENTITY;let u=0;if(l&&l.visible&&(u=l.width,a!==ut.POLY||s.fillStyle.visible?u*=Math.max(0,l.alignment):u*=Math.max(l.alignment,1-l.alignment)),r!==c&&(n.isEmpty()||(e.addBoundsMatrix(n,r),n.clear()),r=c),a===ut.RECT||a===ut.RREC){const d=o;n.addFramePad(d.x,d.y,d.x+d.width,d.y+d.height,u,u)}else if(a===ut.CIRC){const d=o;n.addFramePad(d.x,d.y,d.x,d.y,d.radius+u,d.radius+u)}else if(a===ut.ELIP){const d=o;n.addFramePad(d.x,d.y,d.x,d.y,d.width+u,d.height+u)}else{const d=o;e.addVerticesMatrix(r,d.points,0,d.points.length,u,u)}}n.isEmpty()||e.addBoundsMatrix(n,r),e.pad(this.boundsPadding,this.boundsPadding)}transformPoints(e,n){for(let r=0;r<e.length/2;r++){const i=e[r*2],s=e[r*2+1];e[r*2]=n.a*i+n.c*s+n.tx,e[r*2+1]=n.b*i+n.d*s+n.ty}}}EB.BATCHABLE_SIZE=100;const d8=`#version 100
precision highp float;
const float FILL = 1.0;
const float BEVEL = 4.0;
const float MITER = 8.0;
const float ROUND = 12.0;
const float JOINT_CAP_BUTT = 16.0;
const float JOINT_CAP_SQUARE = 18.0;
const float JOINT_CAP_ROUND = 20.0;

const float FILL_EXPAND = 24.0;

const float CAP_BUTT = 1.0;
const float CAP_SQUARE = 2.0;
const float CAP_ROUND = 3.0;
const float CAP_BUTT2 = 4.0;

const float MITER_LIMIT = 10.0;

// === geom ===
attribute vec2 aPrev;
attribute vec2 aPoint1;
attribute vec2 aPoint2;
attribute vec2 aNext;
attribute float aVertexJoint;
attribute float aTravel;

uniform mat3 projectionMatrix;
uniform mat3 translationMatrix;
uniform vec4 tint;

varying vec4 vLine1;
varying vec4 vLine2;
varying vec4 vArc;
varying float vType;

uniform float resolution;
uniform float expand;

// === style ===
attribute float aStyleId;
attribute vec4 aColor;

varying float vTextureId;
varying vec4 vColor;
varying vec2 vTextureCoord;
varying vec2 vTravel;

uniform vec2 styleLine[%MAX_STYLES%];
uniform vec3 styleMatrix[2 * %MAX_STYLES%];
uniform float styleTextureId[%MAX_STYLES%];
uniform vec2 samplerSize[%MAX_TEXTURES%];

vec2 doBisect(vec2 norm, float len, vec2 norm2, float len2,
    float dy, float inner) {
    vec2 bisect = (norm + norm2) / 2.0;
    bisect /= dot(norm, bisect);
    vec2 shift = dy * bisect;
    if (inner > 0.5) {
        if (len < len2) {
            if (abs(dy * (bisect.x * norm.y - bisect.y * norm.x)) > len) {
                return dy * norm;
            }
        } else {
            if (abs(dy * (bisect.x * norm2.y - bisect.y * norm2.x)) > len2) {
                return dy * norm;
            }
        }
    }
    return dy * bisect;
}

void main(void){
    vec2 pointA = (translationMatrix * vec3(aPoint1, 1.0)).xy;
    vec2 pointB = (translationMatrix * vec3(aPoint2, 1.0)).xy;

    vec2 xBasis = pointB - pointA;
    float len = length(xBasis);
    vec2 forward = xBasis / len;
    vec2 norm = vec2(forward.y, -forward.x);

    float type = floor(aVertexJoint / 16.0);
    float vertexNum = aVertexJoint - type * 16.0;
    float dx = 0.0, dy = 1.0;

    float capType = floor(type / 32.0);
    type -= capType * 32.0;

    int styleId = int(aStyleId + 0.5);
    float lineWidth = styleLine[styleId].x;
    vTextureId = floor(styleTextureId[styleId] / 4.0);
    float scaleMode = styleTextureId[styleId] - vTextureId * 4.0;
    float avgScale = 1.0;
    if (scaleMode > 2.5) {
        avgScale = length(translationMatrix * vec3(1.0, 0.0, 0.0));
    } else if (scaleMode > 1.5) {
        avgScale = length(translationMatrix * vec3(0.0, 1.0, 0.0));
    } else if (scaleMode > 0.5) {
        vec2 avgDiag = (translationMatrix * vec3(1.0, 1.0, 0.0)).xy;
        avgScale = sqrt(dot(avgDiag, avgDiag) * 0.5);
    }
    lineWidth *= 0.5 * avgScale;
    float lineAlignment = 2.0 * styleLine[styleId].y - 1.0;
    vTextureCoord = vec2(0.0);

    vec2 pos;

    if (capType == CAP_ROUND) {
        vertexNum += 4.0;
        type = JOINT_CAP_ROUND;
        capType = 0.0;
        lineAlignment = -lineAlignment;
    }

    vLine1 = vec4(0.0, 10.0, 1.0, 0.0);
    vLine2 = vec4(0.0, 10.0, 1.0, 0.0);
    vArc = vec4(0.0);
    if (type == FILL) {
        pos = pointA;
        vType = 0.0;
        vLine2 = vec4(-2.0, -2.0, -2.0, 0.0);
        vec2 vTexturePixel;
        vTexturePixel.x = dot(vec3(aPoint1, 1.0), styleMatrix[styleId * 2]);
        vTexturePixel.y = dot(vec3(aPoint1, 1.0), styleMatrix[styleId * 2 + 1]);
        vTextureCoord = vTexturePixel / samplerSize[int(vTextureId)];
    } else if (type >= FILL_EXPAND && type < FILL_EXPAND + 7.5) {
        // expand vertices
        float flags = type - FILL_EXPAND;
        float flag3 = floor(flags / 4.0);
        float flag2 = floor((flags - flag3 * 4.0) / 2.0);
        float flag1 = flags - flag3 * 4.0 - flag2 * 2.0;

        vec2 prev = (translationMatrix * vec3(aPrev, 1.0)).xy;

        if (vertexNum < 0.5) {
            pos = prev;
        } else if (vertexNum < 1.5) {
            pos = pointA;
        } else {
            pos = pointB;
        }
        float len2 = length(aNext);
        vec2 bisect = (translationMatrix * vec3(aNext, 0.0)).xy;
        if (len2 > 0.01) {
            bisect = normalize(bisect) * len2;
        }

        vec2 n1 = normalize(vec2(pointA.y - prev.y, -(pointA.x - prev.x)));
        vec2 n2 = normalize(vec2(pointB.y - pointA.y, -(pointB.x - pointA.x)));
        vec2 n3 = normalize(vec2(prev.y - pointB.y, -(prev.x - pointB.x)));

        if (n1.x * n2.y - n1.y * n2.x < 0.0) {
            n1 = -n1;
            n2 = -n2;
            n3 = -n3;
        }
        pos += bisect * expand;

        vLine1 = vec4(16.0, 16.0, 16.0, -1.0);
        if (flag1 > 0.5) {
            vLine1.x = -dot(pos - prev, n1);
        }
        if (flag2 > 0.5) {
            vLine1.y = -dot(pos - pointA, n2);
        }
        if (flag3 > 0.5) {
            vLine1.z = -dot(pos - pointB, n3);
        }
        vLine1.xyz *= resolution;
        vType = 2.0;
    } else if (type >= BEVEL) {
        float dy = lineWidth + expand;
        float shift = lineWidth * lineAlignment;
        float inner = 0.0;
        if (vertexNum >= 1.5) {
            dy = -dy;
            inner = 1.0;
        }

        vec2 base, next, xBasis2, bisect;
        float flag = 0.0;
        float side2 = 1.0;
        if (vertexNum < 0.5 || vertexNum > 2.5 && vertexNum < 3.5) {
            next = (translationMatrix * vec3(aPrev, 1.0)).xy;
            base = pointA;
            flag = type - floor(type / 2.0) * 2.0;
            side2 = -1.0;
        } else {
            next = (translationMatrix * vec3(aNext, 1.0)).xy;
            base = pointB;
            if (type >= MITER && type < MITER + 3.5) {
                flag = step(MITER + 1.5, type);
                // check miter limit here?
            }
        }
        xBasis2 = next - base;
        float len2 = length(xBasis2);
        vec2 norm2 = vec2(xBasis2.y, -xBasis2.x) / len2;
        float D = norm.x * norm2.y - norm.y * norm2.x;
        if (D < 0.0) {
            inner = 1.0 - inner;
        }

        norm2 *= side2;

        float collinear = step(0.0, dot(norm, norm2));

        vType = 0.0;
        float dy2 = -1000.0;

        if (abs(D) < 0.01 && collinear < 0.5) {
            if (type >= ROUND && type < ROUND + 1.5) {
                type = JOINT_CAP_ROUND;
            }
            //TODO: BUTT here too
        }

        vLine1 = vec4(0.0, lineWidth, max(abs(norm.x), abs(norm.y)), min(abs(norm.x), abs(norm.y)));
        vLine2 = vec4(0.0, lineWidth, max(abs(norm2.x), abs(norm2.y)), min(abs(norm2.x), abs(norm2.y)));

        if (vertexNum < 3.5) {
            if (abs(D) < 0.01 && collinear < 0.5) {
                pos = (shift + dy) * norm;
            } else {
                if (flag < 0.5 && inner < 0.5) {
                    pos = (shift + dy) * norm;
                } else {
                    pos = doBisect(norm, len, norm2, len2, shift + dy, inner);
                }
            }
            vLine2.y = -1000.0;
            if (capType >= CAP_BUTT && capType < CAP_ROUND) {
                float extra = step(CAP_SQUARE, capType) * lineWidth;
                vec2 back = -forward;
                if (vertexNum < 0.5 || vertexNum > 2.5) {
                    pos += back * (expand + extra);
                    dy2 = expand;
                } else {
                    dy2 = dot(pos + base - pointA, back) - extra;
                }
            }
            if (type >= JOINT_CAP_BUTT && type < JOINT_CAP_SQUARE + 0.5) {
                float extra = step(JOINT_CAP_SQUARE, type) * lineWidth;
                if (vertexNum < 0.5 || vertexNum > 2.5) {
                    vLine2.y = dot(pos + base - pointB, forward) - extra;
                } else {
                    pos += forward * (expand + extra);
                    vLine2.y = expand;
                    if (capType >= CAP_BUTT) {
                        dy2 -= expand + extra;
                    }
                }
            }
        } else if (type >= JOINT_CAP_ROUND && type < JOINT_CAP_ROUND + 1.5) {
            base += shift * norm;
            if (inner > 0.5) {
                dy = -dy;
                inner = 0.0;
            }
            vec2 d2 = abs(dy) * forward;
            if (vertexNum < 4.5) {
                dy = -dy;
                pos = dy * norm;
            } else if (vertexNum < 5.5) {
                pos = dy * norm;
            } else if (vertexNum < 6.5) {
                pos = dy * norm + d2;
                vArc.x = abs(dy);
            } else {
                dy = -dy;
                pos = dy * norm + d2;
                vArc.x = abs(dy);
            }
            vLine2 = vec4(0.0, lineWidth * 2.0 + 10.0, 1.0  , 0.0); // forget about line2 with type=3
            vArc.y = dy;
            vArc.z = 0.0;
            vArc.w = lineWidth;
            vType = 3.0;
        } else if (abs(D) < 0.01 && collinear < 0.5) {
            pos = dy * norm;
        } else {
            if (inner > 0.5) {
                dy = -dy;
                inner = 0.0;
            }
            float side = sign(dy);
            vec2 norm3 = normalize(norm + norm2);

            if (type >= MITER && type < MITER + 3.5) {
                vec2 farVertex = doBisect(norm, len, norm2, len2, shift + dy, 0.0);
                if (length(farVertex) > abs(shift + dy) * MITER_LIMIT) {
                    type = BEVEL;
                }
            }

            if (vertexNum < 4.5) {
                pos = doBisect(norm, len, norm2, len2, shift - dy, 1.0);
            } else if (vertexNum < 5.5) {
                pos = (shift + dy) * norm;
            } else if (vertexNum > 7.5) {
                pos = (shift + dy) * norm2;
            } else {
                if (type >= ROUND && type < ROUND + 1.5) {
                    pos = doBisect(norm, len, norm2, len2, shift + dy, 0.0);
                    float d2 = abs(shift + dy);
                    if (length(pos) > abs(shift + dy) * 1.5) {
                        if (vertexNum < 6.5) {
                            pos.x = (shift + dy) * norm.x - d2 * norm.y;
                            pos.y = (shift + dy) * norm.y + d2 * norm.x;
                        } else {
                            pos.x = (shift + dy) * norm2.x + d2 * norm2.y;
                            pos.y = (shift + dy) * norm2.y - d2 * norm2.x;
                        }
                    }
                } else if (type >= MITER && type < MITER + 3.5) {
                    pos = doBisect(norm, len, norm2, len2, shift + dy, 0.0); //farVertex
                } else if (type >= BEVEL && type < BEVEL + 1.5) {
                    float d2 = side / resolution;
                    if (vertexNum < 6.5) {
                        pos = (shift + dy) * norm + d2 * norm3;
                    } else {
                        pos = (shift + dy) * norm2 + d2 * norm3;
                    }
                }
            }

            if (type >= ROUND && type < ROUND + 1.5) {
                vArc.x = side * dot(pos, norm3);
                vArc.y = pos.x * norm3.y - pos.y * norm3.x;
                vArc.z = dot(norm, norm3) * (lineWidth + side * shift);
                vArc.w = lineWidth + side * shift;
                vType = 3.0;
            } else if (type >= MITER && type < MITER + 3.5) {
                vType = 1.0;
            } else if (type >= BEVEL && type < BEVEL + 1.5) {
                vType = 4.0;
                vArc.z = dot(norm, norm3) * (lineWidth + side * shift) - side * dot(pos, norm3);
            }

            dy = side * (dot(pos, norm) - shift);
            dy2 = side * (dot(pos, norm2) - shift);
        }

        pos += base;
        vLine1.xy = vec2(dy, vLine1.y) * resolution;
        vLine2.xy = vec2(dy2, vLine2.y) * resolution;
        vArc = vArc * resolution;
        vTravel = vec2(aTravel * avgScale + dot(pos - pointA, vec2(-norm.y, norm.x)), avgScale);
    }

    gl_Position = vec4((projectionMatrix * vec3(pos, 1.0)).xy, 0.0, 1.0);

    vColor = aColor * tint;
}`,lde=`#version 100
#ifdef GL_FRAGMENT_PRECISION_HIGH
  precision highp float;
#else
  precision mediump float;
#endif
`,h8=`%PRECISION%
varying vec4 vColor;
varying vec4 vLine1;
varying vec4 vLine2;
varying vec4 vArc;
varying float vType;
varying float vTextureId;
varying vec2 vTextureCoord;
varying vec2 vTravel;
uniform sampler2D uSamplers[%MAX_TEXTURES%];

%PIXEL_LINE%

void main(void){
    %PIXEL_COVERAGE%

    vec4 texColor;
    float textureId = floor(vTextureId+0.5);
    %FOR_LOOP%

    gl_FragColor = vColor * texColor * alpha;
}
`,cde=[`
float pixelLine(float x, float A, float B) {
    return clamp(x + 0.5, 0.0, 1.0);
}
`,`
float pixelLine(float x, float A, float B) {
    float y = abs(x), s = sign(x);
    if (y * 2.0 < A - B) {
        return 0.5 + s * y / A;
    }
    y -= (A - B) * 0.5;
    y = max(1.0 - y / B, 0.0);
    return (1.0 + s * (1.0 - y * y)) * 0.5;
    //return clamp(x + 0.5, 0.0, 1.0);
}
`],ude=`float alpha = 1.0;
if (vType < 0.5) {
    float left = pixelLine(-vLine1.y - vLine1.x, vLine1.z, vLine1.w);
    float right = pixelLine(vLine1.y - vLine1.x, vLine1.z, vLine1.w);
    float near = vLine2.x - 0.5;
    float far = min(vLine2.x + 0.5, 0.0);
    float top = vLine2.y - 0.5;
    float bottom = min(vLine2.y + 0.5, 0.0);
    alpha = (right - left) * max(bottom - top, 0.0) * max(far - near, 0.0);
} else if (vType < 1.5) {
    float a1 = pixelLine(- vLine1.y - vLine1.x, vLine1.z, vLine1.w);
    float a2 = pixelLine(vLine1.y - vLine1.x, vLine1.z, vLine1.w);
    float b1 = pixelLine(- vLine2.y - vLine2.x, vLine2.z, vLine2.w);
    float b2 = pixelLine(vLine2.y - vLine2.x, vLine2.z, vLine2.w);
    alpha = a2 * b2 - a1 * b1;
} else if (vType < 2.5) {
    alpha *= max(min(vLine1.x + 0.5, 1.0), 0.0);
    alpha *= max(min(vLine1.y + 0.5, 1.0), 0.0);
    alpha *= max(min(vLine1.z + 0.5, 1.0), 0.0);
} else if (vType < 3.5) {
    float a1 = pixelLine(- vLine1.y - vLine1.x, vLine1.z, vLine1.w);
    float a2 = pixelLine(vLine1.y - vLine1.x, vLine1.z, vLine1.w);
    float b1 = pixelLine(- vLine2.y - vLine2.x, vLine2.z, vLine2.w);
    float b2 = pixelLine(vLine2.y - vLine2.x, vLine2.z, vLine2.w);
    float alpha_miter = a2 * b2 - a1 * b1;
    float alpha_plane = clamp(vArc.z - vArc.x + 0.5, 0.0, 1.0);
    float d = length(vArc.xy);
    float circle_hor = max(min(vArc.w, d + 0.5) - max(-vArc.w, d - 0.5), 0.0);
    float circle_vert = min(vArc.w * 2.0, 1.0);
    float alpha_circle = circle_hor * circle_vert;
    alpha = min(alpha_miter, max(alpha_circle, alpha_plane));
} else {
    float a1 = pixelLine(- vLine1.y - vLine1.x, vLine1.z, vLine1.w);
    float a2 = pixelLine(vLine1.y - vLine1.x, vLine1.z, vLine1.w);
    float b1 = pixelLine(- vLine2.y - vLine2.x, vLine2.z, vLine2.w);
    float b2 = pixelLine(vLine2.y - vLine2.x, vLine2.z, vLine2.w);
    alpha = a2 * b2 - a1 * b1;
    alpha *= clamp(vArc.z + 0.5, 0.0, 1.0);
}
`;class pm extends ms{constructor(e,n=d8,r=h8,i={}){n=pm.generateVertexSrc(e,n),r=pm.generateFragmentSrc(e,r);const{maxStyles:s,maxTextures:o}=e,a=new Int32Array(o);for(let l=0;l<o;l++)a[l]=l;super(no.from(n,r),Object.assign(i,{styleMatrix:new Float32Array(6*s),styleTextureId:new Float32Array(s),styleLine:new Float32Array(2*s),samplerSize:new Float32Array(2*o),uSamplers:a,tint:new Float32Array([1,1,1,1]),resolution:1,expand:1})),this.settings=e}static generateVertexSrc(e,n=d8){const{maxStyles:r,maxTextures:i}=e;return n=n.replace(/%MAX_TEXTURES%/gi,`${i}`).replace(/%MAX_STYLES%/gi,`${r}`),n}static generateFragmentSrc(e,n=h8){const{maxTextures:r,pixelLine:i}=e;return n=n.replace(/%PRECISION%/gi,lde).replace(/%PIXEL_LINE%/gi,cde[i]).replace(/%PIXEL_COVERAGE%/gi,ude).replace(/%MAX_TEXTURES%/gi,`${r}`).replace(/%FOR_LOOP%/gi,this.generateSampleSrc(r)),n}static generateSampleSrc(e){let n="";n+=`
`,n+=`
`;for(let r=0;r<e;r++)r>0&&(n+=`
else `),r<e-1&&(n+=`if(textureId < ${r}.5)`),n+=`
{`,n+=`
	texColor = texture2D(uSamplers[${r}], vTextureCoord);`,n+=`
}`;return n+=`
`,n+=`
`,n}}const ef={LINE_SCALE_MODE:wc.NORMAL,SHADER_MAX_STYLES:24,SHADER_MAX_TEXTURES:4,PIXEL_LINE:0},dde=uu,{BezierUtils:hde,QuadraticUtils:fde,ArcUtils:f8}=nO,z_={},g0=class extends Xn{constructor(t=null){super(),this._geometry=t||new EB,this._geometry.refCount++,this.shader=null,this.shaderSettings={maxStyles:ef.SHADER_MAX_STYLES,maxTextures:ef.SHADER_MAX_TEXTURES,pixelLine:ef.PIXEL_LINE},this.state=Ts.for2d(),this._fillStyle=new T2,this._lineStyle=new f4,this._matrix=null,this._holeMode=!1,this.currentPath=null,this.batches=[],this.batchTint=-1,this.batchDirty=-1,this.vertexData=null,this.pluginName="smooth",this._transformID=-1,this._tintColor=new pt(16777215),this.blendMode=Ne.NORMAL}get geometry(){return this._geometry}clone(){return this.finishPoly(),new g0(this._geometry)}set blendMode(t){this.state.blendMode=t}get blendMode(){return this.state.blendMode}get tint(){return this._tintColor.value}set tint(t){this._tintColor.setValue(t)}get fill(){return this._fillStyle}get line(){return this._lineStyle}lineStyle(t=null,e=0,n=1,r=.5,i=ef.LINE_SCALE_MODE){if(typeof t=="number")typeof i=="boolean"&&(i=i?wc.NONE:wc.NORMAL),t={width:t,color:e,alpha:n,alignment:r,scaleMode:i};else{const s=t.native;s!==void 0&&(t.scaleMode=s?wc.NONE:wc.NORMAL)}return this.lineTextureStyle(t)}lineTextureStyle(t){t=Object.assign({width:0,texture:he.WHITE,color:t&&t.texture?16777215:0,alpha:1,matrix:null,alignment:.5,native:!1,cap:_n.BUTT,join:Vt.MITER,miterLimit:10,shader:null,scaleMode:ef.LINE_SCALE_MODE},t),this.normalizeColor(t),this.currentPath&&this.startPoly();const e=t.width>0&&t.alpha>0;return e?(t.matrix&&(t.matrix=t.matrix.clone(),t.matrix.invert()),Object.assign(this._lineStyle,{visible:e},t)):this._lineStyle.reset(),this}startPoly(){if(this.currentPath){const t=this.currentPath.points,e=this.currentPath.points.length;e>2&&(this.drawShape(this.currentPath),this.currentPath=new oo,this.currentPath.closeStroke=!1,this.currentPath.points.push(t[e-2],t[e-1]))}else this.currentPath=new oo,this.currentPath.closeStroke=!1}finishPoly(){this.currentPath&&(this.currentPath.points.length>2?(this.drawShape(this.currentPath),this.currentPath=null):this.currentPath.points.length=0)}moveTo(t,e){return this.startPoly(),this.currentPath.points[0]=t,this.currentPath.points[1]=e,this}lineTo(t,e){this.currentPath||this.moveTo(0,0);const n=this.currentPath.points,r=n[n.length-2],i=n[n.length-1];return(r!==t||i!==e)&&n.push(t,e),this}_initCurve(t=0,e=0){this.currentPath?this.currentPath.points.length===0&&(this.currentPath.points=[t,e]):this.moveTo(t,e)}quadraticCurveTo(t,e,n,r){this._initCurve();const i=this.currentPath.points;return i.length===0&&this.moveTo(0,0),fde.curveTo(t,e,n,r,i),this}bezierCurveTo(t,e,n,r,i,s){return this._initCurve(),hde.curveTo(t,e,n,r,i,s,this.currentPath.points),this}arcTo(t,e,n,r,i){this._initCurve(t,e);const s=this.currentPath.points,o=f8.curveTo(t,e,n,r,i,s);if(o){const{cx:a,cy:l,radius:c,startAngle:u,endAngle:d,anticlockwise:h}=o;this.arc(a,l,c,u,d,h)}return this}arc(t,e,n,r,i,s=!1){if(r===i)return this;if(!s&&i<=r?i+=Xd:s&&r<=i&&(r+=Xd),i-r===0)return this;const a=t+Math.cos(r)*n,l=e+Math.sin(r)*n,c=this._geometry.closePointEps;let u=this.currentPath?this.currentPath.points:null;if(u){const d=Math.abs(u[u.length-2]-a),h=Math.abs(u[u.length-1]-l);d<c&&h<c||u.push(a,l)}else this.moveTo(a,l),u=this.currentPath.points;return f8.arc(a,l,t,e,n,r,i,s,u),this}beginFill(t=0,e=1,n=!1){return this.beginTextureFill({texture:he.WHITE,color:t,alpha:e,smooth:n})}normalizeColor(t){const e=pt.shared.setValue(t.color??0);t.color=e.toNumber(),t.alpha??(t.alpha=e.alpha)}beginTextureFill(t){t=Object.assign({texture:he.WHITE,color:16777215,alpha:1,matrix:null,smooth:!1},t),this.normalizeColor(t),this.currentPath&&this.startPoly();const e=t.alpha>0;return e?(t.matrix&&(t.matrix=t.matrix.clone(),t.matrix.invert()),Object.assign(this._fillStyle,{visible:e},t)):this._fillStyle.reset(),this}endFill(){return this.finishPoly(),this._fillStyle.reset(),this}drawRect(t,e,n,r){return this.drawShape(new Me(t,e,n,r))}drawRoundedRect(t,e,n,r,i){return this.drawShape(new Nm(t,e,n,r,i))}drawCircle(t,e,n){return this.drawShape(new Om(t,e,n))}drawEllipse(t,e,n,r){return this.drawShape(new Dm(t,e,n,r))}drawPolygon(...t){let e,n=!0;const r=t[0];r.points?(n=r.closeStroke,e=r.points):Array.isArray(t[0])?e=t[0]:e=t;const i=new oo(e);return i.closeStroke=n,this.drawShape(i),this}drawShape(t){return this._holeMode?this._geometry.drawHole(t,this._matrix):this._geometry.drawShape(t,this._fillStyle.clone(),this._lineStyle.clone(),this._matrix),this}clear(){return this._geometry.clear(),this._lineStyle.reset(),this._fillStyle.reset(),this._boundsID++,this._matrix=null,this._holeMode=!1,this.currentPath=null,this}isFastRect(){const t=this._geometry.graphicsData;return t.length===1&&t[0].shape.type===ut.RECT&&!t[0].matrix&&!t[0].holes.length&&!(t[0].lineStyle.visible&&t[0].lineStyle.width)}_renderCanvas(t){dde.prototype._renderCanvas.call(this,t)}_render(t){this.finishPoly();const e=this._geometry,n=t.context.supports.uint32Indices;e.checkInstancing(t.geometry.hasInstance,n),e.updateBatches(this.shaderSettings),e.batchable?(this.batchDirty!==e.batchDirty&&this._populateBatches(),this._renderBatched(t)):(t.batch.flush(),this._renderDirect(t))}_populateBatches(){const t=this._geometry,e=this.blendMode,n=t.batches.length;this.batchTint=-1,this._transformID=-1,this.batchDirty=t.batchDirty,this.batches.length=n,this.vertexData=new Float32Array(t.points);for(let r=0;r<n;r++){const i=t.batches[r],s=i.style.color,a={vertexData:new Float32Array(this.vertexData.buffer,i.attribStart*4*2,i.attribSize*2),blendMode:e,_batchRGB:sY(s),_tintRGB:s,_texture:i.style.texture,alpha:i.style.alpha,worldAlpha:1};this.batches[r]=a}}_renderBatched(t){if(this.batches.length){t.batch.setObjectRenderer(t.plugins[this.pluginName]),this.calculateVertices(),this.calculateTints();for(let e=0,n=this.batches.length;e<n;e++){const r=this.batches[e];r.worldAlpha=this.worldAlpha*r.alpha,t.plugins[this.pluginName].render(r)}}}_renderDirect(t){const e=this._resolveDirectShader(t);let n=e;const r=this._geometry,i=this.worldAlpha,s=n.uniforms,o=r.drawCalls;s.translationMatrix=this.transform.worldTransform,pt.shared.setValue(this._tintColor).premultiply(i).toArray(s.tint),s.resolution=t.renderTexture.current?t.renderTexture.current.resolution:t.resolution;const a=t.projection.transform;if(a){const c=Math.sqrt(a.a*a.a+a.b*a.b);s.resolution*=c}const l=t.renderTexture.current?t.renderTexture.current.multisample:t.multisample;s.expand=(l!==dn.NONE?2:1)/s.resolution,t.shader.bind(n),t.geometry.bind(r,n),t.state.set(this.state),n=null;for(let c=0,u=o.length;c<u;c++){const d=r.drawCalls[c],h=n!==d.shader;h&&(n=d.shader,n&&(n.uniforms.translationMatrix=this.transform.worldTransform,n.uniforms.tint&&(n.uniforms.tint[0]=s.tint[0],n.uniforms.tint[1]=s.tint[1],n.uniforms.tint[2]=s.tint[2],n.uniforms.tint[3]=s.tint[3])));const{texArray:f,styleArray:p,size:m,start:v}=d,y=f.count,b=n||e,_=b.uniforms.styleTextureId,E=b.uniforms.styleMatrix,w=b.uniforms.styleLine;for(let T=0;T<p.count;T++){_[T]=p.textureIds[T],w[T*2]=p.lines[T*2],w[T*2+1]=p.lines[T*2+1];const C=p.matrices[T];E[T*6]=C.a,E[T*6+1]=C.c,E[T*6+2]=C.tx,E[T*6+3]=C.b,E[T*6+4]=C.d,E[T*6+5]=C.ty}const x=b.uniforms.samplerSize;for(let T=0;T<y;T++)x[T*2]=f.elements[T].width,x[T*2+1]=f.elements[T].height;t.shader.bind(b),h&&t.geometry.bind(r);for(let T=0;T<y;T++)t.texture.bind(f.elements[T],T);t.geometry.draw(ls.TRIANGLES,m,v)}}_resolveDirectShader(t){let e=this.shader;const n=this.pluginName;return e||(z_[n]||(z_[n]=new pm(this.shaderSettings)),e=z_[n]),e}_calculateBounds(){this.finishPoly();const t=this._geometry;if(!t.graphicsData.length)return;const{minX:e,minY:n,maxX:r,maxY:i}=t.bounds;this._bounds.addFrame(this.transform,e,n,r,i)}containsPoint(t){return this.worldTransform.applyInverse(t,g0._TEMP_POINT),this._geometry.containsPoint(g0._TEMP_POINT)}calculateTints(){if(this.batchTint!==this.tint){this.batchTint=this._tintColor.toNumber();for(let t=0;t<this.batches.length;t++){const e=this.batches[t];e._tintRGB=pt.shared.setValue(this._tintColor).multiply(e._batchRGB).toLittleEndianNumber()}}}calculateVertices(){const t=this.transform._worldID;if(this._transformID===t)return;this._transformID=t;const e=this.transform.worldTransform,n=e.a,r=e.b,i=e.c,s=e.d,o=e.tx,a=e.ty,l=this._geometry.points,c=this.vertexData;let u=0;for(let d=0;d<l.length;d+=2){const h=l[d],f=l[d+1];c[u++]=n*h+i*f+o,c[u++]=s*f+r*h+a}}closePath(){const t=this.currentPath;return t&&(t.closeStroke=!0),this}setMatrix(t){return this._matrix=t,this}beginHole(){return this.finishPoly(),this._holeMode=!0,this}endHole(){return this.finishPoly(),this._holeMode=!1,this}destroy(t){this._geometry.refCount--,this._geometry.refCount===0&&this._geometry.dispose(),this._matrix=null,this.currentPath=null,this._lineStyle.destroy(),this._lineStyle=null,this._fillStyle.destroy(),this._fillStyle=null,this._geometry=null,this.shader=null,this.vertexData=null,this.batches.length=0,this.batches=null,super.destroy(t)}};let mm=g0;mm.curves=yl;mm._TEMP_POINT=new Ke;const pde=`%PRECISION%
varying vec4 vColor;
varying vec4 vLine1;
varying vec4 vLine2;
varying vec4 vArc;
varying float vType;
varying float vTextureId;
varying vec2 vTextureCoord;
varying vec2 vTravel;
uniform sampler2D uSamplers[%MAX_TEXTURES%];
uniform float dash;
uniform float gap;

%PIXEL_LINE%

void main(void){
    %PIXEL_COVERAGE%

    float d = dash * vTravel.y;
    if (d > 0.0) {
        float g = gap * vTravel.y;
        if (g > 0.0) {
            float t = mod(vTravel.x, d + g);
            alpha *= mix(
                min(0.5 * d + 0.5 - abs(t - 0.5 * d), 1.0),
                max(abs(t - 0.5 * g - d) - 0.5 * g + 0.5, 0.0),
                step(d, t)
            );
        }
    } else {
        alpha = 0.0;
    }

    vec4 texColor;
    float textureId = floor(vTextureId+0.5);
    %FOR_LOOP%

    gl_FragColor = vColor * texColor * alpha;
}
`;class o3 extends pm{constructor(e){const n={maxStyles:16,maxTextures:1,pixelLine:1};super(n,void 0,pde,e||{dash:8,gap:5})}}const un=new WeakMap,cp=new WeakMap,gm=new WeakMap,Yy=new WeakMap,mde=()=>new c9(void 0,`
  varying vec2 vMaskCoord;
  varying vec2 vTextureCoord;
  
  uniform sampler2D uSampler;
  uniform sampler2D mask;
  uniform float alpha;
  uniform float npmAlpha;
  uniform vec4 maskClamp;
  
  void main(void)
  {
    float clip = step(3.5,
    step(maskClamp.x, vMaskCoord.x) +
    step(maskClamp.y, vMaskCoord.y) +
    step(vMaskCoord.x, maskClamp.z) +
    step(vMaskCoord.y, maskClamp.w));
  
    vec4 original = texture2D(uSampler, vTextureCoord);
    vec4 masky = texture2D(mask, vMaskCoord);
    float alphaMul = 1.0 - npmAlpha * (1.0 - masky.a);
  
    original *= 1.0 - (alphaMul * masky.r * alpha * clip);
  
    gl_FragColor = original;
  }
  `),wr=10,gde=t=>{const e=un.get(t);e&&!e.destroyed&&e.destroy(!0),un.delete(t);const n=gm.get(t);n&&!n.destroyed&&n.destroy(!0),gm.delete(t);const r=Yy.get(t);r&&!r.destroyed&&r.destroy(!0),Yy.delete(t);const i=cp.get(t);i&&!i.destroyed&&i.destroy(!0),cp.delete(t)},yde=(t,e)=>{switch(t){case"dashed":return new o3({dash:8*e,gap:8+e});case"dotted":return new o3({dash:1.5*e,gap:6+e})}},up=document.createElementNS("http://www.w3.org/2000/svg","svg"),wB=document.createElementNS("http://www.w3.org/2000/svg","path");up.appendChild(wB);const vde=(t,e,n,r)=>{up.setAttributeNS("http://www.w3.org/2000/svg","stroke",t),up.setAttributeNS("http://www.w3.org/2000/svg","fill",t),up.setAttributeNS("http://www.w3.org/2000/svg","viewport",`0 0 ${n} ${r}`),wB.setAttributeNS(null,"d",e)},bde=(t,e,n,r)=>{let i=un.get(t);if(!i)i=new uu,un.set(t,i),r==null||r.addChild(i);else{i.clear();const u=i.removeChildren();for(const d of u)d.destroy()}i.beginFill("#E7E7E7",n).drawRect(-e.halfWidth,-e.halfHeight,e.width,e.height).endFill();const s=Math.min(e.width,e.height),o=Math.min(s,Math.min(s*.4,100)),a=t.status==="error"?GS:zS,l=he.from(a.src),c=new On(l);c.width=o,c.height=o,c.anchor.set(.5),i.addChild(c),i.position.set(e.x+e.halfWidth,e.y+e.halfHeight),i.rotation=t.angle,i.alpha=n,i.mask=null},_de=t=>{switch(t){case mr.Virgil:return"Virgil";case mr.Helvetica:return"Helvetica";case mr.Cascadia:return"Cascadia";case mr.Assistant:return"Assistant"}},p8=(t,e,n,r)=>{const i=e.opacity/100,s=e.backgroundColor==="transparent"&&e.type!=="arrow";for(const o of t)if(o.type==="fillPath"&&!s){n.beginFill(e.type==="arrow"?e.strokeColor:e.backgroundColor,i);for(const{op:a,data:l}of o.ops)a==="move"?n.moveTo(l[0]-r.x,l[1]-r.y):a==="lineTo"?n.lineTo(l[0]-r.x,l[1]-r.y):a==="bcurveTo"&&n.bezierCurveTo(l[0]-r.x,l[1]-r.y,l[2]-r.x,l[3]-r.y,l[4]-r.x,l[5]-r.y);n.closePath(),n.endFill()}else if(o.type==="fillSketch"&&!s){n.lineStyle({width:e.strokeWidth,color:e.backgroundColor,alpha:i});for(const{op:a,data:l}of o.ops)a==="move"?n.moveTo(l[0]-r.x,l[1]-r.y):a==="lineTo"?n.lineTo(l[0]-r.x,l[1]-r.y):a==="bcurveTo"&&n.bezierCurveTo(l[0]-r.x,l[1]-r.y,l[2]-r.x,l[3]-r.y,l[4]-r.x,l[5]-r.y)}else if(o.type==="path"){n.lineStyle({color:e.strokeColor,width:e.strokeWidth,alpha:i,cap:_n.ROUND,join:Vt.ROUND,shader:yde(e.strokeStyle,e.strokeWidth),scaleMode:wc.NORMAL});for(const{op:a,data:l}of o.ops)a==="move"?n.moveTo(l[0]-r.x,l[1]-r.y):a==="lineTo"?n.lineTo(l[0]-r.x,l[1]-r.y):a==="bcurveTo"&&n.bezierCurveTo(l[0]-r.x,l[1]-r.y,l[2]-r.x,l[3]-r.y,l[4]-r.x,l[5]-r.y)}},G_=(t,e,n,r,i={x:0,y:0},s)=>{const o=new mm,a=mt.get(t);if(Array.isArray(a))for(const u of a)p8(u.sets,t,o,i);else p8(a.sets,t,o,i);const l=(s??un).get(t);l&&!l.destroyed&&l.destroy(!0);const c=e.generateTexture(o,{width:t.width,height:t.height,region:n,resolution:r});return o.destroy(),new On(c)},Ede=(t,e,n,r,i)=>{let s=gm.get(t);s||(s=new On(he.WHITE),gm.set(t,s),i==null||i.addChild(s)),s.width=n.width,s.height=n.height,s.position.set(n.x,n.y);const o=un.get(e);if(r.shouldCacheIgnoreZoom)s.visible=!1,o.filters=[];else{s.visible=!0;const a=mde();a.maskSprite=s,o.filters=[a]}},wde=(t,e,n,r)=>{const i=new uu,s=n.width-2*n.stokeWidth,o=n.height-2*n.stokeWidth;i.beginFill("#ffffff").drawRoundedRect(n.stokeWidth,n.stokeWidth,s,o,Pt.radius/(r.resolution??.1)).endFill();const a=e.generateTexture(i,{width:s,height:o,resolution:r.resolution});i.destroy();const l=new On(a);l.anchor.set(.5,.5),gm.set(t,l),r.addChild(l),r.mask=l},tf=(t,e,n,r,i)=>!t||t.frameId!==i||t.resolution!==r||ag(n.width)!==ag(t.width)||ag(n.height)!==ag(t.height)||e.idx!==t.zIndex,a3=(t,e)=>{const n=li({sceneX:t.x,sceneY:t.y},e);return n.x=n.x/e.zoom.value,n.y=n.y/e.zoom.value,n},m8=(t,e)=>{const n=Xoe(t),r=a3({x:n[0],y:n[1]},e),i=n[2]-n[0],s=n[3]-n[1];return[r.x,r.y,i,s,i/2,s/2,i+2*wr,s+2*wr]},nf=(t,e,n,r,i,s,o)=>{var v;const[a,l,c,u,d,h,f,p]=m8(t,r),m=t.opacity/100;switch(t.type){case"frame":case"magicframe":if(r.frameRendering.enabled&&r.frameRendering.outline){let y=un.get(t),b=Yy.get(t);if(tf(y,t,{width:f,height:p},i,s)||!b){const _=Pt.strokeWidth/i,E="rgba(0, 0, 200, 0.04)";let w=Pt.strokeColor;sd(t)&&(w=r.theme==="light"?"#7affd7":"#1d8264"),y==null||y.destroy(),b==null||b.destroy();const x=new uu;x.lineStyle({color:w,width:_,cap:_n.ROUND,join:Vt.ROUND,alpha:m}).beginFill(E).drawRoundedRect(wr,wr,c,u,Pt.radius/i).endFill();const T=e.renderer.generateTexture(x,{width:t.width,height:t.height,region:new Me(0,0,f,p),resolution:i});x.destroy(),y=new On(T),y.anchor.set(.5,.5),y.zIndex=t.idx??0,y.resolution=i,y.frameId=null,b=new On(T),b.anchor.set(.5,.5),b.zIndex=t.idx??0,un.set(t,y),o==null||o.addChild(y),Yy.set(t,b),o==null||o.addChild(b),wde(t,e.renderer,{x:a,y:l,width:c,height:u,halfHeight:h,halfWidth:d,stokeWidth:_},y)}y.position.set(a+d,l+h),y.width=f,y.height=p,b.position.set(a+d,l+h),b.width=f,b.height=p}break;case"rectangle":case"embeddable":case"diamond":case"ellipse":{let y=un.get(t);tf(y,t,{width:f,height:p},i,s)&&(mt.generateElementShape(t,n),y=G_(t,e.renderer,new Me(0,0,f,p),i,{x:-wr,y:-wr}),y.anchor.set(.5,.5),y.zIndex=t.idx??0,y.resolution=i,y.frameId=s,un.set(t,y),o==null||o.addChild(y)),y.position.set(a+d,l+h),y.width=f,y.height=p,y.rotation=t.angle,y.mask=null}break;case"line":case"arrow":{let y=un.get(t);const b=y==null?void 0:y.pathHash,_=t.points.reduce((w,[x,T])=>w+x+T,0);if(tf(y,t,{width:f,height:p},i,s)||_!==b){mt.generateElementShape(t,n);const w=a3(t,r),x=a-w.x,T=l-w.y;y=G_(t,e.renderer,new Me(0,0,f,p),i,{x:x-wr,y:T-wr}),y.anchor.set(.5,.5),y.zIndex=t.idx??0,y.resolution=i,y.frameId=s,y.pathHash=_,un.set(t,y),o==null||o.addChild(y)}y.position.set(a+d,l+h),y.width=f,y.height=p,y.rotation=t.angle,y.mask=null,y.filters=[];const E=tt(t);if(E){const[w,x,T,C]=m8(E,r);Ede(E,t,{x:w-wr/2,y:x-wr/2,width:T+wr,height:C+wr},r,o)}}break;case"freedraw":{let y=un.get(t),b=cp.get(t);const _=y==null?void 0:y.pathHash,E=t.points.reduce((w,[x,T])=>w+x+T,0);if(!y||y.resolution!==i||t.idx!==y.zIndex||_!==E){mt.generateElementShape(t,n);const w=a3(t,r),x=a-w.x,T=l-w.y;sa(t.points)&&(tf(b,t,{width:f,height:p},i,s)||_!==E)&&(b=G_(t,e.renderer,new Me(0,0,f,p),i,{x:x-wr,y:T-wr},cp),b.anchor.set(.5,.5),b.zIndex=t.idx??0,b.resolution=i,b.frameId=s,cp.set(t,b),o==null||o.addChild(b));const C=AN.get(t);vde(t.strokeColor,C,c,u),y==null||y.destroy(),y=new dd(up),y.pivot.set(d+x,h+T),y.zIndex=t.idx??0,y.resolution=i,y.frameId=s,y.pathHash=E,un.set(t,y),o==null||o.addChild(y)}b&&(b.position.set(a+d,l+h),b.width=f,b.height=p,b.rotation=t.angle),y.position.set(a+d,l+h),y.rotation=t.angle,y.alpha=m,y.mask=null}break;case"text":{let y=un.get(t);tf(y,t,{width:c,height:u},i,s)&&(y==null||y.destroy(),y=new rS(t.text,{fontFamily:_de(t.fontFamily),fontSize:t.fontSize,fill:t.strokeColor,align:t.textAlign,padding:wr*4,textBaseline:"bottom"}),y.zIndex=t.idx??0,y.resolution=i,y.frameId=s,un.set(t,y),o==null||o.addChild(y)),y.position.set(a+d,l+h),y.anchor.set(.5,.45),y.rotation=t.angle,y.height=u,y.width=c,y.alpha=m,y.mask=null}break;case"image":{const y=En(t)?(v=n.imageCache.get(t.fileId))==null?void 0:v.image:void 0;if(y!=null&&!(y instanceof Promise)){let b=un.get(t);if(!b||b.frameId!==s||b.zIndex!==t.idx){const _=he.from(y.src);b==null||b.destroy(),b=new On(_),b.anchor.set(.5),b.zIndex=t.idx??0,b.frameId=s,un.set(t,b),o==null||o.addChild(b)}b.position.set(a+d,l+h),b.rotation=t.angle,b.height=u,b.width=c,b.alpha=m,b.mask=null}else bde(t,{x:a,y:l,width:c,height:u,halfWidth:d,halfHeight:h},m,o)}break;default:throw new Error(`Unimplemented type ${t.type}`)}},ae=(t,e,n=!0)=>{var o;let r=!1;const{points:i,fileId:s}=e;typeof i<"u"&&(e={...PN(i),...e});for(const a in e){const l=e[a];if(typeof l<"u"){if(t[a]===l&&(typeof l!="object"||l===null||a==="groupIds"||a==="scale"))continue;if(a==="scale"){const c=t[a],u=l;if(c[0]===u[0]&&c[1]===u[1])continue}else if(a==="points"){const c=t[a],u=l;if(c.length===u.length){let d=!1,h=c.length;for(;--h;){const f=c[h],p=u[h];if(f[0]!==p[0]||f[1]!==p[1]){d=!0;break}}if(!d)continue}}t[a]=l,r=!0}}return r&&((typeof e.height<"u"||typeof e.width<"u"||typeof s<"u"||typeof i<"u")&&mt.delete(t),t.version++,t.versionNonce=Rl(),t.updated=lh(),n&&((o=bt.getScene(t))==null||o.informMutation())),t},Re=(t,e)=>{let n=!1;for(const r in e){const i=e[r];if(typeof i<"u"){if(t[r]===i&&(typeof i!="object"||i===null))continue;n=!0}}return n?(gde(t),{...t,...e,updated:lh(),version:t.version+1,versionNonce:Rl()}):t},wh=(t,e)=>(t.version=(e??t.version)+1,t.versionNonce=Rl(),t.updated=lh(),t),su=t=>Je(t)||Zr(t)?t.points.length<2:t.width===0&&t.height===0,Zy=(t,e,n,r)=>{const[i,s,o,a]=qc(t),l=Ft({clientX:r.offsetLeft,clientY:r.offsetTop},r),c=Ft({clientX:r.offsetLeft+e,clientY:r.offsetTop+n},r);return l.x<=o&&l.y<=a&&c.x>=i&&c.y>=s},g8=(t,e,n)=>{const r=Math.abs(e),i=Math.abs(n);if(t==="line"||t==="arrow"||t==="freedraw"){const s=Math.round(Math.atan(i/r)/fl)*fl;s===0?n=0:s===Math.PI/2?e=0:n=r*Math.tan(s)*Math.sign(n)||n}else t!=="selection"&&(n=r*Math.sign(n));return{width:e,height:n}},l3=(t,e,n,r)=>{let i=n-t,s=r-e;const o=Math.round(Math.atan(s/i)/fl)*fl;if(o===0)s=0;else if(o===Math.PI/2)i=0;else{const a=Math.tan(o),l=-1,c=e-a*t,u=-1/a,d=-1,h=r-u*n,f=(l*h-d*c)/(a*d-u*l),p=(c*u-h*a)/(a*d-u*l);i=f-t,s=p-e}return{width:i,height:s}},xB=t=>{const e={width:t.width,height:t.height,x:t.x,y:t.y};if(t.width<0){const n=Math.abs(t.width);e.width=n,e.x=t.x-n}if(t.height<0){const n=Math.abs(t.height);e.height=n,e.y=t.y-n}return e},c3=(t,e,n)=>e>=t[0]&&e<=t[0]+t[2]&&n>=t[1]&&n<=t[1]+t[3],xde=(t,e,n,r,i,s)=>{if(!e.selectedElementIds[t.id])return!1;const{rotation:o,...a}=yD(t,i,s);if(o&&c3(o,n,r))return"rotation";const l=Object.keys(a).filter(c=>{const u=a[c];return u?c3(u,n,r):!1});return l.length>0?l[0]:!1},y8=(t,e,n,r,i,s)=>t.reduce((o,a)=>{if(o)return o;const l=xde(a,e,n,r,i,s);return l?{element:a,transformHandleType:l}:null},null),v8=([t,e,n,r],i,s,o,a)=>{const l=xS([t,e,n,r,(t+n)/2,(e+r)/2],0,o,a,gD);return Object.keys(l).find(u=>{const d=l[u];return d&&c3(d,i,s)})||!1},V_=["ns","nesw","ew","nwse"],Tde=(t,e)=>{const n=V_.indexOf(t);if(n>=0){const r=Math.round(e/(Math.PI/4));t=V_[(n+r)%V_.length]}return t},b8=t=>{const{element:e,transformHandleType:n}=t,r=e&&Math.sign(e.height)*Math.sign(e.width)===-1;let i=null;switch(n){case"n":case"s":i="ns";break;case"w":case"e":i="ew";break;case"nw":case"se":r?i="nesw":i="nwse";break;case"ne":case"sw":r?i="nwse":i="nesw";break;case"rotation":return"grab"}return i&&e&&(i=Tde(i,e.angle)),i?`${i}-resize`:""},Ky=t=>t<0?t+2*Math.PI:t>=2*Math.PI?t-2*Math.PI:t,Sde=(t,e,n,r,i,s,o,a,l,c,u,d)=>{if(n.length===1){const[h]=n;return e==="rotation"?(Cde(h,a,l,i,t.originalElements),wl(h)):Se(h)&&(e==="nw"||e==="ne"||e==="sw"||e==="se")?(kde(h,e,s,a,l),wl(h)):e&&Mde(t.originalElements,o,h,e,s,a,l),!0}else if(n.length>1){if(e==="rotation")return Pde(t,n,a,l,i,c,u),!0;if(e==="nw"||e==="ne"||e==="sw"||e==="se")return TB(t,n,e,s,a,l),!0}return!1},Cde=(t,e,n,r,i)=>{var f;const[s,o,a,l]=Ve(t),c=(s+a)/2,u=(o+l)/2;let d;qe(t)?d=0:(d=5*Math.PI/2+Math.atan2(n-u,e-c),r&&(d+=fl/2,d-=d%fl),d=Ky(d));const h=Yc(t);if(ae(t,{angle:d}),h){const p=(f=bt.getScene(t))==null?void 0:f.getElement(h);p&&!Ct(t)&&ae(p,{angle:d})}},Ide=(t,e,n,r)=>Je(t)||Zr(t)?{points:Kd(0,e,Kd(1,n,t.points,r),r)}:{},m4=(t,e,n)=>{let r=t.width;if(nn(t)){const a=Dn(t);a&&(r=mo(a))}const s=t.fontSize*(e/r);if(s<AT)return null;const o=ia(t.text,mn({fontSize:s,fontFamily:t.fontFamily}),t.lineHeight);return{size:s,baseline:o.baseline+(n-o.height)}},Ade=(t,e)=>({n:/^(n|ne|nw)$/.test(t)||e&&/^(s|se|sw)$/.test(t),s:/^(s|se|sw)$/.test(t)||e&&/^(n|ne|nw)$/.test(t),w:/^(w|nw|sw)$/.test(t)||e&&/^(e|ne|se)$/.test(t),e:/^(e|ne|se)$/.test(t)||e&&/^(w|nw|sw)$/.test(t)}),kde=(t,e,n,r,i)=>{const[s,o,a,l]=Ve(t),c=(s+a)/2,u=(o+l)/2,[d,h]=et(r,i,c,u,-t.angle);let f;switch(e){case"se":f=Math.max((d-s)/(a-s),(h-o)/(l-o));break;case"nw":f=Math.max((a-d)/(a-s),(l-h)/(l-o));break;case"ne":f=Math.max((d-s)/(a-s),(l-h)/(l-o));break;case"sw":f=Math.max((a-d)/(a-s),(h-o)/(l-o));break}if(f>0){const p=t.width*f,m=t.height*f,v=m4(t,p,m);if(v===null)return;const[y,b,_,E]=ep(t,p,m,!1),w=(s-y)/2,x=(o-b)/2,T=(a-_)/2,C=(l-E)/2,[k,L]=LN(Ade(e,n),t.x,t.y,t.angle,w,x,T,C);ae(t,{fontSize:v.size,width:p,height:m,baseline:v.baseline,x:k,y:L})}},Mde=(t,e,n,r,i,s,o)=>{const a=t.get(n.id),[l,c,u,d]=ep(a,a.width,a.height,!0),h=[l,c],f=[u,d],p=Vx(h,f),m=Wt([s,o],p,-a.angle),[v,y,b,_]=ep(n,n.width,n.height,!0),E=b-v,w=_-y,x=f[0]-h[0],T=f[1]-h[1];let C=x/E,k=T/w,L={};const F=tt(n);r.includes("e")&&(C=(m[0]-h[0])/E),r.includes("s")&&(k=(m[1]-h[1])/w),r.includes("w")&&(C=(f[0]-m[0])/E),r.includes("n")&&(k=(f[1]-m[1])/w);const N=a.width,R=a.height;let H=n.width*C,W=n.height*k;if(i&&(H=2*H-N,W=2*W-R),e){const We=Math.abs(H)/N,ir=Math.abs(W)/R;if(r.length===1&&(W*=We,H*=ir),r.length===2){const Cn=Math.max(We,ir);H=N*Cn*Math.sign(H),W=R*Cn*Math.sign(W)}}if(F){const We=t.get(F.id);if(We&&(L={fontSize:We.fontSize,baseline:We.baseline}),e){const ir={...n,width:H,height:W},Cn=m4(F,mo(ir),yh(ir,F));if(Cn===null)return;L={fontSize:Cn.size,baseline:Cn.baseline}}else{const ir=wN(mn(F),F.lineHeight),Cn=bN(F.fontSize,F.lineHeight);H=Math.max(H,ir),W=Math.max(W,Cn)}}const[q,Z,j,K]=ep(a,H,W,!0),$=j-q,B=K-Z;let G=[...h];if(["n","w","nw"].includes(r)&&(G=[f[0]-Math.abs($),f[1]-Math.abs(B)]),r==="ne"){const We=[h[0],f[1]];G=[We[0],We[1]-Math.abs(B)]}if(r==="sw"){const We=[f[0],h[1]];G=[We[0]-Math.abs($),We[1]]}e&&(["s","n"].includes(r)&&(G[0]=p[0]-$/2),["e","w"].includes(r)&&(G[1]=p[1]-B/2));const Y=H<0,X=W<0;Y&&(r.includes("e")&&(G[0]-=Math.abs($)),r.includes("w")&&(G[0]+=Math.abs($))),X&&(r.includes("s")&&(G[1]-=Math.abs(B)),r.includes("n")&&(G[1]+=Math.abs(B))),i&&(G[0]=p[0]-Math.abs($)/2,G[1]=p[1]-Math.abs(B)/2);const J=a.angle,ne=Wt(G,p,J),se=[G[0]+Math.abs($)/2,G[1]+Math.abs(B)/2],Ue=Wt(se,p,J);G=Wt(ne,Ue,-J);const De=[...G],Le=a.x-q,fe=a.y-Z;De[0]+=Le,De[1]+=fe;const ke=De[0],Xe=De[1];let _t,Sn;(Je(n)||Zr(n))&&(_t=Kd(1,W,a.points,!0),Sn=Kd(0,H,_t,!0));const Ot={width:Math.abs(H),height:Math.abs(W),x:ke,y:Xe,points:Sn};if("scale"in n&&"scale"in a&&ae(n,{scale:[(Math.sign(j-a.x)||a.scale[0])*a.scale[0],(Math.sign(K-a.y)||a.scale[1])*a.scale[1]]}),Ct(n)&&F&&e){const We=Ot.width/n.width*F.fontSize;if(We<AT)return;L.fontSize=We}Ot.width!==0&&Ot.height!==0&&Number.isFinite(Ot.x)&&Number.isFinite(Ot.y)&&(ae(n,Ot),wl(n,{newSize:{width:Ot.width,height:Ot.height}}),F&&L!=null&&ae(F,{fontSize:L.fontSize,baseline:L.baseline}),l2(n,r,e))},TB=(t,e,n,r,i,s)=>{var L;const o=e.reduce((F,N)=>{const R=t.originalElements.get(N.id);return R&&F.push({orig:R,latest:N}),F},[]),a=o.reduce((F,{orig:N})=>{if(!Je(N))return F;const R=Yc(N);if(!R)return F;const H=t.originalElements.get(R)??null;if(!nn(H))return F;const W=Ae.getBoundTextElementPosition(N,H);return[...F,{...H,...W}]},[]),{minX:l,minY:c,maxX:u,maxY:d,midX:h,midY:f}=Yo(o.map(({orig:F})=>F).concat(a)),p=n,m={ne:[l,d],se:[l,c],sw:[u,c],nw:[u,d]},[v,y]=r?[h,f]:m[p],b=Math.max(Math.abs(i-v)/(u-l)||0,Math.abs(s-y)/(d-c)||0)*(r?2:1);if(b===0)return;const _={ne:[i>=v,s<=y],se:[i>=v,s>=y],sw:[i<=v,s>=y],nw:[i<=v,s<=y]},[E,w]=_[p].map(F=>F?1:-1),x=E<0,T=w<0,C=[];for(const{orig:F,latest:N}of o){if(Se(F)&&nn(F))continue;const R=F.width*b,H=F.height*b,W=Ky(F.angle*E*w),q=Je(F)||Zr(F),Z=F.x-v,j=F.y-y,K=x&&!q?R:0,$=T&&!q?H:0,B=v+E*(Z*b+K),G=y+w*(j*b+$),Y=Ide(F,R*E,H*w,!1),X={x:B,y:G,width:R,height:H,angle:W,...Y};if(Wo(F)&&o.length===1&&(X.scale=[F.scale[0]*E,F.scale[1]*w]),Je(F)&&(x||T)){const ne=Ry(F,F.points),se=Ry({...F,x:B,y:G},Y.points),Ue=[F.x,F.y],De=[B,G],Le=fe=>{const ke=fe==="x"?0:1;return(se[ke+2]-De[ke]-(Ue[ke]-ne[ke])*b+(ne[ke+2]-Ue[ke])*b-(De[ke]-se[ke]))/2};x&&(X.x-=Le("x")),T&&(X.y-=Le("y"))}if(Se(F)){const ne=m4(F,R,H);if(!ne)return;X.fontSize=ne.size,X.baseline=ne.baseline}const J=t.originalElements.get(Yc(F)??"");if(J){const ne=J.fontSize*b;if(ne<AT)return;X.boundTextFontSize=ne}C.push({element:N,update:X})}const k=C.map(({element:F})=>F);for(const{element:F,update:{boundTextFontSize:N,...R}}of C){const{width:H,height:W,angle:q}=R;ae(F,R,!1),wl(F,{simultaneouslyUpdated:k,newSize:{width:H,height:W}});const Z=tt(F);Z&&N&&(ae(Z,{fontSize:N,angle:Je(F)?void 0:q},!1),l2(F,n,!0))}(L=bt.getScene(C[0].element))==null||L.informMutation()},Pde=(t,e,n,r,i,s,o)=>{var l;let a=5*Math.PI/2+Math.atan2(r-o,n-s);i&&(a+=fl/2,a-=a%fl),e.filter(c=>!qe(c)).forEach(c=>{var E;const[u,d,h,f]=Ve(c),p=(u+h)/2,m=(d+f)/2,v=((E=t.originalElements.get(c.id))==null?void 0:E.angle)??c.angle,[y,b]=et(p,m,s,o,a+v-c.angle);ae(c,{x:c.x+(y-p),y:c.y+(b-m),angle:Ky(a+v)},!1),wl(c,{simultaneouslyUpdated:e});const _=tt(c);_&&!Ct(c)&&ae(_,{x:_.x+(y-p),y:_.y+(b-m),angle:Ky(a+v)},!1)}),(l=bt.getScene(e[0]))==null||l.informMutation()},Lde=(t,e,n,r)=>{const[i,s,o,a]=e.length===1?Ve(e[0]):Ut(e),l=(i+o)/2,c=(s+a)/2,u=e.length===1?e[0].angle:0;switch([n,r]=et(n,r,l,c,-u),t){case"n":return et(n-(i+o)/2,r-s,0,0,u);case"s":return et(n-(i+o)/2,r-a,0,0,u);case"w":return et(n-i,r-(s+a)/2,0,0,u);case"e":return et(n-o,r-(s+a)/2,0,0,u);case"nw":return et(n-i,r-s,0,0,u);case"ne":return et(n-o,r-s,0,0,u);case"sw":return et(n-i,r-a,0,0,u);case"se":return et(n-o,r-a,0,0,u);default:return[0,0]}},Rde=(t,e)=>{const[,[n,r]]=e.points;return t==="nw"&&(n<0||r<0)||t==="ne"&&n>=0||t==="sw"&&n<=0||t==="se"&&(n>0||r>0)?"end":"origin"},Ode=(t,e,n,r,i,s,o)=>{const a=new Set(e),l=e.filter(d=>qe(d)).map(d=>d.id);l.length>0&&i.getNonDeletedElements().filter(h=>!nn(h)).filter(h=>h.frameId!==null).filter(h=>l.includes(h.frameId)).forEach(h=>a.add(h));const c=Ut(Array.from(a).map(d=>t.originalElements.get(d.id)??d)),u=Dde(c,n,s,o);a.forEach(d=>{if(_8(t,d,u),!Ct(d)&&(!d.groupIds.length||r.editingGroupId&&!dS(r,d))){const h=tt(d);h&&_8(t,h,u)}wl(d,{simultaneouslyUpdated:Array.from(a)})})},Dde=(t,e,n,r)=>{const[i,s]=t;let o=i+e.x+n.x,a=s+e.y+n.y;if(n.x===0||n.y===0){const[l,c]=Kn(i+e.x,s+e.y,r);n.x===0&&(o=l),n.y===0&&(a=c)}return{x:o-i,y:a-s}},_8=(t,e,n)=>{const r=t.originalElements.get(e.id)??e,i=r.x+n.x,s=r.y+n.y;ae(e,{x:i,y:s})},Nde=(t,e,n)=>{const[r,i]=Ut(t);return[e-r,n-i]},E8=(t,e,n,r,i,s,o,a,l,c,u,d=null)=>{l&&t.type!=="selection"&&(u?a=o/u:(Math.abs(s-r)>Math.abs(i-n)?{width:o,height:a}=g8(e,a,i<n?-o:o):{width:o,height:a}=g8(e,o,s<r?-a:a),a<0&&(a=-a)));let h=i<n?n-o:n,f=s<r?r-a:r;c&&(o+=o,a+=a,h=n-o/2,f=r-a/2),o!==0&&a!==0&&ae(t,{x:h+((d==null?void 0:d.x)??0),y:f+((d==null?void 0:d.y)??0),width:o,height:a})},g4=(t,e)=>!!(!t.viewModeEnabled&&(t.activeTool.type!=="custom"&&(t.editingElement||t.activeTool.type!=="selection"&&t.activeTool.type!=="eraser"&&t.activeTool.type!=="hand"&&t.activeTool.type!=="laser")||Rt(e,t).length)),Oa=t=>t.reduce((e,n)=>e+n.version,0),Fde=t=>t.filter(e=>!e.isDeleted&&!su(e)),yt=t=>t.filter(e=>!e.isDeleted),u3=t=>!t.isDeleted,y4=t=>yt(t).map(e=>aS(e.type)?{...e,lastCommittedPoint:null}:e),Bde=t=>y4(t),SB=t=>y4(t),CB=t=>y4(t),Ys=4,Ya=6,Ude="rgba(0,0,0,0.3)",$de=(t,e,n,r)=>{if(t.length===0)return{horizontal:null,vertical:null};const[i,s,o,a]=Ut(t),l=e/r.zoom.value,c=n/r.zoom.value,u=e-l,d=n-c,h={top:parseInt(S1("sat"))||0,bottom:parseInt(S1("sab"))||0,left:parseInt(S1("sal"))||0,right:parseInt(S1("sar"))||0},f=km().rtl,p=-r.scrollX+u/2+h.left,m=-r.scrollY+d/2+h.top,v=p+l-h.right,y=m+c-h.bottom,b=Math.min(i,p),_=Math.min(s,m),E=Math.max(o,v),w=Math.max(a,y);return{horizontal:p===b&&v===E?null:{x:Math.max(h.left,Ys)+(p-b)/(E-b)*e,y:n-Ya-Math.max(Ys,h.bottom),width:(v-p)/(E-b)*e-Math.max(Ys*2,h.left+h.right),height:Ya},vertical:m===_&&y===w?null:{x:f?Math.max(h.left,Ys):e-Ya-Math.max(h.right,Ys),y:(m-_)/(w-_)*n+Math.max(h.top,Ys),width:Ya,height:(y-m)/(w-_)*n-Math.max(Ys*2,h.top+h.bottom)}}},w8=(t,e,n)=>{const[r,i]=[t.horizontal,t.vertical].map(o=>o!=null&&o.x<=e&&e<=o.x+o.width&&o.y<=n&&n<=o.y+o.height);return{isOverEither:r||i,isOverHorizontal:r,isOverVertical:i}},Hde=(t,e)=>{const n=new Set(Rt(t.filter(r=>qe(r)),e).map(r=>r.id));return{elements:t.map(r=>e.selectedElementIds[r.id]?Re(r,{isDeleted:!0}):r.frameId&&n.has(r.frameId)?Re(r,{isDeleted:!0}):nn(r)&&e.selectedElementIds[r.containerId]?Re(r,{isDeleted:!0}):r),appState:{...e,selectedElementIds:{},selectedGroupIds:{}}}},x8=(t,e)=>{if(t.editingGroupId){const n=Gn(yt(e),t.editingGroupId);if(n.length)return{...t,selectedElementIds:{[n[0].id]:!0}}}return t},IB=ue({name:"deleteSelectedElements",trackEvent:{category:"element",action:"delete"},perform:(t,e)=>{if(e.editingLinearElement){const{elementId:i,selectedPointsIndices:s,startBindingElement:o,endBindingElement:a}=e.editingLinearElement,l=Ae.getElement(i);if(!l||s==null)return!1;if(l.points.length<2){const u=t.map(h=>h.id===l.id?Re(h,{isDeleted:!0}):h),d=x8(e,u);return{elements:u,appState:{...d,editingLinearElement:null},commitToHistory:!1}}const c={startBindingElement:s!=null&&s.includes(0)?null:o,endBindingElement:s!=null&&s.includes(l.points.length-1)?null:a};return Ae.deletePoints(l,s),{elements:t,appState:{...e,editingLinearElement:{...e.editingLinearElement,...c,selectedPointsIndices:(s==null?void 0:s[0])>0?[s[0]-1]:[0]}},commitToHistory:!0}}let{elements:n,appState:r}=Hde(t,e);return kS(n,t.filter(({id:i})=>e.selectedElementIds[i])),r=x8(r,n),{elements:n,appState:{...r,activeTool:kn(e,{type:"selection"}),multiElement:null,activeEmbeddable:null},commitToHistory:wn(yt(t),e)}},contextItemLabel:"labels.delete",keyTest:(t,e,n)=>(t.key===z.BACKSPACE||t.key===z.DELETE)&&!t[z.CTRL_OR_CMD],PanelComponent:({elements:t,appState:e,updateData:n})=>g(st,{type:"button",icon:Gv,title:I("labels.delete"),"aria-label":I("labels.delete"),onClick:()=>n(null),visible:wn(yt(t),e)})}),d3=(t,e)=>t.frameId===e||t.id===e,AB=(t,e,n)=>{let r=[],i=[],s=null,o=-1;const a=xn(n||Rt(t,e,{includeBoundTextElement:!0,includeElementsInFrames:!0}));for(;++o<t.length;){const l=t[o];a.get(l.id)?(i.length&&(r=r.concat(i),i=[]),r.push(o),s=o+1):l.isDeleted&&s===o?(s=o+1,i.push(o)):i=[]}return r},zde=t=>{let e=0;return t.reduce((n,r,i)=>(i>0&&t[i-1]!==r-1&&(e=++e),(n[e]||(n[e]=[])).push(r),n),[])},T8=(t,e,n)=>{var r,i;if("containerId"in t&&t.containerId)if(n==="left"){const s=bt.getScene(t).getElement(t.containerId);if(s)return e.indexOf(s)}else return e.indexOf(t);else{const s=(i=(r=t.boundElements)==null?void 0:r.find(o=>o.type!=="arrow"))==null?void 0:i.id;if(s){if(n==="left")return e.indexOf(t);const o=bt.getScene(t).getElement(s);if(o)return e.indexOf(o)}}},Gde=(t,e)=>{let n=-1,r=-1;return t.forEach((i,s)=>{d3(i,e)&&(n===-1&&(n=s),r=s)}),n===-1?[]:t.slice(n,r+1)},Vde=(t,e,n,r,i)=>{const s=e[n],o=d=>d.isDeleted?!1:i?d.frameId===i:t.editingGroupId?d.groupIds.includes(t.editingGroupId):!0,a=r==="left"?lR(e,d=>o(d),Math.max(0,n-1)):aR(e,d=>o(d),n+1),l=e[a];if(!l)return-1;if(t.editingGroupId){if((s==null?void 0:s.groupIds.join(""))===(l==null?void 0:l.groupIds.join("")))return T8(l,e,r)??a;if(!(l!=null&&l.groupIds.includes(t.editingGroupId)))return-1}if(!i&&(l.frameId||qe(l))){const d=Gde(e,l.frameId||l.id);return r==="left"?e.indexOf(d[0]):e.indexOf(d[d.length-1])}if(!l.groupIds.length)return T8(l,e,r)??a;const c=t.editingGroupId?l.groupIds[l.groupIds.indexOf(t.editingGroupId)-1]:l.groupIds[l.groupIds.length-1],u=Gn(e,c);return u.length?r==="left"?e.indexOf(u[0]):e.indexOf(u[u.length-1]):a},kB=(t,e)=>e.reduce((n,r)=>{const i=t[r];return n[i.id]=i,n},{}),MB=(t,e,n)=>{const r=AB(t,e),i=kB(t,r);let s=zde(r);n==="right"&&(s=s.reverse());const o=new Set(r.filter(a=>qe(t[a])).map(a=>t[a].id));return s.forEach((a,l)=>{var b;const c=a[0],u=a[a.length-1],d=n==="left"?c:u,h=a.some(_=>{const E=t[_];return E.frameId&&o.has(E.frameId)})?null:(b=t[d])==null?void 0:b.frameId,f=Vde(e,t,d,n,h);if(f===-1||d===f)return;const p=n==="left"?t.slice(0,f):t.slice(0,c),m=t.slice(c,u+1),v=n==="left"?t.slice(f,c):t.slice(u+1,f+1),y=n==="left"?t.slice(u+1):t.slice(f+1);t=n==="left"?[...p,...m,...v,...y]:[...p,...v,...m,...y]}),t.map(a=>i[a.id]?wh(a):a)},PB=(t,e,n,r,i)=>{const s=AB(t,e,i),o=kB(t,s),a=[];let l,c;if(n==="left"){if(r)l=aR(t,f=>d3(f,r));else if(e.editingGroupId){const f=Gn(t,e.editingGroupId);if(!f.length)return t;l=t.indexOf(f[0])}else l=0;c=s[s.length-1]}else{if(r)c=lR(t,f=>d3(f,r));else if(e.editingGroupId){const f=Gn(t,e.editingGroupId);if(!f.length)return t;c=t.indexOf(f[f.length-1])}else c=t.length-1;l=s[0]}l===-1&&(l=0);for(let f=l;f<c+1;f++)s.includes(f)||a.push(t[f]);const u=Object.values(o).map(f=>wh(f)),d=t.slice(0,l),h=t.slice(c+1);return n==="left"?[...d,...u,...a,...h]:[...d,...a,...u,...h]};function LB(t,e,n,r){const i=xn(Rt(t,e,{includeBoundTextElement:!0,includeElementsInFrames:!0})),s={regularElements:[],frameChildren:new Map},o=new Set;for(const c of t)i.has(c.id)&&qe(c)&&o.add(c.id);for(const c of t)if(i.has(c.id))if(qe(c)||c.frameId&&o.has(c.frameId))s.regularElements.push(c);else if(!c.frameId)s.regularElements.push(c);else{const u=s.frameChildren.get(c.frameId)||[];u.push(c),s.frameChildren.set(c.frameId,u)}let a=t;const l=Array.from(s.frameChildren.entries());for(const[c,u]of l)a=r(t,e,n,c,u);return r(a,e,n,null,s.regularElements)}const Wde=(t,e)=>MB(t,e,"left"),jde=(t,e)=>MB(t,e,"right"),Xde=(t,e)=>LB(t,e,"left",PB),Yde=(t,e)=>LB(t,e,"right",PB),Zde=ue({name:"sendBackward",trackEvent:{category:"element"},perform:(t,e)=>({elements:Wde(t,e),appState:e,commitToHistory:!0}),contextItemLabel:"labels.sendBackward",keyPriority:40,keyTest:t=>t[z.CTRL_OR_CMD]&&!t.shiftKey&&t.code===ht.BRACKET_LEFT,PanelComponent:({updateData:t,appState:e})=>g("button",{type:"button",className:"zIndexButton",onClick:()=>t(null),title:`${I("labels.sendBackward")} — ${re("CtrlOrCmd+[")}`,children:Fee})}),Kde=ue({name:"bringForward",trackEvent:{category:"element"},perform:(t,e)=>({elements:jde(t,e),appState:e,commitToHistory:!0}),contextItemLabel:"labels.bringForward",keyPriority:40,keyTest:t=>t[z.CTRL_OR_CMD]&&!t.shiftKey&&t.code===ht.BRACKET_RIGHT,PanelComponent:({updateData:t,appState:e})=>g("button",{type:"button",className:"zIndexButton",onClick:()=>t(null),title:`${I("labels.bringForward")} — ${re("CtrlOrCmd+]")}`,children:Nee})}),qde=ue({name:"sendToBack",trackEvent:{category:"element"},perform:(t,e)=>({elements:Xde(t,e),appState:e,commitToHistory:!0}),contextItemLabel:"labels.sendToBack",keyTest:t=>uo?t[z.CTRL_OR_CMD]&&t.altKey&&t.code===ht.BRACKET_LEFT:t[z.CTRL_OR_CMD]&&t.shiftKey&&t.code===ht.BRACKET_LEFT,PanelComponent:({updateData:t,appState:e})=>g("button",{type:"button",className:"zIndexButton",onClick:()=>t(null),title:`${I("labels.sendToBack")} — ${re(uo?"CtrlOrCmd+Alt+[":"CtrlOrCmd+Shift+[")}`,children:Uee})}),Jde=ue({name:"bringToFront",trackEvent:{category:"element"},perform:(t,e)=>({elements:Yde(t,e),appState:e,commitToHistory:!0}),contextItemLabel:"labels.bringToFront",keyTest:t=>uo?t[z.CTRL_OR_CMD]&&t.altKey&&t.code===ht.BRACKET_RIGHT:t[z.CTRL_OR_CMD]&&t.shiftKey&&t.code===ht.BRACKET_RIGHT,PanelComponent:({updateData:t,appState:e})=>g("button",{type:"button",className:"zIndexButton",onClick:n=>t(null),title:`${I("labels.bringToFront")} — ${re(uo?"CtrlOrCmd+Alt+]":"CtrlOrCmd+Shift+]")}`,children:Bee})}),Qde=ue({name:"selectAll",trackEvent:{category:"canvas"},perform:(t,e,n,r)=>{if(e.editingLinearElement)return!1;const i=E2(t.filter(s=>!s.isDeleted&&!(Se(s)&&s.containerId)&&!s.locked)).reduce((s,o)=>(s[o.id]=!0,s),{});return{appState:{...e,...ri({editingGroupId:null,selectedElementIds:i},yt(t),e,r),selectedLinearElement:Object.keys(i).length===1&&Je(t[0])?new Ae(t[0],r.scene):null},commitToHistory:!0}},contextItemLabel:"labels.selectAll",keyTest:t=>t[z.CTRL_OR_CMD]&&t.key===z.A}),ehe=t=>{const e=t.slice(),n=new Set,r=s=>{var c,u,d;const o=(u=(c=s[0])==null?void 0:c.groupIds)==null?void 0:u.join(""),a=[s[0]],l=[];for(const h of s.slice(1))((d=h.groupIds)==null?void 0:d.join(""))===o?a.push(h):l.push(h);return l.length?[...a,...r(l)]:a},i=new Map;return e.forEach((s,o)=>{var a;if(!i.has(s.id))if((a=s.groupIds)!=null&&a.length){const l=s.groupIds[s.groupIds.length-1],c=e.slice(o).filter(u=>{var h;const d=(h=u==null?void 0:u.groupIds)==null?void 0:h.some(f=>f===l);return d&&i.set(u.id,!0),d});for(const u of r(c))n.add(u)}else n.add(s)}),n.size!==t.length?(console.error("normalizeGroupElementOrder: lost some elements... bailing!"),t):[...n]},the=t=>{const e=hR(t),n=t.slice(),r=new Set;return n.forEach((i,s)=>{var o,a;if(i)if((o=i.boundElements)!=null&&o.length)r.add(i),n[s]=null,i.boundElements.forEach(l=>{const c=e.get(l.id);c&&l.type==="text"&&(r.add(c[0]),n[c[1]]=null)});else if(i.type==="text"&&i.containerId){const l=e.get(i.containerId);(a=l==null?void 0:l[0].boundElements)!=null&&a.find(c=>c.id===i.id)||(r.add(i),n[s]=null)}else r.add(i),n[s]=null}),r.size!==t.length?(console.error("normalizeBoundElementsOrder: lost some elements... bailing!"),t):[...r]},nhe=t=>the(ehe(t)),rhe=ue({name:"duplicateSelection",trackEvent:{category:"element"},perform:(t,e)=>{if(e.editingLinearElement){const n=Ae.duplicateSelectedPoints(e);return n?{elements:t,appState:n.appState,commitToHistory:!0}:!1}return{...ihe(t,e),commitToHistory:!0}},contextItemLabel:"labels.duplicateSelection",keyTest:t=>t[z.CTRL_OR_CMD]&&t.key===z.D,PanelComponent:({elements:t,appState:e,updateData:n})=>g(st,{type:"button",icon:yee,title:`${I("labels.duplicateSelection")} — ${re("CtrlOrCmd+D")}`,"aria-label":I("labels.duplicateSelection"),onClick:()=>n(null),visible:wn(yt(t),e)})}),ihe=(t,e)=>{const n=nhe(t),r=new Map,i=[],s=[],o=new Map,a=y=>{const b=VO(e.editingGroupId,r,y,{x:y.x+vd/2,y:y.y+vd/2});return o.set(y.id,b.id),s.push(y),i.push(b),b},l=xn(Rt(n,e,{includeBoundTextElement:!0,includeElementsInFrames:!0})),c=new Map,u=y=>{for(const b of y)c.set(b.id,!0);return y},d=[];let h=-1;for(;++h<n.length;){const y=n[h];if(c.get(y.id))continue;const b=tt(y),_=qe(y);if(l.get(y.id)){if(y.groupIds.length||b||_){const E=NO(e,y);if(E){const w=Gn(n,E).flatMap(x=>qe(x)?[...oa(t,x.id),x]:[x]);d.push(...u([...w,...w.map(x=>a(x))]));continue}if(b){d.push(...u([y,b,a(y),a(b)]));continue}if(_){const w=oa(n,y.id);d.push(...u([...w,y,...w.map(x=>a(x)),a(y)]));continue}}(!y.frameId||!l.has(y.frameId))&&d.push(...u([y,a(y)]))}else d.push(...u([y]))}const f=[],p=new Map;for(h=d.length;--h>=0;){const y=d[h];p.get(y.id)||(p.set(y.id,!0),f.push(y))}const m=f.reverse();gN(d,s,o),CD(d,s,o),rB(m,s,o);const v=E2(i);return{elements:m,appState:{...e,...ri({editingGroupId:e.editingGroupId,selectedElementIds:v.reduce((y,b)=>(nn(b)||(y[b.id]=!0),y),{})},yt(m),e,null)}}},Ds=ue({name:"finalize",trackEvent:!1,perform:(t,e,n,{interactiveCanvas:r,focusContainer:i,scene:s})=>{var u;if(e.editingLinearElement){const{elementId:d,startBindingElement:h,endBindingElement:f}=e.editingLinearElement,p=Ae.getElement(d);if(p)return pr(p)&&fh(p,h,f),{elements:p.points.length<2||su(p)?t.filter(m=>m.id!==p.id):void 0,appState:{...e,cursorButton:"up",editingLinearElement:null},commitToHistory:!0}}let o=t;const a=e.pendingImageElementId&&s.getElement(e.pendingImageElementId);a&&ae(a,{isDeleted:!0},!1),window.document.activeElement instanceof HTMLElement&&i();const l=e.multiElement?e.multiElement:((u=e.editingElement)==null?void 0:u.type)==="freedraw"?e.editingElement:null;if(l){if(l.type!=="freedraw"&&e.lastPointerDownWith!=="touch"){const{points:h,lastCommittedPoint:f}=l;(!f||h[h.length-1]!==f)&&ae(l,{points:l.points.slice(0,-1)})}su(l)&&(o=o.filter(h=>h.id!==l.id));const d=sa(l.points,e.zoom.value);if((l.type==="line"||l.type==="freedraw")&&d){const h=l.points,f=h[0];ae(l,{points:h.map((p,m)=>m===h.length-1?[f[0],f[1]]:p)})}if(pr(l)&&!d&&l.points.length>1){const[h,f]=Ae.getPointAtIndexGlobalCoordinates(l,-1);Ax(l,e,bt.getScene(l),{x:h,y:f})}}(!e.activeTool.locked&&e.activeTool.type!=="freedraw"||!l)&&qi(r);let c;return e.activeTool.type==="eraser"?c=kn(e,{...e.activeTool.lastActiveTool||{type:"selection"},lastActiveToolBeforeEraser:null}):c=kn(e,{type:"selection"}),{elements:o,appState:{...e,cursorButton:"up",activeTool:(e.activeTool.locked||e.activeTool.type==="freedraw")&&l?e.activeTool:c,activeEmbeddable:null,draggingElement:null,multiElement:null,editingElement:null,startBoundElement:null,suggestedBindings:[],selectedElementIds:l&&!e.activeTool.locked&&e.activeTool.type!=="freedraw"?{...e.selectedElementIds,[l.id]:!0}:e.selectedElementIds,selectedLinearElement:l&&Je(l)?new Ae(l,s):e.selectedLinearElement,pendingImageElementId:null},commitToHistory:e.activeTool.type==="freedraw"}},keyTest:(t,e)=>t.key===z.ESCAPE&&(e.editingLinearElement!==null||!e.draggingElement&&e.multiElement===null)||(t.key===z.ESCAPE||t.key===z.ENTER)&&e.multiElement!==null,PanelComponent:({appState:t,updateData:e,data:n})=>g(st,{type:"button",icon:kee,title:I("buttons.done"),"aria-label":I("buttons.done"),onClick:e,visible:t.multiElement!=null,size:(n==null?void 0:n.size)||"medium"})}),she=t=>{const{id:e}=pa(),[n,r]=A.useState(t.value),i=o=>{t.ignoreFocus||gW(o.target);const a=o.target.value;a!==t.value&&t.onChange(a)},s=o=>{if(o.key===z.ENTER){if(o.preventDefault(),o.nativeEvent.isComposing||o.keyCode===229)return;o.currentTarget.blur()}};return M("div",{className:"ProjectName",children:[g("label",{className:"ProjectName-label",htmlFor:"filename",children:`${t.label}${t.isNameEditable?"":":"}`}),t.isNameEditable?g("input",{type:"text",className:"TextInput",onBlur:i,onKeyDown:s,id:`${e}-filename`,value:n,onChange:o=>r(o.target.value)}):g("span",{className:"TextInput TextInput--readonly",id:`${e}-filename`,children:t.value})]})},ohe=t=>{const e=t.title||(t.value==="dark"?I("buttons.lightMode"):I("buttons.darkMode"));return g(st,{type:"icon",icon:t.value===Vn.LIGHT?S8.MOON:S8.SUN,title:e,"aria-label":e,onClick:()=>t.onChange(t.value===Vn.DARK?Vn.LIGHT:Vn.DARK),"data-testid":"toggle-dark-mode"})},S8={SUN:g("svg",{width:"512",height:"512",className:"rtl-mirror",viewBox:"0 0 512 512",children:g("path",{fill:"currentColor",d:"M256 160c-52.9 0-96 43.1-96 96s43.1 96 96 96 96-43.1 96-96-43.1-96-96-96zm246.4 80.5l-94.7-47.3 33.5-100.4c4.5-13.6-8.4-26.5-21.9-21.9l-100.4 33.5-47.4-94.8c-6.4-12.8-24.6-12.8-31 0l-47.3 94.7L92.7 70.8c-13.6-4.5-26.5 8.4-21.9 21.9l33.5 100.4-94.7 47.4c-12.8 6.4-12.8 24.6 0 31l94.7 47.3-33.5 100.5c-4.5 13.6 8.4 26.5 21.9 21.9l100.4-33.5 47.3 94.7c6.4 12.8 24.6 12.8 31 0l47.3-94.7 100.4 33.5c13.6 4.5 26.5-8.4 21.9-21.9l-33.5-100.4 94.7-47.3c13-6.5 13-24.7.2-31.1zm-155.9 106c-49.9 49.9-131.1 49.9-181 0-49.9-49.9-49.9-131.1 0-181 49.9-49.9 131.1-49.9 181 0 49.9 49.9 49.9 131.1 0 181z"})}),MOON:g("svg",{width:"512",height:"512",className:"rtl-mirror",viewBox:"0 0 512 512",children:g("path",{fill:"currentColor",d:"M283.211 512c78.962 0 151.079-35.925 198.857-94.792 7.068-8.708-.639-21.43-11.562-19.35-124.203 23.654-238.262-71.576-238.262-196.954 0-72.222 38.662-138.635 101.498-174.394 9.686-5.512 7.25-20.197-3.756-22.23A258.156 258.156 0 0 0 283.211 0c-141.309 0-256 114.511-256 256 0 141.309 114.511 256 256 256z"})})},S2=(t,{selectedElementIds:e},n)=>{t=yt(t);const r=n&&wn(t,{selectedElementIds:e});let i=null,s=r?Rt(t,{selectedElementIds:e},{includeBoundTextElement:!0}):t;return r&&(s.length===1&&qe(s[0])?(i=s[0],s=a4({elements:t,bounds:i,type:"overlap"})):s.length>1&&(s=Rt(t,{selectedElementIds:e},{includeBoundTextElement:!0,includeElementsInFrames:!0}))),{exportingFrame:i,exportedElements:Hc(s)}},C2=async(t,e,n,r,{exportBackground:i,exportPadding:s=oh,viewBackgroundColor:o,name:a,fileHandle:l=null,exportingFrame:c=null})=>{if(e.length===0)throw new Error(I("alerts.cannotExportEmptyCanvas"));if(t==="svg"||t==="clipboard-svg"){const d=await KS(e,{exportBackground:i,exportWithDarkMode:n.exportWithDarkMode,viewBackgroundColor:o,exportPadding:s,exportScale:n.exportScale,exportEmbedScene:n.exportEmbedScene&&t==="svg"},r,{exportingFrame:c});if(t==="svg")return await Ny(new Blob([d.outerHTML],{type:Oe.svg}),{description:"Export to SVG",name:a,extension:n.exportEmbedScene?"excalidraw.svg":"svg",fileHandle:l});if(t==="clipboard-svg"){await fu(d.outerHTML);return}}const u=JN(e,n,r,{exportBackground:i,viewBackgroundColor:o,exportPadding:s,exportingFrame:c});if(t==="png"){let d=await sm(u);return n.exportEmbedScene&&(d=await(await pe(()=>Promise.resolve().then(()=>$y),void 0)).encodePngMetadata({blob:d,metadata:vh(e,n,r,"local")})),await Ny(d,{description:"Export to PNG",name:a,extension:"png",fileHandle:l})}else if(t==="clipboard")try{const d=sm(u);await doe(d)}catch(d){throw console.warn(d),d.name==="CANVAS_POSSIBLY_TOO_BIG"?d:Av&&d.name==="TypeError"?new Error(`${I("alerts.couldNotCopyToClipboard")}

${I("hints.firefox_clipboard_write")}`):new Error(I("alerts.couldNotCopyToClipboard"))}else throw new Error("Unsupported export type")},ahe=async(t,e,n)=>{const{exportBackground:r,viewBackgroundColor:i,name:s,fileHandle:o}=e,a=$N(o);if(!o||!hae(a))throw new Error("fileHandle should exist and should be of type svg or png when resaving");e={...e,exportEmbedScene:!0};const{exportedElements:l,exportingFrame:c}=S2(t,e,!1);return await C2(a,l,e,n,{exportBackground:r,viewBackgroundColor:i,name:s,fileHandle:o,exportingFrame:c}),{fileHandle:o}},I2=({children:t,checked:e,onChange:n,className:r})=>M("div",{className:Ee("Checkbox",r,{"is-checked":e}),onClick:i=>{n(!e,i),i.currentTarget.querySelector(".Checkbox-box").focus()},children:[g("button",{className:"Checkbox-box",role:"checkbox","aria-checked":e,children:xee}),g("div",{className:"Checkbox-label",children:t})]}),lhe=ue({name:"changeProjectName",trackEvent:!1,perform:(t,e,n)=>({appState:{...e,name:n},commitToHistory:!1}),PanelComponent:({appState:t,updateData:e,appProps:n,data:r})=>g(she,{label:I("labels.fileTitle"),value:t.name||"Unnamed",onChange:i=>e(i),isNameEditable:typeof n.name>"u"&&!t.viewModeEnabled,ignoreFocus:(r==null?void 0:r.ignoreFocus)??!1})}),che=ue({name:"changeExportScale",trackEvent:{category:"export",action:"scale"},perform:(t,e,n)=>({appState:{...e,exportScale:n},commitToHistory:!1}),PanelComponent:({elements:t,appState:e,updateData:n})=>{const r=yt(t),s=wn(r,e)?Rt(r,e):r;return g(ge,{children:LT.map(o=>{const[a,l]=Aae(s,oh,o),c=`${I("imageExportDialog.label.scale")} ${o}x (${a}x${l})`;return g(st,{size:"small",type:"radio",icon:`${o}x`,name:"export-canvas-scale",title:c,"aria-label":c,id:"export-canvas-scale",checked:o===e.exportScale,onChange:()=>n(o)},o)})})}}),uhe=ue({name:"changeExportBackground",trackEvent:{category:"export",action:"toggleBackground"},perform:(t,e,n)=>({appState:{...e,exportBackground:n},commitToHistory:!1}),PanelComponent:({appState:t,updateData:e})=>g(I2,{checked:t.exportBackground,onChange:n=>e(n),children:I("imageExportDialog.label.withBackground")})}),RB=ue({name:"changeExportEmbedScene",trackEvent:{category:"export",action:"embedScene"},perform:(t,e,n)=>({appState:{...e,exportEmbedScene:n},commitToHistory:!1}),PanelComponent:({appState:t,updateData:e})=>M(I2,{checked:t.exportEmbedScene,onChange:n=>e(n),children:[I("imageExportDialog.label.embedScene"),g(El,{label:I("imageExportDialog.tooltip.embedScene"),long:!0,children:g("div",{className:"excalidraw-tooltip-icon",children:Lee})})]})}),C8=ue({name:"saveToActiveFile",trackEvent:{category:"export"},predicate:(t,e,n,r)=>!!r.props.UIOptions.canvasActions.saveToActiveFile&&!!e.fileHandle&&!e.viewModeEnabled,perform:async(t,e,n,r)=>{const i=!!e.fileHandle;try{const{fileHandle:s}=XS(e.fileHandle)?await ahe(t,e,r.files):await GN(t,e,r.files);return{commitToHistory:!1,appState:{...e,fileHandle:s,toast:i?{message:s!=null&&s.name?I("toast.fileSavedToFilename").replace("{filename}",`"${s.name}"`):I("toast.fileSaved")}:null}}}catch(s){return(s==null?void 0:s.name)!=="AbortError"?console.error(s):console.warn(s),{commitToHistory:!1}}},keyTest:t=>t.key===z.S&&t[z.CTRL_OR_CMD]&&!t.shiftKey}),OB=ue({name:"saveFileToDisk",viewMode:!0,trackEvent:{category:"export"},perform:async(t,e,n,r)=>{try{const{fileHandle:i}=await GN(t,{...e,fileHandle:null},r.files);return{commitToHistory:!1,appState:{...e,openDialog:null,fileHandle:i,toast:{message:I("toast.fileSaved")}}}}catch(i){return(i==null?void 0:i.name)!=="AbortError"?console.error(i):console.warn(i),{commitToHistory:!1}}},keyTest:t=>t.key===z.S&&t.shiftKey&&t[z.CTRL_OR_CMD],PanelComponent:({updateData:t})=>g(st,{type:"button",icon:See,title:I("buttons.saveAs"),"aria-label":I("buttons.saveAs"),showAriaLabel:_r().editor.isMobile,hidden:!pu,onClick:()=>t(null),"data-testid":"save-as-button"})}),h3=ue({name:"loadScene",trackEvent:{category:"export"},predicate:(t,e,n,r)=>!!r.props.UIOptions.canvasActions.loadScene&&!e.viewModeEnabled,perform:async(t,e,n,r)=>{try{const{elements:i,appState:s,files:o}=await _ae(e,t);return{elements:i,appState:s,files:o,commitToHistory:!0}}catch(i){return(i==null?void 0:i.name)==="AbortError"?(console.warn(i),!1):{elements:t,appState:{...e,errorMessage:i.message},files:r.files,commitToHistory:!1}}},keyTest:t=>t[z.CTRL_OR_CMD]&&t.key===z.O}),dhe=ue({name:"exportWithDarkMode",trackEvent:{category:"export",action:"toggleTheme"},perform:(t,e,n)=>({appState:{...e,exportWithDarkMode:n},commitToHistory:!1}),PanelComponent:({appState:t,updateData:e})=>g("div",{style:{display:"flex",justifyContent:"flex-end",marginTop:"-45px",marginBottom:"10px"},children:g(ohe,{value:t.exportWithDarkMode?Vn.DARK:Vn.LIGHT,onChange:n=>{e(n===Vn.DARK)},title:I("imageExportDialog.label.darkMode")})})});let DB="{}";const hhe=ue({name:"copyStyles",trackEvent:{category:"element"},perform:(t,e)=>{const n=[],r=t.find(i=>e.selectedElementIds[i.id]);if(n.push(r),r&&vl(r)){const i=tt(r);n.push(i)}return r&&(DB=JSON.stringify(n)),{appState:{...e,toast:{message:I("toast.copyStyles")}},commitToHistory:!1}},contextItemLabel:"labels.copyStyles",keyTest:t=>t[z.CTRL_OR_CMD]&&t.altKey&&t.code===ht.C}),fhe=ue({name:"pasteStyles",trackEvent:{category:"element"},perform:(t,e)=>{const n=JSON.parse(DB),r=n[0],i=n[1];if(!IO(r))return{elements:t,commitToHistory:!1};const s=Rt(t,e,{includeBoundTextElement:!0}),o=s.map(a=>a.id);return{elements:t.map(a=>{if(o.includes(a.id)){let l=r;if(Se(a)&&a.containerId&&(l=i),!l)return a;let c=Re(a,{backgroundColor:l==null?void 0:l.backgroundColor,strokeWidth:l==null?void 0:l.strokeWidth,strokeColor:l==null?void 0:l.strokeColor,strokeStyle:l==null?void 0:l.strokeStyle,fillStyle:l==null?void 0:l.fillStyle,opacity:l==null?void 0:l.opacity,roughness:l==null?void 0:l.roughness,roundness:l.roundness?jJ(l.roundness.type,a)?l.roundness:XJ(a):null});if(Se(c)){const u=l.fontSize||_s,d=l.fontFamily||ca;c=Re(c,{fontSize:u,fontFamily:d,textAlign:l.textAlign||kv,lineHeight:l.lineHeight||Kc(d)});let h=null;c.containerId&&(h=s.find(f=>Se(c)&&f.id===c.containerId)||null),go(c,h)}return c.type==="arrow"&&Ct(l)&&(c=Re(c,{startArrowhead:l.startArrowhead,endArrowhead:l.endArrowhead})),qe(a)&&(c=Re(c,{roundness:null,backgroundColor:"transparent"})),c}return a}),commitToHistory:!0}},contextItemLabel:"labels.pasteStyles",keyTest:t=>t[z.CTRL_OR_CMD]&&t.altKey&&t.code===ht.V});ue({name:"toggleCanvasMenu",trackEvent:{category:"menu"},perform:(t,e)=>({appState:{...e,openMenu:e.openMenu==="canvas"?null:"canvas"},commitToHistory:!1}),PanelComponent:({appState:t,updateData:e})=>g(st,{type:"button",icon:YO,"aria-label":I("buttons.menu"),onClick:e,selected:t.openMenu==="canvas"})});ue({name:"toggleEditMenu",trackEvent:{category:"menu"},perform:(t,e)=>({appState:{...e,openMenu:e.openMenu==="shape"?null:"shape"},commitToHistory:!1}),PanelComponent:({elements:t,appState:e,updateData:n})=>g(st,{visible:g4(e,yt(t)),type:"button",icon:Cee,"aria-label":I("buttons.edit"),onClick:n,selected:e.openMenu==="shape"})});const v4=ue({name:"toggleShortcuts",viewMode:!0,trackEvent:{category:"menu",action:"toggleHelpDialog"},perform:(t,e,n,{focusContainer:r})=>{var i,s;return((i=e.openDialog)==null?void 0:i.name)==="help"&&r(),{appState:{...e,openDialog:((s=e.openDialog)==null?void 0:s.name)==="help"?null:{name:"help"}},commitToHistory:!1}},keyTest:t=>t.key===z.QUESTION_MARK}),phe=t=>{if(t.length>=2){const e=t[0].groupIds;for(const n of e)if(t.reduce((r,i)=>r&&Xp(i,n),!0))return!0}return!1},I8=(t,e,n)=>{const r=n.scene.getSelectedElements({selectedElementIds:e.selectedElementIds,includeBoundTextElement:!0});return r.length>=2&&!phe(r)},mhe=ue({name:"group",trackEvent:{category:"element"},perform:(t,e,n,r)=>{const i=r.scene.getSelectedElements({selectedElementIds:e.selectedElementIds,includeBoundTextElement:!0});if(i.length<2)return{appState:e,elements:t,commitToHistory:!1};const s=Cd(e);if(s.length===1){const m=s[0],v=new Set(Gn(t,m).map(_=>_.id)),y=new Set(i.map(_=>_.id));if(new Set([...Array.from(v),...Array.from(y)]).size===v.size)return{appState:e,elements:t,commitToHistory:!1}}let o=[...t];new Set(i.map(m=>m.frameId)).size>1&&rue(i).forEach((v,y)=>{o=_2(o,v)});const l=Di(),c=xn(i);o=o.map(m=>c.get(m.id)?Re(m,{groupIds:AQ(m.groupIds,l,e.editingGroupId)}):m);const u=Gn(o,l),d=u[u.length-1],h=o.lastIndexOf(d),f=o.slice(h+1);return o=[...o.slice(0,h).filter(m=>!Xp(m,l)),...u,...f],{appState:{...e,...DO(l,{...e,selectedGroupIds:{}},yt(o))},elements:o,commitToHistory:!0}},contextItemLabel:"labels.group",predicate:(t,e,n,r)=>I8(t,e,r),keyTest:t=>!t.shiftKey&&t[z.CTRL_OR_CMD]&&t.key===z.G,PanelComponent:({elements:t,appState:e,updateData:n,app:r})=>g(st,{hidden:!I8(t,e,r),type:"button",icon:g(Kee,{theme:e.theme}),onClick:()=>n(null),title:`${I("labels.group")} — ${re("CtrlOrCmd+G")}`,"aria-label":I("labels.group"),visible:wn(yt(t),e)})}),ghe=ue({name:"ungroup",trackEvent:{category:"element"},perform:(t,e,n,r)=>{if(Cd(e).length===0)return{appState:e,elements:t,commitToHistory:!1};let s=[...t];const o=[];s=s.map(d=>{nn(d)&&o.push(d.id);const h=kQ(d.groupIds,e.selectedGroupIds);return h.length===d.groupIds.length?d:Re(d,{groupIds:h})});const a=ri(e,yt(s),e,null),l=r.scene.getSelectedElements(e),c=new Set(l.filter(d=>d.frameId).map(d=>d.frameId));return l4(t).filter(d=>c.has(d.id)).forEach(d=>{d&&(s=uB(s,m0(s,d,e),d))}),a.selectedElementIds=Object.entries(a.selectedElementIds).reduce((d,[h,f])=>(f&&!o.includes(h)&&(d[h]=!0),d),{}),{appState:{...e,...a},elements:s,commitToHistory:!0}},keyTest:t=>t.shiftKey&&t[z.CTRL_OR_CMD]&&t.key===z.G.toUpperCase(),contextItemLabel:"labels.ungroup",predicate:(t,e)=>Cd(e).length>0,PanelComponent:({elements:t,appState:e,updateData:n})=>g(st,{type:"button",hidden:Cd(e).length===0,icon:g(qee,{theme:e.theme}),onClick:()=>n(null),title:`${I("labels.ungroup")} — ${re("CtrlOrCmd+Shift+G")}`,"aria-label":I("labels.ungroup"),visible:wn(yt(t),e)})}),A8=({color:t,onClick:e,name:n,src:r,isBeingFollowed:i,isCurrentUser:s})=>{const o=TQ(n),[a,l]=A.useState(!1),c=!a&&r,u=c?void 0:{background:t};return g("div",{className:Ee("Avatar",{"Avatar--is-followed":i,"Avatar--is-current-user":s}),style:u,onClick:e,children:c?g("img",{className:"Avatar-img",src:r,alt:o,referrerPolicy:"no-referrer",onError:()=>l(!0)}):o})};ue({name:"goToCollaborator",viewMode:!0,trackEvent:{category:"collab"},perform:(t,e,n)=>{var r;return!n.socketId||((r=e.userToFollow)==null?void 0:r.socketId)===n.socketId||n.isCurrentUser?{appState:{...e,userToFollow:null},commitToHistory:!1}:{appState:{...e,userToFollow:{socketId:n.socketId,username:n.username||""},openMenu:e.openMenu==="canvas"?null:e.openMenu},commitToHistory:!1}},PanelComponent:({updateData:t,data:e,appState:n})=>{const{clientId:r,collaborator:i,withName:s,isBeingFollowed:o}=e,a=vy(r);return s?M("div",{className:"dropdown-menu-item dropdown-menu-item-base UserList__collaborator",onClick:()=>t(i),children:[g(A8,{color:a,onClick:()=>{},name:i.username||"",src:i.avatarUrl,isBeingFollowed:o,isCurrentUser:i.isCurrentUser===!0}),i.username,g("div",{className:"UserList__collaborator-follow-status-icon",style:{visibility:o?"visible":"hidden"},title:o?I("userList.hint.followStatus"):void 0,"aria-hidden":!0,children:eD})]}):g(A8,{color:a,onClick:()=>{t(i)},name:i.username||"",src:i.avatarUrl,isBeingFollowed:o,isCurrentUser:i.isCurrentUser===!0})}});const yhe=ue({name:"addToLibrary",trackEvent:{category:"element"},perform:(t,e,n,r)=>{const i=r.scene.getSelectedElements({selectedElementIds:e.selectedElementIds,includeBoundTextElement:!0,includeElementsInFrames:!0});for(const s of _7)if(i.some(o=>o.type===s))return{commitToHistory:!1,appState:{...e,errorMessage:I(`errors.libraryElementTypeError.${s}`)}};return r.library.getLatestLibrary().then(s=>r.library.setLibrary([{id:Di(),status:"unpublished",elements:i.map(Hm),created:Date.now()},...s])).then(()=>({commitToHistory:!1,appState:{...e,toast:{message:I("toast.addedToLibrary")}}})).catch(s=>({commitToHistory:!1,appState:{...e,errorMessage:s.message}}))},contextItemLabel:"labels.addToLibrary"}),vhe=(t,e)=>{const n=zv(t),r=Yo(t);return n.flatMap(i=>{const s=bhe(i,r,e);return i.map(o=>Re(o,{x:o.x+s.x,y:o.y+s.y}))})},bhe=(t,e,{axis:n,position:r})=>{const i=Yo(t),[s,o]=n==="x"?["minX","maxX"]:["minY","maxY"],a={x:0,y:0};return r==="start"?{...a,[n]:e[s]-i[s]}:r==="end"?{...a,[n]:e[o]-i[o]}:{...a,[n]:(e[s]+e[o])/2-(i[s]+i[o])/2}},Ui=(t,e,n,r)=>{const i=r.scene.getSelectedElements(e);return i.length>1&&!i.some(s=>qe(s))},xh=(t,e,n,r)=>{const i=n.scene.getSelectedElements(e),s=vhe(i,r),o=xn(s);return Jd(t.map(a=>o.get(a.id)||a),e,n)};ue({name:"alignTop",trackEvent:{category:"element"},predicate:Ui,perform:(t,e,n,r)=>({appState:e,elements:xh(t,e,r,{position:"start",axis:"y"}),commitToHistory:!0}),keyTest:t=>t[z.CTRL_OR_CMD]&&t.shiftKey&&t.key===z.ARROW_UP,PanelComponent:({elements:t,appState:e,updateData:n,app:r})=>g(st,{hidden:!Ui(t,e,null,r),type:"button",icon:$ee,onClick:()=>n(null),title:`${I("labels.alignTop")} — ${re("CtrlOrCmd+Shift+Up")}`,"aria-label":I("labels.alignTop"),visible:wn(yt(t),e)})});ue({name:"alignBottom",trackEvent:{category:"element"},predicate:Ui,perform:(t,e,n,r)=>({appState:e,elements:xh(t,e,r,{position:"end",axis:"y"}),commitToHistory:!0}),keyTest:t=>t[z.CTRL_OR_CMD]&&t.shiftKey&&t.key===z.ARROW_DOWN,PanelComponent:({elements:t,appState:e,updateData:n,app:r})=>g(st,{hidden:!Ui(t,e,null,r),type:"button",icon:Hee,onClick:()=>n(null),title:`${I("labels.alignBottom")} — ${re("CtrlOrCmd+Shift+Down")}`,"aria-label":I("labels.alignBottom"),visible:wn(yt(t),e)})});ue({name:"alignLeft",trackEvent:{category:"element"},predicate:Ui,perform:(t,e,n,r)=>({appState:e,elements:xh(t,e,r,{position:"start",axis:"x"}),commitToHistory:!0}),keyTest:t=>t[z.CTRL_OR_CMD]&&t.shiftKey&&t.key===z.ARROW_LEFT,PanelComponent:({elements:t,appState:e,updateData:n,app:r})=>g(st,{hidden:!Ui(t,e,null,r),type:"button",icon:zee,onClick:()=>n(null),title:`${I("labels.alignLeft")} — ${re("CtrlOrCmd+Shift+Left")}`,"aria-label":I("labels.alignLeft"),visible:wn(yt(t),e)})});ue({name:"alignRight",trackEvent:{category:"element"},predicate:Ui,perform:(t,e,n,r)=>({appState:e,elements:xh(t,e,r,{position:"end",axis:"x"}),commitToHistory:!0}),keyTest:t=>t[z.CTRL_OR_CMD]&&t.shiftKey&&t.key===z.ARROW_RIGHT,PanelComponent:({elements:t,appState:e,updateData:n,app:r})=>g(st,{hidden:!Ui(t,e,null,r),type:"button",icon:Gee,onClick:()=>n(null),title:`${I("labels.alignRight")} — ${re("CtrlOrCmd+Shift+Right")}`,"aria-label":I("labels.alignRight"),visible:wn(yt(t),e)})});ue({name:"alignVerticallyCentered",trackEvent:{category:"element"},predicate:Ui,perform:(t,e,n,r)=>({appState:e,elements:xh(t,e,r,{position:"center",axis:"y"}),commitToHistory:!0}),PanelComponent:({elements:t,appState:e,updateData:n,app:r})=>g(st,{hidden:!Ui(t,e,null,r),type:"button",icon:jee,onClick:()=>n(null),title:I("labels.centerVertically"),"aria-label":I("labels.centerVertically"),visible:wn(yt(t),e)})});ue({name:"alignHorizontallyCentered",trackEvent:{category:"element"},predicate:Ui,perform:(t,e,n,r)=>({appState:e,elements:xh(t,e,r,{position:"center",axis:"x"}),commitToHistory:!0}),PanelComponent:({elements:t,appState:e,updateData:n,app:r})=>g(st,{hidden:!Ui(t,e,null,r),type:"button",icon:Xee,onClick:()=>n(null),title:I("labels.centerHorizontally"),"aria-label":I("labels.centerHorizontally"),visible:wn(yt(t),e)})});const _he=(t,e)=>{const[n,r,i,s]=e.axis==="x"?["minX","midX","maxX","width"]:["minY","midY","maxY","height"],o=Yo(t),a=zv(t).map(d=>[d,Yo(d)]).sort((d,h)=>d[1][r]-h[1][r]);let l=0;for(const d of a)l+=d[1][s];const c=(o[s]-l)/(a.length-1);if(c<0){const d=a.findIndex(m=>m[1][n]===o[n]),h=a.findIndex(m=>m[1][i]===o[i]),f=(a[h][1][r]-a[d][1][r])/(a.length-1);let p=a[d][1][r];return a.flatMap(([m,v],y)=>{const b={x:0,y:0};return y!==d&&y!==h&&(p+=f,b[e.axis]=p-v[r]),m.map(_=>Re(_,{x:_.x+b.x,y:_.y+b.y}))})}let u=o[n];return a.flatMap(([d,h])=>{const f={x:0,y:0};return f[e.axis]=u-h[n],u+=c,u+=h[s],d.map(p=>Re(p,{x:p.x+f.x,y:p.y+f.y}))})},NB=(t,e)=>{const n=e.scene.getSelectedElements(t);return n.length>1&&!n.some(r=>qe(r))},FB=(t,e,n,r)=>{const i=n.scene.getSelectedElements(e),s=_he(i,r),o=xn(s);return Jd(t.map(a=>o.get(a.id)||a),e,n)};ue({name:"distributeHorizontally",trackEvent:{category:"element"},perform:(t,e,n,r)=>({appState:e,elements:FB(t,e,r,{space:"between",axis:"x"}),commitToHistory:!0}),keyTest:t=>!t[z.CTRL_OR_CMD]&&t.altKey&&t.code===ht.H,PanelComponent:({elements:t,appState:e,updateData:n,app:r})=>g(st,{hidden:!NB(e,r),type:"button",icon:Vee,onClick:()=>n(null),title:`${I("labels.distributeHorizontally")} — ${re("Alt+H")}`,"aria-label":I("labels.distributeHorizontally"),visible:wn(yt(t),e)})});ue({name:"distributeVertically",trackEvent:{category:"element"},perform:(t,e,n,r)=>({appState:e,elements:FB(t,e,r,{space:"between",axis:"y"}),commitToHistory:!0}),keyTest:t=>!t[z.CTRL_OR_CMD]&&t.altKey&&t.code===ht.V,PanelComponent:({elements:t,appState:e,updateData:n,app:r})=>g(st,{hidden:!NB(e,r),type:"button",icon:Wee,onClick:()=>n(null),title:`${I("labels.distributeVertically")} — ${re("Alt+V")}`,"aria-label":I("labels.distributeVertically"),visible:wn(yt(t),e)})});const Ehe=ue({name:"flipHorizontal",trackEvent:{category:"element"},perform:(t,e,n,r)=>({elements:Jd(BB(t,e,"horizontal"),e,r),appState:e,commitToHistory:!0}),keyTest:t=>t.shiftKey&&t.code===ht.H,contextItemLabel:"labels.flipHorizontal"}),whe=ue({name:"flipVertical",trackEvent:{category:"element"},perform:(t,e,n,r)=>({elements:Jd(BB(t,e,"vertical"),e,r),appState:e,commitToHistory:!0}),keyTest:t=>t.shiftKey&&t.code===ht.V&&!t[z.CTRL_OR_CMD],contextItemLabel:"labels.flipVertical"}),BB=(t,e,n)=>{const r=Rt(yt(t),e,{includeBoundTextElement:!0,includeElementsInFrames:!0}),i=xhe(r,e,n),s=xn(i);return t.map(o=>s.get(o.id)||o)},xhe=(t,e,n)=>{const{minX:r,minY:i,maxX:s,maxY:o}=Yo(t);return TB({originalElements:xn(t)},t,"nw",!0,n==="horizontal"?s:r,n==="horizontal"?i:o),(yc(e)?Ix:kx)(t),t},y0=ue({name:"copy",trackEvent:{category:"element"},perform:async(t,e,n,r)=>{const i=r.scene.getSelectedElements({selectedElementIds:e.selectedElementIds,includeBoundTextElement:!0,includeElementsInFrames:!0});try{await ooe(i,r.files,n)}catch(s){return{commitToHistory:!1,appState:{...e,errorMessage:s.message}}}return{commitToHistory:!1}},contextItemLabel:"labels.copy",keyTest:void 0}),k8=ue({name:"paste",trackEvent:{category:"element"},perform:async(t,e,n,r)=>{let i;try{i=await coe()}catch(s){return s.name==="AbortError"||s.name==="NotAllowedError"?!1:(console.error(`actionPaste ${s.name}: ${s.message}`),Av?{commitToHistory:!1,appState:{...e,errorMessage:I("hints.firefox_clipboard_write")}}:{commitToHistory:!1,appState:{...e,errorMessage:I("errors.asyncPasteFailedOnRead")}})}try{r.pasteFromClipboard(ioe({types:i}))}catch(s){return console.error(s),{commitToHistory:!1,appState:{...e,errorMessage:I("errors.asyncPasteFailedOnParse")}}}return{commitToHistory:!1}},contextItemLabel:"labels.paste",keyTest:void 0}),M8=ue({name:"cut",trackEvent:{category:"element"},perform:(t,e,n,r)=>(y0.perform(t,e,n,r),IB.perform(t,e)),contextItemLabel:"labels.cut",keyTest:t=>t[z.CTRL_OR_CMD]&&t.key===z.X}),P8=ue({name:"copyAsSvg",trackEvent:{category:"element"},perform:async(t,e,n,r)=>{if(!r.canvas)return{commitToHistory:!1};const{exportedElements:i,exportingFrame:s}=S2(t,e,!0);try{return await C2("clipboard-svg",i,e,r.files,{...e,exportingFrame:s}),{commitToHistory:!1}}catch(o){return console.error(o),{appState:{...e,errorMessage:o.message},commitToHistory:!1}}},predicate:t=>US&&t.length>0,contextItemLabel:"labels.copyAsSvg"}),L8=ue({name:"copyAsPng",trackEvent:{category:"element"},perform:async(t,e,n,r)=>{if(!r.canvas)return{commitToHistory:!1};const i=r.scene.getSelectedElements({selectedElementIds:e.selectedElementIds,includeBoundTextElement:!0,includeElementsInFrames:!0}),{exportedElements:s,exportingFrame:o}=S2(t,e,!0);try{return await C2("clipboard",s,e,r.files,{...e,exportingFrame:o}),{appState:{...e,toast:{message:I("toast.copyToClipboardAsPng",{exportSelection:i.length?I("toast.selection"):I("toast.canvas"),exportColorScheme:e.exportWithDarkMode?I("buttons.darkMode"):I("buttons.lightMode")})}},commitToHistory:!1}}catch(a){return console.error(a),{appState:{...e,errorMessage:a.message},commitToHistory:!1}}},predicate:t=>$S&&t.length>0,contextItemLabel:"labels.copyAsPng",keyTest:t=>t.code===ht.C&&t.altKey&&t.shiftKey}),R8=ue({name:"copyText",trackEvent:{category:"element"},perform:(t,e,n,r)=>{const s=r.scene.getSelectedElements({selectedElementIds:e.selectedElementIds,includeBoundTextElement:!0}).reduce((o,a)=>(Se(a)&&o.push(a.text),o),[]).join(`

`);return fu(s),{commitToHistory:!1}},predicate:(t,e,n,r)=>US&&r.scene.getSelectedElements({selectedElementIds:e.selectedElementIds,includeBoundTextElement:!0}).some(Se),contextItemLabel:"labels.copyText"}),O8=ue({name:"gridMode",viewMode:!0,trackEvent:{category:"canvas",predicate:t=>!t.gridSize},perform(t,e){return{appState:{...e,gridSize:this.checked(e)?null:vd,objectsSnapModeEnabled:!1},commitToHistory:!1}},checked:t=>t.gridSize!==null,predicate:(t,e,n)=>typeof n.gridModeEnabled>"u",contextItemLabel:"labels.showGrid",keyTest:t=>t[z.CTRL_OR_CMD]&&t.code===ht.QUOTE}),f3=ue({name:"zenMode",viewMode:!0,trackEvent:{category:"canvas",predicate:t=>!t.zenModeEnabled},perform(t,e){return{appState:{...e,zenModeEnabled:!this.checked(e)},commitToHistory:!1}},checked:t=>t.zenModeEnabled,predicate:(t,e,n)=>typeof n.zenModeEnabled>"u",contextItemLabel:"buttons.zenMode",keyTest:t=>!t[z.CTRL_OR_CMD]&&t.altKey&&t.code===ht.Z}),The=ue({name:"objectsSnapMode",viewMode:!0,trackEvent:{category:"canvas",predicate:t=>!t.objectsSnapModeEnabled},perform(t,e){return{appState:{...e,objectsSnapModeEnabled:!this.checked(e),gridSize:null},commitToHistory:!1}},checked:t=>t.objectsSnapModeEnabled,predicate:(t,e,n)=>typeof n.objectsSnapModeEnabled>"u",contextItemLabel:"buttons.objectsSnapMode",keyTest:t=>!t[z.CTRL_OR_CMD]&&t.altKey&&t.code===ht.S}),qy=ue({name:"stats",viewMode:!0,trackEvent:{category:"menu"},perform(t,e){return{appState:{...e,showStats:!this.checked(e)},commitToHistory:!1}},checked:t=>t.showStats,contextItemLabel:"stats.title",keyTest:t=>!t[z.CTRL_OR_CMD]&&t.altKey&&t.code===ht.SLASH}),She=ue({name:"unbindText",contextItemLabel:"labels.unbindText",trackEvent:{category:"element"},predicate:(t,e,n,r)=>r.scene.getSelectedElements(e).some(s=>vl(s)),perform:(t,e,n,r)=>(r.scene.getSelectedElements(e).forEach(s=>{var a;const o=tt(s);if(o){const{width:l,height:c,baseline:u}=ia(o.originalText,mn(o),o.lineHeight),d=poe(s.id);mN(s.id);const{x:h,y:f}=c2(s,o);ae(o,{containerId:null,width:l,height:c,baseline:u,text:o.originalText,x:h,y:f}),ae(s,{boundElements:(a=s.boundElements)==null?void 0:a.filter(p=>p.id!==o.id),height:d||s.height})}}),{elements:t,appState:e,commitToHistory:!0})}),Che=ue({name:"bindText",contextItemLabel:"labels.bindText",trackEvent:{category:"element"},predicate:(t,e,n,r)=>{const i=r.scene.getSelectedElements(e);if(i.length===2){const s=Se(i[0])||Se(i[1]);let o;if(Lc(i[0])?o=i[0]:Lc(i[1])&&(o=i[1]),s&&o&&tt(o)===null)return!0}return!1},perform:(t,e,n,r)=>{const i=r.scene.getSelectedElements(e);let s,o;Se(i[0])&&Lc(i[1])?(s=i[0],o=i[1]):(s=i[1],o=i[0]),ae(s,{containerId:o.id,verticalAlign:ai.MIDDLE,textAlign:Dp.CENTER}),ae(o,{boundElements:(o.boundElements||[]).concat({type:"text",id:s.id})});const a=o.height;return go(s,o),Py(o.id,a),{elements:Ihe(t,o,s),appState:{...e,selectedElementIds:{[o.id]:!0}},commitToHistory:!0}}}),Ihe=(t,e,n)=>{const r=t.slice(),i=r.findIndex(o=>o.id===n.id);r.splice(i,1);const s=r.findIndex(o=>o.id===e.id);return r.splice(s+1,0,n),r},Ahe=(t,e,n)=>{const r=t.slice(),i=r.findIndex(o=>o.id===e.id);r.splice(i,1);const s=r.findIndex(o=>o.id===n.id);return r.splice(s,0,e),r},khe=ue({name:"wrapTextInContainer",contextItemLabel:"labels.createContainerFromText",trackEvent:{category:"element"},predicate:(t,e,n,r)=>{const i=r.scene.getSelectedElements(e),s=i.every(o=>Se(o));return i.length>0&&s},perform:(t,e,n,r)=>{var a;const i=r.scene.getSelectedElements(e);let s=t.slice();const o={};for(const l of i)if(Se(l)){const c=bl({type:"rectangle",backgroundColor:e.currentItemBackgroundColor,boundElements:[...l.boundElements||[],{id:l.id,type:"text"}],angle:l.angle,fillStyle:e.currentItemFillStyle,strokeColor:e.currentItemStrokeColor,roughness:e.currentItemRoughness,strokeWidth:e.currentItemStrokeWidth,strokeStyle:e.currentItemStrokeStyle,roundness:e.currentItemRoundness==="round"?{type:dh("rectangle")?jn.ADAPTIVE_RADIUS:jn.PROPORTIONAL_RADIUS}:null,opacity:100,locked:!1,x:l.x-Ln,y:l.y-Ln,width:Zc(l.width,"rectangle"),height:Zc(l.height,"rectangle"),groupIds:l.groupIds,frameId:l.frameId});if((a=l.boundElements)!=null&&a.length){const u=l.boundElements.filter(h=>h.type==="arrow").map(h=>h.id);s.filter(h=>u.includes(h.id)).forEach(h=>{let f=h.startBinding,p=h.endBinding;(f==null?void 0:f.elementId)===l.id&&(f={...f,elementId:c.id}),(p==null?void 0:p.elementId)===l.id&&(p={...p,elementId:c.id}),(f||p)&&ae(h,{startBinding:f,endBinding:p},!1)})}ae(l,{containerId:c.id,verticalAlign:ai.MIDDLE,boundElements:null,textAlign:Dp.CENTER},!1),go(l,c),s=Ahe([...s,c],c,l),o[c.id]=!0}return{elements:s,appState:{...e,selectedElementIds:o},commitToHistory:!0}}}),D8=t=>t.every(e=>!e.locked),Mhe=ue({name:"toggleElementLock",trackEvent:{category:"element"},predicate:(t,e,n,r)=>!r.scene.getSelectedElements(e).some(s=>s.locked&&s.frameId),perform:(t,e,n,r)=>{const i=r.scene.getSelectedElements({selectedElementIds:e.selectedElementIds,includeBoundTextElement:!0,includeElementsInFrames:!0});if(!i.length)return!1;const s=D8(i),o=xn(i);return{elements:t.map(a=>o.has(a.id)?Re(a,{locked:s}):a),appState:{...e,selectedLinearElement:s?null:e.selectedLinearElement},commitToHistory:!0}},contextItemLabel:(t,e,n)=>{const r=n.scene.getSelectedElements({selectedElementIds:e.selectedElementIds,includeBoundTextElement:!1});return r.length===1&&!qe(r[0])?r[0].locked?"labels.elementLock.unlock":"labels.elementLock.lock":D8(r)?"labels.elementLock.lockAll":"labels.elementLock.unlockAll"},keyTest:(t,e,n,r)=>t.key.toLocaleLowerCase()===z.L&&t[z.CTRL_OR_CMD]&&t.shiftKey&&r.scene.getSelectedElements({selectedElementIds:e.selectedElementIds,includeBoundTextElement:!1}).length>0}),Phe=ue({name:"unlockAllElements",trackEvent:{category:"canvas"},viewMode:!1,predicate:t=>t.some(e=>e.locked),perform:(t,e)=>{const n=t.filter(r=>r.locked);return{elements:t.map(r=>r.locked?Re(r,{locked:!1}):r),appState:{...e,selectedElementIds:Object.fromEntries(n.map(r=>[r.id,!0]))},commitToHistory:!0}},contextItemLabel:"labels.elementLock.unlockAll"}),Lhe=ue({name:"toggleLinearEditor",trackEvent:{category:"element"},predicate:(t,e,n,r)=>{const i=r.scene.getSelectedElements(e);return!!(i.length===1&&Je(i[0]))},perform(t,e,n,r){var o;const i=r.scene.getSelectedElements({selectedElementIds:e.selectedElementIds,includeBoundTextElement:!0})[0],s=((o=e.editingLinearElement)==null?void 0:o.elementId)===i.id?null:new Ae(i,r.scene);return{appState:{...e,editingLinearElement:s},commitToHistory:!1}},contextItemLabel:(t,e,n)=>{var i;const r=n.scene.getSelectedElements({selectedElementIds:e.selectedElementIds,includeBoundTextElement:!0})[0];return((i=e.editingLinearElement)==null?void 0:i.elementId)===r.id?"labels.lineEditor.exit":"labels.lineEditor.edit"}}),UB=(t,e,n)=>{if(!e.multiElement&&!e.resizingElement&&!e.editingElement&&!e.draggingElement){const i=n();if(i===null)return{commitToHistory:!1};const s=xn(t),o=i.elements,a=xn(o),l=t.filter(u=>!a.has(u.id)),c=o.map(u=>Re(s.get(u.id)||u,u)).concat(l.map(u=>Re(u,{isDeleted:!0})));return kS(c,l),{elements:c,appState:{...e,...i.appState},commitToHistory:!1,syncHistory:!0}}return{commitToHistory:!1}},Rhe=t=>({name:"undo",trackEvent:{category:"history"},perform:(e,n)=>UB(e,n,()=>t.undoOnce()),keyTest:e=>e[z.CTRL_OR_CMD]&&e.key.toLowerCase()===z.Z&&!e.shiftKey,PanelComponent:({updateData:e,data:n})=>g(st,{type:"button",icon:Mee,"aria-label":I("buttons.undo"),onClick:e,size:(n==null?void 0:n.size)||"medium"}),commitToHistory:()=>!1}),Ohe=t=>({name:"redo",trackEvent:{category:"history"},perform:(e,n)=>UB(e,n,()=>t.redoOnce()),keyTest:e=>e[z.CTRL_OR_CMD]&&e.shiftKey&&e.key.toLowerCase()===z.Z||f7&&e.ctrlKey&&!e.shiftKey&&e.key===z.Y,PanelComponent:({updateData:e,data:n})=>g(st,{type:"button",icon:Pee,"aria-label":I("buttons.redo"),onClick:e,size:(n==null?void 0:n.size)||"medium"}),commitToHistory:()=>!1}),W_=(t,e,n,r,i,s)=>{if(t.trackEvent)try{typeof t.trackEvent=="object"&&(!t.trackEvent.predicate||t.trackEvent.predicate(n,r,s))&&at(t.trackEvent.category,t.trackEvent.action||t.name,`${e} (${i.device.editor.isMobile?"mobile":"desktop"})`)}catch(o){console.error("error while logging action:",o)}};class Dhe{constructor(e,n,r,i){O(this,"actions",{});O(this,"updater");O(this,"getAppState");O(this,"getElementsIncludingDeleted");O(this,"app");O(this,"renderAction",(e,n)=>{const r=this.app.props.UIOptions.canvasActions;if(this.actions[e]&&"PanelComponent"in this.actions[e]&&(!(e in r)||r[e])){const i=this.actions[e],s=i.PanelComponent;s.displayName="PanelComponent";const o=this.getElementsIncludingDeleted(),a=this.getAppState(),l=c=>{W_(i,"ui",a,o,this.app,c),this.updater(i.perform(this.getElementsIncludingDeleted(),this.getAppState(),c,this.app))};return g(s,{elements:this.getElementsIncludingDeleted(),appState:this.getAppState(),updateData:l,appProps:this.app.props,app:this.app,data:n})}return null});O(this,"isActionEnabled",e=>{const n=this.getElementsIncludingDeleted(),r=this.getAppState();return!e.predicate||e.predicate(n,r,this.app.props,this.app)});this.updater=s=>{if(s&&"then"in s)s.then(o=>e(o));else return e(s)},this.getAppState=n,this.getElementsIncludingDeleted=r,this.app=i}registerAction(e){this.actions[e.name]=e}registerAll(e){e.forEach(n=>this.registerAction(n))}handleKeyDown(e){const n=this.app.props.UIOptions.canvasActions,r=Object.values(this.actions).sort((l,c)=>(c.keyPriority||0)-(l.keyPriority||0)).filter(l=>(l.name in n?n[l.name]:!0)&&l.keyTest&&l.keyTest(e,this.getAppState(),this.getElementsIncludingDeleted(),this.app));if(r.length!==1)return r.length>1&&console.warn("Canceling as multiple actions match this shortcut",r),!1;const i=r[0];if(this.getAppState().viewModeEnabled&&i.viewMode!==!0)return!1;const s=this.getElementsIncludingDeleted(),o=this.getAppState(),a=null;return W_(i,"keyboard",o,s,this.app,null),e.preventDefault(),e.stopPropagation(),this.updater(r[0].perform(s,o,a,this.app)),!0}executeAction(e,n="api",r=null){const i=this.getElementsIncludingDeleted(),s=this.getAppState();W_(e,n,s,i,this.app,r),this.updater(e.perform(i,s,r,this.app))}}const N8=t=>{const e=Array.from(t.values());return{x:B8(e,n=>n.x)/e.length,y:B8(e,n=>n.y)/e.length}},F8=([t,e])=>Math.hypot(t.x-e.x,t.y-e.y),B8=(t,e)=>t.reduce((n,r)=>n+e(r),0),Nhe=t=>({selectedElementIds:t.selectedElementIds,selectedGroupIds:t.selectedGroupIds,viewBackgroundColor:t.viewBackgroundColor,editingLinearElement:t.editingLinearElement,editingGroupId:t.editingGroupId,name:t.name});class Fhe{constructor(){O(this,"elementCache",new Map);O(this,"recording",!0);O(this,"stateHistory",[]);O(this,"redoStack",[]);O(this,"lastEntry",null);O(this,"generateEntry",(e,n)=>this.dehydrateHistoryEntry({appState:Nhe(e),elements:n.reduce((r,i)=>{if(Je(i)&&e.multiElement&&e.multiElement.id===i.id){if(e.multiElement&&e.multiElement.id===i.id&&i.points.length<2)return r;r.push({...i,points:i.lastCommittedPoint!==i.points[i.points.length-1]?i.points.slice(0,-1):i.points})}else r.push(i);return r},[])}))}hydrateHistoryEntry({appState:e,elements:n}){return{appState:JSON.parse(e),elements:n.map(r=>{var s;const i=(s=this.elementCache.get(r.id))==null?void 0:s.get(r.versionNonce);if(!i)throw new Error(`Element not found: ${r.id}:${r.versionNonce}`);return i})}}dehydrateHistoryEntry({appState:e,elements:n}){return{appState:JSON.stringify(e),elements:n.map(r=>{this.elementCache.has(r.id)||this.elementCache.set(r.id,new Map);const i=this.elementCache.get(r.id);return i.has(r.versionNonce)||i.set(r.versionNonce,Hm(r)),{id:r.id,versionNonce:r.versionNonce}})}}getSnapshotForTest(){return{recording:this.recording,stateHistory:this.stateHistory.map(e=>this.hydrateHistoryEntry(e)),redoStack:this.redoStack.map(e=>this.hydrateHistoryEntry(e))}}clear(){this.stateHistory.length=0,this.redoStack.length=0,this.lastEntry=null,this.elementCache.clear()}shouldCreateEntry(e){var i,s;const{lastEntry:n}=this;if(!n||e.elements.length!==n.elements.length)return!0;for(let o=e.elements.length-1;o>-1;o--){const a=e.elements[o],l=n.elements[o];if(!a||!l||a.id!==l.id||a.versionNonce!==l.versionNonce)return!0}let r;for(r in e.appState)if(!(r==="editingLinearElement"&&((i=e.appState[r])==null?void 0:i.elementId)===((s=n.appState[r])==null?void 0:s.elementId))&&!(r==="selectedElementIds"||r==="selectedGroupIds")&&e.appState[r]!==n.appState[r])return!0;return!1}pushEntry(e,n){const r=this.generateEntry(e,n),i=this.hydrateHistoryEntry(r);if(i){if(!this.shouldCreateEntry(i))return;this.stateHistory.push(r),this.lastEntry=i,this.clearRedoStack()}}clearRedoStack(){this.redoStack.splice(0,this.redoStack.length)}redoOnce(){if(this.redoStack.length===0)return null;const e=this.redoStack.pop();return e!==void 0?(this.stateHistory.push(e),this.hydrateHistoryEntry(e)):null}undoOnce(){if(this.stateHistory.length===1)return null;const e=this.stateHistory.pop(),n=this.stateHistory[this.stateHistory.length-1];return e!==void 0?(this.redoStack.push(e),this.hydrateHistoryEntry(n)):null}setCurrentState(e,n){this.lastEntry=this.hydrateHistoryEntry(this.generateEntry(e,n))}resumeRecording(){this.recording=!0}record(e,n){this.recording&&(this.pushEntry(e,n),this.recording=!1)}}const $B=[{icon:iee,value:"selection",key:z.V,numericKey:z[1],fillable:!0},{icon:see,value:"rectangle",key:z.R,numericKey:z[2],fillable:!0},{icon:oee,value:"diamond",key:z.D,numericKey:z[3],fillable:!0},{icon:aee,value:"ellipse",key:z.O,numericKey:z[4],fillable:!0},{icon:lee,value:"arrow",key:z.A,numericKey:z[5],fillable:!0},{icon:cee,value:"line",key:z.L,numericKey:z[6],fillable:!0},{icon:pS,value:"freedraw",key:[z.P,z.X],numericKey:z[7],fillable:!1},{icon:dee,value:"text",key:z.T,numericKey:z[8],fillable:!1},{icon:hee,value:"image",key:null,numericKey:z[9],fillable:!1},{icon:fee,value:"eraser",key:z.E,numericKey:z[0],fillable:!1}],Bhe=t=>{const e=$B.find((n,r)=>n.numericKey!=null&&t===n.numericKey.toString()||n.key&&(typeof n.key=="string"?n.key===t:n.key.includes(t)));return(e==null?void 0:e.value)||null},Uhe={toggleTheme:[re("Shift+Alt+D")],saveScene:[re("CtrlOrCmd+S")],loadScene:[re("CtrlOrCmd+O")],clearCanvas:[re("CtrlOrCmd+Delete")],imageExport:[re("CtrlOrCmd+Shift+E")],cut:[re("CtrlOrCmd+X")],copy:[re("CtrlOrCmd+C")],paste:[re("CtrlOrCmd+V")],copyStyles:[re("CtrlOrCmd+Alt+C")],pasteStyles:[re("CtrlOrCmd+Alt+V")],selectAll:[re("CtrlOrCmd+A")],deleteSelectedElements:[re("Delete")],duplicateSelection:[re("CtrlOrCmd+D"),re(`Alt+${I("helpDialog.drag")}`)],sendBackward:[re("CtrlOrCmd+[")],bringForward:[re("CtrlOrCmd+]")],sendToBack:[re(uo?"CtrlOrCmd+Alt+[":"CtrlOrCmd+Shift+[")],bringToFront:[re(uo?"CtrlOrCmd+Alt+]":"CtrlOrCmd+Shift+]")],copyAsPng:[re("Shift+Alt+C")],copyAsSvg:[],group:[re("CtrlOrCmd+G")],ungroup:[re("CtrlOrCmd+Shift+G")],gridMode:[re("CtrlOrCmd+'")],zenMode:[re("Alt+Z")],objectsSnapMode:[re("Alt+S")],stats:[re("Alt+/")],addToLibrary:[],flipHorizontal:[re("Shift+H")],flipVertical:[re("Shift+V")],viewMode:[re("Alt+R")],hyperlink:[re("CtrlOrCmd+K")],toggleElementLock:[re("CtrlOrCmd+Shift+L")]},Th=t=>{const e=Uhe[t];return e&&e.length>0?e[0]:""},Ur="separator",$he=ce.memo(({actionManager:t,items:e,top:n,left:r,onClose:i})=>{const s=G4(),o=P2(),a=e.reduce((l,c)=>(c&&(c===Ur||!c.predicate||c.predicate(o,s,t.app.props,t.app))&&l.push(c),l),[]);return g(sN,{onCloseRequest:()=>{i()},top:n,left:r,fitInViewport:!0,offsetLeft:s.offsetLeft,offsetTop:s.offsetTop,viewportWidth:s.width,viewportHeight:s.height,children:g("ul",{className:"context-menu",onContextMenu:l=>l.preventDefault(),children:a.map((l,c)=>{var h;if(l===Ur)return!a[c-1]||a[c-1]===Ur?null:g("hr",{className:"context-menu-item-separator"},c);const u=l.name;let d="";return l.contextItemLabel&&(typeof l.contextItemLabel=="function"?d=I(l.contextItemLabel(o,s,t.app)):d=I(l.contextItemLabel)),g("li",{"data-testid":u,onClick:()=>{i(()=>{t.executeAction(l,"contextMenu")})},children:M("button",{className:Ee("context-menu-item",{dangerous:u==="deleteSelectedElements",checkmark:(h=l.checked)==null?void 0:h.call(l,s)}),children:[g("div",{className:"context-menu-item__label",children:d}),g("kbd",{className:"context-menu-item__shortcut",children:u?Th(u):""})]})},c)})})})}),Hhe=A.forwardRef(({children:t,gap:e,align:n,justifyContent:r,className:i,style:s},o)=>g("div",{className:Ee("Stack Stack_horizontal",i),style:{"--gap":e,alignItems:n,justifyContent:r,...s},ref:o,children:t})),zhe=A.forwardRef(({children:t,gap:e,align:n,justifyContent:r,className:i,style:s},o)=>g("div",{className:Ee("Stack Stack_vertical",i),style:{"--gap":e,justifyItems:n,justifyContent:r,...s},ref:o,children:t})),Ii={Row:Hhe,Col:zhe},HB=({className:t="",children:e,onToggle:n,title:r,...i})=>{const s=_r(),o=Ee(`dropdown-menu-button ${t}`,"zen-mode-transition",{"dropdown-menu-button--mobile":s.editor.isMobile}).trim();return g("button",{"data-prevent-outside-click":!0,className:o,onClick:n,type:"button","data-testid":"dropdown-menu-button",title:r,...i,children:e})};HB.displayName="DropdownMenuTrigger";const zB=ce.createContext({}),GB=(t="",e=!1)=>`dropdown-menu-item dropdown-menu-item-base ${t} ${e?"dropdown-menu-item--selected":""}`.trim(),VB=(t,e)=>{const n=A.useContext(zB);return Lv(t,r=>{var s;const i=new CustomEvent(ee.MENU_ITEM_SELECT,{bubbles:!0,cancelable:!0});e==null||e(i),i.defaultPrevented||(s=n.onSelect)==null||s.call(n,i)})},WB=({icon:t,shortcut:e,children:n})=>{const r=_r();return M(ge,{children:[g("div",{className:"dropdown-menu-item__icon",children:t}),g("div",{className:"dropdown-menu-item__text",children:n}),e&&!r.editor.isMobile&&g("div",{className:"dropdown-menu-item__shortcut",children:e})]})},Is=({icon:t,onSelect:e,children:n,shortcut:r,className:i,selected:s,...o})=>{const a=VB(o.onClick,e);return g("button",{...o,onClick:a,type:"button",className:GB(i,s),title:o.title??o["aria-label"],children:g(WB,{icon:t,shortcut:r,children:n})})};Is.displayName="DropdownMenuItem";const jB=({children:t})=>g("div",{style:{display:"inline-flex",marginLeft:"auto",padding:"2px 4px",background:"pink",borderRadius:6,fontSize:9,color:"black",fontFamily:"Cascadia, monospace"},children:t});jB.displayName="DropdownMenuItemBadge";Is.Badge=jB;const XB=()=>g("div",{style:{height:"1px",backgroundColor:"var(--default-border-color)",margin:".5rem 0"}});XB.displayName="DropdownMenuSeparator";const YB=({children:t,className:e="",style:n,title:r})=>M("div",{className:`dropdown-menu-group ${e}`,style:n,children:[r&&g("p",{className:"dropdown-menu-group-title",children:r}),t]});YB.displayName="DropdownMenuGroup";const lo=ce.forwardRef(({children:t,padding:e,className:n,style:r},i)=>g("div",{className:Ee("Island",n),style:{"--padding":e,...r},ref:i,children:t})),ZB=({children:t,onClickOutside:e,className:n="",onSelect:r,style:i})=>{const s=_r(),o=A.useRef(null);NS(o,()=>{e==null||e()});const a=Ee(`dropdown-menu ${n}`,{"dropdown-menu--mobile":s.editor.isMobile}).trim();return g(zB.Provider,{value:{onSelect:r},children:g("div",{ref:o,className:a,style:i,"data-testid":"dropdown-menu",children:s.editor.isMobile?g(Ii.Col,{className:"dropdown-menu-container",children:t}):g(lo,{className:"dropdown-menu-container",padding:2,style:{zIndex:2},children:t})})})};ZB.displayName="DropdownMenuContent";const dp=({icon:t,shortcut:e,href:n,children:r,onSelect:i,className:s="",selected:o,...a})=>{const l=VB(a.onClick,i);return g("a",{...a,href:n,target:"_blank",rel:"noreferrer",className:GB(s,o),title:a.title??a["aria-label"],onClick:l,children:g(WB,{icon:t,shortcut:e,children:r})})};dp.displayName="DropdownMenuItemLink";const Ghe=({children:t,className:e="",selected:n,...r})=>g("div",{...r,className:`dropdown-menu-item-base dropdown-menu-item-custom ${e} ${n?"dropdown-menu-item--selected":""}`.trim(),children:t}),Vhe=t=>{const e=ce.Children.toArray(t).find(n=>ce.isValidElement(n)&&typeof n.type!="string"&&(n==null?void 0:n.type.displayName)&&n.type.displayName==="DropdownMenuTrigger");return e||null},Whe=t=>{const e=ce.Children.toArray(t).find(n=>ce.isValidElement(n)&&typeof n.type!="string"&&(n==null?void 0:n.type.displayName)&&n.type.displayName==="DropdownMenuContent");return e||null},it=({children:t,open:e})=>{const n=Vhe(t),r=Whe(t);return M(ge,{children:[n,e&&r]})};it.Trigger=HB;it.Content=ZB;it.Item=Is;it.ItemLink=dp;it.ItemCustom=Ghe;it.Group=YB;it.Separator=XB;it.displayName="DropdownMenu";var jhe={VITE_APP_BACKEND_V2_GET_URL:"https://json.excalidraw.com/api/v2/",VITE_APP_BACKEND_V2_POST_URL:"https://json.excalidraw.com/api/v2/post/",VITE_APP_LIBRARY_URL:"https://libraries.excalidraw.com",VITE_APP_LIBRARY_BACKEND:"https://us-central1-excalidraw-room-persistence.cloudfunctions.net/libraries",VITE_APP_PORTAL_URL:"https://portal.excalidraw.com",VITE_APP_PLUS_LP:"https://plus.excalidraw.com",VITE_APP_PLUS_APP:"https://app.excalidraw.com",VITE_APP_AI_BACKEND:"https://oss-ai.excalidraw.com",VITE_APP_WS_SERVER_URL:"",VITE_APP_FIREBASE_CONFIG:'{"apiKey":"AIzaSyAd15pYlMci_xIp9ko6wkEsDzAAA0Dn0RU","authDomain":"excalidraw-room-persistence.firebaseapp.com","databaseURL":"https://excalidraw-room-persistence.firebaseio.com","projectId":"excalidraw-room-persistence","storageBucket":"excalidraw-room-persistence.appspot.com","messagingSenderId":"654800341332","appId":"1:654800341332:web:4a692de832b55bd57ce0c1"}',VITE_APP_DISABLE_TRACKING:"",VITE_APP_GIT_SHA:"",BASE_URL:"/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const U8=t=>{let e;const n=new Set,r=(l,c)=>{const u=typeof l=="function"?l(e):l;if(!Object.is(u,e)){const d=e;e=c??(typeof u!="object"||u===null)?u:Object.assign({},e,u),n.forEach(h=>h(e,d))}},i=()=>e,a={setState:r,getState:i,subscribe:l=>(n.add(l),()=>n.delete(l)),destroy:()=>{(jhe?"production":void 0)!=="production"&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),n.clear()}};return e=t(r,i,a),a},Xhe=t=>t?U8(t):U8;var KB={exports:{}},qB={},JB={exports:{}},QB={};/**
 * @license React
 * use-sync-external-store-shim.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Qd=A;function Yhe(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var Zhe=typeof Object.is=="function"?Object.is:Yhe,Khe=Qd.useState,qhe=Qd.useEffect,Jhe=Qd.useLayoutEffect,Qhe=Qd.useDebugValue;function efe(t,e){var n=e(),r=Khe({inst:{value:n,getSnapshot:e}}),i=r[0].inst,s=r[1];return Jhe(function(){i.value=n,i.getSnapshot=e,j_(i)&&s({inst:i})},[t,n,e]),qhe(function(){return j_(i)&&s({inst:i}),t(function(){j_(i)&&s({inst:i})})},[t]),Qhe(n),n}function j_(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!Zhe(t,n)}catch{return!0}}function tfe(t,e){return e()}var nfe=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?tfe:efe;QB.useSyncExternalStore=Qd.useSyncExternalStore!==void 0?Qd.useSyncExternalStore:nfe;JB.exports=QB;var rfe=JB.exports;/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var A2=A,ife=rfe;function sfe(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var ofe=typeof Object.is=="function"?Object.is:sfe,afe=ife.useSyncExternalStore,lfe=A2.useRef,cfe=A2.useEffect,ufe=A2.useMemo,dfe=A2.useDebugValue;qB.useSyncExternalStoreWithSelector=function(t,e,n,r,i){var s=lfe(null);if(s.current===null){var o={hasValue:!1,value:null};s.current=o}else o=s.current;s=ufe(function(){function l(f){if(!c){if(c=!0,u=f,f=r(f),i!==void 0&&o.hasValue){var p=o.value;if(i(p,f))return d=p}return d=f}if(p=d,ofe(u,f))return p;var m=r(f);return i!==void 0&&i(p,m)?p:(u=f,d=m)}var c=!1,u,d,h=n===void 0?null:n;return[function(){return l(e())},h===null?void 0:function(){return l(h())}]},[e,n,r,i]);var a=afe(t,s[0],s[1]);return cfe(function(){o.hasValue=!0,o.value=a},[a]),dfe(a),a};KB.exports=qB;var hfe=KB.exports;const ffe=aa(hfe);var eU={VITE_APP_BACKEND_V2_GET_URL:"https://json.excalidraw.com/api/v2/",VITE_APP_BACKEND_V2_POST_URL:"https://json.excalidraw.com/api/v2/post/",VITE_APP_LIBRARY_URL:"https://libraries.excalidraw.com",VITE_APP_LIBRARY_BACKEND:"https://us-central1-excalidraw-room-persistence.cloudfunctions.net/libraries",VITE_APP_PORTAL_URL:"https://portal.excalidraw.com",VITE_APP_PLUS_LP:"https://plus.excalidraw.com",VITE_APP_PLUS_APP:"https://app.excalidraw.com",VITE_APP_AI_BACKEND:"https://oss-ai.excalidraw.com",VITE_APP_WS_SERVER_URL:"",VITE_APP_FIREBASE_CONFIG:'{"apiKey":"AIzaSyAd15pYlMci_xIp9ko6wkEsDzAAA0Dn0RU","authDomain":"excalidraw-room-persistence.firebaseapp.com","databaseURL":"https://excalidraw-room-persistence.firebaseio.com","projectId":"excalidraw-room-persistence","storageBucket":"excalidraw-room-persistence.appspot.com","messagingSenderId":"654800341332","appId":"1:654800341332:web:4a692de832b55bd57ce0c1"}',VITE_APP_DISABLE_TRACKING:"",VITE_APP_GIT_SHA:"",BASE_URL:"/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const{useDebugValue:pfe}=ce,{useSyncExternalStoreWithSelector:mfe}=ffe;let $8=!1;function gfe(t,e=t.getState,n){(eU?"production":void 0)!=="production"&&n&&!$8&&(console.warn("[DEPRECATED] Use `createWithEqualityFn` instead of `create` or use `useStoreWithEqualityFn` instead of `useStore`. They can be imported from 'zustand/traditional'. https://github.com/pmndrs/zustand/discussions/1937"),$8=!0);const r=mfe(t.subscribe,t.getState,t.getServerState||t.getState,e,n);return pfe(r),r}const H8=t=>{(eU?"production":void 0)!=="production"&&typeof t!="function"&&console.warn("[DEPRECATED] Passing a vanilla store will be unsupported in a future version. Instead use `import { useStore } from 'zustand'`.");const e=typeof t=="function"?Xhe(t):t,n=(r,i)=>gfe(e,r,i);return Object.assign(n,e),n},yfe=t=>t?H8(t):H8;var z8,G8;const V8=typeof window<"u"&&((z8=window.document)!=null&&z8.createElement||((G8=window.navigator)==null?void 0:G8.product)==="ReactNative")?ce.useLayoutEffect:ce.useEffect;function Ns(){const t=yfe(e=>({current:new Array,version:0,set:e}));return{In:({children:e})=>{const n=t(i=>i.set),r=t(i=>i.version);return V8(()=>{n(i=>({version:i.version+1}))},[]),V8(()=>(n(({current:i})=>({current:[...i,e]})),()=>n(({current:i})=>({current:i.filter(s=>s!==e)}))),[e,r]),null},Out:()=>{const e=t(n=>n.current);return ce.createElement(ce.Fragment,null,e)}}}const tU=ce.createContext(null),Nr=()=>ce.useContext(tU),vfe=()=>ce.useMemo(()=>({MainMenuTunnel:Ns(),WelcomeScreenMenuHintTunnel:Ns(),WelcomeScreenToolbarHintTunnel:Ns(),WelcomeScreenHelpHintTunnel:Ns(),WelcomeScreenCenterTunnel:Ns(),FooterCenterTunnel:Ns(),DefaultSidebarTriggerTunnel:Ns(),DefaultSidebarTabTriggersTunnel:Ns(),OverwriteConfirmDialogTunnel:Ns(),TTDDialogTriggerTunnel:Ns(),jotaiScope:Symbol()}),[]),nU=({appState:t,elements:e,renderAction:n})=>{var h;const r=d4(yt(e),t);let i=!1;r.length===2&&(vl(r[0])||vl(r[1]))&&(i=!0);const s=!!t.editingElement,o=_r(),a=document.documentElement.getAttribute("dir")==="rtl",l=ld(t.activeTool.type)&&!to(t.currentItemBackgroundColor)||r.some(f=>ld(f.type)&&!to(f.backgroundColor)),c=ld(t.activeTool.type)||r.some(f=>ld(f.type)),u=r.length===1||i;let d=((h=r[0])==null?void 0:h.type)||null;for(const f of r)if(f.type!==d){d=null;break}return M("div",{className:"panelColumn",children:[g("div",{children:(Ux(t.activeTool.type)&&t.activeTool.type!=="image"&&d!=="image"&&d!=="frame"&&d!=="magicframe"||r.some(f=>Ux(f.type)))&&n("changeStrokeColor")}),c&&g("div",{children:n("changeBackgroundColor")}),l&&n("changeFillStyle"),(yA(t.activeTool.type)||r.some(f=>yA(f.type)))&&n("changeStrokeWidth"),(t.activeTool.type==="freedraw"||r.some(f=>f.type==="freedraw"))&&n("changeStrokeShape"),(vA(t.activeTool.type)||r.some(f=>vA(f.type)))&&M(ge,{children:[n("changeStrokeStyle"),n("changeSloppiness")]}),($x(t.activeTool.type)||r.some(f=>$x(f.type)))&&g(ge,{children:n("changeRoundness")}),(t.activeTool.type==="text"||r.some(Se))&&M(ge,{children:[n("changeFontSize"),n("changeFontFamily"),(t.activeTool.type==="text"||_oe(r))&&n("changeTextAlign")]}),boe(r)&&n("changeVerticalAlign"),(ky(t.activeTool.type)||r.some(f=>ky(f.type)))&&g(ge,{children:n("changeArrowhead")}),n("changeOpacity"),M("fieldset",{children:[g("legend",{children:I("labels.layers")}),M("div",{className:"buttonList",children:[n("sendToBack"),n("sendBackward"),n("bringToFront"),n("bringForward")]})]}),r.length>1&&!i&&M("fieldset",{children:[g("legend",{children:I("labels.align")}),M("div",{className:"buttonList",children:[a?M(ge,{children:[n("alignRight"),n("alignHorizontallyCentered"),n("alignLeft")]}):M(ge,{children:[n("alignLeft"),n("alignHorizontallyCentered"),n("alignRight")]}),r.length>2&&n("distributeHorizontally"),g("div",{style:{flexBasis:"100%",height:0}}),M("div",{style:{display:"flex",flexWrap:"wrap",gap:".5rem",marginTop:"-0.5rem"},children:[n("alignTop"),n("alignVerticallyCentered"),n("alignBottom"),r.length>2&&n("distributeVertically")]})]})]}),!s&&r.length>0&&M("fieldset",{children:[g("legend",{children:I("labels.actions")}),M("div",{className:"buttonList",children:[!o.editor.isMobile&&n("duplicateSelection"),!o.editor.isMobile&&n("deleteSelectedElements"),n("group"),n("ungroup"),u&&n("hyperlink")]})]})]})},rU=({activeTool:t,appState:e,app:n,UIOptions:r})=>{const[i,s]=A.useState(!1),o=t.type==="frame",a=t.type==="laser",l=t.type==="embeddable",{TTDDialogTriggerTunnel:c}=Nr();return M(ge,{children:[$B.map(({value:u,icon:d,key:h,numericKey:f,fillable:p},m)=>{var _;if(((_=r.tools)==null?void 0:_[u])===!1)return null;const v=I(`toolBar.${u}`),y=h&&$g(typeof h=="string"?h:h[0]),b=y?`${y} ${I("helpDialog.or")} ${f}`:`${f}`;return g(st,{className:Ee("Shape",{fillable:p}),type:"radio",icon:d,checked:t.type===u,name:"editor-current-shape",title:`${$g(v)} — ${b}`,keyBindingLabel:f||y,"aria-label":$g(v),"aria-keyshortcuts":b,"data-testid":`toolbar-${u}`,onPointerDown:({pointerType:E})=>{!e.penDetected&&E==="pen"&&n.togglePenMode(!0)},onChange:({pointerType:E})=>{e.activeTool.type!==u&&at("toolbar",u,"ui"),u==="image"?n.setActiveTool({type:u,insertOnCanvasDirectly:E!=="mouse"}):n.setActiveTool({type:u})}},u)}),g("div",{className:"App-toolbar__divider"}),M(it,{open:i,children:[g(it.Trigger,{className:Ee("App-toolbar__extra-tools-trigger",{"App-toolbar__extra-tools-trigger--selected":o||l||a&&!n.props.isCollaborating}),onToggle:()=>s(!i),title:I("toolBar.extraTools"),children:Bte}),M(it.Content,{onClickOutside:()=>s(!1),onSelect:()=>s(!1),className:"App-toolbar__extra-tools-dropdown",children:[g(it.Item,{onSelect:()=>n.setActiveTool({type:"frame"}),icon:Ute,shortcut:z.F.toLocaleUpperCase(),"data-testid":"toolbar-frame",selected:o,children:I("toolBar.frame")}),g(it.Item,{onSelect:()=>n.setActiveTool({type:"embeddable"}),icon:gee,"data-testid":"toolbar-embeddable",selected:l,children:I("toolBar.embeddable")}),g(it.Item,{onSelect:()=>n.setActiveTool({type:"laser"}),icon:QO,"data-testid":"toolbar-laser",selected:a,shortcut:z.K.toLocaleUpperCase(),children:I("toolBar.laser")}),g("div",{style:{margin:"6px 0",fontSize:14,fontWeight:600},children:"Generate"}),n.props.aiEnabled!==!1&&g(c.Out,{}),g(it.Item,{onSelect:()=>n.setOpenDialog({name:"ttd",tab:"mermaid"}),icon:$te,"data-testid":"toolbar-embeddable",children:I("toolBar.mermaidToExcalidraw")}),n.props.aiEnabled!==!1&&M(ge,{children:[M(it.Item,{onSelect:()=>n.onMagicframeToolSelect(),icon:vS,"data-testid":"toolbar-magicframe",children:[I("toolBar.magicframe"),g(it.Item.Badge,{children:"AI"})]}),g(it.Item,{onSelect:()=>{at("ai","open-settings","d2c"),n.setOpenDialog({name:"settings",source:"settings",tab:"diagram-to-code"})},icon:wx,"data-testid":"toolbar-magicSettings",children:I("toolBar.magicSettings")})]})]})]})]})},bfe=({renderAction:t,zoom:e})=>g(Ii.Col,{gap:1,className:"zoom-actions",children:M(Ii.Row,{align:"center",children:[t("zoomOut"),t("resetZoom"),t("zoomIn")]})}),_fe=({renderAction:t,className:e})=>M("div",{className:`undo-redo-buttons ${e}`,children:[g("div",{className:"undo-button-container",children:g(El,{label:I("buttons.undo"),children:t("undo")})}),g("div",{className:"redo-button-container",children:M(El,{label:I("buttons.redo"),children:[" ",t("redo")]})})]}),Efe=({actionManager:t,showExitZenModeBtn:e})=>g("button",{className:Ee("disable-zen-mode",{"disable-zen-mode--visible":e}),onClick:()=>t.executeAction(f3),children:I("buttons.exitZenMode")}),wfe=({renderAction:t,className:e})=>g("div",{className:`finalize-button ${e}`,children:t("finalize",{size:"small"})}),xfe=function({onChange:t,value:e,choices:n,name:r}){return g("div",{className:"RadioGroup",children:n.map(i=>M("div",{className:Ee("RadioGroup__choice",{active:i.value===e}),children:[g("input",{name:r,type:"radio",checked:i.value===e,onChange:()=>t(i.value)}),i.label]},i.label))})},yg=({title:t,name:e,checked:n,onChange:r,disabled:i=!1})=>g("div",{className:Ee("Switch",{toggled:n,disabled:i}),children:g("input",{name:e,id:e,title:t,type:"checkbox",checked:n,disabled:i,onChange:()=>r(!n),onKeyDown:s=>{s.key===" "&&r(!n)}})}),us=A.forwardRef(({children:t,startIcon:e,onClick:n,label:r,variant:i="filled",color:s="primary",size:o="medium",fullWidth:a,className:l},c)=>M("button",{className:Ee("ExcButton",`ExcButton--color-${s}`,`ExcButton--variant-${i}`,`ExcButton--size-${o}`,{"ExcButton--fullWidth":a},l),onClick:n,type:"button","aria-label":r,ref:c,children:[e&&g("div",{className:"ExcButton__icon","aria-hidden":!0,children:e}),i!=="icon"&&(t??r)]})),Tfe="filter"in document.createElement("canvas").getContext("2d"),Sfe=()=>M("div",{children:[g("h3",{children:I("canvasError.cannotShowPreview")}),g("p",{children:g("span",{children:I("canvasError.canvasTooBig")})}),M("em",{children:["(",I("canvasError.canvasTooBigTip"),")"]})]}),Cfe=({appStateSnapshot:t,elementsSnapshot:e,files:n,actionManager:r,onExportImage:i})=>{const s=wn(e,t),o=M2(),[a,l]=A.useState(t.name),[c,u]=A.useState(s),[d,h]=A.useState(t.exportBackground),[f,p]=A.useState(t.exportWithDarkMode),[m,v]=A.useState(t.exportEmbedScene),[y,b]=A.useState(t.exportScale),_=A.useRef(null),[E,w]=A.useState(null),{exportedElements:x,exportingFrame:T}=S2(e,t,c);return A.useEffect(()=>{const C=_.current;if(!C)return;const k=C.offsetWidth,L=C.offsetHeight;k&&b2({elements:x,appState:{...t,name:a,exportBackground:d,exportWithDarkMode:f,exportScale:y,exportEmbedScene:m},files:n,exportPadding:oh,maxWidthOrHeight:Math.max(k,L),exportingFrame:T}).then(F=>(w(null),sm(F).then(()=>{C.replaceChildren(F)}))).catch(F=>{console.error(F),w(F)})},[t,n,x,T,a,d,f,y,m]),M("div",{className:"ImageExportModal",children:[g("h3",{children:I("imageExportDialog.header")}),M("div",{className:"ImageExportModal__preview",children:[g("div",{className:"ImageExportModal__preview__canvas",ref:_,children:E&&g(Sfe,{})}),g("div",{className:"ImageExportModal__preview__filename",children:!pu&&g("input",{type:"text",className:"TextInput",value:a,style:{width:"30ch"},disabled:typeof o.name<"u"||t.viewModeEnabled,onChange:C=>{l(C.target.value),r.executeAction(lhe,"ui",C.target.value)}})})]}),M("div",{className:"ImageExportModal__settings",children:[g("h3",{children:I("imageExportDialog.header")}),s&&g(rf,{label:I("imageExportDialog.label.onlySelected"),name:"exportOnlySelected",children:g(yg,{name:"exportOnlySelected",checked:c,onChange:C=>{u(C)}})}),g(rf,{label:I("imageExportDialog.label.withBackground"),name:"exportBackgroundSwitch",children:g(yg,{name:"exportBackgroundSwitch",checked:d,onChange:C=>{h(C),r.executeAction(uhe,"ui",C)}})}),Tfe&&g(rf,{label:I("imageExportDialog.label.darkMode"),name:"exportDarkModeSwitch",children:g(yg,{name:"exportDarkModeSwitch",checked:f,onChange:C=>{p(C),r.executeAction(dhe,"ui",C)}})}),g(rf,{label:I("imageExportDialog.label.embedScene"),tooltip:I("imageExportDialog.tooltip.embedScene"),name:"exportEmbedSwitch",children:g(yg,{name:"exportEmbedSwitch",checked:m,onChange:C=>{v(C),r.executeAction(RB,"ui",C)}})}),g(rf,{label:I("imageExportDialog.label.scale"),name:"exportScale",children:g(xfe,{name:"exportScale",value:y,onChange:C=>{b(C),r.executeAction(che,"ui",C)},choices:LT.map(C=>({value:C,label:`${C}×`}))})}),M("div",{className:"ImageExportModal__settings__buttons",children:[g(us,{className:"ImageExportModal__settings__buttons__button",label:I("imageExportDialog.title.exportToPng"),onClick:()=>i(hb.png,x,{exportingFrame:T}),startIcon:LI,children:I("imageExportDialog.button.exportToPng")}),g(us,{className:"ImageExportModal__settings__buttons__button",label:I("imageExportDialog.title.exportToSvg"),onClick:()=>i(hb.svg,x,{exportingFrame:T}),startIcon:LI,children:I("imageExportDialog.button.exportToSvg")}),($S||Av)&&g(us,{className:"ImageExportModal__settings__buttons__button",label:I("imageExportDialog.title.copyPngToClipboard"),onClick:()=>i(hb.clipboard,x,{exportingFrame:T}),startIcon:Vv,children:I("imageExportDialog.button.copyPngToClipboard")})]})]})]})},rf=({label:t,children:e,tooltip:n,name:r})=>M("div",{className:"ImageExportModal__settings__setting",title:t,children:[M("label",{htmlFor:r,className:"ImageExportModal__settings__setting__label",children:[t,n&&g(El,{label:n,long:!0,children:Rte})]}),g("div",{className:"ImageExportModal__settings__setting__content",children:e})]}),Ife=({elements:t,appState:e,files:n,actionManager:r,onExportImage:i,onCloseRequest:s})=>{const[{appStateSnapshot:o,elementsSnapshot:a}]=A.useState(()=>({appStateSnapshot:Hc(e),elementsSnapshot:Hc(t)}));return g(yi,{onCloseRequest:s,size:"wide",title:!1,children:g(Cfe,{elementsSnapshot:a,appStateSnapshot:o,files:n,actionManager:r,onExportImage:i})})},iU=({children:t,side:e,className:n})=>g("div",{className:Ee("FixedSideContainer",`FixedSideContainer_side_${e}`,n),children:t}),Afe=({appState:t,isMobile:e,device:n,app:r})=>{var u;const{activeTool:i,isResizing:s,isRotating:o,lastPointerDownWith:a}=t,l=t.multiElement!==null;if(t.openSidebar&&!n.editor.canFitSidebar)return null;if(pc(t))return I("hints.eraserRevert");if(i.type==="arrow"||i.type==="line")return I(l?"hints.linearElementMulti":"hints.linearElement");if(i.type==="freedraw")return I("hints.freeDraw");if(i.type==="text")return I("hints.text");if(i.type==="embeddable")return I("hints.embeddable");if(t.activeTool.type==="image"&&t.pendingImageElementId)return I("hints.placeImage");const c=r.scene.getSelectedElements(t);if(s&&a==="mouse"&&c.length===1){const d=c[0];return Je(d)&&d.points.length===2?I("hints.lockAngle"):Wo(d)?I("hints.resizeImage"):I("hints.resize")}if(o&&a==="mouse")return I("hints.rotate");if(c.length===1&&Se(c[0]))return I("hints.text_selected");if(t.editingElement&&Se(t.editingElement))return I("hints.text_editing");if(i.type==="selection"){if(((u=t.draggingElement)==null?void 0:u.type)==="selection"&&!c.length&&!t.editingElement&&!t.editingLinearElement)return I("hints.deepBoxSelect");if(t.gridSize&&t.draggingElement)return I("hints.disableSnapping");if(!c.length&&!e)return I("hints.canvasPanning");if(c.length===1){if(Je(c[0]))return t.editingLinearElement?t.editingLinearElement.selectedPointsIndices?I("hints.lineEditor_pointSelected"):I("hints.lineEditor_nothingSelected"):I("hints.lineEditor_info");if(!t.draggingElement&&Lc(c[0]))return I("hints.bindTextToElement")}}return null},sU=({appState:t,isMobile:e,device:n,app:r})=>{let i=Afe({appState:t,isMobile:e,device:n,app:r});return i?(i=re(i),g("div",{className:"HintViewer",children:g("span",{children:i})})):null},oU=({delay:t,theme:e})=>{const[n,r]=A.useState(!!t);return A.useEffect(()=>{if(!t)return;const i=setTimeout(()=>{r(!1)},t);return()=>clearTimeout(i)},[t]),n?null:M("div",{className:Ee("LoadingMessage",{"LoadingMessage--dark":e===Vn.DARK}),children:[g("div",{children:g(_l,{})}),g("div",{className:"LoadingMessage-text",children:I("labels.loadingScene")})]})},kfe="medium",W8={CHECKED:eee,UNCHECKED:QQ},aU=t=>M("label",{className:Ee("ToolIcon ToolIcon__lock",`ToolIcon_size_${kfe}`,{"is-mobile":t.isMobile}),title:`${t.title} — Q`,children:[g("input",{className:"ToolIcon_type_checkbox",type:"checkbox",name:t.name,onChange:t.onChange,checked:t.checked,"aria-label":t.title,"data-testid":"toolbar-lock"}),g("div",{className:"ToolIcon__icon",children:t.checked?W8.CHECKED:W8.UNCHECKED})]}),ym=({heading:t,children:e,...n})=>{const{id:r}=pa(),i=g("h2",{className:"visually-hidden",id:`${r}-${t}-title`,children:I(`headings.${t}`)});return g("section",{...n,"aria-labelledby":`${r}-${t}-title`,children:typeof e=="function"?e(i):M(ge,{children:[i,e]})})},Mfe="medium",lU=t=>t.penDetected?M("label",{className:Ee("ToolIcon ToolIcon__penMode",`ToolIcon_size_${Mfe}`,{"is-mobile":t.isMobile}),title:`${t.title}`,children:[g("input",{className:"ToolIcon_type_checkbox",type:"checkbox",name:t.name,onChange:t.onChange,checked:t.checked,"aria-label":t.title}),g("div",{className:"ToolIcon__icon",children:uee})]}):null,cU=t=>{var i;const e=Ut(t.elements),n=d4(t.elements,t.appState),r=Ut(n);return g("div",{className:"Stats",children:M(lo,{padding:2,children:[g("div",{className:"close",onClick:t.onClose,children:hh}),g("h3",{children:I("stats.title")}),g("table",{children:M("tbody",{children:[g("tr",{children:g("th",{colSpan:2,children:I("stats.scene")})}),M("tr",{children:[g("td",{children:I("stats.elements")}),g("td",{children:t.elements.length})]}),M("tr",{children:[g("td",{children:I("stats.width")}),g("td",{children:Math.round(e[2])-Math.round(e[0])})]}),M("tr",{children:[g("td",{children:I("stats.height")}),g("td",{children:Math.round(e[3])-Math.round(e[1])})]}),n.length===1&&g("tr",{children:g("th",{colSpan:2,children:I("stats.element")})}),n.length>1&&M(ge,{children:[g("tr",{children:g("th",{colSpan:2,children:I("stats.selected")})}),M("tr",{children:[g("td",{children:I("stats.elements")}),g("td",{children:n.length})]})]}),n.length>0&&M(ge,{children:[M("tr",{children:[g("td",{children:"x"}),g("td",{children:Math.round(r[0])})]}),M("tr",{children:[g("td",{children:"y"}),g("td",{children:Math.round(r[1])})]}),M("tr",{children:[g("td",{children:I("stats.width")}),g("td",{children:Math.round(r[2]-r[0])})]}),M("tr",{children:[g("td",{children:I("stats.height")}),g("td",{children:Math.round(r[3]-r[1])})]})]}),n.length===1&&M("tr",{children:[g("td",{children:I("stats.angle")}),g("td",{children:`${Math.round(n[0].angle*180/Math.PI)}°`})]}),(i=t.renderCustomStats)==null?void 0:i.call(t,t.elements,t.appState)]})})]})})},uU=t=>g(st,{className:Ee("Shape",{fillable:!1}),type:"radio",icon:Lte,name:"editor-current-shape",checked:t.checked,title:`${t.title} — H`,keyBindingLabel:t.isMobile?void 0:z.H.toLocaleUpperCase(),"aria-label":`${t.title} — H`,"aria-keyshortcuts":z.H,"data-testid":"toolbar-hand",onChange:()=>{var e;return(e=t.onChange)==null?void 0:e.call(t)}}),Pfe=({appState:t,elements:e,actionManager:n,setAppState:r,onLockToggle:i,onHandToolToggle:s,onPenModeToggle:o,renderTopRightUI:a,renderCustomStats:l,renderSidebars:c,device:u,renderWelcomeScreen:d,UIOptions:h,app:f})=>{const{WelcomeScreenCenterTunnel:p,MainMenuTunnel:m,DefaultSidebarTriggerTunnel:v}=Nr(),y=()=>M(iU,{side:"top",className:"App-top-bar",children:[d&&g(p.Out,{}),g(ym,{heading:"shapes",children:_=>g(Ii.Col,{gap:4,align:"center",children:M(Ii.Row,{gap:1,className:"App-toolbar-container",children:[M(lo,{padding:1,className:"App-toolbar App-toolbar--mobile",children:[_,g(Ii.Row,{gap:1,children:g(rU,{appState:t,activeTool:t.activeTool,UIOptions:h,app:f})})]}),a&&a(!0,t),M("div",{className:"mobile-misc-tools-container",children:[!t.viewModeEnabled&&g(v.Out,{}),g(lU,{checked:t.penMode,onChange:()=>o(null),title:I("toolBar.penMode"),isMobile:!0,penDetected:t.penDetected}),g(aU,{checked:t.activeTool.locked,onChange:i,title:I("toolBar.lock"),isMobile:!0}),g(uU,{checked:Gd(t),onChange:()=>s(),title:I("toolBar.hand"),isMobile:!0})]})]})})}),g(sU,{appState:t,isMobile:!0,device:u,app:f})]}),b=()=>t.viewModeEnabled?g("div",{className:"App-toolbar-content",children:g(m.Out,{})}):M("div",{className:"App-toolbar-content",children:[g(m.Out,{}),n.renderAction("toggleEditMenu"),n.renderAction("undo"),n.renderAction("redo"),n.renderAction(t.multiElement?"finalize":"duplicateSelection"),n.renderAction("deleteSelectedElements")]});return M(ge,{children:[c(),!t.viewModeEnabled&&y(),!t.openMenu&&t.showStats&&g(cU,{appState:t,setAppState:r,elements:e,onClose:()=>{n.executeAction(qy)},renderCustomStats:l}),g("div",{className:"App-bottom-bar",style:{marginBottom:Ya+Ys*2,marginLeft:Ya+Ys*2,marginRight:Ya+Ys*2},children:M(lo,{padding:0,children:[t.openMenu==="shape"&&!t.viewModeEnabled&&g4(t,e)?g(ym,{className:"App-mobile-menu",heading:"selectedShapeActions",children:g(nU,{appState:t,elements:e,renderAction:n.renderAction})}):null,M("footer",{className:"App-toolbar",children:[b(),t.scrolledOutside&&!t.openMenu&&!t.openSidebar&&g("button",{className:"scroll-back-to-content",onClick:()=>{r(_=>({...nm(e,_)}))},children:I("buttons.scrollBackToContent")})]})]})})]})},j8=t=>{const e=A.useRef(null),[n,r]=A.useState(null);return A.useLayoutEffect(()=>{if(!t.spreadsheet)return;const i=noe(t.chartType,t.spreadsheet,0,0);r(i);let s;const o=e.current;return(async()=>{var a;s=await KS(i,{exportBackground:!1,viewBackgroundColor:Jt.white},null),(a=s.querySelector(".style-fonts"))==null||a.remove(),o.replaceChildren(),o.appendChild(s),t.selected&&o.parentNode.focus()})(),()=>{o.replaceChildren()}},[t.spreadsheet,t.chartType,t.selected]),g("button",{className:"ChartPreview",onClick:()=>{n&&t.onClick(t.chartType,n)},children:g("div",{ref:e})})},Lfe=({setAppState:t,appState:e,onClose:n})=>{const{onInsertElements:r}=Sh(),i=ce.useCallback(()=>{n&&n()},[n]),s=(o,a)=>{r(a),at("paste","chart",o),t({currentChartType:o,pasteDialog:{shown:!1,data:null}})};return g(yi,{size:"small",onCloseRequest:i,title:I("labels.pasteCharts"),className:"PasteChartDialog",autofocus:!1,children:M("div",{className:"container",children:[g(j8,{chartType:"bar",spreadsheet:e.pasteDialog.data,selected:e.currentChartType==="bar",onClick:s}),g(j8,{chartType:"line",spreadsheet:e.pasteDialog.data,selected:e.currentChartType==="line",onClick:s})]})})},Rfe=()=>M("div",{className:"HelpDialog__header",children:[M("a",{className:"HelpDialog__btn",href:"https://docs.excalidraw.com",target:"_blank",rel:"noopener noreferrer",children:[I("helpDialog.documentation"),g("div",{className:"HelpDialog__link-icon",children:i_})]}),M("a",{className:"HelpDialog__btn",href:"https://blog.excalidraw.com",target:"_blank",rel:"noopener noreferrer",children:[I("helpDialog.blog"),g("div",{className:"HelpDialog__link-icon",children:i_})]}),M("a",{className:"HelpDialog__btn",href:"https://github.com/excalidraw/excalidraw/issues",target:"_blank",rel:"noopener noreferrer",children:[I("helpDialog.github"),g("div",{className:"HelpDialog__link-icon",children:i_})]})]}),Ofe=t=>M(ge,{children:[g("h3",{children:t.title}),g("div",{className:"HelpDialog__islands-container",children:t.children})]}),X_=t=>M("div",{className:`HelpDialog__island ${t.className}`,children:[g("h4",{className:"HelpDialog__island-title",children:t.caption}),g("div",{className:"HelpDialog__island-content",children:t.children})]});function*Dfe(t,e){let n=!0;for(const r of t)n||(yield e),n=!1,yield r}const Nfe=t=>t.replace(/\b[a-z]\b/,e=>e.toUpperCase()),ve=({label:t,shortcuts:e,isOr:n=!0})=>{const r=e.map(i=>(i.endsWith("++")?[...i.slice(0,-2).split("+"),"+"]:i.split("+")).map(o=>g(Ffe,{children:Nfe(o)},o)));return M("div",{className:"HelpDialog__shortcut",children:[g("div",{children:t}),g("div",{className:"HelpDialog__key-container",children:[...Dfe(r,n?I("helpDialog.or"):null)]})]})},Ffe=t=>g("kbd",{className:"HelpDialog__key",...t}),Bfe=({onClose:t})=>{const e=ce.useCallback(()=>{t&&t()},[t]);return g(ge,{children:M(yi,{onCloseRequest:e,title:I("helpDialog.title"),className:"HelpDialog",children:[g(Rfe,{}),M(Ofe,{title:I("helpDialog.shortcuts"),children:[M(X_,{className:"HelpDialog__island--tools",caption:I("helpDialog.tools"),children:[g(ve,{label:I("toolBar.hand"),shortcuts:[z.H]}),g(ve,{label:I("toolBar.selection"),shortcuts:[z.V,z[1]]}),g(ve,{label:I("toolBar.rectangle"),shortcuts:[z.R,z[2]]}),g(ve,{label:I("toolBar.diamond"),shortcuts:[z.D,z[3]]}),g(ve,{label:I("toolBar.ellipse"),shortcuts:[z.O,z[4]]}),g(ve,{label:I("toolBar.arrow"),shortcuts:[z.A,z[5]]}),g(ve,{label:I("toolBar.line"),shortcuts:[z.L,z[6]]}),g(ve,{label:I("toolBar.freedraw"),shortcuts:[z.P,z[7]]}),g(ve,{label:I("toolBar.text"),shortcuts:[z.T,z[8]]}),g(ve,{label:I("toolBar.image"),shortcuts:[z[9]]}),g(ve,{label:I("toolBar.eraser"),shortcuts:[z.E,z[0]]}),g(ve,{label:I("toolBar.frame"),shortcuts:[z.F]}),g(ve,{label:I("toolBar.laser"),shortcuts:[z.K]}),g(ve,{label:I("labels.eyeDropper"),shortcuts:[z.I,"Shift+S","Shift+G"]}),g(ve,{label:I("helpDialog.editLineArrowPoints"),shortcuts:[re("CtrlOrCmd+Enter")]}),g(ve,{label:I("helpDialog.editText"),shortcuts:[re("Enter")]}),g(ve,{label:I("helpDialog.textNewLine"),shortcuts:[re("Enter"),re("Shift+Enter")]}),g(ve,{label:I("helpDialog.textFinish"),shortcuts:[re("Esc"),re("CtrlOrCmd+Enter")]}),g(ve,{label:I("helpDialog.curvedArrow"),shortcuts:["A",I("helpDialog.click"),I("helpDialog.click"),I("helpDialog.click")],isOr:!1}),g(ve,{label:I("helpDialog.curvedLine"),shortcuts:["L",I("helpDialog.click"),I("helpDialog.click"),I("helpDialog.click")],isOr:!1}),g(ve,{label:I("toolBar.lock"),shortcuts:[z.Q]}),g(ve,{label:I("helpDialog.preventBinding"),shortcuts:[re("CtrlOrCmd")]}),g(ve,{label:I("toolBar.link"),shortcuts:[re("CtrlOrCmd+K")]})]}),M(X_,{className:"HelpDialog__island--view",caption:I("helpDialog.view"),children:[g(ve,{label:I("buttons.zoomIn"),shortcuts:[re("CtrlOrCmd++")]}),g(ve,{label:I("buttons.zoomOut"),shortcuts:[re("CtrlOrCmd+-")]}),g(ve,{label:I("buttons.resetZoom"),shortcuts:[re("CtrlOrCmd+0")]}),g(ve,{label:I("helpDialog.zoomToFit"),shortcuts:["Shift+1"]}),g(ve,{label:I("helpDialog.zoomToSelection"),shortcuts:["Shift+2"]}),g(ve,{label:I("helpDialog.movePageUpDown"),shortcuts:["PgUp/PgDn"]}),g(ve,{label:I("helpDialog.movePageLeftRight"),shortcuts:["Shift+PgUp/PgDn"]}),g(ve,{label:I("buttons.zenMode"),shortcuts:[re("Alt+Z")]}),g(ve,{label:I("buttons.objectsSnapMode"),shortcuts:[re("Alt+S")]}),g(ve,{label:I("labels.showGrid"),shortcuts:[re("CtrlOrCmd+'")]}),g(ve,{label:I("labels.viewMode"),shortcuts:[re("Alt+R")]}),g(ve,{label:I("labels.toggleTheme"),shortcuts:[re("Alt+Shift+D")]}),g(ve,{label:I("stats.title"),shortcuts:[re("Alt+/")]})]}),M(X_,{className:"HelpDialog__island--editor",caption:I("helpDialog.editor"),children:[g(ve,{label:I("labels.moveCanvas"),shortcuts:[re(`Space+${I("helpDialog.drag")}`),re(`Wheel+${I("helpDialog.drag")}`)],isOr:!0}),g(ve,{label:I("buttons.clearReset"),shortcuts:[re("CtrlOrCmd+Delete")]}),g(ve,{label:I("labels.delete"),shortcuts:[re("Delete")]}),g(ve,{label:I("labels.cut"),shortcuts:[re("CtrlOrCmd+X")]}),g(ve,{label:I("labels.copy"),shortcuts:[re("CtrlOrCmd+C")]}),g(ve,{label:I("labels.paste"),shortcuts:[re("CtrlOrCmd+V")]}),g(ve,{label:I("labels.pasteAsPlaintext"),shortcuts:[re("CtrlOrCmd+Shift+V")]}),g(ve,{label:I("labels.selectAll"),shortcuts:[re("CtrlOrCmd+A")]}),g(ve,{label:I("labels.multiSelect"),shortcuts:[re(`Shift+${I("helpDialog.click")}`)]}),g(ve,{label:I("helpDialog.deepSelect"),shortcuts:[re(`CtrlOrCmd+${I("helpDialog.click")}`)]}),g(ve,{label:I("helpDialog.deepBoxSelect"),shortcuts:[re(`CtrlOrCmd+${I("helpDialog.drag")}`)]}),($S||Av)&&g(ve,{label:I("labels.copyAsPng"),shortcuts:[re("Shift+Alt+C")]}),g(ve,{label:I("labels.copyStyles"),shortcuts:[re("CtrlOrCmd+Alt+C")]}),g(ve,{label:I("labels.pasteStyles"),shortcuts:[re("CtrlOrCmd+Alt+V")]}),g(ve,{label:I("labels.sendToBack"),shortcuts:[re(uo?"CtrlOrCmd+Alt+[":"CtrlOrCmd+Shift+[")]}),g(ve,{label:I("labels.bringToFront"),shortcuts:[re(uo?"CtrlOrCmd+Alt+]":"CtrlOrCmd+Shift+]")]}),g(ve,{label:I("labels.sendBackward"),shortcuts:[re("CtrlOrCmd+[")]}),g(ve,{label:I("labels.bringForward"),shortcuts:[re("CtrlOrCmd+]")]}),g(ve,{label:I("labels.alignTop"),shortcuts:[re("CtrlOrCmd+Shift+Up")]}),g(ve,{label:I("labels.alignBottom"),shortcuts:[re("CtrlOrCmd+Shift+Down")]}),g(ve,{label:I("labels.alignLeft"),shortcuts:[re("CtrlOrCmd+Shift+Left")]}),g(ve,{label:I("labels.alignRight"),shortcuts:[re("CtrlOrCmd+Shift+Right")]}),g(ve,{label:I("labels.duplicateSelection"),shortcuts:[re("CtrlOrCmd+D"),re(`Alt+${I("helpDialog.drag")}`)]}),g(ve,{label:I("helpDialog.toggleElementLock"),shortcuts:[re("CtrlOrCmd+Shift+L")]}),g(ve,{label:I("buttons.undo"),shortcuts:[re("CtrlOrCmd+Z")]}),g(ve,{label:I("buttons.redo"),shortcuts:f7?[re("CtrlOrCmd+Y"),re("CtrlOrCmd+Shift+Z")]:[re("CtrlOrCmd+Shift+Z")]}),g(ve,{label:I("labels.group"),shortcuts:[re("CtrlOrCmd+G")]}),g(ve,{label:I("labels.ungroup"),shortcuts:[re("CtrlOrCmd+Shift+G")]}),g(ve,{label:I("labels.flipHorizontal"),shortcuts:[re("Shift+H")]}),g(ve,{label:I("labels.flipVertical"),shortcuts:[re("Shift+V")]}),g(ve,{label:I("labels.showStroke"),shortcuts:[re("S")]}),g(ve,{label:I("labels.showBackground"),shortcuts:[re("G")]}),g(ve,{label:I("labels.decreaseFontSize"),shortcuts:[re("CtrlOrCmd+Shift+<")]}),g(ve,{label:I("labels.increaseFontSize"),shortcuts:[re("CtrlOrCmd+Shift+>")]})]})]})]})})},Y_=3,Ufe=8,$fe=({shouldWrap:t,children:e,clientId:n,username:r})=>t?g(El,{label:r||"Unknown user",children:e},n):g(ce.Fragment,{children:e},n),Z_=({actionManager:t,collaborator:e,clientId:n,withName:r=!1,shouldWrapWithTooltip:i=!1,isBeingFollowed:s})=>{const o={clientId:n,collaborator:e,withName:r,isBeingFollowed:s},a=t.renderAction("goToCollaborator",o);return g($fe,{clientId:n,username:e.username,shouldWrap:i,children:a},n)},Hfe=["avatarUrl","id","socketId","username"],dU=ce.memo(({className:t,mobile:e,collaborators:n,userToFollow:r})=>{const i=$i(),s=new Map;n.forEach((f,p)=>{const m=f.id||p;s.set(m,{...f,socketId:p})});const o=Array.from(s).filter(([f,p])=>{var m;return(m=p.username)==null?void 0:m.trim()}),[a,l]=ce.useState("");if(o.length===0)return null;const u=a.trim().toLowerCase()?o.filter(([,f])=>{var p;return(p=f.username)==null?void 0:p.toLowerCase().includes(a)}):o,h=o.slice(0,Y_).map(([f,p])=>Z_({actionManager:i,collaborator:p,clientId:f,shouldWrapWithTooltip:!0,isBeingFollowed:p.socketId===r}));return e?g("div",{className:Ee("UserList UserList_mobile",t),children:o.map(([f,p])=>Z_({actionManager:i,collaborator:p,clientId:f,shouldWrapWithTooltip:!0,isBeingFollowed:p.socketId===r}))}):M("div",{className:Ee("UserList",t),children:[h,o.length>Y_&&M(r2,{onOpenChange:f=>{f||l("")},children:[M(i2,{className:"UserList__more",children:["+",o.length-Y_]}),g(s2,{style:{zIndex:2,width:"13rem",textAlign:"left"},align:"end",sideOffset:10,children:M(lo,{style:{overflow:"hidden"},children:[o.length>=Ufe&&M("div",{className:"UserList__search-wrapper",children:[Vte,g("input",{className:"UserList__search",type:"text",placeholder:I("userList.search.placeholder"),value:a,onChange:f=>{l(f.target.value)}})]}),M("div",{className:"dropdown-menu UserList__collaborators",children:[u.length===0&&g("div",{className:"UserList__collaborators__empty",children:I("userList.search.empty")}),g("div",{className:"UserList__hint",children:I("userList.hint.text")}),u.map(([f,p])=>Z_({actionManager:i,collaborator:p,clientId:f,withName:!0,isBeingFollowed:p.socketId===r}))]})]})})]})]})},(t,e)=>{if(t.collaborators.size!==e.collaborators.size||t.mobile!==e.mobile||t.className!==e.className||t.userToFollow!==e.userToFollow)return!1;for(const[n,r]of t.collaborators){const i=e.collaborators.get(n);if(!i||!Pr(r,i,Hfe))return!1}return!0}),p3=({children:t,color:e})=>g("div",{className:"Card",style:{"--card-color":e==="primary"?"var(--color-primary)":Jt[e][7],"--card-color-darker":e==="primary"?"var(--color-primary-darker)":Jt[e][8],"--card-color-darkest":e==="primary"?"var(--color-primary-darkest)":Jt[e][9]},children:t}),zfe=({elements:t,appState:e,setAppState:n,files:r,actionManager:i,exportOpts:s,canvas:o,onCloseRequest:a})=>{const{onExportToBackend:l}=s;return g("div",{className:"ExportDialog ExportDialog--json",children:M("div",{className:"ExportDialog-cards",children:[s.saveFileToDisk&&M(p3,{color:"lime",children:[g("div",{className:"Card-icon",children:Aee}),g("h2",{children:I("exportDialog.disk_title")}),M("div",{className:"Card-details",children:[I("exportDialog.disk_details"),!pu&&i.renderAction("changeProjectName")]}),g(st,{className:"Card-button",type:"button",title:I("exportDialog.disk_button"),"aria-label":I("exportDialog.disk_button"),showAriaLabel:!0,onClick:()=>{i.executeAction(OB,"ui")}})]}),l&&M(p3,{color:"pink",children:[g("div",{className:"Card-icon",children:KO}),g("h2",{children:I("exportDialog.link_title")}),g("div",{className:"Card-details",children:I("exportDialog.link_details")}),g(st,{className:"Card-button",type:"button",title:I("exportDialog.link_button"),"aria-label":I("exportDialog.link_button"),showAriaLabel:!0,onClick:async()=>{try{at("export","link",`ui (${Pm()})`),await l(t,e,r,o),a()}catch(c){n({errorMessage:c.message})}}})]}),s.renderCustomUI&&s.renderCustomUI(t,e,r,o)]})})},Gfe=({elements:t,appState:e,files:n,actionManager:r,exportOpts:i,canvas:s,setAppState:o})=>{var l;const a=ce.useCallback(()=>{o({openDialog:null})},[o]);return g(ge,{children:((l=e.openDialog)==null?void 0:l.name)==="jsonExport"&&g(yi,{onCloseRequest:a,title:I("buttons.export"),children:g(zfe,{elements:t,appState:e,setAppState:o,files:n,actionManager:r,onCloseRequest:a,exportOpts:i,canvas:s})})})},Vfe=t=>g("button",{className:"help-icon",onClick:t.onClick,type:"button",title:`${I("helpDialog.title")} — ?`,"aria-label":I("helpDialog.title"),children:mS}),hU=({appState:t,actionManager:e,showExitZenModeBtn:n,renderWelcomeScreen:r})=>{const{FooterCenterTunnel:i,WelcomeScreenHelpHintTunnel:s}=Nr(),o=_r(),a=!t.viewModeEnabled&&t.multiElement&&o.isTouchScreen;return M("footer",{role:"contentinfo",className:"layer-ui__wrapper__footer App-menu App-menu_bottom",children:[g("div",{className:Ee("layer-ui__wrapper__footer-left zen-mode-transition",{"layer-ui__wrapper__footer-left--transition-left":t.zenModeEnabled}),children:g(Ii.Col,{gap:2,children:M(ym,{heading:"canvasActions",children:[g(bfe,{renderAction:e.renderAction,zoom:t.zoom}),!t.viewModeEnabled&&g(_fe,{renderAction:e.renderAction,className:Ee("zen-mode-transition",{"layer-ui__wrapper__footer-left--transition-bottom":t.zenModeEnabled})}),a&&g(wfe,{renderAction:e.renderAction,className:Ee("zen-mode-transition",{"layer-ui__wrapper__footer-left--transition-left":t.zenModeEnabled})})]})})}),g(i.Out,{}),g("div",{className:Ee("layer-ui__wrapper__footer-right zen-mode-transition",{"transition-right":t.zenModeEnabled}),children:M("div",{style:{position:"relative"},children:[r&&g(s.Out,{}),g(Vfe,{onClick:()=>e.executeAction(v4)})]})}),g(Efe,{actionManager:e,showExitZenModeBtn:n})]})};hU.displayName="Footer";const fU=ce.createContext({}),vm=({type:t="button",onSelect:e,selected:n,children:r,className:i="",...s})=>g("button",{onClick:Lv(s.onClick,o=>{e()}),type:t,className:Ee("excalidraw-button",i,{selected:n}),...s,children:r}),pU=({children:t,className:e})=>{const n=_r(),r=A.useContext(fU),i=!!(n.editor.canFitSidebar&&r.shouldRenderDockButton);return M("div",{className:Ee("sidebar__header",e),"data-testid":"sidebar-header",children:[t,M("div",{className:"sidebar__header__buttons",children:[i&&g(El,{label:I("labels.sidebarLock"),children:g(vm,{onSelect:()=>{var s;return(s=r.onDock)==null?void 0:s.call(r,!r.docked)},selected:!!r.docked,className:"sidebar__dock","data-testid":"sidebar-dock","aria-label":I("labels.sidebarLock"),children:JQ})}),g(vm,{"data-testid":"sidebar-close",className:"sidebar__close",onSelect:r.onCloseRequest,"aria-label":I("buttons.close"),children:hh})]})]})};pU.displayName="SidebarHeader";const mU=({name:t,tab:e,icon:n,title:r,children:i,onToggle:s,className:o,style:a})=>{var u;const l=Fr(),c=br();return M("label",{title:r,className:"sidebar-trigger__label-element",children:[g("input",{className:"ToolIcon_type_checkbox",type:"checkbox",onChange:d=>{var f;(f=document.querySelector(".layer-ui__wrapper"))==null||f.classList.remove("animate");const h=d.target.checked;l({openSidebar:h?{name:t,tab:e}:null}),s==null||s(h)},checked:((u=c.openSidebar)==null?void 0:u.name)===t,"aria-label":r,"aria-keyshortcuts":"0"}),M("div",{className:Ee("sidebar-trigger",o),style:a,children:[n&&g("div",{children:n}),i&&g("div",{className:"sidebar-trigger__label",children:i})]})]})};mU.displayName="SidebarTrigger";function Wfe(t){const e=t+"CollectionProvider",[n,r]=Gm(e),[i,s]=n(e,{collectionRef:{current:null},itemMap:new Map}),o=f=>{const{scope:p,children:m}=f,v=ce.useRef(null),y=ce.useRef(new Map).current;return ce.createElement(i,{scope:p,itemMap:y,collectionRef:v},m)},a=t+"CollectionSlot",l=ce.forwardRef((f,p)=>{const{scope:m,children:v}=f,y=s(a,m),b=fo(p,y.collectionRef);return ce.createElement(Qp,{ref:b},v)}),c=t+"CollectionItemSlot",u="data-radix-collection-item",d=ce.forwardRef((f,p)=>{const{scope:m,children:v,...y}=f,b=ce.useRef(null),_=fo(p,b),E=s(c,m);return ce.useEffect(()=>(E.itemMap.set(b,{ref:b,...y}),()=>void E.itemMap.delete(b))),ce.createElement(Qp,{[u]:"",ref:_},v)});function h(f){const p=s(t+"CollectionConsumer",f);return ce.useCallback(()=>{const v=p.collectionRef.current;if(!v)return[];const y=Array.from(v.querySelectorAll(`[${u}]`));return Array.from(p.itemMap.values()).sort((E,w)=>y.indexOf(E.ref.current)-y.indexOf(w.ref.current))},[p.collectionRef,p.itemMap])}return[{Provider:o,Slot:l,ItemSlot:d},h,r]}const jfe=A.createContext(void 0);function gU(t){const e=A.useContext(jfe);return t||e||"ltr"}const K_="rovingFocusGroup.onEntryFocus",Xfe={bubbles:!1,cancelable:!0},b4="RovingFocusGroup",[m3,yU,Yfe]=Wfe(b4),[Zfe,vU]=Gm(b4,[Yfe]),[Kfe,qfe]=Zfe(b4),Jfe=A.forwardRef((t,e)=>A.createElement(m3.Provider,{scope:t.__scopeRovingFocusGroup},A.createElement(m3.Slot,{scope:t.__scopeRovingFocusGroup},A.createElement(Qfe,It({},t,{ref:e}))))),Qfe=A.forwardRef((t,e)=>{const{__scopeRovingFocusGroup:n,orientation:r,loop:i=!1,dir:s,currentTabStopId:o,defaultCurrentTabStopId:a,onCurrentTabStopIdChange:l,onEntryFocus:c,...u}=t,d=A.useRef(null),h=fo(e,d),f=gU(s),[p=null,m]=DS({prop:o,defaultProp:a,onChange:l}),[v,y]=A.useState(!1),b=ra(c),_=yU(n),E=A.useRef(!1),[w,x]=A.useState(0);return A.useEffect(()=>{const T=d.current;if(T)return T.addEventListener(K_,b),()=>T.removeEventListener(K_,b)},[b]),A.createElement(Kfe,{scope:n,orientation:r,dir:f,loop:i,currentTabStopId:p,onItemFocus:A.useCallback(T=>m(T),[m]),onItemShiftTab:A.useCallback(()=>y(!0),[]),onFocusableItemAdd:A.useCallback(()=>x(T=>T+1),[]),onFocusableItemRemove:A.useCallback(()=>x(T=>T-1),[])},A.createElement(Kr.div,It({tabIndex:v||w===0?-1:0,"data-orientation":r},u,{ref:h,style:{outline:"none",...t.style},onMouseDown:gr(t.onMouseDown,()=>{E.current=!0}),onFocus:gr(t.onFocus,T=>{const C=!E.current;if(T.target===T.currentTarget&&C&&!v){const k=new CustomEvent(K_,Xfe);if(T.currentTarget.dispatchEvent(k),!k.defaultPrevented){const L=_().filter(W=>W.focusable),F=L.find(W=>W.active),N=L.find(W=>W.id===p),H=[F,N,...L].filter(Boolean).map(W=>W.ref.current);bU(H)}}E.current=!1}),onBlur:gr(t.onBlur,()=>y(!1))})))}),epe="RovingFocusGroupItem",tpe=A.forwardRef((t,e)=>{const{__scopeRovingFocusGroup:n,focusable:r=!0,active:i=!1,tabStopId:s,...o}=t,a=PS(),l=s||a,c=qfe(epe,n),u=c.currentTabStopId===l,d=yU(n),{onFocusableItemAdd:h,onFocusableItemRemove:f}=c;return A.useEffect(()=>{if(r)return h(),()=>f()},[r,h,f]),A.createElement(m3.ItemSlot,{scope:n,id:l,focusable:r,active:i},A.createElement(Kr.span,It({tabIndex:u?0:-1,"data-orientation":c.orientation},o,{ref:e,onMouseDown:gr(t.onMouseDown,p=>{r?c.onItemFocus(l):p.preventDefault()}),onFocus:gr(t.onFocus,()=>c.onItemFocus(l)),onKeyDown:gr(t.onKeyDown,p=>{if(p.key==="Tab"&&p.shiftKey){c.onItemShiftTab();return}if(p.target!==p.currentTarget)return;const m=ipe(p,c.orientation,c.dir);if(m!==void 0){p.preventDefault();let y=d().filter(b=>b.focusable).map(b=>b.ref.current);if(m==="last")y.reverse();else if(m==="prev"||m==="next"){m==="prev"&&y.reverse();const b=y.indexOf(p.currentTarget);y=c.loop?spe(y,b+1):y.slice(b+1)}setTimeout(()=>bU(y))}})})))}),npe={ArrowLeft:"prev",ArrowUp:"prev",ArrowRight:"next",ArrowDown:"next",PageUp:"first",Home:"first",PageDown:"last",End:"last"};function rpe(t,e){return e!=="rtl"?t:t==="ArrowLeft"?"ArrowRight":t==="ArrowRight"?"ArrowLeft":t}function ipe(t,e,n){const r=rpe(t.key,n);if(!(e==="vertical"&&["ArrowLeft","ArrowRight"].includes(r))&&!(e==="horizontal"&&["ArrowUp","ArrowDown"].includes(r)))return npe[r]}function bU(t){const e=document.activeElement;for(const n of t)if(n===e||(n.focus(),document.activeElement!==e))return}function spe(t,e){return t.map((n,r)=>t[(e+r)%t.length])}const ope=Jfe,ape=tpe,_U="Tabs",[lpe,Lye]=Gm(_U,[vU]),EU=vU(),[cpe,_4]=lpe(_U),upe=A.forwardRef((t,e)=>{const{__scopeTabs:n,value:r,onValueChange:i,defaultValue:s,orientation:o="horizontal",dir:a,activationMode:l="automatic",...c}=t,u=gU(a),[d,h]=DS({prop:r,onChange:i,defaultProp:s});return A.createElement(cpe,{scope:n,baseId:PS(),value:d,onValueChange:h,orientation:o,dir:u,activationMode:l},A.createElement(Kr.div,It({dir:u,"data-orientation":o},c,{ref:e})))}),dpe="TabsList",hpe=A.forwardRef((t,e)=>{const{__scopeTabs:n,loop:r=!0,...i}=t,s=_4(dpe,n),o=EU(n);return A.createElement(ope,It({asChild:!0},o,{orientation:s.orientation,dir:s.dir,loop:r}),A.createElement(Kr.div,It({role:"tablist","aria-orientation":s.orientation},i,{ref:e})))}),fpe="TabsTrigger",ppe=A.forwardRef((t,e)=>{const{__scopeTabs:n,value:r,disabled:i=!1,...s}=t,o=_4(fpe,n),a=EU(n),l=wU(o.baseId,r),c=xU(o.baseId,r),u=r===o.value;return A.createElement(ape,It({asChild:!0},a,{focusable:!i,active:u}),A.createElement(Kr.button,It({type:"button",role:"tab","aria-selected":u,"aria-controls":c,"data-state":u?"active":"inactive","data-disabled":i?"":void 0,disabled:i,id:l},s,{ref:e,onMouseDown:gr(t.onMouseDown,d=>{!i&&d.button===0&&d.ctrlKey===!1?o.onValueChange(r):d.preventDefault()}),onKeyDown:gr(t.onKeyDown,d=>{[" ","Enter"].includes(d.key)&&o.onValueChange(r)}),onFocus:gr(t.onFocus,()=>{const d=o.activationMode!=="manual";!u&&!i&&d&&o.onValueChange(r)})})))}),mpe="TabsContent",gpe=A.forwardRef((t,e)=>{const{__scopeTabs:n,value:r,forceMount:i,children:s,...o}=t,a=_4(mpe,n),l=wU(a.baseId,r),c=xU(a.baseId,r),u=r===a.value,d=A.useRef(u);return A.useEffect(()=>{const h=requestAnimationFrame(()=>d.current=!1);return()=>cancelAnimationFrame(h)},[]),A.createElement(e2,{present:i||u},({present:h})=>A.createElement(Kr.div,It({"data-state":u?"active":"inactive","data-orientation":a.orientation,role:"tabpanel","aria-labelledby":l,hidden:!h,id:c,tabIndex:0},o,{ref:e,style:{...t.style,animationDuration:d.current?"0s":void 0}}),h&&s))});function wU(t,e){return`${t}-trigger-${e}`}function xU(t,e){return`${t}-content-${e}`}const TU=upe,SU=hpe,CU=ppe,IU=gpe,AU=({children:t,...e})=>g(SU,{className:"sidebar-triggers",...e,children:t});AU.displayName="SidebarTabTriggers";const kU=({children:t,tab:e,onSelect:n,...r})=>g(CU,{value:e,asChild:!0,onSelect:n,children:g("button",{type:"button",className:"excalidraw-button sidebar-tab-trigger",...r,children:t})});kU.displayName="SidebarTabTrigger";const MU=({children:t,...e})=>{const n=br(),r=Fr();if(!n.openSidebar)return null;const{name:i}=n.openSidebar;return g(TU,{className:"sidebar-tabs-root",value:n.openSidebar.tab,onValueChange:s=>r(o=>({...o,openSidebar:{...o.openSidebar,name:i,tab:s}})),...e,children:t})};MU.displayName="SidebarTabs";const PU=({tab:t,children:e,...n})=>g(IU,{...n,value:t,children:e});PU.displayName="SidebarTab";const E4=Yn(!1),LU=A.forwardRef(({name:t,children:e,onDock:n,docked:r,className:i,...s},o)=>{const a=Fr(),l=ah(E4,rr);A.useLayoutEffect(()=>(l(!!r),()=>{l(!1)}),[l,r]);const c=A.useRef({});c.current.onCloseRequest=()=>{a({openSidebar:null})},c.current.onDock=f=>n==null?void 0:n(f),c.current=Hg(c.current,{docked:r,shouldRenderDockButton:!!n&&r!=null});const u=A.useRef(null);A.useImperativeHandle(o,()=>u.current);const d=_r(),h=A.useCallback(()=>{document.querySelector(".Dialog")||a({openSidebar:null})},[a]);return NS(u,A.useCallback(f=>{f.target.closest(".sidebar-trigger")||(!r||!d.editor.canFitSidebar)&&h()},[h,r,d.editor.canFitSidebar])),A.useEffect(()=>{const f=p=>{p.key===z.ESCAPE&&(!r||!d.editor.canFitSidebar)&&h()};return document.addEventListener(ee.KEYDOWN,f),()=>{document.removeEventListener(ee.KEYDOWN,f)}},[h,r,d.editor.canFitSidebar]),g(lo,{...s,className:Ee("sidebar",{"sidebar--docked":r},i),ref:u,children:g(fU.Provider,{value:c.current,children:e})})});LU.displayName="SidebarInner";const xc=Object.assign(A.forwardRef((t,e)=>{var l;const n=br(),{onStateChange:r}=t,i=A.useRef(n.openSidebar);A.useEffect(()=>{var c,u,d,h,f;(!n.openSidebar&&((c=i==null?void 0:i.current)==null?void 0:c.name)===t.name||((u=n.openSidebar)==null?void 0:u.name)===t.name&&((d=i==null?void 0:i.current)==null?void 0:d.name)!==t.name||((h=i.current)==null?void 0:h.name)===t.name)&&n.openSidebar!==i.current&&(r==null||r(((f=n.openSidebar)==null?void 0:f.name)!==t.name?null:n.openSidebar)),i.current=n.openSidebar},[n.openSidebar,r,t.name]);const[s,o]=A.useState(!1);return A.useLayoutEffect(()=>(o(!0),()=>o(!1)),[]),s&&((l=n.openSidebar)==null?void 0:l.name)===t.name?A.createElement(LU,{...t,ref:e,key:t.name}):null}),{Header:pU,TabTriggers:AU,TabTrigger:kU,Tabs:MU,Tab:PU,Trigger:mU});xc.displayName="Sidebar";const Jy=({label:t,onClick:e,className:n,children:r,actionType:i,type:s="button",isLoading:o,...a})=>{const l=i?`Dialog__action-button--${i}`:"";return M("button",{className:Ee("Dialog__action-button",l,n),type:s,"aria-label":t,onClick:e,...a,children:[r&&g("div",{style:o?{visibility:"hidden"}:{},children:r}),g("div",{style:o?{visibility:"hidden"}:{},children:t}),o&&g("div",{style:{position:"absolute",inset:0},children:g(_l,{})})]})},ype=({theme:t,id:e,libraryReturnUrl:n})=>{const r=n||window.location.origin+window.location.pathname;return g("a",{className:"library-menu-browse-button",href:`https://libraries.excalidraw.com?target=${window.name||"_blank"}&referrer=${r}&useHash=true&token=${e}&theme=${t}&version=${Mv.excalidrawLibrary}`,target:"_excalidraw_libraries",children:I("labels.libraries")})},RU=({libraryReturnUrl:t,theme:e,id:n,style:r,children:i,className:s})=>M("div",{className:Ee("library-menu-control-buttons",s),style:r,children:[g(ype,{id:n,libraryReturnUrl:t,theme:e}),i]}),vpe=/({{[\w-]+}})|(<[\w-]+>)|(<\/[\w-]+>)/g,bpe=/{{([\w-]+)}}/,_pe=/<([\w-]+)>/,Epe=/<\/([\w-]+)>/,wpe=(t,e)=>{const n=[{name:"",children:[]}];return t.split(vpe).filter(Boolean).forEach(r=>{const i=r.match(_pe),s=r.match(Epe),o=r.match(bpe);if(i!==null){const a=i[1];e.hasOwnProperty(a)?n.push({name:a,children:[]}):console.warn(`Trans: missed to pass in prop ${a} for interpolating ${t}`)}else if(s!==null)if(s[1]===n[n.length-1].name){const l=n.pop(),c=ce.createElement(ce.Fragment,{},...l.children),u=e[l.name];typeof u=="function"&&n[n.length-1].children.push(u(c))}else console.warn(`Trans: unexpected end tag ${r} for interpolating ${t}`);else if(o!==null){const a=o[1];e.hasOwnProperty(a)?n[n.length-1].children.push(e[a]):console.warn(`Trans: key ${a} not in props for interpolating ${t}`)}else n[n.length-1].children.push(r)}),n.length!==1&&console.warn(`Trans: stack not empty for interpolating ${t}`),n[0].children},Vr=({i18nKey:t,children:e,...n})=>{const{t:r}=Nn();return ce.createElement(ce.Fragment,{},...wpe(r(t),n))};class co{static has(e){try{return!!window.localStorage.getItem(e)}catch(n){return console.warn(`localStorage.getItem error: ${n.message}`),!1}}static get(e){try{const n=window.localStorage.getItem(e);return n?JSON.parse(n):null}catch(n){return console.warn(`localStorage.getItem error: ${n.message}`),null}}}O(co,"set",(e,n)=>{try{return window.localStorage.setItem(e,JSON.stringify(n)),!0}catch(r){return console.warn(`localStorage.setItem error: ${r.message}`),!1}}),O(co,"delete",e=>{try{window.localStorage.removeItem(e)}catch(n){console.warn(`localStorage.removeItem error: ${n.message}`)}});const xpe=async t=>{const r=Math.round(8),i=Math.max(Math.round(128/64),2),s=dW(t,6),o=document.createElement("canvas");o.width=s[0].length*128+(s[0].length+1)*(r*2)-r*2,o.height=s.length*128+(s.length+1)*(r*2)-r*2;const a=o.getContext("2d");a.fillStyle=Jt.white,a.fillRect(0,0,o.width,o.height);for(const[l,c]of t.entries()){const u=await b2({elements:c.elements,files:null,maxWidthOrHeight:128}),{width:d,height:h}=u,f=Math.floor(l/6)*(128+r*2),p=l%6*(128+r*2);a.drawImage(u,p+(128-d)/2+r,f+(128-h)/2+r),a.lineWidth=i,a.strokeStyle=Jt.gray[4],a.strokeRect(p+r/2,f+r/2,128+r,128+r)}return await Wx(new File([await sm(o)],"preview",{type:Oe.png}),{outputType:Oe.jpg,maxWidthOrHeight:5e3})},Tpe=({libItem:t,appState:e,index:n,onChange:r,onRemove:i})=>{const s=A.useRef(null),o=A.useRef(null);return A.useEffect(()=>{const a=s.current;a&&(async()=>{const l=await nB({elements:t.elements,appState:{...e,viewBackgroundColor:Jt.white,exportBackground:!0},files:null});a.innerHTML=l.outerHTML})()},[t.elements,e]),M("div",{className:"single-library-item",children:[t.status==="published"&&g("span",{className:"single-library-item-status",children:I("labels.statusPublished")}),g("div",{ref:s,className:"single-library-item__svg"}),g(st,{"aria-label":I("buttons.remove"),type:"button",icon:hh,className:"single-library-item--remove",onClick:i.bind(null,t.id),title:I("buttons.remove")}),M("div",{style:{display:"flex",margin:"0.8rem 0",width:"100%",fontSize:"14px",fontWeight:500,flexDirection:"column"},children:[M("label",{style:{display:"flex",justifyContent:"space-between",flexDirection:"column"},children:[M("div",{style:{padding:"0.5em 0"},children:[g("span",{style:{fontWeight:500,color:Jt.gray[6]},children:I("publishDialog.itemName")}),g("span",{"aria-hidden":"true",className:"required",children:"*"})]}),g("input",{type:"text",ref:o,style:{width:"80%",padding:"0.2rem"},defaultValue:t.name,placeholder:"Item name",onChange:a=>{r(a.target.value,n)}})]}),g("span",{className:"error",children:t.error})]})]})},Spe=({onClose:t,libraryItems:e,appState:n,onSuccess:r,onError:i,updateItemsInStorage:s,onRemove:o})=>{const[a,l]=A.useState({authorName:"",githubHandle:"",name:"",description:"",twitterHandle:"",website:""}),[c,u]=A.useState(!1);A.useEffect(()=>{const _=co.get(il.PUBLISH_LIBRARY);_&&l(_)},[]);const[d,h]=A.useState(e.slice());A.useEffect(()=>{h(e.slice())},[e]);const f=_=>{l({...a,[_.target.name]:_.target.value})},p=async _=>{_.preventDefault(),u(!0);const E=[];let w=!1;if(d.forEach(F=>{let N="";F.name||(N=I("publishDialog.errors.required"),w=!0),E.push({...F,error:N})}),w){h(E),u(!1);return}const x=await xpe(d),T={type:ki.excalidrawLibrary,version:Mv.excalidrawLibrary,source:MT,libraryItems:d},C=JSON.stringify(T,null,2),k=new Blob([C],{type:"application/json"}),L=new FormData;L.append("excalidrawLib",k),L.append("previewImage",x),L.append("previewImageType",x.type),L.append("title",a.name),L.append("authorName",a.authorName),L.append("githubHandle",a.githubHandle),L.append("name",a.name),L.append("description",a.description),L.append("twitterHandle",a.twitterHandle),L.append("website",a.website),fetch("https://us-central1-excalidraw-room-persistence.cloudfunctions.net/libraries/submit",{method:"post",body:L}).then(F=>F.ok?F.json().then(({url:N})=>{co.delete(il.PUBLISH_LIBRARY),r({url:N,authorName:a.authorName,items:d})}):F.json().catch(()=>{throw new Error(F.statusText||"something went wrong")}).then(N=>{throw new Error(N.message||F.statusText||"something went wrong")}),F=>{console.error(F),i(F),u(!1)}).catch(F=>{console.error(F),i(F),u(!1)})},m=()=>{const _=[];return d.forEach((E,w)=>{_.push(g("div",{className:"single-library-item-wrapper",children:g(Tpe,{libItem:E,appState:n,index:w,onChange:(x,T)=>{const C=d.slice();C[T].name=x,h(C)},onRemove:o})},w))}),g("div",{className:"selected-library-items",children:_})},v=A.useCallback(()=>{s(d),co.set(il.PUBLISH_LIBRARY,a),t()},[d,t,s,a]),y=!!e.length,b=e.some(_=>_.status==="published");return g(yi,{onCloseRequest:v,title:I("publishDialog.title"),className:"publish-library",children:y?M("form",{onSubmit:p,children:[g("div",{className:"publish-library-note",children:g(Vr,{i18nKey:"publishDialog.noteDescription",link:_=>g("a",{href:"https://libraries.excalidraw.com",target:"_blank",rel:"noopener noreferrer",children:_})})}),g("span",{className:"publish-library-note",children:g(Vr,{i18nKey:"publishDialog.noteGuidelines",link:_=>g("a",{href:"https://github.com/excalidraw/excalidraw-libraries#guidelines",target:"_blank",rel:"noopener noreferrer",children:_})})}),g("div",{className:"publish-library-note",children:I("publishDialog.noteItems")}),b&&g("span",{className:"publish-library-note publish-library-warning",children:I("publishDialog.republishWarning")}),m(),M("div",{className:"publish-library__fields",children:[M("label",{children:[M("div",{children:[g("span",{children:I("publishDialog.libraryName")}),g("span",{"aria-hidden":"true",className:"required",children:"*"})]}),g("input",{type:"text",name:"name",required:!0,value:a.name,onChange:f,placeholder:I("publishDialog.placeholder.libraryName")})]}),M("label",{style:{alignItems:"flex-start"},children:[M("div",{children:[g("span",{children:I("publishDialog.libraryDesc")}),g("span",{"aria-hidden":"true",className:"required",children:"*"})]}),g("textarea",{name:"description",rows:4,required:!0,value:a.description,onChange:f,placeholder:I("publishDialog.placeholder.libraryDesc")})]}),M("label",{children:[M("div",{children:[g("span",{children:I("publishDialog.authorName")}),g("span",{"aria-hidden":"true",className:"required",children:"*"})]}),g("input",{type:"text",name:"authorName",required:!0,value:a.authorName,onChange:f,placeholder:I("publishDialog.placeholder.authorName")})]}),M("label",{children:[g("span",{children:I("publishDialog.githubUsername")}),g("input",{type:"text",name:"githubHandle",value:a.githubHandle,onChange:f,placeholder:I("publishDialog.placeholder.githubHandle")})]}),M("label",{children:[g("span",{children:I("publishDialog.twitterUsername")}),g("input",{type:"text",name:"twitterHandle",value:a.twitterHandle,onChange:f,placeholder:I("publishDialog.placeholder.twitterHandle")})]}),M("label",{children:[g("span",{children:I("publishDialog.website")}),g("input",{type:"text",name:"website",pattern:"https?://.+",title:I("publishDialog.errors.website"),value:a.website,onChange:f,placeholder:I("publishDialog.placeholder.website")})]}),g("span",{className:"publish-library-note",children:g(Vr,{i18nKey:"publishDialog.noteLicense",link:_=>g("a",{href:"https://github.com/excalidraw/excalidraw-libraries/blob/main/LICENSE",target:"_blank",rel:"noopener noreferrer",children:_})})})]}),M("div",{className:"publish-library__buttons",children:[g(Jy,{label:I("buttons.cancel"),onClick:v,"data-testid":"cancel-clear-canvas-button"}),g(Jy,{type:"submit",label:I("buttons.submit"),actionType:"primary",isLoading:c})]})]}):g("p",{style:{padding:"1em",textAlign:"center",fontWeight:500},children:I("publishDialog.atleastOneLibItem")})})},Cpe=(t,e)=>t.filter(n=>e.includes(n.id)),Ipe=({setAppState:t,selectedItems:e,library:n,onRemoveFromLibrary:r,resetLibrary:i,onSelectItems:s,appState:o,className:a})=>{const[l]=Ht(hm,rr),[c,u]=Ht(w4,rr),d=()=>{const L=e.length?I("alerts.removeItemsFromsLibrary",{count:e.length}):I("alerts.resetLibrary"),F=e.length?I("confirmDialog.removeItemsFromLib"):I("confirmDialog.resetLibrary");return g(DU,{onConfirm:()=>{e.length?r():i(),f(!1)},onCancel:()=>{f(!1)},title:F,children:g("p",{children:L})})},[h,f]=A.useState(!1),p=!!e.length,m=p?l.libraryItems.filter(L=>e.includes(L.id)):l.libraryItems,v=I(p?"buttons.remove":"buttons.resetLibrary"),[y,b]=A.useState(!1),[_,E]=A.useState(null),w=A.useCallback(()=>M(yi,{onCloseRequest:()=>E(null),title:I("publishSuccessDialog.title"),className:"publish-library-success",size:"small",children:[g("p",{children:g(Vr,{i18nKey:"publishSuccessDialog.content",authorName:_.authorName,link:L=>g("a",{href:_==null?void 0:_.url,target:"_blank",rel:"noopener noreferrer",children:L})})}),g(st,{type:"button",title:I("buttons.close"),"aria-label":I("buttons.close"),label:I("buttons.close"),onClick:()=>E(null),"data-testid":"publish-library-success-close",className:"publish-library-success-close"})]}),[E,_]),x=(L,F)=>{b(!1),E({url:L.url,authorName:L.authorName});const N=F.slice();N.forEach(R=>{e.includes(R.id)&&(R.status="published")}),n.setLibrary(N)},T=async()=>{try{await n.updateLibrary({libraryItems:jS({description:"Excalidraw library files"}),merge:!0,openLibraryMenu:!0})}catch(L){if((L==null?void 0:L.name)==="AbortError"){console.warn(L);return}t({errorMessage:I("errors.importLibraryError")})}},C=async()=>{const L=p?m:await n.getLatestLibrary();wae(L).catch(oR).catch(F=>{t({errorMessage:F.message})})},k=()=>M(it,{open:c,children:[g(it.Trigger,{onToggle:()=>u(!c),children:qQ}),M(it.Content,{onClickOutside:()=>u(!1),onSelect:()=>u(!1),className:"library-menu",children:[!p&&g(it.Item,{onSelect:T,icon:gS,"data-testid":"lib-dropdown--load",children:I("buttons.load")}),!!m.length&&g(it.Item,{onSelect:C,icon:ZO,"data-testid":"lib-dropdown--export",children:I("buttons.export")}),!!m.length&&g(it.Item,{onSelect:()=>f(!0),icon:Gv,children:v}),p&&g(it.Item,{icon:Pte,onSelect:()=>b(!0),"data-testid":"lib-dropdown--remove",children:I("buttons.publishLibrary")})]})]});return M("div",{className:Ee("library-menu-dropdown-container",a),children:[k(),e.length>0&&g("div",{className:"library-actions-counter",children:e.length}),h&&d(),y&&g(Spe,{onClose:()=>b(!1),libraryItems:Cpe(l.libraryItems,e),appState:o,onSuccess:L=>x(L,l.libraryItems),onError:L=>window.alert(L),updateItemsInStorage:()=>n.setLibrary(l.libraryItems),onRemove:L=>s(e.filter(F=>F!==L))}),_&&w()]})},X8=({selectedItems:t,onSelectItems:e,className:n})=>{const{library:r}=Sh(),{clearLibraryCache:i,deleteItemsFromLibraryCache:s}=eB(),o=br(),a=Fr(),[l]=Ht(hm,rr),c=async d=>{const h=d.filter(f=>!t.includes(f.id));r.setLibrary(h).catch(()=>{a({errorMessage:I("alerts.errorRemovingFromLibrary")})}),s(t),e([])};return g(Ipe,{appState:o,setAppState:a,selectedItems:t,onSelectItems:e,library:r,onRemoveFromLibrary:()=>c(l.libraryItems),resetLibrary:()=>{r.resetLibrary(),i()},className:n})},Ape=A.memo(({id:t,elements:e,isPending:n,onClick:r,selected:i,onToggle:s,onDrag:o,svgCache:a})=>{const l=A.useRef(null),c=qce(t,e,a);A.useEffect(()=>{const p=l.current;if(p)return c&&(p.innerHTML=c.outerHTML),()=>{p.innerHTML=""}},[c]);const[u,d]=A.useState(!1),h=_r().editor.isMobile,f=n&&g("div",{className:"library-unit__adder",children:KQ});return M("div",{className:Ee("library-unit",{"library-unit__active":e,"library-unit--hover":e&&u,"library-unit--selected":i,"library-unit--skeleton":!c}),onMouseEnter:()=>d(!0),onMouseLeave:()=>d(!1),children:[g("div",{className:Ee("library-unit__dragger",{"library-unit__pulse":!!n}),ref:l,draggable:!!e,onClick:e||n?p=>{t&&p.shiftKey?s(t,p):r(t)}:void 0,onDragStart:p=>{if(!t){p.preventDefault();return}d(!1),o(t,p)}}),f,t&&e&&(u||h||i)&&g(I2,{checked:i,onChange:(p,m)=>s(t,m),className:"library-unit__checkbox"})]})}),kpe=()=>g("div",{className:"library-unit library-unit--skeleton"});function Mpe(){return[!1,A.useCallback(e=>e(),[])]}const Ppe=ce.useTransition||Mpe,Y8=({children:t})=>g("div",{className:"library-menu-items-container__grid",children:t}),q_=A.memo(({items:t,onItemSelectToggle:e,onItemDrag:n,isItemSelected:r,onClick:i,svgCache:s,itemsRenderedPerBatch:o})=>{const[,a]=Ppe(),[l,c]=A.useState(0);return A.useEffect(()=>{l<t.length&&a(()=>{c(l+o)})},[l,t.length,a,o]),g(ge,{children:t.map((u,d)=>d<l?g(Ape,{elements:u==null?void 0:u.elements,isPending:!(u!=null&&u.id)&&!!(u!=null&&u.elements),onClick:i,svgCache:s,id:u==null?void 0:u.id,selected:r(u.id),onToggle:e,onDrag:n},(u==null?void 0:u.id)??d):g(kpe,{},d))})});var vg={},OU="Expected a function",Z8=NaN,Lpe="[object Symbol]",Rpe=/^\s+|\s+$/g,Ope=/^[-+]0x[0-9a-f]+$/i,Dpe=/^0b[01]+$/i,Npe=/^0o[0-7]+$/i,Fpe=parseInt,Bpe=typeof vg=="object"&&vg&&vg.Object===Object&&vg,Upe=typeof self=="object"&&self&&self.Object===Object&&self,$pe=Bpe||Upe||Function("return this")(),Hpe=Object.prototype,zpe=Hpe.toString,Gpe=Math.max,Vpe=Math.min,J_=function(){return $pe.Date.now()};function Wpe(t,e,n){var r,i,s,o,a,l,c=0,u=!1,d=!1,h=!0;if(typeof t!="function")throw new TypeError(OU);e=K8(e)||0,Qy(n)&&(u=!!n.leading,d="maxWait"in n,s=d?Gpe(K8(n.maxWait)||0,e):s,h="trailing"in n?!!n.trailing:h);function f(x){var T=r,C=i;return r=i=void 0,c=x,o=t.apply(C,T),o}function p(x){return c=x,a=setTimeout(y,e),u?f(x):o}function m(x){var T=x-l,C=x-c,k=e-T;return d?Vpe(k,s-C):k}function v(x){var T=x-l,C=x-c;return l===void 0||T>=e||T<0||d&&C>=s}function y(){var x=J_();if(v(x))return b(x);a=setTimeout(y,m(x))}function b(x){return a=void 0,h&&r?f(x):(r=i=void 0,o)}function _(){a!==void 0&&clearTimeout(a),c=0,r=l=i=a=void 0}function E(){return a===void 0?o:b(J_())}function w(){var x=J_(),T=v(x);if(r=arguments,i=this,l=x,T){if(a===void 0)return p(l);if(d)return a=setTimeout(y,e),f(l)}return a===void 0&&(a=setTimeout(y,e)),o}return w.cancel=_,w.flush=E,w}function jpe(t,e,n){var r=!0,i=!0;if(typeof t!="function")throw new TypeError(OU);return Qy(n)&&(r="leading"in n?!!n.leading:r,i="trailing"in n?!!n.trailing:i),Wpe(t,e,{leading:r,maxWait:e,trailing:i})}function Qy(t){var e=typeof t;return!!t&&(e=="object"||e=="function")}function Xpe(t){return!!t&&typeof t=="object"}function Ype(t){return typeof t=="symbol"||Xpe(t)&&zpe.call(t)==Lpe}function K8(t){if(typeof t=="number")return t;if(Ype(t))return Z8;if(Qy(t)){var e=typeof t.valueOf=="function"?t.valueOf():t;t=Qy(e)?e+"":e}if(typeof t!="string")return t===0?t:+t;t=t.replace(Rpe,"");var n=Dpe.test(t);return n||Npe.test(t)?Fpe(t.slice(2),n?2:8):Ope.test(t)?Z8:+t}var Zpe=jpe;const Tc=aa(Zpe),Kpe=Yn(0),qpe=t=>{const[e,n]=Ht(Kpe);return A.useEffect(()=>{const{current:r}=t;if(!r)return;const i=Tc(()=>{const{scrollTop:s}=r;n(s)},200);return r.addEventListener("scroll",i),()=>{i.cancel(),r.removeEventListener("scroll",i)}},[t,n]),e},Jpe=17,Qpe=64;function eme({isLoading:t,libraryItems:e,onAddToLibrary:n,onInsertLibraryItems:r,pendingElements:i,theme:s,id:o,libraryReturnUrl:a,onSelectItems:l,selectedItems:c}){const u=A.useRef(null),d=qpe(u);A.useEffect(()=>{var L;d>0&&((L=u.current)==null||L.scrollTo(0,d))},[]);const{svgCache:h}=eB(),f=A.useMemo(()=>e.filter(L=>L.status!=="published"),[e]),p=A.useMemo(()=>e.filter(L=>L.status==="published"),[e]),m=!e.length&&!i.length,v=!i.length&&!f.length&&!p.length,[y,b]=A.useState(null),_=A.useCallback((L,F)=>{const N=!c.includes(L),R=[...f,...p];if(N){if(F.shiftKey&&y){const H=R.findIndex(j=>j.id===y),W=R.findIndex(j=>j.id===L);if(H===-1||W===-1){l([...c,L]);return}const q=xn(c),Z=R.reduce((j,K,$)=>(($>=H&&$<=W||q.has(K.id))&&j.push(K.id),j),[]);l(Z)}else l([...c,L]);b(L)}else b(null),l(c.filter(H=>H!==L))},[y,l,p,c,f]),E=A.useCallback(L=>{let F;return c.includes(L)?F=e.filter(N=>c.includes(N.id)):F=e.filter(N=>N.id===L),F.map(N=>({...N,elements:WO(N.elements,{randomizeSeed:!0})}))},[e,c]),w=A.useCallback((L,F)=>{F.dataTransfer.setData(Oe.excalidrawlib,WN(E(L)))},[E]),x=A.useCallback(L=>L?c.includes(L):!1,[c]),T=A.useCallback(()=>{n(i)},[i,n]),C=A.useCallback(L=>{L&&r(E(L))},[E,r]),k=h.size>=e.length?Qpe:Jpe;return M("div",{className:"library-menu-items-container",style:i.length||f.length||p.length?{justifyContent:"flex-start"}:{borderBottom:0},children:[!v&&g(X8,{selectedItems:c,onSelectItems:l,className:"library-menu-dropdown-container--in-heading"}),M(Ii.Col,{className:"library-menu-items-container__items",align:"start",gap:1,style:{flex:p.length>0?1:"0 1 auto",marginBottom:0},ref:u,children:[M(ge,{children:[!v&&g("div",{className:"library-menu-items-container__header",children:I("labels.personalLib")}),t&&g("div",{style:{position:"absolute",top:"var(--container-padding-y)",right:"var(--container-padding-x)",transform:"translateY(50%)"},children:g(_l,{})}),!i.length&&!f.length?M("div",{className:"library-menu-items__no-items",children:[g("div",{className:"library-menu-items__no-items__label",children:I("library.noItems")}),g("div",{className:"library-menu-items__no-items__hint",children:p.length>0?I("library.hint_emptyPrivateLibrary"):I("library.hint_emptyLibrary")})]}):M(Y8,{children:[i.length>0&&g(q_,{itemsRenderedPerBatch:k,items:[{id:null,elements:i}],onItemSelectToggle:_,onItemDrag:w,onClick:T,isItemSelected:x,svgCache:h}),g(q_,{itemsRenderedPerBatch:k,items:f,onItemSelectToggle:_,onItemDrag:w,onClick:C,isItemSelected:x,svgCache:h})]})]}),M(ge,{children:[(p.length>0||i.length>0||f.length>0)&&g("div",{className:"library-menu-items-container__header library-menu-items-container__header--excal",children:I("labels.excalidrawLib")}),p.length>0?g(Y8,{children:g(q_,{itemsRenderedPerBatch:k,items:p,onItemSelectToggle:_,onItemDrag:w,onClick:C,isItemSelected:x,svgCache:h})}):f.length>0?g("div",{style:{margin:"1rem 0",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",width:"100%",fontSize:".9rem"},children:I("library.noItems")}):null]}),m&&g(RU,{style:{padding:"16px 0",width:"100%"},id:o,libraryReturnUrl:a,theme:s,children:g(X8,{selectedItems:c,onSelectItems:l})})]})]})}const w4=Yn(!1),q8=({children:t})=>g("div",{className:"layer-ui__library",children:t}),tme=({onInsertLibraryItems:t,pendingElements:e,onAddToLibrary:n,setAppState:r,libraryReturnUrl:i,library:s,id:o,theme:a,selectedItems:l,onSelectItems:c})=>{const[u]=Ht(hm,rr),d=A.useCallback(p=>{(async(v,y)=>{at("element","addToLibrary","ui");for(const _ of _7)if(v.some(E=>E.type===_))return r({errorMessage:I(`errors.libraryElementTypeError.${_}`)});const b=[{status:"unpublished",elements:v,id:Di(),created:Date.now()},...y];n(),s.setLibrary(b).catch(()=>{r({errorMessage:I("alerts.errorAddingToLibrary")})})})(p,u.libraryItems)},[n,s,r,u.libraryItems]),h=A.useMemo(()=>u.libraryItems,[u]);if(u.status==="loading"&&!u.isInitialized)return g(q8,{children:g("div",{className:"layer-ui__library-message",children:M("div",{children:[g(_l,{size:"2em"}),g("span",{children:I("labels.libraryLoadingMessage")})]})})});const f=u.libraryItems.length>0||e.length>0;return M(q8,{children:[g(eme,{isLoading:u.status==="loading",libraryItems:h,onAddToLibrary:d,onInsertLibraryItems:t,pendingElements:e,id:o,libraryReturnUrl:i,theme:a,onSelectItems:c,selectedItems:l}),f&&g(RU,{className:"library-menu-control-buttons--at-bottom",style:{padding:"16px 12px 0 12px"},id:o,libraryReturnUrl:i,theme:a})]})},nme=(t,e)=>{const n=()=>Rt(e,t,{includeBoundTextElement:!0,includeElementsInFrames:!0}),r=A.useRef(n()),i=A.useRef(t),s=A.useRef(e);return(!Pr(t.selectedElementIds,i.current.selectedElementIds)||!Pr(e,s.current))&&(r.current=n(),i.current=t,s.current=e),r.current},rme=()=>{const{library:t,id:e,onInsertElements:n}=Sh(),r=M2(),i=br(),s=Fr(),o=P2(),[a,l]=A.useState([]),c=A.useMemo(()=>t,[t]),u=nme(i,o),d=A.useCallback(f=>{n(tB(f))},[n]),h=A.useCallback(()=>{s({selectedElementIds:{},selectedGroupIds:{},activeEmbeddable:null})},[s]);return g(tme,{pendingElements:u,onInsertLibraryItems:d,onAddToLibrary:h,setAppState:s,libraryReturnUrl:r.libraryReturnUrl,library:c,id:e,theme:i.theme,selectedItems:a,onSelectItems:l})},DU=t=>{const{onConfirm:e,onCancel:n,children:r,confirmText:i=I("buttons.confirm"),cancelText:s=I("buttons.cancel"),className:o="",...a}=t,l=Fr(),c=ah(w4,rr),{container:u}=pa();return M(yi,{onCloseRequest:n,size:"small",...a,className:`confirm-dialog ${o}`,children:[r,M("div",{className:"confirm-dialog-buttons",children:[g(Jy,{label:s,onClick:()=>{l({openMenu:null}),c(!1),n(),u==null||u.focus()}}),g(Jy,{label:i,onClick:()=>{l({openMenu:null}),c(!1),e(),u==null||u.focus()},actionType:"danger"})]})]})},x4=Yn(null),ime=()=>{const[t,e]=Ht(x4,rr),n=$i();return t&&t==="clearCanvas"?g(DU,{onConfirm:()=>{n.executeAction(lN),e(null)},onCancel:()=>e(null),title:I("clearCanvasDialog.title"),children:M("p",{className:"clear-canvas__content",children:[" ",I("alerts.clearReset")]})}):null},NU=Yn({active:!1});async function g3({title:t,description:e,actionLabel:n,color:r}){return new Promise(i=>{zo.set(NU,{active:!0,onConfirm:()=>i(!0),onClose:()=>i(!1),onReject:()=>i(!1),title:t,description:e,actionLabel:n,color:r})})}const FU=()=>{const{t}=Nn(),e=$i(),n=P2();return e.isActionEnabled(h3)?g(Is,{icon:gS,onSelect:async()=>{(!n.length||await g3({title:t("overwriteConfirm.modal.loadFromFile.title"),actionLabel:t("overwriteConfirm.modal.loadFromFile.button"),color:"warning",description:g(Vr,{i18nKey:"overwriteConfirm.modal.loadFromFile.description",bold:i=>g("strong",{children:i}),br:()=>g("br",{})})}))&&e.executeAction(h3)},"data-testid":"load-button",shortcut:Th("loadScene"),"aria-label":t("buttons.load"),children:t("buttons.load")}):null};FU.displayName="LoadScene";const BU=()=>{const{t}=Nn(),e=$i();return e.isActionEnabled(C8)?g(Is,{shortcut:Th("saveScene"),"data-testid":"save-button",onSelect:()=>e.executeAction(C8),icon:Tee,"aria-label":`${t("buttons.save")}`,children:`${t("buttons.save")}`}):null};BU.displayName="SaveToActiveFile";const UU=()=>{const t=Fr(),{t:e}=Nn();return g(Is,{icon:Iee,"data-testid":"image-export-button",onSelect:()=>t({openDialog:{name:"imageExport"}}),shortcut:Th("imageExport"),"aria-label":e("buttons.exportImage"),children:e("buttons.exportImage")})};UU.displayName="SaveAsImage";const $U=()=>{const{t}=Nn(),e=$i();return g(Is,{"data-testid":"help-menu-item",icon:mS,onSelect:()=>e.executeAction(v4),shortcut:"?","aria-label":t("helpDialog.title"),children:t("helpDialog.title")})};$U.displayName="Help";const HU=()=>{const{t}=Nn(),e=ah(x4,rr);return $i().isActionEnabled(lN)?g(Is,{icon:Gv,onSelect:()=>e("clearCanvas"),"data-testid":"clear-canvas-button","aria-label":t("buttons.clearReset"),children:t("buttons.clearReset")}):null};HU.displayName="ClearCanvas";const zU=()=>{const{t}=Nn(),e=br(),n=$i();return n.isActionEnabled(TA)?g(Is,{onSelect:r=>(r.preventDefault(),n.executeAction(TA)),icon:e.theme==="dark"?bee:vee,"data-testid":"toggle-dark-mode",shortcut:Th("toggleTheme"),"aria-label":e.theme==="dark"?t("buttons.lightMode"):t("buttons.darkMode"),children:e.theme==="dark"?t("buttons.lightMode"):t("buttons.darkMode")}):null};zU.displayName="ToggleTheme";const GU=()=>{const{t}=Nn(),e=br(),n=$i(),r=M2();return e.viewModeEnabled||!r.UIOptions.canvasActions.changeViewBackgroundColor?null:M("div",{style:{marginTop:"0.5rem"},children:[g("div",{"data-testid":"canvas-background-label",style:{fontSize:".75rem",marginBottom:".5rem"},children:t("labels.canvasBackground")}),g("div",{style:{padding:"0 0.625rem"},children:n.renderAction("changeViewBackgroundColor")})]})};GU.displayName="ChangeCanvasBackground";const VU=()=>{const{t}=Nn(),e=Fr();return g(Is,{icon:ZO,onSelect:()=>{e({openDialog:{name:"jsonExport"}})},"data-testid":"json-export-button","aria-label":t("buttons.export"),children:t("buttons.export")})};VU.displayName="Export";const WU=()=>M(ge,{children:[g(dp,{icon:_ee,href:"https://github.com/excalidraw/excalidraw","aria-label":"GitHub",children:"GitHub"}),g(dp,{icon:Eee,href:"https://discord.gg/UexuTaE","aria-label":"Discord",children:"Discord"}),g(dp,{icon:wee,href:"https://twitter.com/excalidraw","aria-label":"Twitter",children:"Twitter"})]});WU.displayName="Socials";const jU=({onSelect:t,isCollaborating:e})=>{const{t:n}=Nn();return g(Is,{"data-testid":"collab-button",icon:yS,className:Ee({"active-collab":e}),onSelect:t,children:n("labels.liveCollaboration")})};jU.displayName="LiveCollaborationTrigger";const sme=Object.freeze(Object.defineProperty({__proto__:null,ChangeCanvasBackground:GU,ClearCanvas:HU,Export:VU,Help:$U,LiveCollaborationTrigger:jU,LoadScene:FU,SaveAsImage:UU,SaveToActiveFile:BU,Socials:WU,ToggleTheme:zU},Symbol.toStringTag,{value:"Module"})),Qm=(t,e)=>{const n=Yn(0),r=i=>{const{jotaiScope:s}=Nr(),[,o]=Ht(n,s),a=A.useRef({preferHost:!1,counter:0});return A.useLayoutEffect(()=>{const l=a.current;return o(c=>{const u=c+1;return l.counter=u,u}),()=>{o(c=>{const u=c-1;return l.counter=u,u||(l.preferHost=!1),u})}},[o]),i.__fallback||(a.current.preferHost=!0),!a.current.counter&&i.__fallback&&a.current.preferHost||a.current.counter>1&&i.__fallback?null:g(e,{...i})};return r.displayName=t,r},xt=Object.assign(Qm("MainMenu",({children:t,onSelect:e})=>{var a;const{MainMenuTunnel:n}=Nr(),r=_r(),i=br(),s=Fr(),o=r.editor.isMobile?void 0:()=>s({openMenu:null});return g(n.In,{children:M(it,{open:i.openMenu==="canvas",children:[g(it.Trigger,{onToggle:()=>{s({openMenu:i.openMenu==="canvas"?null:"canvas"})},"data-testid":"main-menu-trigger",className:"main-menu-trigger",children:YO}),M(it.Content,{onClickOutside:o,onSelect:Lv(e,()=>{s({openMenu:null})}),children:[t,r.editor.isMobile&&i.collaborators.size>0&&M("fieldset",{className:"UserList-Wrapper",children:[g("legend",{children:I("labels.collaborators")}),g(dU,{mobile:!0,collaborators:i.collaborators,userToFollow:((a=i.userToFollow)==null?void 0:a.socketId)||null})]})]})]})})}),{Trigger:it.Trigger,Item:it.Item,ItemLink:it.ItemLink,ItemCustom:it.ItemCustom,Group:it.Group,Separator:it.Separator,DefaultItems:sme}),T4=({title:t,children:e,actionLabel:n,onClick:r})=>M("div",{className:"OverwriteConfirm__Actions__Action",children:[g("h4",{children:t}),g("div",{className:"OverwriteConfirm__Actions__Action__content",children:e}),g(us,{variant:"outlined",color:"muted",label:n,size:"large",fullWidth:!0,onClick:r})]}),ome=()=>{const{t}=Nn(),e=$i(),n=Fr();return g(T4,{title:t("overwriteConfirm.action.exportToImage.title"),actionLabel:t("overwriteConfirm.action.exportToImage.button"),onClick:()=>{e.executeAction(RB,"ui",!0),n({openDialog:{name:"imageExport"}})},children:t("overwriteConfirm.action.exportToImage.description")})},ame=()=>{const{t}=Nn(),e=$i();return g(T4,{title:t("overwriteConfirm.action.saveToDisk.title"),actionLabel:t("overwriteConfirm.action.saveToDisk.button"),onClick:()=>{e.executeAction(OB,"ui")},children:t("overwriteConfirm.action.saveToDisk.description")})},J8=Object.assign(({children:t})=>g("div",{className:"OverwriteConfirm__Actions",children:t}),{ExportToImage:ome,SaveToDisk:ame}),Sc=Object.assign(Qm("OverwriteConfirmDialog",({children:t})=>{const{OverwriteConfirmDialogTunnel:e}=Nr(),[n,r]=Ht(NU,rr);if(!n.active)return null;const i=()=>{n.onClose(),r(o=>({...o,active:!1}))},s=()=>{n.onConfirm(),r(o=>({...o,active:!1}))};return g(e.In,{children:g(yi,{onCloseRequest:i,title:!1,size:916,children:M("div",{className:"OverwriteConfirm",children:[g("h3",{children:n.title}),M("div",{className:`OverwriteConfirm__Description OverwriteConfirm__Description--color-${n.color}`,children:[g("div",{className:"OverwriteConfirm__Description__icon",children:Nte}),g("div",{children:n.description}),g("div",{className:"OverwriteConfirm__Description__spacer"}),g(us,{color:n.color,size:"large",label:n.actionLabel,onClick:s})]}),g(J8,{children:t})]})})})}),{Actions:J8,Action:T4}),XU=Qm("DefaultSidebarTrigger",t=>{const{DefaultSidebarTriggerTunnel:e}=Nr();return g(e.In,{children:g(xc.Trigger,{...t,className:"default-sidebar-trigger",name:bd.name})})});XU.displayName="DefaultSidebarTrigger";const YU=({children:t,...e})=>{const{DefaultSidebarTabTriggersTunnel:n}=Nr();return g(n.In,{children:g(xc.TabTriggers,{...e,children:t})})};YU.displayName="DefaultTabTriggers";const Q8=Object.assign(Qm("DefaultSidebar",({children:t,className:e,onDock:n,docked:r,...i})=>{const s=br(),o=Fr(),{DefaultSidebarTabTriggersTunnel:a}=Nr();return A.createElement(xc,{...i,name:"default",key:"default",className:Ee("default-sidebar",e),docked:r??s.defaultSidebarDockedPreference,onDock:n===!1||!n&&r!=null?void 0:Lv(n,l=>{o({defaultSidebarDockedPreference:l})})},M(xc.Tabs,{children:[M(xc.Header,{children:[i.__fallback&&g("div",{style:{color:"var(--color-primary)",fontSize:"1.2em",fontWeight:"bold",textOverflow:"ellipsis",overflow:"hidden",whiteSpace:"nowrap",paddingRight:"1em"},children:I("toolBar.library")}),g(a.Out,{})]}),g(xc.Tab,{tab:RT,children:g(rme,{})}),t]}))}),{Trigger:XU,TabTriggers:YU}),lme="small",cme=t=>M("label",{className:Ee("ToolIcon ToolIcon__LaserPointer",`ToolIcon_size_${lme}`,{"is-mobile":t.isMobile}),title:`${t.title}`,children:[g("input",{className:"ToolIcon_type_checkbox",type:"checkbox",name:t.name,onChange:t.onChange,checked:t.checked,"aria-label":t.title,"data-testid":"toolbar-LaserPointer"}),g("div",{className:"ToolIcon__icon",children:QO})]}),ev=A.forwardRef(({value:t,onChange:e,label:n,fullWidth:r,placeholder:i,readonly:s,selectOnRender:o,onKeyDown:a,isRedacted:l=!1},c)=>{const u=A.useRef(null);A.useImperativeHandle(c,()=>u.current),A.useLayoutEffect(()=>{var f;o&&((f=u.current)==null||f.select())},[o]);const[d,h]=A.useState(!1);return M("div",{className:Ee("ExcTextField",{"ExcTextField--fullWidth":r}),onClick:()=>{var f;(f=u.current)==null||f.focus()},children:[g("div",{className:"ExcTextField__label",children:n}),M("div",{className:Ee("ExcTextField__input",{"ExcTextField__input--readonly":s}),children:[g("input",{className:Ee({"is-redacted":t&&l&&!d}),readOnly:s,value:t,placeholder:i,ref:u,onChange:f=>e==null?void 0:e(f.target.value),onKeyDown:a}),l&&g(vm,{onSelect:()=>h(!d),style:{border:0,userSelect:"none"},children:d?zte:eD})]})]})}),v0=({icon:t})=>g("span",{style:{width:"1em",margin:"0 0.5ex 0 0.5ex",display:"inline-block",lineHeight:0,verticalAlign:"middle"},children:t}),sf=t=>g("p",{className:"excalidraw__paragraph",style:t.style,children:t.children}),S4=t=>{const e=Fr(),n=A.useRef(null),r=A.useRef(0);return g(TU,{ref:n,className:"ttd-dialog-tabs-root",value:t.tab,onValueChange:i=>{var o;if(!i)return;const s=(o=n.current)==null?void 0:o.closest(".Modal__content");if(s){const a=s.offsetHeight||0;a>r.current&&(r.current=a,s.style.minHeight=`min(${r.current}px, 100%)`)}t.dialog==="settings"&&yw(["text-to-diagram","diagram-to-code"],i)?e({openDialog:{name:t.dialog,tab:i,source:"settings"}}):t.dialog==="ttd"&&yw(["text-to-diagram","mermaid"],i)&&e({openDialog:{name:t.dialog,tab:i}})},children:t.children})};S4.displayName="TTDDialogTabs";const tv=({tab:t,children:e,...n})=>g(IU,{...n,value:t,children:e});tv.displayName="TTDDialogTab";const ume=t=>{var a;const[e,n]=A.useState(t.openAIKey||""),[r,i]=A.useState(t.isPersisted),s=br(),o=()=>{t.onConfirm(e.trim(),r)};return((a=s.openDialog)==null?void 0:a.name)!=="settings"?null:g(yi,{onCloseRequest:()=>{t.onClose(),t.onConfirm(e.trim(),r)},title:M("div",{style:{display:"flex"},children:["Wireframe to Code (AI)"," ",g("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",padding:"0.1rem 0.5rem",marginLeft:"1rem",fontSize:14,borderRadius:"12px",color:"#000",background:"pink"},children:"Experimental"})]}),className:"MagicSettings",autofocus:!1,children:g(S4,{dialog:"settings",tab:s.openDialog.tab,children:M(tv,{tab:"diagram-to-code",children:[M(sf,{children:["For the diagram-to-code feature we use"," ",g(v0,{icon:wx}),"OpenAI."]}),M(sf,{children:["While the OpenAI API is in beta, its use is strictly limited — as such we require you use your own API key. You can create an"," ",g("a",{href:"https://platform.openai.com/login?launch",rel:"noopener noreferrer",target:"_blank",children:"OpenAI account"}),", add a small credit (5 USD minimum), and"," ",g("a",{href:"https://platform.openai.com/api-keys",rel:"noopener noreferrer",target:"_blank",children:"generate your own API key"}),"."]}),g(sf,{children:"Your OpenAI key does not leave the browser, and you can also set your own limit in your OpenAI account dashboard if needed."}),g(ev,{isRedacted:!0,value:e,placeholder:"Paste your API key here",label:"OpenAI API key",onChange:l=>{n(l),t.onChange(l.trim(),r)},selectOnRender:!0,onKeyDown:l=>l.key===z.ENTER&&o()}),g(sf,{children:"By default, your API token is not persisted anywhere so you'll need to insert it again after reload. But, you can persist locally in your browser below."}),g(I2,{checked:r,onChange:i,children:"Persist API key in browser storage"}),M(sf,{children:["Once API key is set, you can use the ",g(v0,{icon:vS})," ","tool to wrap your elements in a frame that will then allow you to turn it into code. This dialog can be accessed using the"," ",g("b",{children:"AI Settings"})," ",g(v0,{icon:wx}),"."]}),g(us,{className:"MagicSettings__confirm",size:"large",label:"Confirm",onClick:o})]})})})},dme=t=>{const[e,n]=A.useState(!0);return A.useEffect(()=>{const r=async()=>{await nR(i),n(!1)},i=FT.find(s=>s.code===t.langCode)||kl;r()},[t.langCode]),e?g(oU,{theme:t.theme}):t.children},ZU=({children:t})=>{const{FooterCenterTunnel:e}=Nr(),n=br();return g(e.In,{children:g("div",{className:Ee("footer-center zen-mode-transition",{"layer-ui__wrapper__footer-left--transition-bottom":n.zenModeEnabled}),children:t})})};ZU.displayName="FooterCenter";const hme=()=>g("svg",{viewBox:"0 0 40 40",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:"ExcalidrawLogo-icon",children:g("path",{d:"M39.9 32.889a.326.326 0 0 0-.279-.056c-2.094-3.083-4.774-6-7.343-8.833l-.419-.472a.212.212 0 0 0-.056-.139.586.586 0 0 0-.167-.111l-.084-.083-.056-.056c-.084-.167-.28-.278-.475-.167-.782.39-1.507.973-2.206 1.528-.92.722-1.842 1.445-2.708 2.25a8.405 8.405 0 0 0-.977 1.028c-.14.194-.028.361.14.444-.615.611-1.23 1.223-1.843 1.861a.315.315 0 0 0-.084.223c0 .083.056.166.111.194l1.09.833v.028c1.535 1.528 4.244 3.611 7.12 5.861.418.334.865.667 1.284 1 .195.223.39.473.558.695.084.11.28.139.391.055.056.056.14.111.196.167a.398.398 0 0 0 .167.056.255.255 0 0 0 .224-.111.394.394 0 0 0 .055-.167c.029 0 .028.028.056.028a.318.318 0 0 0 .224-.084l5.082-5.528a.309.309 0 0 0 0-.444Zm-14.63-1.917a.485.485 0 0 0 .111.14c.586.5 1.2 1 1.843 1.555l-2.569-1.945-.251-.166c-.056-.028-.112-.084-.168-.111l-.195-.167.056-.056.055-.055.112-.111c.866-.861 2.346-2.306 3.1-3.028-.81.805-2.43 3.167-2.095 3.944Zm8.767 6.89-2.122-1.612a44.713 44.713 0 0 0-2.625-2.5c1.145.861 2.122 1.611 2.262 1.75 1.117.972 1.06.806 1.815 1.445l.921.666a1.06 1.06 0 0 1-.251.25Zm.558.416-.056-.028c.084-.055.168-.111.252-.194l-.196.222ZM1.089 5.75c.055.361.14.722.195 1.056.335 1.833.67 3.5 1.284 4.75l.252.944c.084.361.223.806.363.917 1.424 1.25 3.602 3.11 5.947 4.889a.295.295 0 0 0 .363 0s0 .027.028.027a.254.254 0 0 0 .196.084.318.318 0 0 0 .223-.084c2.988-3.305 5.221-6.027 6.813-8.305.112-.111.14-.278.14-.417.111-.111.195-.25.307-.333.111-.111.111-.306 0-.39l-.028-.027c0-.055-.028-.139-.084-.167-.698-.666-1.2-1.138-1.731-1.638-.922-.862-1.871-1.75-3.881-3.75l-.028-.028c-.028-.028-.056-.056-.112-.056-.558-.194-1.703-.389-3.127-.639C6.087 2.223 3.21 1.723.614.944c0 0-.168 0-.196.028l-.083.084c-.028.027-.056.055-.224.11h.056-.056c.028.167.028.278.084.473 0 .055.112.5.112.555l.782 3.556Zm15.496 3.278-.335-.334c.084.112.196.195.335.334Zm-3.546 4.666-.056.056c0-.028.028-.056.056-.056Zm-2.038-10c.168.167.866.834 1.033.973-.726-.334-2.54-1.167-3.379-1.445.838.167 1.983.334 2.346.472ZM1.424 2.306c.419.722.754 3.222 1.089 5.666-.196-.778-.335-1.555-.503-2.278-.251-1.277-.503-2.416-.838-3.416.056 0 .14 0 .252.028Zm-.168-.584c-.112 0-.223-.028-.307-.028 0-.027 0-.055-.028-.055.14 0 .223.028.335.083Zm-1.089.222c0-.027 0-.027 0 0ZM39.453 1.333c.028-.11-.558-.61-.363-.639.42-.027.42-.666 0-.666-.558.028-1.144.166-1.675.25-.977.194-1.982.389-2.96.61-2.205.473-4.383.973-6.561 1.557-.67.194-1.424.333-2.066.666-.224.111-.196.333-.084.472-.056.028-.084.028-.14.056-.195.028-.363.056-.558.083-.168.028-.252.167-.224.334 0 .027.028.083.028.11-1.173 1.556-2.485 3.195-3.909 4.945-1.396 1.611-2.876 3.306-4.356 5.056-4.719 5.5-10.052 11.75-15.943 17.25a.268.268 0 0 0 0 .389c.028.027.056.055.084.055-.084.084-.168.14-.252.222-.056.056-.084.111-.084.167a.605.605 0 0 0-.111.139c-.112.111-.112.305.028.389.111.11.307.11.39-.028.029-.028.029-.056.056-.056a.44.44 0 0 1 .615 0c.335.362.67.723.977 1.028l-.698-.583c-.112-.111-.307-.083-.39.028-.113.11-.085.305.027.389l7.427 6.194c.056.056.112.056.196.056s.14-.028.195-.084l.168-.166c.028.027.083.027.111.027.084 0 .14-.027.196-.083 10.052-10.055 18.15-17.639 27.42-24.417.083-.055.111-.166.111-.25.112 0 .196-.083.251-.194 1.704-5.194 2.039-9.806 2.15-12.083v-.028c0-.028.028-.056.028-.083.028-.056.028-.084.028-.084a1.626 1.626 0 0 0-.111-1.028ZM21.472 9.5c.446-.5.893-1.028 1.34-1.5-2.876 3.778-7.65 9.583-14.408 16.5 4.607-5.083 9.242-10.333 13.068-15ZM5.193 35.778h.084-.084Zm3.462 3.194c-.027-.028-.027-.028 0-.028v.028Zm4.16-3.583c.224-.25.448-.472.699-.722 0 0 0 .027.028.027-.252.223-.475.445-.726.695Zm1.146-1.111c.14-.14.279-.334.446-.5l.028-.028c1.648-1.694 3.351-3.389 5.082-5.111l.028-.028c.419-.333.921-.694 1.368-1.028a379.003 379.003 0 0 0-6.952 6.695ZM24.794 6.472c-.921 1.195-1.954 2.778-2.82 4.028-2.736 3.944-11.532 13.583-11.727 13.75a1976.983 1976.983 0 0 1-8.042 7.639l-.167.167c-.14-.167-.14-.417.028-.556C14.49 19.861 22.03 10.167 25.074 5.917c-.084.194-.14.36-.28.555Zm4.83 5.695c-1.116-.64-1.646-1.64-1.34-2.611l.084-.334c.028-.083.084-.194.14-.277.307-.5.754-.917 1.257-1.167.027 0 .055 0 .083-.028-.028-.056-.028-.139-.028-.222.028-.167.14-.278.335-.278.335 0 1.369.306 1.76.639.111.083.223.194.335.305.14.167.363.445.474.667.056.028.112.306.196.445.056.222.111.472.084.694-.028.028 0 .194-.028.194a2.668 2.668 0 0 1-.363 1.028c-.028.028-.028.056-.056.084l-.028.027c-.14.223-.335.417-.53.556-.643.444-1.369.583-2.095.389 0 0-.195-.084-.28-.111Zm8.154-.834a39.098 39.098 0 0 1-.893 3.167c0 .028-.028.083 0 .111-.056 0-.084.028-.14.056-2.206 1.61-4.356 3.305-6.506 5.028 1.843-1.64 3.686-3.306 5.613-4.945.558-.5.949-1.139 1.06-1.861l.28-1.667v-.055c.14-.334.67-.195.586.166Z",fill:"currentColor"})}),fme=()=>M("svg",{viewBox:"0 0 450 55",xmlns:"http://www.w3.org/2000/svg",fill:"none",className:"ExcalidrawLogo-text",children:[g("path",{d:"M429.27 96.74c2.47-1.39 4.78-3.02 6.83-4.95 1.43-1.35 2.73-2.86 3.81-4.51-.66.9-1.4 1.77-2.23 2.59-2.91 2.84-5.72 5.09-8.42 6.87h.01ZM343.6 69.36c.33 3.13.58 6.27.79 9.4.09 1.37.18 2.75.25 4.12-.12-4.46-.27-8.93-.5-13.39-.11-2.08-.24-4.16-.4-6.24-.06 1.79-.11 3.85-.13 6.11h-.01ZM378.47 98.34c.01-.37.07-1.13.01-6.51-.11 1.9-.22 3.81-.31 5.71-.07 1.42-.22 2.91-.16 4.35.39.03.78.07 1.17.1-.92-.85-.76-2.01-.72-3.66l.01.01ZM344.09 86.12c-.09-2.41-.22-4.83-.39-7.24v12.21c.15-.05.32-.09.47-.14.05-1.61-.03-3.23-.09-4.83h.01ZM440.69 66.79c-.22-.34-.45-.67-.69-.99-3.71-4.87-9.91-7.14-15.65-8.55-1.05-.26-2.12-.49-3.18-.71 2.29.59 4.48 1.26 6.64 2.02 7.19 2.54 10.57 5.41 12.88 8.23ZM305.09 72.46l1.2 3.6c.84 2.53 1.67 5.06 2.46 7.61.24.78.5 1.57.73 2.36.22-.04.44-.08.67-.12a776.9 776.9 0 0 1-5.01-13.57c-.02.04-.03.09-.05.13v-.01ZM345.49 90.25v.31c1.48-.42 3.05-.83 4.66-1.2-1.56.25-3.12.52-4.66.89ZM371.02 90.22c0-.57-.04-1.14-.11-1.71-.06-.02-.12-.04-.19-.05-.21-.05-.43-.08-.65-.11.42.16.74.88.95 1.87ZM398.93 54.23c-.13 0-.27-.01-.4-.02l.03.4c.11-.15.23-.27.37-.38ZM401.57 62.28v-.15c-1.22-.24-2.86-.61-3.23-1.25-.09-.15-.18-.51-.27-.98-.09.37-.2.73-.33 1.09 1.24.56 2.52.98 3.83 1.29ZM421.73 88.68c-2.97 1.65-6.28 3.12-9.69 3.68v.18c4.72-.14 11.63-3.85 16.33-8.38-2.04 1.75-4.33 3.24-6.63 4.53l-.01-.01ZM411.28 80.92c-.05-1.2-.09-2.4-.15-3.6-.21 5.66-.46 11.38-.47 14.51.24-.02.48-.04.71-.07.15-3.61.05-7.23-.09-10.83v-.01Z",transform:"translate(-144.023 -51.76)"}),g("path",{d:"M425.38 67.41c-3.5-1.45-7.19-2.57-14.06-3.62.09 1.97.06 4.88-.03 8.12.03.04.06.09.06.15.19 1.36.28 2.73.37 4.1.25 3.77.39 7.55.41 11.33 0 1.38-.01 2.76-.07 4.13 1.4-.25 2.78-.65 4.12-1.15 4.07-1.5 7.94-3.78 11.28-6.54 2.33-1.92 5.13-4.49 5.88-7.58.63-3.53-2.45-6.68-7.97-8.96l.01.02ZM411.35 92.53v-.06l-.34.03c.11.01.22.03.34.03ZM314.26 64.06c-.23-.59-.47-1.17-.7-1.75.57 1.62 1.11 3.25 1.6 4.9l.15.54 2.35 6.05c.32.82.66 1.64.98 2.46-1.38-4.1-2.83-8.17-4.39-12.2h.01ZM156.82 103.07c-.18.13-.38.23-.58.33 1.32-.03 2.66-.2 3.93-.34.86-.09 1.72-.22 2.58-.33-2.12.1-4.12.17-5.94.34h.01ZM210.14 68.88s.03.04.05.07c.18-.31.39-.64.58-.96-.21.3-.42.6-.64.89h.01ZM201.65 82.8c-.5.77-1.02 1.56-1.49 2.37 1.11-1.55 2.21-3.1 3.2-4.59-.23.23-.49.51-.75.79-.32.47-.65.95-.96 1.43ZM194.03 98.66c-.33-.4-.65-.84-1.05-1.17-.24-.2-.07-.49.17-.56-.23-.26-.42-.5-.63-.75 1.51-2.55 3.93-5.87 6.4-9.28-.17-.08-.29-.28-.2-.49.04-.09.09-.17.13-.26-1.21 1.78-2.42 3.55-3.61 5.33-.87 1.31-1.74 2.64-2.54 4-.29.5-.63 1.04-.87 1.61.81.65 1.63 1.27 2.47 1.88-.09-.11-.18-.21-.27-.32v.01ZM307.79 82.93c-1-3.17-2.05-6.32-3.1-9.48-1.62 4.08-3.69 9.17-6.16 15.19 3.32-1.04 6.77-1.87 10.27-2.5-.32-1.08-.67-2.15-1.01-3.21ZM149.5 80.7c.05-1.71.04-3.43 0-5.14-.1 2.26-.16 4.51-.22 6.77-.02.73-.03 1.46-.04 2.19.14-1.27.2-2.55.24-3.82h.02ZM228.98 98.3c.39 1.25.91 3.03.94 3.91.06-.03.12-.07.17-.1.08-1.29-.55-2.65-1.11-3.81ZM307.72 53.36c.81.5 1.53 1.04 2.07 1.49-.38-.8-.78-1.58-1.21-2.35-.17.03-.34.06-.51.11-.43.12-.86.26-1.29.41.35-.01.53.1.94.34ZM283.69 96.14c3.91-7.25 6.89-13.35 8.88-18.15l1.1-2.66c-1.27 2.64-2.56 5.27-3.83 7.9-1.53 3.15-3.06 6.31-4.58 9.47-.87 1.81-1.76 3.62-2.54 5.47.04.02.07.04.11.07.05.05.1.09.15.14.05-.73.27-1.48.71-2.24ZM289.92 103.23s-.04.01-.05.03c0-.02.04-.03.05-.04.05-.05.11-.1.16-.15l.21-.21c-.55 0-1.5-.27-2.55-.72.4.26.8.51 1.22.74.24.13.48.26.73.37.05.02.1.03.14.05a.27.27 0 0 1 .08-.07h.01ZM269.23 68.49c-.39-.19-.82-.48-1.33-.87-3.06-1.56-6.31-2.78-9.36-2.35-3.5.49-5.7 1.11-7.74 2.44 5.71-2.6 12.82-2.07 18.44.79l-.01-.01ZM177.87 53.69l1.06.03c-.96-.22-2-.25-2.89-.3-4.95-.26-9.99.33-14.86 1.19-2.44.43-4.88.95-7.28 1.59 9.09-1.76 15.69-2.77 23.97-2.51ZM219.85 55.51c-.18.12-.36.27-.56.45-.45.53-.86 1.11-1.26 1.66-1.91 2.61-3.71 5.31-5.57 7.95l-.12.18 8.05-10.11c-.18-.05-.36-.1-.55-.13h.01ZM510.71 54.1c.12-.15.29-.3.53-.45.69-.4 3.72-.63 5.87-.74-.36-.02-.73-.04-1.09-.05-1.84-.03-3.67.09-5.49.35.05.3.12.59.18.88v.01ZM510.76 86.02c1.37-3.07 2.49-6.27 3.57-9.46.55-1.64 1.12-3.3 1.6-4.97-1.59 4.01-3.67 9.14-6.2 15.3.24-.08.5-.14.74-.22.1-.22.19-.44.29-.65ZM566.95 75.76c.11-.02.23.03.31.11-.05-.13-.09-.26-.14-.39-.05.09-.11.18-.17.28ZM511.33 86.41c3.08-.89 6.24-1.62 9.46-2.14-1.51-3.98-2.98-7.96-4.39-11.87-.05.15-.09.31-.14.46-1.02 3.32-2.15 6.61-3.39 9.85-.48 1.25-.98 2.49-1.53 3.7h-.01ZM578.24 74.45c.11-.44.23-.87.35-1.31-.31.7-.64 1.39-.97 2.08.09.21.19.4.28.61.12-.46.23-.92.35-1.38h-.01ZM520.62 53.11c-.09 0-.18-.01-.28-.02.38.34.29 1.08.93 2.53l6.65 17.15c2.2 5.68 4.69 11.36 7.41 16.87l1.06 2.17c-2.95-7.05-5.92-14.08-8.87-21.13-1.58-3.79-3.16-7.59-4.7-11.4-.78-1.92-1.73-3.89-2.25-5.91-.03-.1 0-.19.04-.26h.01ZM578.78 77.87c1.45-5.77 3.07-10.43 3.58-13.36.05-.34.16-.88.31-1.55-.67 1.79-1.37 3.56-2.08 5.33-.12.43-.23.86-.35 1.29-.65 2.43-1.29 4.86-1.9 7.3.14.33.29.65.43 1l.01-.01ZM545.3 94.66c.02-.44.03-.83.05-1.12.02-1.01.05-2.02.11-3.02.03-6.66-.46-14.33-1.46-22.8-.13-.42-.27-1.24-.56-2.89 0-.02 0-.04-.01-.06.62 6.61.95 13.25 1.32 19.87.17 3.08.33 6.16.52 9.23.02.25.03.52.04.78l-.01.01ZM580.77 102.81c.13.2.27.38.37.49.27-.11.53-.22.8-.32-.43.09-.82.05-1.17-.16v-.01ZM530.48 104.07h.33c-.36-.13-.71-.32-1.04-.56.14.24.3.47.45.7.06-.08.14-.13.26-.13v-.01ZM542.63 58.82c.06.23.11.47.15.71.14-.33.36-.62.7-.86-.28.05-.57.11-.85.15ZM583.81 57.87c.15-.7.29-1.41.42-2.11-.14.45-.28.9-.42 1.34-.46 1.44-.89 2.89-1.31 4.34.44-1.19.88-2.37 1.31-3.57ZM523.62 91.48c-4.66 1.17-9.05 2.89-14.02 5.27 4.65-1.84 9.48-3.29 14.28-4.63-.09-.22-.17-.41-.26-.64ZM460.64 78.3c-.04-2.9-.11-5.81-.28-8.71-.1-1.68-.17-3.43-.5-5.09-.07.02-.14.03-.2.05.3 6.54.45 12.17.51 17.12.17-.07.34-.14.51-.2 0-1.06-.01-2.11-.03-3.17h-.01ZM470.63 63.24c-3.38-.26-6.81.32-10.1 1.1.41 2.01.47 4.14.57 6.18.18 3.55.25 7.11.27 10.67 3.31-1.38 6.5-3.12 9.3-5.35 1.96-1.56 3.86-3.41 5.02-5.66.73-1.41 1.19-3.22.26-4.65-1.09-1.7-3.46-2.14-5.32-2.29ZM460.29 63.68c1-.24 2.01-.46 3.04-.65-1.15.16-2.37.38-3.71.69v.13c.07-.02.15-.04.22-.05.11-.13.3-.18.45-.11v-.01ZM457.24 100.96c.43-.03.86-.07 1.29-.11.14-.49.27-.99.38-1.49-.44.7-1 1.23-1.67 1.6ZM482.88 104.98c-.18.23-.36.38-.55.47.14.09.27.19.4.28a70.76 70.76 0 0 0 4.37-4.63c.76-.89 1.52-1.81 2.19-2.77-.3-.27-.61-.53-.92-.79-.07 1.94-4.62 6.32-5.49 7.45v-.01Z",transform:"translate(-144.023 -51.76)"}),g("path",{d:"M474.36 63.31c-.4-.16-.84-.27-1.29-.37 1.56.42 3.08 1.22 3.76 2.74.62 1.4.32 2.95-.28 4.32.7-1.22.94-2.34.74-3.47-.24-1.33-1.19-2.54-2.93-3.21v-.01ZM477.34 89.18c-1.2-.81-2.4-1.62-3.6-2.42-.14.1-.26.19-.4.29 1.4.67 2.73 1.39 4 2.13ZM465.88 93.85c.37.25.74.5 1.1.75.46.32.92.65 1.38.97-1.57-1.2-2.01-1.61-2.49-1.72h.01ZM574.92 90.06c-2.28-5.21-4.93-11.13-5.67-12.26-.1-.15-1.57-3.01-1.63-3.08 0 0-.01.02-.02.02.4 1.37 1.09 2.69 1.65 3.99 2.14 4.95 4.36 9.86 6.67 14.73.6 1.26 1.21 2.52 1.83 3.78-.75-2.01-1.64-4.45-2.83-7.18ZM448.73 65.29c.1.2.22.38.34.57.22-.02.43-.06.65-.08v-.08c-.14-.05-.25 0-.99-.41ZM460.16 94.81c-.02.31-.06.59-.1.89-.03 1.71-.33 3.43-.79 5.07.15-.02.3-.03.45-.05.01-.04.02-.08.03-.11.09-.34.15-.69.2-1.03.17-1.07.25-2.16.33-3.24.05-.69.08-1.39.12-2.08-.27.1-.27.26-.24.57v-.02Z",transform:"translate(-144.023 -51.76)"}),g("path",{d:"m328.67 98.12-3.22-6.58c-1.29-2.63-2.53-5.29-3.72-7.97-.25-.85-.52-1.69-.79-2.53-.81-2.57-1.67-5.12-2.55-7.67-1.92-5.53-3.9-11.08-6.32-16.41-.72-1.58-1.46-3.44-2.63-4.79-.03-.17-.16-.29-.34-.36a.282.282 0 0 0-.23-.04c-.06-.01-.12 0-.18.01-.74.06-1.5.38-2.19.61-2.22.77-4.4 1.64-6.63 2.38-.03-.08-.06-.16-.09-.25-.15-.42-.82-.24-.67.19.03.09.07.19.1.28l-.18.06c-.36.11-.28.6 0 .68.18 1.18.63 2.36.98 3.49.03.09.06.17.08.26-.08.23-.17.46-.24.64-.37.98-.79 1.94-1.21 2.9-1.27 2.89-2.62 5.75-3.98 8.6-3.18 6.67-6.44 13.31-9.64 19.97-1.08 2.25-2.2 4.5-3.15 6.81-.13.32.24.5.5.37 1.34 1.33 2.84 2.5 4.4 3.57.65.44 1.31.87 2.01 1.24.4.22.86.48 1.33.5.24.01.35-.19.33-.37.11-.1.21-.21.28-.28.41-.41.81-.84 1.2-1.26.85-.92 1.69-1.87 2.5-2.84 6.31-2.34 12.6-4.31 18.71-5.84 2.14 5.3 3.43 8.43 3.97 9.58.55 1.05 1.15 1.88 1.82 2.52 1.32.56 6.96-.03 9.23-1.96.87-1.28 1.19-2.67.93-4.15-.09-.5-.22-.95-.4-1.33l-.01-.03Zm-20.09-45.61c.43.77.83 1.56 1.21 2.35-.54-.45-1.27-.99-2.07-1.49-.42-.24-.6-.35-.94-.34.43-.15.85-.29 1.29-.41.17-.05.34-.08.51-.11Zm-25.86 45.66c.78-1.85 1.67-3.66 2.54-5.47 1.51-3.16 3.05-6.31 4.58-9.47 1.28-2.63 2.56-5.26 3.83-7.9l-1.1 2.66c-1.99 4.79-4.97 10.9-8.88 18.15-.43.76-.66 1.51-.71 2.24-.05-.05-.1-.09-.15-.14a.259.259 0 0 0-.11-.07Zm6.24 4.71c-.42-.23-.82-.48-1.22-.74 1.05.45 2 .72 2.55.72l-.21.21c-.05.05-.11.1-.16.15-.01.01-.04.03-.05.04 0-.02.03-.02.05-.03a.27.27 0 0 0-.08.07c-.05-.02-.1-.03-.14-.05-.25-.1-.49-.24-.73-.37h-.01Zm15.73-29.43c1.05 3.15 2.1 6.31 3.1 9.48.34 1.06.69 2.13 1.01 3.21-3.5.63-6.95 1.46-10.27 2.5 2.48-6.03 4.54-11.11 6.16-15.19Zm4.79 12.57c-.23-.79-.49-1.58-.73-2.36-.79-2.54-1.63-5.08-2.46-7.61l-1.2-3.6c.02-.04.04-.09.05-.13 1.6 4.45 3.28 9 5.01 13.57l-.67.12v.01Zm5.83-18.27-.15-.54c-.49-1.64-1.03-3.28-1.6-4.9.23.58.47 1.17.7 1.75 1.56 4.03 3.01 8.1 4.39 12.2-.33-.82-.67-1.64-.98-2.46l-2.35-6.05h-.01ZM390.43 79.37c-.13-10.43-.22-17.5-.24-19.97-.24-1.6.21-2.88-.65-3.65-.14-.13-.32-.23-.52-.32h.03c.45 0 .45-.69 0-.7-1.75-.03-3.5-.04-5.25-.14-1.38-.08-2.76-.21-4.15-.31-.07 0-.12.01-.17.04-.21-.07-.47.03-.45.31l.03.45c-.11.14-.19.3-.22.5-.21 1.26-.32 13.67-.36 23.59-.32 5.79-.67 11.57-.97 17.36-.09 1.73-.29 3.54-.21 5.3-.39.02-.38.64.04.69v.12c.05.44.74.45.7 0v-.06c1.1.09 2.2.21 3.3.3 1.14.19 2.44.2 3.29.17 1.73-.05 2.92-.05 3.8-.37.45-.05.9-.11 1.35-.17.44-.06.25-.73-.19-.67h-.01c.24-.32.45-.72.62-1.25.66-1.84.41-6.36.34-11.33l-.13-9.9.02.01Zm-12.26 18.17c.09-1.91.2-3.81.31-5.71.06 5.38 0 6.14-.01 6.51-.05 1.65-.21 2.81.72 3.66-.39-.04-.78-.07-1.17-.1-.06-1.44.09-2.93.16-4.35l-.01-.01ZM588.97 53.85c-2.06-.25-3.17-.51-3.76-.6a.3.3 0 0 1 .04-.08c.22-.39-.39-.75-.6-.35-.56 1.02-.9 2.19-1.26 3.29-.61 1.88-1.17 3.78-1.72 5.68-.63 2.19-1.24 4.39-1.83 6.59-.81 2.03-1.67 4.05-2.61 6.03-1.7-3.64-3.11-6.04-4.03-7.57-2.26-3.74-2.85-5.48-3.57-6.08l.31-.09c.43-.12.25-.8-.19-.67-1.06.3-2.12.6-3.17.95-.93.32-1.85.69-2.76 1.07-.13.05-.19.16-.22.27-.04.02-.08.05-.11.07-.04-.06-.07-.12-.11-.18a.354.354 0 0 0-.48-.12c-.16.09-.22.32-.13.48l.33.54c0 .09.02.18.06.28.51 1.16.78 1.38.72 1.47-2.42 3.44-5.41 7.86-6.2 9.1-1.27 1.97-2.01 3.14-2.45 3.84l-.91-6.56-.43-4.1c-.19-1.85-.37-3.23-.53-4.13-.19-1.1-.3-2.15-.45-3.16-.2-1.36-.29-2.06-.47-2.42h.04c.45.02.45-.68 0-.7-3.43-.16-6.81.94-10.17 1.48-.24-.22-.73-.04-.58.32.24.59.33 1.25.43 1.87.17 1.06.29 2.13.4 3.2.32 3.09.53 6.2.74 9.3.44 6.75.77 13.51 1.17 20.26.11 1.95.13 3.96.46 5.89.05.3.37.31.55.14.74 1.71 2.87 1.27 6.13 1.27 1.34 0 2.39.04 2.99-.11.02.32.48.53.63.18 3.61-8.26 7.41-16.46 12.05-24.2.03-.05.04-.1.05-.15.3.73.64 1.45.94 2.16.97 2.26 1.97 4.52 2.98 6.76 2.26 5.03 4.54 10.07 7.09 14.96.47.9.94 1.79 1.47 2.65.2.32.4.67.66.96-.18.25 0 .68.34.54.91-.38 1.82-.75 2.76-1.07 1.04-.35 2.11-.65 3.17-.95.39-.11.28-.66-.07-.68.62-.4.95-.96.87-1.91-.3-3.34.72-7.47.86-8.52l2.14-11.43c1.75-10.74 3.13-17.51 3.23-20.86.02-.49.08-2.84.13-3.24.17-1.25.48-1-4.96-1.65l.03-.02Zm-46.19 5.67c-.04-.24-.09-.48-.15-.71l.85-.15c-.34.24-.56.53-.7.86Zm1.95 25.12c-.36-6.63-.7-13.26-1.32-19.87 0 .02 0 .04.01.06.29 1.65.44 2.47.56 2.89 1 8.46 1.5 16.14 1.46 22.8-.06.99-.1 2-.11 3.02-.01.29-.03.68-.05 1.12-.01-.26-.03-.53-.04-.78-.19-3.08-.35-6.16-.52-9.23l.01-.01Zm36.4 18.66c-.11-.11-.24-.29-.37-.49.35.21.74.26 1.17.16-.27.11-.53.22-.8.32v.01Zm-.89-33.72c.12-.43.23-.86.35-1.29.71-1.77 1.41-3.55 2.08-5.33-.15.68-.26 1.22-.31 1.55-.5 2.94-2.13 7.59-3.58 13.36-.15-.35-.29-.66-.43-1 .61-2.44 1.25-4.87 1.9-7.3l-.01.01Zm3.56-12.48c.14-.44.28-.89.42-1.34-.13.7-.27 1.41-.42 2.11-.43 1.19-.86 2.38-1.31 3.57.42-1.45.85-2.9 1.31-4.34Zm-5.22 16.05c-.11.44-.23.87-.35 1.31-.12.46-.23.92-.35 1.38-.1-.22-.19-.4-.28-.61.34-.69.66-1.38.97-2.08h.01Zm-11.64 2.62c.06-.1.12-.19.17-.28.05.13.09.26.14.39a.398.398 0 0 0-.31-.11Zm2.3 2.98c-.56-1.3-1.25-2.63-1.65-3.99 0 0 .01-.02.02-.02.06.08 1.52 2.93 1.63 3.08.73 1.13 3.38 7.04 5.67 12.26 1.2 2.73 2.08 5.17 2.83 7.18-.62-1.25-1.23-2.51-1.83-3.78-2.31-4.87-4.53-9.78-6.67-14.73ZM275.92 87.03c-1.06-2.18-1.13-3.45-2.44-2.93-1.52.57-2.94 1.3-4.5 2.1-1.4.72-2.68 1.44-3.92 2.12.01-.25-.24-.5-.51-.34-4.8 2.93-12.41 4.7-17.28 1.31-1.98-1.77-3.32-4.15-3.97-5.78-.29-.95-.49-1.94-.63-2.93-.14-3.34 1.58-6.53 3.9-9.12.8-.79 1.68-1.51 2.66-2.12 3.7-2.3 8.22-3.07 12.51-2.51 2.71.35 5.32 1.24 7.71 2.55.39.22.75-.39.35-.6-.18-.1-.37-.18-.55-.27.56.27 1.03.33 1.51.19l-.48.39c-.15.11-.23.3-.13.48.09.15.33.24.48.13 1.3-.97 2.46-2.09 3.45-3.37.37-.29.64-.6.65-.97v-.02c.08-.33-.03-.7-.21-1.08-.31-.87-.98-2.01-2.19-3.26-2.43-2.52-3.79-3.45-5.68-4.26-1.14-.49-3.12-1.06-4.42-1.23-3.28-.42-10.64-1.21-18.18 4.11-7.74 5.46-11.94 12.3-12.23 20.61-.08 2.06.04 3.98.34 5.71.74 4.18 2.57 8 5.44 11.34 4.26 4.99 9.76 7.52 16.34 7.52 4.85 0 9.69-1.77 14.89-4.62.23-.12.45-.23.68-.35 2.19-1.1 4.37-2.23 6.46-3.5.49-.3 1.03-.61 1.5-.98 1.47-.87 1.11-1.12.49-2.95-.39-1.14-.76-2.7-2.06-5.36l.02-.01Zm-17.38-21.76c3.05-.42 6.31.79 9.36 2.35.51.39.94.68 1.33.87-5.61-2.86-12.72-3.39-18.44-.79 2.05-1.33 4.24-1.95 7.74-2.44l.01.01ZM443.67 72.67c-.4-2.2-1.15-4.33-2.37-6.22-1.49-2.32-3.58-4.19-5.91-5.64-6.17-3.81-13.75-5.11-20.83-6.01-3.23-.41-6.47-.69-9.72-.92l-1.39-.12c-.85-.07-1.52-.1-2.05-.1-1.08-.06-2.17-.12-3.25-.17-.08 0-.14.02-.19.05-.1.05-.18.14-.16.3.27 2.55-.01 5.12-.92 7.52-.15.38.4.56.62.28 1.32.59 2.68 1.05 4.08 1.37 0 2.78-.14 7.58-.33 12.91 0 0 0 .02-.01.03-.61 3.66-.79 7.42-1 11.12-.23 4.01-.43 8.03-.44 12.05 0 .64 0 1.28.03 1.93.02.31 0 .68.15.96.06.11.14.16.24.17-.2.17-.21.54.11.59 3.83.67 7.78.71 11.68.25 2.3-.19 4.87-.65 7.65-1.56 1.85-.54 3.67-1.18 5.43-1.91 7.2-3.02 14.31-8.07 17.35-15.53.76-1.86 1.17-3.8 1.31-5.75.3-1.93.28-3.82-.09-5.58l.01-.02Zm-19.32-15.42c5.74 1.41 11.94 3.68 15.65 8.55.25.32.47.65.69.99-2.3-2.82-5.68-5.69-12.88-8.23-2.16-.76-4.35-1.43-6.64-2.02 1.06.21 2.13.45 3.18.71Zm-25.82-3.04c.13 0 .27.01.4.02-.14.1-.26.23-.37.38 0-.13-.02-.26-.03-.4Zm34.82 22.17c-.75 3.09-3.55 5.66-5.88 7.58-3.35 2.76-7.21 5.03-11.28 6.54-1.33.49-2.71.9-4.12 1.15.06-1.38.08-2.76.07-4.13-.02-3.78-.16-7.56-.41-11.33-.09-1.37-.18-2.74-.37-4.1 0-.06-.03-.11-.06-.15.09-3.25.12-6.16.03-8.12 6.86 1.05 10.56 2.17 14.06 3.62 5.52 2.28 8.59 5.44 7.97 8.96l-.01-.02Zm-22 16.15c-.12 0-.23-.02-.34-.03l.34-.03v.06Zm-.69-.7c0-3.13.26-8.84.47-14.51.06 1.2.11 2.41.15 3.6.15 3.6.25 7.23.09 10.83-.24.03-.48.05-.71.07v.01Zm-12.33-30.94c.37.63 2.01 1.01 3.23 1.25v.15c-1.31-.31-2.59-.73-3.83-1.29.12-.36.23-.72.33-1.09.08.48.18.84.27.98Zm13.7 31.65v-.18c3.41-.56 6.71-2.02 9.69-3.68 2.31-1.28 4.59-2.78 6.63-4.53-4.69 4.53-11.61 8.24-16.33 8.38l.01.01Zm24.07-.75c-2.05 1.93-4.37 3.56-6.83 4.95 2.7-1.78 5.52-4.03 8.42-6.87.82-.82 1.56-1.69 2.23-2.59-1.08 1.65-2.38 3.16-3.81 4.51h-.01ZM187.16 92.14c-.79-2.47-2.1-7.12-3.1-6.87-.19-.01-2.09.77-4.08 1.54-3.06 1.18-5.91 2.13-10.09 2.82-2.74.42-5.87 1.01-10.61 1.06.04-3.34.05-6.01.05-7.99 7.97-.65 12.33-2.11 16.37-3.55 1.11-.39 2.69-1.01 2.63-1.8-.08-.35-.55-1.39-1.17-2.61-.47-1.16-.98-2.31-1.61-3.38-.42-.71-1.04-1.69-1.86-2.06-.11-.08-.22-.13-.29-.12-.02 0-.04 0-.07.01-.19-.04-.39-.05-.6-.01-.17.03-.24.15-.25.28-.04.02-.09.04-.14.05-4.33 1.48-8.85 2.33-13.24 3.61a499.1 499.1 0 0 0-.31-8.19c4.51-.99 8.88-1.38 13.11-1.82 3.68-.38 6.28.12 7.47.34.59.11.9.16 1.16.18h.1c-.1.37.44.66.62.28.02-.04.03-.08.05-.13.15.2.53.22.62-.1.17-.58.19-1.21.21-1.81v-.36c.03-.15.05-.3.07-.45.52-2.47.33-5.09-.64-7.44-.11-.27-.44-.28-.6-.14-.08-.21-.15-.42-.24-.62-.19-.41-.79-.05-.6.35.03.07.05.15.09.22-.98-.42-2.15-.54-3.17-.63-2.17-.19-4.37-.14-6.54 0-5.7.35-11.4 1.3-16.91 2.79-2.08.56-4.13 1.22-6.14 2-4.54 1.05-3.79 1.51-2.17 6.07.18.51.46 1.68.54 1.94.82 2.47 1.08 2.13 3.1 2.13s0 .05 0 .08h.52c-.48 2.66-.51 5.45-.62 8.13-.15 3.48-.22 6.96-.28 10.45 0 .41-.01.82-.02 1.23-.16.29-.33.57-.51.85-.05.38-.09.77-.14 1.18-.42 3.52-.59 6.48-.52 8.8v.34c.02.47.05.76.06.87.16 1.57-.26 3.47 1.35 3.79 1.61.32 3.5.55 4.85.55.11 0 .22-.02.33-.02 1.79.24 3.67.05 5.45-.12 2.85-.28 5.69-.7 8.51-1.19 3.03-.53 6.05-1.14 9.04-1.86 2.4-.58 4.82-1.19 7.13-2.06.51-.19 1.73-.57 2.46-1.14 1.81-.68 2.18-1 1.57-2.67-.23-.62-.48-1.49-.91-2.78l-.03-.02Zm-11.12-38.71c.89.05 1.93.08 2.89.3-.33 0-.68-.02-1.06-.03-8.28-.26-14.88.75-23.97 2.51 2.41-.64 4.85-1.16 7.28-1.59 4.87-.86 9.91-1.45 14.86-1.19Zm-26.53 22.13c.03 1.71.04 3.43 0 5.14-.04 1.27-.11 2.55-.24 3.82 0-.73.02-1.46.04-2.19.05-2.26.12-4.51.22-6.77h-.02Zm6.73 27.85c.2-.1.4-.21.58-.33 1.82-.17 3.82-.24 5.94-.34-.86.11-1.72.24-2.58.33-1.27.14-2.61.31-3.93.34h-.01ZM534.48 85.44c-3.52-8.38-7.07-16.75-10.5-25.17-.63-1.54-1.25-3.09-1.86-4.65-.31-.8-.65-1.6-.87-2.43-.04-.17-.17-.24-.31-.25.1-.2 0-.51-.29-.53-1.59-.08-3.18-.22-4.78-.25-1.96-.03-3.91.13-5.84.42-.31.05-.31.38-.13.56-.03.06-.05.14-.04.22.23 1.54.63 3.06 1.16 4.53.13.35.27.7.41 1.06l-2.68 6.18c-.11.03-.2.09-.25.22-.67 1.9-1.52 3.73-2.34 5.56a536.85 536.85 0 0 1-3.9 8.45c-2.64 5.64-5.34 11.25-7.91 16.93-.44.97-.88 1.94-1.29 2.93-.2.48-.47 1-.55 1.52v.05c-.02.12.02.26.16.34 1.19.73 2.41 1.41 3.66 2.05 1.2.62 2.45 1.25 3.76 1.61.43.12.62-.55.19-.67-1.13-.31-2.2-.83-3.24-1.36 1.09.36 2.1.69 2.75.93 2.82 1.01 2.38 1.1 4.3-3.75 2.1-1.09 4.34-1.96 6.53-2.79 4.35-1.64 8.8-3.03 13.27-4.29.82 2.01 1.77 3.97 2.72 5.92.35.83.62 1.45.79 1.82.22.42.45.8.69 1.15.17.33.33.67.5 1 .42.8.84 1.63 1.4 2.35.23.29.6 0 .55-.31 1.53-.02 3.06-.07 4.58-.27.92-.12 1.82-.32 2.71-.54 1.39-.27 3.85-1.11 3.74-1.42-.67-1.96-1.55-3.87-2.34-5.78-1.57-3.78-3.16-7.56-4.75-11.33v-.01Zm-11.65-26.16c1.54 3.81 3.12 7.6 4.7 11.4 2.94 7.05 5.91 14.09 8.87 21.13l-1.06-2.17c-2.71-5.51-5.2-11.19-7.41-16.87l-6.65-17.15c-.65-1.45-.55-2.19-.93-2.53.09 0 .18.01.28.02a.29.29 0 0 0-.04.26c.52 2.02 1.47 3.98 2.25 5.91h-.01Zm-6.58 13.58c.05-.15.09-.31.14-.46 1.41 3.92 2.88 7.9 4.39 11.87-3.22.52-6.38 1.25-9.46 2.14.55-1.22 1.05-2.46 1.53-3.7 1.24-3.24 2.37-6.53 3.39-9.85h.01Zm-.23-20c.36 0 .73.03 1.09.05-2.15.1-5.18.33-5.87.74-.24.15-.41.3-.53.45-.06-.29-.13-.58-.18-.88 1.82-.26 3.65-.39 5.49-.35v-.01Zm-.09 18.72c-.49 1.67-1.05 3.33-1.6 4.97-1.07 3.19-2.19 6.38-3.57 9.46-.09.21-.19.43-.29.65-.25.07-.5.14-.74.22 2.53-6.16 4.61-11.29 6.2-15.3Zm-6.34 25.16c4.97-2.38 9.37-4.1 14.02-5.27l.26.64c-4.8 1.35-9.63 2.8-14.28 4.63Zm20.17 6.76c.33.23.68.42 1.04.56h-.33c-.12 0-.21.06-.26.13-.15-.23-.31-.45-.45-.7v.01ZM226.57 91.75c-3.55-4.74-6.68-9.11-9.31-12.99 9.2-15.25 10.05-17.81 10.35-18.38.17-.34 1.09-2.27.64-2.53-1.13-.65-1.03-.65-2.97-1.71-1.19-.65-3.04-1.61-4.53-2.12-1.71-.59-1.24-.36-3 2.77-.06.1-.11.2-.17.3-.75 1.02-1.48 2.05-2.2 3.09-1.88 2.71-3.73 5.45-5.69 8.1-3.68-4.91-6.88-8.76-9.51-11.43-.15-.15-.3-.29-.46-.42-1.27-1.28-7.24 3.53-7.93 5.58-.09.09-.19.16-.28.25-.27.26.03.64.33.58.19.65.5 1.29.94 1.91 3.85 5.06 7.19 9.76 9.94 14-1.23 2.61-3.06 5-4.67 7.38l-2.28 3.33c-.5.66-.93 1.23-1.29 1.69-.67.93-2.09 2.61-2.3 3.87-.51.85-1.16 1.84-1.29 2.83-.06.44.61.63.67.19.01-.08.04-.15.06-.22 1.36 1.08 2.76 2.11 4.19 3.11 1.3.91 2.62 1.85 4.04 2.56.21.1.4 0 .48-.17.24.07.48.14.72.2.44.1.62-.57.19-.67-2.02-.48-3.77-1.57-5.23-3.02-.47-.46-.9-.96-1.32-1.46 1.74 1.35 4.2 2.89 5.89 4.14 1.39 1.03 2.85-2.27 4.22-4.2 1.86-2.64 3.96-5.86 5.52-8.29l10.39 14.51c.67.81 1.14 1.21 1.57 1.36-.05.24.12.51.41.4 1.53-.58 3.05-1.19 4.54-1.87 1.52-.69 3.06-1.45 4.36-2.5a.28.28 0 0 0 .12-.23c1.66-1.1.81-1.74-1.41-4.91-1.13-1.58-1.71-2.36-3.7-5.01l-.03-.02Zm2.41 6.54c.56 1.15 1.19 2.52 1.11 3.81-.06.04-.12.07-.17.1-.03-.88-.55-2.66-.94-3.91Zm-16.51-32.73c1.86-2.65 3.65-5.35 5.57-7.95.4-.55.81-1.13 1.26-1.66.19-.18.38-.33.56-.45.18.03.36.08.55.13l-8.05 10.11.12-.18h-.01ZM192.7 95.48c.79-1.37 1.66-2.69 2.54-4 1.19-1.79 2.4-3.56 3.61-5.33-.04.09-.09.17-.13.26-.1.22.03.41.2.49-2.47 3.42-4.89 6.73-6.4 9.28.21.24.4.48.63.75-.24.07-.4.36-.17.56.4.33.72.77 1.05 1.17.09.11.18.21.27.32-.84-.61-1.66-1.24-2.47-1.88.24-.57.58-1.11.87-1.61v-.01Zm7.46-10.32c.47-.81.98-1.59 1.49-2.37.31-.48.64-.95.96-1.43.26-.29.52-.56.75-.79-.99 1.48-2.09 3.03-3.2 4.59Zm10.03-16.22s-.03-.05-.05-.07c.22-.29.43-.59.64-.89-.2.32-.4.65-.58.96h-.01ZM371.54 87.96c-.01-.08-.01-.16-.03-.23-.06-.38-.58-.29-.66.03-.3-.05-.6-.08-.81-.11-1.14-.15-2.29-.19-3.44-.2 1.04-.09 2.09-.18 3.14-.23.45-.02.45-.72 0-.7-6.57.35-13.14 1.23-19.65 2.11-1.53.21-3.05.42-4.57.68-.01 0-.02.01-.04.01-.04-3.33-.13-6.66-.24-9.99-.19-5.7-.4-11.41-.88-17.1-.13-1.51-.23-3.07-.49-4.58 0-.25 0-.48-.02-.68-.06-1.19-.04-2.61-.68-2.78-.16-.07-.72-.16-1.5-.24.22-.17.16-.62-.2-.63-1.19-.04-2.39.09-3.57.23-1.2.14-2.41.32-3.59.6-.16-.1-.41-.06-.5.12-.06.02-.13.03-.19.05-.35.1-.29.55-.03.66-.26.6-.19 2.27-.21 3-.02.66-.66 33.73-.9 40.3-.03.65.06 1.12.04 1.45-.16 3.05.87 4.96 6.34 3.93 1.09-.08 2.75-.77 5.36-1.43 4.13-1.04 5.78-1.52 6.2-1.65 6.43-1.69 6.78-1.97 11.72-2.43.55-.05 4.8-.38 6.03-.3.64.04 1.19.07 1.65.1.09 0 .16-.03.24-.05.1.27.56.33.66-.02.39-1.32.61-2.71.78-4.08.2-1.61.29-3.24.15-4.86.24.03.52-.23.38-.53-.09-.2-.27-.33-.49-.43v-.02Zm-.63.56c.07.57.11 1.14.11 1.71-.21-.99-.53-1.71-.95-1.87.22.03.44.06.65.11.06.01.12.04.19.05Zm-25.41 1.73c1.54-.36 3.1-.64 4.66-.89-1.61.37-3.18.77-4.66 1.2v-.31Zm-.86-7.37c-.07-1.37-.16-2.75-.25-4.12-.21-3.13-.45-6.27-.79-9.4.02-2.25.08-4.31.13-6.11.16 2.08.29 4.16.4 6.24.23 4.46.38 8.93.5 13.39h.01Zm-.94-4c.16 2.41.29 4.83.39 7.24.06 1.6.14 3.22.09 4.83-.15.05-.32.09-.47.14V78.88h-.01ZM483.72 92.83c-3.05-2.28-6.22-4.4-9.38-6.51 8.86-6.49 13.49-12.95 13.73-19.23.04-.76 0-1.5-.13-2.2-.67-3.82-3.5-6.68-8.39-8.48.13.04.27.08.4.13 3.92 1.39 7.74 4.23 8.5 8.56.34 1.95-.05 3.96-.98 5.69-.21.4.39.75.6.35 1.86-3.46 1.46-7.55-.97-10.63-3.53-4.47-9.76-5.88-15.16-6.16-2.32-.12-4.64-.04-6.95.19-6 .32-12.71 1.68-17.63 3.21-.37.11-.67.23-.92.35-.2-.17-.62.02-.57.37v.03c-.64.68-.18 1.64.48 3.21.38.91.67 1.89 1.15 2.58.32.76.68 1.51 1.13 2.19.14.21.38.19.53.07.19-.02.38-.05.57-.08v1.57c-.06.06-.1.13-.11.23-.27 4.18-.34 8.38-.48 12.57l-.3 9.03c-.24 3.91-.44 6.77-.46 7.26-.05.88-.11 1.95.07 2.81-.01.22-.02.43-.04.65 0 .11-.02.23-.03.35 0 .05-.03.27-.01.16-.05.4.5.59.64.28.05.04.12.08.2.08 1.75.13 3.5.28 5.25.3 1.69.02 3.38-.12 5.06-.32.08.23.36.39.55.15.06-.08.11-.17.16-.26.18-.09.24-.32.18-.48.05-.2.1-.4.13-.6.16-.86.25-1.74.33-2.62.11-1.17.17-2.34.23-3.51.15-.01.32-.03.52-.04.36-.03 1.73-.15 2.06-.15.39 0 .7-.02.95-.04 1.76 1.11 3.45 2.35 5.14 3.55 2.83 2.01 5.64 4.04 8.47 6.04 1.42 1 2.85 2 4.29 2.97.1.06.19.07.27.04.08 0 .17-.02.25-.1 1.61-1.56 3.15-3.18 4.6-4.88.75-.88 1.49-1.78 2.15-2.73.01.01.03.02.04.03.34.3.83-.2.49-.49-2.16-1.9-4.34-3.76-6.64-5.48l.03-.01Zm-6.38-3.65a55.72 55.72 0 0 0-4-2.13c.14-.1.26-.19.4-.29 1.2.81 2.4 1.61 3.6 2.42Zm-20.1 11.78c.67-.37 1.23-.91 1.67-1.6-.11.5-.24 1-.38 1.49-.43.04-.86.08-1.29.11Zm2.38-37.24c1.34-.31 2.56-.52 3.71-.69-1.03.19-2.04.41-3.04.65-.14-.07-.34-.02-.45.11-.07.02-.15.04-.22.05v-.13.01Zm.04.84c.07-.02.14-.03.2-.05.34 1.66.41 3.41.5 5.09.17 2.9.24 5.81.28 8.71l.03 3.17c-.17.07-.34.14-.51.2-.06-4.96-.21-10.58-.51-17.12h.01Zm16.04 5.62c-1.16 2.25-3.06 4.1-5.02 5.66-2.8 2.23-5.99 3.97-9.3 5.35-.01-3.56-.09-7.12-.27-10.67-.1-2.04-.16-4.16-.57-6.18 3.3-.78 6.72-1.36 10.1-1.1 1.85.14 4.23.59 5.32 2.29.92 1.43.46 3.24-.26 4.65Zm.85-.18c.6-1.37.9-2.92.28-4.32-.67-1.52-2.2-2.32-3.76-2.74.46.1.89.21 1.29.37 1.74.67 2.69 1.88 2.93 3.21.2 1.13-.05 2.25-.74 3.47V70Zm-27.47-4.14c-.12-.19-.23-.38-.34-.57.74.42.85.36.99.41v.08c-.22.03-.43.06-.65.08Zm11.21 30.46c-.08 1.08-.16 2.17-.33 3.24-.05.35-.11.69-.2 1.03 0 .04-.02.07-.03.11-.15.02-.3.04-.45.05.45-1.64.76-3.36.79-5.07.03-.29.08-.57.1-.89-.03-.31-.03-.47.24-.57-.04.69-.07 1.39-.12 2.08v.02Zm5.6-2.47c.48.11.92.52 2.49 1.72-.46-.32-.92-.65-1.38-.97-.37-.25-.73-.5-1.1-.75h-.01Zm21.23 7.24a70.76 70.76 0 0 1-4.37 4.63c-.14-.09-.27-.19-.4-.28.19-.09.37-.24.55-.47.87-1.14 5.43-5.51 5.49-7.45.31.26.62.53.92.79-.67.97-1.42 1.88-2.19 2.77v.01Z",fill:"currentColor",transform:"translate(-144.023 -51.76)"})]}),KU=({style:t,size:e="small",withText:n})=>M("div",{className:`ExcalidrawLogo is-${e}`,style:t,children:[g(hme,{}),n&&g(fme,{})]}),C4=({icon:t,shortcut:e,children:n})=>{const r=_r();return M(ge,{children:[g("div",{className:"welcome-screen-menu-item__icon",children:t}),g("div",{className:"welcome-screen-menu-item__text",children:n}),e&&!r.editor.isMobile&&g("div",{className:"welcome-screen-menu-item__shortcut",children:e})]})};C4.displayName="WelcomeScreenMenuItemContent";const e1=({onSelect:t,children:e,icon:n,shortcut:r,className:i="",...s})=>g("button",{...s,type:"button",className:`welcome-screen-menu-item ${i}`,onClick:t,children:g(C4,{icon:n,shortcut:r,children:e})});e1.displayName="WelcomeScreenMenuItem";const qU=({children:t,href:e,icon:n,shortcut:r,className:i="",...s})=>g("a",{...s,className:`welcome-screen-menu-item ${i}`,href:e,target:"_blank",rel:"noreferrer",children:g(C4,{icon:n,shortcut:r,children:t})});qU.displayName="WelcomeScreenMenuItemLink";const As=({children:t})=>{const{WelcomeScreenCenterTunnel:e}=Nr();return g(e.In,{children:g("div",{className:"welcome-screen-center",children:t||M(ge,{children:[g(I4,{}),g(A4,{children:I("welcomeScreen.defaults.center_heading")}),M(k4,{children:[g(P4,{}),g(M4,{})]})]})})})};As.displayName="Center";const I4=({children:t})=>g("div",{className:"welcome-screen-center__logo virgil welcome-screen-decor",children:t||g(KU,{withText:!0})});I4.displayName="Logo";const A4=({children:t})=>g("div",{className:"welcome-screen-center__heading welcome-screen-decor virgil",children:t});A4.displayName="Heading";const k4=({children:t})=>g("div",{className:"welcome-screen-menu",children:t});k4.displayName="Menu";const M4=()=>{const t=$i();return g(e1,{onSelect:()=>t.executeAction(v4),shortcut:"?",icon:mS,children:I("helpDialog.title")})};M4.displayName="MenuItemHelp";const P4=()=>{const t=br(),e=$i();return t.viewModeEnabled?null:g(e1,{onSelect:()=>e.executeAction(h3),shortcut:Th("loadScene"),icon:gS,children:I("buttons.load")})};P4.displayName="MenuItemLoadScene";const JU=({onSelect:t})=>{const{t:e}=Nn();return g(e1,{shortcut:null,onSelect:t,icon:yS,children:e("labels.liveCollaboration")})};JU.displayName="MenuItemLiveCollaborationTrigger";As.Logo=I4;As.Heading=A4;As.Menu=k4;As.MenuItem=e1;As.MenuItemLink=qU;As.MenuItemHelp=M4;As.MenuItemLoadScene=P4;As.MenuItemLiveCollaborationTrigger=JU;const L4=({children:t})=>{const{WelcomeScreenMenuHintTunnel:e}=Nr();return g(e.In,{children:M("div",{className:"virgil welcome-screen-decor welcome-screen-decor-hint welcome-screen-decor-hint--menu",children:[tee,g("div",{className:"welcome-screen-decor-hint__label",children:t||I("welcomeScreen.defaults.menuHint")})]})})};L4.displayName="MenuHint";const R4=({children:t})=>{const{WelcomeScreenToolbarHintTunnel:e}=Nr();return g(e.In,{children:M("div",{className:"virgil welcome-screen-decor welcome-screen-decor-hint welcome-screen-decor-hint--toolbar",children:[g("div",{className:"welcome-screen-decor-hint__label",children:t||I("welcomeScreen.defaults.toolbarHint")}),ree]})})};R4.displayName="ToolbarHint";const O4=({children:t})=>{const{WelcomeScreenHelpHintTunnel:e}=Nr();return g(e.In,{children:M("div",{className:"virgil welcome-screen-decor welcome-screen-decor-hint welcome-screen-decor-hint--help",children:[g("div",{children:t||I("welcomeScreen.defaults.helpHint")}),nee]})})};O4.displayName="HelpHint";const Tr=t=>g(ge,{children:t.children||M(ge,{children:[g(As,{}),g(L4,{}),g(R4,{}),g(O4,{})]})});Tr.displayName="WelcomeScreen";Tr.Center=As;Tr.Hints={MenuHint:L4,ToolbarHint:R4,HelpHint:O4};const QU=({isCollaborating:t,onSelect:e,...n})=>{const r=br();return M(vm,{...n,className:Ee("collab-button",{active:t}),type:"button",onSelect:e,style:{position:"relative"},title:I("labels.liveCollaboration"),children:[yS,r.collaborators.size>0&&g("div",{className:"CollabButton-collaborators",children:r.collaborators.size})]})};QU.displayName="LiveCollaborationTrigger";const e$=({children:t,icon:e})=>{const{TTDDialogTriggerTunnel:n}=Nr(),r=Fr();return g(n.In,{children:M(it.Item,{onSelect:()=>{at("ai","dialog open","ttd"),r({openDialog:{name:"ttd",tab:"text-to-diagram"}})},icon:e??Gte,children:[t??I("labels.textToDiagram"),g(it.Item.Badge,{children:"AI"})]})})};e$.displayName="TTDDialogTrigger";const bg={width:100,height:0},Za=100,pme=(t,e)=>{const n=Ni({x:0,y:0,textAlign:Dp.CENTER,verticalAlign:ai.MIDDLE,...e,containerId:t.id,strokeColor:e.strokeColor||t.strokeColor});return Object.assign(t,{boundElements:(t.boundElements||[]).concat({type:"text",id:n.id})}),go(n,t),[t,n]},eM=(t,e,n,r)=>{let i,s;if(Object.assign(t,{startBinding:(t==null?void 0:t.startBinding)||null,endBinding:t.endBinding||null}),e){const c=(e==null?void 0:e.width)??Za,u=(e==null?void 0:e.height)??Za;let d;e.id&&(d=r.getElement(e.id),d||console.error(`No element for start binding with id ${e.id} found`));const h=e.x||t.x-c,f=e.y||t.y-u/2,p=d?d.type:e.type;if(p){if(p==="text"){let m="";d&&d.type==="text"?m=d.text:e.type==="text"&&(m=e.text),m||console.error(`No text found for start binding text element for ${t.id}`),i=Ni({x:h,y:f,type:"text",...d,...e,text:m}),Object.assign(i,{x:e.x||t.x-i.width,y:e.y||t.y-i.height/2})}else switch(p){case"rectangle":case"ellipse":case"diamond":{i=bl({x:h,y:f,width:c,height:u,...d,...e,type:p});break}default:zd(t,`Unhandled element start type "${e.type}"`,!0)}Jp(t,i,"start")}}if(n){const c=(n==null?void 0:n.height)??Za,u=(n==null?void 0:n.width)??Za;let d;n.id&&(d=r.getElement(n.id),d||console.error(`No element for end binding with id ${n.id} found`));const h=n.x||t.x+t.width,f=n.y||t.y-c/2,p=d?d.type:n.type;if(p){if(p==="text"){let m="";d&&d.type==="text"?m=d.text:n.type==="text"&&(m=n.text),m||console.error(`No text found for end binding text element for ${t.id}`),s=Ni({x:h,y:f,type:"text",...d,...n,text:m}),Object.assign(s,{y:n.y||t.y-s.height/2})}else switch(p){case"rectangle":case"ellipse":case"diamond":{s=bl({x:h,y:f,width:u,height:c,...d,...n,type:p});break}default:zd(t,`Unhandled element end type "${p}"`,!0)}Jp(t,s,"end")}}const o=t.points.length-1,a=.5,l=Hc(t.points);return t.points[o][0]>t.points[o-1][0]&&(l[0][0]=a,l[o][0]-=a),t.points[o][0]<t.points[o-1][0]&&(l[0][0]=-a,l[o][0]+=a),t.points[o][1]>t.points[o-1][1]&&(l[0][1]=a,l[o][1]-=a),t.points[o][1]<t.points[o-1][1]&&(l[0][1]=-a,l[o][1]+=a),Object.assign(t,{points:l}),{linearElement:t,startBoundElement:i,endBoundElement:s}};class mme{constructor(){O(this,"excalidrawElements",new Map);O(this,"add",e=>{e&&this.excalidrawElements.set(e.id,e)});O(this,"getElements",()=>Array.from(this.excalidrawElements.values()));O(this,"getElement",e=>this.excalidrawElements.get(e))}}const t$=(t,e)=>{var o,a,l;if(!t)return[];const n=Hc(t),r=new mme,i=new Map,s=new Map;for(const c of n){let u;const d=c.id;switch((e==null?void 0:e.regenerateIds)!==!1&&Object.assign(c,{id:Di()}),c.type){case"rectangle":case"ellipse":case"diamond":{const f=(o=c==null?void 0:c.label)!=null&&o.text&&c.width===void 0?0:(c==null?void 0:c.width)||Za,p=(a=c==null?void 0:c.label)!=null&&a.text&&c.height===void 0?0:(c==null?void 0:c.height)||Za;u=bl({...c,width:f,height:p});break}case"line":{const f=c.width||bg.width,p=c.height||bg.height;u=sl({width:f,height:p,points:[[0,0],[f,p]],...c});break}case"arrow":{const f=c.width||bg.width,p=c.height||bg.height;u=sl({width:f,height:p,endArrowhead:"arrow",points:[[0,0],[f,p]],...c}),Object.assign(u,PN(u.points));break}case"text":{const f=(c==null?void 0:c.fontFamily)||ca,p=(c==null?void 0:c.fontSize)||_s,m=(c==null?void 0:c.lineHeight)||Kc(f),v=c.text??"",y=im(v),b=ia(y,mn({fontFamily:f,fontSize:p}),m);u=Ni({width:b.width,height:b.height,fontFamily:f,fontSize:p,...c});break}case"image":{u=GO({width:(c==null?void 0:c.width)||Za,height:(c==null?void 0:c.height)||Za,...c});break}case"frame":{u=HO({x:0,y:0,...c});break}case"magicframe":{u=_x({x:0,y:0,...c});break}case"freedraw":case"iframe":case"embeddable":{u=c;break}default:u=c,zd(c,`Unhandled element type "${c.type}"`,!0)}r.getElement(u.id)?console.error(`Duplicate id found for ${u.id}`):(r.add(u),i.set(u.id,c),d&&s.set(d,u.id))}for(const[c,u]of i){const d=r.getElement(c);switch(u.type){case"rectangle":case"ellipse":case"diamond":case"arrow":{if((l=u.label)!=null&&l.text){let[h,f]=pme(d,u==null?void 0:u.label);if(r.add(h),r.add(f),h.type==="arrow"){const p=u.type==="arrow"?u==null?void 0:u.start:void 0,m=u.type==="arrow"?u==null?void 0:u.end:void 0;if(p&&p.id){const _=s.get(p.id);_&&Object.assign(p,{id:_})}if(m&&m.id){const _=s.get(m.id);_&&Object.assign(m,{id:_})}const{linearElement:v,startBoundElement:y,endBoundElement:b}=eM(h,p,m,r);h=v,r.add(v),r.add(y),r.add(b)}}else switch(u.type){case"arrow":{const{start:h,end:f}=u;if(h&&h.id){const y=s.get(h.id);Object.assign(h,{id:y})}if(f&&f.id){const y=s.get(f.id);Object.assign(f,{id:y})}const{linearElement:p,startBoundElement:m,endBoundElement:v}=eM(d,h,f,r);r.add(p),r.add(m),r.add(v);break}}break}}}for(const[c,u]of i){if(u.type!=="frame"&&u.type!=="magicframe")continue;const d=r.getElement(c);if(!d)throw new Error(`Excalidraw element with id ${c} doesn't exist`);const h=[];u.children.forEach(E=>{var T;const w=s.get(E);if(!w)throw new Error(`Element with ${E} wasn't mapped correctly`);const x=r.getElement(w);if(!x)throw new Error(`Frame element with id ${w} doesn't exist`);Object.assign(x,{frameId:d.id}),(T=x==null?void 0:x.boundElements)==null||T.forEach(C=>{const k=r.getElement(C.id);if(!k)throw new Error(`Bound element with id ${C.id} doesn't exist`);Object.assign(k,{frameId:d.id}),h.push(k)}),h.push(x)});let[f,p,m,v]=Ut(h);const y=10;f=f-y,p=p-y,m=m+y,v=v+y;const b=Math.max(d==null?void 0:d.width,m-f),_=Math.max(d==null?void 0:d.height,v-p);Object.assign(d,{x:f,y:p,width:b,height:_})}return r.getElements()},gme=t=>{var H,W,q,Z;const{onChange:e,initialData:n,excalidrawAPI:r,isCollaborating:i=!1,onPointerUpdate:s,renderTopRightUI:o,langCode:a=kl.code,viewModeEnabled:l,zenModeEnabled:c,gridModeEnabled:u,libraryReturnUrl:d,theme:h,name:f,renderCustomStats:p,onPaste:m,detectScroll:v=!0,handleKeyboardGlobally:y=!1,onLibraryChange:b,autoFocus:_=!1,generateIdForFile:E,onLinkOpen:w,onPointerDown:x,onScrollChange:T,children:C,validateEmbeddable:k,renderEmbeddable:L,aiEnabled:F}=t,N=(H=t.UIOptions)==null?void 0:H.canvasActions,R={...t.UIOptions,canvasActions:{...MC.canvasActions,...N},tools:{image:((q=(W=t.UIOptions)==null?void 0:W.tools)==null?void 0:q.image)??!0}};return N!=null&&N.export&&(R.canvasActions.export.saveFileToDisk=((Z=N.export)==null?void 0:Z.saveFileToDisk)??MC.canvasActions.export.saveFileToDisk),R.canvasActions.toggleTheme===null&&typeof h>"u"&&(R.canvasActions.toggleTheme=!0),A.useEffect(()=>{const j=K=>{typeof K.scale=="number"&&K.scale!==1&&K.preventDefault()};return document.addEventListener("touchmove",j,{passive:!1}),()=>{document.removeEventListener("touchmove",j)}},[]),g(NT,{unstable_createStore:()=>zo,scope:rr,children:g(dme,{langCode:a,theme:h,children:g(V4,{onChange:e,initialData:n,excalidrawAPI:r,isCollaborating:i,onPointerUpdate:s,renderTopRightUI:o,langCode:a,viewModeEnabled:l,zenModeEnabled:c,gridModeEnabled:u,libraryReturnUrl:d,theme:h,name:f,renderCustomStats:p,UIOptions:R,onPaste:m,detectScroll:v,handleKeyboardGlobally:y,onLibraryChange:b,autoFocus:_,generateIdForFile:E,onLinkOpen:w,onPointerDown:x,onScrollChange:T,validateEmbeddable:k,renderEmbeddable:L,aiEnabled:F!==!1,children:C})})})},yme=(t,e)=>{if(t.children!==e.children)return!1;const{initialData:n,UIOptions:r={},...i}=t,{initialData:s,UIOptions:o={},...a}=e,l=Object.keys(r),c=Object.keys(o);return l.length!==c.length?!1:l.every(d=>d==="canvasActions"?Object.keys(r.canvasActions).every(f=>{var p,m,v,y;return f==="export"&&((p=r==null?void 0:r.canvasActions)!=null&&p.export)&&((m=o==null?void 0:o.canvasActions)!=null&&m.export)?r.canvasActions.export.saveFileToDisk===o.canvasActions.export.saveFileToDisk:((v=r==null?void 0:r.canvasActions)==null?void 0:v[f])===((y=o==null?void 0:o.canvasActions)==null?void 0:y[f])}):r[d]===o[d])&&Pr(i,a)},n$=ce.memo(gme,yme);n$.displayName="Excalidraw";const vme=({canvasRef:t,setError:e})=>{const n=t.current;if(!n)return;const r=n.parentElement;r&&(r.style.background="",e(null),n.replaceChildren())},r$=async({canvasRef:t,mermaidToExcalidrawLib:e,mermaidDefinition:n,setError:r,data:i})=>{const s=t.current,o=s==null?void 0:s.parentElement;if(!(!s||!o)){if(!n){vme({canvasRef:t,setError:r});return}try{const a=await e.api;let l;try{l=await a.parseMermaidToExcalidraw(n,{fontSize:_s})}catch{l=await a.parseMermaidToExcalidraw(n.replace(/"/g,"'"),{fontSize:_s})}const{elements:c,files:u}=l;r(null),i.current={elements:t$(c,{regenerateIds:!0}),files:u};const d=await b2({elements:i.current.elements,files:i.current.files,exportPadding:oh,maxWidthOrHeight:Math.max(o.offsetWidth,o.offsetHeight)*window.devicePixelRatio});await sm(d),o.style.background="var(--default-bg-color)",s.replaceChildren(d)}catch(a){throw o.style.background="var(--default-bg-color)",n&&r(a),a}}},D4=t=>{co.set(il.MERMAID_TO_EXCALIDRAW,t)},i$=({app:t,data:e,text:n,shouldSaveMermaidDataToStorage:r})=>{const{elements:i,files:s}=e.current;i.length&&(t.addElementsFromPasteOrLibrary({elements:i,files:s,position:"center",fitToContent:!0}),t.setOpenDialog(null),r&&n&&D4(n))},s$=({children:t})=>g("div",{className:"ttd-dialog-panels",children:t}),nv=({label:t,children:e,panelAction:n,panelActionDisabled:r=!1,onTextSubmitInProgess:i,renderTopRight:s,renderSubmitShortcut:o,renderBottomRight:a})=>M("div",{className:"ttd-dialog-panel",children:[M("div",{className:"ttd-dialog-panel__header",children:[g("label",{children:t}),s==null?void 0:s()]}),e,M("div",{className:Ee("ttd-dialog-panel-button-container",{invisible:!n}),style:{display:"flex",alignItems:"center"},children:[M(vm,{className:"ttd-dialog-panel-button",onSelect:n?n.action:()=>{},disabled:r||i,children:[M("div",{className:Ee({invisible:i}),children:[n==null?void 0:n.label,(n==null?void 0:n.icon)&&g("span",{children:n.icon})]}),i&&g(_l,{})]}),!r&&!i&&(o==null?void 0:o()),a==null?void 0:a()]})]}),o$=({input:t,placeholder:e,onChange:n,onKeyboardSubmit:r})=>{const i=A.useRef(null),s=A.useRef(r);return s.current=r,A.useEffect(()=>{if(!s.current)return;const o=i.current;if(o){const a=l=>{var c;l[z.CTRL_OR_CMD]&&l.key===z.ENTER&&(l.preventDefault(),(c=s.current)==null||c.call(s))};return o.addEventListener(ee.KEYDOWN,a),()=>{o.removeEventListener(ee.KEYDOWN,a)}}},[]),g("textarea",{className:"ttd-dialog-input",onChange:n,value:t,placeholder:e,autoFocus:!0,ref:i})},bme=({error:t})=>M("div",{"data-testid":"ttd-dialog-output-error",className:"ttd-dialog-output-error",children:["Error! ",g("p",{children:t})]}),a$=({error:t,canvasRef:e,loaded:n})=>M("div",{className:"ttd-dialog-output-wrapper",children:[t&&g(bme,{error:t.message}),n?g("div",{ref:e,style:{opacity:t?"0.15":1},className:"ttd-dialog-output-canvas-container"}):g(_l,{size:"2rem"})]}),l$=()=>M("div",{className:"ttd-dialog-submit-shortcut",children:[g("div",{className:"ttd-dialog-submit-shortcut__key",children:re("CtrlOrCmd")}),g("div",{className:"ttd-dialog-submit-shortcut__key",children:re("Enter")})]}),_me=`flowchart TD
 A[Christmas] -->|Get money| B(Go shopping)
 B --> C{Let me think}
 C -->|One| D[Laptop]
 C -->|Two| E[iPhone]
 C -->|Three| F[Car]`,tM=$c(D4,300),Eme=({mermaidToExcalidrawLib:t})=>{const[e,n]=A.useState(()=>co.get(il.MERMAID_TO_EXCALIDRAW)||_me),r=A.useDeferredValue(e.trim()),[i,s]=A.useState(null),o=A.useRef(null),a=A.useRef({elements:[],files:null}),l=Sh();A.useEffect(()=>{r$({canvasRef:o,data:a,mermaidToExcalidrawLib:t,setError:s,mermaidDefinition:r}).catch(()=>{}),tM(r)},[r,t]),A.useEffect(()=>()=>{tM.flush()},[]);const c=()=>{i$({app:l,data:a,text:e,shouldSaveMermaidDataToStorage:!0})};return M(ge,{children:[g("div",{className:"ttd-dialog-desc",children:g(Vr,{i18nKey:"mermaid.description",flowchartLink:u=>g("a",{href:"https://mermaid.js.org/syntax/flowchart.html",children:u}),sequenceLink:u=>g("a",{href:"https://mermaid.js.org/syntax/sequenceDiagram.html",children:u}),classLink:u=>g("a",{href:"https://mermaid.js.org/syntax/classDiagram.html",children:u})})}),M(s$,{children:[g(nv,{label:I("mermaid.syntax"),children:g(o$,{input:e,placeholder:"Write Mermaid diagram defintion here...",onChange:u=>n(u.target.value),onKeyboardSubmit:()=>{c()}})}),g(nv,{label:I("mermaid.preview"),panelAction:{action:()=>{c()},label:I("mermaid.button"),icon:n0},renderSubmitShortcut:()=>g(l$,{}),children:g(a$,{canvasRef:o,loaded:t.loaded,error:i})})]})]})},c$=({children:t,...e})=>g(SU,{className:"ttd-dialog-triggers",...e,children:t});c$.displayName="TTDDialogTabTriggers";const y3=({children:t,tab:e,onSelect:n,...r})=>g(CU,{value:e,asChild:!0,onSelect:n,children:g("button",{type:"button",className:"ttd-dialog-tab-trigger",...r,children:t})});y3.displayName="TTDDialogTabTrigger";const Q_=3,ku=1e3,wme=Yn(null),xme=Yn(null),u$=t=>{var n;const e=br();return((n=e.openDialog)==null?void 0:n.name)!=="ttd"?null:g(Tme,{...t,tab:e.openDialog.tab})},Tme=Qm("TTDDialogBase",({tab:t,...e})=>{const n=Sh(),r=Fr(),i=A.useRef(null),[s,o]=Ht(xme),[a,l]=A.useState((s==null?void 0:s.prompt)??""),c=a.trim(),u=x=>{l(x.target.value),o(T=>({generatedResponse:(T==null?void 0:T.generatedResponse)??null,prompt:x.target.value}))},[d,h]=A.useState(!1),[f,p]=Ht(wme),m=async()=>{if(c.length>ku||c.length<Q_||d||(f==null?void 0:f.rateLimitRemaining)===0||"__fallback"in e){c.length<Q_&&w(new Error(`Prompt is too short (min ${Q_} characters)`)),c.length>ku&&w(new Error(`Prompt is too long (max ${ku} characters)`));return}try{h(!0),at("ai","generate","ttd");const{generatedResponse:x,error:T,rateLimit:C,rateLimitRemaining:k}=await e.onTextSubmit(c);if(typeof x=="string"&&o(L=>({generatedResponse:x,prompt:(L==null?void 0:L.prompt)??null})),BC(C)&&BC(k)&&p({rateLimit:C,rateLimitRemaining:k}),T){w(T);return}if(!x){w(new Error("Generation failed"));return}try{await r$({canvasRef:i,data:_,mermaidToExcalidrawLib:y,setError:w,mermaidDefinition:x}),at("ai","mermaid parse success","ttd")}catch(L){console.info(`%cTTD mermaid render errror: ${L.message}`,"color: red"),console.info(`>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
TTD mermaid definition render errror: ${L.message}`,"color: yellow"),at("ai","mermaid parse failed","ttd"),w(new Error("Generated an invalid diagram :(. You may also try a different prompt."))}}catch(x){let T=x.message;(!T||T==="Failed to fetch")&&(T="Request failed"),w(new Error(T))}finally{h(!1)}},v=A.useRef(m);v.current=m;const[y,b]=A.useState({loaded:!1,api:pe(()=>import("./index-MeqYtErK.js").then(x=>x.aN),__vite__mapDeps([]))});A.useEffect(()=>{(async()=>{await y.api,b(T=>({...T,loaded:!0}))})()},[y.api]);const _=A.useRef({elements:[],files:null}),[E,w]=A.useState(null);return g(yi,{className:"ttd-dialog",onCloseRequest:()=>{n.setOpenDialog(null)},size:1200,title:!1,...e,autofocus:!1,children:M(S4,{dialog:"ttd",tab:t,children:["__fallback"in e&&e.__fallback?g("p",{className:"dialog-mermaid-title",children:I("mermaid.title")}):M(c$,{children:[g(y3,{tab:"text-to-diagram",children:M("div",{style:{display:"flex",alignItems:"center"},children:[I("labels.textToDiagram"),g("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",padding:"1px 6px",marginLeft:"10px",fontSize:10,borderRadius:"12px",background:"pink",color:"#000"},children:"AI Beta"})]})}),g(y3,{tab:"mermaid",children:"Mermaid"})]}),g(tv,{className:"ttd-dialog-content",tab:"mermaid",children:g(Eme,{mermaidToExcalidrawLib:y})}),!("__fallback"in e)&&M(tv,{className:"ttd-dialog-content",tab:"text-to-diagram",children:[g("div",{className:"ttd-dialog-desc",children:"Currently we use Mermaid as a middle step, so you'll get best results if you describe a diagram, workflow, flow chart, and similar."}),M(s$,{children:[g(nv,{label:I("labels.prompt"),panelAction:{action:m,label:"Generate",icon:n0},onTextSubmitInProgess:d,panelActionDisabled:c.length>ku||(f==null?void 0:f.rateLimitRemaining)===0,renderTopRight:()=>f?M("div",{className:"ttd-dialog-rate-limit",style:{fontSize:12,marginLeft:"auto",color:f.rateLimitRemaining===0?"var(--color-danger)":void 0},children:[f.rateLimitRemaining," requests left today"]}):null,renderSubmitShortcut:()=>g(l$,{}),renderBottomRight:()=>{if(typeof(s==null?void 0:s.generatedResponse)=="string")return M("div",{className:"excalidraw-link",style:{marginLeft:"auto",fontSize:14},onClick:()=>{typeof(s==null?void 0:s.generatedResponse)=="string"&&(D4(s.generatedResponse),r({openDialog:{name:"ttd",tab:"mermaid"}}))},children:["View as Mermaid",g(v0,{icon:n0})]});const x=c.length/ku;return x>.8?M("div",{style:{marginLeft:"auto",fontSize:12,fontFamily:"monospace",color:x>1?"var(--color-danger)":void 0},children:["Length: ",c.length,"/",ku]}):null},children:g(o$,{onChange:u,input:a,placeholder:"Describe what you want to see...",onKeyboardSubmit:()=>{v.current()}})}),g(nv,{label:"Preview",panelAction:{action:()=>{console.info("Panel action clicked"),i$({app:n,data:_})},label:"Insert",icon:n0},children:g(a$,{canvasRef:i,error:E,loaded:y.loaded})})]})]})]})})}),Sme=({UIOptions:t})=>M(xt,{__fallback:!0,children:[g(xt.DefaultItems.LoadScene,{}),g(xt.DefaultItems.SaveToActiveFile,{}),t.canvasActions.export&&g(xt.DefaultItems.Export,{}),t.canvasActions.saveAsImage&&g(xt.DefaultItems.SaveAsImage,{}),g(xt.DefaultItems.Help,{}),g(xt.DefaultItems.ClearCanvas,{}),g(xt.Separator,{}),g(xt.Group,{title:"Excalidraw links",children:g(xt.DefaultItems.Socials,{})}),g(xt.Separator,{}),g(xt.DefaultItems.ToggleTheme,{}),g(xt.DefaultItems.ChangeCanvasBackground,{})]}),Cme=()=>M(Sc,{__fallback:!0,children:[g(Sc.Actions.SaveToDisk,{}),g(Sc.Actions.ExportToImage,{})]}),Ime=({actionManager:t,appState:e,files:n,setAppState:r,elements:i,canvas:s,onLockToggle:o,onHandToolToggle:a,onPenModeToggle:l,showExitZenModeBtn:c,renderTopRightUI:u,renderCustomStats:d,UIOptions:h,onExportImage:f,renderWelcomeScreen:p,children:m,app:v,isCollaborating:y,openAIKey:b,isOpenAIKeyPersisted:_,onOpenAIAPIKeyChange:E,onMagicSettingsConfirm:w})=>{var j,K,$;const x=_r(),T=vfe(),[C,k]=Ht(o2,rr),L=()=>h.canvasActions.export?g(Gfe,{elements:i,appState:e,files:n,actionManager:t,exportOpts:h.canvasActions.export,canvas:s,setAppState:r}):null,F=()=>{var B;return!h.canvasActions.saveAsImage||((B=e.openDialog)==null?void 0:B.name)!=="imageExport"?null:g(Ife,{elements:i,appState:e,files:n,actionManager:t,onExportImage:f,onCloseRequest:()=>r({openDialog:null})})},N=()=>M("div",{style:{position:"relative"},children:[g(T.MainMenuTunnel.Out,{}),p&&g(T.WelcomeScreenMenuHintTunnel.Out,{})]}),R=()=>g(ym,{heading:"selectedShapeActions",className:Ee("selected-shape-actions zen-mode-transition",{"transition-left":e.zenModeEnabled}),children:g(lo,{className:m7.SHAPE_ACTIONS_MENU,padding:2,style:{maxHeight:`${e.height-166}px`},children:g(nU,{appState:e,elements:i,renderAction:t.renderAction})})}),H=()=>{var G,Y;const B=g4(e,i);return g(iU,{side:"top",children:M("div",{className:"App-menu App-menu_top",children:[M(Ii.Col,{gap:6,className:Ee("App-menu_top__left"),children:[N(),B&&R()]}),!e.viewModeEnabled&&g(ym,{heading:"shapes",className:"shapes-section",children:X=>M("div",{style:{position:"relative"},children:[p&&g(T.WelcomeScreenToolbarHintTunnel.Out,{}),g(Ii.Col,{gap:4,align:"start",children:M(Ii.Row,{gap:1,className:Ee("App-toolbar-container",{"zen-mode":e.zenModeEnabled}),children:[M(lo,{padding:1,className:Ee("App-toolbar",{"zen-mode":e.zenModeEnabled}),children:[g(sU,{appState:e,isMobile:x.editor.isMobile,device:x,app:v}),X,M(Ii.Row,{gap:1,children:[g(lU,{zenModeEnabled:e.zenModeEnabled,checked:e.penMode,onChange:()=>l(null),title:I("toolBar.penMode"),penDetected:e.penDetected}),g(aU,{checked:e.activeTool.locked,onChange:o,title:I("toolBar.lock")}),g("div",{className:"App-toolbar__divider"}),g(uU,{checked:Gd(e),onChange:()=>a(),title:I("toolBar.hand"),isMobile:!0}),g(rU,{appState:e,activeTool:e.activeTool,UIOptions:h,app:v})]})]}),y&&g(lo,{style:{marginLeft:8,alignSelf:"center",height:"fit-content"},children:g(cme,{title:I("toolBar.laser"),checked:e.activeTool.type===kr.laser,onChange:()=>v.setActiveTool({type:kr.laser}),isMobile:!0})})]})})]})}),M("div",{className:Ee("layer-ui__wrapper__top-right zen-mode-transition",{"transition-right":e.zenModeEnabled}),children:[e.collaborators.size>0&&g(dU,{collaborators:e.collaborators,userToFollow:((G=e.userToFollow)==null?void 0:G.socketId)||null}),u==null?void 0:u(x.editor.isMobile,e),!e.viewModeEnabled&&(!q||((Y=e.openSidebar)==null?void 0:Y.name)!==bd.name)&&g(T.DefaultSidebarTriggerTunnel.Out,{})]})]})})},W=()=>g(Q8,{__fallback:!0,onDock:B=>{at("sidebar",`toggleDock (${B?"dock":"undock"})`,`(${x.editor.isMobile?"mobile":"desktop"})`)}}),q=Pv(E4,rr),Z=M(ge,{children:[m,g(Sme,{UIOptions:h}),g(Q8.Trigger,{__fallback:!0,icon:ZQ,title:$g(I("toolBar.library")),onToggle:B=>{B&&at("sidebar",`${bd.name} (open)`,`button (${x.editor.isMobile?"mobile":"desktop"})`)},tab:bd.defaultTab,children:I("toolBar.library")}),g(Cme,{}),((j=e.openDialog)==null?void 0:j.name)==="ttd"&&g(u$,{__fallback:!0}),e.isLoading&&g(oU,{delay:250}),e.errorMessage&&g(W4,{onClose:()=>r({errorMessage:null}),children:e.errorMessage}),C&&!x.editor.isMobile&&g(Fse,{colorPickerType:C.colorPickerType,onCancel:()=>{k(null)},onChange:(B,G,Y,{altKey:X})=>{var J;if(!(B!=="elementBackground"&&B!=="elementStroke"))if(Y.length){for(const ne of Y)ae(ne,{[X&&C.swapPreviewOnAlt?B==="elementBackground"?"strokeColor":"backgroundColor":B==="elementBackground"?"backgroundColor":"strokeColor"]:G},!1),mt.delete(ne);(J=bt.getScene(Y[0]))==null||J.informMutation()}else r(B==="elementBackground"?{currentItemBackgroundColor:G}:{currentItemStrokeColor:G})},onSelect:(B,G)=>{var Y;k(X=>X!=null&&X.keepOpenOnAlt&&G.altKey?X:null),(Y=C==null?void 0:C.onSelect)==null||Y.call(C,B,G)}}),((K=e.openDialog)==null?void 0:K.name)==="help"&&g(Bfe,{onClose:()=>{r({openDialog:null})}}),(($=e.openDialog)==null?void 0:$.name)==="settings"&&g(ume,{openAIKey:b,isPersisted:_,onChange:E,onConfirm:(B,G)=>{var X,J;const Y=((X=e.openDialog)==null?void 0:X.name)==="settings"?(J=e.openDialog)==null?void 0:J.source:"settings";r({openDialog:null},()=>{w(B,G,Y)})},onClose:()=>{r({openDialog:null})}}),g(ime,{}),g(T.OverwriteConfirmDialogTunnel.Out,{}),F(),L(),e.pasteDialog.shown&&g(Lfe,{setAppState:r,appState:e,onClose:()=>r({pasteDialog:{shown:!1,data:null}})}),x.editor.isMobile&&g(Pfe,{app:v,appState:e,elements:i,actionManager:t,renderJSONExportDialog:L,renderImageExportDialog:F,setAppState:r,onLockToggle:o,onHandToolToggle:a,onPenModeToggle:l,renderTopRightUI:u,renderCustomStats:d,renderSidebars:W,device:x,renderWelcomeScreen:p,UIOptions:h}),!x.editor.isMobile&&M(ge,{children:[M("div",{className:"layer-ui__wrapper",style:e.openSidebar&&q&&x.editor.canFitSidebar?{width:`calc(100% - ${$V}px)`}:{},children:[p&&g(T.WelcomeScreenCenterTunnel.Out,{}),H(),g(hU,{appState:e,actionManager:t,showExitZenModeBtn:c,renderWelcomeScreen:p}),e.showStats&&g(cU,{appState:e,setAppState:r,elements:i,onClose:()=>{t.executeAction(qy)},renderCustomStats:d}),e.scrolledOutside&&g("button",{className:"scroll-back-to-content",onClick:()=>{r(B=>({...nm(i,B)}))},children:I("buttons.scrollBackToContent")})]}),W()]})]});return g(rN.Provider,{value:e,children:g(NT,{scope:T.jotaiScope,children:g(tU.Provider,{value:T,children:Z})})})},nM=t=>{const{suggestedBindings:e,startBoundElement:n,cursorButton:r,scrollX:i,scrollY:s,...o}=t;return o},Ame=(t,e)=>{if(t.children!==e.children)return!1;const{canvas:n,appState:r,...i}=t,{canvas:s,appState:o,...a}=e;return Pr(nM(r),nM(o),{selectedElementIds:Pr,selectedGroupIds:Pr})&&Pr(i,a)},kme=ce.memo(Ime,Ame),Mme=5e3,Pme=({message:t,onClose:e,closable:n=!1,duration:r=Mme})=>{const i=A.useRef(0),s=r!==1/0,o=A.useCallback(()=>{s&&(i.current=window.setTimeout(()=>e(),r))},[e,r,s]);return A.useEffect(()=>{if(s)return o(),()=>clearTimeout(i.current)},[o,t,r,s]),M("div",{className:"Toast",onMouseEnter:s?()=>clearTimeout(i==null?void 0:i.current):void 0,onMouseLeave:s?o:void 0,children:[g("p",{className:"Toast__message",children:t}),n&&g(st,{icon:hh,"aria-label":"close",type:"icon",onClick:e,className:"close"})]})},rM=ue({name:"viewMode",viewMode:!0,trackEvent:{category:"canvas",predicate:t=>!t.viewModeEnabled},perform(t,e){return{appState:{...e,viewModeEnabled:!this.checked(e)},commitToHistory:!1}},checked:t=>t.viewModeEnabled,predicate:(t,e,n)=>typeof n.viewModeEnabled>"u",contextItemLabel:"labels.viewMode",keyTest:t=>!t[z.CTRL_OR_CMD]&&t.altKey&&t.code===ht.R}),mp=class mp{constructor({scene:e,onSceneUpdated:n}){O(this,"scene");O(this,"onSceneUpdated");O(this,"onFontsLoaded",e=>{if(e.every(r=>{const i=`${r.family}-${r.style}-${r.weight}`;return mp.loadedFontFaces.has(i)?!0:(mp.loadedFontFaces.add(i),!1)}))return!1;let n=!1;this.scene.mapElements(r=>Se(r)&&!nn(r)?(mt.delete(r),n=!0,Re(r,{...hS(r)})):r),n&&this.onSceneUpdated()});O(this,"loadFontsForElements",async e=>{const n=await Promise.all([...new Set(e.filter(r=>Se(r)).map(r=>r.fontFamily))].map(r=>{var s,o,a,l;const i=mn({fontFamily:r,fontSize:16});if(!((o=(s=document.fonts)==null?void 0:s.check)!=null&&o.call(s,i)))return(l=(a=document.fonts)==null?void 0:a.load)==null?void 0:l.call(a,i)}));this.onFontsLoaded(n.flat().filter(Boolean))});this.scene=e,this.onSceneUpdated=n}};O(mp,"loadedFontFaces",new Set);let v3=mp;const d$=(t,e)=>{const n=e.scene.getSelectedElements(t);return n.length===1&&qe(n[0])},Lme=ue({name:"selectAllElementsInFrame",trackEvent:{category:"canvas"},perform:(t,e,n,r)=>{const i=r.scene.getSelectedElements(e).at(0)||null;if(qe(i)){const s=oa(yt(t),i.id).filter(o=>!(o.type==="text"&&o.containerId));return{elements:t,appState:{...e,selectedElementIds:s.reduce((o,a)=>(o[a.id]=!0,o),{})},commitToHistory:!1}}return{elements:t,appState:e,commitToHistory:!1}},contextItemLabel:"labels.selectAllElementsInFrame",predicate:(t,e,n,r)=>d$(e,r)}),Rme=ue({name:"removeAllElementsFromFrame",trackEvent:{category:"history"},perform:(t,e,n,r)=>{const i=r.scene.getSelectedElements(e).at(0)||null;return qe(i)?{elements:cB(t,i),appState:{...e,selectedElementIds:{[i.id]:!0}},commitToHistory:!0}:{elements:t,appState:e,commitToHistory:!1}},contextItemLabel:"labels.removeAllElementsFromFrame",predicate:(t,e,n,r)=>d$(e,r)});ue({name:"updateFrameRendering",viewMode:!0,trackEvent:{category:"canvas"},perform:(t,e)=>({elements:t,appState:{...e,frameRendering:{...e.frameRendering,enabled:!e.frameRendering.enabled}},commitToHistory:!1}),contextItemLabel:"labels.updateFrameRendering",checked:t=>t.frameRendering.enabled});ue({name:"setFrameAsActiveTool",trackEvent:{category:"toolbar"},perform:(t,e,n,r)=>{const i=kn(e,{type:"frame"});return zs(r.interactiveCanvas,{...e,activeTool:i}),{elements:t,appState:{...e,activeTool:kn(e,{type:"frame"})},commitToHistory:!1}},keyTest:t=>!t[z.CTRL_OR_CMD]&&!t.shiftKey&&!t.altKey&&t.key.toLocaleLowerCase()===z.F});const Ome=8,iM=99999,k2=t=>Ome/t,xr=class xr{};O(xr,"referenceSnapPoints",null),O(xr,"visibleGaps",null),O(xr,"setReferenceSnapPoints",e=>{xr.referenceSnapPoints=e}),O(xr,"getReferenceSnapPoints",()=>xr.referenceSnapPoints),O(xr,"setVisibleGaps",e=>{xr.visibleGaps=e}),O(xr,"getVisibleGaps",()=>xr.visibleGaps),O(xr,"destroy",()=>{xr.referenceSnapPoints=null,xr.visibleGaps=null});let ts=xr;const Tl=({event:t,appState:e,selectedElements:n})=>t?e.objectsSnapModeEnabled&&!t[z.CTRL_OR_CMD]||!e.objectsSnapModeEnabled&&t[z.CTRL_OR_CMD]&&e.gridSize===null:n.length===1&&n[0].type==="arrow"?!1:e.objectsSnapModeEnabled,Dme=(t,e,n=.01)=>Math.abs(t-e)<=n,bm=(t,{omitCenter:e,boundingBoxCorners:n,dragOffset:r}={omitCenter:!1,boundingBoxCorners:!1})=>{let i=[];if(t.length===1){const s=t[0];let[o,a,l,c,u,d]=Ve(s);r&&(o+=r.x,l+=r.x,u+=r.x,a+=r.y,c+=r.y,d+=r.y);const h=(l-o)/2,f=(c-a)/2;if((s.type==="diamond"||s.type==="ellipse")&&!n){const p=Wt([o,a+f],[u,d],s.angle),m=Wt([o+h,a],[u,d],s.angle),v=Wt([l,a+f],[u,d],s.angle),y=Wt([o+h,c],[u,d],s.angle);i=e?[p,m,v,y]:[p,m,v,y,[u,d]]}else{const p=Wt([o,a],[u,d],s.angle),m=Wt([l,a],[u,d],s.angle),v=Wt([o,c],[u,d],s.angle),y=Wt([l,c],[u,d],s.angle);i=e?[p,m,v,y]:[p,m,v,y,[u,d]]}}else if(t.length>1){const[s,o,a,l]=WS(t,r??{x:0,y:0}),c=a-s,u=l-o,d=[s,o],h=[a,o],f=[s,l],p=[a,l],m=[s+c/2,o+u/2];i=e?[d,h,f,p]:[d,h,f,p,m]}return i.map(s=>[jt(s[0]),jt(s[1])])},h$=(t,e,n)=>{const r=e.filter(i=>qe(i)).map(i=>i.id);return hB(t,e,n).filter(i=>!(i.frameId&&r.includes(i.frameId)))},Nme=(t,e,n)=>{const r=h$(t,e,n),i=zv(r).filter(u=>!(u.length===1&&nn(u[0]))).map(u=>Ut(u).map(d=>jt(d))),s=i.sort((u,d)=>u[0]-d[0]),o=[];let a=0;e:for(let u=0;u<s.length;u++){const d=s[u];for(let h=u+1;h<s.length;h++){if(++a>iM)break e;const f=s[h],[,p,m,v]=d,[y,b,,_]=f;m<y&&Oy([p,v],[b,_])&&o.push({startBounds:d,endBounds:f,startSide:[[m,p],[m,v]],endSide:[[y,b],[y,_]],length:y-m,overlap:Dy([p,v],[b,_])})}}const l=i.sort((u,d)=>u[1]-d[1]),c=[];a=0;e:for(let u=0;u<l.length;u++){const d=l[u];for(let h=u+1;h<l.length;h++){if(++a>iM)break e;const f=l[h],[p,,m,v]=d,[y,b,_]=f;v<b&&Oy([p,m],[y,_])&&c.push({startBounds:d,endBounds:f,startSide:[[p,v],[m,v]],endSide:[[y,b],[_,b]],length:b-v,overlap:Dy([p,m],[y,_])})}}return{horizontalGaps:o,verticalGaps:c}},sM=(t,e,n,r,i,s,o)=>{if(!Tl({appState:n,event:r,selectedElements:t}))return[];if(t.length===0)return[];const a=ts.getVisibleGaps();if(a){const{horizontalGaps:l,verticalGaps:c}=a,[u,d,h,f]=WS(t,e).map(v=>jt(v)),p=(u+h)/2,m=(d+f)/2;for(const v of l){if(!Oy([d,f],v.overlap))continue;const y=v.startSide[0][0]+v.length/2,b=jt(y-p);if(v.length>h-u&&Math.abs(b)<=o.x){Math.abs(b)<o.x&&(i.length=0),o.x=Math.abs(b);const L={type:"gap",direction:"center_horizontal",gap:v,offset:b};i.push(L);continue}const[,,E]=v.endBounds,w=u-E,x=jt(v.length-w);if(Math.abs(x)<=o.x){Math.abs(x)<o.x&&(i.length=0),o.x=Math.abs(x);const L={type:"gap",direction:"side_right",gap:v,offset:x};i.push(L);continue}const[T,,,]=v.startBounds,C=T-h,k=jt(C-v.length);if(Math.abs(k)<=o.x){Math.abs(k)<o.x&&(i.length=0),o.x=Math.abs(k);const L={type:"gap",direction:"side_left",gap:v,offset:k};i.push(L);continue}}for(const v of c){if(!Oy([u,h],v.overlap))continue;const y=v.startSide[0][1]+v.length/2,b=jt(y-m);if(v.length>f-d&&Math.abs(b)<=o.y){Math.abs(b)<o.y&&(s.length=0),o.y=Math.abs(b);const L={type:"gap",direction:"center_vertical",gap:v,offset:b};s.push(L);continue}const[,E,,]=v.startBounds,w=E-f,x=jt(w-v.length);if(Math.abs(x)<=o.y){Math.abs(x)<o.y&&(s.length=0),o.y=Math.abs(x);const L={type:"gap",direction:"side_top",gap:v,offset:x};s.push(L);continue}const[,,,T]=v.endBounds,C=jt(d-T),k=v.length-C;if(Math.abs(k)<=o.y){Math.abs(k)<o.y&&(s.length=0),o.y=Math.abs(k);const L={type:"gap",direction:"side_bottom",gap:v,offset:k};s.push(L);continue}}}},Fme=(t,e,n)=>{const r=h$(t,e,n);return zv(r).filter(i=>!(i.length===1&&nn(i[0]))).flatMap(i=>bm(i))},eh=(t,e,n,r,i,s,o)=>{if(!Tl({appState:n,event:r,selectedElements:t})||t.length===0&&e.length===0)return[];const a=ts.getReferenceSnapPoints();if(a)for(const l of e)for(const c of a){const u=c[0]-l[0],d=c[1]-l[1];Math.abs(u)<=o.x&&(Math.abs(u)<o.x&&(i.length=0),i.push({type:"point",points:[l,c],offset:u}),o.x=Math.abs(u)),Math.abs(d)<=o.y&&(Math.abs(d)<o.y&&(s.length=0),s.push({type:"point",points:[l,c],offset:d}),o.y=Math.abs(d))}},Bme=(t,e,n,r)=>{var f,p;if(!Tl({appState:n,event:r,selectedElements:t})||t.length===0)return{snapOffset:{x:0,y:0},snapLines:[]};e.x=jt(e.x),e.y=jt(e.y);const i=[],s=[],o=k2(n.zoom.value),a={x:o,y:o},l=bm(t,{dragOffset:e});eh(t,l,n,r,i,s,a),sM(t,e,n,r,i,s,a);const c={x:((f=i[0])==null?void 0:f.offset)??0,y:((p=s[0])==null?void 0:p.offset)??0};a.x=0,a.y=0,i.length=0,s.length=0;const u={x:jt(e.x+c.x),y:jt(e.y+c.y)};eh(t,bm(t,{dragOffset:u}),n,r,i,s,a),sM(t,u,n,r,i,s,a);const d=N4(i,s),h=$me(t,u,[...i,...s].filter(m=>m.type==="gap"));return{snapOffset:c,snapLines:[...d,...h]}},jt=t=>Math.round(t*10**6)/10**6,oM=t=>{const e=new Map;for(const n of t){const r=n.join(",");e.has(r)||e.set(r,n)}return Array.from(e.values())},N4=(t,e)=>{const n={},r={};if(t.length>0){for(const i of t)if(i.type==="point"){const s=jt(i.points[0][0]);n[s]||(n[s]=[]),n[s].push(...i.points.map(o=>[jt(o[0]),jt(o[1])]))}}if(e.length>0){for(const i of e)if(i.type==="point"){const s=jt(i.points[0][1]);r[s]||(r[s]=[]),r[s].push(...i.points.map(o=>[jt(o[0]),jt(o[1])]))}}return Object.entries(n).map(([i,s])=>({type:"points",points:oM(s.map(o=>[Number(i),o[1]]).sort((o,a)=>o[1]-a[1]))})).concat(Object.entries(r).map(([i,s])=>({type:"points",points:oM(s.map(o=>[o[0],Number(i)]).sort((o,a)=>o[0]-a[0]))})))},Ume=t=>{const e=new Map;for(const n of t){const r=n.points.flat().map(i=>[jt(i)]).join(",");e.has(r)||e.set(r,n)}return Array.from(e.values())},$me=(t,e,n)=>{const[r,i,s,o]=WS(t,e),a=[];for(const l of n){const[c,u,d,h]=l.gap.startBounds,[f,p,m,v]=l.gap.endBounds,y=Dy([i,o],l.gap.overlap),b=Dy([r,s],l.gap.overlap);switch(l.direction){case"center_horizontal":{if(y){const _=(y[0]+y[1])/2;a.push({type:"gap",direction:"horizontal",points:[[l.gap.startSide[0][0],_],[r,_]]},{type:"gap",direction:"horizontal",points:[[s,_],[l.gap.endSide[0][0],_]]})}break}case"center_vertical":{if(b){const _=(b[0]+b[1])/2;a.push({type:"gap",direction:"vertical",points:[[_,l.gap.startSide[0][1]],[_,i]]},{type:"gap",direction:"vertical",points:[[_,o],[_,l.gap.endSide[0][1]]]})}break}case"side_right":{if(y){const _=(y[0]+y[1])/2;a.push({type:"gap",direction:"horizontal",points:[[d,_],[f,_]]},{type:"gap",direction:"horizontal",points:[[m,_],[r,_]]})}break}case"side_left":{if(y){const _=(y[0]+y[1])/2;a.push({type:"gap",direction:"horizontal",points:[[s,_],[c,_]]},{type:"gap",direction:"horizontal",points:[[d,_],[f,_]]})}break}case"side_top":{if(b){const _=(b[0]+b[1])/2;a.push({type:"gap",direction:"vertical",points:[[_,o],[_,u]]},{type:"gap",direction:"vertical",points:[[_,h],[_,p]]})}break}case"side_bottom":{if(b){const _=(b[0]+b[1])/2;a.push({type:"gap",direction:"vertical",points:[[_,h],[_,p]]},{type:"gap",direction:"vertical",points:[[_,v],[_,i]]})}break}}}return Ume(a.map(l=>({...l,points:l.points.map(c=>[jt(c[0]),jt(c[1])])})))},Hme=(t,e,n,r,i,s)=>{var x,T;if(!Tl({event:r,selectedElements:t,appState:n})||t.length===0||t.length===1&&!Dme(t[0].angle,0))return{snapOffset:{x:0,y:0},snapLines:[]};let[o,a,l,c]=Ut(e);s&&(s.includes("e")?l+=i.x:s.includes("w")&&(o+=i.x),s.includes("n")?a+=i.y:s.includes("s")&&(c+=i.y));const u=[];if(s)switch(s){case"e":{u.push([l,a],[l,c]);break}case"w":{u.push([o,a],[o,c]);break}case"n":{u.push([o,a],[l,a]);break}case"s":{u.push([o,c],[l,c]);break}case"ne":{u.push([l,a]);break}case"nw":{u.push([o,a]);break}case"se":{u.push([l,c]);break}case"sw":{u.push([o,c]);break}}const d=k2(n.zoom.value),h={x:d,y:d},f=[],p=[];eh(e,u,n,r,f,p,h);const m={x:((x=f[0])==null?void 0:x.offset)??0,y:((T=p[0])==null?void 0:T.offset)??0};h.x=0,h.y=0,f.length=0,p.length=0;const[v,y,b,_]=Ut(t).map(C=>jt(C));eh(t,[[v,y],[v,_],[b,y],[b,_]],n,r,f,p,h);const w=N4(f,p);return{snapOffset:m,snapLines:w}},zme=(t,e,n,r,i)=>{var f,p;if(!Tl({event:n,selectedElements:[t],appState:e}))return{snapOffset:{x:0,y:0},snapLines:[]};const s=[[r.x+i.x,r.y+i.y]],o=k2(e.zoom.value),a={x:o,y:o},l=[],c=[];eh([t],s,e,n,l,c,a);const u={x:((f=l[0])==null?void 0:f.offset)??0,y:((p=c[0])==null?void 0:p.offset)??0};a.x=0,a.y=0,l.length=0,c.length=0;const d=bm([t],{boundingBoxCorners:!0,omitCenter:!0});eh([t],d,e,n,l,c,a);const h=N4(l,c);return{snapOffset:u,snapLines:h}},Gme=(t,e,n,r)=>{if(!Tl({event:r,selectedElements:[],appState:e}))return{originOffset:{x:0,y:0},snapLines:[]};const i=hB(t,[],e),s=k2(e.zoom.value),o={x:s,y:s},a=[],l=[];for(const c of i){const u=bm([c]);for(const d of u){const h=d[0]-n.x;Math.abs(h)<=Math.abs(o.x)&&(Math.abs(h)<Math.abs(o.x)&&(l.length=0),l.push({type:"pointer",points:[d,[d[0],n.y]],direction:"vertical"}),o.x=h);const f=d[1]-n.y;Math.abs(f)<=Math.abs(o.y)&&(Math.abs(f)<Math.abs(o.y)&&(a.length=0),a.push({type:"pointer",points:[d,[n.x,d[1]]],direction:"horizontal"}),o.y=f)}}return{originOffset:{x:l.length>0?l[0].points[0][0]-n.x:0,y:a.length>0?a[0].points[0][1]-n.y:0},snapLines:[...l,...a]}},Vme=t=>t===kr.rectangle||t===kr.ellipse||t===kr.diamond||t===kr.frame||t===kr.magicframe||t===kr.image,Wme=()=>M("div",{"data-testid":"brave-measure-text-error",children:[g("p",{children:g(Vr,{i18nKey:"errors.brave_measure_text_error.line1",bold:t=>g("span",{style:{fontWeight:600},children:t})})}),g("p",{children:g(Vr,{i18nKey:"errors.brave_measure_text_error.line2",bold:t=>g("span",{style:{fontWeight:600},children:t})})}),g("p",{children:g(Vr,{i18nKey:"errors.brave_measure_text_error.line3",link:t=>g("a",{href:"http://docs.excalidraw.com/docs/@excalidraw/excalidraw/faq#turning-off-aggresive-block-fingerprinting-in-brave-browser",children:t})})}),g("p",{children:g(Vr,{i18nKey:"errors.brave_measure_text_error.line4",issueLink:t=>g("a",{href:"https://github.com/excalidraw/excalidraw/issues/new",children:t}),discordLink:t=>M("a",{href:"https://discord.gg/UexuTaE",children:[t,"."]})})})]}),jme=t=>{const e=A.useRef(!1);return A.useEffect(()=>{var l;if(!e.current){e.current=!0;return}const n={},r={},i={},s={},o={};t.appState.collaborators.forEach((c,u)=>{if(c.selectedElementIds)for(const d of Object.keys(c.selectedElementIds))d in i||(i[d]=[]),i[d].push(u);c.pointer&&(c.username&&(s[u]=c.username),c.userState&&(o[u]=c.userState),r[u]=li({sceneX:c.pointer.x,sceneY:c.pointer.y},t.appState),n[u]=c.button)});const a=((l=t.containerRef)==null?void 0:l.current)&&getComputedStyle(t.containerRef.current).getPropertyValue("--color-selection")||"#6965db";_ne({canvas:t.canvas,elements:t.elements,visibleElements:t.visibleElements,selectedElements:t.selectedElements,scale:window.devicePixelRatio,appState:t.appState,renderConfig:{remotePointerViewportCoords:r,remotePointerButton:n,remoteSelectedElementIds:i,remotePointerUsernames:s,remotePointerUserStates:o,selectionColor:a,renderScrollbars:!1},callback:t.renderInteractiveSceneCallback},$T())}),g("canvas",{className:"excalidraw__canvas interactive",style:{width:t.appState.width,height:t.appState.height,cursor:t.appState.viewModeEnabled?vt.GRAB:vt.AUTO},width:t.appState.width*t.scale,height:t.appState.height*t.scale,ref:t.handleCanvasRef,onContextMenu:t.onContextMenu,onPointerMove:t.onPointerMove,onPointerUp:t.onPointerUp,onPointerCancel:t.onPointerCancel,onTouchMove:t.onTouchMove,onPointerDown:t.onPointerDown,onDoubleClick:t.appState.viewModeEnabled?void 0:t.onDoubleClick,children:I("labels.drawingCanvas")})},aM=t=>({webGLEnabled:t.webGLEnabled,zoom:t.zoom,scrollX:t.scrollX,scrollY:t.scrollY,width:t.width,height:t.height,viewModeEnabled:t.viewModeEnabled,editingGroupId:t.editingGroupId,editingLinearElement:t.editingLinearElement,selectedElementIds:t.selectedElementIds,frameToHighlight:t.frameToHighlight,offsetLeft:t.offsetLeft,offsetTop:t.offsetTop,theme:t.theme,pendingImageElementId:t.pendingImageElementId,selectionElement:t.selectionElement,selectedGroupIds:t.selectedGroupIds,selectedLinearElement:t.selectedLinearElement,multiElement:t.multiElement,isBindingEnabled:t.isBindingEnabled,suggestedBindings:t.suggestedBindings,isRotating:t.isRotating,elementsToHighlight:t.elementsToHighlight,collaborators:t.collaborators,activeEmbeddable:t.activeEmbeddable,snapLines:t.snapLines,zenModeEnabled:t.zenModeEnabled}),Xme=(t,e)=>t.selectionNonce!==e.selectionNonce||t.versionNonce!==e.versionNonce||t.scale!==e.scale||t.elements!==e.elements||t.visibleElements!==e.visibleElements||t.selectedElements!==e.selectedElements?!1:Pr(aM(t.appState),aM(e.appState)),Yme=ce.memo(jme,Xme),Zme=t=>{const e=A.useRef(null),n=A.useRef(!1);return A.useEffect(()=>{const r=e.current;if(!r)return;const i=t.canvas;n.current||(n.current=!0,r.replaceChildren(i),i.classList.add("excalidraw__canvas","static"));const s=`${t.appState.width}px`,o=`${t.appState.height}px`;i.style.width!==s&&(i.style.width=s),i.style.height!==o&&(i.style.height=o);const a=t.appState.width*t.scale,l=t.appState.height*t.scale;i.width!==a&&(i.width=a),i.height!==l&&(i.height=l),pD({canvas:i,rc:t.rc,scale:t.scale,elements:t.elements,visibleElements:t.visibleElements,appState:t.appState,renderConfig:t.renderConfig},$T())}),g("div",{className:"excalidraw__canvas-wrapper",ref:e})},lM=t=>({zoom:t.zoom,scrollX:t.scrollX,scrollY:t.scrollY,width:t.width,height:t.height,viewModeEnabled:t.viewModeEnabled,offsetLeft:t.offsetLeft,offsetTop:t.offsetTop,theme:t.theme,pendingImageElementId:t.pendingImageElementId,shouldCacheIgnoreZoom:t.shouldCacheIgnoreZoom,viewBackgroundColor:t.viewBackgroundColor,exportScale:t.exportScale,selectedElementsAreBeingDragged:t.selectedElementsAreBeingDragged,gridSize:t.gridSize,frameRendering:t.frameRendering,selectedElementIds:t.selectedElementIds,frameToHighlight:t.frameToHighlight,editingGroupId:t.editingGroupId,webGLEnabled:t.webGLEnabled}),Kme=(t,e)=>t.versionNonce!==e.versionNonce||t.scale!==e.scale||t.elements!==e.elements||t.visibleElements!==e.visibleElements?!1:Pr(lM(t.appState),lM(e.appState))&&Pr(t.renderConfig,e.renderConfig),qme=ce.memo(Zme,Kme);class cM{constructor(e){O(this,"scene");O(this,"getRenderableElements",(()=>{const e=({elements:r,zoom:i,offsetLeft:s,webGLEnabled:o,offsetTop:a,scrollX:l,scrollY:c,height:u,width:d})=>r.filter((h,f)=>{h.idx=f;const p=Zy(h,d,u,{zoom:i,offsetLeft:s,offsetTop:a,scrollX:l,scrollY:c});if(o){const m=un.get(h);m&&(m.visible=p,m.renderable=p,m.cullable=!0)}return p}),n=({editingElement:r,elements:i,pendingImageElementId:s})=>i.filter(o=>Wo(o)&&s===o.id?!1:!r||r.type!=="text"||o.id!==r.id);return vW(({zoom:r,offsetLeft:i,offsetTop:s,scrollX:o,scrollY:a,height:l,width:c,editingElement:u,pendingImageElementId:d,webGLEnabled:h,versionNonce:f})=>{const p=this.scene.getNonDeletedElements(),m=n({elements:p,editingElement:u,pendingImageElementId:d}),v=e({elements:m,webGLEnabled:h,zoom:r,offsetLeft:i,offsetTop:s,scrollX:o,scrollY:a,height:l,width:c});return{canvasElements:m,visibleElements:v}})})());this.scene=e}destroy(){Ene(),this.getRenderableElements.clear()}}const Jme=({manager:t})=>{const e=A.useRef(null);return A.useEffect(()=>(e.current&&t.start(e.current),()=>{t.stop()}),[t]),g("div",{className:"LaserToolOverlay",children:g("svg",{ref:e,className:"LaserToolOverlayCanvas"})})};function Qme(t,e,n,r){Object.defineProperty(t,e,{get:n,set:r,enumerable:!0,configurable:!0})}var e1e={};Qme(e1e,"LaserPointer",()=>_m);function yn([t,e,n],[r,i,s]){return[t+r,e+i,n+s]}function Pf([t,e,n],[r,i,s]){return[t-r,e-i,n-s]}function Un([t,e,n],r){return[t*r,e*r,n*r]}function Mu([t,e,n]){return[t/Math.sqrt(t**2+e**2),e/Math.sqrt(t**2+e**2),n]}function Er([t,e,n],r){return[Math.cos(r)*t-Math.sin(r)*e,Math.sin(r)*t+Math.cos(r)*e,n]}function t1e(t,e,n){return yn(t,Un(Pf(e,t),n))}function uM(t,e,n){return Math.atan2(n[1]-t[1],n[0]-t[0])-Math.atan2(e[1]-t[1],e[0]-t[0])}function dM(t){return Math.atan2(Math.sin(t),Math.cos(t))}function hM([t,e]){return Math.sqrt(t**2+e**2)}function Rd([t,e],[n,r]){return Math.sqrt((n-t)**2+(r-e)**2)}function n1e(t){if(t.length<2)return 0;let e=0;for(let n=1;n<=t.length-1;n++)e+=Rd(t[n-1],t[n]);return e+=Rd(t[t.length-2],t[t.length-1]),e}const r1e=(t,e,n)=>Math.max(e,Math.min(n,t));function i1e(t,e,n){const r=Rd(e,n);if(r===0)return Rd(t,e);const i=r1e(((t[0]-e[0])*(n[0]-e[0])+(t[1]-e[1])*(n[1]-e[1]))/r**2,0,1),s=[e[0]+i*(n[0]-e[0]),e[1]+i*(n[1]-e[1]),t[2]];return Rd(s,t)}function rv(t,e){if(e===0||t.length<=2)return t;const n=t[0],r=t[t.length-1],[i,s]=t.reduce(([o,a],l,c)=>{const u=i1e(l,n,r);return u>o?[u,c]:[o,a]},[0,-1]);if(i>=e){const o=t[s];return[...rv([n,...t.slice(1,s),o],e).slice(0,-1),o,...rv([o,...t.slice(s,-1),r],e).slice(1)]}else return[n,r]}var P3,L3;const Xs=class Xs{constructor(e){this.originalPoints=[],this.stablePoints=[],this.tailPoints=[],this.isFresh=!0,this.options=Object.assign({},Xs.defaults,e)}get lastPoint(){return this.tailPoints[this.tailPoints.length-1]??this.stablePoints[this.stablePoints.length-1]}addPoint(e){const n=this.originalPoints[this.originalPoints.length-1];if(!(n&&n[0]===e[0]&&n[1]===e[1])){if(this.originalPoints.push(e),this.isFresh){this.isFresh=!1,this.stablePoints.push(e);return}this.options.streamline>0&&(e=t1e(this.lastPoint,e,1-this.options.streamline)),this.tailPoints.push(e),n1e(this.tailPoints)>Xs.constants.maxTailLength&&this.stabilizeTail()}}close(){this.stabilizeTail()}stabilizeTail(){if(this.options.simplify>0&&this.options.simplifyPhase=="tail")throw new Error("Not implemented yet");this.stablePoints.push(...this.tailPoints),this.tailPoints=[]}getSize(e,n,r,i,s){return(e??this.options.size)*this.options.sizeMapping({pressure:n,runningLength:s,currentIndex:r,totalLength:i})}getStrokeOutline(e){if(this.isFresh)return[];let n=[...this.stablePoints,...this.tailPoints];this.options.simplify>0&&this.options.simplifyPhase==="input"&&(n=rv(n,this.options.simplify));const r=n.length;if(r===0)return[];if(r===1){const T=n[0],C=[];for(let k=0;k<=Math.PI*2;k+=Math.PI/16)C.push(yn(T,Un(Er([1,0,0],k),this.getSize(e,T[2],0,r,0))));return C.push(yn(T,Un([1,0,0],this.getSize(e,T[2],0,r,0)))),C}if(r===2){const T=n[0],C=n[1],k=[],L=uM(T,[T[0],T[1]-100,T[2]],C);for(let F=L;F<=Math.PI+L;F+=Math.PI/16)k.push(yn(T,Un(Er([1,0,0],F),this.getSize(e,T[2],0,r,0))));for(let F=Math.PI+L;F<=Math.PI*2+L;F+=Math.PI/16)k.push(yn(C,Un(Er([1,0,0],F),this.getSize(e,C[2],0,r,0))));return k.push(k[0]),k}const i=[],s=[];let o=0,a=0,l=0,c=0;for(let T=1;T<r-1;T++){const C=n[T-1],k=n[T],L=n[T+1];let F=k[2];const N=Rd(C,k);c+=N,o=a+(N-a)*.2;const R=this.getSize(e,F,T,r,c);if(R===0){l=T+1;continue}const H=Mu(Pf(C,k)),W=Mu(Pf(L,k)),q=Er(H,Math.PI/2),Z=Er(H,-Math.PI/2),j=Er(W,Math.PI/2),K=Er(W,-Math.PI/2),$=yn(k,Un(q,R)),B=yn(k,Un(Z,R)),G=yn(k,Un(j,R)),Y=yn(k,Un(K,R)),X=yn(q,K),J=yn(Z,j),ne=yn(k,Un(hM(X)===0?H:Mu(X),R)),se=yn(k,Un(hM(J)===0?W:Mu(J),R)),Ue=dM(uM(k,C,L)),De=Xs.constants.cornerDetectionMaxAngle/180*Math.PI*Xs.constants.cornerDetectionVariance(o);if(Math.abs(Ue)<De){const Le=Math.abs(dM(Math.PI-Ue));if(Le===0)continue;if(Ue<0){s.push(B,se);for(let fe=0;fe<=Le;fe+=Le/4)i.push(yn(k,Er(Un(q,R),fe)));for(let fe=Le;fe>=0;fe-=Le/4)s.push(yn(k,Er(Un(q,R),fe)));s.push(se,G)}else{i.push($,ne);for(let fe=0;fe<=Le;fe+=Le/4)s.push(yn(k,Er(Un(q,-R),-fe)));for(let fe=Le;fe>=0;fe-=Le/4)i.push(yn(k,Er(Un(q,-R),-fe)));i.push(ne,Y)}}else i.push(ne),s.push(se);a=o}const u=n[l],d=n[l+1],h=n[r-2],f=n[r-1];if(l>=r-2)return[];const p=Mu(Pf(d,u)),m=Mu(Pf(h,f)),v=Er(p,-Math.PI/2),y=Er(m,Math.PI/2),b=this.getSize(e,u[2],0,r,0),_=[],E=this.getSize(e,h[2],r-2,r,c),w=[];for(let T=0;T<=Math.PI;T+=Math.PI/16)_.unshift(yn(u,Er(Un(v,b),-T)));_.unshift(yn(u,Un(v,-b)));for(let T=0;T<=Math.PI;T+=Math.PI/16)w.push(yn(f,Er(Un(y,-E),-T)));const x=[..._,...i,...w.reverse(),...s.reverse()];return _.length>0&&x.push(_[0]),this.options.simplify>0&&this.options.simplifyPhase==="output"?rv(x,this.options.simplify):x}};P3=new WeakMap,L3=new WeakMap,U2(Xs,P3,(()=>{Xs.defaults={size:2,streamline:.45,simplify:.1,simplifyPhase:"output",sizeMapping:()=>1}})()),U2(Xs,L3,(()=>{Xs.constants={cornerDetectionMaxAngle:120,cornerDetectionVariance:e=>e>35?.5:1,maxTailLength:50}})());let _m=Xs;const b3=1e3,s1e=50,_g=(t,e)=>(t+e)/2;function o1e(t,e=!0){const n=t.length;if(n<4)return"";let r=t[0],i=t[1];const s=t[2];let o=`M${r[0].toFixed(2)},${r[1].toFixed(2)} Q${i[0].toFixed(2)},${i[1].toFixed(2)} ${_g(i[0],s[0]).toFixed(2)},${_g(i[1],s[1]).toFixed(2)} T`;for(let a=2,l=n-1;a<l;a++)r=t[a],i=t[a+1],o+=`${_g(r[0],i[0]).toFixed(2)},${_g(r[1],i[1]).toFixed(2)} `;return e&&(o+="Z"),o}function fM(t){return 1-Math.pow(1-t,3)}function eE(){return{currentPath:void 0,finishedPaths:[],lastPoint:[-1e4,-1e4],svg:document.createElementNS("http://www.w3.org/2000/svg","path")}}function pM(){return _m.constants.cornerDetectionMaxAngle=70,new _m({simplify:0,streamline:.4,sizeMapping:t=>{const e=b3,n=s1e,r=Math.max(0,1-(performance.now()-t.pressure)/e),i=(n-Math.min(n,t.totalLength-t.currentIndex))/n;return Math.min(fM(i),fM(r))}})}class a1e{constructor(e){O(this,"ownState");O(this,"collaboratorsState",new Map);O(this,"rafId");O(this,"isDrawing",!1);O(this,"container");O(this,"isRunning",!1);this.app=e,this.ownState=eE()}destroy(){this.stop(),this.isDrawing=!1,this.ownState=eE(),this.collaboratorsState=new Map}startPath(e,n){this.ownState.currentPath=pM(),this.ownState.currentPath.addPoint([e,n,performance.now()]),this.updatePath(this.ownState)}addPointToPath(e,n){var r;this.ownState.currentPath&&((r=this.ownState.currentPath)==null||r.addPoint([e,n,performance.now()]),this.updatePath(this.ownState))}endPath(){this.ownState.currentPath&&(this.ownState.currentPath.close(),this.ownState.finishedPaths.push(this.ownState.currentPath),this.updatePath(this.ownState))}updatePath(e){this.isDrawing=!0,this.isRunning||this.start()}start(e){e&&(this.container=e,this.container.appendChild(this.ownState.svg)),this.stop(),this.isRunning=!0,this.loop()}stop(){this.isRunning=!1,this.rafId&&cancelAnimationFrame(this.rafId),this.rafId=void 0}loop(){this.rafId=requestAnimationFrame(this.loop.bind(this)),this.updateCollabolatorsState(),this.isDrawing?this.update():this.isRunning=!1}draw(e){const n=e.getStrokeOutline(e.options.size/this.app.state.zoom.value).map(([r,i])=>{const s=li({sceneX:r,sceneY:i},this.app.state);return[s.x,s.y]});return o1e(n,!0)}updateCollabolatorsState(){if(!(!this.container||!this.app.state.collaborators.size))for(const[e,n]of this.app.state.collaborators.entries()){if(!this.collaboratorsState.has(e)){const i=eE();this.container.appendChild(i.svg),this.collaboratorsState.set(e,i),this.updatePath(i)}const r=this.collaboratorsState.get(e);n.pointer&&n.pointer.tool==="laser"&&(n.button==="down"&&r.currentPath===void 0&&(r.lastPoint=[n.pointer.x,n.pointer.y],r.currentPath=pM(),r.currentPath.addPoint([n.pointer.x,n.pointer.y,performance.now()]),this.updatePath(r)),n.button==="down"&&r.currentPath!==void 0&&(n.pointer.x!==r.lastPoint[0]||n.pointer.y!==r.lastPoint[1])&&(r.lastPoint=[n.pointer.x,n.pointer.y],r.currentPath.addPoint([n.pointer.x,n.pointer.y,performance.now()]),this.updatePath(r)),n.button==="up"&&r.currentPath!==void 0&&(r.lastPoint=[n.pointer.x,n.pointer.y],r.currentPath.addPoint([n.pointer.x,n.pointer.y,performance.now()]),r.currentPath.close(),r.finishedPaths.push(r.currentPath),r.currentPath=void 0,this.updatePath(r)))}}update(){if(!this.container)return;let e=!1;for(const[r,i]of this.collaboratorsState.entries()){if(!this.app.state.collaborators.has(r)){i.svg.remove(),this.collaboratorsState.delete(r);continue}i.finishedPaths=i.finishedPaths.filter(o=>{const a=o.originalPoints[o.originalPoints.length-1];return!(a&&a[2]<performance.now()-b3)});let s=i.finishedPaths.map(o=>this.draw(o)).join(" ");i.currentPath&&(s+=` ${this.draw(i.currentPath)}`),s.trim()&&(e=!0),i.svg.setAttribute("d",s),i.svg.setAttribute("fill",vy(r))}this.ownState.finishedPaths=this.ownState.finishedPaths.filter(r=>{const i=r.originalPoints[r.originalPoints.length-1];return!(i&&i[2]<performance.now()-b3)});let n=this.ownState.finishedPaths.map(r=>this.draw(r)).join(" ");this.ownState.currentPath&&(n+=` ${this.draw(this.ownState.currentPath)}`),n=n.trim(),n&&(e=!0),this.ownState.svg.setAttribute("d",n),this.ownState.svg.setAttribute("fill","red"),e||(this.isDrawing=!1)}}class of{constructor(e){O(this,"subscribers",[]);O(this,"value");O(this,"updateOnChangeOnly");this.updateOnChangeOnly=(e==null?void 0:e.updateOnChangeOnly)??!1,this.value=e==null?void 0:e.initialState}on(...e){const n=e.flat().filter(r=>typeof r=="function");return this.subscribers.push(...n),()=>this.off(n)}off(...e){const n=e.flat();this.subscribers=this.subscribers.filter(r=>!n.includes(r))}trigger(...e){return this.updateOnChangeOnly&&this.value===e?[]:(this.value=e,this.subscribers.map(n=>n(...e)))}destroy(){this.subscribers=[],this.value=void 0}}const l1e=5,c1e=(t,e)=>{const[n,r]=Ve(t),{x:i,y:s}=li({sceneX:n+t.width,sceneY:r},e),o=i-e.offsetLeft+10,a=s-e.offsetTop;return{x:o,y:a}},mM=({children:t,element:e})=>{const n=G4();if(n.contextMenu||n.draggingElement||n.resizingElement||n.isRotating||n.openMenu||n.viewModeEnabled)return null;const{x:r,y:i}=c1e(e,n);return g("div",{className:"excalidraw-canvas-buttons",style:{top:`${i}px`,left:`${r}px`,padding:l1e},children:t})},u1e=`You are a skilled front-end developer who builds interactive prototypes from wireframes, and is an expert at CSS Grid and Flex design.
Your role is to transform low-fidelity wireframes into working front-end HTML code.

YOU MUST FOLLOW FOLLOWING RULES:

- Use HTML, CSS, JavaScript to build a responsive, accessible, polished prototype
- Leverage Tailwind for styling and layout (import as script <script src="https://cdn.tailwindcss.com"><\/script>)
- Inline JavaScript when needed
- Fetch dependencies from CDNs when needed (using unpkg or skypack)
- Source images from Unsplash or create applicable placeholders
- Interpret annotations as intended vs literal UI
- Fill gaps using your expertise in UX and business logic
- generate primarily for desktop UI, but make it responsive.
- Use grid and flexbox wherever applicable.
- Convert the wireframe in its entirety, don't omit elements if possible.

If the wireframes, diagrams, or text is unclear or unreadable, refer to provided text for clarification.

Your goal is a production-ready prototype that brings the wireframes to life.

Please output JUST THE HTML file containing your best attempt at implementing the provided wireframes.`;async function d1e({image:t,apiKey:e,text:n,theme:r="light"}){const i={model:"gpt-4-vision-preview",max_tokens:4096,temperature:.1,messages:[{role:"system",content:u1e},{role:"user",content:[{type:"image_url",image_url:{url:t,detail:"high"}},{type:"text",text:`Above is the reference wireframe. Please make a new website based on these and return just the HTML file. Also, please make it for the ${r} theme. What follows are the wireframe's text annotations (if any)...`},{type:"text",text:n}]}]};let s;const o=await fetch("https://api.openai.com/v1/chat/completions",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${e}`},body:JSON.stringify(i)});return o.ok?s={...await o.json(),ok:!0}:s={...await o.json(),ok:!1},s}const h1e="small",tE=t=>M("label",{className:Ee("ToolIcon ToolIcon__MagicButton",`ToolIcon_size_${h1e}`,{"is-mobile":t.isMobile}),title:`${t.title}`,children:[g("input",{className:"ToolIcon_type_checkbox",type:"checkbox",name:t.name,onChange:t.onChange,checked:t.checked,"aria-label":t.title}),g("div",{className:"ToolIcon__icon",children:t.icon})]}),f1e=({height:t,width:e,userToFollow:n,onDisconnect:r})=>g("div",{style:{position:"relative"},children:g("div",{className:"follow-mode",style:{width:e,height:t},children:M("div",{className:"follow-mode__badge",children:[M("div",{className:"follow-mode__badge__label",children:["Following"," ",g("span",{className:"follow-mode__badge__username",title:n.username,children:n.username})]}),g("button",{onClick:r,className:"follow-mode__disconnect-btn",children:hh})]})})}),p1e=({pixi:t,canvas:e,scale:n,theme:r,isExporting:i,viewBackgroundColor:s})=>{const o=t.stage.getChildAt(0),a=t.stage.getChildAt(1),l=o.removeChildren();for(const c of l)c.destroy();return s?t.renderer.background.color=s:t.renderer.background.color=Ge.white,{gridContainer:o,elementsContainer:a}},m1e=(t,e,n,r,i,s,o)=>{const l=-Math.round(i.value/e)*e+n%e,c=-Math.round(i.value/e)*e+r%e,u=Math.min(1/i.value,1),d=1/i.value,h=new o3({dash:u*3,gap:d+(u+d)}),f=new mm;for(let m=l;m<l+s+e*2;m+=e){const v=Math.round(m-n)%(5*e)===0;f.lineStyle({width:u,color:v?Uo.Bold:Uo.Regular,shader:v?void 0:h}).moveTo(m,c-e).lineTo(m,c+o+e*2)}t.addChild(f);const p=new mm;for(let m=c;m<c+o+e*2;m+=e){const v=Math.round(m-r)%(5*e)===0;p.lineStyle({width:u,color:v?Uo.Bold:Uo.Regular,shader:v?void 0:h}).moveTo(l-e,m).lineTo(l+s+e*2,m)}t.addChild(p)},g1e=he.from(ES),nE=new WeakMap,gM=(t,e,n)=>{if(t.link&&!n.selectedElementIds[t.id]){const[r,i,s,o]=Ve(t),[a,l,c,u]=Wv([r,i,s,o],t.angle,n),d=c/2,h=u/2,f=a+d,p=l+h,m=li({sceneX:f,sceneY:p},n);m.x=m.x/n.zoom.value,m.y=m.y/n.zoom.value;let v=nE.get(t);v||(v=new On(g1e),v.zoom=n.zoom.value,v.anchor.set(.5,.5),e.addChild(v),nE.set(t,v)),v.position.set(m.x,m.y),v.width=u,v.height=c,v.rotation=t.angle,v.visible=!0,v.renderable=!0}else{const r=nE.get(t);r&&(r.visible=!1,r.renderable=!1)}},y1e=.1,v1e=2,f$=({canvas:t,pixi:e,elements:n,visibleElements:r,scale:i,appState:s,renderConfig:o})=>{if(t===null)return;const[a,l]=wS(t,i),{renderGrid:c=!0,isExporting:u}=o,d=new Set,h=s.shouldCacheIgnoreZoom?y1e:Math.min(s.zoom.value,v1e);r.forEach(y=>{y.groupIds.length>0&&s.frameToHighlight&&s.selectedElementIds[y.id]&&(qd(y,s.frameToHighlight)||y.groupIds.find(b=>d.has(b)))&&y.groupIds.forEach(b=>d.add(b))});const{gridContainer:f,elementsContainer:p}=p1e({pixi:e,canvas:t,scale:i,theme:s.theme,normalizedHeight:l,normalizedWidth:a,isExporting:u,viewBackgroundColor:s.viewBackgroundColor});e.stage.scale={x:s.zoom.value,y:s.zoom.value},c&&s.gridSize&&m1e(f,s.gridSize,s.scrollX,s.scrollY,s.zoom,a/s.zoom.value,l/s.zoom.value);const m=new Map,v=(y,b)=>{const _=m.get(y);_?_.push(b):m.set(y,[b])};r.filter(y=>!Yp(y)).forEach(y=>{var b;try{const _=y.frameId||((b=s.frameToHighlight)==null?void 0:b.id);if(_&&s.frameRendering.enabled&&s.frameRendering.clip){const E=fm(y,s);E&&iu(y,n,s)?(v(E,y),nf(y,e,o,s,h,_)):nf(y,e,o,s,h,null,p)}else nf(y,e,o,s,h,null,p);u||gM(y,p,s)}catch(_){console.error(_)}}),r.filter(y=>Yp(y)).forEach(y=>{var b;try{const _=({container:w,frameId:x})=>{if(nf(y,e,o,s,h,x,w),os(y)&&(u||ur(y)&&!y.validated)&&y.width&&y.height){const T=fS(y);nf(T,e,o,s,h,null,w)}u||gM(y,p,s)},E=y.frameId||((b=s.frameToHighlight)==null?void 0:b.id);if(E&&s.frameRendering.enabled&&s.frameRendering.clip){const w=fm(y,s);w&&iu(y,n,s)?(v(w,y),_({frameId:E})):_({container:p,frameId:null})}else _({container:p,frameId:null})}catch(_){console.error(_)}}),m.forEach((y,b)=>{const _=un.get(b);for(const E of y){const w=un.get(E);w.position.set(w.x-_.x,w.y-_.y),_.addChild(w)}}),e.render()},b1e=Mm(t=>{f$(t)},{trailing:!0}),_1e=(t,e)=>{if(e){b1e(t);return}f$(t)},E1e=t=>{const e=A.useRef(null),n=A.useRef(!1);return A.useEffect(()=>{const r=e.current;if(!r)return;const i=t.canvas;n.current||(n.current=!0,r.replaceChildren(i),i.classList.add("excalidraw__canvas","static","webgl"));const s=`${t.appState.width}px`,o=`${t.appState.height}px`;i.style.width!==s&&(i.style.width=s),i.style.height!==o&&(i.style.height=o);const a=t.appState.width*t.scale,l=t.appState.height*t.scale;i.width!==a&&(i.width=a),i.height!==l&&(i.height=l),_1e({canvas:i,pixi:t.pixi,scale:t.scale,elements:t.elements,visibleElements:t.visibleElements,appState:t.appState,renderConfig:t.renderConfig},$T())}),g("div",{className:"excalidraw__canvas-wrapper",ref:e})},yM=t=>({zoom:t.zoom,scrollX:t.scrollX,scrollY:t.scrollY,width:t.width,height:t.height,viewModeEnabled:t.viewModeEnabled,offsetLeft:t.offsetLeft,offsetTop:t.offsetTop,theme:t.theme,pendingImageElementId:t.pendingImageElementId,shouldCacheIgnoreZoom:t.shouldCacheIgnoreZoom,viewBackgroundColor:t.viewBackgroundColor,exportScale:t.exportScale,selectedElementsAreBeingDragged:t.selectedElementsAreBeingDragged,gridSize:t.gridSize,frameRendering:t.frameRendering,selectedElementIds:t.selectedElementIds,frameToHighlight:t.frameToHighlight,editingGroupId:t.editingGroupId,webGLEnabled:t.webGLEnabled}),w1e=(t,e)=>t.versionNonce!==e.versionNonce||t.scale!==e.scale||t.elements!==e.elements||t.visibleElements!==e.visibleElements?!1:Pr(yM(t.appState),yM(e.appState))&&Pr(t.renderConfig,e.renderConfig),x1e=ce.memo(E1e,w1e),p$=ce.createContext(null),m$=ce.createContext(null),g$={viewport:{isMobile:!1,isLandscape:!1},editor:{isMobile:!1,canFitSidebar:!1},isTouchScreen:!1},F4=ce.createContext(g$);F4.displayName="DeviceContext";const B4=ce.createContext({container:null,id:null});B4.displayName="ExcalidrawContainerContext";const U4=ce.createContext([]);U4.displayName="ExcalidrawElementsContext";const $4=ce.createContext({...Es(),width:0,height:0,offsetLeft:0,offsetTop:0});$4.displayName="ExcalidrawAppStateContext";const H4=ce.createContext(()=>{console.warn("Uninitialized ExcalidrawSetAppStateContext context!")});H4.displayName="ExcalidrawSetAppStateContext";const z4=ce.createContext(null);z4.displayName="ExcalidrawActionManagerContext";const Sh=()=>A.useContext(p$),M2=()=>A.useContext(m$),_r=()=>A.useContext(F4),pa=()=>A.useContext(B4),P2=()=>A.useContext(U4),G4=()=>A.useContext($4),Fr=()=>A.useContext(H4),$i=()=>A.useContext(z4),vM=typeof window<"u"&&"ResizeObserver"in window;let af=!1,rE=0,$l=!1,lf=!1,iE=!1,sE={horizontal:null,vertical:null},va=0,cf=!1;const oE=new Map;let aE=!1,bM=0,_M=!1,ba=null;const ct={pointers:new Map,lastCenter:null,initialDistance:null,initialScale:null};class V4 extends ce.Component{constructor(n){super(n);O(this,"canvas");O(this,"interactiveCanvas",null);O(this,"rc");O(this,"pixi");O(this,"unmounted",!1);O(this,"actionManager");O(this,"device",g$);O(this,"excalidrawContainerRef",ce.createRef());O(this,"scene");O(this,"renderer");O(this,"fonts");O(this,"resizeObserver");O(this,"nearestScrollableContainer");O(this,"library");O(this,"libraryItemsFromStorage");O(this,"id");O(this,"history");O(this,"excalidrawContainerValue");O(this,"files",{});O(this,"imageCache",new Map);O(this,"iFrameRefs",new Map);O(this,"hitLinkElement");O(this,"lastPointerDownEvent",null);O(this,"lastPointerUpEvent",null);O(this,"lastViewportPosition",{x:0,y:0});O(this,"laserPathManager",new a1e(this));O(this,"onChangeEmitter",new of);O(this,"onPointerDownEmitter",new of);O(this,"onPointerUpEmitter",new of);O(this,"onUserFollowEmitter",new of);O(this,"onScrollChangeEmitter",new of);O(this,"updateEmbeddables",()=>{const n=new Set;let r=!1;this.scene.getNonDeletedElements().filter(i=>{if(ur(i)){if(n.add(i.id),i.validated==null){r=!0;const s=t0(i.link,this.props.validateEmbeddable);ae(i,{validated:s},!1),mt.delete(i)}}else Pa(i)&&n.add(i.id);return!1}),r&&this.scene.informMutation(),this.iFrameRefs.forEach((i,s)=>{n.has(s)||this.iFrameRefs.delete(s)})});O(this,"getFrameNameDOMId",n=>`${this.id}-frame-name-${n.id}`);O(this,"frameNameBoundsCache",{get:n=>{let r=this.frameNameBoundsCache._cache.get(n.id);if(!r||r.zoom!==this.state.zoom.value||r.versionNonce!==n.versionNonce){const i=document.getElementById(this.getFrameNameDOMId(n));if(i){const s=i.getBoundingClientRect(),o=Ft({clientX:s.x,clientY:s.y},this.state),a=Ft({clientX:s.right,clientY:s.bottom},this.state);return r={x:o.x,y:o.y,width:a.x-o.x,height:a.y-o.y,angle:0,zoom:this.state.zoom.value,versionNonce:n.versionNonce},this.frameNameBoundsCache._cache.set(n.id,r),r}return null}return r},_cache:new Map});O(this,"renderFrameNames",()=>{if(!this.state.frameRendering.enabled||!this.state.frameRendering.name)return null;const n=this.state.theme==="dark";let r=0,i=0;return this.scene.getNonDeletedFramesLikes().map(s=>{if(Wp(s)?r++:i++,!Zy(s,this.canvas.width/window.devicePixelRatio,this.canvas.height/window.devicePixelRatio,{offsetLeft:this.state.offsetLeft,offsetTop:this.state.offsetTop,scrollX:this.state.scrollX,scrollY:this.state.scrollY,zoom:this.state.zoom}))return null;const{x:o,y:a}=li({sceneX:s.x,sceneY:s.y},this.state),l=6,c=()=>{var h;((h=s.name)==null?void 0:h.trim())===""&&ae(s,{name:null}),this.setState({editingFrame:null})};let u;const d=dB(s,Wp(s)?r:i);if(s.id===this.state.editingFrame){const h=d;u=g("input",{autoFocus:!0,value:h,onChange:f=>{ae(s,{name:f.target.value})},onBlur:()=>c(),onKeyDown:f=>{(f.key===z.ESCAPE||f.key===z.ENTER)&&c()},style:{background:this.state.viewBackgroundColor,filter:n?PT:"none",zIndex:2,border:"none",display:"block",padding:`${l}px`,borderRadius:4,boxShadow:"inset 0 0 0 1px var(--color-primary)",fontFamily:"Assistant",fontSize:"14px",transform:`translate(-${l}px, ${l}px)`,color:"var(--color-gray-80)",overflow:"hidden",maxWidth:`${document.body.clientWidth-o-l}px`},size:h.length+1||1,dir:"auto",autoComplete:"off",autoCapitalize:"off",autoCorrect:"off"})}else u=d;return g("div",{id:this.getFrameNameDOMId(s),style:{position:"absolute",bottom:`${this.state.height+Pt.nameOffsetY-a+this.state.offsetTop}px`,left:`${o-this.state.offsetLeft}px`,zIndex:2,fontSize:Pt.nameFontSize,color:n?Pt.nameColorDarkTheme:Pt.nameColorLightTheme,lineHeight:Pt.nameLineHeight,width:"max-content",maxWidth:`${s.width}px`,overflow:s.id===this.state.editingFrame?"visible":"hidden",whiteSpace:"nowrap",textOverflow:"ellipsis",cursor:vt.MOVE,pointerEvents:this.state.viewModeEnabled?Vl.disabled:Vl.enabled},onPointerDown:h=>this.handleCanvasPointerDown(h),onWheel:h=>this.handleWheel(h),onContextMenu:this.handleCanvasContextMenu,onDoubleClick:()=>{this.setState({editingFrame:s.id})},children:u},s.id)})});O(this,"focusContainer",()=>{var n;(n=this.excalidrawContainerRef.current)==null||n.focus()});O(this,"getSceneElementsIncludingDeleted",()=>this.scene.getElementsIncludingDeleted());O(this,"getSceneElements",()=>this.scene.getNonDeletedElements());O(this,"onInsertElements",n=>{this.addElementsFromPasteOrLibrary({elements:n,position:"center",files:null})});O(this,"onExportImage",async(n,r,i)=>{at("export",n,"ui");const s=await C2(n,r,this.state,this.files,{exportBackground:this.state.exportBackground,name:this.state.name,viewBackgroundColor:this.state.viewBackgroundColor,exportingFrame:i.exportingFrame}).catch(oR).catch(o=>{console.error(o),this.setState({errorMessage:o.message})});this.state.exportEmbedScene&&s&&XS(s)&&this.setState({fileHandle:s})});O(this,"magicGenerations",new Map);O(this,"updateMagicGeneration",({frameElement:n,data:r})=>{r.status==="pending"?ae(n,{customData:{generationData:void 0}},!1):ae(n,{customData:{generationData:r}},!1),this.magicGenerations.set(n.id,r),this.onSceneUpdated()});O(this,"OPENAI_KEY",co.get(il.OAI_API_KEY));O(this,"OPENAI_KEY_IS_PERSISTED",co.has(il.OAI_API_KEY)||!1);O(this,"onOpenAIKeyChange",(n,r)=>{if(this.OPENAI_KEY=n||null,r){const i=co.set(il.OAI_API_KEY,n);this.OPENAI_KEY_IS_PERSISTED=i}else this.OPENAI_KEY_IS_PERSISTED=!1});O(this,"onMagicSettingsConfirm",(n,r,i)=>{if(this.OPENAI_KEY=n||null,this.onOpenAIKeyChange(this.OPENAI_KEY,r),i==="settings")return;const s=this.scene.getSelectedElements({selectedElementIds:this.state.selectedElementIds});n?s.length?this.onMagicframeToolSelect():this.setActiveTool({type:"magicframe"}):sd(s[0])||this.setActiveTool({type:"magicframe"})});O(this,"onMagicframeToolSelect",()=>{if(!this.OPENAI_KEY){this.setState({openDialog:{name:"settings",tab:"diagram-to-code",source:"tool"}}),at("ai","tool-select (missing key)","d2c");return}const n=this.scene.getSelectedElements({selectedElementIds:this.state.selectedElementIds});if(n.length===0)this.setActiveTool({type:kr.magicframe}),at("ai","tool-select (empty-selection)","d2c");else{const r=n.length===1&&sd(n[0])&&n[0];if(!r&&n.some(s=>qe(s)||s.frameId)){this.setActiveTool({type:kr.magicframe});return}at("ai","tool-select (existing selection)","d2c");let i;if(r)i=r;else{const[s,o,a,l]=Ut(n),c=50;i=_x({...Pt,x:s-c,y:o-c,width:a-s+c*2,height:l-o+c*2,opacity:100,locked:!1}),this.scene.addNewElement(i);for(const u of n)ae(u,{frameId:i.id});this.setState({selectedElementIds:{[i.id]:!0}})}this.onMagicFrameGenerate(i,"upstream")}});O(this,"openEyeDropper",({type:n})=>{zo.set(o2,{swapPreviewOnAlt:!0,colorPickerType:n==="stroke"?"elementStroke":"elementBackground",onSelect:(r,i)=>{const s=n==="background"&&i.altKey||n==="stroke"&&!i.altKey;!this.scene.getSelectedElements(this.state).length||this.state.activeTool.type!=="selection"?s?this.syncActionResult({appState:{...this.state,currentItemStrokeColor:r},commitToHistory:!0}):this.syncActionResult({appState:{...this.state,currentItemBackgroundColor:r},commitToHistory:!0}):this.updateScene({elements:this.scene.getElementsIncludingDeleted().map(a=>this.state.selectedElementIds[a.id]?Re(a,{[s?"strokeColor":"backgroundColor"]:r}):a)})},keepOpenOnAlt:!1})});O(this,"syncActionResult",Nt(n=>{var i,s,o,a,l,c,u;if(this.unmounted||n===!1)return;let r=null;if(n.elements&&(n.elements.forEach(d=>{var h;((h=this.state.editingElement)==null?void 0:h.id)===d.id&&this.state.editingElement!==d&&u3(d)&&(r=d)}),this.scene.replaceAllElements(n.elements),n.commitToHistory&&this.history.resumeRecording()),n.files&&(this.files=n.replaceFiles?n.files:{...this.files,...n.files},this.addNewImagesToImageCache()),n.appState||r||this.state.contextMenu){n.commitToHistory&&this.history.resumeRecording();let d=((i=n==null?void 0:n.appState)==null?void 0:i.viewModeEnabled)||!1,h=((s=n==null?void 0:n.appState)==null?void 0:s.zenModeEnabled)||!1,f=((o=n==null?void 0:n.appState)==null?void 0:o.gridSize)||null;const p=((a=n==null?void 0:n.appState)==null?void 0:a.theme)||this.props.theme||Vn.LIGHT;let m=((l=n==null?void 0:n.appState)==null?void 0:l.name)??this.state.name;const v=((c=n==null?void 0:n.appState)==null?void 0:c.errorMessage)??this.state.errorMessage;typeof this.props.viewModeEnabled<"u"&&(d=this.props.viewModeEnabled),typeof this.props.zenModeEnabled<"u"&&(h=this.props.zenModeEnabled),typeof this.props.gridModeEnabled<"u"&&(f=this.props.gridModeEnabled?vd:null),typeof this.props.name<"u"&&(m=this.props.name),r=r||((u=n.appState)==null?void 0:u.editingElement)||null,r!=null&&r.isDeleted&&(r=null),this.setState(y=>Object.assign(n.appState||{},{contextMenu:null,editingElement:r,viewModeEnabled:d,zenModeEnabled:h,gridSize:f,theme:p,name:m,errorMessage:v}),()=>{n.syncHistory&&this.history.setCurrentState(this.state,this.scene.getElementsIncludingDeleted())})}}));O(this,"onBlur",Nt(()=>{$l=!1,this.setState({isBindingEnabled:!0})}));O(this,"onUnload",()=>{this.onBlur()});O(this,"disableEvent",n=>{n.preventDefault()});O(this,"resetHistory",()=>{this.history.clear()});O(this,"resetScene",Nt(n=>{this.scene.replaceAllElements([]),this.setState(r=>({...Es(),isLoading:n!=null&&n.resetLoadingState?!1:r.isLoading,theme:this.state.theme})),this.resetHistory()}));O(this,"initializeScene",async()=>{var i;"launchQueue"in window&&"LaunchParams"in window&&window.launchQueue.setConsumer(async s=>{if(!s.files.length)return;const o=s.files[0],a=await o.getFile();this.loadFileToCanvas(new File([a],a.name||"",{type:a.type}),o)}),this.props.theme&&this.setState({theme:this.props.theme}),this.state.isLoading||this.setState({isLoading:!0});let n=null;try{n=await this.props.initialData||null,n!=null&&n.libraryItems&&this.library.updateLibrary({libraryItems:n.libraryItems,merge:!0}).catch(s=>{console.error(s)})}catch(s){console.error(s),n={appState:{errorMessage:s.message||"Encountered an error during importing or restoring scene data"}}}const r=Jc(n,null,null,{repairBindings:!0});r.appState={...r.appState,theme:this.props.theme||r.appState.theme,openSidebar:((i=r.appState)==null?void 0:i.openSidebar)||this.state.openSidebar,activeTool:r.appState.activeTool.type==="image"?{...r.appState.activeTool,type:"selection"}:r.appState.activeTool,isLoading:!1,toast:this.state.toast},n!=null&&n.scrollToContent&&(r.appState={...r.appState,...nm(r.elements,{...r.appState,width:this.state.width,height:this.state.height,offsetTop:this.state.offsetTop,offsetLeft:this.state.offsetLeft})}),this.fonts.loadFontsForElements(r.elements),this.resetHistory(),this.syncActionResult({...r,commitToHistory:!0})});O(this,"isMobileBreakpoint",(n,r)=>n<NV||r<BV&&n<FV);O(this,"refreshViewportBreakpoints",()=>{if(!this.excalidrawContainerRef.current)return;const{clientWidth:r,clientHeight:i}=document.body,s=this.device.viewport,o=Hg(s,{isLandscape:r>i,isMobile:this.isMobileBreakpoint(r,i)});return s!==o?(this.device={...this.device,viewport:o},!0):!1});O(this,"refreshEditorBreakpoints",()=>{const n=this.excalidrawContainerRef.current;if(!n)return;const{width:r,height:i}=n.getBoundingClientRect(),s=this.props.UIOptions.dockedSidebarBreakpoint!=null?this.props.UIOptions.dockedSidebarBreakpoint:UV,o=this.device.editor,a=Hg(o,{isMobile:this.isMobileBreakpoint(r,i),canFitSidebar:r>s});return o!==a?(this.device={...this.device,editor:a},!0):!1});O(this,"onResize",Nt(()=>{this.scene.getElementsIncludingDeleted().forEach(n=>mt.delete(n)),this.refreshViewportBreakpoints(),this.updateDOMRect(),vM||this.refreshEditorBreakpoints(),this.setState({})}));O(this,"onFullscreenChange",()=>{var n;!document.fullscreenElement&&((n=this.state.activeEmbeddable)==null?void 0:n.state)==="active"&&this.setState({activeEmbeddable:null})});O(this,"renderInteractiveSceneCallback",({atLeastOneVisibleElement:n,scrollBars:r,elements:i})=>{r&&(sE=r);const s=Se(this.state.editingElement)?!1:!n&&i.length>0;this.state.scrolledOutside!==s&&this.setState({scrolledOutside:s}),this.scheduleImageRefresh()});O(this,"onScroll",$c(()=>{const{offsetTop:n,offsetLeft:r}=this.getCanvasOffsets();this.setState(i=>i.offsetLeft===r&&i.offsetTop===n?null:{offsetTop:n,offsetLeft:r})},OV));O(this,"onCut",Nt(n=>{var i;!((i=this.excalidrawContainerRef.current)!=null&&i.contains(document.activeElement))||rc(n.target)||(this.actionManager.executeAction(M8,"keyboard",n),n.preventDefault(),n.stopPropagation())}));O(this,"onCopy",Nt(n=>{var i;!((i=this.excalidrawContainerRef.current)!=null&&i.contains(document.activeElement))||rc(n.target)||(this.actionManager.executeAction(y0,"keyboard",n),n.preventDefault(),n.stopPropagation())}));O(this,"onTouchStart",n=>{if(SC||n.preventDefault(),!af){af=!0,clearTimeout(rE),rE=window.setTimeout(V4.resetTapTwice,MV);return}if(af&&n.touches.length===1){const r=n.touches[0];this.handleCanvasDoubleClick({clientX:r.clientX,clientY:r.clientY}),af=!1,clearTimeout(rE)}SC&&n.preventDefault(),n.touches.length===2&&this.setState({selectedElementIds:gt({},this.state),activeEmbeddable:null})});O(this,"onTouchEnd",n=>{this.resetContextMenuTimer(),n.touches.length>0?this.setState({previousSelectedElementIds:{},selectedElementIds:gt(this.state.previousSelectedElementIds,this.state)}):ct.pointers.clear()});O(this,"pasteFromClipboard",Nt(async n=>{var d,h,f;const r=!!aE,i=document.activeElement,s=(d=this.excalidrawContainerRef.current)==null?void 0:d.contains(i);if(n&&!s)return;const o=document.elementFromPoint(this.lastViewportPosition.x,this.lastViewportPosition.y);if(n&&(!(o instanceof HTMLCanvasElement)||rc(i)))return;const{x:a,y:l}=Ft({clientX:this.lastViewportPosition.x,clientY:this.lastViewportPosition.y},this.state);let c=(h=n==null?void 0:n.clipboardData)==null?void 0:h.files[0];const u=await pN(n,r);if(!c&&!r){if(u.mixedContent)return this.addElementsFromMixedContentPaste(u.mixedContent,{isPlainPaste:r,sceneX:a,sceneY:l});if(u.text){const p=u.text.trim();p.startsWith("<svg")&&p.endsWith("</svg>")&&(c=$A(p))}}if(Rc(c)&&!u.spreadsheet){if(!this.isToolSupported("image")){this.setState({errorMessage:I("errors.imageToolNotSupported")});return}const p=this.createImageElement({sceneX:a,sceneY:l});this.insertImageElement(p,c),this.initializeImageDimensions(p),this.setState({selectedElementIds:gt({[p.id]:!0},this.state)});return}if(this.props.onPaste)try{if(await this.props.onPaste(u,n)===!1)return}catch(p){console.error(p)}if(u.errorMessage)this.setState({errorMessage:u.errorMessage});else if(u.spreadsheet&&!r)this.setState({pasteDialog:{data:u.spreadsheet,shown:!0}});else if(u.elements){const p=u.programmaticAPI?t$(u.elements):u.elements;this.addElementsFromPasteOrLibrary({elements:p,files:u.files||null,position:"cursor",retainSeed:r})}else if(u.text){const p=XQ(u.text);if(!r&&t0(p,this.props.validateEmbeddable)&&(/^(http|https):\/\/[^\s/$.?#].[^\s]*$/.test(p)||((f=ad(p))==null?void 0:f.type)==="video")){const m=this.insertEmbeddableElement({sceneX:a,sceneY:l,link:ao(p)});m&&this.setState({selectedElementIds:{[m.id]:!0}});return}this.addTextFromPaste(u.text,r)}this.setActiveTool({type:"selection"}),n==null||n.preventDefault()}));O(this,"addElementsFromPasteOrLibrary",n=>{const r=Ym(n.elements,null,void 0),[i,s,o,a]=Ut(r),l=fr(i,o)/2,c=fr(s,a)/2,u=typeof n.position=="object"?n.position.clientX:n.position==="cursor"?this.lastViewportPosition.x:this.state.width/2+this.state.offsetLeft,d=typeof n.position=="object"?n.position.clientY:n.position==="cursor"?this.lastViewportPosition.y:this.state.height/2+this.state.offsetTop,{x:h,y:f}=Ft({clientX:u,clientY:d},this.state),p=h-l,m=f-c,[v,y]=Kn(p,m,this.state.gridSize),b=WO(r.map(w=>Re(w,{x:w.x+v-i,y:w.y+y-s})),{randomizeSeed:!n.retainSeed}),_=[...this.scene.getElementsIncludingDeleted(),...b];this.scene.replaceAllElements(_),b.forEach(w=>{if(Se(w)&&nn(w)){const x=Dn(w);go(w,x)}}),n.files&&(this.files={...this.files,...n.files}),this.history.resumeRecording();const E=E2(b);this.setState({...this.state,openSidebar:this.state.openSidebar&&this.device.editor.canFitSidebar&&zo.get(E4)?this.state.openSidebar:null,...ri({editingGroupId:null,selectedElementIds:E.reduce((w,x)=>(nn(x)||(w[x.id]=!0),w),{})},this.scene.getNonDeletedElements(),this.state,this)},()=>{n.files&&this.addNewImagesToImageCache()}),this.setActiveTool({type:"selection"}),n.fitToContent&&this.scrollToContent(b,{fitToContent:!0})});O(this,"setAppState",(n,r)=>{this.setState(n,r)});O(this,"removePointer",n=>{va&&this.resetContextMenuTimer(),ct.pointers.delete(n.pointerId)});O(this,"toggleLock",(n="ui")=>{this.state.activeTool.locked||at("toolbar","toggleLock",`${n} (${this.device.editor.isMobile?"mobile":"desktop"})`),this.setState(r=>({activeTool:{...r.activeTool,...kn(this.state,r.activeTool.locked?{type:"selection"}:r.activeTool),locked:!r.activeTool.locked}}))});O(this,"updateFrameRendering",n=>{this.setState(r=>{const i=typeof n=="function"?n(r.frameRendering):n;return{frameRendering:{enabled:(i==null?void 0:i.enabled)??r.frameRendering.enabled,clip:(i==null?void 0:i.clip)??r.frameRendering.clip,name:(i==null?void 0:i.name)??r.frameRendering.name,outline:(i==null?void 0:i.outline)??r.frameRendering.outline}}})});O(this,"togglePenMode",n=>{this.setState(r=>({penMode:n??!r.penMode,penDetected:!0}))});O(this,"onHandToolToggle",()=>{this.actionManager.executeAction(Yse)});O(this,"zoomCanvas",n=>{this.setState({...bc({viewportX:this.state.width/2+this.state.offsetLeft,viewportY:this.state.height/2+this.state.offsetTop,nextZoom:vc(n)},this.state)})});O(this,"cancelInProgressAnimation",null);O(this,"scrollToContent",(n=this.scene.getNonDeletedElements(),r)=>{var l;(l=this.cancelInProgressAnimation)==null||l.call(this);const i=Array.isArray(n)?n:[n];let s=this.state.zoom,o=this.state.scrollX,a=this.state.scrollY;if(r!=null&&r.fitToContent||r!=null&&r.fitToViewport){const{appState:c}=a2({targetElements:i,appState:this.state,fitToViewport:!!(r!=null&&r.fitToViewport),viewportZoomFactor:r==null?void 0:r.viewportZoomFactor});s=c.zoom,o=c.scrollX,a=c.scrollY}else{const c=nm(i,this.state);o=c.scrollX,a=c.scrollY}if(r!=null&&r.animate){const c=this.state.scrollX,u=this.state.scrollY,d=this.state.zoom.value,h=uW({fromValues:{scrollX:c,scrollY:u,zoom:d},toValues:{scrollX:o,scrollY:a,zoom:s.value},interpolateValue:(f,p,m,v)=>{if(v==="zoom")return f*Math.pow(p/f,UT(m))},onStep:({scrollX:f,scrollY:p,zoom:m})=>{this.setState({scrollX:f,scrollY:p,zoom:{value:m}})},onStart:()=>{this.setState({shouldCacheIgnoreZoom:!0})},onEnd:()=>{this.setState({shouldCacheIgnoreZoom:!1})},onCancel:()=>{this.setState({shouldCacheIgnoreZoom:!1})},duration:(r==null?void 0:r.duration)??500});this.cancelInProgressAnimation=()=>{h(),this.cancelInProgressAnimation=null}}else this.setState({scrollX:o,scrollY:a,zoom:s})});O(this,"maybeUnfollowRemoteUser",()=>{this.state.userToFollow&&this.setState({userToFollow:null})});O(this,"translateCanvas",n=>{var r;(r=this.cancelInProgressAnimation)==null||r.call(this),this.maybeUnfollowRemoteUser(),this.setState(n)});O(this,"setToast",n=>{this.setState({toast:n})});O(this,"restoreFileFromShare",async()=>{try{const n=await caches.open("web-share-target"),r=await n.match("shared-file");if(r){const i=await r.blob(),s=new File([i],i.name||"",{type:i.type});this.loadFileToCanvas(s,null),await n.delete("shared-file"),window.history.replaceState(null,Ho,window.location.pathname)}}catch(n){this.setState({errorMessage:n.message})}});O(this,"addFiles",Nt(n=>{const r=n.reduce((i,s)=>(i.set(s.id,s),i),new Map);this.files={...this.files,...Object.fromEntries(r)},this.scene.getNonDeletedElements().forEach(i=>{En(i)&&r.has(i.fileId)&&(this.imageCache.delete(i.fileId),mt.delete(i))}),this.scene.informMutation(),this.addNewImagesToImageCache()}));O(this,"updateScene",Nt(n=>{n.commitToHistory&&this.history.resumeRecording(),n.appState&&this.setState(n.appState),n.elements&&this.scene.replaceAllElements(n.elements),n.collaborators&&this.setState({collaborators:n.collaborators})}));O(this,"onSceneUpdated",()=>{this.setState({})});O(this,"toggleSidebar",({name:n,tab:r,force:i})=>{var o;let s;return i===void 0?s=((o=this.state.openSidebar)==null?void 0:o.name)===n?null:n:s=i?n:null,this.setState({openSidebar:s?{name:s,tab:r}:null}),!!s});O(this,"updateCurrentCursorPosition",Nt(n=>{this.lastViewportPosition.x=n.clientX,this.lastViewportPosition.y=n.clientY}));O(this,"onKeyDown",Nt(n=>{if("Proxy"in window&&(!n.shiftKey&&/^[A-Z]$/.test(n.key)||n.shiftKey&&/^[a-z]$/.test(n.key))&&(n=new Proxy(n,{get(o,a){const l=o[a];return typeof l=="function"?l.bind(o):a==="key"?n.shiftKey?o.key.toUpperCase():o.key.toLowerCase():l}})),n[z.CTRL_OR_CMD]&&n.key.toLowerCase()===z.V&&(aE=n.shiftKey,clearTimeout(bM),bM=window.setTimeout(()=>{aE=!1},100)),n[z.CTRL_OR_CMD]&&rc(n.target)&&(n.code===ht.MINUS||n.code===ht.EQUAL)){n.preventDefault();return}if(rc(n.target)&&n.key!==z.ESCAPE||r0(n.key)&&iR(n.target))return;if(n.key===z.QUESTION_MARK){this.setState({openDialog:{name:"help"}});return}else if(n.key.toLowerCase()===z.E&&n.shiftKey&&n[z.CTRL_OR_CMD]){n.preventDefault(),this.setState({openDialog:{name:"imageExport"}});return}if(n.key===z.PAGE_UP||n.key===z.PAGE_DOWN){let o=(n.shiftKey?this.state.width:this.state.height)/this.state.zoom.value;n.key===z.PAGE_DOWN&&(o=-o),n.shiftKey?this.translateCanvas(a=>({scrollX:a.scrollX+o})):this.translateCanvas(a=>({scrollY:a.scrollY+o}))}if(this.actionManager.handleKeyDown(n)||this.state.viewModeEnabled)return;if(n[z.CTRL_OR_CMD]&&this.state.isBindingEnabled&&this.setState({isBindingEnabled:!1}),r0(n.key)){const o=this.state.gridSize&&(n.shiftKey?CC:this.state.gridSize)||(n.shiftKey?CV:CC);let a=0,l=0;n.key===z.ARROW_LEFT?a=-o:n.key===z.ARROW_RIGHT?a=o:n.key===z.ARROW_UP?l=-o:n.key===z.ARROW_DOWN&&(l=o);const c=this.scene.getSelectedElements({selectedElementIds:this.state.selectedElementIds,includeBoundTextElement:!0,includeElementsInFrames:!0});c.forEach(u=>{ae(u,{x:u.x+a,y:u.y+l}),wl(u,{simultaneouslyUpdated:c})}),this.maybeSuggestBindingForAll(c),n.preventDefault()}else if(n.key===z.ENTER){const o=this.scene.getSelectedElements(this.state);if(o.length===1){const a=o[0];if(n[z.CTRL_OR_CMD])Je(a)&&(!this.state.editingLinearElement||this.state.editingLinearElement.elementId!==o[0].id)&&(this.history.resumeRecording(),this.setState({editingLinearElement:new Ae(a,this.scene)}));else if(Se(a)||woe(a)){let l;Se(a)||(l=a);const c=b_(a,this.state),u=c.x,d=c.y;this.startTextEditing({sceneX:u,sceneY:d,container:l}),n.preventDefault();return}else qe(a)&&this.setState({editingFrame:a.id})}}else if(!n.ctrlKey&&!n.altKey&&!n.metaKey&&this.state.draggingElement===null){const o=Bhe(n.key);o?(this.state.activeTool.type!==o&&at("toolbar",o,`keyboard (${this.device.editor.isMobile?"mobile":"desktop"})`),this.setActiveTool({type:o}),n.stopPropagation()):n.key===z.Q&&(this.toggleLock("keyboard"),n.stopPropagation())}if(n.key===z.SPACE&&ct.pointers.size===0&&($l=!0,Et(this.interactiveCanvas,vt.GRAB),n.preventDefault()),(n.key===z.G||n.key===z.S)&&!n.altKey&&!n[z.CTRL_OR_CMD]){const o=this.scene.getSelectedElements(this.state);if(this.state.activeTool.type==="selection"&&!o.length)return;n.key===z.G&&(ld(this.state.activeTool.type)||o.some(a=>ld(a.type)))&&(this.setState({openPopup:"elementBackground"}),n.stopPropagation()),n.key===z.S&&(this.setState({openPopup:"elementStroke"}),n.stopPropagation())}if(n.key===z.K&&!n.altKey&&!n[z.CTRL_OR_CMD]){this.state.activeTool.type==="laser"?this.setActiveTool({type:"selection"}):this.setActiveTool({type:"laser"});return}n[z.CTRL_OR_CMD]&&(n.key===z.BACKSPACE||n.key===z.DELETE)&&zo.set(x4,"clearCanvas");const r=n.key.toLocaleLowerCase(),i=r===z.S&&n.shiftKey,s=n.key===z.I||r===z.G&&n.shiftKey;(i||s)&&this.openEyeDropper({type:i?"stroke":"background"})}));O(this,"onWheel",Nt(n=>{!(n.target instanceof HTMLCanvasElement)&&n.ctrlKey&&n.preventDefault()}));O(this,"onKeyUp",Nt(n=>{if(n.key===z.SPACE&&(this.state.viewModeEnabled?Et(this.interactiveCanvas,vt.GRAB):this.state.activeTool.type==="selection"?qi(this.interactiveCanvas):(zs(this.interactiveCanvas,this.state),this.setState({selectedElementIds:gt({},this.state),selectedGroupIds:{},editingGroupId:null,activeEmbeddable:null})),$l=!1),!n[z.CTRL_OR_CMD]&&!this.state.isBindingEnabled&&this.setState({isBindingEnabled:!0}),r0(n.key)){const r=this.scene.getSelectedElements(this.state);yc(this.state)?Ix(r):kx(r),this.setState({suggestedBindings:[]})}}));O(this,"isToolSupported",n=>{var r;return((r=this.props.UIOptions.tools)==null?void 0:r[n])!==!1});O(this,"setActiveTool",n=>{if(!this.isToolSupported(n.type)){console.warn(`"${n.type}" tool is disabled via "UIOptions.canvasActions.tools.${n.type}"`);return}const r=kn(this.state,n);r.type==="hand"?Et(this.interactiveCanvas,vt.GRAB):$l||zs(this.interactiveCanvas,this.state),lW(document.activeElement)&&this.focusContainer(),aS(r.type)||this.setState({suggestedBindings:[]}),r.type==="image"&&this.onImageAction({insertOnCanvasDirectly:(n.type==="image"&&n.insertOnCanvasDirectly)??!1}),this.setState(i=>{const s={snapLines:i.snapLines.length?[]:i.snapLines,originSnapOffset:null,activeEmbeddable:null};return r.type!=="selection"?{...i,activeTool:r,selectedElementIds:gt({},i),selectedGroupIds:gt({},i),editingGroupId:null,multiElement:null,...s}:{...i,activeTool:r,...s}})});O(this,"setOpenDialog",n=>{this.setState({openDialog:n})});O(this,"setCursor",n=>{Et(this.interactiveCanvas,n)});O(this,"resetCursor",()=>{qi(this.interactiveCanvas)});O(this,"isTouchScreenMultiTouchGesture",()=>ct.pointers.size>=2);O(this,"onGestureStart",Nt(n=>{n.preventDefault(),this.isTouchScreenMultiTouchGesture()&&this.setState({selectedElementIds:gt({},this.state),activeEmbeddable:null}),ct.initialScale=this.state.zoom.value}));O(this,"onGestureChange",Nt(n=>{if(n.preventDefault(),this.isTouchScreenMultiTouchGesture())return;const r=ct.initialScale;r&&this.setState(i=>({...bc({viewportX:this.lastViewportPosition.x,viewportY:this.lastViewportPosition.y,nextZoom:vc(r*n.scale)},i)}))}));O(this,"onGestureEnd",Nt(n=>{n.preventDefault(),this.isTouchScreenMultiTouchGesture()&&this.setState({previousSelectedElementIds:{},selectedElementIds:gt(this.state.previousSelectedElementIds,this.state)}),ct.initialScale=null}));O(this,"startTextEditing",({sceneX:n,sceneY:r,insertAtParentCenter:i=!0,container:s})=>{let o=!1,a=i&&this.getTextWysiwygSnappedToCenterPosition(n,r,this.state,s);s&&a&&(tt(s)||(o=!0));let l=null;const c=this.scene.getSelectedElements(this.state);c.length===1?Se(c[0])?l=c[0]:s?l=tt(c[0]):l=this.getTextElementAtPosition(n,r):l=this.getTextElementAtPosition(n,r);const u=(l==null?void 0:l.fontFamily)||this.state.currentItemFontFamily,d=(l==null?void 0:l.lineHeight)||Kc(u),h=this.state.currentItemFontSize;if(!l&&o&&s&&!Ct(s)){const v=wN(mn({fontSize:h,fontFamily:u}),d),y=bN(h,d),b=Math.max(s.height,y),_=Math.max(s.width,v);ae(s,{height:b,width:_}),n=s.x+_/2,r=s.y+b/2,a&&(a=this.getTextWysiwygSnappedToCenterPosition(n,r,this.state,s))}const f=this.getTopLayerFrameAtSceneCoords({x:n,y:r}),p=l||Ni({x:a?a.elementCenterX:n,y:a?a.elementCenterY:r,strokeColor:this.state.currentItemStrokeColor,backgroundColor:this.state.currentItemBackgroundColor,fillStyle:this.state.currentItemFillStyle,strokeWidth:this.state.currentItemStrokeWidth,strokeStyle:this.state.currentItemStrokeStyle,roughness:this.state.currentItemRoughness,opacity:this.state.currentItemOpacity,text:"",fontSize:h,fontFamily:u,textAlign:a?"center":this.state.currentItemTextAlign,verticalAlign:a?ai.MIDDLE:j0,containerId:o?s==null?void 0:s.id:void 0,groupIds:(s==null?void 0:s.groupIds)??[],lineHeight:d,angle:(s==null?void 0:s.angle)??0,frameId:f?f.id:null});if(!l&&o&&s&&ae(s,{boundElements:(s.boundElements||[]).concat({type:"text",id:p.id})}),this.setState({editingElement:p}),!l)if(s&&o){const m=this.scene.getElementIndex(s.id);this.scene.insertElementAtIndex(p,m+1)}else this.scene.addNewElement(p);this.setState({editingElement:p}),this.handleTextWysiwyg(p,{isExistingElement:!!l})});O(this,"handleCanvasDoubleClick",n=>{if(this.state.multiElement||this.state.activeTool.type!=="selection")return;const r=this.scene.getSelectedElements(this.state);if(r.length===1&&Je(r[0])){if(n[z.CTRL_OR_CMD]&&(!this.state.editingLinearElement||this.state.editingLinearElement.elementId!==r[0].id)){this.history.resumeRecording(),this.setState({editingLinearElement:new Ae(r[0],this.scene)});return}else if(this.state.editingLinearElement&&this.state.editingLinearElement.elementId===r[0].id)return}qi(this.interactiveCanvas);let{x:i,y:s}=Ft(n,this.state);if(Cd(this.state).length>0){const a=this.getElementAtPosition(i,s),l=a&&CQ(a,this.state.selectedGroupIds);if(l){this.setState(c=>({...c,...ri({editingGroupId:l,selectedElementIds:{[a.id]:!0}},this.scene.getNonDeletedElements(),c,this)}));return}}if(qi(this.interactiveCanvas),!n[z.CTRL_OR_CMD]&&!this.state.viewModeEnabled){const a=this.getElementAtPosition(i,s);if(os(a)){this.setState({activeEmbeddable:{element:a,state:"active"}});return}const l=CA(this.scene.getNonDeletedElements(),this.state,i,s);if(l&&(vl(l)||!to(l.backgroundColor)||qp(l,this.state,this.frameNameBoundsCache,[i,s]))){const c=b_(l,this.state);i=c.x,s=c.y}this.startTextEditing({sceneX:i,sceneY:s,insertAtParentCenter:!n.altKey,container:l})}});O(this,"getElementLinkAtPosition",(n,r)=>{const i=this.scene.getNonDeletedElements().slice().reverse();let s=1/0;return i.find((o,a)=>(r&&o.id===r.id&&(s=a),o.link&&a<=s&&o_(o,this.state,[n.x,n.y],this.device.editor.isMobile)))});O(this,"redirectToLink",(n,r)=>{const i=vn(this.lastPointerDownEvent.clientX,this.lastPointerDownEvent.clientY,this.lastPointerUpEvent.clientX,this.lastPointerUpEvent.clientY);if(!this.hitLinkElement||r&&i>Gl||!r&&i!==0)return;const s=Ft(this.lastPointerDownEvent,this.state),o=o_(this.hitLinkElement,this.state,[s.x,s.y],this.device.editor.isMobile),a=Ft(this.lastPointerUpEvent,this.state),l=o_(this.hitLinkElement,this.state,[a.x,a.y],this.device.editor.isMobile);if(o&&l){let c=this.hitLinkElement.link;if(c){c=ao(c);let u;if(this.props.onLinkOpen&&(u=fR(ee.EXCALIDRAW_LINK,n.nativeEvent),this.props.onLinkOpen({...this.hitLinkElement,link:c},u)),!(u!=null&&u.defaultPrevented)){const d=rD(c)?"_self":"_blank",h=window.open(void 0,d);h&&(h.opener=null,h.location=c)}}}});O(this,"getTopLayerFrameAtSceneCoords",n=>{const r=this.scene.getNonDeletedFramesLikes().filter(i=>Bk(n,i));return r.length?r[r.length-1]:null});O(this,"handleCanvasPointerMove",n=>{var f;this.savePointer(n.clientX,n.clientY,this.state.cursorButton),ct.pointers.has(n.pointerId)&&ct.pointers.set(n.pointerId,{x:n.clientX,y:n.clientY});const r=ct.initialScale;if(ct.pointers.size===2&&ct.lastCenter&&r&&ct.initialDistance){const p=N8(ct.pointers),m=p.x-ct.lastCenter.x,v=p.y-ct.lastCenter.y;ct.lastCenter=p;const y=F8(Array.from(ct.pointers.values())),b=this.state.activeTool.type==="freedraw"&&this.state.penMode?1:y/ct.initialDistance,_=b?vc(r*b):this.state.zoom.value;this.setState(E=>{const w=bc({viewportX:p.x,viewportY:p.y,nextZoom:_},E);this.translateCanvas({zoom:w.zoom,scrollX:w.scrollX+m/_,scrollY:w.scrollY+v/_,shouldCacheIgnoreZoom:!0})}),this.resetShouldCacheIgnoreZoomDebounced()}else ct.lastCenter=ct.initialDistance=ct.initialScale=null;if($l||lf||iE||Gd(this.state))return;const s=w8(sE,n.clientX-this.state.offsetLeft,n.clientY-this.state.offsetTop).isOverEither;!this.state.draggingElement&&!this.state.multiElement&&(s?qi(this.interactiveCanvas):zs(this.interactiveCanvas,this.state));const o=Ft(n,this.state),{x:a,y:l}=o;if(!this.state.draggingElement&&Vme(this.state.activeTool.type)){const{originOffset:p,snapLines:m}=Gme(this.scene.getNonDeletedElements(),this.state,{x:a,y:l},n);this.setState(v=>{const y=yb(v.snapLines,m),b=v.originSnapOffset?yb(v.originSnapOffset,p):p;return v.snapLines===y&&v.originSnapOffset===b?null:{snapLines:y,originSnapOffset:b}})}else this.state.draggingElement||this.setState(p=>p.snapLines.length?{snapLines:[]}:null);if(this.state.editingLinearElement&&!this.state.editingLinearElement.isDragging){const p=Ae.handlePointerMove(n,a,l,this.state);p&&p!==this.state.editingLinearElement&&hi.flushSync(()=>{this.setState({editingLinearElement:p})}),(p==null?void 0:p.lastUncommittedPoint)!=null?this.maybeSuggestBindingAtCursor(o):hi.flushSync(()=>{this.setState({suggestedBindings:[]})})}if(CO(this.state.activeTool.type)){const{draggingElement:p}=this.state;pr(p,!1)?this.maybeSuggestBindingsForLinearElementAtCoords(p,[o],this.state.startBoundElement):this.maybeSuggestBindingAtCursor(o)}if(this.state.multiElement){const{multiElement:p}=this.state,{x:m,y:v}=p,{points:y,lastCommittedPoint:b}=p,_=y[y.length-1];if(zs(this.interactiveCanvas,this.state),_===b)vn(a-m,l-v,_[0],_[1])>=Fg?ae(p,{points:[...y,[a-m,l-v]]}):Et(this.interactiveCanvas,vt.POINTER);else if(y.length>2&&b&&vn(a-m,l-v,b[0],b[1])<Fg)Et(this.interactiveCanvas,vt.POINTER),ae(p,{points:y.slice(0,-1)});else{const[E,w]=Kn(a,l,n[z.CTRL_OR_CMD]?null:this.state.gridSize),[x,T]=(p==null?void 0:p.lastCommittedPoint)??[0,0];let C=E-m-x,k=w-v-T;Yf(n)&&({width:C,height:k}=l3(x+m,T+v,E,w)),sa(y,this.state.zoom.value)&&Et(this.interactiveCanvas,vt.POINTER),ae(p,{points:[...y.slice(0,-1),[x+C,T+k]]})}return}if(!!n.buttons||this.state.activeTool.type!=="selection"&&this.state.activeTool.type!=="text"&&this.state.activeTool.type!=="eraser")return;const u=this.scene.getNonDeletedElements(),d=this.scene.getSelectedElements(this.state);if(d.length===1&&!s&&!this.state.editingLinearElement){const p=y8(u,this.state,a,l,this.state.zoom,n.pointerType);if(p&&p.transformHandleType){Et(this.interactiveCanvas,b8(p));return}}else if(d.length>1&&!s){const p=v8(Ut(d),a,l,this.state.zoom,n.pointerType);if(p){Et(this.interactiveCanvas,b8({transformHandleType:p}));return}}const h=this.getElementAtPosition(o.x,o.y);this.hitLinkElement=this.getElementLinkAtPosition(o,h),!pc(this.state)&&(this.hitLinkElement&&!this.state.selectedElementIds[this.hitLinkElement.id]?(Et(this.interactiveCanvas,vt.POINTER),one(this.hitLinkElement,this.state)):(lne(),h&&(h.link||ur(h))&&this.state.selectedElementIds[h.id]&&!this.state.contextMenu&&!this.state.showHyperlinkPopup?this.setState({showHyperlinkPopup:"info"}):this.state.activeTool.type==="text"?Et(this.interactiveCanvas,Se(h)?vt.TEXT:vt.CROSSHAIR):this.state.viewModeEnabled?Et(this.interactiveCanvas,vt.GRAB):s?Et(this.interactiveCanvas,vt.AUTO):this.state.selectedLinearElement?this.handleHoverSelectedLinearElement(this.state.selectedLinearElement,a,l):n[z.CTRL_OR_CMD]?Et(this.interactiveCanvas,vt.AUTO):(h||this.isHittingCommonBoundingBoxOfSelectedElements(o,d))&&!(h!=null&&h.locked)&&(h&&os(h)&&this.isIframeLikeElementCenter(h,n,a,l)?(Et(this.interactiveCanvas,vt.POINTER),this.setState({activeEmbeddable:{element:h,state:"hover"}})):(Et(this.interactiveCanvas,vt.MOVE),((f=this.state.activeEmbeddable)==null?void 0:f.state)==="hover"&&this.setState({activeEmbeddable:null})))))});O(this,"handleEraser",(n,r,i)=>{const s=h=>{h.forEach(f=>{f.locked||(o.push(f.id),n.altKey?r.elementIdsToErase[f.id]&&r.elementIdsToErase[f.id].erase&&(r.elementIdsToErase[f.id].erase=!1):r.elementIdsToErase[f.id]||(r.elementIdsToErase[f.id]={erase:!0,opacity:f.opacity}))})},o=[],a=vn(r.lastCoords.x,r.lastCoords.y,i.x,i.y),l=10/this.state.zoom.value,c={...r.lastCoords};let u=0;for(;u<=a;){const h=this.getElementsAtPosition(c.x,c.y);if(s(h),u===a)break;u=Math.min(u+l,a);const f=u/a,p=(1-f)*c.x+f*i.x,m=(1-f)*c.y+f*i.y;c.x=p,c.y=m}const d=this.scene.getElementsIncludingDeleted().map(h=>{const f=nn(h)&&o.includes(h.containerId)?h.containerId:h.id;if(o.includes(f))if(n.altKey){if(r.elementIdsToErase[f]&&r.elementIdsToErase[f].erase===!1)return Re(h,{opacity:r.elementIdsToErase[f].opacity})}else return Re(h,{opacity:VV});return h});this.scene.replaceAllElements(d),r.lastCoords.x=i.x,r.lastCoords.y=i.y});O(this,"handleTouchMove",n=>{cf=!0});O(this,"handleCanvasPointerDown",n=>{var u,d;if(this.maybeUnfollowRemoteUser(),this.state.contextMenu&&this.setState({contextMenu:null}),this.state.snapLines&&this.setAppState({snapLines:[]}),this.updateGestureOnPointerDown(n),n.pointerType==="touch"&&this.state.draggingElement&&this.state.draggingElement.type==="freedraw"){const h=this.state.draggingElement;this.updateScene({...h.points.length<10?{elements:this.scene.getElementsIncludingDeleted().filter(f=>f.id!==h.id)}:{},appState:{draggingElement:null,editingElement:null,startBoundElement:null,suggestedBindings:[],selectedElementIds:gt(Object.keys(this.state.selectedElementIds).filter(f=>f!==h.id).reduce((f,p)=>(f[p]=this.state.selectedElementIds[p],f),{}),this.state)}});return}const r=document.getSelection();if(r!=null&&r.anchorNode&&r.removeAllRanges(),this.maybeOpenContextMenuAfterPointerDownOnTouchDevices(n),this.maybeCleanupAfterMissingPointerUp(n),!this.state.penDetected&&n.pointerType==="pen"&&this.setState(h=>({penMode:!0,penDetected:!0})),!this.device.isTouchScreen&&["pen","touch"].includes(n.pointerType)&&(this.device=Hg(this.device,{isTouchScreen:!0})),lf||(this.lastPointerDownEvent=n,this.handleCanvasPanUsingWheelOrSpaceDrag(n))||(this.setState({lastPointerDownWith:n.pointerType,cursorButton:"down"}),this.savePointer(n.clientX,n.clientY,"down"),n.button!==Fh.MAIN&&n.button!==Fh.TOUCH)||ct.pointers.size>1)return;const i=this.initialPointerDownState(n);if(this.setState({selectedElementsAreBeingDragged:!1}),this.handleDraggingScrollBar(n,i)||(this.clearSelectionIfNotUsingSelection(),this.updateBindingEnabledOnPointerMove(n),this.handleSelectionOnPointerDown(n,i))||!(!this.state.penMode||n.pointerType!=="touch"||this.state.activeTool.type==="selection"||this.state.activeTool.type==="text"||this.state.activeTool.type==="image"))return;if(this.state.activeTool.type==="text"){this.handleTextOnPointerDown(n,i);return}else if(this.state.activeTool.type==="arrow"||this.state.activeTool.type==="line")this.handleLinearElementOnPointerDown(n,this.state.activeTool.type,i);else if(this.state.activeTool.type==="image"){Et(this.interactiveCanvas,vt.CROSSHAIR);const h=this.state.pendingImageElementId&&this.scene.getElement(this.state.pendingImageElementId);if(!h)return;this.setState({draggingElement:h,editingElement:h,pendingImageElementId:null,multiElement:null});const{x:f,y:p}=Ft(n,this.state),m=this.getTopLayerFrameAtSceneCoords({x:f,y:p});ae(h,{x:f,y:p,frameId:m?m.id:null})}else this.state.activeTool.type==="freedraw"?this.handleFreeDrawElementOnPointerDown(n,this.state.activeTool.type,i):this.state.activeTool.type==="custom"?zs(this.interactiveCanvas,this.state):this.state.activeTool.type===kr.frame||this.state.activeTool.type===kr.magicframe?this.createFrameElementOnPointerDown(i,this.state.activeTool.type):this.state.activeTool.type==="laser"?this.laserPathManager.startPath(i.lastCoords.x,i.lastCoords.y):this.state.activeTool.type!=="eraser"&&this.state.activeTool.type!=="hand"&&this.createGenericElementOnPointerDown(this.state.activeTool.type,i);(d=(u=this.props)==null?void 0:u.onPointerDown)==null||d.call(u,this.state.activeTool,i),this.onPointerDownEmitter.trigger(this.state.activeTool,i,n);const o=this.onPointerMoveFromPointerDownHandler(i),a=this.onPointerUpFromPointerDownHandler(i),l=this.onKeyDownFromPointerDownHandler(i),c=this.onKeyUpFromPointerDownHandler(i);ba=a,(!this.state.viewModeEnabled||this.state.activeTool.type==="laser")&&(window.addEventListener(ee.POINTER_MOVE,o),window.addEventListener(ee.POINTER_UP,a),window.addEventListener(ee.KEYDOWN,l),window.addEventListener(ee.KEYUP,c),i.eventListeners.onMove=o,i.eventListeners.onUp=a,i.eventListeners.onKeyUp=c,i.eventListeners.onKeyDown=l)});O(this,"handleCanvasPointerUp",n=>{var s;this.removePointer(n),this.lastPointerUpEvent=n;const r=Ft({clientX:n.clientX,clientY:n.clientY},this.state),i=n.timeStamp-(((s=this.lastPointerDownEvent)==null?void 0:s.timeStamp)??0);if(this.device.editor.isMobile&&i<300){const o=this.getElementAtPosition(r.x,r.y);if(os(o)&&this.isIframeLikeElementCenter(o,n,r.x,r.y)){this.handleEmbeddableCenterClick(o);return}}if(this.device.isTouchScreen){const o=this.getElementAtPosition(r.x,r.y);this.hitLinkElement=this.getElementLinkAtPosition(r,o)}this.hitLinkElement&&!this.state.selectedElementIds[this.hitLinkElement.id]?i<300&&os(this.hitLinkElement)&&!aD(this.hitLinkElement,this.state,[r.x,r.y])?this.handleEmbeddableCenterClick(this.hitLinkElement):this.redirectToLink(n,this.device.isTouchScreen):this.state.viewModeEnabled&&this.setState({activeEmbeddable:null,selectedElementIds:{}})});O(this,"maybeOpenContextMenuAfterPointerDownOnTouchDevices",n=>{n.pointerType==="touch"&&(cf=!1,va?cf=!0:va=window.setTimeout(()=>{va=0,cf||this.handleCanvasContextMenu(n)},PV))});O(this,"resetContextMenuTimer",()=>{clearTimeout(va),va=0,cf=!1});O(this,"handleCanvasPanUsingWheelOrSpaceDrag",n=>{if(!(ct.pointers.size<=1&&(n.button===Fh.WHEEL||n.button===Fh.MAIN&&$l||Gd(this.state)||this.state.viewModeEnabled))||Se(this.state.editingElement))return!1;lf=!0,n.preventDefault();let r=!1;const i=/Linux/.test(window.navigator.platform);Et(this.interactiveCanvas,vt.GRABBING);let{clientX:s,clientY:o}=n;const a=gb(c=>{const u=s-c.clientX,d=o-c.clientY;if(s=c.clientX,o=c.clientY,i&&!r&&(Math.abs(u)>1||Math.abs(d)>1)){r=!0;const h=p=>{document.body.removeEventListener(ee.PASTE,h),p.stopPropagation()},f=()=>{setTimeout(()=>{document.body.removeEventListener(ee.PASTE,h),window.removeEventListener(ee.POINTER_UP,f)},100)};document.body.addEventListener(ee.PASTE,h),window.addEventListener(ee.POINTER_UP,f)}this.translateCanvas({scrollX:this.state.scrollX-u/this.state.zoom.value,scrollY:this.state.scrollY-d/this.state.zoom.value})}),l=Nt(ba=()=>{ba=null,lf=!1,$l||(this.state.viewModeEnabled?Et(this.interactiveCanvas,vt.GRAB):zs(this.interactiveCanvas,this.state)),this.setState({cursorButton:"up"}),this.savePointer(n.clientX,n.clientY,"up"),window.removeEventListener(ee.POINTER_MOVE,a),window.removeEventListener(ee.POINTER_UP,l),window.removeEventListener(ee.BLUR,l),a.flush()});return window.addEventListener(ee.BLUR,l),window.addEventListener(ee.POINTER_MOVE,a,{passive:!0}),window.addEventListener(ee.POINTER_UP,l),!0});O(this,"clearSelectionIfNotUsingSelection",()=>{this.state.activeTool.type!=="selection"&&this.setState({selectedElementIds:gt({},this.state),selectedGroupIds:{},editingGroupId:null,activeEmbeddable:null})});O(this,"handleSelectionOnPointerDown",(n,r)=>{if(this.state.activeTool.type==="selection"){const i=this.scene.getNonDeletedElements(),s=this.scene.getSelectedElements(this.state);if(s.length===1&&!this.state.editingLinearElement){const o=y8(i,this.state,r.origin.x,r.origin.y,this.state.zoom,n.pointerType);o!=null&&(this.setState({resizingElement:o.element}),r.resize.handleType=o.transformHandleType)}else s.length>1&&(r.resize.handleType=v8(Ut(s),r.origin.x,r.origin.y,this.state.zoom,n.pointerType));if(r.resize.handleType)r.resize.isResizing=!0,r.resize.offset=$a(Lde(r.resize.handleType,s,r.origin.x,r.origin.y)),s.length===1&&Je(s[0])&&s[0].points.length===2&&(r.resize.arrowDirection=Rde(r.resize.handleType,s[0]));else{if(this.state.selectedLinearElement){const l=this.state.editingLinearElement||this.state.selectedLinearElement,c=Ae.handlePointerDown(n,this.state,this.history,r.origin,l);if(c.hitElement&&(r.hit.element=c.hitElement),c.linearElementEditor&&(this.setState({selectedLinearElement:c.linearElementEditor}),this.state.editingLinearElement&&this.setState({editingLinearElement:c.linearElementEditor})),c.didAddPoint)return!0}if(r.hit.element=r.hit.element??this.getElementAtPosition(r.origin.x,r.origin.y),r.hit.element&&this.getElementLinkAtPosition({x:r.origin.x,y:r.origin.y},r.hit.element))return!1;r.hit.allHitElements=this.getElementsAtPosition(r.origin.x,r.origin.y);const o=r.hit.element,a=r.hit.allHitElements.some(l=>this.isASelectedElement(l));if((o===null||!a)&&!n.shiftKey&&!r.hit.hasHitCommonBoundingBoxOfSelectedElements&&this.clearSelection(o),this.state.editingLinearElement)this.setState({selectedElementIds:gt({[this.state.editingLinearElement.elementId]:!0},this.state)});else if(o!=null){if(n[z.CTRL_OR_CMD])return this.state.selectedElementIds[o.id]||(r.hit.wasAddedToSelection=!0),this.setState(l=>({...SQ(l,o),previousSelectedElementIds:this.state.selectedElementIds})),!1;this.state.selectedElementIds[o.id]||(this.state.editingGroupId&&!Xp(o,this.state.editingGroupId)&&this.setState({selectedElementIds:gt({},this.state),selectedGroupIds:{},editingGroupId:null,activeEmbeddable:null}),!a&&!r.hit.hasHitCommonBoundingBoxOfSelectedElements&&(this.setState(l=>{const c={...l.selectedElementIds,[o.id]:!0},u=[];if(Object.keys(l.selectedElementIds).forEach(d=>{const h=this.scene.getElement(d);h&&u.push(h)}),qe(o))oa(u,o.id).forEach(d=>{delete c[d.id]});else if(o.frameId)c[o.frameId]&&delete c[o.id];else{const d=o.groupIds,h=new Set(d.flatMap(f=>Gn(this.scene.getNonDeletedElements(),f)).filter(f=>qe(f)).map(f=>f.id));h.size>0&&u.forEach(f=>{f.frameId&&h.has(f.frameId)&&(delete c[f.id],f.groupIds.flatMap(p=>Gn(this.scene.getNonDeletedElements(),p)).forEach(p=>{delete c[p.id]}))})}return{...ri({editingGroupId:l.editingGroupId,selectedElementIds:c},this.scene.getNonDeletedElements(),l,this),showHyperlinkPopup:o.link||ur(o)?"info":!1}}),r.hit.wasAddedToSelection=!0))}this.setState({previousSelectedElementIds:this.state.selectedElementIds})}}return!1});O(this,"handleTextOnPointerDown",(n,r)=>{if(Se(this.state.editingElement))return;let i=r.origin.x,s=r.origin.y;const o=this.getElementAtPosition(i,s,{includeBoundTextElement:!0});let a=CA(this.scene.getNonDeletedElements(),this.state,i,s);vl(o)&&(a=o,i=o.x+o.width/2,s=o.y+o.height/2),this.startTextEditing({sceneX:i,sceneY:s,insertAtParentCenter:!n.altKey,container:a}),qi(this.interactiveCanvas),this.state.activeTool.locked||this.setState({activeTool:kn(this.state,{type:"selection"})})});O(this,"handleFreeDrawElementOnPointerDown",(n,r,i)=>{const[s,o]=Kn(i.origin.x,i.origin.y,null),a=this.getTopLayerFrameAtSceneCoords({x:s,y:o}),l=FQ({type:r,x:s,y:o,strokeColor:this.state.currentItemStrokeColor,backgroundColor:this.state.currentItemBackgroundColor,fillStyle:this.state.currentItemFillStyle,strokeWidth:this.state.currentItemStrokeWidth,strokeStyle:this.state.currentItemStrokeStyle,roughness:this.state.currentItemRoughness,opacity:this.state.currentItemOpacity,roundness:null,simulatePressure:n.pressure===.5,locked:!1,frameId:a?a.id:null});this.setState(d=>{const h={...d.selectedElementIds};return delete h[l.id],{selectedElementIds:gt(h,d)}});const c=l.simulatePressure?l.pressures:[...l.pressures,n.pressure];ae(l,{points:[[0,0]],pressures:c});const u=Ga(i.origin,this.scene);this.scene.addNewElement(l),this.setState({draggingElement:l,editingElement:l,startBoundElement:u,suggestedBindings:[]})});O(this,"insertIframeElement",({sceneX:n,sceneY:r,width:i,height:s})=>{var c;const[o,a]=Kn(n,r,(c=this.lastPointerDownEvent)!=null&&c[z.CTRL_OR_CMD]?null:this.state.gridSize),l=OQ({type:"iframe",x:o,y:a,strokeColor:"transparent",backgroundColor:"transparent",fillStyle:this.state.currentItemFillStyle,strokeWidth:this.state.currentItemStrokeWidth,strokeStyle:this.state.currentItemStrokeStyle,roughness:this.state.currentItemRoughness,roundness:this.getCurrentItemRoundness("iframe"),opacity:this.state.currentItemOpacity,locked:!1,width:i,height:s});return this.scene.replaceAllElements([...this.scene.getElementsIncludingDeleted(),l]),l});O(this,"insertEmbeddableElement",({sceneX:n,sceneY:r,link:i})=>{var c;const[s,o]=Kn(n,r,(c=this.lastPointerDownEvent)!=null&&c[z.CTRL_OR_CMD]?null:this.state.gridSize),a=ad(i);if(!a)return;a.warning&&this.setToast({message:a.warning,closable:!0});const l=AI({type:"embeddable",x:s,y:o,strokeColor:"transparent",backgroundColor:"transparent",fillStyle:this.state.currentItemFillStyle,strokeWidth:this.state.currentItemStrokeWidth,strokeStyle:this.state.currentItemStrokeStyle,roughness:this.state.currentItemRoughness,roundness:this.getCurrentItemRoundness("embeddable"),opacity:this.state.currentItemOpacity,locked:!1,width:a.intrinsicSize.w,height:a.intrinsicSize.h,link:i,validated:null});return this.scene.replaceAllElements([...this.scene.getElementsIncludingDeleted(),l]),l});O(this,"createImageElement",({sceneX:n,sceneY:r,addToFrameUnderCursor:i=!0})=>{var c;const[s,o]=Kn(n,r,(c=this.lastPointerDownEvent)!=null&&c[z.CTRL_OR_CMD]?null:this.state.gridSize),a=i?this.getTopLayerFrameAtSceneCoords({x:s,y:o}):null;return GO({type:"image",x:s,y:o,strokeColor:this.state.currentItemStrokeColor,backgroundColor:this.state.currentItemBackgroundColor,fillStyle:this.state.currentItemFillStyle,strokeWidth:this.state.currentItemStrokeWidth,strokeStyle:this.state.currentItemStrokeStyle,roughness:this.state.currentItemRoughness,roundness:null,opacity:this.state.currentItemOpacity,locked:!1,frameId:a?a.id:null})});O(this,"handleLinearElementOnPointerDown",(n,r,i)=>{if(this.state.multiElement){const{multiElement:s}=this.state;if(s.type==="line"&&sa(s.points,this.state.zoom.value)){ae(s,{lastCommittedPoint:s.points[s.points.length-1]}),this.actionManager.executeAction(Ds);return}const{x:o,y:a,lastCommittedPoint:l}=s;if(s.points.length>1&&l&&vn(i.origin.x-o,i.origin.y-a,l[0],l[1])<Fg){this.actionManager.executeAction(Ds);return}this.setState(c=>({selectedElementIds:gt({...c.selectedElementIds,[s.id]:!0},c)})),ae(s,{lastCommittedPoint:s.points[s.points.length-1]}),Et(this.interactiveCanvas,vt.POINTER)}else{const[s,o]=Kn(i.origin.x,i.origin.y,n[z.CTRL_OR_CMD]?null:this.state.gridSize),a=this.getTopLayerFrameAtSceneCoords({x:s,y:o}),{currentItemStartArrowhead:l,currentItemEndArrowhead:c}=this.state,[u,d]=r==="arrow"?[l,c]:[null,null],h=sl({type:r,x:s,y:o,strokeColor:this.state.currentItemStrokeColor,backgroundColor:this.state.currentItemBackgroundColor,fillStyle:this.state.currentItemFillStyle,strokeWidth:this.state.currentItemStrokeWidth,strokeStyle:this.state.currentItemStrokeStyle,roughness:this.state.currentItemRoughness,opacity:this.state.currentItemOpacity,roundness:this.state.currentItemRoundness==="round"?{type:jn.PROPORTIONAL_RADIUS}:null,startArrowhead:u,endArrowhead:d,locked:!1,frameId:a?a.id:null});this.setState(p=>{const m={...p.selectedElementIds};return delete m[h.id],{selectedElementIds:gt(m,p)}}),ae(h,{points:[...h.points,[0,0]]});const f=Ga(i.origin,this.scene);this.scene.addNewElement(h),this.setState({draggingElement:h,editingElement:h,startBoundElement:f,suggestedBindings:[]})}});O(this,"createGenericElementOnPointerDown",(n,r)=>{var c;const[i,s]=Kn(r.origin.x,r.origin.y,(c=this.lastPointerDownEvent)!=null&&c[z.CTRL_OR_CMD]?null:this.state.gridSize),o=this.getTopLayerFrameAtSceneCoords({x:i,y:s}),a={x:i,y:s,strokeColor:this.state.currentItemStrokeColor,backgroundColor:this.state.currentItemBackgroundColor,fillStyle:this.state.currentItemFillStyle,strokeWidth:this.state.currentItemStrokeWidth,strokeStyle:this.state.currentItemStrokeStyle,roughness:this.state.currentItemRoughness,opacity:this.state.currentItemOpacity,roundness:this.getCurrentItemRoundness(n),locked:!1,frameId:o?o.id:null};let l;n==="embeddable"?l=AI({type:"embeddable",validated:null,...a}):l=bl({type:n,...a}),l.type==="selection"?this.setState({selectionElement:l,draggingElement:l}):(this.scene.addNewElement(l),this.setState({multiElement:null,draggingElement:l,editingElement:l}))});O(this,"createFrameElementOnPointerDown",(n,r)=>{var l;const[i,s]=Kn(n.origin.x,n.origin.y,(l=this.lastPointerDownEvent)!=null&&l[z.CTRL_OR_CMD]?null:this.state.gridSize),o={x:i,y:s,opacity:this.state.currentItemOpacity,locked:!1,...Pt},a=r===kr.magicframe?_x(o):HO(o);this.scene.replaceAllElements([...this.scene.getElementsIncludingDeleted(),a]),this.setState({multiElement:null,draggingElement:a,editingElement:a})});O(this,"restoreReadyToEraseElements",n=>{const r=this.scene.getElementsIncludingDeleted().map(i=>n.elementIdsToErase[i.id]&&n.elementIdsToErase[i.id].erase?Re(i,{opacity:n.elementIdsToErase[i.id].opacity}):nn(i)&&n.elementIdsToErase[i.containerId]&&n.elementIdsToErase[i.containerId].erase?Re(i,{opacity:n.elementIdsToErase[i.containerId].opacity}):i.frameId&&n.elementIdsToErase[i.frameId]&&n.elementIdsToErase[i.frameId].erase?Re(i,{opacity:n.elementIdsToErase[i.frameId].opacity}):i);this.scene.replaceAllElements(r)});O(this,"eraseElements",n=>{const r=this.scene.getElementsIncludingDeleted().map(i=>n.elementIdsToErase[i.id]&&n.elementIdsToErase[i.id].erase?Re(i,{isDeleted:!0}):nn(i)&&n.elementIdsToErase[i.containerId]&&n.elementIdsToErase[i.containerId].erase?Re(i,{isDeleted:!0}):i.frameId&&n.elementIdsToErase[i.frameId]&&n.elementIdsToErase[i.frameId].erase?Re(i,{isDeleted:!0}):i);this.history.resumeRecording(),this.scene.replaceAllElements(r)});O(this,"initializeImage",async({imageFile:n,imageElement:r,showCursorImagePreview:i=!1})=>{var u,d,h,f;if(!Rc(n))throw new Error(I("errors.unsupportedFileType"));const s=n.type;if(Et(this.interactiveCanvas,"wait"),s===Oe.svg)try{n=$A(await Tae(await n.text()),n.name)}catch(p){throw console.warn(p),new Error(I("errors.svgImageInsertError"))}const o=await(((d=(u=this.props).generateIdForFile)==null?void 0:d.call(u,n))||pae(n));if(!o)throw console.warn("Couldn't generate file id or the supplied `generateIdForFile` didn't resolve to one."),new Error(I("errors.imageInsertError"));const a=this.files[o];if(!(a!=null&&a.dataURL)){try{n=await Wx(n,{maxWidthOrHeight:HV})}catch(p){console.error("Error trying to resizing image file on insertion",p)}if(n.size>PC)throw new Error(I("errors.fileTooBig",{maxSize:`${Math.trunc(PC/1024/1024)}MB`}))}if(i){const p=(h=this.files[o])==null?void 0:h.dataURL,m=p&&mae(p);this.setImagePreviewCursor(m||n)}const l=((f=this.files[o])==null?void 0:f.dataURL)||await E_(n),c=ae(r,{fileId:o},!1);return new Promise(async(p,m)=>{var v;try{this.files={...this.files,[o]:{mimeType:s,id:o,dataURL:l,created:Date.now(),lastRetrieved:Date.now()}};const y=this.imageCache.get(o);y||(this.addNewImagesToImageCache(),await this.updateImageCache([c])),(y==null?void 0:y.image)instanceof Promise&&await y.image,this.state.pendingImageElementId!==c.id&&((v=this.state.draggingElement)==null?void 0:v.id)!==c.id&&this.initializeImageDimensions(c,!0),p(c)}catch(y){console.error(y),m(new Error(I("errors.imageInsertError")))}finally{i||qi(this.interactiveCanvas)}})});O(this,"insertImageElement",async(n,r,i)=>{if(!this.isToolSupported("image")){this.setState({errorMessage:I("errors.imageToolNotSupported")});return}this.scene.addNewElement(n);try{return await this.initializeImage({imageFile:r,imageElement:n,showCursorImagePreview:i})}catch(s){return ae(n,{isDeleted:!0}),this.actionManager.executeAction(Ds),this.setState({errorMessage:s.message||I("errors.imageInsertError")}),null}});O(this,"setImagePreviewCursor",async n=>{const i=await Wx(n,{maxWidthOrHeight:96});let s=await E_(i);if(n.type===Oe.svg){const o=await jN(s);let a=Math.min(o.height,96),l=a*(o.width/o.height);l>96&&(l=96,a=l*(o.height/o.width));const c=document.createElement("canvas");c.height=a,c.width=l,c.getContext("2d").drawImage(o,0,0,l,a),s=c.toDataURL(Oe.svg)}this.state.pendingImageElementId&&Et(this.interactiveCanvas,`url(${s}) 4 4, auto`)});O(this,"onImageAction",async({insertOnCanvasDirectly:n})=>{try{const r=this.state.width/2+this.state.offsetLeft,i=this.state.height/2+this.state.offsetTop,{x:s,y:o}=Ft({clientX:r,clientY:i},this.state),a=await jS({description:"Image",extensions:Object.keys(kT)}),l=this.createImageElement({sceneX:s,sceneY:o,addToFrameUnderCursor:!1});n?(this.insertImageElement(l,a),this.initializeImageDimensions(l),this.setState({selectedElementIds:gt({[l.id]:!0},this.state)},()=>{this.actionManager.executeAction(Ds)})):this.setState({pendingImageElementId:l.id},()=>{this.insertImageElement(l,a,!0)})}catch(r){r.name!=="AbortError"?console.error(r):console.warn(r),this.setState({pendingImageElementId:null,editingElement:null,activeTool:kn(this.state,{type:"selection"})},()=>{this.actionManager.executeAction(Ds)})}});O(this,"initializeImageDimensions",(n,r=!1)=>{var s;const i=En(n)&&((s=this.imageCache.get(n.fileId))==null?void 0:s.image);if(!i||i instanceof Promise){if(n.width<Gl/this.state.zoom.value&&n.height<Gl/this.state.zoom.value){const o=100/this.state.zoom.value;ae(n,{x:n.x-o/2,y:n.y-o/2,width:o,height:o})}return}if(r||n.width<Gl/this.state.zoom.value&&n.height<Gl/this.state.zoom.value){const o=Math.max(this.state.height-120,160),a=Math.min(o,Math.floor(this.state.height*.5)/this.state.zoom.value),l=Math.min(i.naturalHeight,a),c=l*(i.naturalWidth/i.naturalHeight),u=n.x+n.width/2-c/2,d=n.y+n.height/2-l/2;ae(n,{x:u,y:d,width:c,height:l})}});O(this,"updateImageCache",async(n,r=this.files)=>{const{updatedFiles:i,erroredFiles:s}=await XN({imageCache:this.imageCache,fileIds:n.map(o=>o.fileId),files:r});if(i.size||s.size)for(const o of n)i.has(o.fileId)&&mt.delete(o);return s.size&&this.scene.replaceAllElements(this.scene.getElementsIncludingDeleted().map(o=>En(o)&&s.has(o.fileId)?Re(o,{status:"error"}):o)),{updatedFiles:i,erroredFiles:s}});O(this,"addNewImagesToImageCache",async(n=YN(this.scene.getNonDeletedElements()),r=this.files)=>{const i=n.filter(s=>!s.isDeleted&&!this.imageCache.has(s.fileId));if(i.length){const{updatedFiles:s}=await this.updateImageCache(i,r);s.size&&this.scene.informMutation()}});O(this,"scheduleImageRefresh",Tc(()=>{this.addNewImagesToImageCache()},kV));O(this,"updateBindingEnabledOnPointerMove",n=>{const r=ere(n);this.state.isBindingEnabled!==r&&this.setState({isBindingEnabled:r})});O(this,"maybeSuggestBindingAtCursor",n=>{const r=Ga(n,this.scene);this.setState({suggestedBindings:r!=null?[r]:[]})});O(this,"maybeSuggestBindingsForLinearElementAtCoords",(n,r,i)=>{if(!r.length)return;const s=r.reduce((o,a)=>{const l=Ga(a,this.scene);return l!=null&&!xD(n,i==null?void 0:i.id,l)&&o.push(l),o},[]);this.setState({suggestedBindings:s})});O(this,"handleInteractiveCanvasRef",n=>{var r,i,s;n!==null?(this.interactiveCanvas=n,this.interactiveCanvas.addEventListener(ee.WHEEL,this.handleWheel),this.interactiveCanvas.addEventListener(ee.TOUCH_START,this.onTouchStart),this.interactiveCanvas.addEventListener(ee.TOUCH_END,this.onTouchEnd)):((r=this.interactiveCanvas)==null||r.removeEventListener(ee.WHEEL,this.handleWheel),(i=this.interactiveCanvas)==null||i.removeEventListener(ee.TOUCH_START,this.onTouchStart),(s=this.interactiveCanvas)==null||s.removeEventListener(ee.TOUCH_END,this.onTouchEnd))});O(this,"handleAppOnDrop",async n=>{var l,c,u,d;const{file:r,fileHandle:i}=await yae(n),{x:s,y:o}=Ft(n,this.state);try{if(Rc(r)&&this.isToolSupported("image")){if((r==null?void 0:r.type)===Oe.png||(r==null?void 0:r.type)===Oe.svg)try{const f=await YS(r,this.state,this.scene.getElementsIncludingDeleted(),i);this.syncActionResult({...f,appState:{...f.appState||this.state,isLoading:!1},replaceFiles:!0,commitToHistory:!0});return}catch(f){if(f.name!=="EncodingError")throw f}const h=this.createImageElement({sceneX:s,sceneY:o});this.insertImageElement(h,r),this.initializeImageDimensions(h),this.setState({selectedElementIds:gt({[h.id]:!0},this.state)});return}}catch(h){return this.setState({isLoading:!1,errorMessage:h.message})}const a=n.dataTransfer.getData(Oe.excalidrawlib);if(a&&typeof a=="string"){try{const h=zN(a);this.addElementsFromPasteOrLibrary({elements:tB(h),position:n,files:null})}catch(h){this.setState({errorMessage:h.message})}return}if(r&&await this.loadFileToCanvas(r,i),(c=(l=n.dataTransfer)==null?void 0:l.types)!=null&&c.includes("text/plain")){const h=(u=n.dataTransfer)==null?void 0:u.getData("text");if(h&&t0(h,this.props.validateEmbeddable)&&(/^(http|https):\/\/[^\s/$.?#].[^\s]*$/.test(h)||((d=ad(h))==null?void 0:d.type)==="video")){const f=this.insertEmbeddableElement({sceneX:s,sceneY:o,link:ao(h)});f&&this.setState({selectedElementIds:{[f.id]:!0}})}}});O(this,"loadFileToCanvas",async(n,r)=>{n=await ZS(n);try{const i=await HN(n,this.state,this.scene.getElementsIncludingDeleted(),r);i.type===Oe.excalidraw?(this.setState({isLoading:!0}),this.syncActionResult({...i.data,appState:{...i.data.appState||this.state,isLoading:!1},replaceFiles:!0,commitToHistory:!0})):i.type===Oe.excalidrawlib&&await this.library.updateLibrary({libraryItems:n,merge:!0,openLibraryMenu:!0}).catch(s=>{console.error(s),this.setState({errorMessage:I("errors.importLibraryError")})})}catch(i){if(i instanceof gc&&i.code==="IMAGE_NOT_CONTAINS_SCENE_DATA"&&!this.isToolSupported("image")){this.setState({isLoading:!1,errorMessage:I("errors.imageToolNotSupported")});return}this.setState({isLoading:!1,errorMessage:i.message})}});O(this,"handleCanvasContextMenu",n=>{if(n.preventDefault(),("pointerType"in n.nativeEvent&&n.nativeEvent.pointerType==="touch"||"pointerType"in n.nativeEvent&&n.nativeEvent.pointerType==="pen"&&n.button!==Fh.SECONDARY)&&this.state.activeTool.type!=="selection")return;const{x:r,y:i}=Ft(n,this.state),s=this.getElementAtPosition(r,i,{preferSelected:!0,includeLockedElements:!0}),o=this.scene.getSelectedElements(this.state),a=this.isHittingCommonBoundingBoxOfSelectedElements({x:r,y:i},o),l=s||a?"element":"canvas",c=this.excalidrawContainerRef.current,{top:u,left:d}=c.getBoundingClientRect(),h=n.clientX-d,f=n.clientY-u;at("contextMenu","openContextMenu",l),this.setState({...s&&!this.state.selectedElementIds[s.id]?{...this.state,...ri({editingGroupId:this.state.editingGroupId,selectedElementIds:{[s.id]:!0}},this.scene.getNonDeletedElements(),this.state,this),selectedLinearElement:Je(s)?new Ae(s,this.scene):null}:this.state,showHyperlinkPopup:!1},()=>{this.setState({contextMenu:{top:f,left:h,items:this.getContextMenuItems(l)}})})});O(this,"maybeDragNewGenericElement",(n,r)=>{var o,a,l;const i=this.state.draggingElement,s=n.lastCoords;if(i)if(i.type==="selection"&&this.state.activeTool.type!=="eraser")E8(i,this.state.activeTool.type,n.origin.x,n.origin.y,s.x,s.y,fr(n.origin.x,s.x),fr(n.origin.y,s.y),Kh(r),s_(r));else{let[c,u]=Kn(s.x,s.y,r[z.CTRL_OR_CMD]?null:this.state.gridSize);const d=En(i)&&((o=this.imageCache.get(i.fileId))==null?void 0:o.image),h=d&&!(d instanceof Promise)?d.width/d.height:null;this.maybeCacheReferenceSnapPoints(r,[i]);const{snapOffset:f,snapLines:p}=zme(i,this.state,r,{x:n.originInGrid.x+(((a=this.state.originSnapOffset)==null?void 0:a.x)??0),y:n.originInGrid.y+(((l=this.state.originSnapOffset)==null?void 0:l.y)??0)},{x:c-n.originInGrid.x,y:u-n.originInGrid.y});c+=f.x,u+=f.y,this.setState({snapLines:p}),E8(i,this.state.activeTool.type,n.originInGrid.x,n.originInGrid.y,c,u,fr(n.originInGrid.x,c),fr(n.originInGrid.y,u),Wo(i)?!Kh(r):Kh(r),s_(r),h,this.state.originSnapOffset),this.maybeSuggestBindingForAll([i]),(this.state.activeTool.type===kr.frame||this.state.activeTool.type===kr.magicframe)&&this.setState({elementsToHighlight:m0(this.scene.getNonDeletedElements(),i,this.state)})}});O(this,"maybeHandleResize",(n,r)=>{const i=this.scene.getSelectedElements(this.state),s=i.filter(d=>qe(d)),o=n.resize.handleType;if(s.length>0&&o==="rotation")return!1;this.setState({isResizing:o&&o!=="rotation",isRotating:o==="rotation",activeEmbeddable:null});const a=n.lastCoords;let[l,c]=Kn(a.x-n.resize.offset.x,a.y-n.resize.offset.y,r[z.CTRL_OR_CMD]?null:this.state.gridSize);const u=new Map;if(s.forEach(d=>{oa(this.scene.getNonDeletedElements(),d.id).forEach(f=>{u.set(d.id+f.id,{x:f.x-d.x,y:f.y-d.y})})}),!this.state.selectedElementsAreBeingDragged){const[d,h]=Kn(a.x,a.y,r[z.CTRL_OR_CMD]?null:this.state.gridSize),f={x:d-n.originInGrid.x,y:h-n.originInGrid.y},p=[...n.originalElements.values()];this.maybeCacheReferenceSnapPoints(r,i);const{snapOffset:m,snapLines:v}=Hme(i,Rt(p,this.state),this.state,r,f,o);l+=m.x,c+=m.y,this.setState({snapLines:v})}if(Sde(n,o,i,n.resize.arrowDirection,Yf(r),s_(r),i.length===1&&Wo(i[0])?!Kh(r):Kh(r),l,c,n.resize.center.x,n.resize.center.y,this.state)){this.maybeSuggestBindingForAll(i);const d=new Set;return s.forEach(h=>{m0(this.scene.getNonDeletedElements(),h,this.state).forEach(f=>d.add(f))}),this.setState({elementsToHighlight:[...d]}),!0}return!1});O(this,"getContextMenuItems",n=>{const r=[];return r.push(L8,P8),n==="canvas"?this.state.viewModeEnabled?[...r,O8,f3,rM,qy]:[k8,Ur,L8,P8,R8,Ur,Qde,Phe,Ur,O8,The,f3,rM,qy]:(r.push(R8),this.state.viewModeEnabled?[y0,...r]:[M8,y0,k8,Lme,Rme,Ur,...r,Ur,hhe,fhe,Ur,mhe,She,Che,khe,ghe,Ur,yhe,Ur,Zde,Kde,qde,Jde,Ur,Ehe,whe,Ur,Lhe,sne,rhe,Mhe,Ur,IB])});O(this,"handleWheel",Nt(n=>{if(n.preventDefault(),lf)return;const{deltaX:r,deltaY:i}=n;if(n.metaKey||n.ctrlKey){const s=Math.sign(i),o=Op*100,a=Math.abs(i);let l=i;a>o&&(l=o*s);let c=this.state.zoom.value-l/100;c+=Math.log10(Math.max(1,this.state.zoom.value))*-s*Math.min(1,a/20),this.translateCanvas(u=>({...bc({viewportX:this.lastViewportPosition.x,viewportY:this.lastViewportPosition.y,nextZoom:vc(c)},u),shouldCacheIgnoreZoom:!0})),this.resetShouldCacheIgnoreZoomDebounced();return}if(n.shiftKey){this.translateCanvas(({zoom:s,scrollX:o})=>({scrollX:o-(i||r)/s.value}));return}this.translateCanvas(({zoom:s,scrollX:o,scrollY:a})=>({scrollX:o-r/s.value,scrollY:a-i/s.value}))}));O(this,"savePointer",(n,r,i)=>{var l,c;if(!n||!r)return;const{x:s,y:o}=Ft({clientX:n,clientY:r},this.state),a={x:s,y:o,tool:this.state.activeTool.type==="laser"?"laser":"pointer"};(c=(l=this.props).onPointerUpdate)==null||c.call(l,{pointer:a,button:i,pointersMap:ct.pointers})});O(this,"resetShouldCacheIgnoreZoomDebounced",$c(()=>{this.unmounted||this.setState({shouldCacheIgnoreZoom:!1})},300));O(this,"updateDOMRect",n=>{var r,i;if((r=this.excalidrawContainerRef)!=null&&r.current){const s=this.excalidrawContainerRef.current,{width:o,height:a,left:l,top:c}=s.getBoundingClientRect(),{width:u,height:d,offsetTop:h,offsetLeft:f}=this.state;if(o===u&&a===d&&l===f&&c===h){n&&n();return}this.state.webGLEnabled&&((i=this.pixi)==null||i.renderer.resize(o,a)),this.setState({width:o,height:a,offsetLeft:l,offsetTop:c},()=>{n&&n()})}});O(this,"refresh",()=>{this.setState({...this.getCanvasOffsets()})});const r=Es(),{excalidrawAPI:i,viewModeEnabled:s=!1,zenModeEnabled:o=!1,gridModeEnabled:a=!1,objectsSnapModeEnabled:l=!1,theme:c=r.theme,name:u=r.name}=n;if(this.state={...r,theme:c,isLoading:!0,...this.getCanvasOffsets(),viewModeEnabled:s,zenModeEnabled:o,objectsSnapModeEnabled:l,gridSize:a?vd:null,name:u,width:window.innerWidth,height:window.innerHeight},this.id=oS(),this.library=new eue(this),this.actionManager=new Dhe(this.syncActionResult,()=>this.state,()=>this.scene.getElementsIncludingDeleted(),this),this.scene=new bt,this.canvas=document.createElement("canvas"),this.state.webGLEnabled){this.pixi=new F9({view:this.canvas,autoDensity:!0,antialias:!0,autoStart:!1,backgroundColor:this.state.viewBackgroundColor,resolution:window.devicePixelRatio,eventMode:"none",width:this.state.width,height:this.state.height,eventFeatures:{click:!1,globalMove:!1,move:!1,wheel:!1}}),this.pixi.stage.interactiveChildren=!1;const d=new Xn;this.pixi.stage.addChild(d);const h=new Xn;h.sortableChildren=!0,this.pixi.stage.addChild(h)}else this.rc=Ll.canvas(this.canvas);if(this.renderer=new cM(this.scene),i){const d={updateScene:this.updateScene,updateLibrary:this.library.updateLibrary,addFiles:this.addFiles,resetScene:this.resetScene,getSceneElementsIncludingDeleted:this.getSceneElementsIncludingDeleted,history:{clear:this.resetHistory},scrollToContent:this.scrollToContent,getSceneElements:this.getSceneElements,getAppState:()=>this.state,getFiles:()=>this.files,registerAction:h=>{this.actionManager.registerAction(h)},refresh:this.refresh,setToast:this.setToast,id:this.id,setActiveTool:this.setActiveTool,setCursor:this.setCursor,resetCursor:this.resetCursor,updateFrameRendering:this.updateFrameRendering,toggleSidebar:this.toggleSidebar,onChange:h=>this.onChangeEmitter.on(h),onPointerDown:h=>this.onPointerDownEmitter.on(h),onPointerUp:h=>this.onPointerUpEmitter.on(h),onScrollChange:h=>this.onScrollChangeEmitter.on(h),onUserFollow:h=>this.onUserFollowEmitter.on(h)};typeof i=="function"?i(d):console.error("excalidrawAPI should be a function!")}this.excalidrawContainerValue={container:this.excalidrawContainerRef.current,id:this.id},this.fonts=new v3({scene:this.scene,onSceneUpdated:this.onSceneUpdated}),this.history=new Fhe,this.actionManager.registerAll(bx),this.actionManager.registerAction(Rhe(this.history)),this.actionManager.registerAction(Ohe(this.history))}onWindowMessage(n){if(n.origin!=="https://player.vimeo.com"&&n.origin!=="https://www.youtube.com")return;let r=null;try{r=JSON.parse(n.data)}catch{}if(r)switch(n.origin){case"https://player.vimeo.com":if(r.method==="paused"){let i=null;const s=document.body.querySelectorAll("iframe.excalidraw__embeddable");if(!s)break;for(const o of s)o.contentWindow===n.source&&(i=o.contentWindow);i==null||i.postMessage(JSON.stringify({method:r.value?"play":"pause",value:!0}),"*")}break;case"https://www.youtube.com":if(r.event==="infoDelivery"&&r.info&&r.id&&typeof r.info.playerState=="number"){const i=r.id,s=r.info.playerState;Object.values(w1).includes(s)&&oE.set(i,s)}break}}cacheEmbeddableRef(n,r){r&&this.iFrameRefs.set(n.id,r)}getHTMLIFrameElement(n){return this.iFrameRefs.get(n.id)}handleEmbeddableCenterClick(n){var i,s,o,a;if(((i=this.state.activeEmbeddable)==null?void 0:i.element)===n&&((s=this.state.activeEmbeddable)==null?void 0:s.state)==="active"||(setTimeout(()=>{this.setState({activeEmbeddable:{element:n,state:"active"},selectedElementIds:{[n.id]:!0},draggingElement:null,selectionElement:null})},100),Pa(n)))return;const r=this.getHTMLIFrameElement(n);if(r!=null&&r.contentWindow){if(r.src.includes("youtube")){const l=oE.get(n.id);switch(l||(oE.set(n.id,w1.UNSTARTED),r.contentWindow.postMessage(JSON.stringify({event:"listening",id:n.id}),"*")),l){case w1.PLAYING:case w1.BUFFERING:(o=r.contentWindow)==null||o.postMessage(JSON.stringify({event:"command",func:"pauseVideo",args:""}),"*");break;default:(a=r.contentWindow)==null||a.postMessage(JSON.stringify({event:"command",func:"playVideo",args:""}),"*")}}r.src.includes("player.vimeo.com")&&r.contentWindow.postMessage(JSON.stringify({method:"paused"}),"*")}}isIframeLikeElementCenter(n,r,i,s){var o,a;return n&&!r.altKey&&!r.shiftKey&&!r.metaKey&&!r.ctrlKey&&(((o=this.state.activeEmbeddable)==null?void 0:o.element)!==n||((a=this.state.activeEmbeddable)==null?void 0:a.state)==="hover"||!this.state.activeEmbeddable)&&i>=n.x+n.width/3&&i<=n.x+2*n.width/3&&s>=n.y+n.height/3&&s<=n.y+2*n.height/3}renderEmbeddables(){const n=this.state.zoom.value,r=this.state.width,i=this.state.height,s=this.scene.getNonDeletedElements().filter(o=>ur(o)&&!!o.validated||Pa(o));return g(ge,{children:s.map(o=>{var f,p,m,v,y,b,_;const{x:a,y:l}=li({sceneX:o.x,sceneY:o.y},this.state);let c;if(Pa(o)){c=null;const E=(((f=o.customData)==null?void 0:f.generationData)??this.magicGenerations.get(o.id))||{status:"error",message:"No generation data",code:"ERR_NO_GENERATION_DATA"};if(E.status==="done"){const w=E.html;c={intrinsicSize:{w:o.width,h:o.height},type:"document",srcdoc:()=>w}}else if(E.status==="pending")c={intrinsicSize:{w:o.width,h:o.height},type:"document",srcdoc:()=>od(`
                    <style>
                      html, body {
                        width: 100%;
                        height: 100%;
                        color: ${this.state.theme==="dark"?"white":"black"};
                      }
                      body {
                        display: flex;
                        align-items: center;
                        justify-content: center;
                        flex-direction: column;
                        gap: 1rem;
                      }

                      .Spinner {
                        display: flex;
                        align-items: center;
                        justify-content: center;
                        margin-left: auto;
                        margin-right: auto;
                      }

                      .Spinner svg {
                        animation: rotate 1.6s linear infinite;
                        transform-origin: center center;
                        width: 40px;
                        height: 40px;
                      }

                      .Spinner circle {
                        stroke: currentColor;
                        animation: dash 1.6s linear 0s infinite;
                        stroke-linecap: round;
                      }

                      @keyframes rotate {
                        100% {
                          transform: rotate(360deg);
                        }
                      }

                      @keyframes dash {
                        0% {
                          stroke-dasharray: 1, 300;
                          stroke-dashoffset: 0;
                        }
                        50% {
                          stroke-dasharray: 150, 300;
                          stroke-dashoffset: -200;
                        }
                        100% {
                          stroke-dasharray: 1, 300;
                          stroke-dashoffset: -280;
                        }
                      }
                    </style>
                    <div class="Spinner">
                      <svg
                        viewBox="0 0 100 100"
                      >
                        <circle
                          cx="50"
                          cy="50"
                          r="46"
                          stroke-width="8"
                          fill="none"
                          stroke-miter-limit="10"
                        />
                      </svg>
                    </div>
                    <div>Generating...</div>
                  `)};else{let w;E.code==="ERR_GENERATION_INTERRUPTED"?w="Generation was interrupted...":w=E.message||"Generation failed",c={intrinsicSize:{w:o.width,h:o.height},type:"document",srcdoc:()=>od(`
                    <style>
                    html, body {
                      height: 100%;
                    }
                      body {
                        display: flex;
                        flex-direction: column;
                        align-items: center;
                        justify-content: center;
                        color: ${Ge.red[3]};
                      }
                      h1, h3 {
                        margin-top: 0;
                        margin-bottom: 0.5rem;
                      }
                    </style>
                    <h1>Error!</h1>
                    <h3>${w}</h3>
                  `)}}}else c=ad(iD(o.link||""));const u=Zy(o,r,i,this.state),d=((p=this.state.activeEmbeddable)==null?void 0:p.element)===o&&((m=this.state.activeEmbeddable)==null?void 0:m.state)==="active",h=((v=this.state.activeEmbeddable)==null?void 0:v.element)===o&&((y=this.state.activeEmbeddable)==null?void 0:y.state)==="hover";return g("div",{className:Ee("excalidraw__embeddable-container",{"is-hovered":h}),style:{transform:u?`translate(${a-this.state.offsetLeft}px, ${l-this.state.offsetTop}px) scale(${n})`:"none",display:u?"block":"none",opacity:o.opacity/100,"--embeddable-radius":`${tp(Math.min(o.width,o.height),o)}px`},children:M("div",{className:"excalidraw__embeddable-container__inner",style:{width:u?`${o.width}px`:0,height:u?`${o.height}px`:0,transform:u?`rotate(${o.angle}rad)`:"none",pointerEvents:d?Vl.enabled:Vl.disabled},children:[h&&g("div",{className:"excalidraw__embeddable-hint",children:I("buttons.embeddableInteractionButton")}),g("div",{className:"excalidraw__embeddable__outer",style:{padding:`${o.strokeWidth}px`},children:(ur(o)?(_=(b=this.props).renderEmbeddable)==null?void 0:_.call(b,o,this.state):null)??g("iframe",{ref:E=>this.cacheEmbeddableRef(o,E),className:"excalidraw__embeddable",srcDoc:(c==null?void 0:c.type)==="document"?c.srcdoc(this.state.theme):void 0,src:(c==null?void 0:c.type)!=="document"?(c==null?void 0:c.link)??"":void 0,scrolling:"no",referrerPolicy:"no-referrer-when-downgrade",title:"Excalidraw Embedded Content",allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture",allowFullScreen:!0,sandbox:"allow-same-origin allow-scripts allow-forms allow-popups allow-popups-to-escape-sandbox allow-presentation allow-downloads"})})]})},o.id)})})}render(){var u,d,h,f,p,m;const n=this.scene.getSelectedElements(this.state),{renderTopRightUI:r,renderCustomStats:i}=this.props,s=this.scene.getVersionNonce(),{canvasElements:o,visibleElements:a}=this.renderer.getRenderableElements({webGLEnabled:this.state.webGLEnabled,versionNonce:s,zoom:this.state.zoom,offsetLeft:this.state.offsetLeft,offsetTop:this.state.offsetTop,scrollX:this.state.scrollX,scrollY:this.state.scrollY,height:this.state.height,width:this.state.width,editingElement:this.state.editingElement,pendingImageElementId:this.state.pendingImageElementId}),l=!(this.state.editingElement&&Je(this.state.editingElement))&&(this.state.selectionElement||this.state.draggingElement||this.state.resizingElement||this.state.activeTool.type==="laser"&&this.state.cursorButton==="down"||this.state.editingElement&&!Se(this.state.editingElement)),c=n[0];return g("div",{className:Ee("excalidraw excalidraw-container",{"excalidraw--view-mode":this.state.viewModeEnabled,"excalidraw--mobile":this.device.editor.isMobile}),style:{"--ui-pointerEvents":l?Vl.disabled:Vl.enabled},ref:this.excalidrawContainerRef,onDrop:this.handleAppOnDrop,tabIndex:0,onKeyDown:this.props.handleKeyboardGlobally?void 0:this.onKeyDown,children:g(p$.Provider,{value:this,children:g(m$.Provider,{value:this.props,children:g(B4.Provider,{value:this.excalidrawContainerValue,children:g(F4.Provider,{value:this.device,children:g(H4.Provider,{value:this.setAppState,children:g($4.Provider,{value:this.state,children:M(U4.Provider,{value:this.scene.getNonDeletedElements(),children:[M(z4.Provider,{value:this.actionManager,children:[g(kme,{canvas:this.canvas,appState:this.state,files:this.files,setAppState:this.setAppState,actionManager:this.actionManager,elements:this.scene.getNonDeletedElements(),onLockToggle:this.toggleLock,onPenModeToggle:this.togglePenMode,onHandToolToggle:this.onHandToolToggle,langCode:km().code,renderTopRightUI:r,renderCustomStats:i,showExitZenModeBtn:typeof((u=this.props)==null?void 0:u.zenModeEnabled)>"u"&&this.state.zenModeEnabled,UIOptions:this.props.UIOptions,onExportImage:this.onExportImage,renderWelcomeScreen:!this.state.isLoading&&this.state.showWelcomeScreen&&this.state.activeTool.type==="selection"&&!this.state.zenModeEnabled&&!this.scene.getElementsIncludingDeleted().length,app:this,isCollaborating:this.props.isCollaborating,openAIKey:this.OPENAI_KEY,isOpenAIKeyPersisted:this.OPENAI_KEY_IS_PERSISTED,onOpenAIAPIKeyChange:this.onOpenAIKeyChange,onMagicSettingsConfirm:this.onMagicSettingsConfirm,children:this.props.children}),g("div",{className:"excalidraw-textEditorContainer"}),g("div",{className:"excalidraw-contextMenuContainer"}),g("div",{className:"excalidraw-eye-dropper-container"}),g(Jme,{manager:this.laserPathManager}),n.length===1&&this.state.showHyperlinkPopup&&g(ine,{element:c,setAppState:this.setAppState,onLinkOpen:this.props.onLinkOpen,setToast:this.setToast},c.id),this.props.aiEnabled!==!1&&n.length===1&&sd(c)&&g(mM,{element:c,children:g(tE,{title:I("labels.convertToCode"),icon:vS,checked:!1,onChange:()=>this.onMagicFrameGenerate(c,"button")})}),n.length===1&&Pa(c)&&((h=(d=c.customData)==null?void 0:d.generationData)==null?void 0:h.status)==="done"&&M(mM,{element:c,children:[g(tE,{title:I("labels.copySource"),icon:Vv,checked:!1,onChange:()=>this.onIframeSrcCopy(c)}),g(tE,{title:"Enter fullscreen",icon:Hte,checked:!1,onChange:()=>{const v=this.getHTMLIFrameElement(c);if(v)try{v.requestFullscreen(),this.setState({activeEmbeddable:{element:c,state:"active"},selectedElementIds:{[c.id]:!0},draggingElement:null,selectionElement:null})}catch(y){console.warn(y),this.setState({errorMessage:"Couldn't enter fullscreen"})}}})]}),this.state.toast!==null&&g(Pme,{message:this.state.toast.message,onClose:()=>this.setToast(null),duration:this.state.toast.duration,closable:this.state.toast.closable}),this.state.contextMenu&&g($he,{items:this.state.contextMenu.items,top:this.state.contextMenu.top,left:this.state.contextMenu.left,actionManager:this.actionManager,onClose:v=>{this.setState({contextMenu:null},()=>{this.focusContainer(),v==null||v()})}}),this.state.webGLEnabled?g(x1e,{canvas:this.canvas,pixi:this.pixi,elements:o,visibleElements:a,versionNonce:s,selectionNonce:(f=this.state.selectionElement)==null?void 0:f.versionNonce,scale:window.devicePixelRatio,appState:this.state,renderConfig:{imageCache:this.imageCache,isExporting:!1,renderGrid:!0,webGLEnabled:this.state.webGLEnabled,canvasBackgroundColor:this.state.viewBackgroundColor}}):g(qme,{canvas:this.canvas,rc:this.rc,elements:o,visibleElements:a,versionNonce:s,selectionNonce:(p=this.state.selectionElement)==null?void 0:p.versionNonce,scale:window.devicePixelRatio,appState:this.state,renderConfig:{imageCache:this.imageCache,isExporting:!1,renderGrid:!0,webGLEnabled:this.state.webGLEnabled,canvasBackgroundColor:this.state.viewBackgroundColor}}),g(Yme,{containerRef:this.excalidrawContainerRef,canvas:this.interactiveCanvas,elements:o,visibleElements:a,selectedElements:n,versionNonce:s,selectionNonce:(m=this.state.selectionElement)==null?void 0:m.versionNonce,scale:window.devicePixelRatio,appState:this.state,renderInteractiveSceneCallback:this.renderInteractiveSceneCallback,handleCanvasRef:this.handleInteractiveCanvasRef,onContextMenu:this.handleCanvasContextMenu,onPointerMove:this.handleCanvasPointerMove,onPointerUp:this.handleCanvasPointerUp,onPointerCancel:this.removePointer,onTouchMove:this.handleTouchMove,onPointerDown:this.handleCanvasPointerDown,onDoubleClick:this.handleCanvasDoubleClick}),this.state.userToFollow&&g(f1e,{width:this.state.width,height:this.state.height,userToFollow:this.state.userToFollow,onDisconnect:this.maybeUnfollowRemoteUser}),this.renderFrameNames()]}),this.renderEmbeddables()]})})})})})})})})}getTextFromElements(n){return n.reduce((i,s)=>(Se(s)&&i.push(s.text),i),[]).join(`

`)}async onMagicFrameGenerate(n,r){var h;if(!this.OPENAI_KEY){this.setState({openDialog:{name:"settings",tab:"diagram-to-code",source:"generation"}}),at("ai","generate (missing key)","d2c");return}const i=a4({elements:this.scene.getNonDeletedElements(),bounds:n,type:"overlap"}).filter(f=>!sd(f));if(!i.length){r==="button"?(this.setState({errorMessage:"Cannot generate from an empty frame"}),at("ai","generate (no-children)","d2c")):this.setActiveTool({type:"magicframe"});return}const s=this.insertIframeElement({sceneX:n.x+n.width+30,sceneY:n.y,width:n.width,height:n.height});if(!s)return;this.updateMagicGeneration({frameElement:s,data:{status:"pending"}}),this.setState({selectedElementIds:{[s.id]:!0}});const o=await nue({elements:this.scene.getNonDeletedElements(),appState:{...this.state,exportBackground:!0,viewBackgroundColor:this.state.viewBackgroundColor},exportingFrame:n,files:this.files}),a=await E_(o),l=this.getTextFromElements(i);at("ai","generate (start)","d2c");const c=await d1e({image:a,apiKey:this.OPENAI_KEY,text:l,theme:this.state.theme});if(!c.ok){at("ai","generate (failed)","d2c"),console.error(c.error),this.updateMagicGeneration({frameElement:s,data:{status:"error",code:"ERR_OAI",message:((h=c.error)==null?void 0:h.message)||"Unknown error during generation"}});return}if(at("ai","generate (success)","d2c"),c.choices[0].message.content==null){this.updateMagicGeneration({frameElement:s,data:{status:"error",code:"ERR_OAI",message:"Nothing genereated :("}});return}const u=c.choices[0].message.content,d=u.slice(u.indexOf("<!DOCTYPE html>"),u.indexOf("</html>")+7);this.updateMagicGeneration({frameElement:s,data:{status:"done",html:d}})}onIframeSrcCopy(n){var r,i;((i=(r=n.customData)==null?void 0:r.generationData)==null?void 0:i.status)==="done"&&(fu(n.customData.generationData.html),this.setToast({message:"copied to clipboard",closable:!1,duration:1500}))}async componentDidMount(){var r;this.unmounted=!1,this.excalidrawContainerValue.container=this.excalidrawContainerRef.current,this.scene.addCallback(this.onSceneUpdated),this.addEventListeners(),this.props.autoFocus&&this.excalidrawContainerRef.current&&this.focusContainer(),this.refreshViewportBreakpoints(),this.refreshEditorBreakpoints(),vM&&this.excalidrawContainerRef.current&&(this.resizeObserver=new ResizeObserver(()=>{this.refreshEditorBreakpoints(),this.updateDOMRect()}),(r=this.resizeObserver)==null||r.observe(this.excalidrawContainerRef.current)),new URLSearchParams(window.location.search.slice(1)).has("web-share-target")?this.restoreFileFromShare():this.updateDOMRect(this.initializeScene),SV()&&!xoe()&&this.setState({errorMessage:g(Wme,{})})}componentWillUnmount(){var n;this.renderer.destroy(),this.scene=new bt,this.renderer=new cM(this.scene),this.files={},this.imageCache.clear(),(n=this.resizeObserver)==null||n.disconnect(),this.unmounted=!0,this.removeEventListeners(),this.scene.destroy(),this.library.destroy(),this.laserPathManager.destroy(),this.onChangeEmitter.destroy(),mt.destroy(),ts.destroy(),clearTimeout(va),wn.clearCache(),ri.clearCache(),va=0}removeEventListeners(){var n,r,i,s;document.removeEventListener(ee.POINTER_UP,this.removePointer),document.removeEventListener(ee.COPY,this.onCopy),document.removeEventListener(ee.PASTE,this.pasteFromClipboard),document.removeEventListener(ee.CUT,this.onCut),(n=this.excalidrawContainerRef.current)==null||n.removeEventListener(ee.WHEEL,this.onWheel),(r=this.nearestScrollableContainer)==null||r.removeEventListener(ee.SCROLL,this.onScroll),document.removeEventListener(ee.KEYDOWN,this.onKeyDown,!1),document.removeEventListener(ee.MOUSE_MOVE,this.updateCurrentCursorPosition,!1),document.removeEventListener(ee.KEYUP,this.onKeyUp),window.removeEventListener(ee.RESIZE,this.onResize,!1),window.removeEventListener(ee.UNLOAD,this.onUnload,!1),window.removeEventListener(ee.BLUR,this.onBlur,!1),(i=this.excalidrawContainerRef.current)==null||i.removeEventListener(ee.DRAG_OVER,this.disableEvent,!1),(s=this.excalidrawContainerRef.current)==null||s.removeEventListener(ee.DROP,this.disableEvent,!1),document.removeEventListener(ee.GESTURE_START,this.onGestureStart,!1),document.removeEventListener(ee.GESTURE_CHANGE,this.onGestureChange,!1),document.removeEventListener(ee.GESTURE_END,this.onGestureEnd,!1),document.removeEventListener(ee.FULLSCREENCHANGE,this.onFullscreenChange),window.removeEventListener(ee.MESSAGE,this.onWindowMessage,!1)}addEventListeners(){var n,r,i,s,o;this.removeEventListeners(),window.addEventListener(ee.MESSAGE,this.onWindowMessage,!1),document.addEventListener(ee.POINTER_UP,this.removePointer),document.addEventListener(ee.COPY,this.onCopy),(n=this.excalidrawContainerRef.current)==null||n.addEventListener(ee.WHEEL,this.onWheel,{passive:!1}),this.props.handleKeyboardGlobally&&document.addEventListener(ee.KEYDOWN,this.onKeyDown,!1),document.addEventListener(ee.KEYUP,this.onKeyUp,{passive:!0}),document.addEventListener(ee.MOUSE_MOVE,this.updateCurrentCursorPosition),(i=(r=document.fonts)==null?void 0:r.addEventListener)==null||i.call(r,"loadingdone",a=>{const l=a.fontfaces;this.fonts.onFontsLoaded(l)}),document.addEventListener(ee.GESTURE_START,this.onGestureStart,!1),document.addEventListener(ee.GESTURE_CHANGE,this.onGestureChange,!1),document.addEventListener(ee.GESTURE_END,this.onGestureEnd,!1),!this.state.viewModeEnabled&&(document.addEventListener(ee.FULLSCREENCHANGE,this.onFullscreenChange),document.addEventListener(ee.PASTE,this.pasteFromClipboard),document.addEventListener(ee.CUT,this.onCut),this.props.detectScroll&&(this.nearestScrollableContainer=mW(this.excalidrawContainerRef.current),this.nearestScrollableContainer.addEventListener(ee.SCROLL,this.onScroll)),window.addEventListener(ee.RESIZE,this.onResize,!1),window.addEventListener(ee.UNLOAD,this.onUnload,!1),window.addEventListener(ee.BLUR,this.onBlur,!1),(s=this.excalidrawContainerRef.current)==null||s.addEventListener(ee.DRAG_OVER,this.disableEvent,!1),(o=this.excalidrawContainerRef.current)==null||o.addEventListener(ee.DROP,this.disableEvent,!1))}componentDidUpdate(n,r){var o,a,l,c,u,d;this.updateEmbeddables(),!this.state.showWelcomeScreen&&!this.scene.getElementsIncludingDeleted().length&&this.setState({showWelcomeScreen:!0}),n.UIOptions.dockedSidebarBreakpoint!==this.props.UIOptions.dockedSidebarBreakpoint&&this.refreshEditorBreakpoints(),r.userToFollow&&!this.state.collaborators.has(r.userToFollow.socketId)&&this.maybeUnfollowRemoteUser(),(r.zoom.value!==this.state.zoom.value||r.scrollX!==this.state.scrollX||r.scrollY!==this.state.scrollY)&&((a=(o=this.props)==null?void 0:o.onScrollChange)==null||a.call(o,this.state.scrollX,this.state.scrollY,this.state.zoom),this.onScrollChangeEmitter.trigger(this.state.scrollX,this.state.scrollY,this.state.zoom)),r.userToFollow!==this.state.userToFollow&&(r.userToFollow&&this.onUserFollowEmitter.trigger({userToFollow:r.userToFollow,action:"UNFOLLOW"}),this.state.userToFollow&&this.onUserFollowEmitter.trigger({userToFollow:this.state.userToFollow,action:"FOLLOW"})),Object.keys(this.state.selectedElementIds).length&&pc(this.state)&&this.setState({activeTool:kn(this.state,{type:"selection"})}),this.state.activeTool.type==="eraser"&&r.theme!==this.state.theme&&$O(this.interactiveCanvas,this.state.theme),r.activeTool.type==="selection"&&this.state.activeTool.type!=="selection"&&this.state.showHyperlinkPopup&&this.setState({showHyperlinkPopup:!1}),n.langCode!==this.props.langCode&&this.updateLanguage(),n.viewModeEnabled!==this.props.viewModeEnabled&&this.setState({viewModeEnabled:!!this.props.viewModeEnabled}),r.viewModeEnabled!==this.state.viewModeEnabled&&(this.addEventListeners(),this.deselectElements()),n.zenModeEnabled!==this.props.zenModeEnabled&&this.setState({zenModeEnabled:!!this.props.zenModeEnabled}),n.theme!==this.props.theme&&this.props.theme&&this.setState({theme:this.props.theme}),n.gridModeEnabled!==this.props.gridModeEnabled&&this.setState({gridSize:this.props.gridModeEnabled?vd:null}),this.props.name&&n.name!==this.props.name&&this.setState({name:this.props.name}),(l=this.excalidrawContainerRef.current)==null||l.classList.toggle("theme--dark",this.state.theme==="dark"),this.state.editingLinearElement&&!this.state.selectedElementIds[this.state.editingLinearElement.elementId]&&setTimeout(()=>{this.state.editingLinearElement&&this.actionManager.executeAction(Ds)}),(c=this.state.editingElement)!=null&&c.isDeleted&&this.setState({editingElement:null}),this.state.selectedLinearElement&&!this.state.selectedElementIds[this.state.selectedLinearElement.elementId]&&this.setState({selectedLinearElement:null});const{multiElement:s}=r;r.activeTool!==this.state.activeTool&&s!=null&&yc(this.state)&&pr(s,!1)&&Ax(s,this.state,this.scene,$a(Ae.getPointAtIndexGlobalCoordinates(s,-1))),this.history.record(this.state,this.scene.getElementsIncludingDeleted()),this.state.isLoading||((d=(u=this.props).onChange)==null||d.call(u,this.scene.getElementsIncludingDeleted(),this.state,this.files),this.onChangeEmitter.trigger(this.scene.getElementsIncludingDeleted(),this.state,this.files))}static resetTapTwice(){af=!1}async addElementsFromMixedContentPaste(n,{isPlainPaste:r,sceneX:i,sceneY:s}){if(!r&&n.some(o=>o.type==="imageUrl")&&this.isToolSupported("image")){const o=n.filter(h=>h.type==="imageUrl").map(h=>h.value),a=await Promise.all(o.map(async h=>{try{return{file:await gae(h)}}catch(f){return{errorMessage:f.message}}}));let l=s,c=!1;const u={};for(const h of a)if(h.file){const f=this.createImageElement({sceneX:i,sceneY:l}),p=await this.insertImageElement(f,h.file);p&&(c||(c=!0,l-=p.height/2),ae(p,{y:l},!1),l=f.y+f.height+25,u[f.id]=!0)}this.setState({selectedElementIds:gt(u,this.state)});const d=a.find(h=>!!h.errorMessage);d&&d.errorMessage&&this.setState({errorMessage:d.errorMessage})}else{const o=n.filter(a=>a.type==="text");o.length&&this.addTextFromPaste(o.map(a=>a.value).join(`

`),r)}}addTextFromPaste(n,r=!1){const{x:i,y:s}=Ft({clientX:this.lastViewportPosition.x,clientY:this.lastViewportPosition.y},this.state),o={x:i,y:s,strokeColor:this.state.currentItemStrokeColor,backgroundColor:this.state.currentItemBackgroundColor,fillStyle:this.state.currentItemFillStyle,strokeWidth:this.state.currentItemStrokeWidth,strokeStyle:this.state.currentItemStrokeStyle,roundness:null,roughness:this.state.currentItemRoughness,opacity:this.state.currentItemOpacity,text:n,fontSize:this.state.currentItemFontSize,fontFamily:this.state.currentItemFontFamily,textAlign:this.state.currentItemTextAlign,verticalAlign:j0,locked:!1},a=10;let l=s;const c=r?[n]:n.split(`
`),u=c.reduce((h,f,p)=>{var y;const m=f.trim(),v=Kc(o.fontFamily);if(m.length){const b=this.getTopLayerFrameAtSceneCoords({x:i,y:l}),_=Ni({...o,x:i,y:l,text:m,lineHeight:v,frameId:b?b.id:null});h.push(_),l+=_.height+a}else((y=c[p-1])==null?void 0:y.trim())&&(l+=jm(o.fontSize,v)+a);return h},[]);if(u.length===0)return;const d=u[0].frameId;d?this.scene.insertElementsAtIndex(u,this.scene.getElementIndex(d)):this.scene.replaceAllElements([...this.scene.getElementsIncludingDeleted(),...u]),this.setState({selectedElementIds:gt(Object.fromEntries(u.map(h=>[h.id,!0])),this.state)}),!r&&u.length>1&&_M===!1&&!this.device.editor.isMobile&&(this.setToast({message:I("toast.pasteAsSingleElement",{shortcut:re("CtrlOrCmd+Shift+V")}),duration:5e3}),_M=!0),this.history.resumeRecording()}handleTextWysiwyg(n,{isExistingElement:r=!1}){const i=(s,o,a)=>{this.scene.replaceAllElements([...this.scene.getElementsIncludingDeleted().map(l=>l.id===n.id&&Se(l)?NQ(l,{text:s,isDeleted:a,originalText:o}):l)])};moe({id:n.id,canvas:this.canvas,getViewportCoords:(s,o)=>{const{x:a,y:l}=li({sceneX:s,sceneY:o},this.state);return[a-this.state.offsetLeft,l-this.state.offsetTop]},onChange:Nt(s=>{i(s,s,!1),u3(n)&&wl(n)}),onSubmit:Nt(({text:s,viaKeyboard:o,originalText:a})=>{const l=!s.trim();if(i(s,a,l),!l&&o){const c=n.containerId?n.containerId:n.id;this.setState(u=>({selectedElementIds:gt({...u.selectedElementIds,[c]:!0},u)}))}l&&kS(this.scene.getNonDeletedElements(),[n]),(!l||r)&&this.history.resumeRecording(),this.setState({draggingElement:null,editingElement:null}),this.state.activeTool.locked&&zs(this.interactiveCanvas,this.state),this.focusContainer()}),element:n,excalidrawContainer:this.excalidrawContainerRef.current,app:this}),this.deselectElements(),i(n.text,n.originalText,!1)}deselectElements(){this.setState({selectedElementIds:gt({},this.state),selectedGroupIds:{},editingGroupId:null,activeEmbeddable:null})}getTextElementAtPosition(n,r){const i=this.getElementAtPosition(n,r,{includeBoundTextElement:!0});return i&&Se(i)&&!i.isDeleted?i:null}getElementAtPosition(n,r,i){const s=this.getElementsAtPosition(n,r,i==null?void 0:i.includeBoundTextElement,i==null?void 0:i.includeLockedElements);if(s.length>1){if(i!=null&&i.preferSelected){for(let a=s.length-1;a>-1;a--)if(this.state.selectedElementIds[s[a].id])return s[a]}const o=s[s.length-1];return c_(o,this.state,this.frameNameBoundsCache,n,r)?s[s.length-2]:o}return s.length===1?s[0]:null}getElementsAtPosition(n,r,i=!1,s=!1){const o=i&&s?this.scene.getNonDeletedElements():this.scene.getNonDeletedElements().filter(a=>(s||!a.locked)&&(i||!(Se(a)&&a.containerId)));return Vse(o,a=>Ey(a,this.state,this.frameNameBoundsCache,n,r)).filter(a=>{const l=Bi(a);return l&&this.state.frameRendering.enabled&&this.state.frameRendering.clip?Bk({x:n,y:r},l):!0})}handleHoverSelectedLinearElement(n,r,i){const s=Ae.getElement(n.elementId),o=tt(s);if(s)if(this.state.selectedLinearElement){let a=-1,l=null;qp(s,this.state,this.frameNameBoundsCache,[r,i])?(a=Ae.getPointIndexUnderCursor(s,this.state.zoom,r,i),l=Ae.getSegmentMidpointHitCoords(n,{x:r,y:i},this.state),a>=0||l?Et(this.interactiveCanvas,vt.POINTER):Et(this.interactiveCanvas,vt.MOVE)):TS([s],this.state)&&c_(s,this.state,this.frameNameBoundsCache,r,i)?Et(this.interactiveCanvas,vt.MOVE):o&&Ey(o,this.state,this.frameNameBoundsCache,r,i)&&Et(this.interactiveCanvas,vt.MOVE),this.state.selectedLinearElement.hoverPointIndex!==a&&this.setState({selectedLinearElement:{...this.state.selectedLinearElement,hoverPointIndex:a}}),Ae.arePointsEqual(this.state.selectedLinearElement.segmentMidPointHoveredCoords,l)||this.setState({selectedLinearElement:{...this.state.selectedLinearElement,segmentMidPointHoveredCoords:l}})}else Et(this.interactiveCanvas,vt.AUTO)}maybeCleanupAfterMissingPointerUp(n){ba!==null&&ba(n)}updateGestureOnPointerDown(n){ct.pointers.set(n.pointerId,{x:n.clientX,y:n.clientY}),ct.pointers.size===2&&(ct.lastCenter=N8(ct.pointers),ct.initialScale=this.state.zoom.value,ct.initialDistance=F8(Array.from(ct.pointers.values())))}initialPointerDownState(n){const r=Ft(n,this.state),i=this.scene.getSelectedElements(this.state),[s,o,a,l]=Ut(i);return{origin:r,withCmdOrCtrl:n[z.CTRL_OR_CMD],originInGrid:$a(Kn(r.x,r.y,n[z.CTRL_OR_CMD]?null:this.state.gridSize)),scrollbars:w8(sE,n.clientX-this.state.offsetLeft,n.clientY-this.state.offsetTop),lastCoords:{...r},originalElements:this.scene.getNonDeletedElements().reduce((c,u)=>(c.set(u.id,Hm(u)),c),new Map),resize:{handleType:!1,isResizing:!1,offset:{x:0,y:0},arrowDirection:"origin",center:{x:(a+s)/2,y:(l+o)/2}},hit:{element:null,allHitElements:[],wasAddedToSelection:!1,hasBeenDuplicated:!1,hasHitCommonBoundingBoxOfSelectedElements:this.isHittingCommonBoundingBoxOfSelectedElements(r,i)},drag:{hasOccurred:!1,offset:null},eventListeners:{onMove:null,onUp:null,onKeyUp:null,onKeyDown:null},boxSelection:{hasOccurred:!1},elementIdsToErase:{}}}handleDraggingScrollBar(n,r){if(!(r.scrollbars.isOverEither&&!this.state.multiElement))return!1;iE=!0,r.lastCoords.x=n.clientX,r.lastCoords.y=n.clientY;const i=gb(o=>{o.target instanceof HTMLElement&&this.handlePointerMoveOverScrollbars(o,r)}),s=Nt(()=>{iE=!1,zs(this.interactiveCanvas,this.state),ba=null,this.setState({cursorButton:"up"}),this.savePointer(n.clientX,n.clientY,"up"),window.removeEventListener(ee.POINTER_MOVE,i),window.removeEventListener(ee.POINTER_UP,s),i.flush()});return ba=s,window.addEventListener(ee.POINTER_MOVE,i),window.addEventListener(ee.POINTER_UP,s),!0}isASelectedElement(n){return n!=null&&this.state.selectedElementIds[n.id]}isHittingCommonBoundingBoxOfSelectedElements(n,r){if(r.length<2)return!1;const i=10/this.state.zoom.value,[s,o,a,l]=Ut(r);return n.x>s-i&&n.x<a+i&&n.y>o-i&&n.y<l+i}getCurrentItemRoundness(n){return this.state.currentItemRoundness==="round"?{type:dh(n)?jn.ADAPTIVE_RADIUS:jn.PROPORTIONAL_RADIUS}:null}maybeCacheReferenceSnapPoints(n,r,i=!1){Tl({event:n,appState:this.state,selectedElements:r})&&(i||!ts.getReferenceSnapPoints())&&ts.setReferenceSnapPoints(Fme(this.scene.getNonDeletedElements(),r,this.state))}maybeCacheVisibleGaps(n,r,i=!1){Tl({event:n,appState:this.state,selectedElements:r})&&(i||!ts.getVisibleGaps())&&ts.setVisibleGaps(Nme(this.scene.getNonDeletedElements(),r,this.state))}onKeyDownFromPointerDownHandler(n){return Nt(r=>{this.maybeHandleResize(n,r)||this.maybeDragNewGenericElement(n,r)})}onKeyUpFromPointerDownHandler(n){return Nt(r=>{r.key===z.ALT&&r.preventDefault(),!this.maybeHandleResize(n,r)&&this.maybeDragNewGenericElement(n,r)})}onPointerMoveFromPointerDownHandler(n){return gb(r=>{var d,h;if(n.drag.offset===null&&(n.drag.offset=$a(Nde(this.scene.getSelectedElements(this.state),n.origin.x,n.origin.y))),!(r.target instanceof HTMLElement)||this.handlePointerMoveOverScrollbars(r,n))return;const s=Ft(r,this.state);if(pc(this.state)){this.handleEraser(r,n,s);return}this.state.activeTool.type==="laser"&&this.laserPathManager.addPointToPath(s.x,s.y);const[o,a]=Kn(s.x,s.y,r[z.CTRL_OR_CMD]?null:this.state.gridSize);if(!n.drag.hasOccurred&&(this.state.activeTool.type==="arrow"||this.state.activeTool.type==="line")&&vn(s.x,s.y,n.origin.x,n.origin.y)<Gl)return;if(n.resize.isResizing&&(n.lastCoords.x=s.x,n.lastCoords.y=s.y,this.maybeHandleResize(n,r)))return!0;if(this.state.selectedLinearElement){const f=this.state.editingLinearElement||this.state.selectedLinearElement;if(Ae.shouldAddMidpoint(this.state.selectedLinearElement,s,this.state)){const m=Ae.addMidpoint(this.state.selectedLinearElement,s,this.state,!r[z.CTRL_OR_CMD]);if(!m)return;hi.flushSync(()=>{this.state.selectedLinearElement&&this.setState({selectedLinearElement:{...this.state.selectedLinearElement,pointerDownState:m.pointerDownState,selectedPointsIndices:m.selectedPointsIndices}}),this.state.editingLinearElement&&this.setState({editingLinearElement:{...this.state.editingLinearElement,pointerDownState:m.pointerDownState,selectedPointsIndices:m.selectedPointsIndices}})});return}else if(f.pointerDownState.segmentMidpoint.value!==null&&!f.pointerDownState.segmentMidpoint.added)return;if(Ae.handlePointDragging(r,this.state,s.x,s.y,(m,v)=>{this.maybeSuggestBindingsForLinearElementAtCoords(m,v)},f)){n.lastCoords.x=s.x,n.lastCoords.y=s.y,n.drag.hasOccurred=!0,this.state.editingLinearElement&&!this.state.editingLinearElement.isDragging&&this.setState({editingLinearElement:{...this.state.editingLinearElement,isDragging:!0}}),this.state.selectedLinearElement.isDragging||this.setState({selectedLinearElement:{...this.state.selectedLinearElement,isDragging:!0}});return}}const l=n.hit.allHitElements.some(f=>this.isASelectedElement(f)),c=this.state.editingLinearElement&&r.shiftKey&&this.state.editingLinearElement.elementId===((d=n.hit.element)==null?void 0:d.id);if((l||n.hit.hasHitCommonBoundingBoxOfSelectedElements)&&!c){const f=this.scene.getSelectedElements(this.state);if(f.every(v=>v.locked))return;const p=f.find(v=>qe(v)),m=this.getTopLayerFrameAtSceneCoords(s);if(this.setState({frameToHighlight:m&&!p?m:null}),n.drag.hasOccurred=!0,this.setState({selectedElementsAreBeingDragged:!0}),f.length>0&&!n.withCmdOrCtrl&&!this.state.editingElement&&((h=this.state.activeEmbeddable)==null?void 0:h.state)!=="active"){const v={x:s.x-n.origin.x,y:s.y-n.origin.y},y=[...n.originalElements.values()],b=r.shiftKey;if(b){const w=Math.abs(v.x),x=Math.abs(v.y),T=b&&w<x,C=b&&w>x;T&&(v.x=0),C&&(v.y=0)}this.maybeCacheVisibleGaps(r,f),this.maybeCacheReferenceSnapPoints(r,f);const{snapOffset:_,snapLines:E}=Bme(Rt(y,this.state),v,this.state,r);if(this.setState({snapLines:E}),!this.state.editingFrame&&Ode(n,f,v,this.state,this.scene,_,r[z.CTRL_OR_CMD]?null:this.state.gridSize),this.maybeSuggestBindingForAll(f),r.altKey&&!n.hit.hasBeenDuplicated){n.hit.hasBeenDuplicated=!0;const w=[],x=[],T=new Map,C=new Map,k=n.hit.element,L=new Set(this.scene.getSelectedElements({selectedElementIds:this.state.selectedElementIds,includeBoundTextElement:!0,includeElementsInFrames:!0}).map(R=>R.id)),F=this.scene.getElementsIncludingDeleted();for(const R of F)if(L.has(R.id)||R.id===(k==null?void 0:k.id)&&n.hit.wasAddedToSelection){const H=VO(this.state.editingGroupId,T,R),W=n.originalElements.get(R.id);ae(H,{x:W.x,y:W.y}),n.originalElements.set(H.id,H),w.push(H),x.push(R),C.set(R.id,H.id)}else w.push(R);const N=[...w,...x];gN(w,x,C),CD(N,x,C,"duplicatesServeAsOld"),rB(N,x,C),this.scene.replaceAllElements(N),this.maybeCacheVisibleGaps(r,f,!0),this.maybeCacheReferenceSnapPoints(r,f,!0)}return}}const u=this.state.draggingElement;if(u){if(u.type==="freedraw"){const f=u.points,p=s.x-u.x,m=s.y-u.y,v=f.length>0&&f[f.length-1];if(!(v&&v[0]===p&&v[1]===m)){const b=u.simulatePressure?u.pressures:[...u.pressures,r.pressure];ae(u,{points:[...f,[p,m]],pressures:b})}}else if(Je(u)){n.drag.hasOccurred=!0,this.setState({selectedElementsAreBeingDragged:!0});const f=u.points;let p=o-u.x,m=a-u.y;Yf(r)&&f.length===2&&({width:p,height:m}=l3(u.x,u.y,s.x,s.y)),f.length===1?ae(u,{points:[...f,[p,m]]}):f.length===2&&ae(u,{points:[...f.slice(0,-1),[p,m]]}),pr(u,!1)&&this.maybeSuggestBindingsForLinearElementAtCoords(u,[s],this.state.startBoundElement)}else n.lastCoords.x=s.x,n.lastCoords.y=s.y,this.maybeDragNewGenericElement(n,r);if(this.state.activeTool.type==="selection"){n.boxSelection.hasOccurred=!0;const f=this.scene.getNonDeletedElements();if(this.state.editingLinearElement)Ae.handleBoxSelection(r,this.state,this.setState.bind(this));else{let p=!0;!r.shiftKey&&wn(f,this.state)&&(n.withCmdOrCtrl&&n.hit.element?this.setState(v=>ri({...v,selectedElementIds:{[n.hit.element.id]:!0}},this.scene.getNonDeletedElements(),v,this)):p=!1);const m=u4(f,u);this.setState(v=>{const y={...p&&v.selectedElementIds,...m.reduce((b,_)=>(b[_.id]=!0,b),{})};return n.hit.element&&(m.length?delete y[n.hit.element.id]:y[n.hit.element.id]=!0),v=p?v:{...v,selectedGroupIds:{},editingGroupId:null},{...ri({editingGroupId:v.editingGroupId,selectedElementIds:y},this.scene.getNonDeletedElements(),v,this),selectedLinearElement:m.length===1&&Je(m[0])?new Ae(m[0],this.scene):null,showHyperlinkPopup:m.length===1&&(m[0].link||ur(m[0]))?"info":!1}})}}}})}handlePointerMoveOverScrollbars(n,r){if(r.scrollbars.isOverHorizontal){const i=n.clientX,s=i-r.lastCoords.x;return this.translateCanvas({scrollX:this.state.scrollX-s/this.state.zoom.value}),r.lastCoords.x=i,!0}if(r.scrollbars.isOverVertical){const i=n.clientY,s=i-r.lastCoords.y;return this.translateCanvas({scrollY:this.state.scrollY-s/this.state.zoom.value}),r.lastCoords.y=i,!0}return!1}onPointerUpFromPointerDownHandler(n){return Nt(r=>{var d,h,f,p,m,v;n.eventListeners.onMove&&n.eventListeners.onMove.flush();const{draggingElement:i,resizingElement:s,multiElement:o,activeTool:a,isResizing:l,isRotating:c}=this.state;if(this.setState(y=>({isResizing:!1,isRotating:!1,resizingElement:null,selectionElement:null,frameToHighlight:null,elementsToHighlight:null,cursorButton:"up",editingElement:o||Se(this.state.editingElement)?this.state.editingElement:null,snapLines:yb(y.snapLines,[]),originSnapOffset:null})),ts.setReferenceSnapPoints(null),ts.setVisibleGaps(null),this.savePointer(r.clientX,r.clientY,"up"),this.setState({selectedElementsAreBeingDragged:!1}),this.state.editingLinearElement)if(!n.boxSelection.hasOccurred&&((h=(d=n.hit)==null?void 0:d.element)==null?void 0:h.id)!==this.state.editingLinearElement.elementId)this.actionManager.executeAction(Ds);else{const y=Ae.handlePointerUp(r,this.state.editingLinearElement,this.state);y!==this.state.editingLinearElement&&this.setState({editingLinearElement:y,suggestedBindings:[]})}else if(this.state.selectedLinearElement)if(((p=(f=n.hit)==null?void 0:f.element)==null?void 0:p.id)!==this.state.selectedLinearElement.elementId)this.scene.getSelectedElements(this.state).length>1&&this.setState({selectedLinearElement:null});else{const y=Ae.handlePointerUp(r,this.state.selectedLinearElement,this.state),{startBindingElement:b,endBindingElement:_}=y,E=this.scene.getElement(y.elementId);pr(E)&&fh(E,b,_),y!==this.state.selectedLinearElement&&this.setState({selectedLinearElement:{...y,selectedPointsIndices:null},suggestedBindings:[]})}if(ba=null,window.removeEventListener(ee.POINTER_MOVE,n.eventListeners.onMove),window.removeEventListener(ee.POINTER_UP,n.eventListeners.onUp),window.removeEventListener(ee.KEYDOWN,n.eventListeners.onKeyDown),window.removeEventListener(ee.KEYUP,n.eventListeners.onKeyUp),this.state.pendingImageElementId&&this.setState({pendingImageElementId:null}),this.onPointerUpEmitter.trigger(this.state.activeTool,n,r),(i==null?void 0:i.type)==="freedraw"){const y=Ft(r,this.state),b=i.points;let _=y.x-i.x,E=y.y-i.y;_===b[0][0]&&E===b[0][1]&&(E+=1e-4,_+=1e-4);const w=i.simulatePressure?[]:[...i.pressures,r.pressure];ae(i,{points:[...b,[_,E]],pressures:w,lastCommittedPoint:[_,E]}),this.actionManager.executeAction(Ds);return}if(Wo(i)){const y=i;try{this.initializeImageDimensions(y),this.setState({selectedElementIds:gt({[y.id]:!0},this.state)},()=>{this.actionManager.executeAction(Ds)})}catch(b){console.error(b),this.scene.replaceAllElements(this.scene.getElementsIncludingDeleted().filter(_=>_.id!==y.id)),this.actionManager.executeAction(Ds)}return}if(Je(i)){i.points.length>1&&this.history.resumeRecording();const y=Ft(r,this.state);!n.drag.hasOccurred&&i&&!o?(ae(i,{points:[...i.points,[y.x-i.x,y.y-i.y]]}),this.setState({multiElement:i,editingElement:this.state.draggingElement})):n.drag.hasOccurred&&!o&&(yc(this.state)&&pr(i,!1)&&Ax(i,this.state,this.scene,y),this.setState({suggestedBindings:[],startBoundElement:null}),a.locked?this.setState(b=>({draggingElement:null})):(qi(this.interactiveCanvas),this.setState(b=>({draggingElement:null,activeTool:kn(this.state,{type:"selection"}),selectedElementIds:gt({...b.selectedElementIds,[i.id]:!0},b),selectedLinearElement:new Ae(i,this.scene)}))));return}if(a.type!=="selection"&&i&&su(i)){this.scene.replaceAllElements(this.scene.getElementsIncludingDeleted().filter(y=>y.id!==i.id)),this.setState({draggingElement:null});return}if(i){if(n.drag.hasOccurred){const y=Ft(r,this.state);if(this.state.selectedLinearElement&&this.state.selectedLinearElement.isDragging){const b=this.scene.getElement(this.state.selectedLinearElement.elementId);if(b!=null&&b.frameId){const _=Bi(b);_&&b&&(qd(b,_)||(ae(b,{groupIds:[]}),this.scene.replaceAllElements(_2(this.scene.getElementsIncludingDeleted(),[b],this.state))))}}else{const b=this.getTopLayerFrameAtSceneCoords(y),_=this.scene.getSelectedElements(this.state);let E=this.scene.getElementsIncludingDeleted();const w=x=>{if(x.length>0){for(const T of x){const C=T.groupIds.indexOf(this.state.editingGroupId);ae(T,{groupIds:T.groupIds.slice(0,C)},!1)}E.forEach(T=>{T.groupIds.length&&Gn(E,T.groupIds[T.groupIds.length-1]).length<2&&ae(T,{groupIds:[]},!1)}),this.setState({editingGroupId:null})}};if(b&&!this.state.selectedElementIds[b.id]){const x=_.filter(T=>T.frameId!==b.id&&iu(T,E,this.state));this.state.editingGroupId&&w(x),E=n3(E,x,b)}else if(!b&&this.state.editingGroupId){const x=_.filter(T=>T.frameId&&!iu(T,E,this.state));w(x)}E=Jd(E,this.state,this),this.scene.replaceAllElements(E)}}if(qe(i)){const y=iue(this.scene.getElementsIncludingDeleted(),i);this.scene.replaceAllElements(n3(this.scene.getElementsIncludingDeleted(),y,i))}ae(i,xB(i))}if(s&&this.history.resumeRecording(),s&&su(s)&&this.scene.replaceAllElements(this.scene.getElementsIncludingDeleted().filter(y=>y.id!==s.id)),n.resize.isResizing){let y=Jd(this.scene.getElementsIncludingDeleted(),this.state,this);const b=this.scene.getSelectedElements(this.state).filter(_=>qe(_));for(const _ of b)y=uB(y,m0(this.scene.getElementsIncludingDeleted(),_,this.state),_,this.state);this.scene.replaceAllElements(y)}const u=n.hit.element;if(((m=this.state.selectedLinearElement)==null?void 0:m.elementId)!==(u==null?void 0:u.id)&&Je(u)&&this.scene.getSelectedElements(this.state).length===1&&this.setState({selectedLinearElement:new Ae(u,this.scene)}),pc(this.state)){if(vn(this.lastPointerDownEvent.clientX,this.lastPointerDownEvent.clientY,this.lastPointerUpEvent.clientX,this.lastPointerUpEvent.clientY)===0){const b=Ft({clientX:this.lastPointerUpEvent.clientX,clientY:this.lastPointerUpEvent.clientY},this.state);this.getElementsAtPosition(b.x,b.y).forEach(E=>n.elementIdsToErase[E.id]={erase:!0,opacity:E.opacity})}this.eraseElements(n);return}else Object.keys(n.elementIdsToErase).length&&this.restoreReadyToEraseElements(n);if(u&&!n.drag.hasOccurred&&!n.hit.wasAddedToSelection&&(!this.state.editingLinearElement||!n.boxSelection.hasOccurred)&&(r.shiftKey&&!this.state.editingLinearElement?this.state.selectedElementIds[u.id]?dS(this.state,u)?this.setState(y=>{const b={...y.selectedElementIds};for(const _ of u.groupIds.flatMap(E=>Gn(this.scene.getNonDeletedElements(),E)))delete b[_.id];return{selectedGroupIds:{...y.selectedElementIds,...u.groupIds.map(_=>({[_]:!1})).reduce((_,E)=>({..._,...E}),{})},selectedElementIds:gt(b,y)}}):(v=this.state.selectedLinearElement)!=null&&v.isDragging||this.setState(y=>{const b={...y.selectedElementIds};delete b[u.id];const _=Rt(this.scene.getNonDeletedElements(),{selectedElementIds:b});return{...ri({editingGroupId:y.editingGroupId,selectedElementIds:b},this.scene.getNonDeletedElements(),y,this),selectedLinearElement:_.length===1&&Je(_[0])?new Ae(_[0],this.scene):y.selectedLinearElement}}):u.frameId&&this.state.selectedElementIds[u.frameId]?this.setState(y=>{var _;const b={...y.selectedElementIds,[u.id]:!0};return delete b[u.frameId],(((_=this.scene.getElement(u.frameId))==null?void 0:_.groupIds)??[]).flatMap(E=>Gn(this.scene.getNonDeletedElements(),E)).forEach(E=>{delete b[E.id]}),{...ri({editingGroupId:y.editingGroupId,selectedElementIds:b},this.scene.getNonDeletedElements(),y,this),showHyperlinkPopup:u.link||ur(u)?"info":!1}}):this.setState(y=>({selectedElementIds:gt({...y.selectedElementIds,[u.id]:!0},y)})):this.setState(y=>{var b;return{...ri({editingGroupId:y.editingGroupId,selectedElementIds:{[u.id]:!0}},this.scene.getNonDeletedElements(),y,this),selectedLinearElement:Je(u)&&((b=y.selectedLinearElement)==null?void 0:b.elementId)!==u.id?new Ae(u,this.scene):y.selectedLinearElement}})),!n.drag.hasOccurred&&!this.state.isResizing&&(u&&c_(u,this.state,this.frameNameBoundsCache,n.origin.x,n.origin.y)||!u&&n.hit.hasHitCommonBoundingBoxOfSelectedElements)){this.state.editingLinearElement?this.setState({editingLinearElement:null}):this.setState({selectedElementIds:gt({},this.state),selectedGroupIds:{},editingGroupId:null,activeEmbeddable:null});return}if(!a.locked&&a.type!=="freedraw"&&i&&i.type!=="selection"&&this.setState(y=>({selectedElementIds:gt({...y.selectedElementIds,[i.id]:!0},y),showHyperlinkPopup:ur(i)&&!i.link?"editor":y.showHyperlinkPopup})),(a.type!=="selection"||wn(this.scene.getNonDeletedElements(),this.state))&&this.history.resumeRecording(),(n.drag.hasOccurred||l||c)&&(yc(this.state)?Ix:kx)(this.scene.getSelectedElements(this.state)),a.type==="laser"){this.laserPathManager.endPath();return}!a.locked&&a.type!=="freedraw"?(qi(this.interactiveCanvas),this.setState({draggingElement:null,suggestedBindings:[],activeTool:kn(this.state,{type:"selection"})})):this.setState({draggingElement:null,suggestedBindings:[]}),u&&this.lastPointerUpEvent&&this.lastPointerDownEvent&&this.lastPointerUpEvent.timeStamp-this.lastPointerDownEvent.timeStamp<300&&ct.pointers.size<=1&&os(u)&&this.isIframeLikeElementCenter(u,this.lastPointerUpEvent,n.origin.x,n.origin.y)&&this.handleEmbeddableCenterClick(u)})}maybeSuggestBindingForAll(n){if(n.length>50)return;const r=ore(n);this.setState({suggestedBindings:r})}clearSelection(n){this.setState(r=>({selectedElementIds:gt({},r),activeEmbeddable:null,selectedGroupIds:{},editingGroupId:r.editingGroupId&&n!=null&&Xp(n,r.editingGroupId)?r.editingGroupId:null})),this.setState({selectedElementIds:gt({},this.state),activeEmbeddable:null,previousSelectedElementIds:this.state.selectedElementIds})}getTextWysiwygSnappedToCenterPosition(n,r,i,s){if(s){let o=s.x+s.width/2,a=s.y+s.height/2;const l=b_(s,i);if(l&&(o=l.x,a=l.y),Math.hypot(n-o,r-a)<IV){const{x:d,y:h}=li({sceneX:o,sceneY:a},i);return{viewportX:d,viewportY:h,elementCenterX:o,elementCenterY:a}}}}getCanvasOffsets(){var n;if((n=this.excalidrawContainerRef)!=null&&n.current){const r=this.excalidrawContainerRef.current,{left:i,top:s}=r.getBoundingClientRect();return{offsetLeft:i,offsetTop:s}}return{offsetLeft:0,offsetTop:0}}async updateLanguage(){const n=FT.find(r=>r.code===this.props.langCode)||kl;await nR(n),this.setAppState({})}}const T1e=t=>{const{closeOnClickOutside:e=!0}=t,n=iN({className:"excalidraw-modal-container"});if(!n)return null;const r=i=>{i.key===z.ESCAPE&&(i.nativeEvent.stopImmediatePropagation(),i.stopPropagation(),t.onCloseRequest())};return hi.createPortal(M("div",{className:Ee("Modal",t.className),role:"dialog","aria-modal":"true",onKeyDown:r,"aria-labelledby":t.labelledBy,"data-prevent-outside-click":!0,children:[g("div",{className:"Modal__background",onClick:e?t.onCloseRequest:void 0}),g("div",{className:"Modal__content",style:{"--max-width":`${t.maxWidth}px`},tabIndex:0,children:t.children})]}),n)};function S1e(t){if(t&&typeof t=="number")return t;switch(t){case"small":return 550;case"wide":return 1024;case"regular":default:return 800}}const yi=t=>{const[e,n]=vR(),[r]=A.useState(document.activeElement),{id:i}=pa(),s=_r().viewport.isMobile;A.useEffect(()=>{if(!e)return;const c=gw(e);c.length>0&&t.autofocus!==!1&&(c[1]||c[0]).focus();const u=d=>{if(d.key===z.TAB){const h=gw(e),{activeElement:f}=document,p=h.findIndex(m=>m===f);p===0&&d.shiftKey?(h[h.length-1].focus(),d.preventDefault()):p===h.length-1&&!d.shiftKey&&(h[0].focus(),d.preventDefault())}};return e.addEventListener("keydown",u),()=>e.removeEventListener("keydown",u)},[e,t.autofocus]);const o=Fr(),a=ah(w4,rr),l=()=>{o({openMenu:null}),a(!1),r.focus(),t.onCloseRequest()};return g(T1e,{className:Ee("Dialog",t.className,{"Dialog--fullscreen":s}),labelledBy:"dialog-title",maxWidth:S1e(t.size),onCloseRequest:l,closeOnClickOutside:t.closeOnClickOutside,children:M(lo,{ref:n,children:[t.title&&g("h2",{id:`${i}-dialog-title`,className:"Dialog__title",children:g("span",{className:"Dialog__titleContent",children:t.title})}),g("button",{className:"Dialog__close",onClick:l,title:I("buttons.close"),"aria-label":I("buttons.close"),children:s?Yee:hh}),g("div",{className:"Dialog__content",children:t.children})]})})},W4=({children:t,onClose:e})=>{const[n,r]=A.useState(!!t),{container:i}=pa(),s=ce.useCallback(()=>{r(!1),e&&e(),i==null||i.focus()},[e,i]);return g(ge,{children:n&&g(yi,{size:"small",onCloseRequest:s,title:I("errorDialog.title"),children:g("div",{style:{whiteSpace:"pre-wrap"},children:t})})})};/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var _3=function(t,e){return _3=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var i in r)r.hasOwnProperty(i)&&(n[i]=r[i])},_3(t,e)};function L2(t,e){_3(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}var Bt=function(){return Bt=Object.assign||function(e){for(var n,r=1,i=arguments.length;r<i;r++){n=arguments[r];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e},Bt.apply(this,arguments)};function EM(t){var e=typeof Symbol=="function"&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function C1e(t,e){var n=typeof Symbol=="function"&&t[Symbol.iterator];if(!n)return t;var r=n.call(t),i,s=[],o;try{for(;(e===void 0||e-- >0)&&!(i=r.next()).done;)s.push(i.value)}catch(a){o={error:a}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(o)throw o.error}}return s}function ac(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(C1e(arguments[e]));return t}var cl;(function(t){t.Ok="ok",t.Exited="exited",t.Crashed="crashed",t.Abnormal="abnormal"})(cl||(cl={}));var xs;(function(t){t.Fatal="fatal",t.Error="error",t.Warning="warning",t.Log="log",t.Info="info",t.Debug="debug",t.Critical="critical"})(xs||(xs={}));(function(t){function e(n){switch(n){case"debug":return t.Debug;case"info":return t.Info;case"warn":case"warning":return t.Warning;case"error":return t.Error;case"fatal":return t.Fatal;case"critical":return t.Critical;case"log":default:return t.Log}}t.fromString=e})(xs||(xs={}));var ou;(function(t){t.Unknown="unknown",t.Skipped="skipped",t.Success="success",t.RateLimit="rate_limit",t.Invalid="invalid",t.Failed="failed"})(ou||(ou={}));(function(t){function e(n){return n>=200&&n<300?t.Success:n===429?t.RateLimit:n>=400&&n<500?t.Invalid:n>=500?t.Failed:t.Unknown}t.fromHttpCode=e})(ou||(ou={}));/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */function I1e(t,e){var n=typeof Symbol=="function"&&t[Symbol.iterator];if(!n)return t;var r=n.call(t),i,s=[],o;try{for(;(e===void 0||e-- >0)&&!(i=r.next()).done;)s.push(i.value)}catch(a){o={error:a}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(o)throw o.error}}return s}function A1e(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(I1e(arguments[e]));return t}/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var He=function(){return He=Object.assign||function(e){for(var n,r=1,i=arguments.length;r<i;r++){n=arguments[r];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e},He.apply(this,arguments)};function k1e(t,e){var n=typeof Symbol=="function"&&t[Symbol.iterator];if(!n)return t;var r=n.call(t),i,s=[],o;try{for(;(e===void 0||e-- >0)&&!(i=r.next()).done;)s.push(i.value)}catch(a){o={error:a}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(o)throw o.error}}return s}function tc(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(k1e(arguments[e]));return t}function y$(t){switch(Object.prototype.toString.call(t)){case"[object Error]":return!0;case"[object Exception]":return!0;case"[object DOMException]":return!0;default:return Sl(t,Error)}}function v$(t){return Object.prototype.toString.call(t)==="[object ErrorEvent]"}function wM(t){return Object.prototype.toString.call(t)==="[object DOMError]"}function M1e(t){return Object.prototype.toString.call(t)==="[object DOMException]"}function th(t){return Object.prototype.toString.call(t)==="[object String]"}function Em(t){return t===null||typeof t!="object"&&typeof t!="function"}function R2(t){return Object.prototype.toString.call(t)==="[object Object]"}function j4(t){return typeof Event<"u"&&Sl(t,Event)}function xM(t){return typeof Element<"u"&&Sl(t,Element)}function P1e(t){return Object.prototype.toString.call(t)==="[object RegExp]"}function X4(t){return!!(t&&t.then&&typeof t.then=="function")}function L1e(t){return R2(t)&&"nativeEvent"in t&&"preventDefault"in t&&"stopPropagation"in t}function Sl(t,e){try{return t instanceof e}catch{return!1}}function iv(t){try{for(var e=t,n=5,r=80,i=[],s=0,o=0,a=" > ",l=a.length,c=void 0;e&&s++<n&&(c=R1e(e),!(c==="html"||s>1&&o+i.length*l+c.length>=r));)i.push(c),o+=c.length,e=e.parentNode;return i.reverse().join(a)}catch{return"<unknown>"}}function R1e(t){var e=t,n=[],r,i,s,o,a;if(!e||!e.tagName)return"";if(n.push(e.tagName.toLowerCase()),e.id&&n.push("#"+e.id),r=e.className,r&&th(r))for(i=r.split(/\s+/),a=0;a<i.length;a++)n.push("."+i[a]);var l=["type","name","title","alt"];for(a=0;a<l.length;a++)s=l[a],o=e.getAttribute(s),o&&n.push("["+s+'="'+o+'"]');return n.join("")}/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var E3=function(t,e){return E3=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var i in r)r.hasOwnProperty(i)&&(n[i]=r[i])},E3(t,e)};function O1e(t,e){E3(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}var lc=function(){return lc=Object.assign||function(e){for(var n,r=1,i=arguments.length;r<i;r++){n=arguments[r];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e},lc.apply(this,arguments)};function b$(t){var e=typeof Symbol=="function"&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function D1e(t,e){var n=typeof Symbol=="function"&&t[Symbol.iterator];if(!n)return t;var r=n.call(t),i,s=[],o;try{for(;(e===void 0||e-- >0)&&!(i=r.next()).done;)s.push(i.value)}catch(a){o={error:a}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(o)throw o.error}}return s}var N1e=Object.setPrototypeOf||({__proto__:[]}instanceof Array?F1e:B1e);function F1e(t,e){return t.__proto__=e,t}function B1e(t,e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n]);return t}var Jn=function(t){O1e(e,t);function e(n){var r=this.constructor,i=t.call(this,n)||this;return i.message=n,i.name=r.prototype.constructor.name,N1e(i,r.prototype),i}return e}(Error),U1e=/^(?:(\w+):)\/\/(?:(\w+)(?::(\w+))?@)([\w.-]+)(?::(\d+))?\/(.+)/,uf="Invalid Dsn",_$=function(){function t(e){typeof e=="string"?this._fromString(e):this._fromComponents(e),this._validate()}return t.prototype.toString=function(e){e===void 0&&(e=!1);var n=this,r=n.host,i=n.path,s=n.pass,o=n.port,a=n.projectId,l=n.protocol,c=n.publicKey;return l+"://"+c+(e&&s?":"+s:"")+("@"+r+(o?":"+o:"")+"/"+(i&&i+"/")+a)},t.prototype._fromString=function(e){var n=U1e.exec(e);if(!n)throw new Jn(uf);var r=D1e(n.slice(1),6),i=r[0],s=r[1],o=r[2],a=o===void 0?"":o,l=r[3],c=r[4],u=c===void 0?"":c,d=r[5],h="",f=d,p=f.split("/");if(p.length>1&&(h=p.slice(0,-1).join("/"),f=p.pop()),f){var m=f.match(/^\d+/);m&&(f=m[0])}this._fromComponents({host:l,pass:a,path:h,projectId:f,port:u,protocol:i,publicKey:s})},t.prototype._fromComponents=function(e){"user"in e&&!("publicKey"in e)&&(e.publicKey=e.user),this.user=e.publicKey||"",this.protocol=e.protocol,this.publicKey=e.publicKey||"",this.pass=e.pass||"",this.host=e.host,this.port=e.port||"",this.path=e.path||"",this.projectId=e.projectId},t.prototype._validate=function(){var e=this;if(["protocol","publicKey","host","projectId"].forEach(function(n){if(!e[n])throw new Jn(uf+": "+n+" missing")}),!this.projectId.match(/^\d+$/))throw new Jn(uf+": Invalid projectId "+this.projectId);if(this.protocol!=="http"&&this.protocol!=="https")throw new Jn(uf+": Invalid protocol "+this.protocol);if(this.port&&isNaN(parseInt(this.port,10)))throw new Jn(uf+": Invalid port "+this.port)},t}();function Y4(){return Object.prototype.toString.call(typeof process<"u"?process:0)==="[object process]"}function $1e(t,e){return t.require(e)}function hp(t,e){return e===void 0&&(e=0),typeof t!="string"||e===0||t.length<=e?t:t.substr(0,e)+"..."}function sv(t,e){if(!Array.isArray(t))return"";for(var n=[],r=0;r<t.length;r++){var i=t[r];try{n.push(String(i))}catch{n.push("[value cannot be serialized]")}}return n.join(e)}function lE(t,e){return th(t)?P1e(e)?e.test(t):typeof e=="string"?t.indexOf(e)!==-1:!1:!1}var H1e={},z1e={};function Tn(){return Y4()?H1e:typeof window<"u"?window:typeof self<"u"?self:z1e}function Od(){var t=Tn(),e=t.crypto||t.msCrypto;if(e!==void 0&&e.getRandomValues){var n=new Uint16Array(8);e.getRandomValues(n),n[3]=n[3]&4095|16384,n[4]=n[4]&16383|32768;var r=function(i){for(var s=i.toString(16);s.length<4;)s="0"+s;return s};return r(n[0])+r(n[1])+r(n[2])+r(n[3])+r(n[4])+r(n[5])+r(n[6])+r(n[7])}return"xxxxxxxxxxxx4xxxyxxxxxxxxxxxxxxx".replace(/[xy]/g,function(i){var s=Math.random()*16|0,o=i==="x"?s:s&3|8;return o.toString(16)})}function cE(t){if(!t)return{};var e=t.match(/^(([^:/?#]+):)?(\/\/([^/?#]*))?([^?#]*)(\?([^#]*))?(#(.*))?$/);if(!e)return{};var n=e[6]||"",r=e[8]||"";return{host:e[4],path:e[5],protocol:e[2],relative:e[5]+n+r}}function nc(t){if(t.message)return t.message;if(t.exception&&t.exception.values&&t.exception.values[0]){var e=t.exception.values[0];return e.type&&e.value?e.type+": "+e.value:e.type||e.value||t.event_id||"<unknown>"}return t.event_id||"<unknown>"}function b0(t){var e=Tn(),n=["debug","info","warn","error","log","assert"];if(!("console"in e))return t();var r=e.console,i={};n.forEach(function(o){o in e.console&&r[o].__sentry_original__&&(i[o]=r[o],r[o]=r[o].__sentry_original__)});var s=t();return Object.keys(i).forEach(function(o){r[o]=i[o]}),s}function w3(t,e,n){t.exception=t.exception||{},t.exception.values=t.exception.values||[],t.exception.values[0]=t.exception.values[0]||{},t.exception.values[0].value=t.exception.values[0].value||e||"",t.exception.values[0].type=t.exception.values[0].type||n||"Error"}function nh(t,e){e===void 0&&(e={});try{t.exception.values[0].mechanism=t.exception.values[0].mechanism||{},Object.keys(e).forEach(function(n){t.exception.values[0].mechanism[n]=e[n]})}catch{}}function G1e(){try{return document.location.href}catch{return""}}var TM=60*1e3;function V1e(t,e){if(!e)return TM;var n=parseInt(""+e,10);if(!isNaN(n))return n*1e3;var r=Date.parse(""+e);return isNaN(r)?TM:r-t}var Oc=Tn(),uE="Sentry Logger ",W1e=function(){function t(){this._enabled=!1}return t.prototype.disable=function(){this._enabled=!1},t.prototype.enable=function(){this._enabled=!0},t.prototype.log=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];this._enabled&&b0(function(){Oc.console.log(uE+"[Log]: "+e.join(" "))})},t.prototype.warn=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];this._enabled&&b0(function(){Oc.console.warn(uE+"[Warn]: "+e.join(" "))})},t.prototype.error=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];this._enabled&&b0(function(){Oc.console.error(uE+"[Error]: "+e.join(" "))})},t}();Oc.__SENTRY__=Oc.__SENTRY__||{};var St=Oc.__SENTRY__.logger||(Oc.__SENTRY__.logger=new W1e),j1e=function(){function t(){this._hasWeakSet=typeof WeakSet=="function",this._inner=this._hasWeakSet?new WeakSet:[]}return t.prototype.memoize=function(e){if(this._hasWeakSet)return this._inner.has(e)?!0:(this._inner.add(e),!1);for(var n=0;n<this._inner.length;n++){var r=this._inner[n];if(r===e)return!0}return this._inner.push(e),!1},t.prototype.unmemoize=function(e){if(this._hasWeakSet)this._inner.delete(e);else for(var n=0;n<this._inner.length;n++)if(this._inner[n]===e){this._inner.splice(n,1);break}},t}(),dE="<anonymous>";function Ia(t){try{return!t||typeof t!="function"?dE:t.name||dE}catch{return dE}}var SM={};function Qn(t,e,n){if(e in t){var r=t[e],i=n(r);if(typeof i=="function")try{i.prototype=i.prototype||{},Object.defineProperties(i,{__sentry_original__:{enumerable:!1,value:r}})}catch{}t[e]=i}}function X1e(t){return Object.keys(t).map(function(e){return encodeURIComponent(e)+"="+encodeURIComponent(t[e])}).join("&")}function E$(t){if(y$(t)){var e=t,n={message:e.message,name:e.name,stack:e.stack};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(n[r]=e[r]);return n}if(j4(t)){var i=t,s={};s.type=i.type;try{s.target=xM(i.target)?iv(i.target):Object.prototype.toString.call(i.target)}catch{s.target="<unknown>"}try{s.currentTarget=xM(i.currentTarget)?iv(i.currentTarget):Object.prototype.toString.call(i.currentTarget)}catch{s.currentTarget="<unknown>"}typeof CustomEvent<"u"&&Sl(t,CustomEvent)&&(s.detail=i.detail);for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(s[r]=i);return s}return t}function Y1e(t){return~-encodeURI(t).split(/%..|./).length}function Z1e(t){return Y1e(JSON.stringify(t))}function w$(t,e,n){e===void 0&&(e=3),n===void 0&&(n=100*1024);var r=Lf(t,e);return Z1e(r)>n?w$(t,e-1,n):r}function K1e(t){var e=Object.prototype.toString.call(t);if(typeof t=="string")return t;if(e==="[object Object]")return"[Object]";if(e==="[object Array]")return"[Array]";var n=x$(t);return Em(n)?n:e}function x$(t,e){return e==="domain"&&t&&typeof t=="object"&&t._events?"[Domain]":e==="domainEmitter"?"[DomainEmitter]":typeof SM<"u"&&t===SM?"[Global]":typeof window<"u"&&t===window?"[Window]":typeof document<"u"&&t===document?"[Document]":L1e(t)?"[SyntheticEvent]":typeof t=="number"&&t!==t?"[NaN]":t===void 0?"[undefined]":typeof t=="function"?"[Function: "+Ia(t)+"]":typeof t=="symbol"?"["+String(t)+"]":typeof t=="bigint"?"[BigInt: "+String(t)+"]":t}function T$(t,e,n,r){if(n===void 0&&(n=1/0),r===void 0&&(r=new j1e),n===0)return K1e(e);if(e!=null&&typeof e.toJSON=="function")return e.toJSON();var i=x$(e,t);if(Em(i))return i;var s=E$(e),o=Array.isArray(e)?[]:{};if(r.memoize(e))return"[Circular ~]";for(var a in s)Object.prototype.hasOwnProperty.call(s,a)&&(o[a]=T$(a,s[a],n-1,r));return r.unmemoize(e),o}function Lf(t,e){try{return JSON.parse(JSON.stringify(t,function(n,r){return T$(n,r,e)}))}catch{return"**non-serializable**"}}function q1e(t,e){e===void 0&&(e=40);var n=Object.keys(E$(t));if(n.sort(),!n.length)return"[object has no keys]";if(n[0].length>=e)return hp(n[0],e);for(var r=n.length;r>0;r--){var i=n.slice(0,r).join(", ");if(!(i.length>e))return r===n.length?i:hp(i,e)}return""}function ov(t){var e,n;if(R2(t)){var r=t,i={};try{for(var s=b$(Object.keys(r)),o=s.next();!o.done;o=s.next()){var a=o.value;typeof r[a]<"u"&&(i[a]=ov(r[a]))}}catch(l){e={error:l}}finally{try{o&&!o.done&&(n=s.return)&&n.call(s)}finally{if(e)throw e.error}}return i}return Array.isArray(t)?t.map(ov):t}function Z4(){if(!("fetch"in Tn()))return!1;try{return new Headers,new Request(""),new Response,!0}catch{return!1}}function x3(t){return t&&/^function fetch\(\)\s+\{\s+\[native code\]\s+\}$/.test(t.toString())}function J1e(){if(!Z4())return!1;var t=Tn();if(x3(t.fetch))return!0;var e=!1,n=t.document;if(n&&typeof n.createElement=="function")try{var r=n.createElement("iframe");r.hidden=!0,n.head.appendChild(r),r.contentWindow&&r.contentWindow.fetch&&(e=x3(r.contentWindow.fetch)),n.head.removeChild(r)}catch(i){St.warn("Could not create sandbox iframe for pure fetch check, bailing to window.fetch: ",i)}return e}function Q1e(){if(!Z4())return!1;try{return new Request("_",{referrerPolicy:"origin"}),!0}catch{return!1}}function ege(){var t=Tn(),e=t.chrome,n=e&&e.app&&e.app.runtime,r="history"in t&&!!t.history.pushState&&!!t.history.replaceState;return!n&&r}var Yt=Tn(),fp={},CM={};function tge(t){if(!CM[t])switch(CM[t]=!0,t){case"console":nge();break;case"dom":dge();break;case"xhr":oge();break;case"fetch":rge();break;case"history":age();break;case"error":hge();break;case"unhandledrejection":fge();break;default:St.warn("unknown instrumentation type:",t)}}function Da(t){!t||typeof t.type!="string"||typeof t.callback!="function"||(fp[t.type]=fp[t.type]||[],fp[t.type].push(t.callback),tge(t.type))}function vs(t,e){var n,r;if(!(!t||!fp[t]))try{for(var i=b$(fp[t]||[]),s=i.next();!s.done;s=i.next()){var o=s.value;try{o(e)}catch(a){St.error(`Error while triggering instrumentation handler.
Type: `+t+`
Name: `+Ia(o)+`
Error: `+a)}}}catch(a){n={error:a}}finally{try{s&&!s.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}}function nge(){"console"in Yt&&["debug","info","warn","error","log","assert"].forEach(function(t){t in Yt.console&&Qn(Yt.console,t,function(e){return function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];vs("console",{args:n,level:t}),e&&Function.prototype.apply.call(e,Yt.console,n)}})})}function rge(){J1e()&&Qn(Yt,"fetch",function(t){return function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var r={args:e,fetchData:{method:ige(e),url:sge(e)},startTimestamp:Date.now()};return vs("fetch",lc({},r)),t.apply(Yt,e).then(function(i){return vs("fetch",lc(lc({},r),{endTimestamp:Date.now(),response:i})),i},function(i){throw vs("fetch",lc(lc({},r),{endTimestamp:Date.now(),error:i})),i})}})}function ige(t){return t===void 0&&(t=[]),"Request"in Yt&&Sl(t[0],Request)&&t[0].method?String(t[0].method).toUpperCase():t[1]&&t[1].method?String(t[1].method).toUpperCase():"GET"}function sge(t){return t===void 0&&(t=[]),typeof t[0]=="string"?t[0]:"Request"in Yt&&Sl(t[0],Request)?t[0].url:String(t[0])}function oge(){if("XMLHttpRequest"in Yt){var t=[],e=[],n=XMLHttpRequest.prototype;Qn(n,"open",function(r){return function(){for(var i=[],s=0;s<arguments.length;s++)i[s]=arguments[s];var o=this,a=i[1];o.__sentry_xhr__={method:th(i[0])?i[0].toUpperCase():i[0],url:i[1]},th(a)&&o.__sentry_xhr__.method==="POST"&&a.match(/sentry_key/)&&(o.__sentry_own_request__=!0);var l=function(){if(o.readyState===4){try{o.__sentry_xhr__&&(o.__sentry_xhr__.status_code=o.status)}catch{}try{var c=t.indexOf(o);if(c!==-1){t.splice(c);var u=e.splice(c)[0];o.__sentry_xhr__&&u[0]!==void 0&&(o.__sentry_xhr__.body=u[0])}}catch{}vs("xhr",{args:i,endTimestamp:Date.now(),startTimestamp:Date.now(),xhr:o})}};return"onreadystatechange"in o&&typeof o.onreadystatechange=="function"?Qn(o,"onreadystatechange",function(c){return function(){for(var u=[],d=0;d<arguments.length;d++)u[d]=arguments[d];return l(),c.apply(o,u)}}):o.addEventListener("readystatechange",l),r.apply(o,i)}}),Qn(n,"send",function(r){return function(){for(var i=[],s=0;s<arguments.length;s++)i[s]=arguments[s];return t.push(this),e.push(i),vs("xhr",{args:i,startTimestamp:Date.now(),xhr:this}),r.apply(this,i)}})}}var Eg;function age(){if(!ege())return;var t=Yt.onpopstate;Yt.onpopstate=function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];var i=Yt.location.href,s=Eg;if(Eg=i,vs("history",{from:s,to:i}),t)return t.apply(this,n)};function e(n){return function(){for(var r=[],i=0;i<arguments.length;i++)r[i]=arguments[i];var s=r.length>2?r[2]:void 0;if(s){var o=Eg,a=String(s);Eg=a,vs("history",{from:o,to:a})}return n.apply(this,r)}}Qn(Yt.history,"pushState",e),Qn(Yt.history,"replaceState",e)}var lge=1e3,wg,xg;function cge(t,e){if(!t||t.type!==e.type)return!0;try{if(t.target!==e.target)return!0}catch{}return!1}function uge(t){if(t.type!=="keypress")return!1;try{var e=t.target;if(!e||!e.tagName)return!0;if(e.tagName==="INPUT"||e.tagName==="TEXTAREA"||e.isContentEditable)return!1}catch{}return!0}function IM(t,e){return e===void 0&&(e=!1),function(n){if(!(!n||xg===n)&&!uge(n)){var r=n.type==="keypress"?"input":n.type;wg===void 0?(t({event:n,name:r,global:e}),xg=n):cge(xg,n)&&(t({event:n,name:r,global:e}),xg=n),clearTimeout(wg),wg=Yt.setTimeout(function(){wg=void 0},lge)}}}function dge(){if("document"in Yt){var t=vs.bind(null,"dom"),e=IM(t,!0);Yt.document.addEventListener("click",e,!1),Yt.document.addEventListener("keypress",e,!1),["EventTarget","Node"].forEach(function(n){var r=Yt[n]&&Yt[n].prototype;!r||!r.hasOwnProperty||!r.hasOwnProperty("addEventListener")||(Qn(r,"addEventListener",function(i){return function(s,o,a){if(s==="click"||s=="keypress")try{var l=this,c=l.__sentry_instrumentation_handlers__=l.__sentry_instrumentation_handlers__||{},u=c[s]=c[s]||{refCount:0};if(!u.handler){var d=IM(t);u.handler=d,i.call(this,s,d,a)}u.refCount+=1}catch{}return i.call(this,s,o,a)}}),Qn(r,"removeEventListener",function(i){return function(s,o,a){if(s==="click"||s=="keypress")try{var l=this,c=l.__sentry_instrumentation_handlers__||{},u=c[s];u&&(u.refCount-=1,u.refCount<=0&&(i.call(this,s,u.handler,a),u.handler=void 0,delete c[s]),Object.keys(c).length===0&&delete l.__sentry_instrumentation_handlers__)}catch{}return i.call(this,s,o,a)}}))})}}var hE=null;function hge(){hE=Yt.onerror,Yt.onerror=function(t,e,n,r,i){return vs("error",{column:r,error:i,line:n,msg:t,url:e}),hE?hE.apply(this,arguments):!1}}var fE=null;function fge(){fE=Yt.onunhandledrejection,Yt.onunhandledrejection=function(t){return vs("unhandledrejection",t),fE?fE.apply(this,arguments):!0}}var Mo;(function(t){t.PENDING="PENDING",t.RESOLVED="RESOLVED",t.REJECTED="REJECTED"})(Mo||(Mo={}));var Wr=function(){function t(e){var n=this;this._state=Mo.PENDING,this._handlers=[],this._resolve=function(r){n._setResult(Mo.RESOLVED,r)},this._reject=function(r){n._setResult(Mo.REJECTED,r)},this._setResult=function(r,i){if(n._state===Mo.PENDING){if(X4(i)){i.then(n._resolve,n._reject);return}n._state=r,n._value=i,n._executeHandlers()}},this._attachHandler=function(r){n._handlers=n._handlers.concat(r),n._executeHandlers()},this._executeHandlers=function(){if(n._state!==Mo.PENDING){var r=n._handlers.slice();n._handlers=[],r.forEach(function(i){i.done||(n._state===Mo.RESOLVED&&i.onfulfilled&&i.onfulfilled(n._value),n._state===Mo.REJECTED&&i.onrejected&&i.onrejected(n._value),i.done=!0)})}};try{e(this._resolve,this._reject)}catch(r){this._reject(r)}}return t.resolve=function(e){return new t(function(n){n(e)})},t.reject=function(e){return new t(function(n,r){r(e)})},t.all=function(e){return new t(function(n,r){if(!Array.isArray(e)){r(new TypeError("Promise.all requires an array as input."));return}if(e.length===0){n([]);return}var i=e.length,s=[];e.forEach(function(o,a){t.resolve(o).then(function(l){s[a]=l,i-=1,i===0&&n(s)}).then(null,r)})})},t.prototype.then=function(e,n){var r=this;return new t(function(i,s){r._attachHandler({done:!1,onfulfilled:function(o){if(!e){i(o);return}try{i(e(o));return}catch(a){s(a);return}},onrejected:function(o){if(!n){s(o);return}try{i(n(o));return}catch(a){s(a);return}}})})},t.prototype.catch=function(e){return this.then(function(n){return n},e)},t.prototype.finally=function(e){var n=this;return new t(function(r,i){var s,o;return n.then(function(a){o=!1,s=a,e&&e()},function(a){o=!0,s=a,e&&e()}).then(function(){if(o){i(s);return}r(s)})})},t.prototype.toString=function(){return"[object SyncPromise]"},t}(),pge=function(){function t(e){this._limit=e,this._buffer=[]}return t.prototype.isReady=function(){return this._limit===void 0||this.length()<this._limit},t.prototype.add=function(e){var n=this;return this.isReady()?(this._buffer.indexOf(e)===-1&&this._buffer.push(e),e.then(function(){return n.remove(e)}).then(null,function(){return n.remove(e).then(null,function(){})}),e):Wr.reject(new Jn("Not adding Promise due to buffer limit reached."))},t.prototype.remove=function(e){var n=this._buffer.splice(this._buffer.indexOf(e),1)[0];return n},t.prototype.length=function(){return this._buffer.length},t.prototype.drain=function(e){var n=this;return new Wr(function(r){var i=setTimeout(function(){e&&e>0&&r(!1)},e);Wr.all(n._buffer).then(function(){clearTimeout(i),r(!0)}).then(null,function(){r(!0)})})},t}(),T3={nowSeconds:function(){return Date.now()/1e3}};function mge(){var t=Tn().performance;if(!(!t||!t.now)){var e=Date.now()-t.now();return{now:function(){return t.now()},timeOrigin:e}}}function gge(){try{var t=$1e(module,"perf_hooks");return t.performance}catch{return}}var pE=Y4()?gge():mge(),AM=pE===void 0?T3:{nowSeconds:function(){return(pE.timeOrigin+pE.now())/1e3}},K4=T3.nowSeconds.bind(T3);AM.nowSeconds.bind(AM);(function(){var t=Tn().performance;if(t){var e=3600*1e3,n=t.timeOrigin&&Math.abs(t.timeOrigin+t.now()-Date.now())<e;if(n)return t.timeOrigin;var r=t.timing&&t.timing.navigationStart,i=typeof r=="number",s=i&&Math.abs(r+t.now()-Date.now())<e;return s?r:Date.now()}})();var av=function(){function t(){this._notifyingListeners=!1,this._scopeListeners=[],this._eventProcessors=[],this._breadcrumbs=[],this._user={},this._tags={},this._extra={},this._contexts={}}return t.clone=function(e){var n=new t;return e&&(n._breadcrumbs=tc(e._breadcrumbs),n._tags=He({},e._tags),n._extra=He({},e._extra),n._contexts=He({},e._contexts),n._user=e._user,n._level=e._level,n._span=e._span,n._session=e._session,n._transactionName=e._transactionName,n._fingerprint=e._fingerprint,n._eventProcessors=tc(e._eventProcessors)),n},t.prototype.addScopeListener=function(e){this._scopeListeners.push(e)},t.prototype.addEventProcessor=function(e){return this._eventProcessors.push(e),this},t.prototype.setUser=function(e){return this._user=e||{},this._session&&this._session.update({user:e}),this._notifyScopeListeners(),this},t.prototype.getUser=function(){return this._user},t.prototype.setTags=function(e){return this._tags=He(He({},this._tags),e),this._notifyScopeListeners(),this},t.prototype.setTag=function(e,n){var r;return this._tags=He(He({},this._tags),(r={},r[e]=n,r)),this._notifyScopeListeners(),this},t.prototype.setExtras=function(e){return this._extra=He(He({},this._extra),e),this._notifyScopeListeners(),this},t.prototype.setExtra=function(e,n){var r;return this._extra=He(He({},this._extra),(r={},r[e]=n,r)),this._notifyScopeListeners(),this},t.prototype.setFingerprint=function(e){return this._fingerprint=e,this._notifyScopeListeners(),this},t.prototype.setLevel=function(e){return this._level=e,this._notifyScopeListeners(),this},t.prototype.setTransactionName=function(e){return this._transactionName=e,this._notifyScopeListeners(),this},t.prototype.setTransaction=function(e){return this.setTransactionName(e)},t.prototype.setContext=function(e,n){var r;return n===null?delete this._contexts[e]:this._contexts=He(He({},this._contexts),(r={},r[e]=n,r)),this._notifyScopeListeners(),this},t.prototype.setSpan=function(e){return this._span=e,this._notifyScopeListeners(),this},t.prototype.getSpan=function(){return this._span},t.prototype.getTransaction=function(){var e,n,r,i,s=this.getSpan();if(!((e=s)===null||e===void 0)&&e.transaction)return(n=s)===null||n===void 0?void 0:n.transaction;if(!((i=(r=s)===null||r===void 0?void 0:r.spanRecorder)===null||i===void 0)&&i.spans[0])return s.spanRecorder.spans[0]},t.prototype.setSession=function(e){return e?this._session=e:delete this._session,this._notifyScopeListeners(),this},t.prototype.getSession=function(){return this._session},t.prototype.update=function(e){if(!e)return this;if(typeof e=="function"){var n=e(this);return n instanceof t?n:this}return e instanceof t?(this._tags=He(He({},this._tags),e._tags),this._extra=He(He({},this._extra),e._extra),this._contexts=He(He({},this._contexts),e._contexts),e._user&&Object.keys(e._user).length&&(this._user=e._user),e._level&&(this._level=e._level),e._fingerprint&&(this._fingerprint=e._fingerprint)):R2(e)&&(e=e,this._tags=He(He({},this._tags),e.tags),this._extra=He(He({},this._extra),e.extra),this._contexts=He(He({},this._contexts),e.contexts),e.user&&(this._user=e.user),e.level&&(this._level=e.level),e.fingerprint&&(this._fingerprint=e.fingerprint)),this},t.prototype.clear=function(){return this._breadcrumbs=[],this._tags={},this._extra={},this._user={},this._contexts={},this._level=void 0,this._transactionName=void 0,this._fingerprint=void 0,this._span=void 0,this._session=void 0,this._notifyScopeListeners(),this},t.prototype.addBreadcrumb=function(e,n){var r=He({timestamp:K4()},e);return this._breadcrumbs=n!==void 0&&n>=0?tc(this._breadcrumbs,[r]).slice(-n):tc(this._breadcrumbs,[r]),this._notifyScopeListeners(),this},t.prototype.clearBreadcrumbs=function(){return this._breadcrumbs=[],this._notifyScopeListeners(),this},t.prototype.applyToEvent=function(e,n){var r;if(this._extra&&Object.keys(this._extra).length&&(e.extra=He(He({},this._extra),e.extra)),this._tags&&Object.keys(this._tags).length&&(e.tags=He(He({},this._tags),e.tags)),this._user&&Object.keys(this._user).length&&(e.user=He(He({},this._user),e.user)),this._contexts&&Object.keys(this._contexts).length&&(e.contexts=He(He({},this._contexts),e.contexts)),this._level&&(e.level=this._level),this._transactionName&&(e.transaction=this._transactionName),this._span){e.contexts=He({trace:this._span.getTraceContext()},e.contexts);var i=(r=this._span.transaction)===null||r===void 0?void 0:r.name;i&&(e.tags=He({transaction:i},e.tags))}return this._applyFingerprint(e),e.breadcrumbs=tc(e.breadcrumbs||[],this._breadcrumbs),e.breadcrumbs=e.breadcrumbs.length>0?e.breadcrumbs:void 0,this._notifyEventProcessors(tc(S$(),this._eventProcessors),e,n)},t.prototype._notifyEventProcessors=function(e,n,r,i){var s=this;return i===void 0&&(i=0),new Wr(function(o,a){var l=e[i];if(n===null||typeof l!="function")o(n);else{var c=l(He({},n),r);X4(c)?c.then(function(u){return s._notifyEventProcessors(e,u,r,i+1).then(o)}).then(null,a):s._notifyEventProcessors(e,c,r,i+1).then(o).then(null,a)}})},t.prototype._notifyScopeListeners=function(){var e=this;this._notifyingListeners||(this._notifyingListeners=!0,this._scopeListeners.forEach(function(n){n(e)}),this._notifyingListeners=!1)},t.prototype._applyFingerprint=function(e){e.fingerprint=e.fingerprint?Array.isArray(e.fingerprint)?e.fingerprint:[e.fingerprint]:[],this._fingerprint&&(e.fingerprint=e.fingerprint.concat(this._fingerprint)),e.fingerprint&&!e.fingerprint.length&&delete e.fingerprint},t}();function S$(){var t=Tn();return t.__SENTRY__=t.__SENTRY__||{},t.__SENTRY__.globalEventProcessors=t.__SENTRY__.globalEventProcessors||[],t.__SENTRY__.globalEventProcessors}function O2(t){S$().push(t)}var yge=function(){function t(e){this.errors=0,this.sid=Od(),this.timestamp=Date.now(),this.started=Date.now(),this.duration=0,this.status=cl.Ok,this.init=!0,e&&this.update(e)}return t.prototype.update=function(e){e===void 0&&(e={}),e.user&&(e.user.ip_address&&(this.ipAddress=e.user.ip_address),e.did||(this.did=e.user.id||e.user.email||e.user.username)),this.timestamp=e.timestamp||Date.now(),e.sid&&(this.sid=e.sid.length===32?e.sid:Od()),e.init!==void 0&&(this.init=e.init),e.did&&(this.did=""+e.did),typeof e.started=="number"&&(this.started=e.started),typeof e.duration=="number"?this.duration=e.duration:this.duration=this.timestamp-this.started,e.release&&(this.release=e.release),e.environment&&(this.environment=e.environment),e.ipAddress&&(this.ipAddress=e.ipAddress),e.userAgent&&(this.userAgent=e.userAgent),typeof e.errors=="number"&&(this.errors=e.errors),e.status&&(this.status=e.status)},t.prototype.close=function(e){e?this.update({status:e}):this.status===cl.Ok?this.update({status:cl.Exited}):this.update()},t.prototype.toJSON=function(){return ov({sid:""+this.sid,init:this.init,started:new Date(this.started).toISOString(),timestamp:new Date(this.timestamp).toISOString(),status:this.status,errors:this.errors,did:typeof this.did=="number"||typeof this.did=="string"?""+this.did:void 0,duration:this.duration,attrs:ov({release:this.release,environment:this.environment,ip_address:this.ipAddress,user_agent:this.userAgent})})},t}(),q4=3,vge=100,bge=100,J4=function(){function t(e,n,r){n===void 0&&(n=new av),r===void 0&&(r=q4),this._version=r,this._stack=[{}],this.getStackTop().scope=n,this.bindClient(e)}return t.prototype.isOlderThan=function(e){return this._version<e},t.prototype.bindClient=function(e){var n=this.getStackTop();n.client=e,e&&e.setupIntegrations&&e.setupIntegrations()},t.prototype.pushScope=function(){var e=av.clone(this.getScope());return this.getStack().push({client:this.getClient(),scope:e}),e},t.prototype.popScope=function(){return this.getStack().length<=1?!1:!!this.getStack().pop()},t.prototype.withScope=function(e){var n=this.pushScope();try{e(n)}finally{this.popScope()}},t.prototype.getClient=function(){return this.getStackTop().client},t.prototype.getScope=function(){return this.getStackTop().scope},t.prototype.getStack=function(){return this._stack},t.prototype.getStackTop=function(){return this._stack[this._stack.length-1]},t.prototype.captureException=function(e,n){var r=this._lastEventId=Od(),i=n;if(!n){var s=void 0;try{throw new Error("Sentry syntheticException")}catch(o){s=o}i={originalException:e,syntheticException:s}}return this._invokeClient("captureException",e,He(He({},i),{event_id:r})),r},t.prototype.captureMessage=function(e,n,r){var i=this._lastEventId=Od(),s=r;if(!r){var o=void 0;try{throw new Error(e)}catch(a){o=a}s={originalException:e,syntheticException:o}}return this._invokeClient("captureMessage",e,n,He(He({},s),{event_id:i})),i},t.prototype.captureEvent=function(e,n){var r=this._lastEventId=Od();return this._invokeClient("captureEvent",e,He(He({},n),{event_id:r})),r},t.prototype.lastEventId=function(){return this._lastEventId},t.prototype.addBreadcrumb=function(e,n){var r=this.getStackTop(),i=r.scope,s=r.client;if(!(!i||!s)){var o=s.getOptions&&s.getOptions()||{},a=o.beforeBreadcrumb,l=a===void 0?null:a,c=o.maxBreadcrumbs,u=c===void 0?vge:c;if(!(u<=0)){var d=K4(),h=He({timestamp:d},e),f=l?b0(function(){return l(h,n)}):h;f!==null&&i.addBreadcrumb(f,Math.min(u,bge))}}},t.prototype.setUser=function(e){var n=this.getScope();n&&n.setUser(e)},t.prototype.setTags=function(e){var n=this.getScope();n&&n.setTags(e)},t.prototype.setExtras=function(e){var n=this.getScope();n&&n.setExtras(e)},t.prototype.setTag=function(e,n){var r=this.getScope();r&&r.setTag(e,n)},t.prototype.setExtra=function(e,n){var r=this.getScope();r&&r.setExtra(e,n)},t.prototype.setContext=function(e,n){var r=this.getScope();r&&r.setContext(e,n)},t.prototype.configureScope=function(e){var n=this.getStackTop(),r=n.scope,i=n.client;r&&i&&e(r)},t.prototype.run=function(e){var n=kM(this);try{e(this)}finally{kM(n)}},t.prototype.getIntegration=function(e){var n=this.getClient();if(!n)return null;try{return n.getIntegration(e)}catch{return St.warn("Cannot retrieve integration "+e.id+" from the current Hub"),null}},t.prototype.startSpan=function(e){return this._callExtensionMethod("startSpan",e)},t.prototype.startTransaction=function(e,n){return this._callExtensionMethod("startTransaction",e,n)},t.prototype.traceHeaders=function(){return this._callExtensionMethod("traceHeaders")},t.prototype.captureSession=function(e){if(e===void 0&&(e=!1),e)return this.endSession();this._sendSessionUpdate()},t.prototype.endSession=function(){var e,n,r,i,s;(r=(n=(e=this.getStackTop())===null||e===void 0?void 0:e.scope)===null||n===void 0?void 0:n.getSession())===null||r===void 0||r.close(),this._sendSessionUpdate(),(s=(i=this.getStackTop())===null||i===void 0?void 0:i.scope)===null||s===void 0||s.setSession()},t.prototype.startSession=function(e){var n=this.getStackTop(),r=n.scope,i=n.client,s=i&&i.getOptions()||{},o=s.release,a=s.environment,l=new yge(He(He({release:o,environment:a},r&&{user:r.getUser()}),e));if(r){var c=r.getSession&&r.getSession();c&&c.status===cl.Ok&&c.update({status:cl.Exited}),this.endSession(),r.setSession(l)}return l},t.prototype._sendSessionUpdate=function(){var e=this.getStackTop(),n=e.scope,r=e.client;if(n){var i=n.getSession&&n.getSession();i&&r&&r.captureSession&&r.captureSession(i)}},t.prototype._invokeClient=function(e){for(var n,r=[],i=1;i<arguments.length;i++)r[i-1]=arguments[i];var s=this.getStackTop(),o=s.scope,a=s.client;a&&a[e]&&(n=a)[e].apply(n,tc(r,[o]))},t.prototype._callExtensionMethod=function(e){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];var i=D2(),s=i.__SENTRY__;if(s&&s.extensions&&typeof s.extensions[e]=="function")return s.extensions[e].apply(this,n);St.warn("Extension method "+e+" couldn't be found, doing nothing.")},t}();function D2(){var t=Tn();return t.__SENTRY__=t.__SENTRY__||{extensions:{},hub:void 0},t}function kM(t){var e=D2(),n=Na(e);return Q4(e,t),n}function dr(){var t=D2();return(!C$(t)||Na(t).isOlderThan(q4))&&Q4(t,new J4),Y4()?_ge(t):Na(t)}function _ge(t){var e,n,r;try{var i=(r=(n=(e=D2().__SENTRY__)===null||e===void 0?void 0:e.extensions)===null||n===void 0?void 0:n.domain)===null||r===void 0?void 0:r.active;if(!i)return Na(t);if(!C$(i)||Na(i).isOlderThan(q4)){var s=Na(t).getStackTop();Q4(i,new J4(s.client,av.clone(s.scope)))}return Na(i)}catch{return Na(t)}}function C$(t){return!!(t&&t.__SENTRY__&&t.__SENTRY__.hub)}function Na(t){return t&&t.__SENTRY__&&t.__SENTRY__.hub||(t.__SENTRY__=t.__SENTRY__||{},t.__SENTRY__.hub=new J4),t.__SENTRY__.hub}function Q4(t,e){return t?(t.__SENTRY__=t.__SENTRY__||{},t.__SENTRY__.hub=e,!0):!1}function I$(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];var r=dr();if(r&&r[t])return r[t].apply(r,A1e(e));throw new Error("No hub defined or "+t+" was not found on the hub, please open a bug report.")}function A$(t,e){var n;try{throw new Error("Sentry syntheticException")}catch(r){n=r}return I$("captureException",t,{captureContext:e,originalException:t,syntheticException:n})}function k$(t){I$("withScope",t)}var MM="7",M$=function(){function t(e,n){n===void 0&&(n={}),this.dsn=e,this._dsnObject=new _$(e),this.metadata=n}return t.prototype.getDsn=function(){return this._dsnObject},t.prototype.getBaseApiEndpoint=function(){var e=this._dsnObject,n=e.protocol?e.protocol+":":"",r=e.port?":"+e.port:"";return n+"//"+e.host+r+(e.path?"/"+e.path:"")+"/api/"},t.prototype.getStoreEndpoint=function(){return this._getIngestEndpoint("store")},t.prototype.getStoreEndpointWithUrlEncodedAuth=function(){return this.getStoreEndpoint()+"?"+this._encodedAuth()},t.prototype.getEnvelopeEndpointWithUrlEncodedAuth=function(){return this._getEnvelopeEndpoint()+"?"+this._encodedAuth()},t.prototype.getStoreEndpointPath=function(){var e=this._dsnObject;return(e.path?"/"+e.path:"")+"/api/"+e.projectId+"/store/"},t.prototype.getRequestHeaders=function(e,n){var r=this._dsnObject,i=["Sentry sentry_version="+MM];return i.push("sentry_client="+e+"/"+n),i.push("sentry_key="+r.publicKey),r.pass&&i.push("sentry_secret="+r.pass),{"Content-Type":"application/json","X-Sentry-Auth":i.join(", ")}},t.prototype.getReportDialogEndpoint=function(e){e===void 0&&(e={});var n=this._dsnObject,r=this.getBaseApiEndpoint()+"embed/error-page/",i=[];i.push("dsn="+n.toString());for(var s in e)if(s!=="dsn")if(s==="user"){if(!e.user)continue;e.user.name&&i.push("name="+encodeURIComponent(e.user.name)),e.user.email&&i.push("email="+encodeURIComponent(e.user.email))}else i.push(encodeURIComponent(s)+"="+encodeURIComponent(e[s]));return i.length?r+"?"+i.join("&"):r},t.prototype._getEnvelopeEndpoint=function(){return this._getIngestEndpoint("envelope")},t.prototype._getIngestEndpoint=function(e){var n=this.getBaseApiEndpoint(),r=this._dsnObject;return""+n+r.projectId+"/"+e+"/"},t.prototype._encodedAuth=function(){var e=this._dsnObject,n={sentry_key:e.publicKey,sentry_version:MM};return X1e(n)},t}();/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var Sr=function(){return Sr=Object.assign||function(e){for(var n,r=1,i=arguments.length;r<i;r++){n=arguments[r];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e},Sr.apply(this,arguments)};function Ege(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]]);return n}function wge(t){var e=typeof Symbol=="function"&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function xge(t,e){var n=typeof Symbol=="function"&&t[Symbol.iterator];if(!n)return t;var r=n.call(t),i,s=[],o;try{for(;(e===void 0||e-- >0)&&!(i=r.next()).done;)s.push(i.value)}catch(a){o={error:a}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(o)throw o.error}}return s}function ul(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(xge(arguments[e]));return t}var PM=[];function Tge(t){var e=t.defaultIntegrations&&ul(t.defaultIntegrations)||[],n=t.integrations,r=[];if(Array.isArray(n)){var i=n.map(function(l){return l.name}),s=[];e.forEach(function(l){i.indexOf(l.name)===-1&&s.indexOf(l.name)===-1&&(r.push(l),s.push(l.name))}),n.forEach(function(l){s.indexOf(l.name)===-1&&(r.push(l),s.push(l.name))})}else typeof n=="function"?(r=n(e),r=Array.isArray(r)?r:[r]):r=ul(e);var o=r.map(function(l){return l.name}),a="Debug";return o.indexOf(a)!==-1&&r.push.apply(r,ul(r.splice(o.indexOf(a),1))),r}function Sge(t){PM.indexOf(t.name)===-1&&(t.setupOnce(O2,dr),PM.push(t.name),St.log("Integration installed: "+t.name))}function Cge(t){var e={};return Tge(t).forEach(function(n){e[n.name]=n,Sge(n)}),e}var Ige=function(){function t(e,n){this._integrations={},this._processing=0,this._backend=new e(n),this._options=n,n.dsn&&(this._dsn=new _$(n.dsn))}return t.prototype.captureException=function(e,n,r){var i=this,s=n&&n.event_id;return this._process(this._getBackend().eventFromException(e,n).then(function(o){return i._captureEvent(o,n,r)}).then(function(o){s=o})),s},t.prototype.captureMessage=function(e,n,r,i){var s=this,o=r&&r.event_id,a=Em(e)?this._getBackend().eventFromMessage(String(e),n,r):this._getBackend().eventFromException(e,r);return this._process(a.then(function(l){return s._captureEvent(l,r,i)}).then(function(l){o=l})),o},t.prototype.captureEvent=function(e,n,r){var i=n&&n.event_id;return this._process(this._captureEvent(e,n,r).then(function(s){i=s})),i},t.prototype.captureSession=function(e){e.release?(this._sendSession(e),e.update({init:!1})):St.warn("Discarded session because of missing release")},t.prototype.getDsn=function(){return this._dsn},t.prototype.getOptions=function(){return this._options},t.prototype.flush=function(e){var n=this;return this._isClientProcessing(e).then(function(r){return n._getBackend().getTransport().close(e).then(function(i){return r&&i})})},t.prototype.close=function(e){var n=this;return this.flush(e).then(function(r){return n.getOptions().enabled=!1,r})},t.prototype.setupIntegrations=function(){this._isEnabled()&&(this._integrations=Cge(this._options))},t.prototype.getIntegration=function(e){try{return this._integrations[e.id]||null}catch{return St.warn("Cannot retrieve integration "+e.id+" from the current Client"),null}},t.prototype._updateSessionFromEvent=function(e,n){var r,i,s=!1,o=!1,a,l=n.exception&&n.exception.values;if(l){o=!0;try{for(var c=wge(l),u=c.next();!u.done;u=c.next()){var d=u.value,h=d.mechanism;if(h&&h.handled===!1){s=!0;break}}}catch(v){r={error:v}}finally{try{u&&!u.done&&(i=c.return)&&i.call(c)}finally{if(r)throw r.error}}}var f=n.user;if(!e.userAgent){var p=n.request?n.request.headers:{};for(var m in p)if(m.toLowerCase()==="user-agent"){a=p[m];break}}e.update(Sr(Sr({},s&&{status:cl.Crashed}),{user:f,userAgent:a,errors:e.errors+Number(o||s)})),this.captureSession(e)},t.prototype._sendSession=function(e){this._getBackend().sendSession(e)},t.prototype._isClientProcessing=function(e){var n=this;return new Wr(function(r){var i=0,s=1,o=setInterval(function(){n._processing==0?(clearInterval(o),r(!0)):(i+=s,e&&i>=e&&(clearInterval(o),r(!1)))},s)})},t.prototype._getBackend=function(){return this._backend},t.prototype._isEnabled=function(){return this.getOptions().enabled!==!1&&this._dsn!==void 0},t.prototype._prepareEvent=function(e,n,r){var i=this,s=this.getOptions().normalizeDepth,o=s===void 0?3:s,a=Sr(Sr({},e),{event_id:e.event_id||(r&&r.event_id?r.event_id:Od()),timestamp:e.timestamp||K4()});this._applyClientOptions(a),this._applyIntegrationsMetadata(a);var l=n;r&&r.captureContext&&(l=av.clone(l).update(r.captureContext));var c=Wr.resolve(a);return l&&(c=l.applyToEvent(a,r)),c.then(function(u){return typeof o=="number"&&o>0?i._normalizeEvent(u,o):u})},t.prototype._normalizeEvent=function(e,n){if(!e)return null;var r=Sr(Sr(Sr(Sr(Sr({},e),e.breadcrumbs&&{breadcrumbs:e.breadcrumbs.map(function(i){return Sr(Sr({},i),i.data&&{data:Lf(i.data,n)})})}),e.user&&{user:Lf(e.user,n)}),e.contexts&&{contexts:Lf(e.contexts,n)}),e.extra&&{extra:Lf(e.extra,n)});return e.contexts&&e.contexts.trace&&(r.contexts.trace=e.contexts.trace),r},t.prototype._applyClientOptions=function(e){var n=this.getOptions(),r=n.environment,i=n.release,s=n.dist,o=n.maxValueLength,a=o===void 0?250:o;"environment"in e||(e.environment="environment"in n?r:"production"),e.release===void 0&&i!==void 0&&(e.release=i),e.dist===void 0&&s!==void 0&&(e.dist=s),e.message&&(e.message=hp(e.message,a));var l=e.exception&&e.exception.values&&e.exception.values[0];l&&l.value&&(l.value=hp(l.value,a));var c=e.request;c&&c.url&&(c.url=hp(c.url,a))},t.prototype._applyIntegrationsMetadata=function(e){var n=e.sdk,r=Object.keys(this._integrations);n&&r.length>0&&(n.integrations=r)},t.prototype._sendEvent=function(e){this._getBackend().sendEvent(e)},t.prototype._captureEvent=function(e,n,r){return this._processEvent(e,n,r).then(function(i){return i.event_id},function(i){St.error(i)})},t.prototype._processEvent=function(e,n,r){var i=this,s=this.getOptions(),o=s.beforeSend,a=s.sampleRate;if(!this._isEnabled())return Wr.reject(new Jn("SDK not enabled, will not send event."));var l=e.type==="transaction";return!l&&typeof a=="number"&&Math.random()>a?Wr.reject(new Jn("Discarding event because it's not included in the random sample (sampling rate = "+a+")")):this._prepareEvent(e,r,n).then(function(c){if(c===null)throw new Jn("An event processor returned null, will not send event.");var u=n&&n.data&&n.data.__sentry__===!0;if(u||l||!o)return c;var d=o(c,n);if(typeof d>"u")throw new Jn("`beforeSend` method has to return `null` or a valid event.");return X4(d)?d.then(function(h){return h},function(h){throw new Jn("beforeSend rejected with "+h)}):d}).then(function(c){if(c===null)throw new Jn("`beforeSend` returned `null`, will not send event.");var u=r&&r.getSession&&r.getSession();return!l&&u&&i._updateSessionFromEvent(u,c),i._sendEvent(c),c}).then(null,function(c){throw c instanceof Jn?c:(i.captureException(c,{data:{__sentry__:!0},originalException:c}),new Jn(`Event processing pipeline threw an error, original event will not be sent. Details have been sent as a new event.
Reason: `+c))})},t.prototype._process=function(e){var n=this;this._processing+=1,e.then(function(r){return n._processing-=1,r},function(r){return n._processing-=1,r})},t}(),Age=function(){function t(){}return t.prototype.sendEvent=function(e){return Wr.resolve({reason:"NoopTransport: Event has been skipped because no Dsn is configured.",status:ou.Skipped})},t.prototype.close=function(e){return Wr.resolve(!0)},t}(),kge=function(){function t(e){this._options=e,this._options.dsn||St.warn("No DSN provided, backend will not do anything."),this._transport=this._setupTransport()}return t.prototype.eventFromException=function(e,n){throw new Jn("Backend has to implement `eventFromException` method")},t.prototype.eventFromMessage=function(e,n,r){throw new Jn("Backend has to implement `eventFromMessage` method")},t.prototype.sendEvent=function(e){this._transport.sendEvent(e).then(null,function(n){St.error("Error while sending event: "+n)})},t.prototype.sendSession=function(e){if(!this._transport.sendSession){St.warn("Dropping session because custom transport doesn't implement sendSession");return}this._transport.sendSession(e).then(null,function(n){St.error("Error while sending session: "+n)})},t.prototype.getTransport=function(){return this._transport},t.prototype._setupTransport=function(){return new Age},t}();function P$(t){if(!(!t.metadata||!t.metadata.sdk)){var e=t.metadata.sdk,n=e.name,r=e.version;return{name:n,version:r}}}function Mge(t,e){return e&&(t.sdk=t.sdk||{name:e.name,version:e.version},t.sdk.name=t.sdk.name||e.name,t.sdk.version=t.sdk.version||e.version,t.sdk.integrations=ul(t.sdk.integrations||[],e.integrations||[]),t.sdk.packages=ul(t.sdk.packages||[],e.packages||[])),t}function L$(t,e){var n=P$(e),r=JSON.stringify(Sr({sent_at:new Date().toISOString()},n&&{sdk:n})),i=JSON.stringify({type:"session"});return{body:r+`
`+i+`
`+JSON.stringify(t),type:"session",url:e.getEnvelopeEndpointWithUrlEncodedAuth()}}function R$(t,e){var n=P$(e),r=t.type||"event",i=r==="transaction",s=t.debug_meta||{},o=s.transactionSampling,a=Ege(s,["transactionSampling"]),l=o||{},c=l.method,u=l.rate;Object.keys(a).length===0?delete t.debug_meta:t.debug_meta=a;var d={body:JSON.stringify(n?Mge(t,e.metadata.sdk):t),type:r,url:i?e.getEnvelopeEndpointWithUrlEncodedAuth():e.getStoreEndpointWithUrlEncodedAuth()};if(i){var h=JSON.stringify(Sr({event_id:t.event_id,sent_at:new Date().toISOString()},n&&{sdk:n})),f=JSON.stringify({type:t.type,sample_rates:[{id:c,rate:u}]}),p=h+`
`+f+`
`+d.body;d.body=p}return d}function Pge(t,e){e.debug===!0&&St.enable();var n=dr(),r=new t(e);n.bindClient(r)}var LM="6.2.5",RM,Lge=function(){function t(){this.name=t.id}return t.prototype.setupOnce=function(){RM=Function.prototype.toString,Function.prototype.toString=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var r=this.__sentry_original__||this;return RM.apply(r,e)}},t.id="FunctionToString",t}(),Rge=[/^Script error\.?$/,/^Javascript error: Script error\.? on line 0$/],Oge=function(){function t(e){e===void 0&&(e={}),this._options=e,this.name=t.id}return t.prototype.setupOnce=function(){O2(function(e){var n=dr();if(!n)return e;var r=n.getIntegration(t);if(r){var i=n.getClient(),s=i?i.getOptions():{},o=r._mergeOptions(s);if(r._shouldDropEvent(e,o))return null}return e})},t.prototype._shouldDropEvent=function(e,n){return this._isSentryError(e,n)?(St.warn(`Event dropped due to being internal Sentry Error.
Event: `+nc(e)),!0):this._isIgnoredError(e,n)?(St.warn("Event dropped due to being matched by `ignoreErrors` option.\nEvent: "+nc(e)),!0):this._isDeniedUrl(e,n)?(St.warn("Event dropped due to being matched by `denyUrls` option.\nEvent: "+nc(e)+`.
Url: `+this._getEventFilterUrl(e)),!0):this._isAllowedUrl(e,n)?!1:(St.warn("Event dropped due to not being matched by `allowUrls` option.\nEvent: "+nc(e)+`.
Url: `+this._getEventFilterUrl(e)),!0)},t.prototype._isSentryError=function(e,n){if(!n.ignoreInternal)return!1;try{return e&&e.exception&&e.exception.values&&e.exception.values[0]&&e.exception.values[0].type==="SentryError"||!1}catch{return!1}},t.prototype._isIgnoredError=function(e,n){return!n.ignoreErrors||!n.ignoreErrors.length?!1:this._getPossibleEventMessages(e).some(function(r){return n.ignoreErrors.some(function(i){return lE(r,i)})})},t.prototype._isDeniedUrl=function(e,n){if(!n.denyUrls||!n.denyUrls.length)return!1;var r=this._getEventFilterUrl(e);return r?n.denyUrls.some(function(i){return lE(r,i)}):!1},t.prototype._isAllowedUrl=function(e,n){if(!n.allowUrls||!n.allowUrls.length)return!0;var r=this._getEventFilterUrl(e);return r?n.allowUrls.some(function(i){return lE(r,i)}):!0},t.prototype._mergeOptions=function(e){return e===void 0&&(e={}),{allowUrls:ul(this._options.whitelistUrls||[],this._options.allowUrls||[],e.whitelistUrls||[],e.allowUrls||[]),denyUrls:ul(this._options.blacklistUrls||[],this._options.denyUrls||[],e.blacklistUrls||[],e.denyUrls||[]),ignoreErrors:ul(this._options.ignoreErrors||[],e.ignoreErrors||[],Rge),ignoreInternal:typeof this._options.ignoreInternal<"u"?this._options.ignoreInternal:!0}},t.prototype._getPossibleEventMessages=function(e){if(e.message)return[e.message];if(e.exception)try{var n=e.exception.values&&e.exception.values[0]||{},r=n.type,i=r===void 0?"":r,s=n.value,o=s===void 0?"":s;return[""+o,i+": "+o]}catch{return St.error("Cannot extract message for event "+nc(e)),[]}return[]},t.prototype._getEventFilterUrl=function(e){try{if(e.stacktrace){var n=e.stacktrace.frames;return n&&n[n.length-1].filename||null}if(e.exception){var r=e.exception.values&&e.exception.values[0].stacktrace&&e.exception.values[0].stacktrace.frames;return r&&r[r.length-1].filename||null}return null}catch{return St.error("Cannot extract url for event "+nc(e)),null}},t.id="InboundFilters",t}(),Rf="?",Dge=/^\s*at (?:(.*?) ?\()?((?:file|https?|blob|chrome-extension|address|native|eval|webpack|<anonymous>|[-a-z]+:|.*bundle|\/).*?)(?::(\d+))?(?::(\d+))?\)?\s*$/i,Nge=/^\s*(.*?)(?:\((.*?)\))?(?:^|@)?((?:file|https?|blob|chrome|webpack|resource|moz-extension|capacitor).*?:\/.*?|\[native code\]|[^@]*(?:bundle|\d+\.js)|\/[\w\-. /=]+)(?::(\d+))?(?::(\d+))?\s*$/i,Fge=/^\s*at (?:((?:\[object object\])?.+) )?\(?((?:file|ms-appx|https?|webpack|blob):.*?):(\d+)(?::(\d+))?\)?\s*$/i,Bge=/(\S+) line (\d+)(?: > eval line \d+)* > eval/i,Uge=/\((\S*)(?::(\d+))(?::(\d+))\)/,$ge=/Minified React error #\d+;/i;function wm(t){var e=null,n=0;t&&(typeof t.framesToPop=="number"?n=t.framesToPop:$ge.test(t.message)&&(n=1));try{if(e=zge(t),e)return OM(e,n)}catch{}try{if(e=Hge(t),e)return OM(e,n)}catch{}return{message:e6(t),name:t&&t.name,stack:[],failed:!0}}function Hge(t){if(!t||!t.stack)return null;for(var e=[],n=t.stack.split(`
`),r,i,s,o,a=0;a<n.length;++a){if(s=Dge.exec(n[a])){var l=s[2]&&s[2].indexOf("native")===0;r=s[2]&&s[2].indexOf("eval")===0,r&&(i=Uge.exec(s[2]))&&(s[2]=i[1],s[3]=i[2],s[4]=i[3]),o={url:s[2]&&s[2].indexOf("address at ")===0?s[2].substr(11):s[2],func:s[1]||Rf,args:l?[s[2]]:[],line:s[3]?+s[3]:null,column:s[4]?+s[4]:null}}else if(s=Fge.exec(n[a]))o={url:s[2],func:s[1]||Rf,args:[],line:+s[3],column:s[4]?+s[4]:null};else if(s=Nge.exec(n[a]))r=s[3]&&s[3].indexOf(" > eval")>-1,r&&(i=Bge.exec(s[3]))?(s[1]=s[1]||"eval",s[3]=i[1],s[4]=i[2],s[5]=""):a===0&&!s[5]&&t.columnNumber!==void 0&&(e[0].column=t.columnNumber+1),o={url:s[3],func:s[1]||Rf,args:s[2]?s[2].split(","):[],line:s[4]?+s[4]:null,column:s[5]?+s[5]:null};else continue;!o.func&&o.line&&(o.func=Rf),e.push(o)}return e.length?{message:e6(t),name:t.name,stack:e}:null}function zge(t){if(!t||!t.stacktrace)return null;for(var e=t.stacktrace,n=/ line (\d+).*script (?:in )?(\S+)(?:: in function (\S+))?$/i,r=/ line (\d+), column (\d+)\s*(?:in (?:<anonymous function: ([^>]+)>|([^)]+))\((.*)\))? in (.*):\s*$/i,i=e.split(`
`),s=[],o,a=0;a<i.length;a+=2){var l=null;(o=n.exec(i[a]))?l={url:o[2],func:o[3],args:[],line:+o[1],column:null}:(o=r.exec(i[a]))&&(l={url:o[6],func:o[3]||o[4],args:o[5]?o[5].split(","):[],line:+o[1],column:+o[2]}),l&&(!l.func&&l.line&&(l.func=Rf),s.push(l))}return s.length?{message:e6(t),name:t.name,stack:s}:null}function OM(t,e){try{return Bt(Bt({},t),{stack:t.stack.slice(e)})}catch{return t}}function e6(t){var e=t&&t.message;return e?e.error&&typeof e.error.message=="string"?e.error.message:e:"No error message"}var Gge=50;function O$(t){var e=t6(t.stack),n={type:t.name,value:t.message};return e&&e.length&&(n.stacktrace={frames:e}),n.type===void 0&&n.value===""&&(n.value="Unrecoverable error caught"),n}function Vge(t,e,n){var r={exception:{values:[{type:j4(t)?t.constructor.name:n?"UnhandledRejection":"Error",value:"Non-Error "+(n?"promise rejection":"exception")+" captured with keys: "+q1e(t)}]},extra:{__serialized__:w$(t)}};if(e){var i=wm(e),s=t6(i.stack);r.stacktrace={frames:s}}return r}function DM(t){var e=O$(t);return{exception:{values:[e]}}}function t6(t){if(!t||!t.length)return[];var e=t,n=e[0].func||"",r=e[e.length-1].func||"";return(n.indexOf("captureMessage")!==-1||n.indexOf("captureException")!==-1)&&(e=e.slice(1)),r.indexOf("sentryWrapped")!==-1&&(e=e.slice(0,-1)),e.slice(0,Gge).map(function(i){return{colno:i.column===null?void 0:i.column,filename:i.url||e[0].url,function:i.func||"?",in_app:!0,lineno:i.line===null?void 0:i.line}}).reverse()}function Wge(t,e,n){var r=n&&n.syntheticException||void 0,i=S3(e,r,{attachStacktrace:t.attachStacktrace});return nh(i,{handled:!0,type:"generic"}),i.level=xs.Error,n&&n.event_id&&(i.event_id=n.event_id),Wr.resolve(i)}function jge(t,e,n,r){n===void 0&&(n=xs.Info);var i=r&&r.syntheticException||void 0,s=C3(e,i,{attachStacktrace:t.attachStacktrace});return s.level=n,r&&r.event_id&&(s.event_id=r.event_id),Wr.resolve(s)}function S3(t,e,n){n===void 0&&(n={});var r;if(v$(t)&&t.error){var i=t;return t=i.error,r=DM(wm(t)),r}if(wM(t)||M1e(t)){var s=t,o=s.name||(wM(s)?"DOMError":"DOMException"),a=s.message?o+": "+s.message:o;return r=C3(a,e,n),w3(r,a),"code"in s&&(r.tags=Bt(Bt({},r.tags),{"DOMException.code":""+s.code})),r}if(y$(t))return r=DM(wm(t)),r;if(R2(t)||j4(t)){var l=t;return r=Vge(l,e,n.rejection),nh(r,{synthetic:!0}),r}return r=C3(t,e,n),w3(r,""+t,void 0),nh(r,{synthetic:!0}),r}function C3(t,e,n){n===void 0&&(n={});var r={message:t};if(n.attachStacktrace&&e){var i=wm(e),s=t6(i.stack);r.stacktrace={frames:s}}return r}var Xge={event:"error",transaction:"transaction",session:"session"},D$=function(){function t(e){this.options=e,this._buffer=new pge(30),this._rateLimits={},this._api=new M$(e.dsn,e._metadata),this.url=this._api.getStoreEndpointWithUrlEncodedAuth()}return t.prototype.sendEvent=function(e){throw new Jn("Transport Class has to implement `sendEvent` method")},t.prototype.close=function(e){return this._buffer.drain(e)},t.prototype._handleResponse=function(e){var n=e.requestType,r=e.response,i=e.headers,s=e.resolve,o=e.reject,a=ou.fromHttpCode(r.status),l=this._handleRateLimit(i);if(l&&St.warn("Too many requests, backing off until: "+this._disabledUntil(n)),a===ou.Success){s({status:a});return}o(r)},t.prototype._disabledUntil=function(e){var n=Xge[e];return this._rateLimits[n]||this._rateLimits.all},t.prototype._isRateLimited=function(e){return this._disabledUntil(e)>new Date(Date.now())},t.prototype._handleRateLimit=function(e){var n,r,i,s,o=Date.now(),a=e["x-sentry-rate-limits"],l=e["retry-after"];if(a){try{for(var c=EM(a.trim().split(",")),u=c.next();!u.done;u=c.next()){var d=u.value,h=d.split(":",2),f=parseInt(h[0],10),p=(isNaN(f)?60:f)*1e3;try{for(var m=(i=void 0,EM(h[1].split(";"))),v=m.next();!v.done;v=m.next()){var y=v.value;this._rateLimits[y||"all"]=new Date(o+p)}}catch(b){i={error:b}}finally{try{v&&!v.done&&(s=m.return)&&s.call(m)}finally{if(i)throw i.error}}}}catch(b){n={error:b}}finally{try{u&&!u.done&&(r=c.return)&&r.call(c)}finally{if(n)throw n.error}}return!0}else if(l)return this._rateLimits.all=new Date(o+V1e(o,l)),!0;return!1},t}();function Yge(){var t,e,n=Tn();if(x3(n.fetch))return n.fetch.bind(n);var r=n.document,i=n.fetch;if(typeof((t=r)===null||t===void 0?void 0:t.createElement)=="function")try{var s=r.createElement("iframe");s.hidden=!0,r.head.appendChild(s),!((e=s.contentWindow)===null||e===void 0)&&e.fetch&&(i=s.contentWindow.fetch),r.head.removeChild(s)}catch(o){St.warn("Could not create sandbox iframe for pure fetch check, bailing to window.fetch: ",o)}return i.bind(n)}var Zge=function(t){L2(e,t);function e(n,r){r===void 0&&(r=Yge());var i=t.call(this,n)||this;return i._fetch=r,i}return e.prototype.sendEvent=function(n){return this._sendRequest(R$(n,this._api),n)},e.prototype.sendSession=function(n){return this._sendRequest(L$(n,this._api),n)},e.prototype._sendRequest=function(n,r){var i=this;if(this._isRateLimited(n.type))return Promise.reject({event:r,type:n.type,reason:"Transport locked till "+this._disabledUntil(n.type)+" due to too many requests.",status:429});var s={body:n.body,method:"POST",referrerPolicy:Q1e()?"origin":""};return this.options.fetchParameters!==void 0&&Object.assign(s,this.options.fetchParameters),this.options.headers!==void 0&&(s.headers=this.options.headers),this._buffer.add(new Wr(function(o,a){i._fetch(n.url,s).then(function(l){var c={"x-sentry-rate-limits":l.headers.get("X-Sentry-Rate-Limits"),"retry-after":l.headers.get("Retry-After")};i._handleResponse({requestType:n.type,response:l,headers:c,resolve:o,reject:a})}).catch(a)}))},e}(D$),Kge=function(t){L2(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.prototype.sendEvent=function(n){return this._sendRequest(R$(n,this._api),n)},e.prototype.sendSession=function(n){return this._sendRequest(L$(n,this._api),n)},e.prototype._sendRequest=function(n,r){var i=this;return this._isRateLimited(n.type)?Promise.reject({event:r,type:n.type,reason:"Transport locked till "+this._disabledUntil(n.type)+" due to too many requests.",status:429}):this._buffer.add(new Wr(function(s,o){var a=new XMLHttpRequest;a.onreadystatechange=function(){if(a.readyState===4){var c={"x-sentry-rate-limits":a.getResponseHeader("X-Sentry-Rate-Limits"),"retry-after":a.getResponseHeader("Retry-After")};i._handleResponse({requestType:n.type,response:a,headers:c,resolve:s,reject:o})}},a.open("POST",n.url);for(var l in i.options.headers)i.options.headers.hasOwnProperty(l)&&a.setRequestHeader(l,i.options.headers[l]);a.send(n.body)}))},e}(D$),qge=function(t){L2(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.prototype.eventFromException=function(n,r){return Wge(this._options,n,r)},e.prototype.eventFromMessage=function(n,r,i){return r===void 0&&(r=xs.Info),jge(this._options,n,r,i)},e.prototype._setupTransport=function(){if(!this._options.dsn)return t.prototype._setupTransport.call(this);var n=Bt(Bt({},this._options.transportOptions),{dsn:this._options.dsn,_metadata:this._options._metadata});return this._options.transport?new this._options.transport(n):Z4()?new Zge(n):new Kge(n)},e}(kge),I3=0;function NM(){return I3>0}function Jge(){I3+=1,setTimeout(function(){I3-=1})}function zu(t,e,n){if(e===void 0&&(e={}),typeof t!="function")return t;try{if(t.__sentry__)return t;if(t.__sentry_wrapped__)return t.__sentry_wrapped__}catch{return t}var r=function(){var o=Array.prototype.slice.call(arguments);try{n&&typeof n=="function"&&n.apply(this,arguments);var a=o.map(function(l){return zu(l,e)});return t.handleEvent?t.handleEvent.apply(this,a):t.apply(this,a)}catch(l){throw Jge(),k$(function(c){c.addEventProcessor(function(u){var d=Bt({},u);return e.mechanism&&(w3(d,void 0,void 0),nh(d,e.mechanism)),d.extra=Bt(Bt({},d.extra),{arguments:o}),d}),A$(l)}),l}};try{for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(r[i]=t[i])}catch{}t.prototype=t.prototype||{},r.prototype=t.prototype,Object.defineProperty(t,"__sentry_wrapped__",{enumerable:!1,value:r}),Object.defineProperties(r,{__sentry__:{enumerable:!1,value:!0},__sentry_original__:{enumerable:!1,value:t}});try{var s=Object.getOwnPropertyDescriptor(r,"name");s.configurable&&Object.defineProperty(r,"name",{get:function(){return t.name}})}catch{}return r}function Qge(t){if(t===void 0&&(t={}),!t.eventId){St.error("Missing eventId option in showReportDialog call");return}if(!t.dsn){St.error("Missing dsn option in showReportDialog call");return}var e=document.createElement("script");e.async=!0,e.src=new M$(t.dsn).getReportDialogEndpoint(t),t.onLoad&&(e.onload=t.onLoad),(document.head||document.body).appendChild(e)}var e0e=function(){function t(e){this.name=t.id,this._onErrorHandlerInstalled=!1,this._onUnhandledRejectionHandlerInstalled=!1,this._options=Bt({onerror:!0,onunhandledrejection:!0},e)}return t.prototype.setupOnce=function(){Error.stackTraceLimit=50,this._options.onerror&&(St.log("Global Handler attached: onerror"),this._installGlobalOnErrorHandler()),this._options.onunhandledrejection&&(St.log("Global Handler attached: onunhandledrejection"),this._installGlobalOnUnhandledRejectionHandler())},t.prototype._installGlobalOnErrorHandler=function(){var e=this;this._onErrorHandlerInstalled||(Da({callback:function(n){var r=n.error,i=dr(),s=i.getIntegration(t),o=r&&r.__sentry_own_request__===!0;if(!(!s||NM()||o)){var a=i.getClient(),l=Em(r)?e._eventFromIncompleteOnError(n.msg,n.url,n.line,n.column):e._enhanceEventWithInitialFrame(S3(r,void 0,{attachStacktrace:a&&a.getOptions().attachStacktrace,rejection:!1}),n.url,n.line,n.column);nh(l,{handled:!1,type:"onerror"}),i.captureEvent(l,{originalException:r})}},type:"error"}),this._onErrorHandlerInstalled=!0)},t.prototype._installGlobalOnUnhandledRejectionHandler=function(){var e=this;this._onUnhandledRejectionHandlerInstalled||(Da({callback:function(n){var r=n;try{"reason"in n?r=n.reason:"detail"in n&&"reason"in n.detail&&(r=n.detail.reason)}catch{}var i=dr(),s=i.getIntegration(t),o=r&&r.__sentry_own_request__===!0;if(!s||NM()||o)return!0;var a=i.getClient(),l=Em(r)?e._eventFromRejectionWithPrimitive(r):S3(r,void 0,{attachStacktrace:a&&a.getOptions().attachStacktrace,rejection:!0});l.level=xs.Error,nh(l,{handled:!1,type:"onunhandledrejection"}),i.captureEvent(l,{originalException:r})},type:"unhandledrejection"}),this._onUnhandledRejectionHandlerInstalled=!0)},t.prototype._eventFromIncompleteOnError=function(e,n,r,i){var s=/^(?:[Uu]ncaught (?:exception: )?)?(?:((?:Eval|Internal|Range|Reference|Syntax|Type|URI|)Error): )?(.*)$/i,o=v$(e)?e.message:e,a;if(th(o)){var l=o.match(s);l&&(a=l[1],o=l[2])}var c={exception:{values:[{type:a||"Error",value:o}]}};return this._enhanceEventWithInitialFrame(c,n,r,i)},t.prototype._eventFromRejectionWithPrimitive=function(e){return{exception:{values:[{type:"UnhandledRejection",value:"Non-Error promise rejection captured with value: "+String(e)}]}}},t.prototype._enhanceEventWithInitialFrame=function(e,n,r,i){e.exception=e.exception||{},e.exception.values=e.exception.values||[],e.exception.values[0]=e.exception.values[0]||{},e.exception.values[0].stacktrace=e.exception.values[0].stacktrace||{},e.exception.values[0].stacktrace.frames=e.exception.values[0].stacktrace.frames||[];var s=isNaN(parseInt(i,10))?void 0:i,o=isNaN(parseInt(r,10))?void 0:r,a=th(n)&&n.length>0?n:G1e();return e.exception.values[0].stacktrace.frames.length===0&&e.exception.values[0].stacktrace.frames.push({colno:s,filename:a,function:"?",in_app:!0,lineno:o}),e},t.id="GlobalHandlers",t}(),t0e=["EventTarget","Window","Node","ApplicationCache","AudioTrackList","ChannelMergerNode","CryptoOperation","EventSource","FileReader","HTMLUnknownElement","IDBDatabase","IDBRequest","IDBTransaction","KeyOperation","MediaController","MessagePort","ModalWindow","Notification","SVGElementInstance","Screen","TextTrack","TextTrackCue","TextTrackList","WebSocket","WebSocketWorker","Worker","XMLHttpRequest","XMLHttpRequestEventTarget","XMLHttpRequestUpload"],n0e=function(){function t(e){this.name=t.id,this._options=Bt({XMLHttpRequest:!0,eventTarget:!0,requestAnimationFrame:!0,setInterval:!0,setTimeout:!0},e)}return t.prototype.setupOnce=function(){var e=Tn();if(this._options.setTimeout&&Qn(e,"setTimeout",this._wrapTimeFunction.bind(this)),this._options.setInterval&&Qn(e,"setInterval",this._wrapTimeFunction.bind(this)),this._options.requestAnimationFrame&&Qn(e,"requestAnimationFrame",this._wrapRAF.bind(this)),this._options.XMLHttpRequest&&"XMLHttpRequest"in e&&Qn(XMLHttpRequest.prototype,"send",this._wrapXHR.bind(this)),this._options.eventTarget){var n=Array.isArray(this._options.eventTarget)?this._options.eventTarget:t0e;n.forEach(this._wrapEventTarget.bind(this))}},t.prototype._wrapTimeFunction=function(e){return function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];var i=n[0];return n[0]=zu(i,{mechanism:{data:{function:Ia(e)},handled:!0,type:"instrument"}}),e.apply(this,n)}},t.prototype._wrapRAF=function(e){return function(n){return e.call(this,zu(n,{mechanism:{data:{function:"requestAnimationFrame",handler:Ia(e)},handled:!0,type:"instrument"}}))}},t.prototype._wrapEventTarget=function(e){var n=Tn(),r=n[e]&&n[e].prototype;!r||!r.hasOwnProperty||!r.hasOwnProperty("addEventListener")||(Qn(r,"addEventListener",function(i){return function(s,o,a){try{typeof o.handleEvent=="function"&&(o.handleEvent=zu(o.handleEvent.bind(o),{mechanism:{data:{function:"handleEvent",handler:Ia(o),target:e},handled:!0,type:"instrument"}}))}catch{}return i.call(this,s,zu(o,{mechanism:{data:{function:"addEventListener",handler:Ia(o),target:e},handled:!0,type:"instrument"}}),a)}}),Qn(r,"removeEventListener",function(i){return function(s,o,a){var l,c=o;try{var u=(l=c)===null||l===void 0?void 0:l.__sentry_wrapped__;u&&i.call(this,s,u,a)}catch{}return i.call(this,s,c,a)}}))},t.prototype._wrapXHR=function(e){return function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];var i=this,s=["onload","onerror","onprogress","onreadystatechange"];return s.forEach(function(o){o in i&&typeof i[o]=="function"&&Qn(i,o,function(a){var l={mechanism:{data:{function:o,handler:Ia(a)},handled:!0,type:"instrument"}};return a.__sentry_original__&&(l.mechanism.data.handler=Ia(a.__sentry_original__)),zu(a,l)})}),e.apply(this,n)}},t.id="TryCatch",t}(),N$=function(){function t(e){this.name=t.id,this._options=Bt({console:!0,dom:!0,fetch:!0,history:!0,sentry:!0,xhr:!0},e)}return t.prototype.addSentryBreadcrumb=function(e){this._options.sentry&&dr().addBreadcrumb({category:"sentry."+(e.type==="transaction"?"transaction":"event"),event_id:e.event_id,level:e.level,message:nc(e)},{event:e})},t.prototype.setupOnce=function(){var e=this;this._options.console&&Da({callback:function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];e._consoleBreadcrumb.apply(e,ac(n))},type:"console"}),this._options.dom&&Da({callback:function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];e._domBreadcrumb.apply(e,ac(n))},type:"dom"}),this._options.xhr&&Da({callback:function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];e._xhrBreadcrumb.apply(e,ac(n))},type:"xhr"}),this._options.fetch&&Da({callback:function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];e._fetchBreadcrumb.apply(e,ac(n))},type:"fetch"}),this._options.history&&Da({callback:function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];e._historyBreadcrumb.apply(e,ac(n))},type:"history"})},t.prototype._consoleBreadcrumb=function(e){var n={category:"console",data:{arguments:e.args,logger:"console"},level:xs.fromString(e.level),message:sv(e.args," ")};if(e.level==="assert")if(e.args[0]===!1)n.message="Assertion failed: "+(sv(e.args.slice(1)," ")||"console.assert"),n.data.arguments=e.args.slice(1);else return;dr().addBreadcrumb(n,{input:e.args,level:e.level})},t.prototype._domBreadcrumb=function(e){var n;try{n=e.event.target?iv(e.event.target):iv(e.event)}catch{n="<unknown>"}n.length!==0&&dr().addBreadcrumb({category:"ui."+e.name,message:n},{event:e.event,name:e.name,global:e.global})},t.prototype._xhrBreadcrumb=function(e){if(e.endTimestamp){if(e.xhr.__sentry_own_request__)return;var n=e.xhr.__sentry_xhr__||{},r=n.method,i=n.url,s=n.status_code,o=n.body;dr().addBreadcrumb({category:"xhr",data:{method:r,url:i,status_code:s},type:"http"},{xhr:e.xhr,input:o});return}},t.prototype._fetchBreadcrumb=function(e){e.endTimestamp&&(e.fetchData.url.match(/sentry_key/)&&e.fetchData.method==="POST"||(e.error?dr().addBreadcrumb({category:"fetch",data:e.fetchData,level:xs.Error,type:"http"},{data:e.error,input:e.args}):dr().addBreadcrumb({category:"fetch",data:Bt(Bt({},e.fetchData),{status_code:e.response.status}),type:"http"},{input:e.args,response:e.response})))},t.prototype._historyBreadcrumb=function(e){var n=Tn(),r=e.from,i=e.to,s=cE(n.location.href),o=cE(r),a=cE(i);o.path||(o=s),s.protocol===a.protocol&&s.host===a.host&&(i=a.relative),s.protocol===o.protocol&&s.host===o.host&&(r=o.relative),dr().addBreadcrumb({category:"navigation",data:{from:r,to:i}})},t.id="Breadcrumbs",t}(),r0e="cause",i0e=5,s0e=function(){function t(e){e===void 0&&(e={}),this.name=t.id,this._key=e.key||r0e,this._limit=e.limit||i0e}return t.prototype.setupOnce=function(){O2(function(e,n){var r=dr().getIntegration(t);return r?r._handler(e,n):e})},t.prototype._handler=function(e,n){if(!e.exception||!e.exception.values||!n||!Sl(n.originalException,Error))return e;var r=this._walkErrorTree(n.originalException,this._key);return e.exception.values=ac(r,e.exception.values),e},t.prototype._walkErrorTree=function(e,n,r){if(r===void 0&&(r=[]),!Sl(e[n],Error)||r.length+1>=this._limit)return r;var i=wm(e[n]),s=O$(i);return this._walkErrorTree(e[n],n,ac([s],r))},t.id="LinkedErrors",t}(),Pu=Tn(),o0e=function(){function t(){this.name=t.id}return t.prototype.setupOnce=function(){O2(function(e){var n,r,i;if(dr().getIntegration(t)){if(!Pu.navigator&&!Pu.location&&!Pu.document)return e;var s=((n=e.request)===null||n===void 0?void 0:n.url)||((r=Pu.location)===null||r===void 0?void 0:r.href),o=(Pu.document||{}).referrer,a=(Pu.navigator||{}).userAgent,l=Bt(Bt(Bt({},(i=e.request)===null||i===void 0?void 0:i.headers),o&&{Referer:o}),a&&{"User-Agent":a}),c=Bt(Bt({},s&&{url:s}),{headers:l});return Bt(Bt({},e),{request:c})}return e})},t.id="UserAgent",t}(),a0e=function(t){L2(e,t);function e(n){n===void 0&&(n={});var r=this;return n._metadata=n._metadata||{},n._metadata.sdk=n._metadata.sdk||{name:"sentry.javascript.browser",packages:[{name:"npm:@sentry/browser",version:LM}],version:LM},r=t.call(this,qge,n)||this,r}return e.prototype.showReportDialog=function(n){n===void 0&&(n={});var r=Tn().document;if(r){if(!this._isEnabled()){St.error("Trying to call showReportDialog with Sentry Client disabled");return}Qge(Bt(Bt({},n),{dsn:n.dsn||this.getDsn()}))}},e.prototype._prepareEvent=function(n,r,i){return n.platform=n.platform||"javascript",t.prototype._prepareEvent.call(this,n,r,i)},e.prototype._sendEvent=function(n){var r=this.getIntegration(N$);r&&r.addSentryBreadcrumb(n),t.prototype._sendEvent.call(this,n)},e}(Ige),l0e=[new Oge,new Lge,new n0e,new N$,new e0e,new s0e,new o0e];function c0e(t){if(t===void 0&&(t={}),t.defaultIntegrations===void 0&&(t.defaultIntegrations=l0e),t.release===void 0){var e=Tn();e.SENTRY_RELEASE&&e.SENTRY_RELEASE.id&&(t.release=e.SENTRY_RELEASE.id)}t.autoSessionTracking===void 0&&(t.autoSessionTracking=!0),Pge(a0e,t),t.autoSessionTracking&&u0e()}function u0e(){var t=Tn(),e=t.document;if(typeof e>"u"){St.warn("Session tracking in non-browser environment with @sentry/browser is not supported.");return}var n=dr();"startSession"in n&&(n.startSession(),n.captureSession(),Da({callback:function(){n.startSession(),n.captureSession()},type:"history"}))}class d0e extends ce.Component{constructor(){super(...arguments);O(this,"state",{hasError:!1,sentryEventId:"",localStorage:""})}render(){return this.state.hasError?this.errorSplash():this.props.children}componentDidCatch(n,r){const i={};for(const[s,o]of Object.entries({...localStorage}))try{i[s]=JSON.parse(o)}catch{i[s]=o}k$(s=>{s.setExtras(r);const o=A$(n);this.setState(a=>({hasError:!0,sentryEventId:o,localStorage:JSON.stringify(i)}))})}selectTextArea(n){n.target!==document.activeElement&&(n.preventDefault(),n.target.select())}async createGithubIssue(){let n="";try{const r=(await pe(()=>import("./bug-issue-template-RzHCT2ur.js"),__vite__mapDeps([]))).default;n=encodeURIComponent(r(this.state.sentryEventId))}catch(r){console.error(r)}window.open(`https://github.com/excalidraw/excalidraw/issues/new?body=${n}`)}errorSplash(){return g("div",{className:"ErrorSplash excalidraw",children:M("div",{className:"ErrorSplash-messageContainer",children:[g("div",{className:"ErrorSplash-paragraph bigger align-center",children:g(Vr,{i18nKey:"errorSplash.headingMain",button:n=>g("button",{onClick:()=>window.location.reload(),children:n})})}),M("div",{className:"ErrorSplash-paragraph align-center",children:[g(Vr,{i18nKey:"errorSplash.clearCanvasMessage",button:n=>g("button",{onClick:()=>{try{localStorage.clear(),window.location.reload()}catch(r){console.error(r)}},children:n})}),g("br",{}),M("div",{className:"smaller",children:[g("span",{role:"img","aria-label":"warning",children:"⚠️"}),I("errorSplash.clearCanvasCaveat"),g("span",{role:"img","aria-hidden":"true",children:"⚠️"})]})]}),M("div",{children:[g("div",{className:"ErrorSplash-paragraph",children:I("errorSplash.trackedToSentry",{eventId:this.state.sentryEventId})}),g("div",{className:"ErrorSplash-paragraph",children:g(Vr,{i18nKey:"errorSplash.openIssueMessage",button:n=>g("button",{onClick:()=>this.createGithubIssue(),children:n})})}),g("div",{className:"ErrorSplash-paragraph",children:M("div",{className:"ErrorSplash-details",children:[g("label",{children:I("errorSplash.sceneContent")}),g("textarea",{rows:5,onPointerDown:this.selectTextArea,readOnly:!0,value:this.state.localStorage})]})})]})]})})}}const h0e=300,f0e=5e3,p0e=300,m0e=500,FM=2e4,g0e=50,y0e=33,v0e=24*60*60*1e3,n6=3*1024*1024,b0e=31536e3,_0={SERVER_VOLATILE:"server-volatile-broadcast",SERVER:"server-broadcast",USER_FOLLOW_CHANGE:"user-follow",USER_FOLLOW_ROOM_CHANGE:"user-follow-room-change"};var Ir=(t=>(t.INVALID_RESPONSE="INVALID_RESPONSE",t.INIT="SCENE_INIT",t.UPDATE="SCENE_UPDATE",t.MOUSE_LOCATION="MOUSE_LOCATION",t.IDLE_STATUS="IDLE_STATUS",t.USER_VISIBLE_SCENE_BOUNDS="USER_VISIBLE_SCENE_BOUNDS",t))(Ir||{});const F$={shareLinkFiles:"/files/shareLinks",collabFiles:"/files/rooms"},_0e=10,pn={LOCAL_STORAGE_ELEMENTS:"excalidraw",LOCAL_STORAGE_APP_STATE:"excalidraw-state",LOCAL_STORAGE_COLLAB:"excalidraw-collab",LOCAL_STORAGE_LIBRARY:"excalidraw-library",LOCAL_STORAGE_THEME:"excalidraw-theme",VERSION_DATA_STATE:"version-dataState",VERSION_FILES:"version-files"},E0e={AUTH_STATE_COOKIE:"excplus-auth"},lv=document.cookie.includes(E0e.AUTH_STATE_COOKIE);class B${constructor({getFiles:e,saveFiles:n}){O(this,"fetchingFiles",new Map);O(this,"savingFiles",new Map);O(this,"savedFiles",new Map);O(this,"erroredFiles",new Map);O(this,"_getFiles");O(this,"_saveFiles");O(this,"isFileHandled",e=>this.savedFiles.has(e)||this.fetchingFiles.has(e)||this.savingFiles.has(e)||this.erroredFiles.has(e));O(this,"isFileSaved",e=>this.savedFiles.has(e));O(this,"saveFiles",async({elements:e,files:n})=>{const r=new Map;for(const i of e)En(i)&&n[i.fileId]&&!this.isFileHandled(i.fileId)&&(r.set(i.fileId,n[i.fileId]),this.savingFiles.set(i.fileId,!0));try{const{savedFiles:i,erroredFiles:s}=await this._saveFiles({addedFiles:r});for(const[o]of i)this.savedFiles.set(o,!0);return{savedFiles:i,erroredFiles:s}}finally{for(const[i]of r)this.savingFiles.delete(i)}});O(this,"getFiles",async e=>{if(!e.length)return{loadedFiles:[],erroredFiles:new Map};for(const n of e)this.fetchingFiles.set(n,!0);try{const{loadedFiles:n,erroredFiles:r}=await this._getFiles(e);for(const i of n)this.savedFiles.set(i.id,!0);for(const[i]of r)this.erroredFiles.set(i,!0);return{loadedFiles:n,erroredFiles:r}}finally{for(const n of e)this.fetchingFiles.delete(n)}});O(this,"shouldPreventUnload",e=>e.some(n=>En(n)&&!n.isDeleted&&this.savingFiles.has(n.fileId)));O(this,"shouldUpdateImageElementStatus",e=>En(e)&&this.isFileSaved(e.fileId)&&e.status==="pending");this._getFiles=e,this._saveFiles=n}reset(){this.fetchingFiles.clear(),this.savingFiles.clear(),this.savedFiles.clear(),this.erroredFiles.clear()}}const r6=async({files:t,maxBytes:e,encryptionKey:n})=>{const r=[];for(const[i,s]of t){const o=new TextEncoder().encode(s.dataURL),a=await XF(o,{encryptionKey:n,metadata:{id:i,mimeType:s.mimeType,created:Date.now(),lastRetrieved:Date.now()}});if(o.byteLength>e)throw new Error(I("errors.fileTooBig",{maxSize:`${Math.trunc(e/1024/1024)}MB`}));r.push({id:i,buffer:a})}return r},Of=t=>{t.erroredFiles.size&&t.excalidrawAPI.updateScene({elements:t.excalidrawAPI.getSceneElementsIncludingDeleted().map(e=>En(e)&&t.erroredFiles.has(e.fileId)?Re(e,{status:"error"}):e)})},w0e=(t,e,n)=>{var r,i,s;return!!(e&&(e.id===((r=t.editingElement)==null?void 0:r.id)||e.id===((i=t.resizingElement)==null?void 0:i.id)||e.id===((s=t.draggingElement)==null?void 0:s.id)||e.version>n.version||e.version===n.version&&e.versionNonce<n.versionNonce))},i6=(t,e,n)=>{var u;const r=hR(t),i=t.slice(),s=new WeakMap;let o=0,a=0,l=-1;for(const d of e){l++;const h=r.get(d.id);if(w0e(n,h==null?void 0:h[0],d)){d[Ua]&&delete d[Ua];continue}if(h){if(h[0]===d)continue;s.set(h[0],!0)}const f=d[Ua]||((u=e[l-1])==null?void 0:u.id)||null;if(f!=null)if(delete d[Ua],f==="^")a++,o===0?(i.unshift(d),r.set(d.id,[d,o-a])):(i.splice(o+1,0,d),r.set(d.id,[d,o+1-a]),o++);else{let p=r.has(f)?r.get(f)[1]:null;p!=null&&(p+=a),p!=null&&p>=o?(i.splice(p+1,0,d),a++,r.set(d.id,[d,p+1-a]),o=p+1):p!=null?(i.splice(o+1,0,d),a++,r.set(d.id,[d,o+1-a]),o++):(i.push(d),r.set(d.id,[d,i.length-1-a]))}else h?(i[h[1]]=d,r.set(d.id,[d,h[1]])):(i.push(d),r.set(d.id,[d,i.length-1-a]))}return i.filter(d=>!s.has(d))};let cv;try{cv=JSON.parse('{"apiKey":"AIzaSyAd15pYlMci_xIp9ko6wkEsDzAAA0Dn0RU","authDomain":"excalidraw-room-persistence.firebaseapp.com","databaseURL":"https://excalidraw-room-persistence.firebaseio.com","projectId":"excalidraw-room-persistence","storageBucket":"excalidraw-room-persistence.appspot.com","messagingSenderId":"654800341332","appId":"1:654800341332:web:4a692de832b55bd57ce0c1"}')}catch{console.warn('Error JSON parsing firebase config. Supplied value: {"apiKey":"AIzaSyAd15pYlMci_xIp9ko6wkEsDzAAA0Dn0RU","authDomain":"excalidraw-room-persistence.firebaseapp.com","databaseURL":"https://excalidraw-room-persistence.firebaseio.com","projectId":"excalidraw-room-persistence","storageBucket":"excalidraw-room-persistence.appspot.com","messagingSenderId":"654800341332","appId":"1:654800341332:web:4a692de832b55bd57ce0c1"}'),cv={}}let mE=null,df=null,hf=null,BM=!1;const x0e=async()=>{const t=(await pe(()=>import("./index.esm-whGSL8KN.js"),__vite__mapDeps([2,3]))).default;if(!BM){try{t.initializeApp(cv)}catch(e){if(e.code==="app/duplicate-app")console.warn(e.name,e.code);else throw e}BM=!0}return t},U$=async()=>(mE||(mE=x0e()),mE),$$=async()=>{const t=await U$();return df||(df=pe(()=>import("./index.esm-R4Xo_FiR.js"),__vite__mapDeps([4,3]))),df!==!0&&(await df,df=!0),t},H$=async()=>{const t=await U$();return hf||(hf=pe(()=>import("./index.esm-0MBOLK1W.js"),__vite__mapDeps([5,3]))),hf!==!0&&(await hf,hf=!0),t},T0e=async(t,e)=>{const n=JSON.stringify(e),r=new TextEncoder().encode(n),{encryptedBuffer:i,iv:s}=await v2(t,r);return{ciphertext:i,iv:s}},z$=async(t,e)=>{const n=t.ciphertext.toUint8Array(),r=t.iv.toUint8Array(),i=await dm(r,n,e),s=new TextDecoder("utf-8").decode(new Uint8Array(i));return JSON.parse(s)},uc=class uc{};O(uc,"cache",new WeakMap),O(uc,"get",e=>uc.cache.get(e)),O(uc,"set",(e,n)=>{uc.cache.set(e,Oa(n))});let xm=uc;const G$=(t,e)=>{if(t.socket&&t.roomId&&t.roomKey){const n=Oa(e);return xm.get(t.socket)===n}return!0},s6=async({prefix:t,files:e})=>{const n=await H$(),r=new Map,i=new Map;return await Promise.all(e.map(async({id:s,buffer:o})=>{try{await n.storage().ref(`${t}/${s}`).put(new Blob([o],{type:Oe.binary}),{cacheControl:`public, max-age=${b0e}`}),i.set(s,!0)}catch{r.set(s,!0)}})),{savedFiles:i,erroredFiles:r}},UM=async(t,e,n)=>{const r=Oa(e),{ciphertext:i,iv:s}=await T0e(n,e);return{sceneVersion:r,ciphertext:t.firestore.Blob.fromUint8Array(new Uint8Array(i)),iv:t.firestore.Blob.fromUint8Array(s)}},S0e=async(t,e,n)=>{const{roomId:r,roomKey:i,socket:s}=t;if(!r||!i||!s||G$(t,e))return!1;const o=await $$(),a=o.firestore(),l=a.collection("scenes").doc(r),c=await a.runTransaction(async u=>{const d=await u.get(l);if(!d.exists){const v=await UM(o,e,i);return u.set(l,v),{elements:e,reconciledElements:null}}const h=d.data(),f=Cc(await z$(h,i)),p=Cc(i6(e,f,n)),m=await UM(o,p,i);return u.update(l,m),{elements:e,reconciledElements:p}});return xm.set(s,c.elements),{reconciledElements:c.reconciledElements}},C0e=async(t,e,n)=>{const o=await(await $$()).firestore().collection("scenes").doc(t).get();if(!o.exists)return null;const a=o.data(),l=Cc(await z$(a,e));return n&&xm.set(n,l),Ym(l,null)},V$=async(t,e,n)=>{const r=[],i=new Map;return await Promise.all([...new Set(n)].map(async s=>{try{const o=`https://firebasestorage.googleapis.com/v0/b/${cv.storageBucket}/o/${encodeURIComponent(t.replace(/^\//,""))}%2F${s}`,a=await fetch(`${o}?alt=media`);if(a.status<400){const l=await a.arrayBuffer(),{data:c,metadata:u}=await YF(new Uint8Array(l),{decryptionKey:e}),d=new TextDecoder().decode(c);r.push({mimeType:u.mimeType||Oe.binary,id:s,dataURL:d,created:(u==null?void 0:u.created)||Date.now(),lastRetrieved:(u==null?void 0:u.created)||Date.now()})}else i.set(s,!0)}catch(o){i.set(s,!0),console.error(o)}})),{loadedFiles:r,erroredFiles:i}},W$=t=>t.isDeleted?t.updated>Date.now()-v0e:!su(t),Cc=t=>t.filter(e=>W$(e)),I0e="https://json.excalidraw.com/api/v2/",A0e="https://json.excalidraw.com/api/v2/post/",k0e=async()=>{const t=new Uint8Array(_0e);return window.crypto.getRandomValues(t),dR(t)},M0e=async()=>{try{return await(await fetch("https://portal.excalidraw.com/collab-server")).json()}catch(t){throw console.error(t),new Error(I("errors.cannotResolveCollabServer"))}},j$=/^#room=([a-zA-Z0-9_-]+),([a-zA-Z0-9_-]+)$/,$M=t=>{const e=new URL(t).hash;return j$.test(e)},P0e=t=>{const n=new URL(t).hash.match(j$);return n&&n[2].length!==22?(window.alert(I("alerts.invalidEncryptionKey")),null):n?{roomId:n[1],roomKey:n[2]}:null},L0e=async()=>{const t=await k0e(),e=await o4();if(!e)throw new Error("Couldn't generate room key");return{roomId:t,roomKey:e}},R0e=t=>`${window.location.origin}${window.location.pathname}#room=${t.roomId},${t.roomKey}`,O0e=async({buffer:t,decryptionKey:e})=>{let n;try{const s=t.slice(0,f0),o=t.slice(f0,t.byteLength);n=await dm(new Uint8Array(s),o,e)}catch{const o=new Uint8Array(f0);n=await dm(o,t,e)}const r=new window.TextDecoder("utf-8").decode(new Uint8Array(n)),i=JSON.parse(r);return{elements:i.elements||null,appState:i.appState||null}},D0e=async(t,e)=>{try{const n=await fetch(`${I0e}${t}`);if(!n.ok)return window.alert(I("alerts.importBackendFailed")),{};const r=await n.arrayBuffer();try{const{data:i}=await YF(new Uint8Array(r),{decryptionKey:e}),s=JSON.parse(new TextDecoder().decode(i));return{elements:s.elements||null,appState:s.appState||null}}catch(i){return console.warn("error when decoding shareLink data using the new format:",i),O0e({buffer:r,decryptionKey:e})}}catch(n){return window.alert(I("alerts.importBackendFailed")),console.error(n),{}}},HM=async(t,e,n)=>{let r;return t!=null&&e!=null?r=Jc(await D0e(t,e),n==null?void 0:n.appState,n==null?void 0:n.elements,{repairBindings:!0,refreshDimensions:!1}):r=Jc(n||null,null,null,{repairBindings:!0}),{elements:r.elements,appState:r.appState,files:r.files,commitToHistory:!1}},N0e=async(t,e,n)=>{const r=await o4("string"),i=await XF(new TextEncoder().encode(vh(t,e,n,"database")),{encryptionKey:r});try{const s=new Map;for(const c of t)En(c)&&n[c.fileId]&&s.set(c.fileId,n[c.fileId]);const o=await r6({files:s,encryptionKey:r,maxBytes:n6}),l=await(await fetch(A0e,{method:"POST",body:i.buffer})).json();if(l.id){const c=new URL(window.location.href);c.hash=`json=${l.id},${r}`;const u=c.toString();return await s6({prefix:`/files/shareLinks/${l.id}`,files:o}),{url:u,errorMessage:null}}else if(l.error_class==="RequestTooLargeError")return{url:null,errorMessage:I("alerts.couldNotCreateShareableLinkTooBig")};return{url:null,errorMessage:I("alerts.couldNotCreateShareableLink")}}catch(s){return console.error(s),{url:null,errorMessage:I("alerts.couldNotCreateShareableLink")}}},F0e=t=>{try{localStorage.setItem(pn.LOCAL_STORAGE_COLLAB,JSON.stringify({username:t}))}catch(e){console.error(e)}},X$=()=>{try{const t=localStorage.getItem(pn.LOCAL_STORAGE_COLLAB);if(t)return JSON.parse(t).username}catch(t){console.error(t)}return null},A3=()=>{let t=null,e=null;try{t=localStorage.getItem(pn.LOCAL_STORAGE_ELEMENTS),e=localStorage.getItem(pn.LOCAL_STORAGE_APP_STATE)}catch(i){console.error(i)}let n=[];if(t)try{n=CB(JSON.parse(t))}catch(i){console.error(i)}let r=null;if(e)try{r={...Es(),...mR(JSON.parse(e))}}catch(i){console.error(i)}return{elements:n,appState:r}},Y$=()=>{try{const t=localStorage.getItem(pn.LOCAL_STORAGE_ELEMENTS);return(t==null?void 0:t.length)||0}catch(t){return console.error(t),0}},B0e=()=>{try{const t=localStorage.getItem(pn.LOCAL_STORAGE_APP_STATE),e=localStorage.getItem(pn.LOCAL_STORAGE_COLLAB),n=localStorage.getItem(pn.LOCAL_STORAGE_LIBRARY),r=(t==null?void 0:t.length)||0,i=(e==null?void 0:e.length)||0,s=(n==null?void 0:n.length)||0;return r+i+s+Y$()}catch(t){return console.error(t),0}},zM=()=>{try{return JSON.parse(localStorage.getItem(pn.LOCAL_STORAGE_LIBRARY))||[]}catch(t){return console.error(t),[]}};class U0e{constructor(e){O(this,"collab");O(this,"socket",null);O(this,"socketInitialized",!1);O(this,"roomId",null);O(this,"roomKey",null);O(this,"broadcastedElementVersions",new Map);O(this,"queueFileUpload",Tc(async()=>{try{await this.collab.fileManager.saveFiles({elements:this.collab.excalidrawAPI.getSceneElementsIncludingDeleted(),files:this.collab.excalidrawAPI.getFiles()})}catch(e){e.name!=="AbortError"&&this.collab.excalidrawAPI.updateScene({appState:{errorMessage:e.message}})}this.collab.excalidrawAPI.updateScene({elements:this.collab.excalidrawAPI.getSceneElementsIncludingDeleted().map(e=>this.collab.fileManager.shouldUpdateImageElementStatus(e)?Re(e,{status:"saved"}):e)})},p0e));O(this,"broadcastScene",async(e,n,r)=>{if(e===Ir.INIT&&!r)throw new Error("syncAll must be true when sending SCENE.INIT");const i=n.reduce((o,a,l,c)=>{var u;return(r||!this.broadcastedElementVersions.has(a.id)||a.version>this.broadcastedElementVersions.get(a.id))&&W$(a)&&o.push({...a,[Ua]:l===0?"^":(u=c[l-1])==null?void 0:u.id}),o},[]),s={type:e,payload:{elements:i}};for(const o of i)this.broadcastedElementVersions.set(o.id,o.version);this.queueFileUpload(),await this._broadcastSocketData(s)});O(this,"broadcastIdleChange",e=>{var n;if((n=this.socket)!=null&&n.id){const r={type:Ir.IDLE_STATUS,payload:{socketId:this.socket.id,userState:e,username:this.collab.state.username}};return this._broadcastSocketData(r,!0)}});O(this,"broadcastMouseLocation",e=>{var n;if((n=this.socket)!=null&&n.id){const r={type:Ir.MOUSE_LOCATION,payload:{socketId:this.socket.id,pointer:e.pointer,button:e.button||"up",selectedElementIds:this.collab.excalidrawAPI.getAppState().selectedElementIds,username:this.collab.state.username}};return this._broadcastSocketData(r,!0)}});O(this,"broadcastVisibleSceneBounds",(e,n)=>{var r;if((r=this.socket)!=null&&r.id){const i={type:Ir.USER_VISIBLE_SCENE_BOUNDS,payload:{socketId:this.socket.id,username:this.collab.state.username,sceneBounds:e.sceneBounds}};return this._broadcastSocketData(i,!0,n)}});O(this,"broadcastUserFollowed",e=>{var n;(n=this.socket)!=null&&n.id&&this.socket.emit(_0.USER_FOLLOW_CHANGE,e)});this.collab=e}open(e,n,r){return this.socket=e,this.roomId=n,this.roomKey=r,this.socket.on("init-room",()=>{this.socket&&(this.socket.emit("join-room",this.roomId),at("share","room joined"))}),this.socket.on("new-user",async i=>{this.broadcastScene(Ir.INIT,this.collab.getSceneElementsIncludingDeleted(),!0)}),this.socket.on("room-user-change",i=>{this.collab.setCollaborators(i)}),e}close(){this.socket&&(this.queueFileUpload.flush(),this.socket.close(),this.socket=null,this.roomId=null,this.roomKey=null,this.socketInitialized=!1,this.broadcastedElementVersions=new Map)}isOpen(){return!!(this.socketInitialized&&this.socket&&this.roomId&&this.roomKey)}async _broadcastSocketData(e,n=!1,r){var i;if(this.isOpen()){const s=JSON.stringify(e),o=new TextEncoder().encode(s),{encryptedBuffer:a,iv:l}=await v2(this.roomKey,o);(i=this.socket)==null||i.emit(n?_0.SERVER_VOLATILE:_0.SERVER,r??this.roomId,a,l)}}}const $0e=t=>A.createElement("svg",{width:178,height:162,viewBox:"0 0 178 162",fill:"none",xmlns:"http://www.w3.org/2000/svg",...t},A.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M40.3329 54.3823L38.5547 94.3134L39.7731 111.754L40.1282 118.907L41.0832 123.59L44.3502 131.942L48.9438 137.693L52.5472 143.333L58.5544 147.755L62.5364 150.239L72.3634 154.486L83.15 156.361L91.1212 158.708L101.174 157.525L110.808 156.719L115.983 154.049L124.511 151.377L129.276 148.71L133.701 143.947L139.666 135.877L142.001 128.136L145.746 118.192L145.188 111.065L145.489 94.3675L145.873 75.2546L143.227 59.7779L142.022 47.4695L138.595 46.8345L102.952 45.4703L56.9173 46.7498L46.0719 49.1207L41.9323 50.6825L39.5684 53.4297",fill:"#E3E2FE"}),A.createElement("path",{d:"M41.0014 54.2859C41.0861 64.8796 38.3765 102.581 40.9779 117.876C43.5793 133.17 48.2646 139.346 56.6121 146.047C64.9596 152.746 79.1214 157.662 91.0653 158.078C103.009 158.492 119.347 155.242 128.277 148.543C137.206 141.842 142.112 133.527 144.641 117.874C147.169 102.221 146.061 66.4132 143.446 54.6222C140.83 42.8289 143.97 48.2857 128.948 47.1238C113.925 45.9619 67.9608 46.477 53.3051 47.6483C38.6493 48.8197 43.2053 53.0675 41.0155 54.1518M40.5263 53.9801C40.5404 64.6138 37.9249 103.418 40.5921 118.587C43.257 133.755 48.147 138.325 56.5251 144.991C64.9008 151.655 78.7263 157.935 90.8536 158.577C102.981 159.221 120.212 155.413 129.289 148.844C138.368 142.277 142.872 134.995 145.321 119.168C147.767 103.343 146.805 65.8698 143.977 53.8837C141.148 41.8975 143.615 48.4292 128.348 47.2508C113.081 46.0724 67.14 45.6726 52.3737 46.8157C37.6074 47.9564 41.7776 53.091 39.7524 54.1024",stroke:"#6965DB",strokeWidth:2,strokeLinecap:"round"}),A.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M64.7935 45.726L66.36 36.6964L65.5979 34.4501L67.3384 30.7668L70.4197 26.5048L74.8157 21.0598L81.9095 16.9131L89.9419 14.4951L95.6127 12.8534L97.7555 13.2133L103.819 15.269L106.552 18.5807L109.967 22.3793L114.45 27.2387L114.904 34.3937L117.153 38.9214L116.031 44.5005L116.765 45.5448L118.863 47.3559L126.164 47.6782L127.744 46.7797L128.76 44.7052L123.882 25.8227L120.641 20.4835L116.351 15.8758L112.809 11.0729L108.617 7.36601L101.352 5.43025L93.263 3.31104L84.2451 5.1433L77.7299 7.86229L76.0011 8.0975L62.1168 19.8532L59.5366 24.5597L55.7733 32.3215L55.0371 39.5282L56.0626 44.8933L56.5636 47.1725L59.6401 46.8644L66.1648 46.0388",fill:"#E3E2FE"}),A.createElement("path",{d:"M65.0037 46.0106C65.1166 43.8231 64.9237 36.8492 66.1421 33.2412C67.3605 29.6307 69.0799 27.2857 72.314 24.3527C75.5481 21.422 81.273 17.6093 85.5444 15.6453C89.8157 13.6813 94.3317 12.1148 97.9421 12.5664C101.555 13.0157 104.544 15.857 107.219 18.3478C109.893 20.8387 112.356 24.0869 113.986 27.5115C115.618 30.9338 116.389 35.8684 117.006 38.8861C117.622 41.9038 115.992 44.2888 117.69 45.6178C119.388 46.949 125.617 48.1721 127.195 46.8667C128.773 45.5613 127.717 41.1888 127.157 37.7877C126.597 34.3866 125.494 30.1247 123.838 26.4601C122.183 22.7956 119.746 18.9029 117.222 15.7982C114.698 12.6934 112.791 9.9086 108.696 7.83642C104.601 5.76189 97.8081 3.42863 92.6547 3.35337C87.5013 3.2781 81.5529 5.74308 77.7708 7.38717C73.991 9.03127 72.8879 10.6166 69.9666 13.218C67.043 15.8217 62.4306 19.6768 60.2384 23.0026C58.0486 26.3284 57.4818 29.252 56.8185 33.1753C56.1529 37.0962 54.6499 44.39 56.2517 46.5327C57.8511 48.6731 64.7756 45.98 66.4267 46.0247M65.9704 45.5096C65.9845 43.348 64.2652 37.5525 65.5423 33.8456C66.8172 30.1364 70.2959 26.4789 73.6264 23.259C76.9546 20.039 81.3177 16.3015 85.5208 14.5281C89.7216 12.7523 95.1079 11.7903 98.8383 12.6111C102.569 13.432 105.283 16.8072 107.903 19.4486C110.526 22.09 113.146 25.3029 114.567 28.4664C115.987 31.6276 116.03 35.4051 116.425 38.4204C116.82 41.4334 115.124 45.1426 116.937 46.5515C118.751 47.9604 125.539 48.2968 127.31 46.8761C129.081 45.4578 127.978 41.4428 127.562 38.0347C127.145 34.6265 126.501 30.1646 124.81 26.4296C123.116 22.6921 120.195 18.7594 117.413 15.6194C114.63 12.4818 112.247 9.39349 108.117 7.58945C103.987 5.78541 97.5776 5.02099 92.6335 4.79519C87.6895 4.56939 82.3503 4.78813 78.4505 6.23466C74.5484 7.68118 72.0882 10.6542 69.228 13.4696C66.3679 16.2851 63.4725 19.7873 61.2898 23.1319C59.1071 26.4789 56.9761 29.4896 56.1293 33.5469C55.285 37.6043 54.577 45.2132 56.2117 47.4759C57.8487 49.7409 64.2675 47.3418 65.9445 47.1301",stroke:"#6965DB",strokeWidth:2,strokeLinecap:"round"}),A.createElement("path",{d:"M140.37 54.8958C137.884 58.1322 127.704 71.2286 125.185 74.5427M139.697 54.209C137.098 57.5466 127.005 71.7884 124.51 75.3565",stroke:"#6965DB",strokeWidth:2,strokeLinecap:"round"}),A.createElement("path",{d:"M141.663 63.1765C139.661 66.0413 131.311 77.1501 129.077 79.9726M141.065 62.5908C139.021 65.2792 130.631 76.1364 128.717 78.8625",stroke:"#6965DB",strokeWidth:2,strokeLinecap:"round"}),A.createElement("path",{d:"M141.888 72.9917C139.475 75.8589 130.268 86.8478 127.966 89.7455M141.02 72.726C138.503 75.6496 129.775 87.2476 127.58 90.3242",stroke:"#6965DB",strokeWidth:2,strokeLinecap:"round"}),A.createElement("path",{d:"M141.948 82.215C139.815 85.1057 130.308 96.8214 127.961 99.7709M141.459 81.7375C139.298 84.4119 129.816 95.9888 127.479 98.8606",stroke:"#6965DB",strokeWidth:2,strokeLinecap:"round"}),A.createElement("path",{d:"M141.357 91.7838C138.885 95.2484 128.808 108.535 126.428 111.76M142.474 91.4757C139.917 94.7921 128.38 107.493 125.781 110.883",stroke:"#6965DB",strokeWidth:2,strokeLinecap:"round"}),A.createElement("path",{d:"M142.568 101.479C140.028 104.403 129.867 115.528 127.195 118.356M141.811 101.018C139.212 104.055 129.477 115.975 126.828 118.97",stroke:"#6965DB",strokeWidth:2,strokeLinecap:"round"}),A.createElement("path",{d:"M141.023 112.172C138.591 114.775 128.028 125.905 125.422 128.664M140.51 113.465C138.008 116.147 127.36 125.233 124.742 127.582",stroke:"#6965DB",strokeWidth:2,strokeLinecap:"round"}),A.createElement("path",{d:"M139.004 123.69C136.501 126.275 125.952 137.248 123.287 140.108M138.343 124.817C135.805 127.454 125.487 138.261 122.848 140.75",stroke:"#6965DB",strokeWidth:2,strokeLinecap:"round"}),A.createElement("path",{d:"M132.192 139.862C129.854 141.624 120.87 148.168 118.574 150.012M131.39 139.496C128.97 141.333 120.524 148.89 118.322 150.621",stroke:"#6965DB",strokeWidth:2,strokeLinecap:"round"}),A.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M82.6351 92.3124L78.2767 89.0148L78.6718 88.8784L75.6282 79.6865L74.4922 76.0525L75.0379 74.1074L78.6248 69.5444L83.6182 65.186L86.6924 64.0711L93.7768 63.9864L99.9181 63.9276L103.905 64.4215L106.038 66.068L109.333 67.6392L110.251 69.4479L112.438 73.1877L112.702 81.928L111.674 82.93L110.907 85.5573L107.828 89.2336L101.273 92.9193L102.785 120.401L99.5488 125.521L98.0059 127.838L96.1313 129.414L93.17 130.237L92.2198 130.033L90.1358 129.233L88.8328 126.594L87.8378 95.2549L88.9386 93.3215L86.0409 91.294L80.9533 91.1552",fill:"white"}),A.createElement("path",{d:"M82.8214 92.0607C82.0664 91.4327 79.291 90.7201 77.8539 88.2033C76.4167 85.6866 73.5284 80.4438 74.1964 76.9581C74.862 73.4723 78.6959 69.6384 81.8524 67.2887C85.0089 64.939 88.9227 63.1138 93.1353 62.8574C97.3478 62.6034 103.957 63.9888 107.132 65.7575C110.31 67.5263 111.416 70.5651 112.196 73.4747C112.977 76.3842 112.606 80.6626 111.82 83.2122C111.035 85.7642 109.078 87.1661 107.481 88.7749C105.883 90.3837 103.106 91.2751 102.233 92.8651C101.363 94.4551 102.327 95.3254 102.25 98.3125C102.172 101.3 101.76 107.227 101.767 110.788C101.772 114.349 102.487 116.981 102.285 119.676C102.085 122.374 101.52 125.126 100.556 126.965C99.5917 128.805 98.077 130.256 96.5011 130.715C94.9275 131.171 92.4485 130.36 91.1101 129.713C89.7742 129.066 89.0144 128.341 88.4805 126.836C87.9489 125.331 87.9678 123.964 87.9137 120.681C87.8596 117.397 88.1159 111.599 88.1583 107.14C88.203 102.68 89.2779 96.445 88.1724 93.9236C87.0693 91.4022 82.7791 92.4347 81.5325 92.0137M82.0194 91.6068C81.222 90.7624 78.4536 89.7886 77.3623 87.1567C76.2733 84.5247 74.6621 79.3125 75.4783 75.815C76.2921 72.3151 79.1428 68.3166 82.2522 66.1597C85.3617 64.0029 90.1693 63.062 94.1302 62.8739C98.0911 62.6857 102.925 63.0832 106.02 65.0331C109.118 66.9853 111.834 71.5836 112.705 74.5801C113.572 77.5743 111.949 80.7731 111.234 83.0076C110.519 85.2444 109.835 86.3711 108.417 87.9916C107.001 89.6146 103.738 90.9623 102.732 92.7358C101.725 94.5092 102.351 95.6382 102.377 98.6301C102.405 101.62 102.866 106.949 102.894 110.682C102.922 114.417 102.955 118.291 102.544 121.038C102.13 123.783 101.408 125.54 100.42 127.161C99.4318 128.781 98.1005 130.233 96.6163 130.759C95.1322 131.286 92.9353 130.893 91.51 130.322C90.0846 129.753 88.7769 128.889 88.0618 127.335C87.3468 125.78 87.0128 124.317 87.2198 120.998C87.4268 117.68 89.0874 112.046 89.299 107.422C89.5107 102.798 89.8494 95.9322 88.4946 93.2509C87.1398 90.5695 82.4804 91.4845 81.1679 91.3316",stroke:"#6965DB",strokeWidth:2,strokeLinecap:"round"}),A.createElement("path",{d:"M28.1943 139.31C26.7936 139.432 25.332 140.402 23.8703 140.523C23.1395 140.766 22.5914 140.16 21.9824 139.735C21.5561 139.553 21.008 138.461 20.8253 138.219C20.5817 136.884 19.9118 134.276 20.0336 133.002C19.7291 131.364 21.5561 129.787 23.0786 129.727C23.2613 129.727 23.8094 129.787 23.8703 129.787C25.7583 130.151 27.5853 131.546 29.5341 131.728C29.595 131.728 29.6559 131.728 29.6559 131.668C30.4476 130.333 30.204 126.937 30.813 125.542C30.813 125.36 31.1784 123.54 31.1784 123.237C31.6048 122.327 32.1529 121.781 33.1273 122.084C33.7972 122.266 34.6498 122.388 34.6498 123.237V128.635C34.8325 129.242 36.1114 128.999 36.5986 128.999C38.7911 128.028 40.8617 127.422 43.3586 127.058C45.6729 127.179 46.7082 129.242 46.5864 131.304C46.6473 132.396 45.4293 133.245 44.6985 133.973C44.4549 134.094 43.4804 134.519 43.115 134.397C42.2624 133.791 41.1662 134.033 40.1309 134.094C40.1309 134.155 40.0091 134.337 40.07 134.397C41.288 135.853 43.5413 136.096 45.0639 137.066C46.1601 138.34 47.4999 138.643 47.1345 140.341C47.0736 141.191 47.1345 142.1 46.221 142.404C45.9774 142.586 44.5767 142.828 44.2722 142.828C43.9677 142.768 43.3586 142.343 43.115 142.04C40.9835 141.13 38.6693 140.402 36.2332 140.159V145.133C35.9896 146.468 35.6851 147.923 34.6498 148.955C34.2844 149.015 33.1273 149.015 32.7619 148.955C32.4574 148.773 31.4221 147.741 31.1784 147.438C30.5694 145.133 30.4476 142.404 29.6559 140.159C29.1687 139.553 28.986 139.25 28.1943 139.31Z",fill:"#6965DB"}),A.createElement("path",{d:"M59.5964 139.31C58.1956 139.432 56.734 140.402 55.2724 140.523C54.5416 140.766 53.9935 140.16 53.3845 139.735C52.9582 139.553 52.41 138.461 52.2273 138.219C51.9837 136.884 51.3138 134.276 51.4356 133.002C51.1311 131.364 52.9582 129.787 54.4807 129.727C54.6634 129.727 55.2115 129.787 55.2724 129.787C57.1603 130.151 58.9874 131.546 60.9362 131.728C60.9971 131.728 61.058 131.728 61.058 131.668C61.8497 130.333 61.6061 126.937 62.2151 125.542C62.2151 125.36 62.5805 123.54 62.5805 123.237C63.0068 122.327 63.5549 121.781 64.5293 122.084C65.1992 122.266 66.0519 122.388 66.0519 123.237V128.635C66.2346 129.242 67.5135 128.999 68.0007 128.999C70.1931 128.028 72.2638 127.422 74.7607 127.058C77.0749 127.179 78.1103 129.242 77.9885 131.304C78.0494 132.396 76.8313 133.245 76.1005 133.973C75.8569 134.094 74.8825 134.519 74.5171 134.397C73.6645 133.791 72.5683 134.033 71.5329 134.094C71.5329 134.155 71.4112 134.337 71.4721 134.397C72.6901 135.853 74.9434 136.096 76.4659 137.066C77.5621 138.34 78.902 138.643 78.5366 140.341C78.4757 141.191 78.5366 142.1 77.623 142.404C77.3794 142.586 75.9787 142.828 75.6742 142.828C75.3697 142.768 74.7607 142.343 74.5171 142.04C72.3856 141.13 70.0713 140.402 67.6353 140.159V145.133C67.3917 146.468 67.0872 147.923 66.0519 148.955C65.6865 149.015 64.5293 149.015 64.1639 148.955C63.8594 148.773 62.8241 147.741 62.5805 147.438C61.9715 145.133 61.8497 142.404 61.058 140.159C60.5708 139.553 60.3881 139.25 59.5964 139.31Z",fill:"#6965DB"}),A.createElement("path",{d:"M90.9984 139.31C89.5977 139.432 88.1361 140.402 86.6745 140.523C85.9436 140.766 85.3955 140.16 84.7865 139.735C84.3602 139.553 83.8121 138.461 83.6294 138.219C83.3858 136.884 82.7159 134.276 82.8377 133.002C82.5332 131.364 84.3602 129.787 85.8827 129.727C86.0654 129.727 86.6136 129.787 86.6745 129.787C88.5624 130.151 90.3894 131.546 92.3382 131.728C92.3991 131.728 92.46 131.728 92.46 131.668C93.2518 130.333 93.0082 126.937 93.6172 125.542C93.6172 125.36 93.9826 123.54 93.9826 123.237C94.4089 122.327 94.957 121.781 95.9314 122.084C96.6013 122.266 97.4539 122.388 97.4539 123.237V128.635C97.6366 129.242 98.9155 128.999 99.4028 128.999C101.595 128.028 103.666 127.422 106.163 127.058C108.477 127.179 109.512 129.242 109.391 131.304C109.451 132.396 108.233 133.245 107.503 133.973C107.259 134.094 106.285 134.519 105.919 134.397C105.067 133.791 103.97 134.033 102.935 134.094C102.935 134.155 102.813 134.337 102.874 134.397C104.092 135.853 106.345 136.096 107.868 137.066C108.964 138.34 110.304 138.643 109.939 140.341C109.878 141.191 109.939 142.1 109.025 142.404C108.782 142.586 107.381 142.828 107.076 142.828C106.772 142.768 106.163 142.343 105.919 142.04C103.788 141.13 101.473 140.402 99.0373 140.159V145.133C98.7937 146.468 98.4892 147.923 97.4539 148.955C97.0885 149.015 95.9314 149.015 95.566 148.955C95.2615 148.773 94.2262 147.741 93.9826 147.438C93.3736 145.133 93.2518 142.404 92.46 140.159C91.9728 139.553 91.7901 139.25 90.9984 139.31Z",fill:"#6965DB"})),H0e=()=>{const t=window.navigator,e=/Apple/.test(t.vendor),n=t.appVersion.indexOf("Win")!==-1;return e?Oee:n?Dee:Ree},z0e=({activeRoomLink:t,onRoomCreate:e,onRoomDestroy:n,setErrorMessage:r,username:i,onUsernameChange:s,handleClose:o})=>{const{t:a}=Nn(),[l,c]=A.useState(!1),u=A.useRef(0),d=A.useRef(null),h="share"in navigator,f=async()=>{var m;try{await fu(t),c(!0),u.current&&window.clearTimeout(u.current),u.current=window.setTimeout(()=>{c(!1)},3e3)}catch(v){r(v.message)}(m=d.current)==null||m.select()},p=async()=>{try{await navigator.share({title:a("roomDialog.shareTitle"),text:a("roomDialog.shareTitle"),url:t})}catch{}};return t?M(ge,{children:[g("h3",{className:"RoomDialog__active__header",children:a("labels.liveCollaboration")}),g(ev,{value:i,placeholder:"Your name",label:"Your name",onChange:s,onKeyDown:m=>m.key===z.ENTER&&o()}),M("div",{className:"RoomDialog__active__linkRow",children:[g(ev,{ref:d,label:"Link",readonly:!0,fullWidth:!0,value:t}),h&&g(us,{size:"large",variant:"icon",label:"Share",startIcon:H0e(),className:"RoomDialog__active__share",onClick:p}),M(r2,{open:l,children:[g(i2,{asChild:!0,children:g(us,{size:"large",label:"Copy link",startIcon:Vv,onClick:f})}),M(s2,{onOpenAutoFocus:m=>m.preventDefault(),onCloseAutoFocus:m=>m.preventDefault(),className:"RoomDialog__popover",side:"top",align:"end",sideOffset:5.5,children:[JO," copied"]})]})]}),M("div",{className:"RoomDialog__active__description",children:[M("p",{children:[M("span",{role:"img","aria-hidden":"true",className:"RoomDialog__active__description__emoji",children:["🔒"," "]}),a("roomDialog.desc_privacy")]}),g("p",{children:a("roomDialog.desc_exitSession")})]}),g("div",{className:"RoomDialog__active__actions",children:g(us,{size:"large",variant:"outlined",color:"danger",label:a("roomDialog.button_stopSession"),startIcon:Dte,onClick:()=>{at("share","room closed"),n()}})})]}):M(ge,{children:[g("div",{className:"RoomDialog__inactive__illustration",children:g($0e,{})}),g("div",{className:"RoomDialog__inactive__header",children:a("labels.liveCollaboration")}),M("div",{className:"RoomDialog__inactive__description",children:[g("strong",{children:a("roomDialog.desc_intro")}),a("roomDialog.desc_privacy")]}),g("div",{className:"RoomDialog__inactive__start_session",children:g(us,{size:"large",label:a("roomDialog.button_startSession"),startIcon:Ote,onClick:()=>{at("share","room creation",`ui (${Pm()})`),e()}})})]})},G0e=t=>g(yi,{size:"small",onCloseRequest:t.handleClose,title:!1,children:g("div",{className:"RoomDialog",children:g(z0e,{...t})})}),uv={[pn.VERSION_DATA_STATE]:-1,[pn.VERSION_FILES]:-1},GM=t=>JSON.parse(localStorage.getItem(t)||"-1")>uv[t],Z$=t=>{const e=Date.now();try{localStorage.setItem(t,JSON.stringify(e)),uv[t]=e}catch(n){console.error("error while updating browser state verison",n)}},V0e=()=>{try{for(const t of Object.keys(uv))localStorage.setItem(t,JSON.stringify(-1)),uv[t]=-1}catch(t){console.error("error while resetting browser state verison",t)}};function W0e(){var t=!navigator.userAgentData&&/Safari\//.test(navigator.userAgent)&&!/Chrom(e|ium)\//.test(navigator.userAgent);if(!t||!indexedDB.databases)return Promise.resolve();var e;return new Promise(function(n){var r=function(){return indexedDB.databases().finally(n)};e=setInterval(r,100),r()}).finally(function(){return clearInterval(e)})}function Ch(t){return new Promise((e,n)=>{t.oncomplete=t.onsuccess=()=>e(t.result),t.onabort=t.onerror=()=>n(t.error)})}function K$(t,e){const n=W0e().then(()=>{const r=indexedDB.open(t);return r.onupgradeneeded=()=>r.result.createObjectStore(e),Ch(r)});return(r,i)=>n.then(s=>i(s.transaction(e,r).objectStore(e)))}let gE;function t1(){return gE||(gE=K$("keyval-store","keyval")),gE}function j0e(t,e,n=t1()){return n("readwrite",r=>(r.put(e,t),Ch(r.transaction)))}function X0e(t,e=t1()){return e("readwrite",n=>(t.forEach(r=>n.put(r[1],r[0])),Ch(n.transaction)))}function Y0e(t,e=t1()){return e("readonly",n=>Promise.all(t.map(r=>Ch(n.get(r)))))}function Z0e(t,e=t1()){return e("readwrite",n=>(n.delete(t),Ch(n.transaction)))}function K0e(t,e){return t("readonly",n=>(n.openCursor().onsuccess=function(){this.result&&(e(this.result),this.result.continue())},Ch(n.transaction)))}function q0e(t=t1()){const e=[];return K0e(t,n=>e.push([n.key,n.value])).then(()=>e)}class J0e{constructor(){O(this,"locks",new Map);O(this,"lock",e=>{this.locks.set(e,!0)});O(this,"unlock",e=>(this.locks.delete(e),!this.isLocked()))}isLocked(e){return e?this.locks.has(e):!!this.locks.size}}const pp=K$("files-db","files-store");class Q0e extends B${constructor(){super(...arguments);O(this,"clearObsoleteFiles",async n=>{await q0e(pp).then(r=>{for(const[i,s]of r)(!s.lastRetrieved||Date.now()-s.lastRetrieved>24*3600*1e3)&&!n.currentFileIds.includes(i)&&Z0e(i,pp)})})}}const eye=(t,e)=>{try{localStorage.setItem(pn.LOCAL_STORAGE_ELEMENTS,JSON.stringify(CB(t))),localStorage.setItem(pn.LOCAL_STORAGE_APP_STATE,JSON.stringify(mR(e))),Z$(pn.VERSION_DATA_STATE)}catch(n){console.error(n)}},Zn=class Zn{};O(Zn,"_save",$c(async(e,n,r,i)=>{eye(e,n),await Zn.fileStorage.saveFiles({elements:e,files:r}),i()},h0e)),O(Zn,"save",(e,n,r,i)=>{Zn.isSavePaused()||Zn._save(e,n,r,i)}),O(Zn,"flushSave",()=>{Zn._save.flush()}),O(Zn,"locker",new J0e),O(Zn,"pauseSave",e=>{Zn.locker.lock(e)}),O(Zn,"resumeSave",e=>{Zn.locker.unlock(e)}),O(Zn,"isSavePaused",()=>document.hidden||Zn.locker.isLocked()),O(Zn,"fileStorage",new Q0e({getFiles(e){return Y0e(e,pp).then(async n=>{const r=[],i=new Map,s=[];n.forEach((o,a)=>{const l=e[a];if(o){const c={...o,lastRetrieved:Date.now()};s.push([l,c]),r.push(c)}else i.set(l,!0)});try{X0e(s,pp)}catch(o){console.warn(o)}return{loadedFiles:r,erroredFiles:i}})},async saveFiles({addedFiles:e}){const n=new Map,r=new Map;return Z$(pn.VERSION_FILES),await Promise.all([...e].map(async([i,s])=>{try{await j0e(i,s,pp),n.set(i,!0)}catch(o){console.error(o),r.set(i,!0)}})),{savedFiles:n,erroredFiles:r}}}));let cr=Zn;const Gu=Q7(),q$=Yn(null),o6=Yn(!1),k3=Yn(!1),J$=Yn(!1);class tye extends A.PureComponent{constructor(n){super(n);O(this,"portal");O(this,"fileManager");O(this,"excalidrawAPI");O(this,"activeIntervalId");O(this,"idleTimeoutId");O(this,"socketInitializationTimer");O(this,"lastBroadcastedOrReceivedSceneVersion",-1);O(this,"collaborators",new Map);O(this,"onUmmount",null);O(this,"onOfflineStatusToggle",()=>{Gu.set(J$,!window.navigator.onLine)});O(this,"isCollaborating",()=>Gu.get(k3));O(this,"setIsCollaborating",n=>{Gu.set(k3,n)});O(this,"onUnload",()=>{this.destroySocketClient({isUnload:!0})});O(this,"beforeUnload",Nt(n=>{const r=Cc(this.getSceneElementsIncludingDeleted());this.isCollaborating()&&(this.fileManager.shouldPreventUnload(r)||!G$(this.portal,r))&&(this.saveCollabRoomToFirebase(r),uR(n))}));O(this,"saveCollabRoomToFirebase",async n=>{try{const r=await S0e(this.portal,n,this.excalidrawAPI.getAppState());this.isCollaborating()&&r&&r.reconciledElements&&this.handleRemoteSceneUpdate(this.reconcileElements(r.reconciledElements))}catch(r){this.setState({errorMessage:/is longer than.*?bytes/.test(r.message)?I("errors.collabSaveFailed_sizeExceeded"):I("errors.collabSaveFailed")}),console.error(r)}});O(this,"stopCollaboration",(n=!0)=>{if(this.queueBroadcastAllElements.cancel(),this.queueSaveToFirebase.cancel(),this.loadImageFiles.cancel(),this.saveCollabRoomToFirebase(Cc(this.excalidrawAPI.getSceneElementsIncludingDeleted())),this.portal.socket&&this.fallbackInitializationHandler&&this.portal.socket.off("connect_error",this.fallbackInitializationHandler),!n)cr.fileStorage.reset(),this.destroySocketClient();else if(window.confirm(I("alerts.collabStopOverridePrompt"))){V0e(),window.history.pushState({},Ho,window.location.origin),this.destroySocketClient(),cr.fileStorage.reset();const r=this.excalidrawAPI.getSceneElementsIncludingDeleted().map(i=>Wo(i)&&i.status==="saved"?Re(i,{status:"pending"}):i);this.excalidrawAPI.updateScene({elements:r,commitToHistory:!1})}});O(this,"destroySocketClient",n=>{this.lastBroadcastedOrReceivedSceneVersion=-1,this.portal.close(),this.fileManager.reset(),n!=null&&n.isUnload||(this.setIsCollaborating(!1),this.setState({activeRoomLink:""}),this.collaborators=new Map,this.excalidrawAPI.updateScene({collaborators:this.collaborators}),cr.resumeSave("collaboration"))});O(this,"fetchImageFilesFromFirebase",async n=>{const r=n.elements.filter(i=>En(i)&&!this.fileManager.isFileHandled(i.fileId)&&!i.isDeleted&&(n.forceFetchFiles?i.status!=="pending"||Date.now()-i.updated>1e4:i.status==="saved")).map(i=>i.fileId);return await this.fileManager.getFiles(r)});O(this,"decryptPayload",async(n,r,i)=>{try{const s=await dm(n,r,i),o=new TextDecoder("utf-8").decode(new Uint8Array(s));return JSON.parse(o)}catch(s){return window.alert(I("alerts.decryptFailed")),console.error(s),{type:Ir.INVALID_RESPONSE}}});O(this,"fallbackInitializationHandler",null);O(this,"startCollaboration",async n=>{if(this.state.username||pe(()=>import("./random-username.esm-K7eb4aAo.js"),__vite__mapDeps([])).then(({getRandomUsername:l})=>{const c=l();this.onUsernameChange(c)}),this.portal.socket)return null;let r,i;n?{roomId:r,roomKey:i}=n:({roomId:r,roomKey:i}=await L0e(),window.history.pushState({},Ho,R0e({roomId:r,roomKey:i})));const s=cR();this.setIsCollaborating(!0),cr.pauseSave("collaboration");const{default:o}=await pe(()=>import("./index-LGH6-1TW.js"),__vite__mapDeps([])),a=()=>{this.initializeRoom({roomLinkData:n,fetchScene:!0}).then(l=>{s.resolve(l)})};this.fallbackInitializationHandler=a;try{const l=await M0e();this.portal.socket=this.portal.open(o(l.url,{transports:l.polling?["websocket","polling"]:["websocket"]}),r,i),this.portal.socket.once("connect_error",a)}catch(l){return console.error(l),this.setState({errorMessage:l.message}),null}if(!n){const l=this.excalidrawAPI.getSceneElements().map(c=>Wo(c)&&c.status==="saved"?Re(c,{status:"pending"}):c);this.excalidrawAPI.history.clear(),this.excalidrawAPI.updateScene({elements:l,commitToHistory:!0}),this.saveCollabRoomToFirebase(Cc(l))}return this.socketInitializationTimer=window.setTimeout(a,f0e),this.portal.socket.on("client-broadcast",async(l,c)=>{var d;if(!this.portal.roomKey)return;const u=await this.decryptPayload(c,l,this.portal.roomKey);switch(u.type){case Ir.INVALID_RESPONSE:return;case Ir.INIT:{if(!this.portal.socketInitialized){this.initializeRoom({fetchScene:!1});const h=u.payload.elements,f=this.reconcileElements(h);this.handleRemoteSceneUpdate(f,{init:!0}),s.resolve({elements:f,scrollToContent:!0})}break}case Ir.UPDATE:this.handleRemoteSceneUpdate(this.reconcileElements(u.payload.elements));break;case Ir.MOUSE_LOCATION:{const{pointer:h,button:f,username:p,selectedElementIds:m}=u.payload,v=u.payload.socketId||u.payload.socketID;this.updateCollaborator(v,{pointer:h,button:f,selectedElementIds:m,username:p});break}case Ir.USER_VISIBLE_SCENE_BOUNDS:{const{sceneBounds:h,socketId:f}=u.payload,p=this.excalidrawAPI.getAppState();if(((d=p.userToFollow)==null?void 0:d.socketId)!==f){console.warn(`receiving remote client's (from ${f}) viewport bounds even though we're not subscribed to it!`);return}if(p.userToFollow&&p.followedBy.has(p.userToFollow.socketId))return;this.excalidrawAPI.updateScene({appState:cN({appState:p,bounds:h,fitToViewport:!0,viewportZoomFactor:1}).appState});break}case Ir.IDLE_STATUS:{const{userState:h,socketId:f,username:p}=u.payload;this.updateCollaborator(f,{userState:h,username:p});break}default:zd(u,null)}}),this.portal.socket.on("first-in-room",async()=>{this.portal.socket&&this.portal.socket.off("first-in-room");const l=await this.initializeRoom({fetchScene:!0,roomLinkData:n});s.resolve(l)}),this.portal.socket.on(_0.USER_FOLLOW_ROOM_CHANGE,l=>{this.excalidrawAPI.updateScene({appState:{followedBy:new Set(l)}}),this.relayVisibleSceneBounds({force:!0})}),this.initializeIdleDetector(),this.setState({activeRoomLink:window.location.href}),s});O(this,"initializeRoom",async({fetchScene:n,roomLinkData:r})=>{if(clearTimeout(this.socketInitializationTimer),this.portal.socket&&this.fallbackInitializationHandler&&this.portal.socket.off("connect_error",this.fallbackInitializationHandler),n&&r&&this.portal.socket){this.excalidrawAPI.resetScene();try{const i=await C0e(r.roomId,r.roomKey,this.portal.socket);if(i)return this.setLastBroadcastedOrReceivedSceneVersion(Oa(i)),{elements:i,scrollToContent:!0}}catch(i){console.error(i)}finally{this.portal.socketInitialized=!0}}else this.portal.socketInitialized=!0;return null});O(this,"reconcileElements",n=>{const r=this.getSceneElementsIncludingDeleted(),i=this.excalidrawAPI.getAppState();n=Ym(n,null);const s=i6(r,n,i);return this.setLastBroadcastedOrReceivedSceneVersion(Oa(s)),s});O(this,"loadImageFiles",Tc(async()=>{const{loadedFiles:n,erroredFiles:r}=await this.fetchImageFilesFromFirebase({elements:this.excalidrawAPI.getSceneElementsIncludingDeleted()});this.excalidrawAPI.addFiles(n),Of({excalidrawAPI:this.excalidrawAPI,erroredFiles:r,elements:this.excalidrawAPI.getSceneElementsIncludingDeleted()})},m0e));O(this,"handleRemoteSceneUpdate",(n,{init:r=!1}={})=>{this.excalidrawAPI.updateScene({elements:n,commitToHistory:!!r}),this.excalidrawAPI.history.clear(),this.loadImageFiles()});O(this,"onPointerMove",()=>{this.idleTimeoutId&&(window.clearTimeout(this.idleTimeoutId),this.idleTimeoutId=null),this.idleTimeoutId=window.setTimeout(this.reportIdle,AC),this.activeIntervalId||(this.activeIntervalId=window.setInterval(this.reportActive,kC))});O(this,"onVisibilityChange",()=>{document.hidden?(this.idleTimeoutId&&(window.clearTimeout(this.idleTimeoutId),this.idleTimeoutId=null),this.activeIntervalId&&(window.clearInterval(this.activeIntervalId),this.activeIntervalId=null),this.onIdleStateChange(mc.AWAY)):(this.idleTimeoutId=window.setTimeout(this.reportIdle,AC),this.activeIntervalId=window.setInterval(this.reportActive,kC),this.onIdleStateChange(mc.ACTIVE))});O(this,"reportIdle",()=>{this.onIdleStateChange(mc.IDLE),this.activeIntervalId&&(window.clearInterval(this.activeIntervalId),this.activeIntervalId=null)});O(this,"reportActive",()=>{this.onIdleStateChange(mc.ACTIVE)});O(this,"initializeIdleDetector",()=>{document.addEventListener(ee.POINTER_MOVE,this.onPointerMove),document.addEventListener(ee.VISIBILITY_CHANGE,this.onVisibilityChange)});O(this,"updateCollaborator",(n,r)=>{var o;const i=new Map(this.collaborators),s=Object.assign({},i.get(n),r,{isCurrentUser:n===((o=this.portal.socket)==null?void 0:o.id)});i.set(n,s),this.collaborators=i,this.excalidrawAPI.updateScene({collaborators:i})});O(this,"setLastBroadcastedOrReceivedSceneVersion",n=>{this.lastBroadcastedOrReceivedSceneVersion=n});O(this,"getLastBroadcastedOrReceivedSceneVersion",()=>this.lastBroadcastedOrReceivedSceneVersion);O(this,"getSceneElementsIncludingDeleted",()=>this.excalidrawAPI.getSceneElementsIncludingDeleted());O(this,"onPointerUpdate",Tc(n=>{n.pointersMap.size<2&&this.portal.socket&&this.portal.broadcastMouseLocation(n)},y0e));O(this,"relayVisibleSceneBounds",n=>{const r=this.excalidrawAPI.getAppState();this.portal.socket&&(r.followedBy.size>0||n!=null&&n.force)&&this.portal.broadcastVisibleSceneBounds({sceneBounds:Zoe(r)},`follow@${this.portal.socket.id}`)});O(this,"onIdleStateChange",n=>{this.portal.broadcastIdleChange(n)});O(this,"broadcastElements",n=>{Oa(n)>this.getLastBroadcastedOrReceivedSceneVersion()&&(this.portal.broadcastScene(Ir.UPDATE,n,!1),this.lastBroadcastedOrReceivedSceneVersion=Oa(n),this.queueBroadcastAllElements())});O(this,"syncElements",n=>{this.broadcastElements(n),this.queueSaveToFirebase()});O(this,"queueBroadcastAllElements",Tc(()=>{this.portal.broadcastScene(Ir.UPDATE,this.excalidrawAPI.getSceneElementsIncludingDeleted(),!0);const n=this.getLastBroadcastedOrReceivedSceneVersion(),r=Math.max(n,Oa(this.getSceneElementsIncludingDeleted()));this.setLastBroadcastedOrReceivedSceneVersion(r)},FM));O(this,"queueSaveToFirebase",Tc(()=>{this.portal.socketInitialized&&this.saveCollabRoomToFirebase(Cc(this.excalidrawAPI.getSceneElementsIncludingDeleted()))},FM,{leading:!1}));O(this,"handleClose",()=>{Gu.set(o6,!1)});O(this,"setUsername",n=>{this.setState({username:n})});O(this,"onUsernameChange",n=>{this.setUsername(n),F0e(n)});this.state={errorMessage:"",username:X$()||"",activeRoomLink:""},this.portal=new U0e(this),this.fileManager=new B$({getFiles:async r=>{const{roomId:i,roomKey:s}=this.portal;if(!i||!s)throw new Zp;return V$(`files/rooms/${i}`,s,r)},saveFiles:async({addedFiles:r})=>{const{roomId:i,roomKey:s}=this.portal;if(!i||!s)throw new Zp;return s6({prefix:`${F$.collabFiles}/${i}`,files:await r6({files:r,encryptionKey:s,maxBytes:n6})})}}),this.excalidrawAPI=n.excalidrawAPI,this.activeIntervalId=null,this.idleTimeoutId=null}componentDidMount(){window.addEventListener(ee.BEFORE_UNLOAD,this.beforeUnload),window.addEventListener("online",this.onOfflineStatusToggle),window.addEventListener("offline",this.onOfflineStatusToggle),window.addEventListener(ee.UNLOAD,this.onUnload);const n=this.excalidrawAPI.onUserFollow(o=>{this.portal.socket&&this.portal.broadcastUserFollowed(o)}),r=Mm(this.relayVisibleSceneBounds),i=this.excalidrawAPI.onScrollChange(()=>r());this.onUmmount=()=>{n(),i()},this.onOfflineStatusToggle();const s={isCollaborating:this.isCollaborating,onPointerUpdate:this.onPointerUpdate,startCollaboration:this.startCollaboration,syncElements:this.syncElements,fetchImageFilesFromFirebase:this.fetchImageFilesFromFirebase,stopCollaboration:this.stopCollaboration,setUsername:this.setUsername};Gu.set(q$,s)}componentWillUnmount(){var n;window.removeEventListener("online",this.onOfflineStatusToggle),window.removeEventListener("offline",this.onOfflineStatusToggle),window.removeEventListener(ee.BEFORE_UNLOAD,this.beforeUnload),window.removeEventListener(ee.UNLOAD,this.onUnload),window.removeEventListener(ee.POINTER_MOVE,this.onPointerMove),window.removeEventListener(ee.VISIBILITY_CHANGE,this.onVisibilityChange),this.activeIntervalId&&(window.clearInterval(this.activeIntervalId),this.activeIntervalId=null),this.idleTimeoutId&&(window.clearTimeout(this.idleTimeoutId),this.idleTimeoutId=null),(n=this.onUmmount)==null||n.call(this)}setCollaborators(n){var i;const r=new Map;for(const s of n)r.set(s,Object.assign({},this.collaborators.get(s),{isCurrentUser:s===((i=this.portal.socket)==null?void 0:i.id)}));this.collaborators=r,this.excalidrawAPI.updateScene({collaborators:r})}render(){const{username:n,errorMessage:r,activeRoomLink:i}=this.state,{modalIsShown:s}=this.props;return M(ge,{children:[s&&g(G0e,{handleClose:this.handleClose,activeRoomLink:i,username:n,onUsernameChange:this.onUsernameChange,onRoomCreate:()=>this.startCollaboration(null),onRoomDestroy:this.stopCollaboration,setErrorMessage:o=>{this.setState({errorMessage:o})}}),r&&g(W4,{onClose:()=>this.setState({errorMessage:""}),children:r})]})}}const nye=t=>{const[e]=Ht(o6);return g(tye,{...t,modalIsShown:e})},rye=500,VM=$c(t=>{t({scene:Y$(),total:B0e()})},rye),iye=t=>{const[e,n]=A.useState({scene:0,total:0});A.useEffect(()=>{VM(o=>{n(o)})},[t.elements,t.appState]),A.useEffect(()=>()=>VM.cancel(),[]);const r=mw();let i,s;return r!==g7?(s=r.slice(0,16).replace("T"," "),i=r.slice(21)):s=I("stats.versionNotAvailable"),M(ge,{children:[g("tr",{children:g("th",{colSpan:2,children:I("stats.storage")})}),M("tr",{children:[g("td",{children:I("stats.scene")}),g("td",{children:NC(e.scene,1)})]}),M("tr",{children:[g("td",{children:I("stats.total")}),g("td",{children:NC(e.total,1)})]}),g("tr",{children:g("th",{colSpan:2,children:I("stats.version")})}),g("tr",{children:M("td",{colSpan:2,style:{textAlign:"center",cursor:"pointer"},onClick:async()=>{try{await fu(mw()),t.setToast(I("toast.copyToClipboard"))}catch{}},title:I("stats.versionCopy"),children:[s,g("br",{}),i]})})]})};let sye=(t=21)=>crypto.getRandomValues(new Uint8Array(t)).reduce((e,n)=>(n&=63,n<36?e+=n.toString(36):n<62?e+=(n-26).toString(36).toUpperCase():n>62?e+="-":e+="_",e),"");const Q$=async(t,e,n)=>{const r=await H$(),i=`${sye(12)}`,s=await o4(),o=await v2(s,vh(t,e,n,"database")),a=new Blob([o.iv,new Uint8Array(o.encryptedBuffer)],{type:Oe.binary});await r.storage().ref(`/migrations/scenes/${i}`).put(a,{customMetadata:{data:JSON.stringify({version:2,name:e.name}),created:Date.now().toString()}});const l=new Map;for(const c of t)En(c)&&n[c.fileId]&&l.set(c.fileId,n[c.fileId]);if(l.size){const c=await r6({files:l,encryptionKey:s,maxBytes:n6});await s6({prefix:`/migrations/files/scenes/${i}`,files:c})}window.open(`https://app.excalidraw.com/import?excalidraw=${i},${s}`)},oye=({elements:t,appState:e,files:n,onError:r,onSuccess:i})=>{const{t:s}=Nn();return M(p3,{color:"primary",children:[g("div",{className:"Card-icon",children:g(KU,{style:{"--color-logo-icon":"#fff",width:"2.8rem",height:"2.8rem"}})}),g("h2",{children:"Excalidraw+"}),g("div",{className:"Card-details",children:s("exportDialog.excalidrawplus_description")}),g(st,{className:"Card-button",type:"button",title:s("exportDialog.excalidrawplus_button"),"aria-label":s("exportDialog.excalidrawplus_button"),showAriaLabel:!0,onClick:async()=>{try{at("export","eplus",`ui (${Pm()})`),await Q$(t,e,n),i()}catch(o){console.error(o),o.name!=="AbortError"&&r(new Error(s("exportDialog.excalidrawplus_exportError")))}}})]})},aye=({style:t})=>{const{t:e,langCode:n}=Nn(),r=ah(tH);return g("select",{className:"dropdown-select dropdown-select__language",onChange:({target:i})=>r(i.value),value:n,"aria-label":e("buttons.selectLanguage"),style:t,children:FT.map(i=>g("option",{value:i.code,children:i.label},i.code))})},lye=ce.memo(t=>M(xt,{children:[g(xt.DefaultItems.LoadScene,{}),g(xt.DefaultItems.SaveToActiveFile,{}),g(xt.DefaultItems.Export,{}),g(xt.DefaultItems.SaveAsImage,{}),t.isCollabEnabled&&g(xt.DefaultItems.LiveCollaborationTrigger,{isCollaborating:t.isCollaborating,onSelect:()=>t.setCollabDialogShown(!0)}),g(xt.DefaultItems.Help,{}),g(xt.DefaultItems.ClearCanvas,{}),g(xt.Separator,{}),g(xt.ItemLink,{icon:XO,href:"https://plus.excalidraw.com/plus?utm_source=excalidraw&utm_medium=app&utm_content=hamburger",className:"ExcalidrawPlus",children:"Excalidraw+"}),g(xt.DefaultItems.Socials,{}),g(xt.Separator,{}),g(xt.DefaultItems.ToggleTheme,{}),g(xt.ItemCustom,{children:g(aye,{style:{width:"100%"}})}),g(xt.DefaultItems.ChangeCanvasBackground,{})]})),cye=ce.memo(t=>{const{t:e}=Nn();let n;return lv?n=e("welcomeScreen.app.center_heading_plus").split(/(Excalidraw\+)/).map((r,i)=>r==="Excalidraw+"?g("a",{style:{pointerEvents:Vl.inheritFromUI},href:"https://app.excalidraw.com?utm_source=excalidraw&utm_medium=app&utm_content=welcomeScreenSignedInUser",children:"Excalidraw+"},i):r):n=e("welcomeScreen.app.center_heading"),M(Tr,{children:[g(Tr.Hints.MenuHint,{children:e("welcomeScreen.app.menuHint")}),g(Tr.Hints.ToolbarHint,{}),g(Tr.Hints.HelpHint,{}),M(Tr.Center,{children:[g(Tr.Center.Logo,{}),g(Tr.Center.Heading,{children:n}),M(Tr.Center.Menu,{children:[g(Tr.Center.MenuItemLoadScene,{}),g(Tr.Center.MenuItemHelp,{}),t.isCollabEnabled&&g(Tr.Center.MenuItemLiveCollaborationTrigger,{onSelect:()=>t.setCollabDialogShown(!0)}),!lv&&g(Tr.Center.MenuItemLink,{href:"https://plus.excalidraw.com/plus?utm_source=excalidraw&utm_medium=app&utm_content=welcomeScreenGuest",shortcut:null,icon:XO,children:"Try Excalidraw Plus!"})]})]})]})}),uye=()=>{const{t}=Nn();return g("a",{className:"encrypted-icon tooltip",href:"https://blog.excalidraw.com/end-to-end-encryption/",target:"_blank",rel:"noopener noreferrer","aria-label":t("encrypted.link"),children:g(El,{label:t("encrypted.tooltip"),long:!0,children:Zee})})},dye=()=>lv?g("a",{href:"https://app.excalidraw.com?utm_source=excalidraw&utm_medium=app&utm_content=signedInUserRedirectButton#excalidraw-redirect",target:"_blank",rel:"noreferrer",className:"plus-button",children:"Go to Excalidraw+"}):null,hye=ce.memo(()=>g(ZU,{children:g("div",{style:{display:"flex",gap:".5rem",alignItems:"center"},children:lv?g(dye,{}):g(uye,{})})})),fye=({link:t,onCloseRequest:e,setErrorMessage:n})=>{const{t:r}=Nn(),[i,s]=A.useState(!1),o=A.useRef(0),a=A.useRef(null);return g(yi,{onCloseRequest:e,title:!1,size:"small",children:M("div",{className:"ShareableLinkDialog",children:[g("h3",{children:"Shareable link"}),M("div",{className:"ShareableLinkDialog__linkRow",children:[g(ev,{ref:a,label:"Link",readonly:!0,fullWidth:!0,value:t,selectOnRender:!0}),M(r2,{open:i,children:[g(i2,{asChild:!0,children:g(us,{size:"large",label:"Copy link",startIcon:Vv,onClick:async()=>{var c;try{await fu(t),s(!0),o.current&&window.clearTimeout(o.current),o.current=window.setTimeout(()=>{s(!1)},3e3)}catch(u){n(u.message)}(c=a.current)==null||c.select()}})}),M(s2,{onOpenAutoFocus:c=>c.preventDefault(),onCloseAutoFocus:c=>c.preventDefault(),className:"ShareableLinkDialog__popover",side:"top",align:"end",sideOffset:5.5,children:[JO," copied"]})]})]}),M("div",{className:"ShareableLinkDialog__description",children:["🔒 ",r("alerts.uploadedSecurly")]})]})})};OG();window.EXCALIDRAW_THROTTLE_RENDER=!0;let eH=!1;if(window.self!==window.top)try{const t=new URL(document.referrer),e=new URL(window.location.href);t.origin===e.origin&&(eH=!0)}catch{}const dv=new a7;dv.init({languageUtils:{}});const WM={title:I("overwriteConfirm.modal.shareableLink.title"),description:g(Vr,{i18nKey:"overwriteConfirm.modal.shareableLink.description",bold:t=>g("strong",{children:t}),br:()=>g("br",{})}),actionLabel:I("overwriteConfirm.modal.shareableLink.button"),color:"danger"},M3=async t=>{var c,u;const n=new URLSearchParams(window.location.search).get("id"),r=window.location.hash.match(/^#json=([a-zA-Z0-9_-]+),([a-zA-Z0-9_-]+)$/),i=window.location.hash.match(/^#url=(.*)$/),s=A3();let o=await HM(null,null,s),a=P0e(window.location.href);const l=!!(n||r||a);if(l)if(!o.elements.length||a||await g3(WM))r&&(o=await HM(r[1],r[2],s)),o.scrollToContent=!0,a||window.history.replaceState({},Ho,window.location.origin);else{if(document.hidden)return new Promise((d,h)=>{window.addEventListener("focus",()=>M3(t).then(d).catch(h),{once:!0})});a=null,window.history.replaceState({},Ho,window.location.origin)}else if(i){window.history.replaceState({},Ho,window.location.origin);const d=i[1];try{const h=await fetch(window.decodeURIComponent(d)),f=await YS(await h.blob(),null,null);if(!o.elements.length||await g3(WM))return{scene:f,isExternalScene:l}}catch{return{scene:{appState:{errorMessage:I("alerts.invalidSceneUrl")}},isExternalScene:l}}}if(a&&t.collabAPI){const{excalidrawAPI:d}=t,h=await t.collabAPI.startCollaboration(a);return{scene:{...h,appState:{...FN({...h==null?void 0:h.appState,theme:((c=s==null?void 0:s.appState)==null?void 0:c.theme)||((u=h==null?void 0:h.appState)==null?void 0:u.theme)},d.getAppState()),isLoading:!1},elements:i6((h==null?void 0:h.elements)||[],d.getSceneElementsIncludingDeleted(),d.getAppState())},isExternalScene:!0,id:a.roomId,key:a.roomKey}}else if(o)return l&&r?{scene:o,isExternalScene:l,id:r[1],key:r[2]}:{scene:o,isExternalScene:!1};return{scene:null,isExternalScene:!1}},yE=dv.detect()||kl.code,tH=Yn(Array.isArray(yE)?yE[0]:yE),pye=()=>{const[t,e]=A.useState(""),[n,r]=Ht(tH),i=yW(),s=A.useRef({promise:null});s.current.promise||(s.current.promise=cR()),A.useEffect(()=>{at("load","frame",Pm()),setTimeout(()=>{at("load","version",mw())},RV)},[]);const[o,a]=vR(),[l]=Ht(q$),[,c]=Ht(o6),[u]=sW(k3,()=>$M(window.location.href));tue({excalidrawAPI:o,getInitialLibraryItems:zM}),A.useEffect(()=>{if(!o||!i&&!l)return;const E=(L,F=!1)=>{var N;if(L.scene)if(l!=null&&l.isCollaborating())L.scene.elements&&l.fetchImageFilesFromFirebase({elements:L.scene.elements,forceFetchFiles:!0}).then(({loadedFiles:R,erroredFiles:H})=>{o.addFiles(R),Of({excalidrawAPI:o,erroredFiles:H,elements:o.getSceneElementsIncludingDeleted()})});else{const R=((N=L.scene.elements)==null?void 0:N.reduce((H,W)=>En(W)?H.concat(W.fileId):H,[]))||[];L.isExternalScene?V$(`${F$.shareLinkFiles}/${L.id}`,L.key,R).then(({loadedFiles:H,erroredFiles:W})=>{o.addFiles(H),Of({excalidrawAPI:o,erroredFiles:W,elements:o.getSceneElementsIncludingDeleted()})}):F&&(R.length&&cr.fileStorage.getFiles(R).then(({loadedFiles:H,erroredFiles:W})=>{H.length&&o.addFiles(H),Of({excalidrawAPI:o,erroredFiles:W,elements:o.getSceneElementsIncludingDeleted()})}),cr.fileStorage.clearObsoleteFiles({currentFileIds:R}))}};M3({collabAPI:l,excalidrawAPI:o}).then(async L=>{E(L,!0),s.current.promise.resolve(L.scene)});const w=async L=>{L.preventDefault(),t3()||(l!=null&&l.isCollaborating()&&!$M(window.location.href)&&l.stopCollaboration(!1),o.updateScene({appState:{isLoading:!0}}),M3({collabAPI:l,excalidrawAPI:o}).then(N=>{E(N),N.scene&&o.updateScene({...N.scene,...Jc(N.scene,null,null,{repairBindings:!0}),commitToHistory:!0})}))},x=setTimeout(()=>document.title=Ho,LV),T=$c(()=>{if(!document.hidden&&(l&&!l.isCollaborating()||i)){if(GM(pn.VERSION_DATA_STATE)){const L=A3(),F=X$();let N=dv.detect()||kl.code;Array.isArray(N)&&(N=N[0]),r(N),o.updateScene({...L}),o.updateLibrary({libraryItems:zM()}),l==null||l.setUsername(F||"")}if(GM(pn.VERSION_FILES)){const L=o.getSceneElementsIncludingDeleted(),F=o.getFiles(),N=(L==null?void 0:L.reduce((R,H)=>En(H)&&!F[H.fileId]?R.concat(H.fileId):R,[]))||[];N.length&&cr.fileStorage.getFiles(N).then(({loadedFiles:R,erroredFiles:H})=>{R.length&&o.addFiles(R),Of({excalidrawAPI:o,erroredFiles:H,elements:o.getSceneElementsIncludingDeleted()})})}}},g0e),C=()=>{cr.flushSave()},k=L=>{(L.type===ee.BLUR||document.hidden)&&cr.flushSave(),(L.type===ee.VISIBILITY_CHANGE||L.type===ee.FOCUS)&&T()};return window.addEventListener(ee.HASHCHANGE,w,!1),window.addEventListener(ee.UNLOAD,C,!1),window.addEventListener(ee.BLUR,k,!1),document.addEventListener(ee.VISIBILITY_CHANGE,k,!1),window.addEventListener(ee.FOCUS,k,!1),()=>{window.removeEventListener(ee.HASHCHANGE,w,!1),window.removeEventListener(ee.UNLOAD,C,!1),window.removeEventListener(ee.BLUR,k,!1),window.removeEventListener(ee.FOCUS,k,!1),document.removeEventListener(ee.VISIBILITY_CHANGE,k,!1),clearTimeout(x)}},[i,l,o,r]),A.useEffect(()=>{const E=w=>{cr.flushSave(),o&&cr.fileStorage.shouldPreventUnload(o.getSceneElements())&&uR(w)};return window.addEventListener(ee.BEFORE_UNLOAD,E),()=>{window.removeEventListener(ee.BEFORE_UNLOAD,E)}},[o]),A.useEffect(()=>{dv.cacheUserLanguage(n)},[n]);const[d,h]=A.useState(()=>{var E;return localStorage.getItem(pn.LOCAL_STORAGE_THEME)||((E=A3().appState)==null?void 0:E.theme)||Vn.LIGHT});A.useEffect(()=>{localStorage.setItem(pn.LOCAL_STORAGE_THEME,d),document.documentElement.classList.toggle("dark",d===Vn.DARK)},[d]);const f=(E,w,x)=>{l!=null&&l.isCollaborating()&&l.syncElements(E),h(w.theme),cr.isSavePaused()||cr.save(E,w,x,()=>{if(o){let T=!1;const C=o.getSceneElementsIncludingDeleted().map(k=>{if(cr.fileStorage.shouldUpdateImageElementStatus(k)){const L=Re(k,{status:"saved"});return L!==k&&(T=!0),L}return k});T&&o.updateScene({elements:C})}})},[p,m]=A.useState(null),v=async(E,w,x,T)=>{if(E.length===0)throw new Error(I("alerts.cannotExportEmptyCanvas"));if(T)try{const{url:C,errorMessage:k}=await N0e(E,{...w,viewBackgroundColor:w.exportBackground?w.viewBackgroundColor:Es().viewBackgroundColor},x);if(k)throw new Error(k);C&&m(C)}catch(C){if(C.name!=="AbortError"){const{width:k,height:L}=T;throw console.error(C,{width:k,height:L}),new Error(C.message)}}},y=(E,w)=>g(iye,{setToast:x=>o.setToast({message:x}),appState:w,elements:E}),b=async E=>{if(!E.length){localStorage.removeItem(pn.LOCAL_STORAGE_LIBRARY);return}const w=JSON.stringify(E);localStorage.setItem(pn.LOCAL_STORAGE_LIBRARY,w)},_=Pv(J$);return eH?g("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",textAlign:"center",height:"100%"},children:g("h1",{children:"I'm not a pretzel!"})}):g("div",{style:{height:"100%"},className:Ee("excalidraw-app",{"is-collaborating":u}),children:M(n$,{excalidrawAPI:a,onChange:f,initialData:s.current.promise,isCollaborating:u,onPointerUpdate:l==null?void 0:l.onPointerUpdate,UIOptions:{canvasActions:{toggleTheme:!0,export:{onExportToBackend:v,renderCustomUI:(E,w,x)=>g(oye,{elements:E,appState:w,files:x,onError:T=>{o==null||o.updateScene({appState:{errorMessage:T.message}})},onSuccess:()=>{o==null||o.updateScene({appState:{openDialog:null}})}})}}},langCode:n,renderCustomStats:y,detectScroll:!1,handleKeyboardGlobally:!0,onLibraryChange:b,autoFocus:!0,theme:d,renderTopRightUI:E=>E||!l||i?null:g(QU,{isCollaborating:u,onSelect:()=>c(!0)}),children:[g(lye,{setCollabDialogShown:c,isCollaborating:u,isCollabEnabled:!i}),g(cye,{setCollabDialogShown:c,isCollabEnabled:!i}),M(Sc,{children:[g(Sc.Actions.ExportToImage,{}),g(Sc.Actions.SaveToDisk,{}),o&&g(Sc.Action,{title:I("overwriteConfirm.action.excalidrawPlus.title"),actionLabel:I("overwriteConfirm.action.excalidrawPlus.button"),onClick:()=>{Q$(o.getSceneElements(),o.getAppState(),o.getFiles())},children:I("overwriteConfirm.action.excalidrawPlus.description")})]}),g(hye,{}),g(u$,{onTextSubmit:async E=>{try{const w=await fetch("https://oss-ai.excalidraw.com/v1/ai/text-to-diagram/generate",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({prompt:E})}),x=w.headers.has("X-Ratelimit-Limit")?parseInt(w.headers.get("X-Ratelimit-Limit")||"0",10):void 0,T=w.headers.has("X-Ratelimit-Remaining")?parseInt(w.headers.get("X-Ratelimit-Remaining")||"0",10):void 0,C=await w.json();if(!w.ok){if(w.status===429)return{rateLimit:x,rateLimitRemaining:T,error:new Error("Too many requests today, please try again tomorrow!")};throw new Error(C.message||"Generation failed...")}const k=C.generatedResponse;if(!k)throw new Error("Generation failed...");return{generatedResponse:k,rateLimit:x,rateLimitRemaining:T}}catch{throw new Error("Request failed")}}}),g(e$,{}),u&&_&&g("div",{className:"collab-offline-warning",children:I("alerts.collabOfflineWarning")}),p&&g(fye,{link:p,onCloseRequest:()=>m(null),setErrorMessage:e}),o&&!i&&g(nye,{excalidrawAPI:o}),t&&g(W4,{onClose:()=>e(""),children:t})]})})},mye=()=>g(d0e,{children:g(NT,{unstable_createStore:()=>Gu,children:g(pye,{})})});function gye(t={}){const{immediate:e=!1,onNeedRefresh:n,onOfflineReady:r,onRegistered:i,onRegisteredSW:s,onRegisterError:o}=t;let a,l;const c=async(d=!0)=>{await l};async function u(){if("serviceWorker"in navigator){const{Workbox:d}=await pe(()=>import("./workbox-window.prod.es5-prqDwDSL.js"),__vite__mapDeps([]));a=new d("/sw.js",{scope:"/",type:"classic"}),a.addEventListener("activated",h=>{(h.isUpdate||h.isExternal)&&window.location.reload()}),a.addEventListener("installed",h=>{h.isUpdate||r==null||r()}),a.register({immediate:e}).then(h=>{s?s("/sw.js",h):i==null||i(h)}).catch(h=>{o==null||o(h)})}}return l=u(),c}var Tg=Tn(),yye=function(){function t(e){e===void 0&&(e={}),this.name=t.id,this._levels=["log","info","warn","error","debug","assert"],e.levels&&(this._levels=e.levels)}return t.prototype.setupOnce=function(e,n){"console"in Tg&&this._levels.forEach(function(r){r in Tg.console&&Qn(Tg.console,r,function(i){return function(){for(var s=[],o=0;o<arguments.length;o++)s[o]=arguments[o];var a=n();a.getIntegration(t)&&a.withScope(function(l){l.setLevel(xs.fromString(r)),l.setExtra("arguments",s),l.addEventProcessor(function(u){return u.logger="console",u});var c=sv(s," ");r==="assert"?s[0]===!1&&(c="Assertion failed: "+(sv(s.slice(1)," ")||"console.assert"),l.setExtra("arguments",s.slice(1)),a.captureMessage(c)):a.captureMessage(c)}),i&&Function.prototype.apply.call(i,Tg.console,s)}})})},t.id="CaptureConsole",t}(),vye={VITE_APP_BACKEND_V2_GET_URL:"https://json.excalidraw.com/api/v2/",VITE_APP_BACKEND_V2_POST_URL:"https://json.excalidraw.com/api/v2/post/",VITE_APP_LIBRARY_URL:"https://libraries.excalidraw.com",VITE_APP_LIBRARY_BACKEND:"https://us-central1-excalidraw-room-persistence.cloudfunctions.net/libraries",VITE_APP_PORTAL_URL:"https://portal.excalidraw.com",VITE_APP_PLUS_LP:"https://plus.excalidraw.com",VITE_APP_PLUS_APP:"https://app.excalidraw.com",VITE_APP_AI_BACKEND:"https://oss-ai.excalidraw.com",VITE_APP_WS_SERVER_URL:"",VITE_APP_FIREBASE_CONFIG:'{"apiKey":"AIzaSyAd15pYlMci_xIp9ko6wkEsDzAAA0Dn0RU","authDomain":"excalidraw-room-persistence.firebaseapp.com","databaseURL":"https://excalidraw-room-persistence.firebaseio.com","projectId":"excalidraw-room-persistence","storageBucket":"excalidraw-room-persistence.appspot.com","messagingSenderId":"654800341332","appId":"1:654800341332:web:4a692de832b55bd57ce0c1"}',VITE_APP_DISABLE_TRACKING:"",VITE_APP_GIT_SHA:"",BASE_URL:"/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const nH={"excalidraw.com":"production","vercel.app":"staging"},bye=vye.VITE_APP_DISABLE_SENTRY==="true",vE=!bye&&Object.keys(nH).find(t=>window.location.hostname.indexOf(t)>=0);c0e({dsn:vE?"https://7bfc596a5bf945eda6b660d3015a5460@sentry.io/5179260":void 0,environment:vE?nH[vE]:void 0,release:"",ignoreErrors:["undefined is not an object (evaluating 'window.__pad.performLoop')"],integrations:[new yye({levels:["error"]})],beforeSend(t){var e;return(e=t.request)!=null&&e.url&&(t.request.url=t.request.url.replace(/#.*$/,"")),t}});window.__EXCALIDRAW_SHA__="";const _ye=document.getElementById("root"),Eye=s7(_ye);gye();Eye.render(g(A.StrictMode,{children:g(mye,{})}));export{Cye as _,La as a,kye as b,Mye as c,Iye as d,Aye as e,Hie as f,aa as g,E0 as h,pe as i};
//# sourceMappingURL=index-J3WFQECV.js.map
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = ["assets/pica-FQTv14zf.js","assets/_commonjs-dynamic-modules-h-SxKiO4.js","assets/index.esm-whGSL8KN.js","assets/index.esm-W3biQmml.js","assets/index.esm-R4Xo_FiR.js","assets/index.esm-0MBOLK1W.js"]
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}